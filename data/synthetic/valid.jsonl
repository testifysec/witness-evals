{"messages": [{"role": "system", "content": "You are an expert in the Witness supply chain attestation framework. You help users instrument CI/CD pipelines with witness, create policy documents, and write Rego policies to validate attestations. You understand all attestors in go-witness and how to use them effectively."}, {"role": "user", "content": "How do I create a witness policy for a build step that uses these attestors: git, github, commandrun, product?"}, {"role": "assistant", "content": "Here's a complete witness policy for your build step with git, github, commandrun, product attestors:\n\n**Policy Document:**\n```json\n{\n  \"expires\": \"2026-11-08T10:52:59Z\",\n  \"publickeys\": {\n    \"build-key\": {\n      \"keyid\": \"sha256:1bb58dcaad023039fe0599c47f224abbe9b5718c45b6b6c9dfbe66fb43065e9b\",\n      \"key\": \"-----BEGIN PUBLIC KEY-----\\n...\\n-----END PUBLIC KEY-----\"\n    }\n  },\n  \"steps\": {\n    \"build\": {\n      \"name\": \"build\",\n      \"attestations\": [\n        {\n          \"type\": \"https://witness.dev/attestations/git/v0.1\"\n        },\n        {\n          \"type\": \"https://witness.dev/attestations/github/v0.1\"\n        },\n        {\n          \"type\": \"https://witness.dev/attestations/command-run/v0.1\"\n        },\n        {\n          \"type\": \"https://witness.dev/attestations/product/v0.1\"\n        }\n      ],\n      \"functionaries\": [\n        {\n          \"type\": \"publickey\",\n          \"publickeyid\": \"build-key\"\n        }\n      ]\n    }\n  }\n}\n```\n\n**Witness Run Command:**\n```bash\nwitness run --step build \\\n  --attestations git,github,commandrun,product \\\n  --outfile build-attestation.json \\\n  --key signing-key.pem \\\n  -- <your-build-command>\n```\n\n**Rego Validation Rules:**\n```rego\npackage git\n\nimport rego.v1\n\n# Enforce builds from specific branch\ndeny contains msg if {\n    input.branch != \"main\"\n    msg := sprintf(\"Must build from main branch, got: %s\", [input.branch])\n}\n\n# Require clean working directory\ndeny contains msg if {\n    count(input.status) > 0\n    msg := \"Working directory must be clean (no uncommitted changes)\"\n}\n\n# Validate commit author\napproved_authors := {\n    \"alice.smith@example.com\",\n    \"bob.jones@company.com\",\n    \"ci-bot@company.com\"\n}\n\ndeny contains msg if {\n    not input.authoremail in approved_authors\n    msg := sprintf(\"Unauthorized commit author: %s\", [input.authoremail])\n}\n```\n\n**Verification:**\n```bash\nwitness verify \\\n  --policy policy-signed.json \\\n  --publickey policy-key.pub \\\n  -a build-attestation.json \\\n  --subject <artifact>\n```\n"}]}
{"messages": [{"role": "system", "content": "You are an expert in the Witness supply chain attestation framework. You help users instrument CI/CD pipelines with witness, create policy documents, and write Rego policies to validate attestations. You understand all attestors in go-witness and how to use them effectively."}, {"role": "user", "content": "How do I create a witness policy for a build step that uses these attestors: product, commandrun, github, environment?"}, {"role": "assistant", "content": "Here's a complete witness policy for your build step with product, commandrun, github, environment attestors:\n\n**Policy Document:**\n```json\n{\n  \"expires\": \"2026-11-08T10:52:59Z\",\n  \"publickeys\": {\n    \"build-key\": {\n      \"keyid\": \"sha256:d1294c0e4712d0339373fd18aca4e1a3ec1d5c91dfc9e509239272a2f4617a05\",\n      \"key\": \"-----BEGIN PUBLIC KEY-----\\n...\\n-----END PUBLIC KEY-----\"\n    }\n  },\n  \"steps\": {\n    \"build\": {\n      \"name\": \"build\",\n      \"attestations\": [\n        {\n          \"type\": \"https://witness.dev/attestations/product/v0.1\"\n        },\n        {\n          \"type\": \"https://witness.dev/attestations/command-run/v0.1\"\n        },\n        {\n          \"type\": \"https://witness.dev/attestations/github/v0.1\"\n        },\n        {\n          \"type\": \"https://witness.dev/attestations/environment/v0.1\"\n        }\n      ],\n      \"functionaries\": [\n        {\n          \"type\": \"publickey\",\n          \"publickeyid\": \"build-key\"\n        }\n      ]\n    }\n  }\n}\n```\n\n**Witness Run Command:**\n```bash\nwitness run --step build \\\n  --attestations product,commandrun,github,environment \\\n  --outfile build-attestation.json \\\n  --key signing-key.pem \\\n  -- <your-build-command>\n```\n\n**Rego Validation Rules:**\n```rego\n\n```\n\n**Verification:**\n```bash\nwitness verify \\\n  --policy policy-signed.json \\\n  --publickey policy-key.pub \\\n  -a build-attestation.json \\\n  --subject <artifact>\n```\n"}]}
{"messages": [{"role": "system", "content": "You are an expert in the Witness supply chain attestation framework. You help users instrument CI/CD pipelines with witness, create policy documents, and write Rego policies to validate attestations. You understand all attestors in go-witness and how to use them effectively."}, {"role": "user", "content": "How do I create a witness policy for a build step that uses these attestors: commandrun, environment?"}, {"role": "assistant", "content": "Here's a complete witness policy for your build step with commandrun, environment attestors:\n\n**Policy Document:**\n```json\n{\n  \"expires\": \"2026-11-08T10:52:59Z\",\n  \"publickeys\": {\n    \"build-key\": {\n      \"keyid\": \"sha256:530ca725f7de735f5d5c029a839128ba6c9feddb2b64f2c7186abd14ad1671de\",\n      \"key\": \"-----BEGIN PUBLIC KEY-----\\n...\\n-----END PUBLIC KEY-----\"\n    }\n  },\n  \"steps\": {\n    \"build\": {\n      \"name\": \"build\",\n      \"attestations\": [\n        {\n          \"type\": \"https://witness.dev/attestations/command-run/v0.1\"\n        },\n        {\n          \"type\": \"https://witness.dev/attestations/environment/v0.1\"\n        }\n      ],\n      \"functionaries\": [\n        {\n          \"type\": \"publickey\",\n          \"publickeyid\": \"build-key\"\n        }\n      ]\n    }\n  }\n}\n```\n\n**Witness Run Command:**\n```bash\nwitness run --step build \\\n  --attestations commandrun,environment \\\n  --outfile build-attestation.json \\\n  --key signing-key.pem \\\n  -- <your-build-command>\n```\n\n**Rego Validation Rules:**\n```rego\n\n```\n\n**Verification:**\n```bash\nwitness verify \\\n  --policy policy-signed.json \\\n  --publickey policy-key.pub \\\n  -a build-attestation.json \\\n  --subject <artifact>\n```\n"}]}
{"messages": [{"role": "system", "content": "You are an expert in the Witness supply chain attestation framework. You help users instrument CI/CD pipelines with witness, create policy documents, and write Rego policies to validate attestations. You understand all attestors in go-witness and how to use them effectively."}, {"role": "user", "content": "How do I create a witness policy for a build step that uses these attestors: material, product, environment, github?"}, {"role": "assistant", "content": "Here's a complete witness policy for your build step with material, product, environment, github attestors:\n\n**Policy Document:**\n```json\n{\n  \"expires\": \"2026-11-08T10:52:59Z\",\n  \"publickeys\": {\n    \"build-key\": {\n      \"keyid\": \"sha256:2ddcda25111e2fd7d65fc7d608de28726678e6ab5262c78ab87c67059b5e3425\",\n      \"key\": \"-----BEGIN PUBLIC KEY-----\\n...\\n-----END PUBLIC KEY-----\"\n    }\n  },\n  \"steps\": {\n    \"build\": {\n      \"name\": \"build\",\n      \"attestations\": [\n        {\n          \"type\": \"https://witness.dev/attestations/material/v0.1\"\n        },\n        {\n          \"type\": \"https://witness.dev/attestations/product/v0.1\"\n        },\n        {\n          \"type\": \"https://witness.dev/attestations/environment/v0.1\"\n        },\n        {\n          \"type\": \"https://witness.dev/attestations/github/v0.1\"\n        }\n      ],\n      \"functionaries\": [\n        {\n          \"type\": \"publickey\",\n          \"publickeyid\": \"build-key\"\n        }\n      ]\n    }\n  }\n}\n```\n\n**Witness Run Command:**\n```bash\nwitness run --step build \\\n  --attestations material,product,environment,github \\\n  --outfile build-attestation.json \\\n  --key signing-key.pem \\\n  -- <your-build-command>\n```\n\n**Rego Validation Rules:**\n```rego\n\n```\n\n**Verification:**\n```bash\nwitness verify \\\n  --policy policy-signed.json \\\n  --publickey policy-key.pub \\\n  -a build-attestation.json \\\n  --subject <artifact>\n```\n"}]}
{"messages": [{"role": "system", "content": "You are an expert in the Witness supply chain attestation framework. You help users instrument CI/CD pipelines with witness, create policy documents, and write Rego policies to validate attestations. You understand all attestors in go-witness and how to use them effectively."}, {"role": "user", "content": "How do I create a witness policy for a build step that uses these attestors: environment, material?"}, {"role": "assistant", "content": "Here's a complete witness policy for your build step with environment, material attestors:\n\n**Policy Document:**\n```json\n{\n  \"expires\": \"2026-11-08T10:52:59Z\",\n  \"publickeys\": {\n    \"build-key\": {\n      \"keyid\": \"sha256:59248e31bc07608c4787b362f068a14430512586ba649412f099eb26954080ad\",\n      \"key\": \"-----BEGIN PUBLIC KEY-----\\n...\\n-----END PUBLIC KEY-----\"\n    }\n  },\n  \"steps\": {\n    \"build\": {\n      \"name\": \"build\",\n      \"attestations\": [\n        {\n          \"type\": \"https://witness.dev/attestations/environment/v0.1\"\n        },\n        {\n          \"type\": \"https://witness.dev/attestations/material/v0.1\"\n        }\n      ],\n      \"functionaries\": [\n        {\n          \"type\": \"publickey\",\n          \"publickeyid\": \"build-key\"\n        }\n      ]\n    }\n  }\n}\n```\n\n**Witness Run Command:**\n```bash\nwitness run --step build \\\n  --attestations environment,material \\\n  --outfile build-attestation.json \\\n  --key signing-key.pem \\\n  -- <your-build-command>\n```\n\n**Rego Validation Rules:**\n```rego\npackage environment\n\nimport rego.v1\n\n# Ensure correct OS\ndeny contains msg if {\n    input.os != \"windows\"\n    msg := sprintf(\"Must run on windows, got: %s\", [input.os])\n}\n\n# Require CI environment\ndeny contains msg if {\n    not \"CI\" in input.variables\n    msg := \"Must run in CI environment (CI variable not set)\"\n}\n```\n\n**Verification:**\n```bash\nwitness verify \\\n  --policy policy-signed.json \\\n  --publickey policy-key.pub \\\n  -a build-attestation.json \\\n  --subject <artifact>\n```\n"}]}
{"messages": [{"role": "system", "content": "You are an expert in the Witness supply chain attestation framework. You help users instrument CI/CD pipelines with witness, create policy documents, and write Rego policies to validate attestations. You understand all attestors in go-witness and how to use them effectively."}, {"role": "user", "content": "How do I create a multi-step witness policy for a build \u2192 test \u2192 package pipeline?"}, {"role": "assistant", "content": "Here's a complete multi-step witness policy for your pipeline:\n\n**Policy Document:**\n```json\n{\n  \"expires\": \"2026-11-08T10:52:59Z\",\n  \"publickeys\": {\n    \"ci-key\": {\n      \"keyid\": \"sha256:f339f52dc7bd992952ddacc26955c782c9e5ebadd9a2175a711564345e8dc510\",\n      \"key\": \"-----BEGIN PUBLIC KEY-----\\n...\\n-----END PUBLIC KEY-----\"\n    }\n  },\n  \"steps\": {\n    \"build\": {\n      \"name\": \"build\",\n      \"attestations\": [\n        {\n          \"type\": \"https://witness.dev/attestations/git/v0.1\"\n        },\n        {\n          \"type\": \"https://witness.dev/attestations/command-run/v0.1\"\n        },\n        {\n          \"type\": \"https://witness.dev/attestations/product/v0.1\"\n        }\n      ],\n      \"functionaries\": [\n        {\n          \"type\": \"publickey\",\n          \"publickeyid\": \"ci-key\"\n        }\n      ]\n    },\n    \"test\": {\n      \"name\": \"test\",\n      \"attestations\": [\n        {\n          \"type\": \"https://witness.dev/attestations/material/v0.1\"\n        },\n        {\n          \"type\": \"https://witness.dev/attestations/command-run/v0.1\"\n        }\n      ],\n      \"functionaries\": [\n        {\n          \"type\": \"publickey\",\n          \"publickeyid\": \"ci-key\"\n        }\n      ]\n    },\n    \"package\": {\n      \"name\": \"package\",\n      \"attestations\": [\n        {\n          \"type\": \"https://witness.dev/attestations/material/v0.1\"\n        },\n        {\n          \"type\": \"https://witness.dev/attestations/product/v0.1\"\n        }\n      ],\n      \"functionaries\": [\n        {\n          \"type\": \"publickey\",\n          \"publickeyid\": \"ci-key\"\n        }\n      ]\n    }\n  }\n}\n```\n\n**Pipeline Commands:**\n\n```bash\n# Step 1: Build\nwitness run --step build \\\n  --attestations git,commandrun,product \\\n  -o build.json --key ci-key.pem \\\n  -- go build -o myapp\n\n# Step 2: Test\nwitness run --step test \\\n  --attestations material,commandrun \\\n  -o test.json --key ci-key.pem \\\n  -- go test ./...\n\n# Step 3: Package\nwitness run --step package \\\n  --attestations material,product \\\n  -o package.json --key ci-key.pem \\\n  -- tar czf myapp.tar.gz myapp\n\n# Verify entire pipeline\nwitness verify \\\n  --policy policy-signed.json \\\n  --publickey policy-key.pub \\\n  -a build.json -a test.json -a package.json\n```\n"}]}
{"messages": [{"role": "system", "content": "You are an expert in the Witness supply chain attestation framework. You help users instrument CI/CD pipelines with witness, create policy documents, and write Rego policies to validate attestations. You understand all attestors in go-witness and how to use them effectively."}, {"role": "user", "content": "How do I create a witness policy for a build step that uses these attestors: github, git?"}, {"role": "assistant", "content": "Here's a complete witness policy for your build step with github, git attestors:\n\n**Policy Document:**\n```json\n{\n  \"expires\": \"2026-11-08T10:52:59Z\",\n  \"publickeys\": {\n    \"build-key\": {\n      \"keyid\": \"sha256:1eb18bdb085ab31b96b0f283d1b483d5effcc1bd8146ce39ddf6eb0fc4d8674e\",\n      \"key\": \"-----BEGIN PUBLIC KEY-----\\n...\\n-----END PUBLIC KEY-----\"\n    }\n  },\n  \"steps\": {\n    \"build\": {\n      \"name\": \"build\",\n      \"attestations\": [\n        {\n          \"type\": \"https://witness.dev/attestations/github/v0.1\"\n        },\n        {\n          \"type\": \"https://witness.dev/attestations/git/v0.1\"\n        }\n      ],\n      \"functionaries\": [\n        {\n          \"type\": \"publickey\",\n          \"publickeyid\": \"build-key\"\n        }\n      ]\n    }\n  }\n}\n```\n\n**Witness Run Command:**\n```bash\nwitness run --step build \\\n  --attestations github,git \\\n  --outfile build-attestation.json \\\n  --key signing-key.pem \\\n  -- <your-build-command>\n```\n\n**Rego Validation Rules:**\n```rego\n\n```\n\n**Verification:**\n```bash\nwitness verify \\\n  --policy policy-signed.json \\\n  --publickey policy-key.pub \\\n  -a build-attestation.json \\\n  --subject <artifact>\n```\n"}]}
{"messages": [{"role": "system", "content": "You are an expert in the Witness supply chain attestation framework. You help users instrument CI/CD pipelines with witness, create policy documents, and write Rego policies to validate attestations. You understand all attestors in go-witness and how to use them effectively."}, {"role": "user", "content": "How do I create a witness policy for a build step that uses these attestors: commandrun, github, environment, material, git?"}, {"role": "assistant", "content": "Here's a complete witness policy for your build step with commandrun, github, environment, material, git attestors:\n\n**Policy Document:**\n```json\n{\n  \"expires\": \"2026-11-08T10:52:59Z\",\n  \"publickeys\": {\n    \"build-key\": {\n      \"keyid\": \"sha256:b1316731b48d4ac0918ba2e4dbd6dfc89f7506d6cc5f517a51172d4037cbc4b4\",\n      \"key\": \"-----BEGIN PUBLIC KEY-----\\n...\\n-----END PUBLIC KEY-----\"\n    }\n  },\n  \"steps\": {\n    \"build\": {\n      \"name\": \"build\",\n      \"attestations\": [\n        {\n          \"type\": \"https://witness.dev/attestations/command-run/v0.1\"\n        },\n        {\n          \"type\": \"https://witness.dev/attestations/github/v0.1\"\n        },\n        {\n          \"type\": \"https://witness.dev/attestations/environment/v0.1\"\n        },\n        {\n          \"type\": \"https://witness.dev/attestations/material/v0.1\"\n        },\n        {\n          \"type\": \"https://witness.dev/attestations/git/v0.1\"\n        }\n      ],\n      \"functionaries\": [\n        {\n          \"type\": \"publickey\",\n          \"publickeyid\": \"build-key\"\n        }\n      ]\n    }\n  }\n}\n```\n\n**Witness Run Command:**\n```bash\nwitness run --step build \\\n  --attestations commandrun,github,environment,material,git \\\n  --outfile build-attestation.json \\\n  --key signing-key.pem \\\n  -- <your-build-command>\n```\n\n**Rego Validation Rules:**\n```rego\n\n```\n\n**Verification:**\n```bash\nwitness verify \\\n  --policy policy-signed.json \\\n  --publickey policy-key.pub \\\n  -a build-attestation.json \\\n  --subject <artifact>\n```\n"}]}
{"messages": [{"role": "system", "content": "You are an expert in the Witness supply chain attestation framework. You help users instrument CI/CD pipelines with witness, create policy documents, and write Rego policies to validate attestations. You understand all attestors in go-witness and how to use them effectively."}, {"role": "user", "content": "How do I create a multi-step witness policy for a build \u2192 test \u2192 package pipeline?"}, {"role": "assistant", "content": "Here's a complete multi-step witness policy for your pipeline:\n\n**Policy Document:**\n```json\n{\n  \"expires\": \"2026-11-08T10:52:59Z\",\n  \"publickeys\": {\n    \"ci-key\": {\n      \"keyid\": \"sha256:a6d60edc630d1311cef80eb300ea614253a48ceb899d596ecfc3e4628f15432d\",\n      \"key\": \"-----BEGIN PUBLIC KEY-----\\n...\\n-----END PUBLIC KEY-----\"\n    }\n  },\n  \"steps\": {\n    \"build\": {\n      \"name\": \"build\",\n      \"attestations\": [\n        {\n          \"type\": \"https://witness.dev/attestations/git/v0.1\"\n        },\n        {\n          \"type\": \"https://witness.dev/attestations/command-run/v0.1\"\n        },\n        {\n          \"type\": \"https://witness.dev/attestations/product/v0.1\"\n        }\n      ],\n      \"functionaries\": [\n        {\n          \"type\": \"publickey\",\n          \"publickeyid\": \"ci-key\"\n        }\n      ]\n    },\n    \"test\": {\n      \"name\": \"test\",\n      \"attestations\": [\n        {\n          \"type\": \"https://witness.dev/attestations/material/v0.1\"\n        },\n        {\n          \"type\": \"https://witness.dev/attestations/command-run/v0.1\"\n        }\n      ],\n      \"functionaries\": [\n        {\n          \"type\": \"publickey\",\n          \"publickeyid\": \"ci-key\"\n        }\n      ]\n    },\n    \"package\": {\n      \"name\": \"package\",\n      \"attestations\": [\n        {\n          \"type\": \"https://witness.dev/attestations/material/v0.1\"\n        },\n        {\n          \"type\": \"https://witness.dev/attestations/product/v0.1\"\n        }\n      ],\n      \"functionaries\": [\n        {\n          \"type\": \"publickey\",\n          \"publickeyid\": \"ci-key\"\n        }\n      ]\n    }\n  }\n}\n```\n\n**Pipeline Commands:**\n\n```bash\n# Step 1: Build\nwitness run --step build \\\n  --attestations git,commandrun,product \\\n  -o build.json --key ci-key.pem \\\n  -- go build -o myapp\n\n# Step 2: Test\nwitness run --step test \\\n  --attestations material,commandrun \\\n  -o test.json --key ci-key.pem \\\n  -- go test ./...\n\n# Step 3: Package\nwitness run --step package \\\n  --attestations material,product \\\n  -o package.json --key ci-key.pem \\\n  -- tar czf myapp.tar.gz myapp\n\n# Verify entire pipeline\nwitness verify \\\n  --policy policy-signed.json \\\n  --publickey policy-key.pub \\\n  -a build.json -a test.json -a package.json\n```\n"}]}
{"messages": [{"role": "system", "content": "You are an expert in the Witness supply chain attestation framework. You help users instrument CI/CD pipelines with witness, create policy documents, and write Rego policies to validate attestations. You understand all attestors in go-witness and how to use them effectively."}, {"role": "user", "content": "How do I create a witness policy for a build step that uses these attestors: git, github, commandrun, material?"}, {"role": "assistant", "content": "Here's a complete witness policy for your build step with git, github, commandrun, material attestors:\n\n**Policy Document:**\n```json\n{\n  \"expires\": \"2026-11-08T10:52:59Z\",\n  \"publickeys\": {\n    \"build-key\": {\n      \"keyid\": \"sha256:7969e188e90c9d664d4d28a1abf487a21cde9eb40816f4d34487da4ea707e943\",\n      \"key\": \"-----BEGIN PUBLIC KEY-----\\n...\\n-----END PUBLIC KEY-----\"\n    }\n  },\n  \"steps\": {\n    \"build\": {\n      \"name\": \"build\",\n      \"attestations\": [\n        {\n          \"type\": \"https://witness.dev/attestations/git/v0.1\"\n        },\n        {\n          \"type\": \"https://witness.dev/attestations/github/v0.1\"\n        },\n        {\n          \"type\": \"https://witness.dev/attestations/command-run/v0.1\"\n        },\n        {\n          \"type\": \"https://witness.dev/attestations/material/v0.1\"\n        }\n      ],\n      \"functionaries\": [\n        {\n          \"type\": \"publickey\",\n          \"publickeyid\": \"build-key\"\n        }\n      ]\n    }\n  }\n}\n```\n\n**Witness Run Command:**\n```bash\nwitness run --step build \\\n  --attestations git,github,commandrun,material \\\n  --outfile build-attestation.json \\\n  --key signing-key.pem \\\n  -- <your-build-command>\n```\n\n**Rego Validation Rules:**\n```rego\npackage git\n\nimport rego.v1\n\n# Enforce builds from specific branch\ndeny contains msg if {\n    input.branch != \"master\"\n    msg := sprintf(\"Must build from master branch, got: %s\", [input.branch])\n}\n\n# Require clean working directory\ndeny contains msg if {\n    count(input.status) > 0\n    msg := \"Working directory must be clean (no uncommitted changes)\"\n}\n\n# Validate commit author\napproved_authors := {\n    \"alice.smith@example.com\",\n    \"bob.jones@company.com\",\n    \"ci-bot@company.com\"\n}\n\ndeny contains msg if {\n    not input.authoremail in approved_authors\n    msg := sprintf(\"Unauthorized commit author: %s\", [input.authoremail])\n}\n```\n\n**Verification:**\n```bash\nwitness verify \\\n  --policy policy-signed.json \\\n  --publickey policy-key.pub \\\n  -a build-attestation.json \\\n  --subject <artifact>\n```\n"}]}
{"messages": [{"role": "system", "content": "You are an expert in the Witness supply chain attestation framework. You help users instrument CI/CD pipelines with witness, create policy documents, and write Rego policies to validate attestations. You understand all attestors in go-witness and how to use them effectively."}, {"role": "user", "content": "How do I create a multi-step witness policy for a build \u2192 test \u2192 package pipeline?"}, {"role": "assistant", "content": "Here's a complete multi-step witness policy for your pipeline:\n\n**Policy Document:**\n```json\n{\n  \"expires\": \"2026-11-08T10:52:59Z\",\n  \"publickeys\": {\n    \"ci-key\": {\n      \"keyid\": \"sha256:6d81bf6981d3f7e0bbaf59cd7d940b8fadb3d09894158ac6ba9849835521207f\",\n      \"key\": \"-----BEGIN PUBLIC KEY-----\\n...\\n-----END PUBLIC KEY-----\"\n    }\n  },\n  \"steps\": {\n    \"build\": {\n      \"name\": \"build\",\n      \"attestations\": [\n        {\n          \"type\": \"https://witness.dev/attestations/git/v0.1\"\n        },\n        {\n          \"type\": \"https://witness.dev/attestations/command-run/v0.1\"\n        },\n        {\n          \"type\": \"https://witness.dev/attestations/product/v0.1\"\n        }\n      ],\n      \"functionaries\": [\n        {\n          \"type\": \"publickey\",\n          \"publickeyid\": \"ci-key\"\n        }\n      ]\n    },\n    \"test\": {\n      \"name\": \"test\",\n      \"attestations\": [\n        {\n          \"type\": \"https://witness.dev/attestations/material/v0.1\"\n        },\n        {\n          \"type\": \"https://witness.dev/attestations/command-run/v0.1\"\n        }\n      ],\n      \"functionaries\": [\n        {\n          \"type\": \"publickey\",\n          \"publickeyid\": \"ci-key\"\n        }\n      ]\n    },\n    \"package\": {\n      \"name\": \"package\",\n      \"attestations\": [\n        {\n          \"type\": \"https://witness.dev/attestations/material/v0.1\"\n        },\n        {\n          \"type\": \"https://witness.dev/attestations/product/v0.1\"\n        }\n      ],\n      \"functionaries\": [\n        {\n          \"type\": \"publickey\",\n          \"publickeyid\": \"ci-key\"\n        }\n      ]\n    }\n  }\n}\n```\n\n**Pipeline Commands:**\n\n```bash\n# Step 1: Build\nwitness run --step build \\\n  --attestations git,commandrun,product \\\n  -o build.json --key ci-key.pem \\\n  -- go build -o myapp\n\n# Step 2: Test\nwitness run --step test \\\n  --attestations material,commandrun \\\n  -o test.json --key ci-key.pem \\\n  -- go test ./...\n\n# Step 3: Package\nwitness run --step package \\\n  --attestations material,product \\\n  -o package.json --key ci-key.pem \\\n  -- tar czf myapp.tar.gz myapp\n\n# Verify entire pipeline\nwitness verify \\\n  --policy policy-signed.json \\\n  --publickey policy-key.pub \\\n  -a build.json -a test.json -a package.json\n```\n"}]}
{"messages": [{"role": "system", "content": "You are an expert in the Witness supply chain attestation framework. You help users instrument CI/CD pipelines with witness, create policy documents, and write Rego policies to validate attestations. You understand all attestors in go-witness and how to use them effectively."}, {"role": "user", "content": "How do I create a witness policy for a build step that uses these attestors: github?"}, {"role": "assistant", "content": "Here's a complete witness policy for your build step with github attestors:\n\n**Policy Document:**\n```json\n{\n  \"expires\": \"2026-11-08T10:52:59Z\",\n  \"publickeys\": {\n    \"build-key\": {\n      \"keyid\": \"sha256:b1357664b705254be1b6ac9bd61dba78144e1b0452e11773fbfbd93d60d6e1d6\",\n      \"key\": \"-----BEGIN PUBLIC KEY-----\\n...\\n-----END PUBLIC KEY-----\"\n    }\n  },\n  \"steps\": {\n    \"build\": {\n      \"name\": \"build\",\n      \"attestations\": [\n        {\n          \"type\": \"https://witness.dev/attestations/github/v0.1\"\n        }\n      ],\n      \"functionaries\": [\n        {\n          \"type\": \"publickey\",\n          \"publickeyid\": \"build-key\"\n        }\n      ]\n    }\n  }\n}\n```\n\n**Witness Run Command:**\n```bash\nwitness run --step build \\\n  --attestations github \\\n  --outfile build-attestation.json \\\n  --key signing-key.pem \\\n  -- <your-build-command>\n```\n\n**Rego Validation Rules:**\n```rego\n\n```\n\n**Verification:**\n```bash\nwitness verify \\\n  --policy policy-signed.json \\\n  --publickey policy-key.pub \\\n  -a build-attestation.json \\\n  --subject <artifact>\n```\n"}]}
{"messages": [{"role": "system", "content": "You are an expert in the Witness supply chain attestation framework. You help users instrument CI/CD pipelines with witness, create policy documents, and write Rego policies to validate attestations. You understand all attestors in go-witness and how to use them effectively."}, {"role": "user", "content": "How do I create a multi-step witness policy for a build \u2192 test \u2192 package pipeline?"}, {"role": "assistant", "content": "Here's a complete multi-step witness policy for your pipeline:\n\n**Policy Document:**\n```json\n{\n  \"expires\": \"2026-11-08T10:52:59Z\",\n  \"publickeys\": {\n    \"ci-key\": {\n      \"keyid\": \"sha256:e8d8bef9625cfbb6796d40b5c9bc9ab5a64c030976176e6510d662ebe32bc407\",\n      \"key\": \"-----BEGIN PUBLIC KEY-----\\n...\\n-----END PUBLIC KEY-----\"\n    }\n  },\n  \"steps\": {\n    \"build\": {\n      \"name\": \"build\",\n      \"attestations\": [\n        {\n          \"type\": \"https://witness.dev/attestations/git/v0.1\"\n        },\n        {\n          \"type\": \"https://witness.dev/attestations/command-run/v0.1\"\n        },\n        {\n          \"type\": \"https://witness.dev/attestations/product/v0.1\"\n        }\n      ],\n      \"functionaries\": [\n        {\n          \"type\": \"publickey\",\n          \"publickeyid\": \"ci-key\"\n        }\n      ]\n    },\n    \"test\": {\n      \"name\": \"test\",\n      \"attestations\": [\n        {\n          \"type\": \"https://witness.dev/attestations/material/v0.1\"\n        },\n        {\n          \"type\": \"https://witness.dev/attestations/command-run/v0.1\"\n        }\n      ],\n      \"functionaries\": [\n        {\n          \"type\": \"publickey\",\n          \"publickeyid\": \"ci-key\"\n        }\n      ]\n    },\n    \"package\": {\n      \"name\": \"package\",\n      \"attestations\": [\n        {\n          \"type\": \"https://witness.dev/attestations/material/v0.1\"\n        },\n        {\n          \"type\": \"https://witness.dev/attestations/product/v0.1\"\n        }\n      ],\n      \"functionaries\": [\n        {\n          \"type\": \"publickey\",\n          \"publickeyid\": \"ci-key\"\n        }\n      ]\n    }\n  }\n}\n```\n\n**Pipeline Commands:**\n\n```bash\n# Step 1: Build\nwitness run --step build \\\n  --attestations git,commandrun,product \\\n  -o build.json --key ci-key.pem \\\n  -- go build -o myapp\n\n# Step 2: Test\nwitness run --step test \\\n  --attestations material,commandrun \\\n  -o test.json --key ci-key.pem \\\n  -- go test ./...\n\n# Step 3: Package\nwitness run --step package \\\n  --attestations material,product \\\n  -o package.json --key ci-key.pem \\\n  -- tar czf myapp.tar.gz myapp\n\n# Verify entire pipeline\nwitness verify \\\n  --policy policy-signed.json \\\n  --publickey policy-key.pub \\\n  -a build.json -a test.json -a package.json\n```\n"}]}
{"messages": [{"role": "system", "content": "You are an expert in the Witness supply chain attestation framework. You help users instrument CI/CD pipelines with witness, create policy documents, and write Rego policies to validate attestations. You understand all attestors in go-witness and how to use them effectively."}, {"role": "user", "content": "How do I create a witness policy for a build step that uses these attestors: material, commandrun, git, environment, product?"}, {"role": "assistant", "content": "Here's a complete witness policy for your build step with material, commandrun, git, environment, product attestors:\n\n**Policy Document:**\n```json\n{\n  \"expires\": \"2026-11-08T10:52:59Z\",\n  \"publickeys\": {\n    \"build-key\": {\n      \"keyid\": \"sha256:13f113daac724486c9bf315270531f3e2b7a87829069ecef7f40495e70c8baec\",\n      \"key\": \"-----BEGIN PUBLIC KEY-----\\n...\\n-----END PUBLIC KEY-----\"\n    }\n  },\n  \"steps\": {\n    \"build\": {\n      \"name\": \"build\",\n      \"attestations\": [\n        {\n          \"type\": \"https://witness.dev/attestations/material/v0.1\"\n        },\n        {\n          \"type\": \"https://witness.dev/attestations/command-run/v0.1\"\n        },\n        {\n          \"type\": \"https://witness.dev/attestations/git/v0.1\"\n        },\n        {\n          \"type\": \"https://witness.dev/attestations/environment/v0.1\"\n        },\n        {\n          \"type\": \"https://witness.dev/attestations/product/v0.1\"\n        }\n      ],\n      \"functionaries\": [\n        {\n          \"type\": \"publickey\",\n          \"publickeyid\": \"build-key\"\n        }\n      ]\n    }\n  }\n}\n```\n\n**Witness Run Command:**\n```bash\nwitness run --step build \\\n  --attestations material,commandrun,git,environment,product \\\n  --outfile build-attestation.json \\\n  --key signing-key.pem \\\n  -- <your-build-command>\n```\n\n**Rego Validation Rules:**\n```rego\n\n```\n\n**Verification:**\n```bash\nwitness verify \\\n  --policy policy-signed.json \\\n  --publickey policy-key.pub \\\n  -a build-attestation.json \\\n  --subject <artifact>\n```\n"}]}
{"messages": [{"role": "system", "content": "You are an expert in the Witness supply chain attestation framework. You help users instrument CI/CD pipelines with witness, create policy documents, and write Rego policies to validate attestations. You understand all attestors in go-witness and how to use them effectively."}, {"role": "user", "content": "How do I create a witness policy for a build step that uses these attestors: commandrun, github, environment?"}, {"role": "assistant", "content": "Here's a complete witness policy for your build step with commandrun, github, environment attestors:\n\n**Policy Document:**\n```json\n{\n  \"expires\": \"2026-11-08T10:52:59Z\",\n  \"publickeys\": {\n    \"build-key\": {\n      \"keyid\": \"sha256:990ed39c5a324cb543bbc457ad8a14b2304cefcabee47384ff12f68325a120b0\",\n      \"key\": \"-----BEGIN PUBLIC KEY-----\\n...\\n-----END PUBLIC KEY-----\"\n    }\n  },\n  \"steps\": {\n    \"build\": {\n      \"name\": \"build\",\n      \"attestations\": [\n        {\n          \"type\": \"https://witness.dev/attestations/command-run/v0.1\"\n        },\n        {\n          \"type\": \"https://witness.dev/attestations/github/v0.1\"\n        },\n        {\n          \"type\": \"https://witness.dev/attestations/environment/v0.1\"\n        }\n      ],\n      \"functionaries\": [\n        {\n          \"type\": \"publickey\",\n          \"publickeyid\": \"build-key\"\n        }\n      ]\n    }\n  }\n}\n```\n\n**Witness Run Command:**\n```bash\nwitness run --step build \\\n  --attestations commandrun,github,environment \\\n  --outfile build-attestation.json \\\n  --key signing-key.pem \\\n  -- <your-build-command>\n```\n\n**Rego Validation Rules:**\n```rego\n\n```\n\n**Verification:**\n```bash\nwitness verify \\\n  --policy policy-signed.json \\\n  --publickey policy-key.pub \\\n  -a build-attestation.json \\\n  --subject <artifact>\n```\n"}]}
{"messages": [{"role": "system", "content": "You are an expert in the Witness supply chain attestation framework. You help users instrument CI/CD pipelines with witness, create policy documents, and write Rego policies to validate attestations. You understand all attestors in go-witness and how to use them effectively."}, {"role": "user", "content": "How do I create a witness policy for a build step that uses these attestors: git, github?"}, {"role": "assistant", "content": "Here's a complete witness policy for your build step with git, github attestors:\n\n**Policy Document:**\n```json\n{\n  \"expires\": \"2026-11-08T10:52:59Z\",\n  \"publickeys\": {\n    \"build-key\": {\n      \"keyid\": \"sha256:42b3118eca8cc68d0774436cb43f84adf433aef3579a3c10b2c5ac195a1a24f0\",\n      \"key\": \"-----BEGIN PUBLIC KEY-----\\n...\\n-----END PUBLIC KEY-----\"\n    }\n  },\n  \"steps\": {\n    \"build\": {\n      \"name\": \"build\",\n      \"attestations\": [\n        {\n          \"type\": \"https://witness.dev/attestations/git/v0.1\"\n        },\n        {\n          \"type\": \"https://witness.dev/attestations/github/v0.1\"\n        }\n      ],\n      \"functionaries\": [\n        {\n          \"type\": \"publickey\",\n          \"publickeyid\": \"build-key\"\n        }\n      ]\n    }\n  }\n}\n```\n\n**Witness Run Command:**\n```bash\nwitness run --step build \\\n  --attestations git,github \\\n  --outfile build-attestation.json \\\n  --key signing-key.pem \\\n  -- <your-build-command>\n```\n\n**Rego Validation Rules:**\n```rego\npackage git\n\nimport rego.v1\n\n# Enforce builds from specific branch\ndeny contains msg if {\n    input.branch != \"release/v1.0\"\n    msg := sprintf(\"Must build from release/v1.0 branch, got: %s\", [input.branch])\n}\n\n# Require clean working directory\ndeny contains msg if {\n    count(input.status) > 0\n    msg := \"Working directory must be clean (no uncommitted changes)\"\n}\n\n# Validate commit author\napproved_authors := {\n    \"alice.smith@example.com\",\n    \"bob.jones@company.com\",\n    \"ci-bot@company.com\"\n}\n\ndeny contains msg if {\n    not input.authoremail in approved_authors\n    msg := sprintf(\"Unauthorized commit author: %s\", [input.authoremail])\n}\n```\n\n**Verification:**\n```bash\nwitness verify \\\n  --policy policy-signed.json \\\n  --publickey policy-key.pub \\\n  -a build-attestation.json \\\n  --subject <artifact>\n```\n"}]}
{"messages": [{"role": "system", "content": "You are an expert in the Witness supply chain attestation framework. You help users instrument CI/CD pipelines with witness, create policy documents, and write Rego policies to validate attestations. You understand all attestors in go-witness and how to use them effectively."}, {"role": "user", "content": "How do I create a witness policy for a build step that uses these attestors: commandrun, material, environment, git?"}, {"role": "assistant", "content": "Here's a complete witness policy for your build step with commandrun, material, environment, git attestors:\n\n**Policy Document:**\n```json\n{\n  \"expires\": \"2026-11-08T10:52:59Z\",\n  \"publickeys\": {\n    \"build-key\": {\n      \"keyid\": \"sha256:c88eabfbb146c5483b11c2c79bc426e4b454ea52d53cc69bb805d37a45682a7d\",\n      \"key\": \"-----BEGIN PUBLIC KEY-----\\n...\\n-----END PUBLIC KEY-----\"\n    }\n  },\n  \"steps\": {\n    \"build\": {\n      \"name\": \"build\",\n      \"attestations\": [\n        {\n          \"type\": \"https://witness.dev/attestations/command-run/v0.1\"\n        },\n        {\n          \"type\": \"https://witness.dev/attestations/material/v0.1\"\n        },\n        {\n          \"type\": \"https://witness.dev/attestations/environment/v0.1\"\n        },\n        {\n          \"type\": \"https://witness.dev/attestations/git/v0.1\"\n        }\n      ],\n      \"functionaries\": [\n        {\n          \"type\": \"publickey\",\n          \"publickeyid\": \"build-key\"\n        }\n      ]\n    }\n  }\n}\n```\n\n**Witness Run Command:**\n```bash\nwitness run --step build \\\n  --attestations commandrun,material,environment,git \\\n  --outfile build-attestation.json \\\n  --key signing-key.pem \\\n  -- <your-build-command>\n```\n\n**Rego Validation Rules:**\n```rego\n\n```\n\n**Verification:**\n```bash\nwitness verify \\\n  --policy policy-signed.json \\\n  --publickey policy-key.pub \\\n  -a build-attestation.json \\\n  --subject <artifact>\n```\n"}]}
{"messages": [{"role": "system", "content": "You are an expert in the Witness supply chain attestation framework. You help users instrument CI/CD pipelines with witness, create policy documents, and write Rego policies to validate attestations. You understand all attestors in go-witness and how to use them effectively."}, {"role": "user", "content": "How do I create a witness policy for a build step that uses these attestors: git, product, github, environment, material?"}, {"role": "assistant", "content": "Here's a complete witness policy for your build step with git, product, github, environment, material attestors:\n\n**Policy Document:**\n```json\n{\n  \"expires\": \"2026-11-08T10:52:59Z\",\n  \"publickeys\": {\n    \"build-key\": {\n      \"keyid\": \"sha256:cbea7f40716c7b2056fc91f0139f125236d47819b064e80dce505218d07e64a4\",\n      \"key\": \"-----BEGIN PUBLIC KEY-----\\n...\\n-----END PUBLIC KEY-----\"\n    }\n  },\n  \"steps\": {\n    \"build\": {\n      \"name\": \"build\",\n      \"attestations\": [\n        {\n          \"type\": \"https://witness.dev/attestations/git/v0.1\"\n        },\n        {\n          \"type\": \"https://witness.dev/attestations/product/v0.1\"\n        },\n        {\n          \"type\": \"https://witness.dev/attestations/github/v0.1\"\n        },\n        {\n          \"type\": \"https://witness.dev/attestations/environment/v0.1\"\n        },\n        {\n          \"type\": \"https://witness.dev/attestations/material/v0.1\"\n        }\n      ],\n      \"functionaries\": [\n        {\n          \"type\": \"publickey\",\n          \"publickeyid\": \"build-key\"\n        }\n      ]\n    }\n  }\n}\n```\n\n**Witness Run Command:**\n```bash\nwitness run --step build \\\n  --attestations git,product,github,environment,material \\\n  --outfile build-attestation.json \\\n  --key signing-key.pem \\\n  -- <your-build-command>\n```\n\n**Rego Validation Rules:**\n```rego\npackage git\n\nimport rego.v1\n\n# Enforce builds from specific branch\ndeny contains msg if {\n    input.branch != \"develop\"\n    msg := sprintf(\"Must build from develop branch, got: %s\", [input.branch])\n}\n\n# Require clean working directory\ndeny contains msg if {\n    count(input.status) > 0\n    msg := \"Working directory must be clean (no uncommitted changes)\"\n}\n\n# Validate commit author\napproved_authors := {\n    \"alice.smith@example.com\",\n    \"bob.jones@company.com\",\n    \"ci-bot@company.com\"\n}\n\ndeny contains msg if {\n    not input.authoremail in approved_authors\n    msg := sprintf(\"Unauthorized commit author: %s\", [input.authoremail])\n}\n```\n\n**Verification:**\n```bash\nwitness verify \\\n  --policy policy-signed.json \\\n  --publickey policy-key.pub \\\n  -a build-attestation.json \\\n  --subject <artifact>\n```\n"}]}
{"messages": [{"role": "system", "content": "You are an expert in the Witness supply chain attestation framework. You help users instrument CI/CD pipelines with witness, create policy documents, and write Rego policies to validate attestations. You understand all attestors in go-witness and how to use them effectively."}, {"role": "user", "content": "How do I create a witness policy for a build step that uses these attestors: git, environment?"}, {"role": "assistant", "content": "Here's a complete witness policy for your build step with git, environment attestors:\n\n**Policy Document:**\n```json\n{\n  \"expires\": \"2026-11-08T10:52:59Z\",\n  \"publickeys\": {\n    \"build-key\": {\n      \"keyid\": \"sha256:1bac6c1cb0d7d8258b86c0841b4334d317a74e32e7645800e8caadf3a66a9e8b\",\n      \"key\": \"-----BEGIN PUBLIC KEY-----\\n...\\n-----END PUBLIC KEY-----\"\n    }\n  },\n  \"steps\": {\n    \"build\": {\n      \"name\": \"build\",\n      \"attestations\": [\n        {\n          \"type\": \"https://witness.dev/attestations/git/v0.1\"\n        },\n        {\n          \"type\": \"https://witness.dev/attestations/environment/v0.1\"\n        }\n      ],\n      \"functionaries\": [\n        {\n          \"type\": \"publickey\",\n          \"publickeyid\": \"build-key\"\n        }\n      ]\n    }\n  }\n}\n```\n\n**Witness Run Command:**\n```bash\nwitness run --step build \\\n  --attestations git,environment \\\n  --outfile build-attestation.json \\\n  --key signing-key.pem \\\n  -- <your-build-command>\n```\n\n**Rego Validation Rules:**\n```rego\npackage git\n\nimport rego.v1\n\n# Enforce builds from specific branch\ndeny contains msg if {\n    input.branch != \"feature/auth\"\n    msg := sprintf(\"Must build from feature/auth branch, got: %s\", [input.branch])\n}\n\n# Validate commit author\napproved_authors := {\n    \"alice.smith@example.com\",\n    \"bob.jones@company.com\",\n    \"ci-bot@company.com\"\n}\n\ndeny contains msg if {\n    not input.authoremail in approved_authors\n    msg := sprintf(\"Unauthorized commit author: %s\", [input.authoremail])\n}\n```\n\n**Verification:**\n```bash\nwitness verify \\\n  --policy policy-signed.json \\\n  --publickey policy-key.pub \\\n  -a build-attestation.json \\\n  --subject <artifact>\n```\n"}]}
{"messages": [{"role": "system", "content": "You are an expert in the Witness supply chain attestation framework. You help users instrument CI/CD pipelines with witness, create policy documents, and write Rego policies to validate attestations. You understand all attestors in go-witness and how to use them effectively."}, {"role": "user", "content": "How do I create a witness policy for a build step that uses these attestors: git, github?"}, {"role": "assistant", "content": "Here's a complete witness policy for your build step with git, github attestors:\n\n**Policy Document:**\n```json\n{\n  \"expires\": \"2026-11-08T10:52:59Z\",\n  \"publickeys\": {\n    \"build-key\": {\n      \"keyid\": \"sha256:46331214ebb7e0c240486d086d29f1667d2057d3a9f660a20c509e493047ed2a\",\n      \"key\": \"-----BEGIN PUBLIC KEY-----\\n...\\n-----END PUBLIC KEY-----\"\n    }\n  },\n  \"steps\": {\n    \"build\": {\n      \"name\": \"build\",\n      \"attestations\": [\n        {\n          \"type\": \"https://witness.dev/attestations/git/v0.1\"\n        },\n        {\n          \"type\": \"https://witness.dev/attestations/github/v0.1\"\n        }\n      ],\n      \"functionaries\": [\n        {\n          \"type\": \"publickey\",\n          \"publickeyid\": \"build-key\"\n        }\n      ]\n    }\n  }\n}\n```\n\n**Witness Run Command:**\n```bash\nwitness run --step build \\\n  --attestations git,github \\\n  --outfile build-attestation.json \\\n  --key signing-key.pem \\\n  -- <your-build-command>\n```\n\n**Rego Validation Rules:**\n```rego\npackage git\n\nimport rego.v1\n\n# Enforce builds from specific branch\ndeny contains msg if {\n    input.branch != \"feature/api\"\n    msg := sprintf(\"Must build from feature/api branch, got: %s\", [input.branch])\n}\n\n# Require clean working directory\ndeny contains msg if {\n    count(input.status) > 0\n    msg := \"Working directory must be clean (no uncommitted changes)\"\n}\n\n# Validate commit author\napproved_authors := {\n    \"alice.smith@example.com\",\n    \"bob.jones@company.com\",\n    \"ci-bot@company.com\"\n}\n\ndeny contains msg if {\n    not input.authoremail in approved_authors\n    msg := sprintf(\"Unauthorized commit author: %s\", [input.authoremail])\n}\n```\n\n**Verification:**\n```bash\nwitness verify \\\n  --policy policy-signed.json \\\n  --publickey policy-key.pub \\\n  -a build-attestation.json \\\n  --subject <artifact>\n```\n"}]}
{"messages": [{"role": "system", "content": "You are an expert in the Witness supply chain attestation framework. You help users instrument CI/CD pipelines with witness, create policy documents, and write Rego policies to validate attestations. You understand all attestors in go-witness and how to use them effectively."}, {"role": "user", "content": "How do I create a witness policy for a build step that uses these attestors: material, commandrun, github?"}, {"role": "assistant", "content": "Here's a complete witness policy for your build step with material, commandrun, github attestors:\n\n**Policy Document:**\n```json\n{\n  \"expires\": \"2026-11-08T10:52:59Z\",\n  \"publickeys\": {\n    \"build-key\": {\n      \"keyid\": \"sha256:38f03e09b2667accd32b37fa22ae625cc38c6644dc0b0595699f7d3147632b21\",\n      \"key\": \"-----BEGIN PUBLIC KEY-----\\n...\\n-----END PUBLIC KEY-----\"\n    }\n  },\n  \"steps\": {\n    \"build\": {\n      \"name\": \"build\",\n      \"attestations\": [\n        {\n          \"type\": \"https://witness.dev/attestations/material/v0.1\"\n        },\n        {\n          \"type\": \"https://witness.dev/attestations/command-run/v0.1\"\n        },\n        {\n          \"type\": \"https://witness.dev/attestations/github/v0.1\"\n        }\n      ],\n      \"functionaries\": [\n        {\n          \"type\": \"publickey\",\n          \"publickeyid\": \"build-key\"\n        }\n      ]\n    }\n  }\n}\n```\n\n**Witness Run Command:**\n```bash\nwitness run --step build \\\n  --attestations material,commandrun,github \\\n  --outfile build-attestation.json \\\n  --key signing-key.pem \\\n  -- <your-build-command>\n```\n\n**Rego Validation Rules:**\n```rego\n\n```\n\n**Verification:**\n```bash\nwitness verify \\\n  --policy policy-signed.json \\\n  --publickey policy-key.pub \\\n  -a build-attestation.json \\\n  --subject <artifact>\n```\n"}]}
{"messages": [{"role": "system", "content": "You are an expert in the Witness supply chain attestation framework. You help users instrument CI/CD pipelines with witness, create policy documents, and write Rego policies to validate attestations. You understand all attestors in go-witness and how to use them effectively."}, {"role": "user", "content": "How do I create a witness policy for a build step that uses these attestors: git?"}, {"role": "assistant", "content": "Here's a complete witness policy for your build step with git attestors:\n\n**Policy Document:**\n```json\n{\n  \"expires\": \"2026-11-08T10:52:59Z\",\n  \"publickeys\": {\n    \"build-key\": {\n      \"keyid\": \"sha256:4c1d74880a662bf48daf66abf4301a87cddaad4f8333625b707af61f1ec9b592\",\n      \"key\": \"-----BEGIN PUBLIC KEY-----\\n...\\n-----END PUBLIC KEY-----\"\n    }\n  },\n  \"steps\": {\n    \"build\": {\n      \"name\": \"build\",\n      \"attestations\": [\n        {\n          \"type\": \"https://witness.dev/attestations/git/v0.1\"\n        }\n      ],\n      \"functionaries\": [\n        {\n          \"type\": \"publickey\",\n          \"publickeyid\": \"build-key\"\n        }\n      ]\n    }\n  }\n}\n```\n\n**Witness Run Command:**\n```bash\nwitness run --step build \\\n  --attestations git \\\n  --outfile build-attestation.json \\\n  --key signing-key.pem \\\n  -- <your-build-command>\n```\n\n**Rego Validation Rules:**\n```rego\npackage git\n\nimport rego.v1\n\n# Enforce builds from specific branch\ndeny contains msg if {\n    input.branch != \"hotfix/critical\"\n    msg := sprintf(\"Must build from hotfix/critical branch, got: %s\", [input.branch])\n}\n\n# Require clean working directory\ndeny contains msg if {\n    count(input.status) > 0\n    msg := \"Working directory must be clean (no uncommitted changes)\"\n}\n\n# Validate commit author\napproved_authors := {\n    \"alice.smith@example.com\",\n    \"bob.jones@company.com\",\n    \"ci-bot@company.com\"\n}\n\ndeny contains msg if {\n    not input.authoremail in approved_authors\n    msg := sprintf(\"Unauthorized commit author: %s\", [input.authoremail])\n}\n```\n\n**Verification:**\n```bash\nwitness verify \\\n  --policy policy-signed.json \\\n  --publickey policy-key.pub \\\n  -a build-attestation.json \\\n  --subject <artifact>\n```\n"}]}
{"messages": [{"role": "system", "content": "You are an expert in the Witness supply chain attestation framework. You help users instrument CI/CD pipelines with witness, create policy documents, and write Rego policies to validate attestations. You understand all attestors in go-witness and how to use them effectively."}, {"role": "user", "content": "How do I create a witness policy for a build step that uses these attestors: material, github?"}, {"role": "assistant", "content": "Here's a complete witness policy for your build step with material, github attestors:\n\n**Policy Document:**\n```json\n{\n  \"expires\": \"2026-11-08T10:52:59Z\",\n  \"publickeys\": {\n    \"build-key\": {\n      \"keyid\": \"sha256:c0eff29f1d869c8936404674593286354e6e0b63afe2f6a3a27f05f7d57f2c0a\",\n      \"key\": \"-----BEGIN PUBLIC KEY-----\\n...\\n-----END PUBLIC KEY-----\"\n    }\n  },\n  \"steps\": {\n    \"build\": {\n      \"name\": \"build\",\n      \"attestations\": [\n        {\n          \"type\": \"https://witness.dev/attestations/material/v0.1\"\n        },\n        {\n          \"type\": \"https://witness.dev/attestations/github/v0.1\"\n        }\n      ],\n      \"functionaries\": [\n        {\n          \"type\": \"publickey\",\n          \"publickeyid\": \"build-key\"\n        }\n      ]\n    }\n  }\n}\n```\n\n**Witness Run Command:**\n```bash\nwitness run --step build \\\n  --attestations material,github \\\n  --outfile build-attestation.json \\\n  --key signing-key.pem \\\n  -- <your-build-command>\n```\n\n**Rego Validation Rules:**\n```rego\n\n```\n\n**Verification:**\n```bash\nwitness verify \\\n  --policy policy-signed.json \\\n  --publickey policy-key.pub \\\n  -a build-attestation.json \\\n  --subject <artifact>\n```\n"}]}
{"messages": [{"role": "system", "content": "You are an expert in the Witness supply chain attestation framework. You help users instrument CI/CD pipelines with witness, create policy documents, and write Rego policies to validate attestations. You understand all attestors in go-witness and how to use them effectively."}, {"role": "user", "content": "How do I create a witness policy for a build step that uses these attestors: git, material, product, environment?"}, {"role": "assistant", "content": "Here's a complete witness policy for your build step with git, material, product, environment attestors:\n\n**Policy Document:**\n```json\n{\n  \"expires\": \"2026-11-08T10:52:59Z\",\n  \"publickeys\": {\n    \"build-key\": {\n      \"keyid\": \"sha256:c5b37f743c1779b71ae1dcd5620ad7dfcc25746c25fae048924a6fd1be2b0941\",\n      \"key\": \"-----BEGIN PUBLIC KEY-----\\n...\\n-----END PUBLIC KEY-----\"\n    }\n  },\n  \"steps\": {\n    \"build\": {\n      \"name\": \"build\",\n      \"attestations\": [\n        {\n          \"type\": \"https://witness.dev/attestations/git/v0.1\"\n        },\n        {\n          \"type\": \"https://witness.dev/attestations/material/v0.1\"\n        },\n        {\n          \"type\": \"https://witness.dev/attestations/product/v0.1\"\n        },\n        {\n          \"type\": \"https://witness.dev/attestations/environment/v0.1\"\n        }\n      ],\n      \"functionaries\": [\n        {\n          \"type\": \"publickey\",\n          \"publickeyid\": \"build-key\"\n        }\n      ]\n    }\n  }\n}\n```\n\n**Witness Run Command:**\n```bash\nwitness run --step build \\\n  --attestations git,material,product,environment \\\n  --outfile build-attestation.json \\\n  --key signing-key.pem \\\n  -- <your-build-command>\n```\n\n**Rego Validation Rules:**\n```rego\npackage git\n\nimport rego.v1\n\n# Enforce builds from specific branch\ndeny contains msg if {\n    input.branch != \"feature/auth\"\n    msg := sprintf(\"Must build from feature/auth branch, got: %s\", [input.branch])\n}\n\n# Require clean working directory\ndeny contains msg if {\n    count(input.status) > 0\n    msg := \"Working directory must be clean (no uncommitted changes)\"\n}\n\n# Validate commit author\napproved_authors := {\n    \"alice.smith@example.com\",\n    \"bob.jones@company.com\",\n    \"ci-bot@company.com\"\n}\n\ndeny contains msg if {\n    not input.authoremail in approved_authors\n    msg := sprintf(\"Unauthorized commit author: %s\", [input.authoremail])\n}\n```\n\n**Verification:**\n```bash\nwitness verify \\\n  --policy policy-signed.json \\\n  --publickey policy-key.pub \\\n  -a build-attestation.json \\\n  --subject <artifact>\n```\n"}]}
{"messages": [{"role": "system", "content": "You are an expert in the Witness supply chain attestation framework. You help users instrument CI/CD pipelines with witness, create policy documents, and write Rego policies to validate attestations. You understand all attestors in go-witness and how to use them effectively."}, {"role": "user", "content": "How do I create a witness policy for a build step that uses these attestors: commandrun?"}, {"role": "assistant", "content": "Here's a complete witness policy for your build step with commandrun attestors:\n\n**Policy Document:**\n```json\n{\n  \"expires\": \"2026-11-08T10:52:59Z\",\n  \"publickeys\": {\n    \"build-key\": {\n      \"keyid\": \"sha256:f08b3235542c45208963def01639e69da7769305ab12aa29ece38530335f25e8\",\n      \"key\": \"-----BEGIN PUBLIC KEY-----\\n...\\n-----END PUBLIC KEY-----\"\n    }\n  },\n  \"steps\": {\n    \"build\": {\n      \"name\": \"build\",\n      \"attestations\": [\n        {\n          \"type\": \"https://witness.dev/attestations/command-run/v0.1\"\n        }\n      ],\n      \"functionaries\": [\n        {\n          \"type\": \"publickey\",\n          \"publickeyid\": \"build-key\"\n        }\n      ]\n    }\n  }\n}\n```\n\n**Witness Run Command:**\n```bash\nwitness run --step build \\\n  --attestations commandrun \\\n  --outfile build-attestation.json \\\n  --key signing-key.pem \\\n  -- <your-build-command>\n```\n\n**Rego Validation Rules:**\n```rego\n\n```\n\n**Verification:**\n```bash\nwitness verify \\\n  --policy policy-signed.json \\\n  --publickey policy-key.pub \\\n  -a build-attestation.json \\\n  --subject <artifact>\n```\n"}]}
{"messages": [{"role": "system", "content": "You are an expert in the Witness supply chain attestation framework. You help users instrument CI/CD pipelines with witness, create policy documents, and write Rego policies to validate attestations. You understand all attestors in go-witness and how to use them effectively."}, {"role": "user", "content": "How do I create a witness policy for a build step that uses these attestors: github, material, environment, product?"}, {"role": "assistant", "content": "Here's a complete witness policy for your build step with github, material, environment, product attestors:\n\n**Policy Document:**\n```json\n{\n  \"expires\": \"2026-11-08T10:52:59Z\",\n  \"publickeys\": {\n    \"build-key\": {\n      \"keyid\": \"sha256:03fb87dca2808025df6bdca513f4d8d3dcaa4259f46eff1ba68f76cda9e1d945\",\n      \"key\": \"-----BEGIN PUBLIC KEY-----\\n...\\n-----END PUBLIC KEY-----\"\n    }\n  },\n  \"steps\": {\n    \"build\": {\n      \"name\": \"build\",\n      \"attestations\": [\n        {\n          \"type\": \"https://witness.dev/attestations/github/v0.1\"\n        },\n        {\n          \"type\": \"https://witness.dev/attestations/material/v0.1\"\n        },\n        {\n          \"type\": \"https://witness.dev/attestations/environment/v0.1\"\n        },\n        {\n          \"type\": \"https://witness.dev/attestations/product/v0.1\"\n        }\n      ],\n      \"functionaries\": [\n        {\n          \"type\": \"publickey\",\n          \"publickeyid\": \"build-key\"\n        }\n      ]\n    }\n  }\n}\n```\n\n**Witness Run Command:**\n```bash\nwitness run --step build \\\n  --attestations github,material,environment,product \\\n  --outfile build-attestation.json \\\n  --key signing-key.pem \\\n  -- <your-build-command>\n```\n\n**Rego Validation Rules:**\n```rego\n\n```\n\n**Verification:**\n```bash\nwitness verify \\\n  --policy policy-signed.json \\\n  --publickey policy-key.pub \\\n  -a build-attestation.json \\\n  --subject <artifact>\n```\n"}]}
{"messages": [{"role": "system", "content": "You are an expert in the Witness supply chain attestation framework. You help users instrument CI/CD pipelines with witness, create policy documents, and write Rego policies to validate attestations. You understand all attestors in go-witness and how to use them effectively."}, {"role": "user", "content": "How do I create a witness policy for a build step that uses these attestors: github?"}, {"role": "assistant", "content": "Here's a complete witness policy for your build step with github attestors:\n\n**Policy Document:**\n```json\n{\n  \"expires\": \"2026-11-08T10:52:59Z\",\n  \"publickeys\": {\n    \"build-key\": {\n      \"keyid\": \"sha256:3e7e4aa0441dccfe110f1b2d7d9a7c291f622ed3a9e4929fa169626e20e54396\",\n      \"key\": \"-----BEGIN PUBLIC KEY-----\\n...\\n-----END PUBLIC KEY-----\"\n    }\n  },\n  \"steps\": {\n    \"build\": {\n      \"name\": \"build\",\n      \"attestations\": [\n        {\n          \"type\": \"https://witness.dev/attestations/github/v0.1\"\n        }\n      ],\n      \"functionaries\": [\n        {\n          \"type\": \"publickey\",\n          \"publickeyid\": \"build-key\"\n        }\n      ]\n    }\n  }\n}\n```\n\n**Witness Run Command:**\n```bash\nwitness run --step build \\\n  --attestations github \\\n  --outfile build-attestation.json \\\n  --key signing-key.pem \\\n  -- <your-build-command>\n```\n\n**Rego Validation Rules:**\n```rego\n\n```\n\n**Verification:**\n```bash\nwitness verify \\\n  --policy policy-signed.json \\\n  --publickey policy-key.pub \\\n  -a build-attestation.json \\\n  --subject <artifact>\n```\n"}]}
{"messages": [{"role": "system", "content": "You are an expert in the Witness supply chain attestation framework. You help users instrument CI/CD pipelines with witness, create policy documents, and write Rego policies to validate attestations. You understand all attestors in go-witness and how to use them effectively."}, {"role": "user", "content": "How do I create a multi-step witness policy for a build \u2192 test \u2192 package pipeline?"}, {"role": "assistant", "content": "Here's a complete multi-step witness policy for your pipeline:\n\n**Policy Document:**\n```json\n{\n  \"expires\": \"2026-11-08T10:52:59Z\",\n  \"publickeys\": {\n    \"ci-key\": {\n      \"keyid\": \"sha256:ca11c332492122f718af46e9fc7cbb4850dfbc6c5ceedcabf505c5b4b3f3c9e1\",\n      \"key\": \"-----BEGIN PUBLIC KEY-----\\n...\\n-----END PUBLIC KEY-----\"\n    }\n  },\n  \"steps\": {\n    \"build\": {\n      \"name\": \"build\",\n      \"attestations\": [\n        {\n          \"type\": \"https://witness.dev/attestations/git/v0.1\"\n        },\n        {\n          \"type\": \"https://witness.dev/attestations/command-run/v0.1\"\n        },\n        {\n          \"type\": \"https://witness.dev/attestations/product/v0.1\"\n        }\n      ],\n      \"functionaries\": [\n        {\n          \"type\": \"publickey\",\n          \"publickeyid\": \"ci-key\"\n        }\n      ]\n    },\n    \"test\": {\n      \"name\": \"test\",\n      \"attestations\": [\n        {\n          \"type\": \"https://witness.dev/attestations/material/v0.1\"\n        },\n        {\n          \"type\": \"https://witness.dev/attestations/command-run/v0.1\"\n        }\n      ],\n      \"functionaries\": [\n        {\n          \"type\": \"publickey\",\n          \"publickeyid\": \"ci-key\"\n        }\n      ]\n    },\n    \"package\": {\n      \"name\": \"package\",\n      \"attestations\": [\n        {\n          \"type\": \"https://witness.dev/attestations/material/v0.1\"\n        },\n        {\n          \"type\": \"https://witness.dev/attestations/product/v0.1\"\n        }\n      ],\n      \"functionaries\": [\n        {\n          \"type\": \"publickey\",\n          \"publickeyid\": \"ci-key\"\n        }\n      ]\n    }\n  }\n}\n```\n\n**Pipeline Commands:**\n\n```bash\n# Step 1: Build\nwitness run --step build \\\n  --attestations git,commandrun,product \\\n  -o build.json --key ci-key.pem \\\n  -- go build -o myapp\n\n# Step 2: Test\nwitness run --step test \\\n  --attestations material,commandrun \\\n  -o test.json --key ci-key.pem \\\n  -- go test ./...\n\n# Step 3: Package\nwitness run --step package \\\n  --attestations material,product \\\n  -o package.json --key ci-key.pem \\\n  -- tar czf myapp.tar.gz myapp\n\n# Verify entire pipeline\nwitness verify \\\n  --policy policy-signed.json \\\n  --publickey policy-key.pub \\\n  -a build.json -a test.json -a package.json\n```\n"}]}
{"messages": [{"role": "system", "content": "You are an expert in the Witness supply chain attestation framework. You help users instrument CI/CD pipelines with witness, create policy documents, and write Rego policies to validate attestations. You understand all attestors in go-witness and how to use them effectively."}, {"role": "user", "content": "How do I create a witness policy for a build step that uses these attestors: github, git, product, environment?"}, {"role": "assistant", "content": "Here's a complete witness policy for your build step with github, git, product, environment attestors:\n\n**Policy Document:**\n```json\n{\n  \"expires\": \"2026-11-08T10:52:59Z\",\n  \"publickeys\": {\n    \"build-key\": {\n      \"keyid\": \"sha256:3788a46ebfa9acf0dd4ff08af436b89ec1fb169483ed030b42633bec2a405887\",\n      \"key\": \"-----BEGIN PUBLIC KEY-----\\n...\\n-----END PUBLIC KEY-----\"\n    }\n  },\n  \"steps\": {\n    \"build\": {\n      \"name\": \"build\",\n      \"attestations\": [\n        {\n          \"type\": \"https://witness.dev/attestations/github/v0.1\"\n        },\n        {\n          \"type\": \"https://witness.dev/attestations/git/v0.1\"\n        },\n        {\n          \"type\": \"https://witness.dev/attestations/product/v0.1\"\n        },\n        {\n          \"type\": \"https://witness.dev/attestations/environment/v0.1\"\n        }\n      ],\n      \"functionaries\": [\n        {\n          \"type\": \"publickey\",\n          \"publickeyid\": \"build-key\"\n        }\n      ]\n    }\n  }\n}\n```\n\n**Witness Run Command:**\n```bash\nwitness run --step build \\\n  --attestations github,git,product,environment \\\n  --outfile build-attestation.json \\\n  --key signing-key.pem \\\n  -- <your-build-command>\n```\n\n**Rego Validation Rules:**\n```rego\n\n```\n\n**Verification:**\n```bash\nwitness verify \\\n  --policy policy-signed.json \\\n  --publickey policy-key.pub \\\n  -a build-attestation.json \\\n  --subject <artifact>\n```\n"}]}
{"messages": [{"role": "system", "content": "You are an expert in the Witness supply chain attestation framework. You help users instrument CI/CD pipelines with witness, create policy documents, and write Rego policies to validate attestations. You understand all attestors in go-witness and how to use them effectively."}, {"role": "user", "content": "How do I create a witness policy for a build step that uses these attestors: material?"}, {"role": "assistant", "content": "Here's a complete witness policy for your build step with material attestors:\n\n**Policy Document:**\n```json\n{\n  \"expires\": \"2026-11-08T10:52:59Z\",\n  \"publickeys\": {\n    \"build-key\": {\n      \"keyid\": \"sha256:0caac0529a1ab488fe6ed6758f40014d7dab96a2102db36770e65fe92ca6a221\",\n      \"key\": \"-----BEGIN PUBLIC KEY-----\\n...\\n-----END PUBLIC KEY-----\"\n    }\n  },\n  \"steps\": {\n    \"build\": {\n      \"name\": \"build\",\n      \"attestations\": [\n        {\n          \"type\": \"https://witness.dev/attestations/material/v0.1\"\n        }\n      ],\n      \"functionaries\": [\n        {\n          \"type\": \"publickey\",\n          \"publickeyid\": \"build-key\"\n        }\n      ]\n    }\n  }\n}\n```\n\n**Witness Run Command:**\n```bash\nwitness run --step build \\\n  --attestations material \\\n  --outfile build-attestation.json \\\n  --key signing-key.pem \\\n  -- <your-build-command>\n```\n\n**Rego Validation Rules:**\n```rego\n\n```\n\n**Verification:**\n```bash\nwitness verify \\\n  --policy policy-signed.json \\\n  --publickey policy-key.pub \\\n  -a build-attestation.json \\\n  --subject <artifact>\n```\n"}]}
{"messages": [{"role": "system", "content": "You are an expert in the Witness supply chain attestation framework. You help users instrument CI/CD pipelines with witness, create policy documents, and write Rego policies to validate attestations. You understand all attestors in go-witness and how to use them effectively."}, {"role": "user", "content": "How do I create a witness policy for a build step that uses these attestors: environment?"}, {"role": "assistant", "content": "Here's a complete witness policy for your build step with environment attestors:\n\n**Policy Document:**\n```json\n{\n  \"expires\": \"2026-11-08T10:52:59Z\",\n  \"publickeys\": {\n    \"build-key\": {\n      \"keyid\": \"sha256:6ea58923122d7fd3ce0c0b942fbb47a4eb59e9f22036f344d85c85adff00d395\",\n      \"key\": \"-----BEGIN PUBLIC KEY-----\\n...\\n-----END PUBLIC KEY-----\"\n    }\n  },\n  \"steps\": {\n    \"build\": {\n      \"name\": \"build\",\n      \"attestations\": [\n        {\n          \"type\": \"https://witness.dev/attestations/environment/v0.1\"\n        }\n      ],\n      \"functionaries\": [\n        {\n          \"type\": \"publickey\",\n          \"publickeyid\": \"build-key\"\n        }\n      ]\n    }\n  }\n}\n```\n\n**Witness Run Command:**\n```bash\nwitness run --step build \\\n  --attestations environment \\\n  --outfile build-attestation.json \\\n  --key signing-key.pem \\\n  -- <your-build-command>\n```\n\n**Rego Validation Rules:**\n```rego\npackage environment\n\nimport rego.v1\n\n# Ensure correct OS\ndeny contains msg if {\n    input.os != \"linux\"\n    msg := sprintf(\"Must run on linux, got: %s\", [input.os])\n}\n\n# Require CI environment\ndeny contains msg if {\n    not \"CI\" in input.variables\n    msg := \"Must run in CI environment (CI variable not set)\"\n}\n```\n\n**Verification:**\n```bash\nwitness verify \\\n  --policy policy-signed.json \\\n  --publickey policy-key.pub \\\n  -a build-attestation.json \\\n  --subject <artifact>\n```\n"}]}
{"messages": [{"role": "system", "content": "You are an expert in the Witness supply chain attestation framework. You help users instrument CI/CD pipelines with witness, create policy documents, and write Rego policies to validate attestations. You understand all attestors in go-witness and how to use them effectively."}, {"role": "user", "content": "How do I create a witness policy for a build step that uses these attestors: git, product, material, github?"}, {"role": "assistant", "content": "Here's a complete witness policy for your build step with git, product, material, github attestors:\n\n**Policy Document:**\n```json\n{\n  \"expires\": \"2026-11-08T10:52:59Z\",\n  \"publickeys\": {\n    \"build-key\": {\n      \"keyid\": \"sha256:f0df23bb6ed73e2d358710938a9c7ccfdb45400d167c02faafe7154ab54304d2\",\n      \"key\": \"-----BEGIN PUBLIC KEY-----\\n...\\n-----END PUBLIC KEY-----\"\n    }\n  },\n  \"steps\": {\n    \"build\": {\n      \"name\": \"build\",\n      \"attestations\": [\n        {\n          \"type\": \"https://witness.dev/attestations/git/v0.1\"\n        },\n        {\n          \"type\": \"https://witness.dev/attestations/product/v0.1\"\n        },\n        {\n          \"type\": \"https://witness.dev/attestations/material/v0.1\"\n        },\n        {\n          \"type\": \"https://witness.dev/attestations/github/v0.1\"\n        }\n      ],\n      \"functionaries\": [\n        {\n          \"type\": \"publickey\",\n          \"publickeyid\": \"build-key\"\n        }\n      ]\n    }\n  }\n}\n```\n\n**Witness Run Command:**\n```bash\nwitness run --step build \\\n  --attestations git,product,material,github \\\n  --outfile build-attestation.json \\\n  --key signing-key.pem \\\n  -- <your-build-command>\n```\n\n**Rego Validation Rules:**\n```rego\npackage git\n\nimport rego.v1\n\n# Enforce builds from specific branch\ndeny contains msg if {\n    input.branch != \"feature/auth\"\n    msg := sprintf(\"Must build from feature/auth branch, got: %s\", [input.branch])\n}\n\n# Require clean working directory\ndeny contains msg if {\n    count(input.status) > 0\n    msg := \"Working directory must be clean (no uncommitted changes)\"\n}\n\n# Validate commit author\napproved_authors := {\n    \"alice.smith@example.com\",\n    \"bob.jones@company.com\",\n    \"ci-bot@company.com\"\n}\n\ndeny contains msg if {\n    not input.authoremail in approved_authors\n    msg := sprintf(\"Unauthorized commit author: %s\", [input.authoremail])\n}\n```\n\n**Verification:**\n```bash\nwitness verify \\\n  --policy policy-signed.json \\\n  --publickey policy-key.pub \\\n  -a build-attestation.json \\\n  --subject <artifact>\n```\n"}]}
{"messages": [{"role": "system", "content": "You are an expert in the Witness supply chain attestation framework. You help users instrument CI/CD pipelines with witness, create policy documents, and write Rego policies to validate attestations. You understand all attestors in go-witness and how to use them effectively."}, {"role": "user", "content": "How do I create a multi-step witness policy for a build \u2192 test \u2192 package pipeline?"}, {"role": "assistant", "content": "Here's a complete multi-step witness policy for your pipeline:\n\n**Policy Document:**\n```json\n{\n  \"expires\": \"2026-11-08T10:52:59Z\",\n  \"publickeys\": {\n    \"ci-key\": {\n      \"keyid\": \"sha256:d8a1369e9550427c43a3b8619acd651ad04391fd28222ee82753d778bca67acf\",\n      \"key\": \"-----BEGIN PUBLIC KEY-----\\n...\\n-----END PUBLIC KEY-----\"\n    }\n  },\n  \"steps\": {\n    \"build\": {\n      \"name\": \"build\",\n      \"attestations\": [\n        {\n          \"type\": \"https://witness.dev/attestations/git/v0.1\"\n        },\n        {\n          \"type\": \"https://witness.dev/attestations/command-run/v0.1\"\n        },\n        {\n          \"type\": \"https://witness.dev/attestations/product/v0.1\"\n        }\n      ],\n      \"functionaries\": [\n        {\n          \"type\": \"publickey\",\n          \"publickeyid\": \"ci-key\"\n        }\n      ]\n    },\n    \"test\": {\n      \"name\": \"test\",\n      \"attestations\": [\n        {\n          \"type\": \"https://witness.dev/attestations/material/v0.1\"\n        },\n        {\n          \"type\": \"https://witness.dev/attestations/command-run/v0.1\"\n        }\n      ],\n      \"functionaries\": [\n        {\n          \"type\": \"publickey\",\n          \"publickeyid\": \"ci-key\"\n        }\n      ]\n    },\n    \"package\": {\n      \"name\": \"package\",\n      \"attestations\": [\n        {\n          \"type\": \"https://witness.dev/attestations/material/v0.1\"\n        },\n        {\n          \"type\": \"https://witness.dev/attestations/product/v0.1\"\n        }\n      ],\n      \"functionaries\": [\n        {\n          \"type\": \"publickey\",\n          \"publickeyid\": \"ci-key\"\n        }\n      ]\n    }\n  }\n}\n```\n\n**Pipeline Commands:**\n\n```bash\n# Step 1: Build\nwitness run --step build \\\n  --attestations git,commandrun,product \\\n  -o build.json --key ci-key.pem \\\n  -- go build -o myapp\n\n# Step 2: Test\nwitness run --step test \\\n  --attestations material,commandrun \\\n  -o test.json --key ci-key.pem \\\n  -- go test ./...\n\n# Step 3: Package\nwitness run --step package \\\n  --attestations material,product \\\n  -o package.json --key ci-key.pem \\\n  -- tar czf myapp.tar.gz myapp\n\n# Verify entire pipeline\nwitness verify \\\n  --policy policy-signed.json \\\n  --publickey policy-key.pub \\\n  -a build.json -a test.json -a package.json\n```\n"}]}
{"messages": [{"role": "system", "content": "You are an expert in the Witness supply chain attestation framework. You help users instrument CI/CD pipelines with witness, create policy documents, and write Rego policies to validate attestations. You understand all attestors in go-witness and how to use them effectively."}, {"role": "user", "content": "How do I create a multi-step witness policy for a build \u2192 test \u2192 package pipeline?"}, {"role": "assistant", "content": "Here's a complete multi-step witness policy for your pipeline:\n\n**Policy Document:**\n```json\n{\n  \"expires\": \"2026-11-08T10:52:59Z\",\n  \"publickeys\": {\n    \"ci-key\": {\n      \"keyid\": \"sha256:a3ad8c3db4ba488af3b57941780fbb618a108149aa8886094c50c9dae3406ecd\",\n      \"key\": \"-----BEGIN PUBLIC KEY-----\\n...\\n-----END PUBLIC KEY-----\"\n    }\n  },\n  \"steps\": {\n    \"build\": {\n      \"name\": \"build\",\n      \"attestations\": [\n        {\n          \"type\": \"https://witness.dev/attestations/git/v0.1\"\n        },\n        {\n          \"type\": \"https://witness.dev/attestations/command-run/v0.1\"\n        },\n        {\n          \"type\": \"https://witness.dev/attestations/product/v0.1\"\n        }\n      ],\n      \"functionaries\": [\n        {\n          \"type\": \"publickey\",\n          \"publickeyid\": \"ci-key\"\n        }\n      ]\n    },\n    \"test\": {\n      \"name\": \"test\",\n      \"attestations\": [\n        {\n          \"type\": \"https://witness.dev/attestations/material/v0.1\"\n        },\n        {\n          \"type\": \"https://witness.dev/attestations/command-run/v0.1\"\n        }\n      ],\n      \"functionaries\": [\n        {\n          \"type\": \"publickey\",\n          \"publickeyid\": \"ci-key\"\n        }\n      ]\n    },\n    \"package\": {\n      \"name\": \"package\",\n      \"attestations\": [\n        {\n          \"type\": \"https://witness.dev/attestations/material/v0.1\"\n        },\n        {\n          \"type\": \"https://witness.dev/attestations/product/v0.1\"\n        }\n      ],\n      \"functionaries\": [\n        {\n          \"type\": \"publickey\",\n          \"publickeyid\": \"ci-key\"\n        }\n      ]\n    }\n  }\n}\n```\n\n**Pipeline Commands:**\n\n```bash\n# Step 1: Build\nwitness run --step build \\\n  --attestations git,commandrun,product \\\n  -o build.json --key ci-key.pem \\\n  -- go build -o myapp\n\n# Step 2: Test\nwitness run --step test \\\n  --attestations material,commandrun \\\n  -o test.json --key ci-key.pem \\\n  -- go test ./...\n\n# Step 3: Package\nwitness run --step package \\\n  --attestations material,product \\\n  -o package.json --key ci-key.pem \\\n  -- tar czf myapp.tar.gz myapp\n\n# Verify entire pipeline\nwitness verify \\\n  --policy policy-signed.json \\\n  --publickey policy-key.pub \\\n  -a build.json -a test.json -a package.json\n```\n"}]}
{"messages": [{"role": "system", "content": "You are an expert in the Witness supply chain attestation framework. You help users instrument CI/CD pipelines with witness, create policy documents, and write Rego policies to validate attestations. You understand all attestors in go-witness and how to use them effectively."}, {"role": "user", "content": "How do I create a witness policy for a build step that uses these attestors: material, github, git, commandrun, product?"}, {"role": "assistant", "content": "Here's a complete witness policy for your build step with material, github, git, commandrun, product attestors:\n\n**Policy Document:**\n```json\n{\n  \"expires\": \"2026-11-08T10:52:59Z\",\n  \"publickeys\": {\n    \"build-key\": {\n      \"keyid\": \"sha256:d063bb34931cc11d0385bd8d7c010934cf778d70612ad41ab8032a3170e54e9f\",\n      \"key\": \"-----BEGIN PUBLIC KEY-----\\n...\\n-----END PUBLIC KEY-----\"\n    }\n  },\n  \"steps\": {\n    \"build\": {\n      \"name\": \"build\",\n      \"attestations\": [\n        {\n          \"type\": \"https://witness.dev/attestations/material/v0.1\"\n        },\n        {\n          \"type\": \"https://witness.dev/attestations/github/v0.1\"\n        },\n        {\n          \"type\": \"https://witness.dev/attestations/git/v0.1\"\n        },\n        {\n          \"type\": \"https://witness.dev/attestations/command-run/v0.1\"\n        },\n        {\n          \"type\": \"https://witness.dev/attestations/product/v0.1\"\n        }\n      ],\n      \"functionaries\": [\n        {\n          \"type\": \"publickey\",\n          \"publickeyid\": \"build-key\"\n        }\n      ]\n    }\n  }\n}\n```\n\n**Witness Run Command:**\n```bash\nwitness run --step build \\\n  --attestations material,github,git,commandrun,product \\\n  --outfile build-attestation.json \\\n  --key signing-key.pem \\\n  -- <your-build-command>\n```\n\n**Rego Validation Rules:**\n```rego\n\n```\n\n**Verification:**\n```bash\nwitness verify \\\n  --policy policy-signed.json \\\n  --publickey policy-key.pub \\\n  -a build-attestation.json \\\n  --subject <artifact>\n```\n"}]}
{"messages": [{"role": "system", "content": "You are an expert in the Witness supply chain attestation framework. You help users instrument CI/CD pipelines with witness, create policy documents, and write Rego policies to validate attestations. You understand all attestors in go-witness and how to use them effectively."}, {"role": "user", "content": "How do I create a witness policy for a build step that uses these attestors: environment, product, git, commandrun?"}, {"role": "assistant", "content": "Here's a complete witness policy for your build step with environment, product, git, commandrun attestors:\n\n**Policy Document:**\n```json\n{\n  \"expires\": \"2026-11-08T10:52:59Z\",\n  \"publickeys\": {\n    \"build-key\": {\n      \"keyid\": \"sha256:1500017e1c30de2021f050ef7963956011cf7d5a69c5dea0afc55cf3401f4e4d\",\n      \"key\": \"-----BEGIN PUBLIC KEY-----\\n...\\n-----END PUBLIC KEY-----\"\n    }\n  },\n  \"steps\": {\n    \"build\": {\n      \"name\": \"build\",\n      \"attestations\": [\n        {\n          \"type\": \"https://witness.dev/attestations/environment/v0.1\"\n        },\n        {\n          \"type\": \"https://witness.dev/attestations/product/v0.1\"\n        },\n        {\n          \"type\": \"https://witness.dev/attestations/git/v0.1\"\n        },\n        {\n          \"type\": \"https://witness.dev/attestations/command-run/v0.1\"\n        }\n      ],\n      \"functionaries\": [\n        {\n          \"type\": \"publickey\",\n          \"publickeyid\": \"build-key\"\n        }\n      ]\n    }\n  }\n}\n```\n\n**Witness Run Command:**\n```bash\nwitness run --step build \\\n  --attestations environment,product,git,commandrun \\\n  --outfile build-attestation.json \\\n  --key signing-key.pem \\\n  -- <your-build-command>\n```\n\n**Rego Validation Rules:**\n```rego\npackage environment\n\nimport rego.v1\n\n# Ensure correct OS\ndeny contains msg if {\n    input.os != \"linux\"\n    msg := sprintf(\"Must run on linux, got: %s\", [input.os])\n}\n\n# Require CI environment\ndeny contains msg if {\n    not \"CI\" in input.variables\n    msg := \"Must run in CI environment (CI variable not set)\"\n}\n```\n\n**Verification:**\n```bash\nwitness verify \\\n  --policy policy-signed.json \\\n  --publickey policy-key.pub \\\n  -a build-attestation.json \\\n  --subject <artifact>\n```\n"}]}
{"messages": [{"role": "system", "content": "You are an expert in the Witness supply chain attestation framework. You help users instrument CI/CD pipelines with witness, create policy documents, and write Rego policies to validate attestations. You understand all attestors in go-witness and how to use them effectively."}, {"role": "user", "content": "How do I create a multi-step witness policy for a build \u2192 test \u2192 package pipeline?"}, {"role": "assistant", "content": "Here's a complete multi-step witness policy for your pipeline:\n\n**Policy Document:**\n```json\n{\n  \"expires\": \"2026-11-08T10:52:59Z\",\n  \"publickeys\": {\n    \"ci-key\": {\n      \"keyid\": \"sha256:e4ca59f14cc2f74d0b4e62f4b4741752591551452e034b24f60fd9f3e5215bfe\",\n      \"key\": \"-----BEGIN PUBLIC KEY-----\\n...\\n-----END PUBLIC KEY-----\"\n    }\n  },\n  \"steps\": {\n    \"build\": {\n      \"name\": \"build\",\n      \"attestations\": [\n        {\n          \"type\": \"https://witness.dev/attestations/git/v0.1\"\n        },\n        {\n          \"type\": \"https://witness.dev/attestations/command-run/v0.1\"\n        },\n        {\n          \"type\": \"https://witness.dev/attestations/product/v0.1\"\n        }\n      ],\n      \"functionaries\": [\n        {\n          \"type\": \"publickey\",\n          \"publickeyid\": \"ci-key\"\n        }\n      ]\n    },\n    \"test\": {\n      \"name\": \"test\",\n      \"attestations\": [\n        {\n          \"type\": \"https://witness.dev/attestations/material/v0.1\"\n        },\n        {\n          \"type\": \"https://witness.dev/attestations/command-run/v0.1\"\n        }\n      ],\n      \"functionaries\": [\n        {\n          \"type\": \"publickey\",\n          \"publickeyid\": \"ci-key\"\n        }\n      ]\n    },\n    \"package\": {\n      \"name\": \"package\",\n      \"attestations\": [\n        {\n          \"type\": \"https://witness.dev/attestations/material/v0.1\"\n        },\n        {\n          \"type\": \"https://witness.dev/attestations/product/v0.1\"\n        }\n      ],\n      \"functionaries\": [\n        {\n          \"type\": \"publickey\",\n          \"publickeyid\": \"ci-key\"\n        }\n      ]\n    }\n  }\n}\n```\n\n**Pipeline Commands:**\n\n```bash\n# Step 1: Build\nwitness run --step build \\\n  --attestations git,commandrun,product \\\n  -o build.json --key ci-key.pem \\\n  -- go build -o myapp\n\n# Step 2: Test\nwitness run --step test \\\n  --attestations material,commandrun \\\n  -o test.json --key ci-key.pem \\\n  -- go test ./...\n\n# Step 3: Package\nwitness run --step package \\\n  --attestations material,product \\\n  -o package.json --key ci-key.pem \\\n  -- tar czf myapp.tar.gz myapp\n\n# Verify entire pipeline\nwitness verify \\\n  --policy policy-signed.json \\\n  --publickey policy-key.pub \\\n  -a build.json -a test.json -a package.json\n```\n"}]}
{"messages": [{"role": "system", "content": "You are an expert in the Witness supply chain attestation framework. You help users instrument CI/CD pipelines with witness, create policy documents, and write Rego policies to validate attestations. You understand all attestors in go-witness and how to use them effectively."}, {"role": "user", "content": "How do I create a multi-step witness policy for a build \u2192 test \u2192 package pipeline?"}, {"role": "assistant", "content": "Here's a complete multi-step witness policy for your pipeline:\n\n**Policy Document:**\n```json\n{\n  \"expires\": \"2026-11-08T10:52:59Z\",\n  \"publickeys\": {\n    \"ci-key\": {\n      \"keyid\": \"sha256:5a6652fea99a3fd08aed18807c3a5a5822deee9d3b67071d8dc2e0c5fbb6a51f\",\n      \"key\": \"-----BEGIN PUBLIC KEY-----\\n...\\n-----END PUBLIC KEY-----\"\n    }\n  },\n  \"steps\": {\n    \"build\": {\n      \"name\": \"build\",\n      \"attestations\": [\n        {\n          \"type\": \"https://witness.dev/attestations/git/v0.1\"\n        },\n        {\n          \"type\": \"https://witness.dev/attestations/command-run/v0.1\"\n        },\n        {\n          \"type\": \"https://witness.dev/attestations/product/v0.1\"\n        }\n      ],\n      \"functionaries\": [\n        {\n          \"type\": \"publickey\",\n          \"publickeyid\": \"ci-key\"\n        }\n      ]\n    },\n    \"test\": {\n      \"name\": \"test\",\n      \"attestations\": [\n        {\n          \"type\": \"https://witness.dev/attestations/material/v0.1\"\n        },\n        {\n          \"type\": \"https://witness.dev/attestations/command-run/v0.1\"\n        }\n      ],\n      \"functionaries\": [\n        {\n          \"type\": \"publickey\",\n          \"publickeyid\": \"ci-key\"\n        }\n      ]\n    },\n    \"package\": {\n      \"name\": \"package\",\n      \"attestations\": [\n        {\n          \"type\": \"https://witness.dev/attestations/material/v0.1\"\n        },\n        {\n          \"type\": \"https://witness.dev/attestations/product/v0.1\"\n        }\n      ],\n      \"functionaries\": [\n        {\n          \"type\": \"publickey\",\n          \"publickeyid\": \"ci-key\"\n        }\n      ]\n    }\n  }\n}\n```\n\n**Pipeline Commands:**\n\n```bash\n# Step 1: Build\nwitness run --step build \\\n  --attestations git,commandrun,product \\\n  -o build.json --key ci-key.pem \\\n  -- go build -o myapp\n\n# Step 2: Test\nwitness run --step test \\\n  --attestations material,commandrun \\\n  -o test.json --key ci-key.pem \\\n  -- go test ./...\n\n# Step 3: Package\nwitness run --step package \\\n  --attestations material,product \\\n  -o package.json --key ci-key.pem \\\n  -- tar czf myapp.tar.gz myapp\n\n# Verify entire pipeline\nwitness verify \\\n  --policy policy-signed.json \\\n  --publickey policy-key.pub \\\n  -a build.json -a test.json -a package.json\n```\n"}]}
{"messages": [{"role": "system", "content": "You are an expert in the Witness supply chain attestation framework. You help users instrument CI/CD pipelines with witness, create policy documents, and write Rego policies to validate attestations. You understand all attestors in go-witness and how to use them effectively."}, {"role": "user", "content": "How do I create a witness policy for a build step that uses these attestors: github, commandrun, product?"}, {"role": "assistant", "content": "Here's a complete witness policy for your build step with github, commandrun, product attestors:\n\n**Policy Document:**\n```json\n{\n  \"expires\": \"2026-11-08T10:52:59Z\",\n  \"publickeys\": {\n    \"build-key\": {\n      \"keyid\": \"sha256:a7c19aef336391c989e4e5af10566788fbd21f786a577c48b02d70d9eff1139f\",\n      \"key\": \"-----BEGIN PUBLIC KEY-----\\n...\\n-----END PUBLIC KEY-----\"\n    }\n  },\n  \"steps\": {\n    \"build\": {\n      \"name\": \"build\",\n      \"attestations\": [\n        {\n          \"type\": \"https://witness.dev/attestations/github/v0.1\"\n        },\n        {\n          \"type\": \"https://witness.dev/attestations/command-run/v0.1\"\n        },\n        {\n          \"type\": \"https://witness.dev/attestations/product/v0.1\"\n        }\n      ],\n      \"functionaries\": [\n        {\n          \"type\": \"publickey\",\n          \"publickeyid\": \"build-key\"\n        }\n      ]\n    }\n  }\n}\n```\n\n**Witness Run Command:**\n```bash\nwitness run --step build \\\n  --attestations github,commandrun,product \\\n  --outfile build-attestation.json \\\n  --key signing-key.pem \\\n  -- <your-build-command>\n```\n\n**Rego Validation Rules:**\n```rego\n\n```\n\n**Verification:**\n```bash\nwitness verify \\\n  --policy policy-signed.json \\\n  --publickey policy-key.pub \\\n  -a build-attestation.json \\\n  --subject <artifact>\n```\n"}]}
{"messages": [{"role": "system", "content": "You are an expert in the Witness supply chain attestation framework. You help users instrument CI/CD pipelines with witness, create policy documents, and write Rego policies to validate attestations. You understand all attestors in go-witness and how to use them effectively."}, {"role": "user", "content": "How do I create a witness policy for a build step that uses these attestors: github?"}, {"role": "assistant", "content": "Here's a complete witness policy for your build step with github attestors:\n\n**Policy Document:**\n```json\n{\n  \"expires\": \"2026-11-08T10:52:59Z\",\n  \"publickeys\": {\n    \"build-key\": {\n      \"keyid\": \"sha256:7b3264241c6a2eb401e819e8a61f3eefb714a7241e8c741327848b6a52e731db\",\n      \"key\": \"-----BEGIN PUBLIC KEY-----\\n...\\n-----END PUBLIC KEY-----\"\n    }\n  },\n  \"steps\": {\n    \"build\": {\n      \"name\": \"build\",\n      \"attestations\": [\n        {\n          \"type\": \"https://witness.dev/attestations/github/v0.1\"\n        }\n      ],\n      \"functionaries\": [\n        {\n          \"type\": \"publickey\",\n          \"publickeyid\": \"build-key\"\n        }\n      ]\n    }\n  }\n}\n```\n\n**Witness Run Command:**\n```bash\nwitness run --step build \\\n  --attestations github \\\n  --outfile build-attestation.json \\\n  --key signing-key.pem \\\n  -- <your-build-command>\n```\n\n**Rego Validation Rules:**\n```rego\n\n```\n\n**Verification:**\n```bash\nwitness verify \\\n  --policy policy-signed.json \\\n  --publickey policy-key.pub \\\n  -a build-attestation.json \\\n  --subject <artifact>\n```\n"}]}
{"messages": [{"role": "system", "content": "You are an expert in the Witness supply chain attestation framework. You help users instrument CI/CD pipelines with witness, create policy documents, and write Rego policies to validate attestations. You understand all attestors in go-witness and how to use them effectively."}, {"role": "user", "content": "How do I create a multi-step witness policy for a build \u2192 test \u2192 package pipeline?"}, {"role": "assistant", "content": "Here's a complete multi-step witness policy for your pipeline:\n\n**Policy Document:**\n```json\n{\n  \"expires\": \"2026-11-08T10:52:59Z\",\n  \"publickeys\": {\n    \"ci-key\": {\n      \"keyid\": \"sha256:117e9c038223e677b72bb760d3082f6826a40a0c24edcdc652dc55f3d4c52b0a\",\n      \"key\": \"-----BEGIN PUBLIC KEY-----\\n...\\n-----END PUBLIC KEY-----\"\n    }\n  },\n  \"steps\": {\n    \"build\": {\n      \"name\": \"build\",\n      \"attestations\": [\n        {\n          \"type\": \"https://witness.dev/attestations/git/v0.1\"\n        },\n        {\n          \"type\": \"https://witness.dev/attestations/command-run/v0.1\"\n        },\n        {\n          \"type\": \"https://witness.dev/attestations/product/v0.1\"\n        }\n      ],\n      \"functionaries\": [\n        {\n          \"type\": \"publickey\",\n          \"publickeyid\": \"ci-key\"\n        }\n      ]\n    },\n    \"test\": {\n      \"name\": \"test\",\n      \"attestations\": [\n        {\n          \"type\": \"https://witness.dev/attestations/material/v0.1\"\n        },\n        {\n          \"type\": \"https://witness.dev/attestations/command-run/v0.1\"\n        }\n      ],\n      \"functionaries\": [\n        {\n          \"type\": \"publickey\",\n          \"publickeyid\": \"ci-key\"\n        }\n      ]\n    },\n    \"package\": {\n      \"name\": \"package\",\n      \"attestations\": [\n        {\n          \"type\": \"https://witness.dev/attestations/material/v0.1\"\n        },\n        {\n          \"type\": \"https://witness.dev/attestations/product/v0.1\"\n        }\n      ],\n      \"functionaries\": [\n        {\n          \"type\": \"publickey\",\n          \"publickeyid\": \"ci-key\"\n        }\n      ]\n    }\n  }\n}\n```\n\n**Pipeline Commands:**\n\n```bash\n# Step 1: Build\nwitness run --step build \\\n  --attestations git,commandrun,product \\\n  -o build.json --key ci-key.pem \\\n  -- go build -o myapp\n\n# Step 2: Test\nwitness run --step test \\\n  --attestations material,commandrun \\\n  -o test.json --key ci-key.pem \\\n  -- go test ./...\n\n# Step 3: Package\nwitness run --step package \\\n  --attestations material,product \\\n  -o package.json --key ci-key.pem \\\n  -- tar czf myapp.tar.gz myapp\n\n# Verify entire pipeline\nwitness verify \\\n  --policy policy-signed.json \\\n  --publickey policy-key.pub \\\n  -a build.json -a test.json -a package.json\n```\n"}]}
{"messages": [{"role": "system", "content": "You are an expert in the Witness supply chain attestation framework. You help users instrument CI/CD pipelines with witness, create policy documents, and write Rego policies to validate attestations. You understand all attestors in go-witness and how to use them effectively."}, {"role": "user", "content": "How do I create a witness policy for a build step that uses these attestors: material, commandrun?"}, {"role": "assistant", "content": "Here's a complete witness policy for your build step with material, commandrun attestors:\n\n**Policy Document:**\n```json\n{\n  \"expires\": \"2026-11-08T10:52:59Z\",\n  \"publickeys\": {\n    \"build-key\": {\n      \"keyid\": \"sha256:230b0934997dc2685389150f1799a6dd491ef66b8ca0e732842c6022e353b6ef\",\n      \"key\": \"-----BEGIN PUBLIC KEY-----\\n...\\n-----END PUBLIC KEY-----\"\n    }\n  },\n  \"steps\": {\n    \"build\": {\n      \"name\": \"build\",\n      \"attestations\": [\n        {\n          \"type\": \"https://witness.dev/attestations/material/v0.1\"\n        },\n        {\n          \"type\": \"https://witness.dev/attestations/command-run/v0.1\"\n        }\n      ],\n      \"functionaries\": [\n        {\n          \"type\": \"publickey\",\n          \"publickeyid\": \"build-key\"\n        }\n      ]\n    }\n  }\n}\n```\n\n**Witness Run Command:**\n```bash\nwitness run --step build \\\n  --attestations material,commandrun \\\n  --outfile build-attestation.json \\\n  --key signing-key.pem \\\n  -- <your-build-command>\n```\n\n**Rego Validation Rules:**\n```rego\n\n```\n\n**Verification:**\n```bash\nwitness verify \\\n  --policy policy-signed.json \\\n  --publickey policy-key.pub \\\n  -a build-attestation.json \\\n  --subject <artifact>\n```\n"}]}
{"messages": [{"role": "system", "content": "You are an expert in the Witness supply chain attestation framework. You help users instrument CI/CD pipelines with witness, create policy documents, and write Rego policies to validate attestations. You understand all attestors in go-witness and how to use them effectively."}, {"role": "user", "content": "How do I create a multi-step witness policy for a build \u2192 test \u2192 package pipeline?"}, {"role": "assistant", "content": "Here's a complete multi-step witness policy for your pipeline:\n\n**Policy Document:**\n```json\n{\n  \"expires\": \"2026-11-08T10:52:59Z\",\n  \"publickeys\": {\n    \"ci-key\": {\n      \"keyid\": \"sha256:bc2e0ce0bdea75bdccba42456d9c023ea5e2e0efa6ee9ea4bc7a7fe0ab6a4acc\",\n      \"key\": \"-----BEGIN PUBLIC KEY-----\\n...\\n-----END PUBLIC KEY-----\"\n    }\n  },\n  \"steps\": {\n    \"build\": {\n      \"name\": \"build\",\n      \"attestations\": [\n        {\n          \"type\": \"https://witness.dev/attestations/git/v0.1\"\n        },\n        {\n          \"type\": \"https://witness.dev/attestations/command-run/v0.1\"\n        },\n        {\n          \"type\": \"https://witness.dev/attestations/product/v0.1\"\n        }\n      ],\n      \"functionaries\": [\n        {\n          \"type\": \"publickey\",\n          \"publickeyid\": \"ci-key\"\n        }\n      ]\n    },\n    \"test\": {\n      \"name\": \"test\",\n      \"attestations\": [\n        {\n          \"type\": \"https://witness.dev/attestations/material/v0.1\"\n        },\n        {\n          \"type\": \"https://witness.dev/attestations/command-run/v0.1\"\n        }\n      ],\n      \"functionaries\": [\n        {\n          \"type\": \"publickey\",\n          \"publickeyid\": \"ci-key\"\n        }\n      ]\n    },\n    \"package\": {\n      \"name\": \"package\",\n      \"attestations\": [\n        {\n          \"type\": \"https://witness.dev/attestations/material/v0.1\"\n        },\n        {\n          \"type\": \"https://witness.dev/attestations/product/v0.1\"\n        }\n      ],\n      \"functionaries\": [\n        {\n          \"type\": \"publickey\",\n          \"publickeyid\": \"ci-key\"\n        }\n      ]\n    }\n  }\n}\n```\n\n**Pipeline Commands:**\n\n```bash\n# Step 1: Build\nwitness run --step build \\\n  --attestations git,commandrun,product \\\n  -o build.json --key ci-key.pem \\\n  -- go build -o myapp\n\n# Step 2: Test\nwitness run --step test \\\n  --attestations material,commandrun \\\n  -o test.json --key ci-key.pem \\\n  -- go test ./...\n\n# Step 3: Package\nwitness run --step package \\\n  --attestations material,product \\\n  -o package.json --key ci-key.pem \\\n  -- tar czf myapp.tar.gz myapp\n\n# Verify entire pipeline\nwitness verify \\\n  --policy policy-signed.json \\\n  --publickey policy-key.pub \\\n  -a build.json -a test.json -a package.json\n```\n"}]}
{"messages": [{"role": "system", "content": "You are an expert in the Witness supply chain attestation framework. You help users instrument CI/CD pipelines with witness, create policy documents, and write Rego policies to validate attestations. You understand all attestors in go-witness and how to use them effectively."}, {"role": "user", "content": "How do I create a multi-step witness policy for a build \u2192 test \u2192 package pipeline?"}, {"role": "assistant", "content": "Here's a complete multi-step witness policy for your pipeline:\n\n**Policy Document:**\n```json\n{\n  \"expires\": \"2026-11-08T10:52:59Z\",\n  \"publickeys\": {\n    \"ci-key\": {\n      \"keyid\": \"sha256:38e56b9072d2b7766fa55d68d71838c2263e3e925f90187fa3450838292a3ef0\",\n      \"key\": \"-----BEGIN PUBLIC KEY-----\\n...\\n-----END PUBLIC KEY-----\"\n    }\n  },\n  \"steps\": {\n    \"build\": {\n      \"name\": \"build\",\n      \"attestations\": [\n        {\n          \"type\": \"https://witness.dev/attestations/git/v0.1\"\n        },\n        {\n          \"type\": \"https://witness.dev/attestations/command-run/v0.1\"\n        },\n        {\n          \"type\": \"https://witness.dev/attestations/product/v0.1\"\n        }\n      ],\n      \"functionaries\": [\n        {\n          \"type\": \"publickey\",\n          \"publickeyid\": \"ci-key\"\n        }\n      ]\n    },\n    \"test\": {\n      \"name\": \"test\",\n      \"attestations\": [\n        {\n          \"type\": \"https://witness.dev/attestations/material/v0.1\"\n        },\n        {\n          \"type\": \"https://witness.dev/attestations/command-run/v0.1\"\n        }\n      ],\n      \"functionaries\": [\n        {\n          \"type\": \"publickey\",\n          \"publickeyid\": \"ci-key\"\n        }\n      ]\n    },\n    \"package\": {\n      \"name\": \"package\",\n      \"attestations\": [\n        {\n          \"type\": \"https://witness.dev/attestations/material/v0.1\"\n        },\n        {\n          \"type\": \"https://witness.dev/attestations/product/v0.1\"\n        }\n      ],\n      \"functionaries\": [\n        {\n          \"type\": \"publickey\",\n          \"publickeyid\": \"ci-key\"\n        }\n      ]\n    }\n  }\n}\n```\n\n**Pipeline Commands:**\n\n```bash\n# Step 1: Build\nwitness run --step build \\\n  --attestations git,commandrun,product \\\n  -o build.json --key ci-key.pem \\\n  -- go build -o myapp\n\n# Step 2: Test\nwitness run --step test \\\n  --attestations material,commandrun \\\n  -o test.json --key ci-key.pem \\\n  -- go test ./...\n\n# Step 3: Package\nwitness run --step package \\\n  --attestations material,product \\\n  -o package.json --key ci-key.pem \\\n  -- tar czf myapp.tar.gz myapp\n\n# Verify entire pipeline\nwitness verify \\\n  --policy policy-signed.json \\\n  --publickey policy-key.pub \\\n  -a build.json -a test.json -a package.json\n```\n"}]}
{"messages": [{"role": "system", "content": "You are an expert in the Witness supply chain attestation framework. You help users instrument CI/CD pipelines with witness, create policy documents, and write Rego policies to validate attestations. You understand all attestors in go-witness and how to use them effectively."}, {"role": "user", "content": "How do I create a witness policy for a build step that uses these attestors: product, commandrun, github, git?"}, {"role": "assistant", "content": "Here's a complete witness policy for your build step with product, commandrun, github, git attestors:\n\n**Policy Document:**\n```json\n{\n  \"expires\": \"2026-11-08T10:52:59Z\",\n  \"publickeys\": {\n    \"build-key\": {\n      \"keyid\": \"sha256:80eac45776f08797c9a6a1e3e6427f59b873d9ad8a784ec05be59bea9f29fa4a\",\n      \"key\": \"-----BEGIN PUBLIC KEY-----\\n...\\n-----END PUBLIC KEY-----\"\n    }\n  },\n  \"steps\": {\n    \"build\": {\n      \"name\": \"build\",\n      \"attestations\": [\n        {\n          \"type\": \"https://witness.dev/attestations/product/v0.1\"\n        },\n        {\n          \"type\": \"https://witness.dev/attestations/command-run/v0.1\"\n        },\n        {\n          \"type\": \"https://witness.dev/attestations/github/v0.1\"\n        },\n        {\n          \"type\": \"https://witness.dev/attestations/git/v0.1\"\n        }\n      ],\n      \"functionaries\": [\n        {\n          \"type\": \"publickey\",\n          \"publickeyid\": \"build-key\"\n        }\n      ]\n    }\n  }\n}\n```\n\n**Witness Run Command:**\n```bash\nwitness run --step build \\\n  --attestations product,commandrun,github,git \\\n  --outfile build-attestation.json \\\n  --key signing-key.pem \\\n  -- <your-build-command>\n```\n\n**Rego Validation Rules:**\n```rego\n\n```\n\n**Verification:**\n```bash\nwitness verify \\\n  --policy policy-signed.json \\\n  --publickey policy-key.pub \\\n  -a build-attestation.json \\\n  --subject <artifact>\n```\n"}]}
{"messages": [{"role": "system", "content": "You are an expert in the Witness supply chain attestation framework. You help users instrument CI/CD pipelines with witness, create policy documents, and write Rego policies to validate attestations. You understand all attestors in go-witness and how to use them effectively."}, {"role": "user", "content": "How do I create a witness policy for a build step that uses these attestors: environment, commandrun?"}, {"role": "assistant", "content": "Here's a complete witness policy for your build step with environment, commandrun attestors:\n\n**Policy Document:**\n```json\n{\n  \"expires\": \"2026-11-08T10:52:59Z\",\n  \"publickeys\": {\n    \"build-key\": {\n      \"keyid\": \"sha256:3ad8c61039876fff7d0561e6f3d8358d8b03dc480b7db60fd81a78afa8e668f6\",\n      \"key\": \"-----BEGIN PUBLIC KEY-----\\n...\\n-----END PUBLIC KEY-----\"\n    }\n  },\n  \"steps\": {\n    \"build\": {\n      \"name\": \"build\",\n      \"attestations\": [\n        {\n          \"type\": \"https://witness.dev/attestations/environment/v0.1\"\n        },\n        {\n          \"type\": \"https://witness.dev/attestations/command-run/v0.1\"\n        }\n      ],\n      \"functionaries\": [\n        {\n          \"type\": \"publickey\",\n          \"publickeyid\": \"build-key\"\n        }\n      ]\n    }\n  }\n}\n```\n\n**Witness Run Command:**\n```bash\nwitness run --step build \\\n  --attestations environment,commandrun \\\n  --outfile build-attestation.json \\\n  --key signing-key.pem \\\n  -- <your-build-command>\n```\n\n**Rego Validation Rules:**\n```rego\npackage environment\n\nimport rego.v1\n\n# Ensure correct OS\ndeny contains msg if {\n    input.os != \"windows\"\n    msg := sprintf(\"Must run on windows, got: %s\", [input.os])\n}\n\n# Require CI environment\ndeny contains msg if {\n    not \"CI\" in input.variables\n    msg := \"Must run in CI environment (CI variable not set)\"\n}\n```\n\n**Verification:**\n```bash\nwitness verify \\\n  --policy policy-signed.json \\\n  --publickey policy-key.pub \\\n  -a build-attestation.json \\\n  --subject <artifact>\n```\n"}]}
{"messages": [{"role": "system", "content": "You are an expert in the Witness supply chain attestation framework. You help users instrument CI/CD pipelines with witness, create policy documents, and write Rego policies to validate attestations. You understand all attestors in go-witness and how to use them effectively."}, {"role": "user", "content": "How do I create a witness policy for a build step that uses these attestors: environment?"}, {"role": "assistant", "content": "Here's a complete witness policy for your build step with environment attestors:\n\n**Policy Document:**\n```json\n{\n  \"expires\": \"2026-11-08T10:52:59Z\",\n  \"publickeys\": {\n    \"build-key\": {\n      \"keyid\": \"sha256:6524b4e41677dbadea8f089982ac0f7eb3d0b75c1c2e9dcb0d35954afa08d392\",\n      \"key\": \"-----BEGIN PUBLIC KEY-----\\n...\\n-----END PUBLIC KEY-----\"\n    }\n  },\n  \"steps\": {\n    \"build\": {\n      \"name\": \"build\",\n      \"attestations\": [\n        {\n          \"type\": \"https://witness.dev/attestations/environment/v0.1\"\n        }\n      ],\n      \"functionaries\": [\n        {\n          \"type\": \"publickey\",\n          \"publickeyid\": \"build-key\"\n        }\n      ]\n    }\n  }\n}\n```\n\n**Witness Run Command:**\n```bash\nwitness run --step build \\\n  --attestations environment \\\n  --outfile build-attestation.json \\\n  --key signing-key.pem \\\n  -- <your-build-command>\n```\n\n**Rego Validation Rules:**\n```rego\npackage environment\n\nimport rego.v1\n\n# Ensure correct OS\ndeny contains msg if {\n    input.os != \"windows\"\n    msg := sprintf(\"Must run on windows, got: %s\", [input.os])\n}\n\n# Require CI environment\ndeny contains msg if {\n    not \"CI\" in input.variables\n    msg := \"Must run in CI environment (CI variable not set)\"\n}\n```\n\n**Verification:**\n```bash\nwitness verify \\\n  --policy policy-signed.json \\\n  --publickey policy-key.pub \\\n  -a build-attestation.json \\\n  --subject <artifact>\n```\n"}]}
{"messages": [{"role": "system", "content": "You are an expert in the Witness supply chain attestation framework. You help users instrument CI/CD pipelines with witness, create policy documents, and write Rego policies to validate attestations. You understand all attestors in go-witness and how to use them effectively."}, {"role": "user", "content": "How do I create a witness policy for a build step that uses these attestors: product, environment, material, commandrun, github?"}, {"role": "assistant", "content": "Here's a complete witness policy for your build step with product, environment, material, commandrun, github attestors:\n\n**Policy Document:**\n```json\n{\n  \"expires\": \"2026-11-08T10:52:59Z\",\n  \"publickeys\": {\n    \"build-key\": {\n      \"keyid\": \"sha256:66a86ab3b1ce2fff825724f10ad85e7a864932c5819ae64fcb951fab40872362\",\n      \"key\": \"-----BEGIN PUBLIC KEY-----\\n...\\n-----END PUBLIC KEY-----\"\n    }\n  },\n  \"steps\": {\n    \"build\": {\n      \"name\": \"build\",\n      \"attestations\": [\n        {\n          \"type\": \"https://witness.dev/attestations/product/v0.1\"\n        },\n        {\n          \"type\": \"https://witness.dev/attestations/environment/v0.1\"\n        },\n        {\n          \"type\": \"https://witness.dev/attestations/material/v0.1\"\n        },\n        {\n          \"type\": \"https://witness.dev/attestations/command-run/v0.1\"\n        },\n        {\n          \"type\": \"https://witness.dev/attestations/github/v0.1\"\n        }\n      ],\n      \"functionaries\": [\n        {\n          \"type\": \"publickey\",\n          \"publickeyid\": \"build-key\"\n        }\n      ]\n    }\n  }\n}\n```\n\n**Witness Run Command:**\n```bash\nwitness run --step build \\\n  --attestations product,environment,material,commandrun,github \\\n  --outfile build-attestation.json \\\n  --key signing-key.pem \\\n  -- <your-build-command>\n```\n\n**Rego Validation Rules:**\n```rego\n\n```\n\n**Verification:**\n```bash\nwitness verify \\\n  --policy policy-signed.json \\\n  --publickey policy-key.pub \\\n  -a build-attestation.json \\\n  --subject <artifact>\n```\n"}]}
{"messages": [{"role": "system", "content": "You are an expert in the Witness supply chain attestation framework. You help users instrument CI/CD pipelines with witness, create policy documents, and write Rego policies to validate attestations. You understand all attestors in go-witness and how to use them effectively."}, {"role": "user", "content": "How do I create a witness policy for a build step that uses these attestors: material, git, environment?"}, {"role": "assistant", "content": "Here's a complete witness policy for your build step with material, git, environment attestors:\n\n**Policy Document:**\n```json\n{\n  \"expires\": \"2026-11-08T10:52:59Z\",\n  \"publickeys\": {\n    \"build-key\": {\n      \"keyid\": \"sha256:511ae357ac303fac81121128f4cb48e65fa99164df89c52083e3847ea6aa2425\",\n      \"key\": \"-----BEGIN PUBLIC KEY-----\\n...\\n-----END PUBLIC KEY-----\"\n    }\n  },\n  \"steps\": {\n    \"build\": {\n      \"name\": \"build\",\n      \"attestations\": [\n        {\n          \"type\": \"https://witness.dev/attestations/material/v0.1\"\n        },\n        {\n          \"type\": \"https://witness.dev/attestations/git/v0.1\"\n        },\n        {\n          \"type\": \"https://witness.dev/attestations/environment/v0.1\"\n        }\n      ],\n      \"functionaries\": [\n        {\n          \"type\": \"publickey\",\n          \"publickeyid\": \"build-key\"\n        }\n      ]\n    }\n  }\n}\n```\n\n**Witness Run Command:**\n```bash\nwitness run --step build \\\n  --attestations material,git,environment \\\n  --outfile build-attestation.json \\\n  --key signing-key.pem \\\n  -- <your-build-command>\n```\n\n**Rego Validation Rules:**\n```rego\n\n```\n\n**Verification:**\n```bash\nwitness verify \\\n  --policy policy-signed.json \\\n  --publickey policy-key.pub \\\n  -a build-attestation.json \\\n  --subject <artifact>\n```\n"}]}
{"messages": [{"role": "system", "content": "You are an expert in the Witness supply chain attestation framework. You help users instrument CI/CD pipelines with witness, create policy documents, and write Rego policies to validate attestations. You understand all attestors in go-witness and how to use them effectively."}, {"role": "user", "content": "How do I create a witness policy for a build step that uses these attestors: git?"}, {"role": "assistant", "content": "Here's a complete witness policy for your build step with git attestors:\n\n**Policy Document:**\n```json\n{\n  \"expires\": \"2026-11-08T10:52:59Z\",\n  \"publickeys\": {\n    \"build-key\": {\n      \"keyid\": \"sha256:f423fc43e9146ddae3b93f5ab2178c347fc28414059cb5fe14d70f4f73fd4854\",\n      \"key\": \"-----BEGIN PUBLIC KEY-----\\n...\\n-----END PUBLIC KEY-----\"\n    }\n  },\n  \"steps\": {\n    \"build\": {\n      \"name\": \"build\",\n      \"attestations\": [\n        {\n          \"type\": \"https://witness.dev/attestations/git/v0.1\"\n        }\n      ],\n      \"functionaries\": [\n        {\n          \"type\": \"publickey\",\n          \"publickeyid\": \"build-key\"\n        }\n      ]\n    }\n  }\n}\n```\n\n**Witness Run Command:**\n```bash\nwitness run --step build \\\n  --attestations git \\\n  --outfile build-attestation.json \\\n  --key signing-key.pem \\\n  -- <your-build-command>\n```\n\n**Rego Validation Rules:**\n```rego\npackage git\n\nimport rego.v1\n\n# Enforce builds from specific branch\ndeny contains msg if {\n    input.branch != \"feature/api\"\n    msg := sprintf(\"Must build from feature/api branch, got: %s\", [input.branch])\n}\n\n# Require clean working directory\ndeny contains msg if {\n    count(input.status) > 0\n    msg := \"Working directory must be clean (no uncommitted changes)\"\n}\n\n# Validate commit author\napproved_authors := {\n    \"alice.smith@example.com\",\n    \"bob.jones@company.com\",\n    \"ci-bot@company.com\"\n}\n\ndeny contains msg if {\n    not input.authoremail in approved_authors\n    msg := sprintf(\"Unauthorized commit author: %s\", [input.authoremail])\n}\n```\n\n**Verification:**\n```bash\nwitness verify \\\n  --policy policy-signed.json \\\n  --publickey policy-key.pub \\\n  -a build-attestation.json \\\n  --subject <artifact>\n```\n"}]}
{"messages": [{"role": "system", "content": "You are an expert in the Witness supply chain attestation framework. You help users instrument CI/CD pipelines with witness, create policy documents, and write Rego policies to validate attestations. You understand all attestors in go-witness and how to use them effectively."}, {"role": "user", "content": "How do I create a multi-step witness policy for a build \u2192 test \u2192 package pipeline?"}, {"role": "assistant", "content": "Here's a complete multi-step witness policy for your pipeline:\n\n**Policy Document:**\n```json\n{\n  \"expires\": \"2026-11-08T10:52:59Z\",\n  \"publickeys\": {\n    \"ci-key\": {\n      \"keyid\": \"sha256:25bb7e46bbca27ed0928e2b9514c8f90dc49f8e8f438f9bf4b05c02b07f7fb43\",\n      \"key\": \"-----BEGIN PUBLIC KEY-----\\n...\\n-----END PUBLIC KEY-----\"\n    }\n  },\n  \"steps\": {\n    \"build\": {\n      \"name\": \"build\",\n      \"attestations\": [\n        {\n          \"type\": \"https://witness.dev/attestations/git/v0.1\"\n        },\n        {\n          \"type\": \"https://witness.dev/attestations/command-run/v0.1\"\n        },\n        {\n          \"type\": \"https://witness.dev/attestations/product/v0.1\"\n        }\n      ],\n      \"functionaries\": [\n        {\n          \"type\": \"publickey\",\n          \"publickeyid\": \"ci-key\"\n        }\n      ]\n    },\n    \"test\": {\n      \"name\": \"test\",\n      \"attestations\": [\n        {\n          \"type\": \"https://witness.dev/attestations/material/v0.1\"\n        },\n        {\n          \"type\": \"https://witness.dev/attestations/command-run/v0.1\"\n        }\n      ],\n      \"functionaries\": [\n        {\n          \"type\": \"publickey\",\n          \"publickeyid\": \"ci-key\"\n        }\n      ]\n    },\n    \"package\": {\n      \"name\": \"package\",\n      \"attestations\": [\n        {\n          \"type\": \"https://witness.dev/attestations/material/v0.1\"\n        },\n        {\n          \"type\": \"https://witness.dev/attestations/product/v0.1\"\n        }\n      ],\n      \"functionaries\": [\n        {\n          \"type\": \"publickey\",\n          \"publickeyid\": \"ci-key\"\n        }\n      ]\n    }\n  }\n}\n```\n\n**Pipeline Commands:**\n\n```bash\n# Step 1: Build\nwitness run --step build \\\n  --attestations git,commandrun,product \\\n  -o build.json --key ci-key.pem \\\n  -- go build -o myapp\n\n# Step 2: Test\nwitness run --step test \\\n  --attestations material,commandrun \\\n  -o test.json --key ci-key.pem \\\n  -- go test ./...\n\n# Step 3: Package\nwitness run --step package \\\n  --attestations material,product \\\n  -o package.json --key ci-key.pem \\\n  -- tar czf myapp.tar.gz myapp\n\n# Verify entire pipeline\nwitness verify \\\n  --policy policy-signed.json \\\n  --publickey policy-key.pub \\\n  -a build.json -a test.json -a package.json\n```\n"}]}
{"messages": [{"role": "system", "content": "You are an expert in the Witness supply chain attestation framework. You help users instrument CI/CD pipelines with witness, create policy documents, and write Rego policies to validate attestations. You understand all attestors in go-witness and how to use them effectively."}, {"role": "user", "content": "How do I create a witness policy for a build step that uses these attestors: environment, product, material, github?"}, {"role": "assistant", "content": "Here's a complete witness policy for your build step with environment, product, material, github attestors:\n\n**Policy Document:**\n```json\n{\n  \"expires\": \"2026-11-08T10:52:59Z\",\n  \"publickeys\": {\n    \"build-key\": {\n      \"keyid\": \"sha256:18f99bf4b6a774629dc297d5861567166b075cb3556e2ed7fc91e2b7025d5259\",\n      \"key\": \"-----BEGIN PUBLIC KEY-----\\n...\\n-----END PUBLIC KEY-----\"\n    }\n  },\n  \"steps\": {\n    \"build\": {\n      \"name\": \"build\",\n      \"attestations\": [\n        {\n          \"type\": \"https://witness.dev/attestations/environment/v0.1\"\n        },\n        {\n          \"type\": \"https://witness.dev/attestations/product/v0.1\"\n        },\n        {\n          \"type\": \"https://witness.dev/attestations/material/v0.1\"\n        },\n        {\n          \"type\": \"https://witness.dev/attestations/github/v0.1\"\n        }\n      ],\n      \"functionaries\": [\n        {\n          \"type\": \"publickey\",\n          \"publickeyid\": \"build-key\"\n        }\n      ]\n    }\n  }\n}\n```\n\n**Witness Run Command:**\n```bash\nwitness run --step build \\\n  --attestations environment,product,material,github \\\n  --outfile build-attestation.json \\\n  --key signing-key.pem \\\n  -- <your-build-command>\n```\n\n**Rego Validation Rules:**\n```rego\npackage environment\n\nimport rego.v1\n\n# Ensure correct OS\ndeny contains msg if {\n    input.os != \"linux\"\n    msg := sprintf(\"Must run on linux, got: %s\", [input.os])\n}\n\n# Require CI environment\ndeny contains msg if {\n    not \"CI\" in input.variables\n    msg := \"Must run in CI environment (CI variable not set)\"\n}\n```\n\n**Verification:**\n```bash\nwitness verify \\\n  --policy policy-signed.json \\\n  --publickey policy-key.pub \\\n  -a build-attestation.json \\\n  --subject <artifact>\n```\n"}]}
{"messages": [{"role": "system", "content": "You are an expert in the Witness supply chain attestation framework. You help users instrument CI/CD pipelines with witness, create policy documents, and write Rego policies to validate attestations. You understand all attestors in go-witness and how to use them effectively."}, {"role": "user", "content": "How do I create a witness policy for a build step that uses these attestors: material, environment, github?"}, {"role": "assistant", "content": "Here's a complete witness policy for your build step with material, environment, github attestors:\n\n**Policy Document:**\n```json\n{\n  \"expires\": \"2026-11-08T10:52:59Z\",\n  \"publickeys\": {\n    \"build-key\": {\n      \"keyid\": \"sha256:9e56392bcdcf7e525eef261035c8b1c3d77f7858960eb6cff0031c9b49823055\",\n      \"key\": \"-----BEGIN PUBLIC KEY-----\\n...\\n-----END PUBLIC KEY-----\"\n    }\n  },\n  \"steps\": {\n    \"build\": {\n      \"name\": \"build\",\n      \"attestations\": [\n        {\n          \"type\": \"https://witness.dev/attestations/material/v0.1\"\n        },\n        {\n          \"type\": \"https://witness.dev/attestations/environment/v0.1\"\n        },\n        {\n          \"type\": \"https://witness.dev/attestations/github/v0.1\"\n        }\n      ],\n      \"functionaries\": [\n        {\n          \"type\": \"publickey\",\n          \"publickeyid\": \"build-key\"\n        }\n      ]\n    }\n  }\n}\n```\n\n**Witness Run Command:**\n```bash\nwitness run --step build \\\n  --attestations material,environment,github \\\n  --outfile build-attestation.json \\\n  --key signing-key.pem \\\n  -- <your-build-command>\n```\n\n**Rego Validation Rules:**\n```rego\n\n```\n\n**Verification:**\n```bash\nwitness verify \\\n  --policy policy-signed.json \\\n  --publickey policy-key.pub \\\n  -a build-attestation.json \\\n  --subject <artifact>\n```\n"}]}
{"messages": [{"role": "system", "content": "You are an expert in the Witness supply chain attestation framework. You help users instrument CI/CD pipelines with witness, create policy documents, and write Rego policies to validate attestations. You understand all attestors in go-witness and how to use them effectively."}, {"role": "user", "content": "How do I create a witness policy for a build step that uses these attestors: git, github, material, commandrun, environment?"}, {"role": "assistant", "content": "Here's a complete witness policy for your build step with git, github, material, commandrun, environment attestors:\n\n**Policy Document:**\n```json\n{\n  \"expires\": \"2026-11-08T10:52:59Z\",\n  \"publickeys\": {\n    \"build-key\": {\n      \"keyid\": \"sha256:b5285e1468c805f9cf00e54f0e7c9d450e7806912a1dd30d11e56071c6309a7d\",\n      \"key\": \"-----BEGIN PUBLIC KEY-----\\n...\\n-----END PUBLIC KEY-----\"\n    }\n  },\n  \"steps\": {\n    \"build\": {\n      \"name\": \"build\",\n      \"attestations\": [\n        {\n          \"type\": \"https://witness.dev/attestations/git/v0.1\"\n        },\n        {\n          \"type\": \"https://witness.dev/attestations/github/v0.1\"\n        },\n        {\n          \"type\": \"https://witness.dev/attestations/material/v0.1\"\n        },\n        {\n          \"type\": \"https://witness.dev/attestations/command-run/v0.1\"\n        },\n        {\n          \"type\": \"https://witness.dev/attestations/environment/v0.1\"\n        }\n      ],\n      \"functionaries\": [\n        {\n          \"type\": \"publickey\",\n          \"publickeyid\": \"build-key\"\n        }\n      ]\n    }\n  }\n}\n```\n\n**Witness Run Command:**\n```bash\nwitness run --step build \\\n  --attestations git,github,material,commandrun,environment \\\n  --outfile build-attestation.json \\\n  --key signing-key.pem \\\n  -- <your-build-command>\n```\n\n**Rego Validation Rules:**\n```rego\npackage git\n\nimport rego.v1\n\n# Enforce builds from specific branch\ndeny contains msg if {\n    input.branch != \"bugfix/security\"\n    msg := sprintf(\"Must build from bugfix/security branch, got: %s\", [input.branch])\n}\n\n# Require clean working directory\ndeny contains msg if {\n    count(input.status) > 0\n    msg := \"Working directory must be clean (no uncommitted changes)\"\n}\n\n# Validate commit author\napproved_authors := {\n    \"alice.smith@example.com\",\n    \"bob.jones@company.com\",\n    \"ci-bot@company.com\"\n}\n\ndeny contains msg if {\n    not input.authoremail in approved_authors\n    msg := sprintf(\"Unauthorized commit author: %s\", [input.authoremail])\n}\n```\n\n**Verification:**\n```bash\nwitness verify \\\n  --policy policy-signed.json \\\n  --publickey policy-key.pub \\\n  -a build-attestation.json \\\n  --subject <artifact>\n```\n"}]}
{"messages": [{"role": "system", "content": "You are an expert in the Witness supply chain attestation framework. You help users instrument CI/CD pipelines with witness, create policy documents, and write Rego policies to validate attestations. You understand all attestors in go-witness and how to use them effectively."}, {"role": "user", "content": "How do I create a witness policy for a build step that uses these attestors: product, material, commandrun?"}, {"role": "assistant", "content": "Here's a complete witness policy for your build step with product, material, commandrun attestors:\n\n**Policy Document:**\n```json\n{\n  \"expires\": \"2026-11-08T10:52:59Z\",\n  \"publickeys\": {\n    \"build-key\": {\n      \"keyid\": \"sha256:4cd4f06a9e5fcf2a00d59151f900359dc9d8dfb990037a0920bf547e5a72d7d8\",\n      \"key\": \"-----BEGIN PUBLIC KEY-----\\n...\\n-----END PUBLIC KEY-----\"\n    }\n  },\n  \"steps\": {\n    \"build\": {\n      \"name\": \"build\",\n      \"attestations\": [\n        {\n          \"type\": \"https://witness.dev/attestations/product/v0.1\"\n        },\n        {\n          \"type\": \"https://witness.dev/attestations/material/v0.1\"\n        },\n        {\n          \"type\": \"https://witness.dev/attestations/command-run/v0.1\"\n        }\n      ],\n      \"functionaries\": [\n        {\n          \"type\": \"publickey\",\n          \"publickeyid\": \"build-key\"\n        }\n      ]\n    }\n  }\n}\n```\n\n**Witness Run Command:**\n```bash\nwitness run --step build \\\n  --attestations product,material,commandrun \\\n  --outfile build-attestation.json \\\n  --key signing-key.pem \\\n  -- <your-build-command>\n```\n\n**Rego Validation Rules:**\n```rego\n\n```\n\n**Verification:**\n```bash\nwitness verify \\\n  --policy policy-signed.json \\\n  --publickey policy-key.pub \\\n  -a build-attestation.json \\\n  --subject <artifact>\n```\n"}]}
{"messages": [{"role": "system", "content": "You are an expert in the Witness supply chain attestation framework. You help users instrument CI/CD pipelines with witness, create policy documents, and write Rego policies to validate attestations. You understand all attestors in go-witness and how to use them effectively."}, {"role": "user", "content": "How do I create a witness policy for a build step that uses these attestors: product, git, github, environment?"}, {"role": "assistant", "content": "Here's a complete witness policy for your build step with product, git, github, environment attestors:\n\n**Policy Document:**\n```json\n{\n  \"expires\": \"2026-11-08T10:52:59Z\",\n  \"publickeys\": {\n    \"build-key\": {\n      \"keyid\": \"sha256:d3c5a171be381d8e0ac1c02b521267711ace04c74d2334d7f9bc9a84c416175b\",\n      \"key\": \"-----BEGIN PUBLIC KEY-----\\n...\\n-----END PUBLIC KEY-----\"\n    }\n  },\n  \"steps\": {\n    \"build\": {\n      \"name\": \"build\",\n      \"attestations\": [\n        {\n          \"type\": \"https://witness.dev/attestations/product/v0.1\"\n        },\n        {\n          \"type\": \"https://witness.dev/attestations/git/v0.1\"\n        },\n        {\n          \"type\": \"https://witness.dev/attestations/github/v0.1\"\n        },\n        {\n          \"type\": \"https://witness.dev/attestations/environment/v0.1\"\n        }\n      ],\n      \"functionaries\": [\n        {\n          \"type\": \"publickey\",\n          \"publickeyid\": \"build-key\"\n        }\n      ]\n    }\n  }\n}\n```\n\n**Witness Run Command:**\n```bash\nwitness run --step build \\\n  --attestations product,git,github,environment \\\n  --outfile build-attestation.json \\\n  --key signing-key.pem \\\n  -- <your-build-command>\n```\n\n**Rego Validation Rules:**\n```rego\n\n```\n\n**Verification:**\n```bash\nwitness verify \\\n  --policy policy-signed.json \\\n  --publickey policy-key.pub \\\n  -a build-attestation.json \\\n  --subject <artifact>\n```\n"}]}
{"messages": [{"role": "system", "content": "You are an expert in the Witness supply chain attestation framework. You help users instrument CI/CD pipelines with witness, create policy documents, and write Rego policies to validate attestations. You understand all attestors in go-witness and how to use them effectively."}, {"role": "user", "content": "How do I create a witness policy for a build step that uses these attestors: product, commandrun, environment?"}, {"role": "assistant", "content": "Here's a complete witness policy for your build step with product, commandrun, environment attestors:\n\n**Policy Document:**\n```json\n{\n  \"expires\": \"2026-11-08T10:52:59Z\",\n  \"publickeys\": {\n    \"build-key\": {\n      \"keyid\": \"sha256:cff5e965b41232e27c26c2718420fe49dcd7445641edde12fa848f3f4c0ced28\",\n      \"key\": \"-----BEGIN PUBLIC KEY-----\\n...\\n-----END PUBLIC KEY-----\"\n    }\n  },\n  \"steps\": {\n    \"build\": {\n      \"name\": \"build\",\n      \"attestations\": [\n        {\n          \"type\": \"https://witness.dev/attestations/product/v0.1\"\n        },\n        {\n          \"type\": \"https://witness.dev/attestations/command-run/v0.1\"\n        },\n        {\n          \"type\": \"https://witness.dev/attestations/environment/v0.1\"\n        }\n      ],\n      \"functionaries\": [\n        {\n          \"type\": \"publickey\",\n          \"publickeyid\": \"build-key\"\n        }\n      ]\n    }\n  }\n}\n```\n\n**Witness Run Command:**\n```bash\nwitness run --step build \\\n  --attestations product,commandrun,environment \\\n  --outfile build-attestation.json \\\n  --key signing-key.pem \\\n  -- <your-build-command>\n```\n\n**Rego Validation Rules:**\n```rego\n\n```\n\n**Verification:**\n```bash\nwitness verify \\\n  --policy policy-signed.json \\\n  --publickey policy-key.pub \\\n  -a build-attestation.json \\\n  --subject <artifact>\n```\n"}]}
{"messages": [{"role": "system", "content": "You are an expert in the Witness supply chain attestation framework. You help users instrument CI/CD pipelines with witness, create policy documents, and write Rego policies to validate attestations. You understand all attestors in go-witness and how to use them effectively."}, {"role": "user", "content": "How do I create a witness policy for a build step that uses these attestors: material, product?"}, {"role": "assistant", "content": "Here's a complete witness policy for your build step with material, product attestors:\n\n**Policy Document:**\n```json\n{\n  \"expires\": \"2026-11-08T10:52:59Z\",\n  \"publickeys\": {\n    \"build-key\": {\n      \"keyid\": \"sha256:0f4bee1f331b49660636e689265405c02da6a36ebc602358d91a228797bdf314\",\n      \"key\": \"-----BEGIN PUBLIC KEY-----\\n...\\n-----END PUBLIC KEY-----\"\n    }\n  },\n  \"steps\": {\n    \"build\": {\n      \"name\": \"build\",\n      \"attestations\": [\n        {\n          \"type\": \"https://witness.dev/attestations/material/v0.1\"\n        },\n        {\n          \"type\": \"https://witness.dev/attestations/product/v0.1\"\n        }\n      ],\n      \"functionaries\": [\n        {\n          \"type\": \"publickey\",\n          \"publickeyid\": \"build-key\"\n        }\n      ]\n    }\n  }\n}\n```\n\n**Witness Run Command:**\n```bash\nwitness run --step build \\\n  --attestations material,product \\\n  --outfile build-attestation.json \\\n  --key signing-key.pem \\\n  -- <your-build-command>\n```\n\n**Rego Validation Rules:**\n```rego\n\n```\n\n**Verification:**\n```bash\nwitness verify \\\n  --policy policy-signed.json \\\n  --publickey policy-key.pub \\\n  -a build-attestation.json \\\n  --subject <artifact>\n```\n"}]}
{"messages": [{"role": "system", "content": "You are an expert in the Witness supply chain attestation framework. You help users instrument CI/CD pipelines with witness, create policy documents, and write Rego policies to validate attestations. You understand all attestors in go-witness and how to use them effectively."}, {"role": "user", "content": "How do I create a witness policy for a build step that uses these attestors: git, github, environment?"}, {"role": "assistant", "content": "Here's a complete witness policy for your build step with git, github, environment attestors:\n\n**Policy Document:**\n```json\n{\n  \"expires\": \"2026-11-08T10:52:59Z\",\n  \"publickeys\": {\n    \"build-key\": {\n      \"keyid\": \"sha256:d0f0226c7b1a3d0dfea3f103d7915f554684803c7f1e8bfbd1cdbba889533b82\",\n      \"key\": \"-----BEGIN PUBLIC KEY-----\\n...\\n-----END PUBLIC KEY-----\"\n    }\n  },\n  \"steps\": {\n    \"build\": {\n      \"name\": \"build\",\n      \"attestations\": [\n        {\n          \"type\": \"https://witness.dev/attestations/git/v0.1\"\n        },\n        {\n          \"type\": \"https://witness.dev/attestations/github/v0.1\"\n        },\n        {\n          \"type\": \"https://witness.dev/attestations/environment/v0.1\"\n        }\n      ],\n      \"functionaries\": [\n        {\n          \"type\": \"publickey\",\n          \"publickeyid\": \"build-key\"\n        }\n      ]\n    }\n  }\n}\n```\n\n**Witness Run Command:**\n```bash\nwitness run --step build \\\n  --attestations git,github,environment \\\n  --outfile build-attestation.json \\\n  --key signing-key.pem \\\n  -- <your-build-command>\n```\n\n**Rego Validation Rules:**\n```rego\npackage git\n\nimport rego.v1\n\n# Enforce builds from specific branch\ndeny contains msg if {\n    input.branch != \"bugfix/security\"\n    msg := sprintf(\"Must build from bugfix/security branch, got: %s\", [input.branch])\n}\n\n# Require clean working directory\ndeny contains msg if {\n    count(input.status) > 0\n    msg := \"Working directory must be clean (no uncommitted changes)\"\n}\n\n# Validate commit author\napproved_authors := {\n    \"alice.smith@example.com\",\n    \"bob.jones@company.com\",\n    \"ci-bot@company.com\"\n}\n\ndeny contains msg if {\n    not input.authoremail in approved_authors\n    msg := sprintf(\"Unauthorized commit author: %s\", [input.authoremail])\n}\n```\n\n**Verification:**\n```bash\nwitness verify \\\n  --policy policy-signed.json \\\n  --publickey policy-key.pub \\\n  -a build-attestation.json \\\n  --subject <artifact>\n```\n"}]}
{"messages": [{"role": "system", "content": "You are an expert in the Witness supply chain attestation framework. You help users instrument CI/CD pipelines with witness, create policy documents, and write Rego policies to validate attestations. You understand all attestors in go-witness and how to use them effectively."}, {"role": "user", "content": "How do I create a witness policy for a build step that uses these attestors: commandrun, environment, material, github?"}, {"role": "assistant", "content": "Here's a complete witness policy for your build step with commandrun, environment, material, github attestors:\n\n**Policy Document:**\n```json\n{\n  \"expires\": \"2026-11-08T10:52:59Z\",\n  \"publickeys\": {\n    \"build-key\": {\n      \"keyid\": \"sha256:e6a611bc202e6b4af66da55307a1fa13789538352771a6ed3597ed7390b449f3\",\n      \"key\": \"-----BEGIN PUBLIC KEY-----\\n...\\n-----END PUBLIC KEY-----\"\n    }\n  },\n  \"steps\": {\n    \"build\": {\n      \"name\": \"build\",\n      \"attestations\": [\n        {\n          \"type\": \"https://witness.dev/attestations/command-run/v0.1\"\n        },\n        {\n          \"type\": \"https://witness.dev/attestations/environment/v0.1\"\n        },\n        {\n          \"type\": \"https://witness.dev/attestations/material/v0.1\"\n        },\n        {\n          \"type\": \"https://witness.dev/attestations/github/v0.1\"\n        }\n      ],\n      \"functionaries\": [\n        {\n          \"type\": \"publickey\",\n          \"publickeyid\": \"build-key\"\n        }\n      ]\n    }\n  }\n}\n```\n\n**Witness Run Command:**\n```bash\nwitness run --step build \\\n  --attestations commandrun,environment,material,github \\\n  --outfile build-attestation.json \\\n  --key signing-key.pem \\\n  -- <your-build-command>\n```\n\n**Rego Validation Rules:**\n```rego\n\n```\n\n**Verification:**\n```bash\nwitness verify \\\n  --policy policy-signed.json \\\n  --publickey policy-key.pub \\\n  -a build-attestation.json \\\n  --subject <artifact>\n```\n"}]}
{"messages": [{"role": "system", "content": "You are an expert in the Witness supply chain attestation framework. You help users instrument CI/CD pipelines with witness, create policy documents, and write Rego policies to validate attestations. You understand all attestors in go-witness and how to use them effectively."}, {"role": "user", "content": "How do I create a multi-step witness policy for a build \u2192 test \u2192 package pipeline?"}, {"role": "assistant", "content": "Here's a complete multi-step witness policy for your pipeline:\n\n**Policy Document:**\n```json\n{\n  \"expires\": \"2026-11-08T10:52:59Z\",\n  \"publickeys\": {\n    \"ci-key\": {\n      \"keyid\": \"sha256:e643ea6967b9e5a0a026a7a238beb83ee2cd609a321cf52632c8292803f4d3e1\",\n      \"key\": \"-----BEGIN PUBLIC KEY-----\\n...\\n-----END PUBLIC KEY-----\"\n    }\n  },\n  \"steps\": {\n    \"build\": {\n      \"name\": \"build\",\n      \"attestations\": [\n        {\n          \"type\": \"https://witness.dev/attestations/git/v0.1\"\n        },\n        {\n          \"type\": \"https://witness.dev/attestations/command-run/v0.1\"\n        },\n        {\n          \"type\": \"https://witness.dev/attestations/product/v0.1\"\n        }\n      ],\n      \"functionaries\": [\n        {\n          \"type\": \"publickey\",\n          \"publickeyid\": \"ci-key\"\n        }\n      ]\n    },\n    \"test\": {\n      \"name\": \"test\",\n      \"attestations\": [\n        {\n          \"type\": \"https://witness.dev/attestations/material/v0.1\"\n        },\n        {\n          \"type\": \"https://witness.dev/attestations/command-run/v0.1\"\n        }\n      ],\n      \"functionaries\": [\n        {\n          \"type\": \"publickey\",\n          \"publickeyid\": \"ci-key\"\n        }\n      ]\n    },\n    \"package\": {\n      \"name\": \"package\",\n      \"attestations\": [\n        {\n          \"type\": \"https://witness.dev/attestations/material/v0.1\"\n        },\n        {\n          \"type\": \"https://witness.dev/attestations/product/v0.1\"\n        }\n      ],\n      \"functionaries\": [\n        {\n          \"type\": \"publickey\",\n          \"publickeyid\": \"ci-key\"\n        }\n      ]\n    }\n  }\n}\n```\n\n**Pipeline Commands:**\n\n```bash\n# Step 1: Build\nwitness run --step build \\\n  --attestations git,commandrun,product \\\n  -o build.json --key ci-key.pem \\\n  -- go build -o myapp\n\n# Step 2: Test\nwitness run --step test \\\n  --attestations material,commandrun \\\n  -o test.json --key ci-key.pem \\\n  -- go test ./...\n\n# Step 3: Package\nwitness run --step package \\\n  --attestations material,product \\\n  -o package.json --key ci-key.pem \\\n  -- tar czf myapp.tar.gz myapp\n\n# Verify entire pipeline\nwitness verify \\\n  --policy policy-signed.json \\\n  --publickey policy-key.pub \\\n  -a build.json -a test.json -a package.json\n```\n"}]}
{"messages": [{"role": "system", "content": "You are an expert in the Witness supply chain attestation framework. You help users instrument CI/CD pipelines with witness, create policy documents, and write Rego policies to validate attestations. You understand all attestors in go-witness and how to use them effectively."}, {"role": "user", "content": "How do I create a witness policy for a build step that uses these attestors: commandrun, material, environment, git?"}, {"role": "assistant", "content": "Here's a complete witness policy for your build step with commandrun, material, environment, git attestors:\n\n**Policy Document:**\n```json\n{\n  \"expires\": \"2026-11-08T10:52:59Z\",\n  \"publickeys\": {\n    \"build-key\": {\n      \"keyid\": \"sha256:c305590ac905979c399bcce54488bb6067f508bf18dc0a25ba90e583a7e626d5\",\n      \"key\": \"-----BEGIN PUBLIC KEY-----\\n...\\n-----END PUBLIC KEY-----\"\n    }\n  },\n  \"steps\": {\n    \"build\": {\n      \"name\": \"build\",\n      \"attestations\": [\n        {\n          \"type\": \"https://witness.dev/attestations/command-run/v0.1\"\n        },\n        {\n          \"type\": \"https://witness.dev/attestations/material/v0.1\"\n        },\n        {\n          \"type\": \"https://witness.dev/attestations/environment/v0.1\"\n        },\n        {\n          \"type\": \"https://witness.dev/attestations/git/v0.1\"\n        }\n      ],\n      \"functionaries\": [\n        {\n          \"type\": \"publickey\",\n          \"publickeyid\": \"build-key\"\n        }\n      ]\n    }\n  }\n}\n```\n\n**Witness Run Command:**\n```bash\nwitness run --step build \\\n  --attestations commandrun,material,environment,git \\\n  --outfile build-attestation.json \\\n  --key signing-key.pem \\\n  -- <your-build-command>\n```\n\n**Rego Validation Rules:**\n```rego\n\n```\n\n**Verification:**\n```bash\nwitness verify \\\n  --policy policy-signed.json \\\n  --publickey policy-key.pub \\\n  -a build-attestation.json \\\n  --subject <artifact>\n```\n"}]}
{"messages": [{"role": "system", "content": "You are an expert in the Witness supply chain attestation framework. You help users instrument CI/CD pipelines with witness, create policy documents, and write Rego policies to validate attestations. You understand all attestors in go-witness and how to use them effectively."}, {"role": "user", "content": "How do I create a witness policy for a build step that uses these attestors: environment?"}, {"role": "assistant", "content": "Here's a complete witness policy for your build step with environment attestors:\n\n**Policy Document:**\n```json\n{\n  \"expires\": \"2026-11-08T10:52:59Z\",\n  \"publickeys\": {\n    \"build-key\": {\n      \"keyid\": \"sha256:80855334473a4c1560736c59d6c247088d8297fa4ecec7abf93bcfaf5243d574\",\n      \"key\": \"-----BEGIN PUBLIC KEY-----\\n...\\n-----END PUBLIC KEY-----\"\n    }\n  },\n  \"steps\": {\n    \"build\": {\n      \"name\": \"build\",\n      \"attestations\": [\n        {\n          \"type\": \"https://witness.dev/attestations/environment/v0.1\"\n        }\n      ],\n      \"functionaries\": [\n        {\n          \"type\": \"publickey\",\n          \"publickeyid\": \"build-key\"\n        }\n      ]\n    }\n  }\n}\n```\n\n**Witness Run Command:**\n```bash\nwitness run --step build \\\n  --attestations environment \\\n  --outfile build-attestation.json \\\n  --key signing-key.pem \\\n  -- <your-build-command>\n```\n\n**Rego Validation Rules:**\n```rego\npackage environment\n\nimport rego.v1\n\n# Ensure correct OS\ndeny contains msg if {\n    input.os != \"windows\"\n    msg := sprintf(\"Must run on windows, got: %s\", [input.os])\n}\n\n# Require CI environment\ndeny contains msg if {\n    not \"CI\" in input.variables\n    msg := \"Must run in CI environment (CI variable not set)\"\n}\n```\n\n**Verification:**\n```bash\nwitness verify \\\n  --policy policy-signed.json \\\n  --publickey policy-key.pub \\\n  -a build-attestation.json \\\n  --subject <artifact>\n```\n"}]}
{"messages": [{"role": "system", "content": "You are an expert in the Witness supply chain attestation framework. You help users instrument CI/CD pipelines with witness, create policy documents, and write Rego policies to validate attestations. You understand all attestors in go-witness and how to use them effectively."}, {"role": "user", "content": "How do I create a witness policy for a build step that uses these attestors: github?"}, {"role": "assistant", "content": "Here's a complete witness policy for your build step with github attestors:\n\n**Policy Document:**\n```json\n{\n  \"expires\": \"2026-11-08T10:52:59Z\",\n  \"publickeys\": {\n    \"build-key\": {\n      \"keyid\": \"sha256:abb0fe32eca6b7aa431547d7ce98ad7da17c7a3dd654fb4607d494c85f084285\",\n      \"key\": \"-----BEGIN PUBLIC KEY-----\\n...\\n-----END PUBLIC KEY-----\"\n    }\n  },\n  \"steps\": {\n    \"build\": {\n      \"name\": \"build\",\n      \"attestations\": [\n        {\n          \"type\": \"https://witness.dev/attestations/github/v0.1\"\n        }\n      ],\n      \"functionaries\": [\n        {\n          \"type\": \"publickey\",\n          \"publickeyid\": \"build-key\"\n        }\n      ]\n    }\n  }\n}\n```\n\n**Witness Run Command:**\n```bash\nwitness run --step build \\\n  --attestations github \\\n  --outfile build-attestation.json \\\n  --key signing-key.pem \\\n  -- <your-build-command>\n```\n\n**Rego Validation Rules:**\n```rego\n\n```\n\n**Verification:**\n```bash\nwitness verify \\\n  --policy policy-signed.json \\\n  --publickey policy-key.pub \\\n  -a build-attestation.json \\\n  --subject <artifact>\n```\n"}]}
{"messages": [{"role": "system", "content": "You are an expert in the Witness supply chain attestation framework. You help users instrument CI/CD pipelines with witness, create policy documents, and write Rego policies to validate attestations. You understand all attestors in go-witness and how to use them effectively."}, {"role": "user", "content": "How do I create a multi-step witness policy for a build \u2192 test \u2192 package pipeline?"}, {"role": "assistant", "content": "Here's a complete multi-step witness policy for your pipeline:\n\n**Policy Document:**\n```json\n{\n  \"expires\": \"2026-11-08T10:52:59Z\",\n  \"publickeys\": {\n    \"ci-key\": {\n      \"keyid\": \"sha256:e87d8a3a5711388b889acb633763040ea3e9ec6d85eec00bac52c8fd543e18d3\",\n      \"key\": \"-----BEGIN PUBLIC KEY-----\\n...\\n-----END PUBLIC KEY-----\"\n    }\n  },\n  \"steps\": {\n    \"build\": {\n      \"name\": \"build\",\n      \"attestations\": [\n        {\n          \"type\": \"https://witness.dev/attestations/git/v0.1\"\n        },\n        {\n          \"type\": \"https://witness.dev/attestations/command-run/v0.1\"\n        },\n        {\n          \"type\": \"https://witness.dev/attestations/product/v0.1\"\n        }\n      ],\n      \"functionaries\": [\n        {\n          \"type\": \"publickey\",\n          \"publickeyid\": \"ci-key\"\n        }\n      ]\n    },\n    \"test\": {\n      \"name\": \"test\",\n      \"attestations\": [\n        {\n          \"type\": \"https://witness.dev/attestations/material/v0.1\"\n        },\n        {\n          \"type\": \"https://witness.dev/attestations/command-run/v0.1\"\n        }\n      ],\n      \"functionaries\": [\n        {\n          \"type\": \"publickey\",\n          \"publickeyid\": \"ci-key\"\n        }\n      ]\n    },\n    \"package\": {\n      \"name\": \"package\",\n      \"attestations\": [\n        {\n          \"type\": \"https://witness.dev/attestations/material/v0.1\"\n        },\n        {\n          \"type\": \"https://witness.dev/attestations/product/v0.1\"\n        }\n      ],\n      \"functionaries\": [\n        {\n          \"type\": \"publickey\",\n          \"publickeyid\": \"ci-key\"\n        }\n      ]\n    }\n  }\n}\n```\n\n**Pipeline Commands:**\n\n```bash\n# Step 1: Build\nwitness run --step build \\\n  --attestations git,commandrun,product \\\n  -o build.json --key ci-key.pem \\\n  -- go build -o myapp\n\n# Step 2: Test\nwitness run --step test \\\n  --attestations material,commandrun \\\n  -o test.json --key ci-key.pem \\\n  -- go test ./...\n\n# Step 3: Package\nwitness run --step package \\\n  --attestations material,product \\\n  -o package.json --key ci-key.pem \\\n  -- tar czf myapp.tar.gz myapp\n\n# Verify entire pipeline\nwitness verify \\\n  --policy policy-signed.json \\\n  --publickey policy-key.pub \\\n  -a build.json -a test.json -a package.json\n```\n"}]}
{"messages": [{"role": "system", "content": "You are an expert in the Witness supply chain attestation framework. You help users instrument CI/CD pipelines with witness, create policy documents, and write Rego policies to validate attestations. You understand all attestors in go-witness and how to use them effectively."}, {"role": "user", "content": "How do I create a witness policy for a build step that uses these attestors: environment, commandrun, material, git, github?"}, {"role": "assistant", "content": "Here's a complete witness policy for your build step with environment, commandrun, material, git, github attestors:\n\n**Policy Document:**\n```json\n{\n  \"expires\": \"2026-11-08T10:52:59Z\",\n  \"publickeys\": {\n    \"build-key\": {\n      \"keyid\": \"sha256:651506982ae497768e4f24b113efc0f64ccce74ad4b6eb964d517787404caa74\",\n      \"key\": \"-----BEGIN PUBLIC KEY-----\\n...\\n-----END PUBLIC KEY-----\"\n    }\n  },\n  \"steps\": {\n    \"build\": {\n      \"name\": \"build\",\n      \"attestations\": [\n        {\n          \"type\": \"https://witness.dev/attestations/environment/v0.1\"\n        },\n        {\n          \"type\": \"https://witness.dev/attestations/command-run/v0.1\"\n        },\n        {\n          \"type\": \"https://witness.dev/attestations/material/v0.1\"\n        },\n        {\n          \"type\": \"https://witness.dev/attestations/git/v0.1\"\n        },\n        {\n          \"type\": \"https://witness.dev/attestations/github/v0.1\"\n        }\n      ],\n      \"functionaries\": [\n        {\n          \"type\": \"publickey\",\n          \"publickeyid\": \"build-key\"\n        }\n      ]\n    }\n  }\n}\n```\n\n**Witness Run Command:**\n```bash\nwitness run --step build \\\n  --attestations environment,commandrun,material,git,github \\\n  --outfile build-attestation.json \\\n  --key signing-key.pem \\\n  -- <your-build-command>\n```\n\n**Rego Validation Rules:**\n```rego\npackage environment\n\nimport rego.v1\n\n# Ensure correct OS\ndeny contains msg if {\n    input.os != \"darwin\"\n    msg := sprintf(\"Must run on darwin, got: %s\", [input.os])\n}\n\n# Require CI environment\ndeny contains msg if {\n    not \"CI\" in input.variables\n    msg := \"Must run in CI environment (CI variable not set)\"\n}\n```\n\n**Verification:**\n```bash\nwitness verify \\\n  --policy policy-signed.json \\\n  --publickey policy-key.pub \\\n  -a build-attestation.json \\\n  --subject <artifact>\n```\n"}]}
{"messages": [{"role": "system", "content": "You are an expert in the Witness supply chain attestation framework. You help users instrument CI/CD pipelines with witness, create policy documents, and write Rego policies to validate attestations. You understand all attestors in go-witness and how to use them effectively."}, {"role": "user", "content": "How do I create a multi-step witness policy for a build \u2192 test \u2192 package pipeline?"}, {"role": "assistant", "content": "Here's a complete multi-step witness policy for your pipeline:\n\n**Policy Document:**\n```json\n{\n  \"expires\": \"2026-11-08T10:52:59Z\",\n  \"publickeys\": {\n    \"ci-key\": {\n      \"keyid\": \"sha256:df1da6a9a4ca9bc3ba2b12782e3131a80e64ee494bf6d450b8df1753057157a2\",\n      \"key\": \"-----BEGIN PUBLIC KEY-----\\n...\\n-----END PUBLIC KEY-----\"\n    }\n  },\n  \"steps\": {\n    \"build\": {\n      \"name\": \"build\",\n      \"attestations\": [\n        {\n          \"type\": \"https://witness.dev/attestations/git/v0.1\"\n        },\n        {\n          \"type\": \"https://witness.dev/attestations/command-run/v0.1\"\n        },\n        {\n          \"type\": \"https://witness.dev/attestations/product/v0.1\"\n        }\n      ],\n      \"functionaries\": [\n        {\n          \"type\": \"publickey\",\n          \"publickeyid\": \"ci-key\"\n        }\n      ]\n    },\n    \"test\": {\n      \"name\": \"test\",\n      \"attestations\": [\n        {\n          \"type\": \"https://witness.dev/attestations/material/v0.1\"\n        },\n        {\n          \"type\": \"https://witness.dev/attestations/command-run/v0.1\"\n        }\n      ],\n      \"functionaries\": [\n        {\n          \"type\": \"publickey\",\n          \"publickeyid\": \"ci-key\"\n        }\n      ]\n    },\n    \"package\": {\n      \"name\": \"package\",\n      \"attestations\": [\n        {\n          \"type\": \"https://witness.dev/attestations/material/v0.1\"\n        },\n        {\n          \"type\": \"https://witness.dev/attestations/product/v0.1\"\n        }\n      ],\n      \"functionaries\": [\n        {\n          \"type\": \"publickey\",\n          \"publickeyid\": \"ci-key\"\n        }\n      ]\n    }\n  }\n}\n```\n\n**Pipeline Commands:**\n\n```bash\n# Step 1: Build\nwitness run --step build \\\n  --attestations git,commandrun,product \\\n  -o build.json --key ci-key.pem \\\n  -- go build -o myapp\n\n# Step 2: Test\nwitness run --step test \\\n  --attestations material,commandrun \\\n  -o test.json --key ci-key.pem \\\n  -- go test ./...\n\n# Step 3: Package\nwitness run --step package \\\n  --attestations material,product \\\n  -o package.json --key ci-key.pem \\\n  -- tar czf myapp.tar.gz myapp\n\n# Verify entire pipeline\nwitness verify \\\n  --policy policy-signed.json \\\n  --publickey policy-key.pub \\\n  -a build.json -a test.json -a package.json\n```\n"}]}
{"messages": [{"role": "system", "content": "You are an expert in the Witness supply chain attestation framework. You help users instrument CI/CD pipelines with witness, create policy documents, and write Rego policies to validate attestations. You understand all attestors in go-witness and how to use them effectively."}, {"role": "user", "content": "How do I create a witness policy for a build step that uses these attestors: commandrun, product, git?"}, {"role": "assistant", "content": "Here's a complete witness policy for your build step with commandrun, product, git attestors:\n\n**Policy Document:**\n```json\n{\n  \"expires\": \"2026-11-08T10:52:59Z\",\n  \"publickeys\": {\n    \"build-key\": {\n      \"keyid\": \"sha256:a4c0824c44c0dda5a5c7e85ea7c921359d3c77eecda3a2c0b160603b0e0300ae\",\n      \"key\": \"-----BEGIN PUBLIC KEY-----\\n...\\n-----END PUBLIC KEY-----\"\n    }\n  },\n  \"steps\": {\n    \"build\": {\n      \"name\": \"build\",\n      \"attestations\": [\n        {\n          \"type\": \"https://witness.dev/attestations/command-run/v0.1\"\n        },\n        {\n          \"type\": \"https://witness.dev/attestations/product/v0.1\"\n        },\n        {\n          \"type\": \"https://witness.dev/attestations/git/v0.1\"\n        }\n      ],\n      \"functionaries\": [\n        {\n          \"type\": \"publickey\",\n          \"publickeyid\": \"build-key\"\n        }\n      ]\n    }\n  }\n}\n```\n\n**Witness Run Command:**\n```bash\nwitness run --step build \\\n  --attestations commandrun,product,git \\\n  --outfile build-attestation.json \\\n  --key signing-key.pem \\\n  -- <your-build-command>\n```\n\n**Rego Validation Rules:**\n```rego\n\n```\n\n**Verification:**\n```bash\nwitness verify \\\n  --policy policy-signed.json \\\n  --publickey policy-key.pub \\\n  -a build-attestation.json \\\n  --subject <artifact>\n```\n"}]}
{"messages": [{"role": "system", "content": "You are an expert in the Witness supply chain attestation framework. You help users instrument CI/CD pipelines with witness, create policy documents, and write Rego policies to validate attestations. You understand all attestors in go-witness and how to use them effectively."}, {"role": "user", "content": "How do I create a multi-step witness policy for a build \u2192 test \u2192 package pipeline?"}, {"role": "assistant", "content": "Here's a complete multi-step witness policy for your pipeline:\n\n**Policy Document:**\n```json\n{\n  \"expires\": \"2026-11-08T10:52:59Z\",\n  \"publickeys\": {\n    \"ci-key\": {\n      \"keyid\": \"sha256:c947201277e43c66938712d1f26e1a5913d0f850434258ceb494987c69b0f48d\",\n      \"key\": \"-----BEGIN PUBLIC KEY-----\\n...\\n-----END PUBLIC KEY-----\"\n    }\n  },\n  \"steps\": {\n    \"build\": {\n      \"name\": \"build\",\n      \"attestations\": [\n        {\n          \"type\": \"https://witness.dev/attestations/git/v0.1\"\n        },\n        {\n          \"type\": \"https://witness.dev/attestations/command-run/v0.1\"\n        },\n        {\n          \"type\": \"https://witness.dev/attestations/product/v0.1\"\n        }\n      ],\n      \"functionaries\": [\n        {\n          \"type\": \"publickey\",\n          \"publickeyid\": \"ci-key\"\n        }\n      ]\n    },\n    \"test\": {\n      \"name\": \"test\",\n      \"attestations\": [\n        {\n          \"type\": \"https://witness.dev/attestations/material/v0.1\"\n        },\n        {\n          \"type\": \"https://witness.dev/attestations/command-run/v0.1\"\n        }\n      ],\n      \"functionaries\": [\n        {\n          \"type\": \"publickey\",\n          \"publickeyid\": \"ci-key\"\n        }\n      ]\n    },\n    \"package\": {\n      \"name\": \"package\",\n      \"attestations\": [\n        {\n          \"type\": \"https://witness.dev/attestations/material/v0.1\"\n        },\n        {\n          \"type\": \"https://witness.dev/attestations/product/v0.1\"\n        }\n      ],\n      \"functionaries\": [\n        {\n          \"type\": \"publickey\",\n          \"publickeyid\": \"ci-key\"\n        }\n      ]\n    }\n  }\n}\n```\n\n**Pipeline Commands:**\n\n```bash\n# Step 1: Build\nwitness run --step build \\\n  --attestations git,commandrun,product \\\n  -o build.json --key ci-key.pem \\\n  -- go build -o myapp\n\n# Step 2: Test\nwitness run --step test \\\n  --attestations material,commandrun \\\n  -o test.json --key ci-key.pem \\\n  -- go test ./...\n\n# Step 3: Package\nwitness run --step package \\\n  --attestations material,product \\\n  -o package.json --key ci-key.pem \\\n  -- tar czf myapp.tar.gz myapp\n\n# Verify entire pipeline\nwitness verify \\\n  --policy policy-signed.json \\\n  --publickey policy-key.pub \\\n  -a build.json -a test.json -a package.json\n```\n"}]}
{"messages": [{"role": "system", "content": "You are an expert in the Witness supply chain attestation framework. You help users instrument CI/CD pipelines with witness, create policy documents, and write Rego policies to validate attestations. You understand all attestors in go-witness and how to use them effectively."}, {"role": "user", "content": "How do I create a witness policy for a build step that uses these attestors: github, environment, material?"}, {"role": "assistant", "content": "Here's a complete witness policy for your build step with github, environment, material attestors:\n\n**Policy Document:**\n```json\n{\n  \"expires\": \"2026-11-08T10:52:59Z\",\n  \"publickeys\": {\n    \"build-key\": {\n      \"keyid\": \"sha256:e8f4e343e0c6daf8571dc7ff148d63fdb16d7e8d0dbf953e41662aa71378cc2f\",\n      \"key\": \"-----BEGIN PUBLIC KEY-----\\n...\\n-----END PUBLIC KEY-----\"\n    }\n  },\n  \"steps\": {\n    \"build\": {\n      \"name\": \"build\",\n      \"attestations\": [\n        {\n          \"type\": \"https://witness.dev/attestations/github/v0.1\"\n        },\n        {\n          \"type\": \"https://witness.dev/attestations/environment/v0.1\"\n        },\n        {\n          \"type\": \"https://witness.dev/attestations/material/v0.1\"\n        }\n      ],\n      \"functionaries\": [\n        {\n          \"type\": \"publickey\",\n          \"publickeyid\": \"build-key\"\n        }\n      ]\n    }\n  }\n}\n```\n\n**Witness Run Command:**\n```bash\nwitness run --step build \\\n  --attestations github,environment,material \\\n  --outfile build-attestation.json \\\n  --key signing-key.pem \\\n  -- <your-build-command>\n```\n\n**Rego Validation Rules:**\n```rego\n\n```\n\n**Verification:**\n```bash\nwitness verify \\\n  --policy policy-signed.json \\\n  --publickey policy-key.pub \\\n  -a build-attestation.json \\\n  --subject <artifact>\n```\n"}]}
{"messages": [{"role": "system", "content": "You are an expert in the Witness supply chain attestation framework. You help users instrument CI/CD pipelines with witness, create policy documents, and write Rego policies to validate attestations. You understand all attestors in go-witness and how to use them effectively."}, {"role": "user", "content": "How do I create a witness policy for a build step that uses these attestors: commandrun?"}, {"role": "assistant", "content": "Here's a complete witness policy for your build step with commandrun attestors:\n\n**Policy Document:**\n```json\n{\n  \"expires\": \"2026-11-08T10:52:59Z\",\n  \"publickeys\": {\n    \"build-key\": {\n      \"keyid\": \"sha256:c804c9e845a96a0df5b865eb690eac741e9219013289094495bce9ff7eb5951d\",\n      \"key\": \"-----BEGIN PUBLIC KEY-----\\n...\\n-----END PUBLIC KEY-----\"\n    }\n  },\n  \"steps\": {\n    \"build\": {\n      \"name\": \"build\",\n      \"attestations\": [\n        {\n          \"type\": \"https://witness.dev/attestations/command-run/v0.1\"\n        }\n      ],\n      \"functionaries\": [\n        {\n          \"type\": \"publickey\",\n          \"publickeyid\": \"build-key\"\n        }\n      ]\n    }\n  }\n}\n```\n\n**Witness Run Command:**\n```bash\nwitness run --step build \\\n  --attestations commandrun \\\n  --outfile build-attestation.json \\\n  --key signing-key.pem \\\n  -- <your-build-command>\n```\n\n**Rego Validation Rules:**\n```rego\n\n```\n\n**Verification:**\n```bash\nwitness verify \\\n  --policy policy-signed.json \\\n  --publickey policy-key.pub \\\n  -a build-attestation.json \\\n  --subject <artifact>\n```\n"}]}
{"messages": [{"role": "system", "content": "You are an expert in the Witness supply chain attestation framework. You help users instrument CI/CD pipelines with witness, create policy documents, and write Rego policies to validate attestations. You understand all attestors in go-witness and how to use them effectively."}, {"role": "user", "content": "How do I create a witness policy for a build step that uses these attestors: environment, github, git?"}, {"role": "assistant", "content": "Here's a complete witness policy for your build step with environment, github, git attestors:\n\n**Policy Document:**\n```json\n{\n  \"expires\": \"2026-11-08T10:52:59Z\",\n  \"publickeys\": {\n    \"build-key\": {\n      \"keyid\": \"sha256:d3f0ecb059ced40f116d47bf4df20f697091d82ff335c894cb767f358bae67bd\",\n      \"key\": \"-----BEGIN PUBLIC KEY-----\\n...\\n-----END PUBLIC KEY-----\"\n    }\n  },\n  \"steps\": {\n    \"build\": {\n      \"name\": \"build\",\n      \"attestations\": [\n        {\n          \"type\": \"https://witness.dev/attestations/environment/v0.1\"\n        },\n        {\n          \"type\": \"https://witness.dev/attestations/github/v0.1\"\n        },\n        {\n          \"type\": \"https://witness.dev/attestations/git/v0.1\"\n        }\n      ],\n      \"functionaries\": [\n        {\n          \"type\": \"publickey\",\n          \"publickeyid\": \"build-key\"\n        }\n      ]\n    }\n  }\n}\n```\n\n**Witness Run Command:**\n```bash\nwitness run --step build \\\n  --attestations environment,github,git \\\n  --outfile build-attestation.json \\\n  --key signing-key.pem \\\n  -- <your-build-command>\n```\n\n**Rego Validation Rules:**\n```rego\npackage environment\n\nimport rego.v1\n\n# Ensure correct OS\ndeny contains msg if {\n    input.os != \"darwin\"\n    msg := sprintf(\"Must run on darwin, got: %s\", [input.os])\n}\n\n# Require CI environment\ndeny contains msg if {\n    not \"CI\" in input.variables\n    msg := \"Must run in CI environment (CI variable not set)\"\n}\n```\n\n**Verification:**\n```bash\nwitness verify \\\n  --policy policy-signed.json \\\n  --publickey policy-key.pub \\\n  -a build-attestation.json \\\n  --subject <artifact>\n```\n"}]}
{"messages": [{"role": "system", "content": "You are an expert in the Witness supply chain attestation framework. You help users instrument CI/CD pipelines with witness, create policy documents, and write Rego policies to validate attestations. You understand all attestors in go-witness and how to use them effectively."}, {"role": "user", "content": "How do I create a multi-step witness policy for a build \u2192 test \u2192 package pipeline?"}, {"role": "assistant", "content": "Here's a complete multi-step witness policy for your pipeline:\n\n**Policy Document:**\n```json\n{\n  \"expires\": \"2026-11-08T10:52:59Z\",\n  \"publickeys\": {\n    \"ci-key\": {\n      \"keyid\": \"sha256:710210596d5744572d55a2853d4a1f10f48797b181e592b57df2fe6ba0cb2b2c\",\n      \"key\": \"-----BEGIN PUBLIC KEY-----\\n...\\n-----END PUBLIC KEY-----\"\n    }\n  },\n  \"steps\": {\n    \"build\": {\n      \"name\": \"build\",\n      \"attestations\": [\n        {\n          \"type\": \"https://witness.dev/attestations/git/v0.1\"\n        },\n        {\n          \"type\": \"https://witness.dev/attestations/command-run/v0.1\"\n        },\n        {\n          \"type\": \"https://witness.dev/attestations/product/v0.1\"\n        }\n      ],\n      \"functionaries\": [\n        {\n          \"type\": \"publickey\",\n          \"publickeyid\": \"ci-key\"\n        }\n      ]\n    },\n    \"test\": {\n      \"name\": \"test\",\n      \"attestations\": [\n        {\n          \"type\": \"https://witness.dev/attestations/material/v0.1\"\n        },\n        {\n          \"type\": \"https://witness.dev/attestations/command-run/v0.1\"\n        }\n      ],\n      \"functionaries\": [\n        {\n          \"type\": \"publickey\",\n          \"publickeyid\": \"ci-key\"\n        }\n      ]\n    },\n    \"package\": {\n      \"name\": \"package\",\n      \"attestations\": [\n        {\n          \"type\": \"https://witness.dev/attestations/material/v0.1\"\n        },\n        {\n          \"type\": \"https://witness.dev/attestations/product/v0.1\"\n        }\n      ],\n      \"functionaries\": [\n        {\n          \"type\": \"publickey\",\n          \"publickeyid\": \"ci-key\"\n        }\n      ]\n    }\n  }\n}\n```\n\n**Pipeline Commands:**\n\n```bash\n# Step 1: Build\nwitness run --step build \\\n  --attestations git,commandrun,product \\\n  -o build.json --key ci-key.pem \\\n  -- go build -o myapp\n\n# Step 2: Test\nwitness run --step test \\\n  --attestations material,commandrun \\\n  -o test.json --key ci-key.pem \\\n  -- go test ./...\n\n# Step 3: Package\nwitness run --step package \\\n  --attestations material,product \\\n  -o package.json --key ci-key.pem \\\n  -- tar czf myapp.tar.gz myapp\n\n# Verify entire pipeline\nwitness verify \\\n  --policy policy-signed.json \\\n  --publickey policy-key.pub \\\n  -a build.json -a test.json -a package.json\n```\n"}]}
{"messages": [{"role": "system", "content": "You are an expert in the Witness supply chain attestation framework. You help users instrument CI/CD pipelines with witness, create policy documents, and write Rego policies to validate attestations. You understand all attestors in go-witness and how to use them effectively."}, {"role": "user", "content": "How do I create a witness policy for a build step that uses these attestors: product, environment, material?"}, {"role": "assistant", "content": "Here's a complete witness policy for your build step with product, environment, material attestors:\n\n**Policy Document:**\n```json\n{\n  \"expires\": \"2026-11-08T10:52:59Z\",\n  \"publickeys\": {\n    \"build-key\": {\n      \"keyid\": \"sha256:7375e4bd9bc15aa77a1f0f9884f9055ff3365a8ba0e59524d853456830e19618\",\n      \"key\": \"-----BEGIN PUBLIC KEY-----\\n...\\n-----END PUBLIC KEY-----\"\n    }\n  },\n  \"steps\": {\n    \"build\": {\n      \"name\": \"build\",\n      \"attestations\": [\n        {\n          \"type\": \"https://witness.dev/attestations/product/v0.1\"\n        },\n        {\n          \"type\": \"https://witness.dev/attestations/environment/v0.1\"\n        },\n        {\n          \"type\": \"https://witness.dev/attestations/material/v0.1\"\n        }\n      ],\n      \"functionaries\": [\n        {\n          \"type\": \"publickey\",\n          \"publickeyid\": \"build-key\"\n        }\n      ]\n    }\n  }\n}\n```\n\n**Witness Run Command:**\n```bash\nwitness run --step build \\\n  --attestations product,environment,material \\\n  --outfile build-attestation.json \\\n  --key signing-key.pem \\\n  -- <your-build-command>\n```\n\n**Rego Validation Rules:**\n```rego\n\n```\n\n**Verification:**\n```bash\nwitness verify \\\n  --policy policy-signed.json \\\n  --publickey policy-key.pub \\\n  -a build-attestation.json \\\n  --subject <artifact>\n```\n"}]}
{"messages": [{"role": "system", "content": "You are an expert in the Witness supply chain attestation framework. You help users instrument CI/CD pipelines with witness, create policy documents, and write Rego policies to validate attestations. You understand all attestors in go-witness and how to use them effectively."}, {"role": "user", "content": "How do I create a witness policy for a build step that uses these attestors: product, github?"}, {"role": "assistant", "content": "Here's a complete witness policy for your build step with product, github attestors:\n\n**Policy Document:**\n```json\n{\n  \"expires\": \"2026-11-08T10:52:59Z\",\n  \"publickeys\": {\n    \"build-key\": {\n      \"keyid\": \"sha256:bd2619755529ab392c3512eed921f57f37afd292ce3ea67f7b33e1018240f74d\",\n      \"key\": \"-----BEGIN PUBLIC KEY-----\\n...\\n-----END PUBLIC KEY-----\"\n    }\n  },\n  \"steps\": {\n    \"build\": {\n      \"name\": \"build\",\n      \"attestations\": [\n        {\n          \"type\": \"https://witness.dev/attestations/product/v0.1\"\n        },\n        {\n          \"type\": \"https://witness.dev/attestations/github/v0.1\"\n        }\n      ],\n      \"functionaries\": [\n        {\n          \"type\": \"publickey\",\n          \"publickeyid\": \"build-key\"\n        }\n      ]\n    }\n  }\n}\n```\n\n**Witness Run Command:**\n```bash\nwitness run --step build \\\n  --attestations product,github \\\n  --outfile build-attestation.json \\\n  --key signing-key.pem \\\n  -- <your-build-command>\n```\n\n**Rego Validation Rules:**\n```rego\n\n```\n\n**Verification:**\n```bash\nwitness verify \\\n  --policy policy-signed.json \\\n  --publickey policy-key.pub \\\n  -a build-attestation.json \\\n  --subject <artifact>\n```\n"}]}
{"messages": [{"role": "system", "content": "You are an expert in the Witness supply chain attestation framework. You help users instrument CI/CD pipelines with witness, create policy documents, and write Rego policies to validate attestations. You understand all attestors in go-witness and how to use them effectively."}, {"role": "user", "content": "How do I create a multi-step witness policy for a build \u2192 test \u2192 package pipeline?"}, {"role": "assistant", "content": "Here's a complete multi-step witness policy for your pipeline:\n\n**Policy Document:**\n```json\n{\n  \"expires\": \"2026-11-08T10:52:59Z\",\n  \"publickeys\": {\n    \"ci-key\": {\n      \"keyid\": \"sha256:741882f5f374d3f77e47c2337dfe430c29b5fc9fd774f933a2cffb6ee75e4624\",\n      \"key\": \"-----BEGIN PUBLIC KEY-----\\n...\\n-----END PUBLIC KEY-----\"\n    }\n  },\n  \"steps\": {\n    \"build\": {\n      \"name\": \"build\",\n      \"attestations\": [\n        {\n          \"type\": \"https://witness.dev/attestations/git/v0.1\"\n        },\n        {\n          \"type\": \"https://witness.dev/attestations/command-run/v0.1\"\n        },\n        {\n          \"type\": \"https://witness.dev/attestations/product/v0.1\"\n        }\n      ],\n      \"functionaries\": [\n        {\n          \"type\": \"publickey\",\n          \"publickeyid\": \"ci-key\"\n        }\n      ]\n    },\n    \"test\": {\n      \"name\": \"test\",\n      \"attestations\": [\n        {\n          \"type\": \"https://witness.dev/attestations/material/v0.1\"\n        },\n        {\n          \"type\": \"https://witness.dev/attestations/command-run/v0.1\"\n        }\n      ],\n      \"functionaries\": [\n        {\n          \"type\": \"publickey\",\n          \"publickeyid\": \"ci-key\"\n        }\n      ]\n    },\n    \"package\": {\n      \"name\": \"package\",\n      \"attestations\": [\n        {\n          \"type\": \"https://witness.dev/attestations/material/v0.1\"\n        },\n        {\n          \"type\": \"https://witness.dev/attestations/product/v0.1\"\n        }\n      ],\n      \"functionaries\": [\n        {\n          \"type\": \"publickey\",\n          \"publickeyid\": \"ci-key\"\n        }\n      ]\n    }\n  }\n}\n```\n\n**Pipeline Commands:**\n\n```bash\n# Step 1: Build\nwitness run --step build \\\n  --attestations git,commandrun,product \\\n  -o build.json --key ci-key.pem \\\n  -- go build -o myapp\n\n# Step 2: Test\nwitness run --step test \\\n  --attestations material,commandrun \\\n  -o test.json --key ci-key.pem \\\n  -- go test ./...\n\n# Step 3: Package\nwitness run --step package \\\n  --attestations material,product \\\n  -o package.json --key ci-key.pem \\\n  -- tar czf myapp.tar.gz myapp\n\n# Verify entire pipeline\nwitness verify \\\n  --policy policy-signed.json \\\n  --publickey policy-key.pub \\\n  -a build.json -a test.json -a package.json\n```\n"}]}
{"messages": [{"role": "system", "content": "You are an expert in the Witness supply chain attestation framework. You help users instrument CI/CD pipelines with witness, create policy documents, and write Rego policies to validate attestations. You understand all attestors in go-witness and how to use them effectively."}, {"role": "user", "content": "How do I create a multi-step witness policy for a build \u2192 test \u2192 package pipeline?"}, {"role": "assistant", "content": "Here's a complete multi-step witness policy for your pipeline:\n\n**Policy Document:**\n```json\n{\n  \"expires\": \"2026-11-08T10:52:59Z\",\n  \"publickeys\": {\n    \"ci-key\": {\n      \"keyid\": \"sha256:4f0d0f319c7f71a4e6a7cf71f28a179f741871f1e63d852a845831d8cefbecd7\",\n      \"key\": \"-----BEGIN PUBLIC KEY-----\\n...\\n-----END PUBLIC KEY-----\"\n    }\n  },\n  \"steps\": {\n    \"build\": {\n      \"name\": \"build\",\n      \"attestations\": [\n        {\n          \"type\": \"https://witness.dev/attestations/git/v0.1\"\n        },\n        {\n          \"type\": \"https://witness.dev/attestations/command-run/v0.1\"\n        },\n        {\n          \"type\": \"https://witness.dev/attestations/product/v0.1\"\n        }\n      ],\n      \"functionaries\": [\n        {\n          \"type\": \"publickey\",\n          \"publickeyid\": \"ci-key\"\n        }\n      ]\n    },\n    \"test\": {\n      \"name\": \"test\",\n      \"attestations\": [\n        {\n          \"type\": \"https://witness.dev/attestations/material/v0.1\"\n        },\n        {\n          \"type\": \"https://witness.dev/attestations/command-run/v0.1\"\n        }\n      ],\n      \"functionaries\": [\n        {\n          \"type\": \"publickey\",\n          \"publickeyid\": \"ci-key\"\n        }\n      ]\n    },\n    \"package\": {\n      \"name\": \"package\",\n      \"attestations\": [\n        {\n          \"type\": \"https://witness.dev/attestations/material/v0.1\"\n        },\n        {\n          \"type\": \"https://witness.dev/attestations/product/v0.1\"\n        }\n      ],\n      \"functionaries\": [\n        {\n          \"type\": \"publickey\",\n          \"publickeyid\": \"ci-key\"\n        }\n      ]\n    }\n  }\n}\n```\n\n**Pipeline Commands:**\n\n```bash\n# Step 1: Build\nwitness run --step build \\\n  --attestations git,commandrun,product \\\n  -o build.json --key ci-key.pem \\\n  -- go build -o myapp\n\n# Step 2: Test\nwitness run --step test \\\n  --attestations material,commandrun \\\n  -o test.json --key ci-key.pem \\\n  -- go test ./...\n\n# Step 3: Package\nwitness run --step package \\\n  --attestations material,product \\\n  -o package.json --key ci-key.pem \\\n  -- tar czf myapp.tar.gz myapp\n\n# Verify entire pipeline\nwitness verify \\\n  --policy policy-signed.json \\\n  --publickey policy-key.pub \\\n  -a build.json -a test.json -a package.json\n```\n"}]}
{"messages": [{"role": "system", "content": "You are an expert in the Witness supply chain attestation framework. You help users instrument CI/CD pipelines with witness, create policy documents, and write Rego policies to validate attestations. You understand all attestors in go-witness and how to use them effectively."}, {"role": "user", "content": "How do I create a multi-step witness policy for a build \u2192 test \u2192 package pipeline?"}, {"role": "assistant", "content": "Here's a complete multi-step witness policy for your pipeline:\n\n**Policy Document:**\n```json\n{\n  \"expires\": \"2026-11-08T10:52:59Z\",\n  \"publickeys\": {\n    \"ci-key\": {\n      \"keyid\": \"sha256:31f29620e2873347596d76ea2ccf49dee4a86889ddf6fd11e97b1ae06b1775fc\",\n      \"key\": \"-----BEGIN PUBLIC KEY-----\\n...\\n-----END PUBLIC KEY-----\"\n    }\n  },\n  \"steps\": {\n    \"build\": {\n      \"name\": \"build\",\n      \"attestations\": [\n        {\n          \"type\": \"https://witness.dev/attestations/git/v0.1\"\n        },\n        {\n          \"type\": \"https://witness.dev/attestations/command-run/v0.1\"\n        },\n        {\n          \"type\": \"https://witness.dev/attestations/product/v0.1\"\n        }\n      ],\n      \"functionaries\": [\n        {\n          \"type\": \"publickey\",\n          \"publickeyid\": \"ci-key\"\n        }\n      ]\n    },\n    \"test\": {\n      \"name\": \"test\",\n      \"attestations\": [\n        {\n          \"type\": \"https://witness.dev/attestations/material/v0.1\"\n        },\n        {\n          \"type\": \"https://witness.dev/attestations/command-run/v0.1\"\n        }\n      ],\n      \"functionaries\": [\n        {\n          \"type\": \"publickey\",\n          \"publickeyid\": \"ci-key\"\n        }\n      ]\n    },\n    \"package\": {\n      \"name\": \"package\",\n      \"attestations\": [\n        {\n          \"type\": \"https://witness.dev/attestations/material/v0.1\"\n        },\n        {\n          \"type\": \"https://witness.dev/attestations/product/v0.1\"\n        }\n      ],\n      \"functionaries\": [\n        {\n          \"type\": \"publickey\",\n          \"publickeyid\": \"ci-key\"\n        }\n      ]\n    }\n  }\n}\n```\n\n**Pipeline Commands:**\n\n```bash\n# Step 1: Build\nwitness run --step build \\\n  --attestations git,commandrun,product \\\n  -o build.json --key ci-key.pem \\\n  -- go build -o myapp\n\n# Step 2: Test\nwitness run --step test \\\n  --attestations material,commandrun \\\n  -o test.json --key ci-key.pem \\\n  -- go test ./...\n\n# Step 3: Package\nwitness run --step package \\\n  --attestations material,product \\\n  -o package.json --key ci-key.pem \\\n  -- tar czf myapp.tar.gz myapp\n\n# Verify entire pipeline\nwitness verify \\\n  --policy policy-signed.json \\\n  --publickey policy-key.pub \\\n  -a build.json -a test.json -a package.json\n```\n"}]}
{"messages": [{"role": "system", "content": "You are an expert in the Witness supply chain attestation framework. You help users instrument CI/CD pipelines with witness, create policy documents, and write Rego policies to validate attestations. You understand all attestors in go-witness and how to use them effectively."}, {"role": "user", "content": "How do I create a witness policy for a build step that uses these attestors: git, product, material, commandrun, environment?"}, {"role": "assistant", "content": "Here's a complete witness policy for your build step with git, product, material, commandrun, environment attestors:\n\n**Policy Document:**\n```json\n{\n  \"expires\": \"2026-11-08T10:52:59Z\",\n  \"publickeys\": {\n    \"build-key\": {\n      \"keyid\": \"sha256:2231f44e757e5944c7ba574764c4adf6f0afaaa1a1f711e091b91c07721317b7\",\n      \"key\": \"-----BEGIN PUBLIC KEY-----\\n...\\n-----END PUBLIC KEY-----\"\n    }\n  },\n  \"steps\": {\n    \"build\": {\n      \"name\": \"build\",\n      \"attestations\": [\n        {\n          \"type\": \"https://witness.dev/attestations/git/v0.1\"\n        },\n        {\n          \"type\": \"https://witness.dev/attestations/product/v0.1\"\n        },\n        {\n          \"type\": \"https://witness.dev/attestations/material/v0.1\"\n        },\n        {\n          \"type\": \"https://witness.dev/attestations/command-run/v0.1\"\n        },\n        {\n          \"type\": \"https://witness.dev/attestations/environment/v0.1\"\n        }\n      ],\n      \"functionaries\": [\n        {\n          \"type\": \"publickey\",\n          \"publickeyid\": \"build-key\"\n        }\n      ]\n    }\n  }\n}\n```\n\n**Witness Run Command:**\n```bash\nwitness run --step build \\\n  --attestations git,product,material,commandrun,environment \\\n  --outfile build-attestation.json \\\n  --key signing-key.pem \\\n  -- <your-build-command>\n```\n\n**Rego Validation Rules:**\n```rego\npackage git\n\nimport rego.v1\n\n# Enforce builds from specific branch\ndeny contains msg if {\n    input.branch != \"feature/api\"\n    msg := sprintf(\"Must build from feature/api branch, got: %s\", [input.branch])\n}\n\n# Require clean working directory\ndeny contains msg if {\n    count(input.status) > 0\n    msg := \"Working directory must be clean (no uncommitted changes)\"\n}\n\n# Validate commit author\napproved_authors := {\n    \"alice.smith@example.com\",\n    \"bob.jones@company.com\",\n    \"ci-bot@company.com\"\n}\n\ndeny contains msg if {\n    not input.authoremail in approved_authors\n    msg := sprintf(\"Unauthorized commit author: %s\", [input.authoremail])\n}\n```\n\n**Verification:**\n```bash\nwitness verify \\\n  --policy policy-signed.json \\\n  --publickey policy-key.pub \\\n  -a build-attestation.json \\\n  --subject <artifact>\n```\n"}]}
{"messages": [{"role": "system", "content": "You are an expert in the Witness supply chain attestation framework. You help users instrument CI/CD pipelines with witness, create policy documents, and write Rego policies to validate attestations. You understand all attestors in go-witness and how to use them effectively."}, {"role": "user", "content": "How do I create a witness policy for a build step that uses these attestors: commandrun, material?"}, {"role": "assistant", "content": "Here's a complete witness policy for your build step with commandrun, material attestors:\n\n**Policy Document:**\n```json\n{\n  \"expires\": \"2026-11-08T10:52:59Z\",\n  \"publickeys\": {\n    \"build-key\": {\n      \"keyid\": \"sha256:219375ef9e5b8c4e82a843625971b1337570db0e4ec05c2203a9c5cb6626dfe3\",\n      \"key\": \"-----BEGIN PUBLIC KEY-----\\n...\\n-----END PUBLIC KEY-----\"\n    }\n  },\n  \"steps\": {\n    \"build\": {\n      \"name\": \"build\",\n      \"attestations\": [\n        {\n          \"type\": \"https://witness.dev/attestations/command-run/v0.1\"\n        },\n        {\n          \"type\": \"https://witness.dev/attestations/material/v0.1\"\n        }\n      ],\n      \"functionaries\": [\n        {\n          \"type\": \"publickey\",\n          \"publickeyid\": \"build-key\"\n        }\n      ]\n    }\n  }\n}\n```\n\n**Witness Run Command:**\n```bash\nwitness run --step build \\\n  --attestations commandrun,material \\\n  --outfile build-attestation.json \\\n  --key signing-key.pem \\\n  -- <your-build-command>\n```\n\n**Rego Validation Rules:**\n```rego\n\n```\n\n**Verification:**\n```bash\nwitness verify \\\n  --policy policy-signed.json \\\n  --publickey policy-key.pub \\\n  -a build-attestation.json \\\n  --subject <artifact>\n```\n"}]}
{"messages": [{"role": "system", "content": "You are an expert in the Witness supply chain attestation framework. You help users instrument CI/CD pipelines with witness, create policy documents, and write Rego policies to validate attestations. You understand all attestors in go-witness and how to use them effectively."}, {"role": "user", "content": "How do I create a witness policy for a build step that uses these attestors: product?"}, {"role": "assistant", "content": "Here's a complete witness policy for your build step with product attestors:\n\n**Policy Document:**\n```json\n{\n  \"expires\": \"2026-11-08T10:52:59Z\",\n  \"publickeys\": {\n    \"build-key\": {\n      \"keyid\": \"sha256:e93808f8ecf8bb7ebd5e758eb140c812fe4ee67346ed3bdc2b16a6c112ec389f\",\n      \"key\": \"-----BEGIN PUBLIC KEY-----\\n...\\n-----END PUBLIC KEY-----\"\n    }\n  },\n  \"steps\": {\n    \"build\": {\n      \"name\": \"build\",\n      \"attestations\": [\n        {\n          \"type\": \"https://witness.dev/attestations/product/v0.1\"\n        }\n      ],\n      \"functionaries\": [\n        {\n          \"type\": \"publickey\",\n          \"publickeyid\": \"build-key\"\n        }\n      ]\n    }\n  }\n}\n```\n\n**Witness Run Command:**\n```bash\nwitness run --step build \\\n  --attestations product \\\n  --outfile build-attestation.json \\\n  --key signing-key.pem \\\n  -- <your-build-command>\n```\n\n**Rego Validation Rules:**\n```rego\n\n```\n\n**Verification:**\n```bash\nwitness verify \\\n  --policy policy-signed.json \\\n  --publickey policy-key.pub \\\n  -a build-attestation.json \\\n  --subject <artifact>\n```\n"}]}
{"messages": [{"role": "system", "content": "You are an expert in the Witness supply chain attestation framework. You help users instrument CI/CD pipelines with witness, create policy documents, and write Rego policies to validate attestations. You understand all attestors in go-witness and how to use them effectively."}, {"role": "user", "content": "How do I create a witness policy for a build step that uses these attestors: github?"}, {"role": "assistant", "content": "Here's a complete witness policy for your build step with github attestors:\n\n**Policy Document:**\n```json\n{\n  \"expires\": \"2026-11-08T10:52:59Z\",\n  \"publickeys\": {\n    \"build-key\": {\n      \"keyid\": \"sha256:ee5fddb662b85ddd3baa6147cf4a390073cb55d519a2dbaa34caa830f4e31e2e\",\n      \"key\": \"-----BEGIN PUBLIC KEY-----\\n...\\n-----END PUBLIC KEY-----\"\n    }\n  },\n  \"steps\": {\n    \"build\": {\n      \"name\": \"build\",\n      \"attestations\": [\n        {\n          \"type\": \"https://witness.dev/attestations/github/v0.1\"\n        }\n      ],\n      \"functionaries\": [\n        {\n          \"type\": \"publickey\",\n          \"publickeyid\": \"build-key\"\n        }\n      ]\n    }\n  }\n}\n```\n\n**Witness Run Command:**\n```bash\nwitness run --step build \\\n  --attestations github \\\n  --outfile build-attestation.json \\\n  --key signing-key.pem \\\n  -- <your-build-command>\n```\n\n**Rego Validation Rules:**\n```rego\n\n```\n\n**Verification:**\n```bash\nwitness verify \\\n  --policy policy-signed.json \\\n  --publickey policy-key.pub \\\n  -a build-attestation.json \\\n  --subject <artifact>\n```\n"}]}
{"messages": [{"role": "system", "content": "You are an expert in the Witness supply chain attestation framework. You help users instrument CI/CD pipelines with witness, create policy documents, and write Rego policies to validate attestations. You understand all attestors in go-witness and how to use them effectively."}, {"role": "user", "content": "How do I create a witness policy for a build step that uses these attestors: git, github, product, material, environment?"}, {"role": "assistant", "content": "Here's a complete witness policy for your build step with git, github, product, material, environment attestors:\n\n**Policy Document:**\n```json\n{\n  \"expires\": \"2026-11-08T10:52:59Z\",\n  \"publickeys\": {\n    \"build-key\": {\n      \"keyid\": \"sha256:cfa62fe7be3dbb8faa0784d0dd20ed61d191ae7c33e7a857cfec52a7124a9256\",\n      \"key\": \"-----BEGIN PUBLIC KEY-----\\n...\\n-----END PUBLIC KEY-----\"\n    }\n  },\n  \"steps\": {\n    \"build\": {\n      \"name\": \"build\",\n      \"attestations\": [\n        {\n          \"type\": \"https://witness.dev/attestations/git/v0.1\"\n        },\n        {\n          \"type\": \"https://witness.dev/attestations/github/v0.1\"\n        },\n        {\n          \"type\": \"https://witness.dev/attestations/product/v0.1\"\n        },\n        {\n          \"type\": \"https://witness.dev/attestations/material/v0.1\"\n        },\n        {\n          \"type\": \"https://witness.dev/attestations/environment/v0.1\"\n        }\n      ],\n      \"functionaries\": [\n        {\n          \"type\": \"publickey\",\n          \"publickeyid\": \"build-key\"\n        }\n      ]\n    }\n  }\n}\n```\n\n**Witness Run Command:**\n```bash\nwitness run --step build \\\n  --attestations git,github,product,material,environment \\\n  --outfile build-attestation.json \\\n  --key signing-key.pem \\\n  -- <your-build-command>\n```\n\n**Rego Validation Rules:**\n```rego\npackage git\n\nimport rego.v1\n\n# Enforce builds from specific branch\ndeny contains msg if {\n    input.branch != \"release/v1.0\"\n    msg := sprintf(\"Must build from release/v1.0 branch, got: %s\", [input.branch])\n}\n\n# Require clean working directory\ndeny contains msg if {\n    count(input.status) > 0\n    msg := \"Working directory must be clean (no uncommitted changes)\"\n}\n\n# Validate commit author\napproved_authors := {\n    \"alice.smith@example.com\",\n    \"bob.jones@company.com\",\n    \"ci-bot@company.com\"\n}\n\ndeny contains msg if {\n    not input.authoremail in approved_authors\n    msg := sprintf(\"Unauthorized commit author: %s\", [input.authoremail])\n}\n```\n\n**Verification:**\n```bash\nwitness verify \\\n  --policy policy-signed.json \\\n  --publickey policy-key.pub \\\n  -a build-attestation.json \\\n  --subject <artifact>\n```\n"}]}
{"messages": [{"role": "system", "content": "You are an expert in the Witness supply chain attestation framework. You help users instrument CI/CD pipelines with witness, create policy documents, and write Rego policies to validate attestations. You understand all attestors in go-witness and how to use them effectively."}, {"role": "user", "content": "How do I create a witness policy for a build step that uses these attestors: product, material?"}, {"role": "assistant", "content": "Here's a complete witness policy for your build step with product, material attestors:\n\n**Policy Document:**\n```json\n{\n  \"expires\": \"2026-11-08T10:52:59Z\",\n  \"publickeys\": {\n    \"build-key\": {\n      \"keyid\": \"sha256:48c020ece46ce5df7638d386419da5c7c3c29ecca383835cc570e008b4674170\",\n      \"key\": \"-----BEGIN PUBLIC KEY-----\\n...\\n-----END PUBLIC KEY-----\"\n    }\n  },\n  \"steps\": {\n    \"build\": {\n      \"name\": \"build\",\n      \"attestations\": [\n        {\n          \"type\": \"https://witness.dev/attestations/product/v0.1\"\n        },\n        {\n          \"type\": \"https://witness.dev/attestations/material/v0.1\"\n        }\n      ],\n      \"functionaries\": [\n        {\n          \"type\": \"publickey\",\n          \"publickeyid\": \"build-key\"\n        }\n      ]\n    }\n  }\n}\n```\n\n**Witness Run Command:**\n```bash\nwitness run --step build \\\n  --attestations product,material \\\n  --outfile build-attestation.json \\\n  --key signing-key.pem \\\n  -- <your-build-command>\n```\n\n**Rego Validation Rules:**\n```rego\n\n```\n\n**Verification:**\n```bash\nwitness verify \\\n  --policy policy-signed.json \\\n  --publickey policy-key.pub \\\n  -a build-attestation.json \\\n  --subject <artifact>\n```\n"}]}
{"messages": [{"role": "system", "content": "You are an expert in the Witness supply chain attestation framework. You help users instrument CI/CD pipelines with witness, create policy documents, and write Rego policies to validate attestations. You understand all attestors in go-witness and how to use them effectively."}, {"role": "user", "content": "How do I create a witness policy for a build step that uses these attestors: github?"}, {"role": "assistant", "content": "Here's a complete witness policy for your build step with github attestors:\n\n**Policy Document:**\n```json\n{\n  \"expires\": \"2026-11-08T10:52:59Z\",\n  \"publickeys\": {\n    \"build-key\": {\n      \"keyid\": \"sha256:baf619cb664c6a689a7e2c8e4081b9c9b488cc724a2d5ed8f559769bf5be74de\",\n      \"key\": \"-----BEGIN PUBLIC KEY-----\\n...\\n-----END PUBLIC KEY-----\"\n    }\n  },\n  \"steps\": {\n    \"build\": {\n      \"name\": \"build\",\n      \"attestations\": [\n        {\n          \"type\": \"https://witness.dev/attestations/github/v0.1\"\n        }\n      ],\n      \"functionaries\": [\n        {\n          \"type\": \"publickey\",\n          \"publickeyid\": \"build-key\"\n        }\n      ]\n    }\n  }\n}\n```\n\n**Witness Run Command:**\n```bash\nwitness run --step build \\\n  --attestations github \\\n  --outfile build-attestation.json \\\n  --key signing-key.pem \\\n  -- <your-build-command>\n```\n\n**Rego Validation Rules:**\n```rego\n\n```\n\n**Verification:**\n```bash\nwitness verify \\\n  --policy policy-signed.json \\\n  --publickey policy-key.pub \\\n  -a build-attestation.json \\\n  --subject <artifact>\n```\n"}]}
{"messages": [{"role": "system", "content": "You are an expert in the Witness supply chain attestation framework. You help users instrument CI/CD pipelines with witness, create policy documents, and write Rego policies to validate attestations. You understand all attestors in go-witness and how to use them effectively."}, {"role": "user", "content": "How do I create a witness policy for a build step that uses these attestors: github, git, commandrun, product?"}, {"role": "assistant", "content": "Here's a complete witness policy for your build step with github, git, commandrun, product attestors:\n\n**Policy Document:**\n```json\n{\n  \"expires\": \"2026-11-08T10:52:59Z\",\n  \"publickeys\": {\n    \"build-key\": {\n      \"keyid\": \"sha256:2ffbfc6ca519cbe3b4a0e6c3bdbba2278fdd28ee96e50ad7ae6ae3c5237a9546\",\n      \"key\": \"-----BEGIN PUBLIC KEY-----\\n...\\n-----END PUBLIC KEY-----\"\n    }\n  },\n  \"steps\": {\n    \"build\": {\n      \"name\": \"build\",\n      \"attestations\": [\n        {\n          \"type\": \"https://witness.dev/attestations/github/v0.1\"\n        },\n        {\n          \"type\": \"https://witness.dev/attestations/git/v0.1\"\n        },\n        {\n          \"type\": \"https://witness.dev/attestations/command-run/v0.1\"\n        },\n        {\n          \"type\": \"https://witness.dev/attestations/product/v0.1\"\n        }\n      ],\n      \"functionaries\": [\n        {\n          \"type\": \"publickey\",\n          \"publickeyid\": \"build-key\"\n        }\n      ]\n    }\n  }\n}\n```\n\n**Witness Run Command:**\n```bash\nwitness run --step build \\\n  --attestations github,git,commandrun,product \\\n  --outfile build-attestation.json \\\n  --key signing-key.pem \\\n  -- <your-build-command>\n```\n\n**Rego Validation Rules:**\n```rego\n\n```\n\n**Verification:**\n```bash\nwitness verify \\\n  --policy policy-signed.json \\\n  --publickey policy-key.pub \\\n  -a build-attestation.json \\\n  --subject <artifact>\n```\n"}]}
{"messages": [{"role": "system", "content": "You are an expert in the Witness supply chain attestation framework. You help users instrument CI/CD pipelines with witness, create policy documents, and write Rego policies to validate attestations. You understand all attestors in go-witness and how to use them effectively."}, {"role": "user", "content": "How do I create a witness policy for a build step that uses these attestors: git?"}, {"role": "assistant", "content": "Here's a complete witness policy for your build step with git attestors:\n\n**Policy Document:**\n```json\n{\n  \"expires\": \"2026-11-08T10:52:59Z\",\n  \"publickeys\": {\n    \"build-key\": {\n      \"keyid\": \"sha256:49c6dc731af77944f5acff705c24f04189d8cebc01353a9c2e250f8b64f2c4ce\",\n      \"key\": \"-----BEGIN PUBLIC KEY-----\\n...\\n-----END PUBLIC KEY-----\"\n    }\n  },\n  \"steps\": {\n    \"build\": {\n      \"name\": \"build\",\n      \"attestations\": [\n        {\n          \"type\": \"https://witness.dev/attestations/git/v0.1\"\n        }\n      ],\n      \"functionaries\": [\n        {\n          \"type\": \"publickey\",\n          \"publickeyid\": \"build-key\"\n        }\n      ]\n    }\n  }\n}\n```\n\n**Witness Run Command:**\n```bash\nwitness run --step build \\\n  --attestations git \\\n  --outfile build-attestation.json \\\n  --key signing-key.pem \\\n  -- <your-build-command>\n```\n\n**Rego Validation Rules:**\n```rego\npackage git\n\nimport rego.v1\n\n# Enforce builds from specific branch\ndeny contains msg if {\n    input.branch != \"master\"\n    msg := sprintf(\"Must build from master branch, got: %s\", [input.branch])\n}\n\n# Require clean working directory\ndeny contains msg if {\n    count(input.status) > 0\n    msg := \"Working directory must be clean (no uncommitted changes)\"\n}\n\n# Validate commit author\napproved_authors := {\n    \"alice.smith@example.com\",\n    \"bob.jones@company.com\",\n    \"ci-bot@company.com\"\n}\n\ndeny contains msg if {\n    not input.authoremail in approved_authors\n    msg := sprintf(\"Unauthorized commit author: %s\", [input.authoremail])\n}\n```\n\n**Verification:**\n```bash\nwitness verify \\\n  --policy policy-signed.json \\\n  --publickey policy-key.pub \\\n  -a build-attestation.json \\\n  --subject <artifact>\n```\n"}]}
{"messages": [{"role": "system", "content": "You are an expert in the Witness supply chain attestation framework. You help users instrument CI/CD pipelines with witness, create policy documents, and write Rego policies to validate attestations. You understand all attestors in go-witness and how to use them effectively."}, {"role": "user", "content": "How do I create a multi-step witness policy for a build \u2192 test \u2192 package pipeline?"}, {"role": "assistant", "content": "Here's a complete multi-step witness policy for your pipeline:\n\n**Policy Document:**\n```json\n{\n  \"expires\": \"2026-11-08T10:52:59Z\",\n  \"publickeys\": {\n    \"ci-key\": {\n      \"keyid\": \"sha256:32525060e769afacb1afc939571746d74125c237d42f24423797f325c65591fc\",\n      \"key\": \"-----BEGIN PUBLIC KEY-----\\n...\\n-----END PUBLIC KEY-----\"\n    }\n  },\n  \"steps\": {\n    \"build\": {\n      \"name\": \"build\",\n      \"attestations\": [\n        {\n          \"type\": \"https://witness.dev/attestations/git/v0.1\"\n        },\n        {\n          \"type\": \"https://witness.dev/attestations/command-run/v0.1\"\n        },\n        {\n          \"type\": \"https://witness.dev/attestations/product/v0.1\"\n        }\n      ],\n      \"functionaries\": [\n        {\n          \"type\": \"publickey\",\n          \"publickeyid\": \"ci-key\"\n        }\n      ]\n    },\n    \"test\": {\n      \"name\": \"test\",\n      \"attestations\": [\n        {\n          \"type\": \"https://witness.dev/attestations/material/v0.1\"\n        },\n        {\n          \"type\": \"https://witness.dev/attestations/command-run/v0.1\"\n        }\n      ],\n      \"functionaries\": [\n        {\n          \"type\": \"publickey\",\n          \"publickeyid\": \"ci-key\"\n        }\n      ]\n    },\n    \"package\": {\n      \"name\": \"package\",\n      \"attestations\": [\n        {\n          \"type\": \"https://witness.dev/attestations/material/v0.1\"\n        },\n        {\n          \"type\": \"https://witness.dev/attestations/product/v0.1\"\n        }\n      ],\n      \"functionaries\": [\n        {\n          \"type\": \"publickey\",\n          \"publickeyid\": \"ci-key\"\n        }\n      ]\n    }\n  }\n}\n```\n\n**Pipeline Commands:**\n\n```bash\n# Step 1: Build\nwitness run --step build \\\n  --attestations git,commandrun,product \\\n  -o build.json --key ci-key.pem \\\n  -- go build -o myapp\n\n# Step 2: Test\nwitness run --step test \\\n  --attestations material,commandrun \\\n  -o test.json --key ci-key.pem \\\n  -- go test ./...\n\n# Step 3: Package\nwitness run --step package \\\n  --attestations material,product \\\n  -o package.json --key ci-key.pem \\\n  -- tar czf myapp.tar.gz myapp\n\n# Verify entire pipeline\nwitness verify \\\n  --policy policy-signed.json \\\n  --publickey policy-key.pub \\\n  -a build.json -a test.json -a package.json\n```\n"}]}
{"messages": [{"role": "system", "content": "You are an expert in the Witness supply chain attestation framework. You help users instrument CI/CD pipelines with witness, create policy documents, and write Rego policies to validate attestations. You understand all attestors in go-witness and how to use them effectively."}, {"role": "user", "content": "How do I create a witness policy for a build step that uses these attestors: github, environment?"}, {"role": "assistant", "content": "Here's a complete witness policy for your build step with github, environment attestors:\n\n**Policy Document:**\n```json\n{\n  \"expires\": \"2026-11-08T10:52:59Z\",\n  \"publickeys\": {\n    \"build-key\": {\n      \"keyid\": \"sha256:8061d745b35a8487777a926016fdc8087689ad0e587d090d63257484de9daec6\",\n      \"key\": \"-----BEGIN PUBLIC KEY-----\\n...\\n-----END PUBLIC KEY-----\"\n    }\n  },\n  \"steps\": {\n    \"build\": {\n      \"name\": \"build\",\n      \"attestations\": [\n        {\n          \"type\": \"https://witness.dev/attestations/github/v0.1\"\n        },\n        {\n          \"type\": \"https://witness.dev/attestations/environment/v0.1\"\n        }\n      ],\n      \"functionaries\": [\n        {\n          \"type\": \"publickey\",\n          \"publickeyid\": \"build-key\"\n        }\n      ]\n    }\n  }\n}\n```\n\n**Witness Run Command:**\n```bash\nwitness run --step build \\\n  --attestations github,environment \\\n  --outfile build-attestation.json \\\n  --key signing-key.pem \\\n  -- <your-build-command>\n```\n\n**Rego Validation Rules:**\n```rego\n\n```\n\n**Verification:**\n```bash\nwitness verify \\\n  --policy policy-signed.json \\\n  --publickey policy-key.pub \\\n  -a build-attestation.json \\\n  --subject <artifact>\n```\n"}]}
{"messages": [{"role": "system", "content": "You are an expert in the Witness supply chain attestation framework. You help users instrument CI/CD pipelines with witness, create policy documents, and write Rego policies to validate attestations. You understand all attestors in go-witness and how to use them effectively."}, {"role": "user", "content": "How do I create a witness policy for a build step that uses these attestors: github?"}, {"role": "assistant", "content": "Here's a complete witness policy for your build step with github attestors:\n\n**Policy Document:**\n```json\n{\n  \"expires\": \"2026-11-08T10:52:59Z\",\n  \"publickeys\": {\n    \"build-key\": {\n      \"keyid\": \"sha256:e6f0331971d67971b43aff6b9ac09d7427b39e37da53f050d2ee145fa4745edd\",\n      \"key\": \"-----BEGIN PUBLIC KEY-----\\n...\\n-----END PUBLIC KEY-----\"\n    }\n  },\n  \"steps\": {\n    \"build\": {\n      \"name\": \"build\",\n      \"attestations\": [\n        {\n          \"type\": \"https://witness.dev/attestations/github/v0.1\"\n        }\n      ],\n      \"functionaries\": [\n        {\n          \"type\": \"publickey\",\n          \"publickeyid\": \"build-key\"\n        }\n      ]\n    }\n  }\n}\n```\n\n**Witness Run Command:**\n```bash\nwitness run --step build \\\n  --attestations github \\\n  --outfile build-attestation.json \\\n  --key signing-key.pem \\\n  -- <your-build-command>\n```\n\n**Rego Validation Rules:**\n```rego\n\n```\n\n**Verification:**\n```bash\nwitness verify \\\n  --policy policy-signed.json \\\n  --publickey policy-key.pub \\\n  -a build-attestation.json \\\n  --subject <artifact>\n```\n"}]}
{"messages": [{"role": "system", "content": "You are an expert in the Witness supply chain attestation framework. You help users instrument CI/CD pipelines with witness, create policy documents, and write Rego policies to validate attestations. You understand all attestors in go-witness and how to use them effectively."}, {"role": "user", "content": "How do I create a witness policy for a build step that uses these attestors: git?"}, {"role": "assistant", "content": "Here's a complete witness policy for your build step with git attestors:\n\n**Policy Document:**\n```json\n{\n  \"expires\": \"2026-11-08T10:52:59Z\",\n  \"publickeys\": {\n    \"build-key\": {\n      \"keyid\": \"sha256:350a11d47b23747cb07d8455bc58dbbdb129ed0d93f51eaa0c1788731596544f\",\n      \"key\": \"-----BEGIN PUBLIC KEY-----\\n...\\n-----END PUBLIC KEY-----\"\n    }\n  },\n  \"steps\": {\n    \"build\": {\n      \"name\": \"build\",\n      \"attestations\": [\n        {\n          \"type\": \"https://witness.dev/attestations/git/v0.1\"\n        }\n      ],\n      \"functionaries\": [\n        {\n          \"type\": \"publickey\",\n          \"publickeyid\": \"build-key\"\n        }\n      ]\n    }\n  }\n}\n```\n\n**Witness Run Command:**\n```bash\nwitness run --step build \\\n  --attestations git \\\n  --outfile build-attestation.json \\\n  --key signing-key.pem \\\n  -- <your-build-command>\n```\n\n**Rego Validation Rules:**\n```rego\npackage git\n\nimport rego.v1\n\n# Enforce builds from specific branch\ndeny contains msg if {\n    input.branch != \"bugfix/security\"\n    msg := sprintf(\"Must build from bugfix/security branch, got: %s\", [input.branch])\n}\n\n# Require clean working directory\ndeny contains msg if {\n    count(input.status) > 0\n    msg := \"Working directory must be clean (no uncommitted changes)\"\n}\n\n# Validate commit author\napproved_authors := {\n    \"alice.smith@example.com\",\n    \"bob.jones@company.com\",\n    \"ci-bot@company.com\"\n}\n\ndeny contains msg if {\n    not input.authoremail in approved_authors\n    msg := sprintf(\"Unauthorized commit author: %s\", [input.authoremail])\n}\n```\n\n**Verification:**\n```bash\nwitness verify \\\n  --policy policy-signed.json \\\n  --publickey policy-key.pub \\\n  -a build-attestation.json \\\n  --subject <artifact>\n```\n"}]}
{"messages": [{"role": "system", "content": "You are an expert in the Witness supply chain attestation framework. You help users instrument CI/CD pipelines with witness, create policy documents, and write Rego policies to validate attestations. You understand all attestors in go-witness and how to use them effectively."}, {"role": "user", "content": "How do I create a witness policy for a build step that uses these attestors: environment, git?"}, {"role": "assistant", "content": "Here's a complete witness policy for your build step with environment, git attestors:\n\n**Policy Document:**\n```json\n{\n  \"expires\": \"2026-11-08T10:52:59Z\",\n  \"publickeys\": {\n    \"build-key\": {\n      \"keyid\": \"sha256:a08fd59886768e49b0cd24803bc552cf973895d2f641211e8edc45db89516b46\",\n      \"key\": \"-----BEGIN PUBLIC KEY-----\\n...\\n-----END PUBLIC KEY-----\"\n    }\n  },\n  \"steps\": {\n    \"build\": {\n      \"name\": \"build\",\n      \"attestations\": [\n        {\n          \"type\": \"https://witness.dev/attestations/environment/v0.1\"\n        },\n        {\n          \"type\": \"https://witness.dev/attestations/git/v0.1\"\n        }\n      ],\n      \"functionaries\": [\n        {\n          \"type\": \"publickey\",\n          \"publickeyid\": \"build-key\"\n        }\n      ]\n    }\n  }\n}\n```\n\n**Witness Run Command:**\n```bash\nwitness run --step build \\\n  --attestations environment,git \\\n  --outfile build-attestation.json \\\n  --key signing-key.pem \\\n  -- <your-build-command>\n```\n\n**Rego Validation Rules:**\n```rego\npackage environment\n\nimport rego.v1\n\n# Ensure correct OS\ndeny contains msg if {\n    input.os != \"linux\"\n    msg := sprintf(\"Must run on linux, got: %s\", [input.os])\n}\n\n# Require CI environment\ndeny contains msg if {\n    not \"CI\" in input.variables\n    msg := \"Must run in CI environment (CI variable not set)\"\n}\n```\n\n**Verification:**\n```bash\nwitness verify \\\n  --policy policy-signed.json \\\n  --publickey policy-key.pub \\\n  -a build-attestation.json \\\n  --subject <artifact>\n```\n"}]}
{"messages": [{"role": "system", "content": "You are an expert in the Witness supply chain attestation framework. You help users instrument CI/CD pipelines with witness, create policy documents, and write Rego policies to validate attestations. You understand all attestors in go-witness and how to use them effectively."}, {"role": "user", "content": "How do I create a multi-step witness policy for a build \u2192 test \u2192 package pipeline?"}, {"role": "assistant", "content": "Here's a complete multi-step witness policy for your pipeline:\n\n**Policy Document:**\n```json\n{\n  \"expires\": \"2026-11-08T10:52:59Z\",\n  \"publickeys\": {\n    \"ci-key\": {\n      \"keyid\": \"sha256:01720da3476573beb5b4bd3f56129abbaa6e9496cb3dd6f7a09530636c1e2ccb\",\n      \"key\": \"-----BEGIN PUBLIC KEY-----\\n...\\n-----END PUBLIC KEY-----\"\n    }\n  },\n  \"steps\": {\n    \"build\": {\n      \"name\": \"build\",\n      \"attestations\": [\n        {\n          \"type\": \"https://witness.dev/attestations/git/v0.1\"\n        },\n        {\n          \"type\": \"https://witness.dev/attestations/command-run/v0.1\"\n        },\n        {\n          \"type\": \"https://witness.dev/attestations/product/v0.1\"\n        }\n      ],\n      \"functionaries\": [\n        {\n          \"type\": \"publickey\",\n          \"publickeyid\": \"ci-key\"\n        }\n      ]\n    },\n    \"test\": {\n      \"name\": \"test\",\n      \"attestations\": [\n        {\n          \"type\": \"https://witness.dev/attestations/material/v0.1\"\n        },\n        {\n          \"type\": \"https://witness.dev/attestations/command-run/v0.1\"\n        }\n      ],\n      \"functionaries\": [\n        {\n          \"type\": \"publickey\",\n          \"publickeyid\": \"ci-key\"\n        }\n      ]\n    },\n    \"package\": {\n      \"name\": \"package\",\n      \"attestations\": [\n        {\n          \"type\": \"https://witness.dev/attestations/material/v0.1\"\n        },\n        {\n          \"type\": \"https://witness.dev/attestations/product/v0.1\"\n        }\n      ],\n      \"functionaries\": [\n        {\n          \"type\": \"publickey\",\n          \"publickeyid\": \"ci-key\"\n        }\n      ]\n    }\n  }\n}\n```\n\n**Pipeline Commands:**\n\n```bash\n# Step 1: Build\nwitness run --step build \\\n  --attestations git,commandrun,product \\\n  -o build.json --key ci-key.pem \\\n  -- go build -o myapp\n\n# Step 2: Test\nwitness run --step test \\\n  --attestations material,commandrun \\\n  -o test.json --key ci-key.pem \\\n  -- go test ./...\n\n# Step 3: Package\nwitness run --step package \\\n  --attestations material,product \\\n  -o package.json --key ci-key.pem \\\n  -- tar czf myapp.tar.gz myapp\n\n# Verify entire pipeline\nwitness verify \\\n  --policy policy-signed.json \\\n  --publickey policy-key.pub \\\n  -a build.json -a test.json -a package.json\n```\n"}]}
{"messages": [{"role": "system", "content": "You are an expert in the Witness supply chain attestation framework. You help users instrument CI/CD pipelines with witness, create policy documents, and write Rego policies to validate attestations. You understand all attestors in go-witness and how to use them effectively."}, {"role": "user", "content": "How do I create a witness policy for a build step that uses these attestors: product?"}, {"role": "assistant", "content": "Here's a complete witness policy for your build step with product attestors:\n\n**Policy Document:**\n```json\n{\n  \"expires\": \"2026-11-08T10:52:59Z\",\n  \"publickeys\": {\n    \"build-key\": {\n      \"keyid\": \"sha256:be86928f9f587a12a5fe8c748ee0d65009f25d2364fe010558874543de878d98\",\n      \"key\": \"-----BEGIN PUBLIC KEY-----\\n...\\n-----END PUBLIC KEY-----\"\n    }\n  },\n  \"steps\": {\n    \"build\": {\n      \"name\": \"build\",\n      \"attestations\": [\n        {\n          \"type\": \"https://witness.dev/attestations/product/v0.1\"\n        }\n      ],\n      \"functionaries\": [\n        {\n          \"type\": \"publickey\",\n          \"publickeyid\": \"build-key\"\n        }\n      ]\n    }\n  }\n}\n```\n\n**Witness Run Command:**\n```bash\nwitness run --step build \\\n  --attestations product \\\n  --outfile build-attestation.json \\\n  --key signing-key.pem \\\n  -- <your-build-command>\n```\n\n**Rego Validation Rules:**\n```rego\n\n```\n\n**Verification:**\n```bash\nwitness verify \\\n  --policy policy-signed.json \\\n  --publickey policy-key.pub \\\n  -a build-attestation.json \\\n  --subject <artifact>\n```\n"}]}
{"messages": [{"role": "system", "content": "You are an expert in the Witness supply chain attestation framework. You help users instrument CI/CD pipelines with witness, create policy documents, and write Rego policies to validate attestations. You understand all attestors in go-witness and how to use them effectively."}, {"role": "user", "content": "How do I create a multi-step witness policy for a build \u2192 test \u2192 package pipeline?"}, {"role": "assistant", "content": "Here's a complete multi-step witness policy for your pipeline:\n\n**Policy Document:**\n```json\n{\n  \"expires\": \"2026-11-08T10:52:59Z\",\n  \"publickeys\": {\n    \"ci-key\": {\n      \"keyid\": \"sha256:1c30afd7f32f10e3af6ed4acac140900fdad0179740e8aa8403189dcc6019fc3\",\n      \"key\": \"-----BEGIN PUBLIC KEY-----\\n...\\n-----END PUBLIC KEY-----\"\n    }\n  },\n  \"steps\": {\n    \"build\": {\n      \"name\": \"build\",\n      \"attestations\": [\n        {\n          \"type\": \"https://witness.dev/attestations/git/v0.1\"\n        },\n        {\n          \"type\": \"https://witness.dev/attestations/command-run/v0.1\"\n        },\n        {\n          \"type\": \"https://witness.dev/attestations/product/v0.1\"\n        }\n      ],\n      \"functionaries\": [\n        {\n          \"type\": \"publickey\",\n          \"publickeyid\": \"ci-key\"\n        }\n      ]\n    },\n    \"test\": {\n      \"name\": \"test\",\n      \"attestations\": [\n        {\n          \"type\": \"https://witness.dev/attestations/material/v0.1\"\n        },\n        {\n          \"type\": \"https://witness.dev/attestations/command-run/v0.1\"\n        }\n      ],\n      \"functionaries\": [\n        {\n          \"type\": \"publickey\",\n          \"publickeyid\": \"ci-key\"\n        }\n      ]\n    },\n    \"package\": {\n      \"name\": \"package\",\n      \"attestations\": [\n        {\n          \"type\": \"https://witness.dev/attestations/material/v0.1\"\n        },\n        {\n          \"type\": \"https://witness.dev/attestations/product/v0.1\"\n        }\n      ],\n      \"functionaries\": [\n        {\n          \"type\": \"publickey\",\n          \"publickeyid\": \"ci-key\"\n        }\n      ]\n    }\n  }\n}\n```\n\n**Pipeline Commands:**\n\n```bash\n# Step 1: Build\nwitness run --step build \\\n  --attestations git,commandrun,product \\\n  -o build.json --key ci-key.pem \\\n  -- go build -o myapp\n\n# Step 2: Test\nwitness run --step test \\\n  --attestations material,commandrun \\\n  -o test.json --key ci-key.pem \\\n  -- go test ./...\n\n# Step 3: Package\nwitness run --step package \\\n  --attestations material,product \\\n  -o package.json --key ci-key.pem \\\n  -- tar czf myapp.tar.gz myapp\n\n# Verify entire pipeline\nwitness verify \\\n  --policy policy-signed.json \\\n  --publickey policy-key.pub \\\n  -a build.json -a test.json -a package.json\n```\n"}]}
{"messages": [{"role": "system", "content": "You are an expert in the Witness supply chain attestation framework. You help users instrument CI/CD pipelines with witness, create policy documents, and write Rego policies to validate attestations. You understand all attestors in go-witness and how to use them effectively."}, {"role": "user", "content": "How do I create a multi-step witness policy for a build \u2192 test \u2192 package pipeline?"}, {"role": "assistant", "content": "Here's a complete multi-step witness policy for your pipeline:\n\n**Policy Document:**\n```json\n{\n  \"expires\": \"2026-11-08T10:52:59Z\",\n  \"publickeys\": {\n    \"ci-key\": {\n      \"keyid\": \"sha256:0ec1bac73f816e8836c6aedad506a9e34efb1091b5a00f06b83f113afb1e4ba3\",\n      \"key\": \"-----BEGIN PUBLIC KEY-----\\n...\\n-----END PUBLIC KEY-----\"\n    }\n  },\n  \"steps\": {\n    \"build\": {\n      \"name\": \"build\",\n      \"attestations\": [\n        {\n          \"type\": \"https://witness.dev/attestations/git/v0.1\"\n        },\n        {\n          \"type\": \"https://witness.dev/attestations/command-run/v0.1\"\n        },\n        {\n          \"type\": \"https://witness.dev/attestations/product/v0.1\"\n        }\n      ],\n      \"functionaries\": [\n        {\n          \"type\": \"publickey\",\n          \"publickeyid\": \"ci-key\"\n        }\n      ]\n    },\n    \"test\": {\n      \"name\": \"test\",\n      \"attestations\": [\n        {\n          \"type\": \"https://witness.dev/attestations/material/v0.1\"\n        },\n        {\n          \"type\": \"https://witness.dev/attestations/command-run/v0.1\"\n        }\n      ],\n      \"functionaries\": [\n        {\n          \"type\": \"publickey\",\n          \"publickeyid\": \"ci-key\"\n        }\n      ]\n    },\n    \"package\": {\n      \"name\": \"package\",\n      \"attestations\": [\n        {\n          \"type\": \"https://witness.dev/attestations/material/v0.1\"\n        },\n        {\n          \"type\": \"https://witness.dev/attestations/product/v0.1\"\n        }\n      ],\n      \"functionaries\": [\n        {\n          \"type\": \"publickey\",\n          \"publickeyid\": \"ci-key\"\n        }\n      ]\n    }\n  }\n}\n```\n\n**Pipeline Commands:**\n\n```bash\n# Step 1: Build\nwitness run --step build \\\n  --attestations git,commandrun,product \\\n  -o build.json --key ci-key.pem \\\n  -- go build -o myapp\n\n# Step 2: Test\nwitness run --step test \\\n  --attestations material,commandrun \\\n  -o test.json --key ci-key.pem \\\n  -- go test ./...\n\n# Step 3: Package\nwitness run --step package \\\n  --attestations material,product \\\n  -o package.json --key ci-key.pem \\\n  -- tar czf myapp.tar.gz myapp\n\n# Verify entire pipeline\nwitness verify \\\n  --policy policy-signed.json \\\n  --publickey policy-key.pub \\\n  -a build.json -a test.json -a package.json\n```\n"}]}
{"messages": [{"role": "system", "content": "You are an expert in the Witness supply chain attestation framework. You help users instrument CI/CD pipelines with witness, create policy documents, and write Rego policies to validate attestations. You understand all attestors in go-witness and how to use them effectively."}, {"role": "user", "content": "How do I create a witness policy for a build step that uses these attestors: material?"}, {"role": "assistant", "content": "Here's a complete witness policy for your build step with material attestors:\n\n**Policy Document:**\n```json\n{\n  \"expires\": \"2026-11-08T10:52:59Z\",\n  \"publickeys\": {\n    \"build-key\": {\n      \"keyid\": \"sha256:2f7ea40f62cf992c632be0d5eb496fb86a73461fed464c9a6002f67efb9db175\",\n      \"key\": \"-----BEGIN PUBLIC KEY-----\\n...\\n-----END PUBLIC KEY-----\"\n    }\n  },\n  \"steps\": {\n    \"build\": {\n      \"name\": \"build\",\n      \"attestations\": [\n        {\n          \"type\": \"https://witness.dev/attestations/material/v0.1\"\n        }\n      ],\n      \"functionaries\": [\n        {\n          \"type\": \"publickey\",\n          \"publickeyid\": \"build-key\"\n        }\n      ]\n    }\n  }\n}\n```\n\n**Witness Run Command:**\n```bash\nwitness run --step build \\\n  --attestations material \\\n  --outfile build-attestation.json \\\n  --key signing-key.pem \\\n  -- <your-build-command>\n```\n\n**Rego Validation Rules:**\n```rego\n\n```\n\n**Verification:**\n```bash\nwitness verify \\\n  --policy policy-signed.json \\\n  --publickey policy-key.pub \\\n  -a build-attestation.json \\\n  --subject <artifact>\n```\n"}]}
{"messages": [{"role": "system", "content": "You are an expert in the Witness supply chain attestation framework. You help users instrument CI/CD pipelines with witness, create policy documents, and write Rego policies to validate attestations. You understand all attestors in go-witness and how to use them effectively."}, {"role": "user", "content": "How do I create a witness policy for a build step that uses these attestors: product, environment, git, material, commandrun?"}, {"role": "assistant", "content": "Here's a complete witness policy for your build step with product, environment, git, material, commandrun attestors:\n\n**Policy Document:**\n```json\n{\n  \"expires\": \"2026-11-08T10:52:59Z\",\n  \"publickeys\": {\n    \"build-key\": {\n      \"keyid\": \"sha256:86f4c032cb0bf6ef760c6f3df63ec639bb990f690c5fcac6bbe18082f50d01cd\",\n      \"key\": \"-----BEGIN PUBLIC KEY-----\\n...\\n-----END PUBLIC KEY-----\"\n    }\n  },\n  \"steps\": {\n    \"build\": {\n      \"name\": \"build\",\n      \"attestations\": [\n        {\n          \"type\": \"https://witness.dev/attestations/product/v0.1\"\n        },\n        {\n          \"type\": \"https://witness.dev/attestations/environment/v0.1\"\n        },\n        {\n          \"type\": \"https://witness.dev/attestations/git/v0.1\"\n        },\n        {\n          \"type\": \"https://witness.dev/attestations/material/v0.1\"\n        },\n        {\n          \"type\": \"https://witness.dev/attestations/command-run/v0.1\"\n        }\n      ],\n      \"functionaries\": [\n        {\n          \"type\": \"publickey\",\n          \"publickeyid\": \"build-key\"\n        }\n      ]\n    }\n  }\n}\n```\n\n**Witness Run Command:**\n```bash\nwitness run --step build \\\n  --attestations product,environment,git,material,commandrun \\\n  --outfile build-attestation.json \\\n  --key signing-key.pem \\\n  -- <your-build-command>\n```\n\n**Rego Validation Rules:**\n```rego\n\n```\n\n**Verification:**\n```bash\nwitness verify \\\n  --policy policy-signed.json \\\n  --publickey policy-key.pub \\\n  -a build-attestation.json \\\n  --subject <artifact>\n```\n"}]}
{"messages": [{"role": "system", "content": "You are an expert in the Witness supply chain attestation framework. You help users instrument CI/CD pipelines with witness, create policy documents, and write Rego policies to validate attestations. You understand all attestors in go-witness and how to use them effectively."}, {"role": "user", "content": "How do I create a witness policy for a build step that uses these attestors: environment, git, product?"}, {"role": "assistant", "content": "Here's a complete witness policy for your build step with environment, git, product attestors:\n\n**Policy Document:**\n```json\n{\n  \"expires\": \"2026-11-08T10:52:59Z\",\n  \"publickeys\": {\n    \"build-key\": {\n      \"keyid\": \"sha256:b3b5b14ea5bc93fd014206c0416e76b50ec479b28ab83e064892f01ba046429f\",\n      \"key\": \"-----BEGIN PUBLIC KEY-----\\n...\\n-----END PUBLIC KEY-----\"\n    }\n  },\n  \"steps\": {\n    \"build\": {\n      \"name\": \"build\",\n      \"attestations\": [\n        {\n          \"type\": \"https://witness.dev/attestations/environment/v0.1\"\n        },\n        {\n          \"type\": \"https://witness.dev/attestations/git/v0.1\"\n        },\n        {\n          \"type\": \"https://witness.dev/attestations/product/v0.1\"\n        }\n      ],\n      \"functionaries\": [\n        {\n          \"type\": \"publickey\",\n          \"publickeyid\": \"build-key\"\n        }\n      ]\n    }\n  }\n}\n```\n\n**Witness Run Command:**\n```bash\nwitness run --step build \\\n  --attestations environment,git,product \\\n  --outfile build-attestation.json \\\n  --key signing-key.pem \\\n  -- <your-build-command>\n```\n\n**Rego Validation Rules:**\n```rego\npackage environment\n\nimport rego.v1\n\n# Ensure correct OS\ndeny contains msg if {\n    input.os != \"linux\"\n    msg := sprintf(\"Must run on linux, got: %s\", [input.os])\n}\n\n# Require CI environment\ndeny contains msg if {\n    not \"CI\" in input.variables\n    msg := \"Must run in CI environment (CI variable not set)\"\n}\n```\n\n**Verification:**\n```bash\nwitness verify \\\n  --policy policy-signed.json \\\n  --publickey policy-key.pub \\\n  -a build-attestation.json \\\n  --subject <artifact>\n```\n"}]}
{"messages": [{"role": "system", "content": "You are an expert in the Witness supply chain attestation framework. You help users instrument CI/CD pipelines with witness, create policy documents, and write Rego policies to validate attestations. You understand all attestors in go-witness and how to use them effectively."}, {"role": "user", "content": "How do I create a multi-step witness policy for a build \u2192 test \u2192 package pipeline?"}, {"role": "assistant", "content": "Here's a complete multi-step witness policy for your pipeline:\n\n**Policy Document:**\n```json\n{\n  \"expires\": \"2026-11-08T10:52:59Z\",\n  \"publickeys\": {\n    \"ci-key\": {\n      \"keyid\": \"sha256:0b0fada388ca3b9a01890e9235599b61b4eb04190bac264a60d4302e88eb44dd\",\n      \"key\": \"-----BEGIN PUBLIC KEY-----\\n...\\n-----END PUBLIC KEY-----\"\n    }\n  },\n  \"steps\": {\n    \"build\": {\n      \"name\": \"build\",\n      \"attestations\": [\n        {\n          \"type\": \"https://witness.dev/attestations/git/v0.1\"\n        },\n        {\n          \"type\": \"https://witness.dev/attestations/command-run/v0.1\"\n        },\n        {\n          \"type\": \"https://witness.dev/attestations/product/v0.1\"\n        }\n      ],\n      \"functionaries\": [\n        {\n          \"type\": \"publickey\",\n          \"publickeyid\": \"ci-key\"\n        }\n      ]\n    },\n    \"test\": {\n      \"name\": \"test\",\n      \"attestations\": [\n        {\n          \"type\": \"https://witness.dev/attestations/material/v0.1\"\n        },\n        {\n          \"type\": \"https://witness.dev/attestations/command-run/v0.1\"\n        }\n      ],\n      \"functionaries\": [\n        {\n          \"type\": \"publickey\",\n          \"publickeyid\": \"ci-key\"\n        }\n      ]\n    },\n    \"package\": {\n      \"name\": \"package\",\n      \"attestations\": [\n        {\n          \"type\": \"https://witness.dev/attestations/material/v0.1\"\n        },\n        {\n          \"type\": \"https://witness.dev/attestations/product/v0.1\"\n        }\n      ],\n      \"functionaries\": [\n        {\n          \"type\": \"publickey\",\n          \"publickeyid\": \"ci-key\"\n        }\n      ]\n    }\n  }\n}\n```\n\n**Pipeline Commands:**\n\n```bash\n# Step 1: Build\nwitness run --step build \\\n  --attestations git,commandrun,product \\\n  -o build.json --key ci-key.pem \\\n  -- go build -o myapp\n\n# Step 2: Test\nwitness run --step test \\\n  --attestations material,commandrun \\\n  -o test.json --key ci-key.pem \\\n  -- go test ./...\n\n# Step 3: Package\nwitness run --step package \\\n  --attestations material,product \\\n  -o package.json --key ci-key.pem \\\n  -- tar czf myapp.tar.gz myapp\n\n# Verify entire pipeline\nwitness verify \\\n  --policy policy-signed.json \\\n  --publickey policy-key.pub \\\n  -a build.json -a test.json -a package.json\n```\n"}]}
{"messages": [{"role": "system", "content": "You are an expert in the Witness supply chain attestation framework. You help users instrument CI/CD pipelines with witness, create policy documents, and write Rego policies to validate attestations. You understand all attestors in go-witness and how to use them effectively."}, {"role": "user", "content": "How do I create a witness policy for a build step that uses these attestors: material, product, github, environment, commandrun?"}, {"role": "assistant", "content": "Here's a complete witness policy for your build step with material, product, github, environment, commandrun attestors:\n\n**Policy Document:**\n```json\n{\n  \"expires\": \"2026-11-08T10:52:59Z\",\n  \"publickeys\": {\n    \"build-key\": {\n      \"keyid\": \"sha256:82ec6748d1706ed63479a6a3510fea399816fcaf27ae1468703b595a3b22dbc7\",\n      \"key\": \"-----BEGIN PUBLIC KEY-----\\n...\\n-----END PUBLIC KEY-----\"\n    }\n  },\n  \"steps\": {\n    \"build\": {\n      \"name\": \"build\",\n      \"attestations\": [\n        {\n          \"type\": \"https://witness.dev/attestations/material/v0.1\"\n        },\n        {\n          \"type\": \"https://witness.dev/attestations/product/v0.1\"\n        },\n        {\n          \"type\": \"https://witness.dev/attestations/github/v0.1\"\n        },\n        {\n          \"type\": \"https://witness.dev/attestations/environment/v0.1\"\n        },\n        {\n          \"type\": \"https://witness.dev/attestations/command-run/v0.1\"\n        }\n      ],\n      \"functionaries\": [\n        {\n          \"type\": \"publickey\",\n          \"publickeyid\": \"build-key\"\n        }\n      ]\n    }\n  }\n}\n```\n\n**Witness Run Command:**\n```bash\nwitness run --step build \\\n  --attestations material,product,github,environment,commandrun \\\n  --outfile build-attestation.json \\\n  --key signing-key.pem \\\n  -- <your-build-command>\n```\n\n**Rego Validation Rules:**\n```rego\n\n```\n\n**Verification:**\n```bash\nwitness verify \\\n  --policy policy-signed.json \\\n  --publickey policy-key.pub \\\n  -a build-attestation.json \\\n  --subject <artifact>\n```\n"}]}
{"messages": [{"role": "system", "content": "You are an expert in the Witness supply chain attestation framework. You help users instrument CI/CD pipelines with witness, create policy documents, and write Rego policies to validate attestations. You understand all attestors in go-witness and how to use them effectively."}, {"role": "user", "content": "How do I create a multi-step witness policy for a build \u2192 test \u2192 package pipeline?"}, {"role": "assistant", "content": "Here's a complete multi-step witness policy for your pipeline:\n\n**Policy Document:**\n```json\n{\n  \"expires\": \"2026-11-08T10:52:59Z\",\n  \"publickeys\": {\n    \"ci-key\": {\n      \"keyid\": \"sha256:03b6ecf01db2f908ae2fac5e231d9e49121e3fe961e0fc71a9bce537049a7f2d\",\n      \"key\": \"-----BEGIN PUBLIC KEY-----\\n...\\n-----END PUBLIC KEY-----\"\n    }\n  },\n  \"steps\": {\n    \"build\": {\n      \"name\": \"build\",\n      \"attestations\": [\n        {\n          \"type\": \"https://witness.dev/attestations/git/v0.1\"\n        },\n        {\n          \"type\": \"https://witness.dev/attestations/command-run/v0.1\"\n        },\n        {\n          \"type\": \"https://witness.dev/attestations/product/v0.1\"\n        }\n      ],\n      \"functionaries\": [\n        {\n          \"type\": \"publickey\",\n          \"publickeyid\": \"ci-key\"\n        }\n      ]\n    },\n    \"test\": {\n      \"name\": \"test\",\n      \"attestations\": [\n        {\n          \"type\": \"https://witness.dev/attestations/material/v0.1\"\n        },\n        {\n          \"type\": \"https://witness.dev/attestations/command-run/v0.1\"\n        }\n      ],\n      \"functionaries\": [\n        {\n          \"type\": \"publickey\",\n          \"publickeyid\": \"ci-key\"\n        }\n      ]\n    },\n    \"package\": {\n      \"name\": \"package\",\n      \"attestations\": [\n        {\n          \"type\": \"https://witness.dev/attestations/material/v0.1\"\n        },\n        {\n          \"type\": \"https://witness.dev/attestations/product/v0.1\"\n        }\n      ],\n      \"functionaries\": [\n        {\n          \"type\": \"publickey\",\n          \"publickeyid\": \"ci-key\"\n        }\n      ]\n    }\n  }\n}\n```\n\n**Pipeline Commands:**\n\n```bash\n# Step 1: Build\nwitness run --step build \\\n  --attestations git,commandrun,product \\\n  -o build.json --key ci-key.pem \\\n  -- go build -o myapp\n\n# Step 2: Test\nwitness run --step test \\\n  --attestations material,commandrun \\\n  -o test.json --key ci-key.pem \\\n  -- go test ./...\n\n# Step 3: Package\nwitness run --step package \\\n  --attestations material,product \\\n  -o package.json --key ci-key.pem \\\n  -- tar czf myapp.tar.gz myapp\n\n# Verify entire pipeline\nwitness verify \\\n  --policy policy-signed.json \\\n  --publickey policy-key.pub \\\n  -a build.json -a test.json -a package.json\n```\n"}]}
{"messages": [{"role": "system", "content": "You are an expert in the Witness supply chain attestation framework. You help users instrument CI/CD pipelines with witness, create policy documents, and write Rego policies to validate attestations. You understand all attestors in go-witness and how to use them effectively."}, {"role": "user", "content": "How do I create a witness policy for a build step that uses these attestors: git?"}, {"role": "assistant", "content": "Here's a complete witness policy for your build step with git attestors:\n\n**Policy Document:**\n```json\n{\n  \"expires\": \"2026-11-08T10:52:59Z\",\n  \"publickeys\": {\n    \"build-key\": {\n      \"keyid\": \"sha256:8cf52d36f203869cee95de1eb6830c8e3a1f1620a068f55d7b85ee2216610d29\",\n      \"key\": \"-----BEGIN PUBLIC KEY-----\\n...\\n-----END PUBLIC KEY-----\"\n    }\n  },\n  \"steps\": {\n    \"build\": {\n      \"name\": \"build\",\n      \"attestations\": [\n        {\n          \"type\": \"https://witness.dev/attestations/git/v0.1\"\n        }\n      ],\n      \"functionaries\": [\n        {\n          \"type\": \"publickey\",\n          \"publickeyid\": \"build-key\"\n        }\n      ]\n    }\n  }\n}\n```\n\n**Witness Run Command:**\n```bash\nwitness run --step build \\\n  --attestations git \\\n  --outfile build-attestation.json \\\n  --key signing-key.pem \\\n  -- <your-build-command>\n```\n\n**Rego Validation Rules:**\n```rego\npackage git\n\nimport rego.v1\n\n# Enforce builds from specific branch\ndeny contains msg if {\n    input.branch != \"main\"\n    msg := sprintf(\"Must build from main branch, got: %s\", [input.branch])\n}\n\n# Require clean working directory\ndeny contains msg if {\n    count(input.status) > 0\n    msg := \"Working directory must be clean (no uncommitted changes)\"\n}\n\n# Validate commit author\napproved_authors := {\n    \"alice.smith@example.com\",\n    \"bob.jones@company.com\",\n    \"ci-bot@company.com\"\n}\n\ndeny contains msg if {\n    not input.authoremail in approved_authors\n    msg := sprintf(\"Unauthorized commit author: %s\", [input.authoremail])\n}\n```\n\n**Verification:**\n```bash\nwitness verify \\\n  --policy policy-signed.json \\\n  --publickey policy-key.pub \\\n  -a build-attestation.json \\\n  --subject <artifact>\n```\n"}]}
{"messages": [{"role": "system", "content": "You are an expert in the Witness supply chain attestation framework. You help users instrument CI/CD pipelines with witness, create policy documents, and write Rego policies to validate attestations. You understand all attestors in go-witness and how to use them effectively."}, {"role": "user", "content": "How do I create a witness policy for a build step that uses these attestors: commandrun?"}, {"role": "assistant", "content": "Here's a complete witness policy for your build step with commandrun attestors:\n\n**Policy Document:**\n```json\n{\n  \"expires\": \"2026-11-08T10:52:59Z\",\n  \"publickeys\": {\n    \"build-key\": {\n      \"keyid\": \"sha256:aa4a5ed5c084ede79595d1bcd2e78c22f770873b8cc3253b7c59e938a234b599\",\n      \"key\": \"-----BEGIN PUBLIC KEY-----\\n...\\n-----END PUBLIC KEY-----\"\n    }\n  },\n  \"steps\": {\n    \"build\": {\n      \"name\": \"build\",\n      \"attestations\": [\n        {\n          \"type\": \"https://witness.dev/attestations/command-run/v0.1\"\n        }\n      ],\n      \"functionaries\": [\n        {\n          \"type\": \"publickey\",\n          \"publickeyid\": \"build-key\"\n        }\n      ]\n    }\n  }\n}\n```\n\n**Witness Run Command:**\n```bash\nwitness run --step build \\\n  --attestations commandrun \\\n  --outfile build-attestation.json \\\n  --key signing-key.pem \\\n  -- <your-build-command>\n```\n\n**Rego Validation Rules:**\n```rego\n\n```\n\n**Verification:**\n```bash\nwitness verify \\\n  --policy policy-signed.json \\\n  --publickey policy-key.pub \\\n  -a build-attestation.json \\\n  --subject <artifact>\n```\n"}]}
{"messages": [{"role": "system", "content": "You are an expert in the Witness supply chain attestation framework. You help users instrument CI/CD pipelines with witness, create policy documents, and write Rego policies to validate attestations. You understand all attestors in go-witness and how to use them effectively."}, {"role": "user", "content": "How do I create a multi-step witness policy for a build \u2192 test \u2192 package pipeline?"}, {"role": "assistant", "content": "Here's a complete multi-step witness policy for your pipeline:\n\n**Policy Document:**\n```json\n{\n  \"expires\": \"2026-11-08T10:52:59Z\",\n  \"publickeys\": {\n    \"ci-key\": {\n      \"keyid\": \"sha256:a78bd2690dca7c6d1f41a31b667e40b363568c9c9424acfce82feb6cd108a52c\",\n      \"key\": \"-----BEGIN PUBLIC KEY-----\\n...\\n-----END PUBLIC KEY-----\"\n    }\n  },\n  \"steps\": {\n    \"build\": {\n      \"name\": \"build\",\n      \"attestations\": [\n        {\n          \"type\": \"https://witness.dev/attestations/git/v0.1\"\n        },\n        {\n          \"type\": \"https://witness.dev/attestations/command-run/v0.1\"\n        },\n        {\n          \"type\": \"https://witness.dev/attestations/product/v0.1\"\n        }\n      ],\n      \"functionaries\": [\n        {\n          \"type\": \"publickey\",\n          \"publickeyid\": \"ci-key\"\n        }\n      ]\n    },\n    \"test\": {\n      \"name\": \"test\",\n      \"attestations\": [\n        {\n          \"type\": \"https://witness.dev/attestations/material/v0.1\"\n        },\n        {\n          \"type\": \"https://witness.dev/attestations/command-run/v0.1\"\n        }\n      ],\n      \"functionaries\": [\n        {\n          \"type\": \"publickey\",\n          \"publickeyid\": \"ci-key\"\n        }\n      ]\n    },\n    \"package\": {\n      \"name\": \"package\",\n      \"attestations\": [\n        {\n          \"type\": \"https://witness.dev/attestations/material/v0.1\"\n        },\n        {\n          \"type\": \"https://witness.dev/attestations/product/v0.1\"\n        }\n      ],\n      \"functionaries\": [\n        {\n          \"type\": \"publickey\",\n          \"publickeyid\": \"ci-key\"\n        }\n      ]\n    }\n  }\n}\n```\n\n**Pipeline Commands:**\n\n```bash\n# Step 1: Build\nwitness run --step build \\\n  --attestations git,commandrun,product \\\n  -o build.json --key ci-key.pem \\\n  -- go build -o myapp\n\n# Step 2: Test\nwitness run --step test \\\n  --attestations material,commandrun \\\n  -o test.json --key ci-key.pem \\\n  -- go test ./...\n\n# Step 3: Package\nwitness run --step package \\\n  --attestations material,product \\\n  -o package.json --key ci-key.pem \\\n  -- tar czf myapp.tar.gz myapp\n\n# Verify entire pipeline\nwitness verify \\\n  --policy policy-signed.json \\\n  --publickey policy-key.pub \\\n  -a build.json -a test.json -a package.json\n```\n"}]}
{"messages": [{"role": "system", "content": "You are an expert in the Witness supply chain attestation framework. You help users instrument CI/CD pipelines with witness, create policy documents, and write Rego policies to validate attestations. You understand all attestors in go-witness and how to use them effectively."}, {"role": "user", "content": "How do I create a witness policy for a build step that uses these attestors: commandrun, github, environment?"}, {"role": "assistant", "content": "Here's a complete witness policy for your build step with commandrun, github, environment attestors:\n\n**Policy Document:**\n```json\n{\n  \"expires\": \"2026-11-08T10:52:59Z\",\n  \"publickeys\": {\n    \"build-key\": {\n      \"keyid\": \"sha256:5541bde3e8a25961889386e6e09e6a41c6a9f2a50084c1982101aa67bb735eb6\",\n      \"key\": \"-----BEGIN PUBLIC KEY-----\\n...\\n-----END PUBLIC KEY-----\"\n    }\n  },\n  \"steps\": {\n    \"build\": {\n      \"name\": \"build\",\n      \"attestations\": [\n        {\n          \"type\": \"https://witness.dev/attestations/command-run/v0.1\"\n        },\n        {\n          \"type\": \"https://witness.dev/attestations/github/v0.1\"\n        },\n        {\n          \"type\": \"https://witness.dev/attestations/environment/v0.1\"\n        }\n      ],\n      \"functionaries\": [\n        {\n          \"type\": \"publickey\",\n          \"publickeyid\": \"build-key\"\n        }\n      ]\n    }\n  }\n}\n```\n\n**Witness Run Command:**\n```bash\nwitness run --step build \\\n  --attestations commandrun,github,environment \\\n  --outfile build-attestation.json \\\n  --key signing-key.pem \\\n  -- <your-build-command>\n```\n\n**Rego Validation Rules:**\n```rego\n\n```\n\n**Verification:**\n```bash\nwitness verify \\\n  --policy policy-signed.json \\\n  --publickey policy-key.pub \\\n  -a build-attestation.json \\\n  --subject <artifact>\n```\n"}]}
{"messages": [{"role": "system", "content": "You are an expert in the Witness supply chain attestation framework. You help users instrument CI/CD pipelines with witness, create policy documents, and write Rego policies to validate attestations. You understand all attestors in go-witness and how to use them effectively."}, {"role": "user", "content": "How do I create a witness policy for a build step that uses these attestors: environment, product, github, commandrun, git?"}, {"role": "assistant", "content": "Here's a complete witness policy for your build step with environment, product, github, commandrun, git attestors:\n\n**Policy Document:**\n```json\n{\n  \"expires\": \"2026-11-08T10:52:59Z\",\n  \"publickeys\": {\n    \"build-key\": {\n      \"keyid\": \"sha256:8edfe5f9caffe72c7c265550d3ae05dd4988bd638eaa640a114ab1c4391f2fa1\",\n      \"key\": \"-----BEGIN PUBLIC KEY-----\\n...\\n-----END PUBLIC KEY-----\"\n    }\n  },\n  \"steps\": {\n    \"build\": {\n      \"name\": \"build\",\n      \"attestations\": [\n        {\n          \"type\": \"https://witness.dev/attestations/environment/v0.1\"\n        },\n        {\n          \"type\": \"https://witness.dev/attestations/product/v0.1\"\n        },\n        {\n          \"type\": \"https://witness.dev/attestations/github/v0.1\"\n        },\n        {\n          \"type\": \"https://witness.dev/attestations/command-run/v0.1\"\n        },\n        {\n          \"type\": \"https://witness.dev/attestations/git/v0.1\"\n        }\n      ],\n      \"functionaries\": [\n        {\n          \"type\": \"publickey\",\n          \"publickeyid\": \"build-key\"\n        }\n      ]\n    }\n  }\n}\n```\n\n**Witness Run Command:**\n```bash\nwitness run --step build \\\n  --attestations environment,product,github,commandrun,git \\\n  --outfile build-attestation.json \\\n  --key signing-key.pem \\\n  -- <your-build-command>\n```\n\n**Rego Validation Rules:**\n```rego\npackage environment\n\nimport rego.v1\n\n# Ensure correct OS\ndeny contains msg if {\n    input.os != \"windows\"\n    msg := sprintf(\"Must run on windows, got: %s\", [input.os])\n}\n\n# Require CI environment\ndeny contains msg if {\n    not \"CI\" in input.variables\n    msg := \"Must run in CI environment (CI variable not set)\"\n}\n```\n\n**Verification:**\n```bash\nwitness verify \\\n  --policy policy-signed.json \\\n  --publickey policy-key.pub \\\n  -a build-attestation.json \\\n  --subject <artifact>\n```\n"}]}
{"messages": [{"role": "system", "content": "You are an expert in the Witness supply chain attestation framework. You help users instrument CI/CD pipelines with witness, create policy documents, and write Rego policies to validate attestations. You understand all attestors in go-witness and how to use them effectively."}, {"role": "user", "content": "How do I create a multi-step witness policy for a build \u2192 test \u2192 package pipeline?"}, {"role": "assistant", "content": "Here's a complete multi-step witness policy for your pipeline:\n\n**Policy Document:**\n```json\n{\n  \"expires\": \"2026-11-08T10:52:59Z\",\n  \"publickeys\": {\n    \"ci-key\": {\n      \"keyid\": \"sha256:4d9173e8feb20321c023e27f723de51fb7d269239d8474fb494ecc840b677467\",\n      \"key\": \"-----BEGIN PUBLIC KEY-----\\n...\\n-----END PUBLIC KEY-----\"\n    }\n  },\n  \"steps\": {\n    \"build\": {\n      \"name\": \"build\",\n      \"attestations\": [\n        {\n          \"type\": \"https://witness.dev/attestations/git/v0.1\"\n        },\n        {\n          \"type\": \"https://witness.dev/attestations/command-run/v0.1\"\n        },\n        {\n          \"type\": \"https://witness.dev/attestations/product/v0.1\"\n        }\n      ],\n      \"functionaries\": [\n        {\n          \"type\": \"publickey\",\n          \"publickeyid\": \"ci-key\"\n        }\n      ]\n    },\n    \"test\": {\n      \"name\": \"test\",\n      \"attestations\": [\n        {\n          \"type\": \"https://witness.dev/attestations/material/v0.1\"\n        },\n        {\n          \"type\": \"https://witness.dev/attestations/command-run/v0.1\"\n        }\n      ],\n      \"functionaries\": [\n        {\n          \"type\": \"publickey\",\n          \"publickeyid\": \"ci-key\"\n        }\n      ]\n    },\n    \"package\": {\n      \"name\": \"package\",\n      \"attestations\": [\n        {\n          \"type\": \"https://witness.dev/attestations/material/v0.1\"\n        },\n        {\n          \"type\": \"https://witness.dev/attestations/product/v0.1\"\n        }\n      ],\n      \"functionaries\": [\n        {\n          \"type\": \"publickey\",\n          \"publickeyid\": \"ci-key\"\n        }\n      ]\n    }\n  }\n}\n```\n\n**Pipeline Commands:**\n\n```bash\n# Step 1: Build\nwitness run --step build \\\n  --attestations git,commandrun,product \\\n  -o build.json --key ci-key.pem \\\n  -- go build -o myapp\n\n# Step 2: Test\nwitness run --step test \\\n  --attestations material,commandrun \\\n  -o test.json --key ci-key.pem \\\n  -- go test ./...\n\n# Step 3: Package\nwitness run --step package \\\n  --attestations material,product \\\n  -o package.json --key ci-key.pem \\\n  -- tar czf myapp.tar.gz myapp\n\n# Verify entire pipeline\nwitness verify \\\n  --policy policy-signed.json \\\n  --publickey policy-key.pub \\\n  -a build.json -a test.json -a package.json\n```\n"}]}
{"messages": [{"role": "system", "content": "You are an expert in the Witness supply chain attestation framework. You help users instrument CI/CD pipelines with witness, create policy documents, and write Rego policies to validate attestations. You understand all attestors in go-witness and how to use them effectively."}, {"role": "user", "content": "How do I create a witness policy for a build step that uses these attestors: git, environment, github, material?"}, {"role": "assistant", "content": "Here's a complete witness policy for your build step with git, environment, github, material attestors:\n\n**Policy Document:**\n```json\n{\n  \"expires\": \"2026-11-08T10:52:59Z\",\n  \"publickeys\": {\n    \"build-key\": {\n      \"keyid\": \"sha256:8d161047758d8130b22235ccc62dd2a737bca153d9fa5e023da8444e8d27eae9\",\n      \"key\": \"-----BEGIN PUBLIC KEY-----\\n...\\n-----END PUBLIC KEY-----\"\n    }\n  },\n  \"steps\": {\n    \"build\": {\n      \"name\": \"build\",\n      \"attestations\": [\n        {\n          \"type\": \"https://witness.dev/attestations/git/v0.1\"\n        },\n        {\n          \"type\": \"https://witness.dev/attestations/environment/v0.1\"\n        },\n        {\n          \"type\": \"https://witness.dev/attestations/github/v0.1\"\n        },\n        {\n          \"type\": \"https://witness.dev/attestations/material/v0.1\"\n        }\n      ],\n      \"functionaries\": [\n        {\n          \"type\": \"publickey\",\n          \"publickeyid\": \"build-key\"\n        }\n      ]\n    }\n  }\n}\n```\n\n**Witness Run Command:**\n```bash\nwitness run --step build \\\n  --attestations git,environment,github,material \\\n  --outfile build-attestation.json \\\n  --key signing-key.pem \\\n  -- <your-build-command>\n```\n\n**Rego Validation Rules:**\n```rego\npackage git\n\nimport rego.v1\n\n# Enforce builds from specific branch\ndeny contains msg if {\n    input.branch != \"staging\"\n    msg := sprintf(\"Must build from staging branch, got: %s\", [input.branch])\n}\n\n# Validate commit author\napproved_authors := {\n    \"alice.smith@example.com\",\n    \"bob.jones@company.com\",\n    \"ci-bot@company.com\"\n}\n\ndeny contains msg if {\n    not input.authoremail in approved_authors\n    msg := sprintf(\"Unauthorized commit author: %s\", [input.authoremail])\n}\n```\n\n**Verification:**\n```bash\nwitness verify \\\n  --policy policy-signed.json \\\n  --publickey policy-key.pub \\\n  -a build-attestation.json \\\n  --subject <artifact>\n```\n"}]}
{"messages": [{"role": "system", "content": "You are an expert in the Witness supply chain attestation framework. You help users instrument CI/CD pipelines with witness, create policy documents, and write Rego policies to validate attestations. You understand all attestors in go-witness and how to use them effectively."}, {"role": "user", "content": "How do I create a witness policy for a build step that uses these attestors: commandrun, product?"}, {"role": "assistant", "content": "Here's a complete witness policy for your build step with commandrun, product attestors:\n\n**Policy Document:**\n```json\n{\n  \"expires\": \"2026-11-08T10:52:59Z\",\n  \"publickeys\": {\n    \"build-key\": {\n      \"keyid\": \"sha256:d64e4e619a8e66fc8c3e070fe922a3fb2cc27489194a4b0ec4a2bd020a715e3e\",\n      \"key\": \"-----BEGIN PUBLIC KEY-----\\n...\\n-----END PUBLIC KEY-----\"\n    }\n  },\n  \"steps\": {\n    \"build\": {\n      \"name\": \"build\",\n      \"attestations\": [\n        {\n          \"type\": \"https://witness.dev/attestations/command-run/v0.1\"\n        },\n        {\n          \"type\": \"https://witness.dev/attestations/product/v0.1\"\n        }\n      ],\n      \"functionaries\": [\n        {\n          \"type\": \"publickey\",\n          \"publickeyid\": \"build-key\"\n        }\n      ]\n    }\n  }\n}\n```\n\n**Witness Run Command:**\n```bash\nwitness run --step build \\\n  --attestations commandrun,product \\\n  --outfile build-attestation.json \\\n  --key signing-key.pem \\\n  -- <your-build-command>\n```\n\n**Rego Validation Rules:**\n```rego\n\n```\n\n**Verification:**\n```bash\nwitness verify \\\n  --policy policy-signed.json \\\n  --publickey policy-key.pub \\\n  -a build-attestation.json \\\n  --subject <artifact>\n```\n"}]}
{"messages": [{"role": "system", "content": "You are an expert in the Witness supply chain attestation framework. You help users instrument CI/CD pipelines with witness, create policy documents, and write Rego policies to validate attestations. You understand all attestors in go-witness and how to use them effectively."}, {"role": "user", "content": "How do I create a multi-step witness policy for a build \u2192 test \u2192 package pipeline?"}, {"role": "assistant", "content": "Here's a complete multi-step witness policy for your pipeline:\n\n**Policy Document:**\n```json\n{\n  \"expires\": \"2026-11-08T10:52:59Z\",\n  \"publickeys\": {\n    \"ci-key\": {\n      \"keyid\": \"sha256:8de2b7afb7a1b327a8a44277641f357e041065f1b744a965fa8a27af80d49c27\",\n      \"key\": \"-----BEGIN PUBLIC KEY-----\\n...\\n-----END PUBLIC KEY-----\"\n    }\n  },\n  \"steps\": {\n    \"build\": {\n      \"name\": \"build\",\n      \"attestations\": [\n        {\n          \"type\": \"https://witness.dev/attestations/git/v0.1\"\n        },\n        {\n          \"type\": \"https://witness.dev/attestations/command-run/v0.1\"\n        },\n        {\n          \"type\": \"https://witness.dev/attestations/product/v0.1\"\n        }\n      ],\n      \"functionaries\": [\n        {\n          \"type\": \"publickey\",\n          \"publickeyid\": \"ci-key\"\n        }\n      ]\n    },\n    \"test\": {\n      \"name\": \"test\",\n      \"attestations\": [\n        {\n          \"type\": \"https://witness.dev/attestations/material/v0.1\"\n        },\n        {\n          \"type\": \"https://witness.dev/attestations/command-run/v0.1\"\n        }\n      ],\n      \"functionaries\": [\n        {\n          \"type\": \"publickey\",\n          \"publickeyid\": \"ci-key\"\n        }\n      ]\n    },\n    \"package\": {\n      \"name\": \"package\",\n      \"attestations\": [\n        {\n          \"type\": \"https://witness.dev/attestations/material/v0.1\"\n        },\n        {\n          \"type\": \"https://witness.dev/attestations/product/v0.1\"\n        }\n      ],\n      \"functionaries\": [\n        {\n          \"type\": \"publickey\",\n          \"publickeyid\": \"ci-key\"\n        }\n      ]\n    }\n  }\n}\n```\n\n**Pipeline Commands:**\n\n```bash\n# Step 1: Build\nwitness run --step build \\\n  --attestations git,commandrun,product \\\n  -o build.json --key ci-key.pem \\\n  -- go build -o myapp\n\n# Step 2: Test\nwitness run --step test \\\n  --attestations material,commandrun \\\n  -o test.json --key ci-key.pem \\\n  -- go test ./...\n\n# Step 3: Package\nwitness run --step package \\\n  --attestations material,product \\\n  -o package.json --key ci-key.pem \\\n  -- tar czf myapp.tar.gz myapp\n\n# Verify entire pipeline\nwitness verify \\\n  --policy policy-signed.json \\\n  --publickey policy-key.pub \\\n  -a build.json -a test.json -a package.json\n```\n"}]}
{"messages": [{"role": "system", "content": "You are an expert in the Witness supply chain attestation framework. You help users instrument CI/CD pipelines with witness, create policy documents, and write Rego policies to validate attestations. You understand all attestors in go-witness and how to use them effectively."}, {"role": "user", "content": "How do I create a witness policy for a build step that uses these attestors: github, material?"}, {"role": "assistant", "content": "Here's a complete witness policy for your build step with github, material attestors:\n\n**Policy Document:**\n```json\n{\n  \"expires\": \"2026-11-08T10:52:59Z\",\n  \"publickeys\": {\n    \"build-key\": {\n      \"keyid\": \"sha256:dc7db424ca9027396f723c8106bd9768d779a319b5daf23b2d65c342420c886c\",\n      \"key\": \"-----BEGIN PUBLIC KEY-----\\n...\\n-----END PUBLIC KEY-----\"\n    }\n  },\n  \"steps\": {\n    \"build\": {\n      \"name\": \"build\",\n      \"attestations\": [\n        {\n          \"type\": \"https://witness.dev/attestations/github/v0.1\"\n        },\n        {\n          \"type\": \"https://witness.dev/attestations/material/v0.1\"\n        }\n      ],\n      \"functionaries\": [\n        {\n          \"type\": \"publickey\",\n          \"publickeyid\": \"build-key\"\n        }\n      ]\n    }\n  }\n}\n```\n\n**Witness Run Command:**\n```bash\nwitness run --step build \\\n  --attestations github,material \\\n  --outfile build-attestation.json \\\n  --key signing-key.pem \\\n  -- <your-build-command>\n```\n\n**Rego Validation Rules:**\n```rego\n\n```\n\n**Verification:**\n```bash\nwitness verify \\\n  --policy policy-signed.json \\\n  --publickey policy-key.pub \\\n  -a build-attestation.json \\\n  --subject <artifact>\n```\n"}]}
{"messages": [{"role": "system", "content": "You are an expert in the Witness supply chain attestation framework. You help users instrument CI/CD pipelines with witness, create policy documents, and write Rego policies to validate attestations. You understand all attestors in go-witness and how to use them effectively."}, {"role": "user", "content": "How do I create a witness policy for a build step that uses these attestors: product, github?"}, {"role": "assistant", "content": "Here's a complete witness policy for your build step with product, github attestors:\n\n**Policy Document:**\n```json\n{\n  \"expires\": \"2026-11-08T10:52:59Z\",\n  \"publickeys\": {\n    \"build-key\": {\n      \"keyid\": \"sha256:f8983991f44bec2c603159610f57e73f8d57c3f97aec09f62475e1fa67449822\",\n      \"key\": \"-----BEGIN PUBLIC KEY-----\\n...\\n-----END PUBLIC KEY-----\"\n    }\n  },\n  \"steps\": {\n    \"build\": {\n      \"name\": \"build\",\n      \"attestations\": [\n        {\n          \"type\": \"https://witness.dev/attestations/product/v0.1\"\n        },\n        {\n          \"type\": \"https://witness.dev/attestations/github/v0.1\"\n        }\n      ],\n      \"functionaries\": [\n        {\n          \"type\": \"publickey\",\n          \"publickeyid\": \"build-key\"\n        }\n      ]\n    }\n  }\n}\n```\n\n**Witness Run Command:**\n```bash\nwitness run --step build \\\n  --attestations product,github \\\n  --outfile build-attestation.json \\\n  --key signing-key.pem \\\n  -- <your-build-command>\n```\n\n**Rego Validation Rules:**\n```rego\n\n```\n\n**Verification:**\n```bash\nwitness verify \\\n  --policy policy-signed.json \\\n  --publickey policy-key.pub \\\n  -a build-attestation.json \\\n  --subject <artifact>\n```\n"}]}
{"messages": [{"role": "system", "content": "You are an expert in the Witness supply chain attestation framework. You help users instrument CI/CD pipelines with witness, create policy documents, and write Rego policies to validate attestations. You understand all attestors in go-witness and how to use them effectively."}, {"role": "user", "content": "How do I create a witness policy for a build step that uses these attestors: material, commandrun, github?"}, {"role": "assistant", "content": "Here's a complete witness policy for your build step with material, commandrun, github attestors:\n\n**Policy Document:**\n```json\n{\n  \"expires\": \"2026-11-08T10:52:59Z\",\n  \"publickeys\": {\n    \"build-key\": {\n      \"keyid\": \"sha256:5e9cbc9c387d4bdb37a0dd7c84c249e046d6ea1e95682c98becdcd328df10d63\",\n      \"key\": \"-----BEGIN PUBLIC KEY-----\\n...\\n-----END PUBLIC KEY-----\"\n    }\n  },\n  \"steps\": {\n    \"build\": {\n      \"name\": \"build\",\n      \"attestations\": [\n        {\n          \"type\": \"https://witness.dev/attestations/material/v0.1\"\n        },\n        {\n          \"type\": \"https://witness.dev/attestations/command-run/v0.1\"\n        },\n        {\n          \"type\": \"https://witness.dev/attestations/github/v0.1\"\n        }\n      ],\n      \"functionaries\": [\n        {\n          \"type\": \"publickey\",\n          \"publickeyid\": \"build-key\"\n        }\n      ]\n    }\n  }\n}\n```\n\n**Witness Run Command:**\n```bash\nwitness run --step build \\\n  --attestations material,commandrun,github \\\n  --outfile build-attestation.json \\\n  --key signing-key.pem \\\n  -- <your-build-command>\n```\n\n**Rego Validation Rules:**\n```rego\n\n```\n\n**Verification:**\n```bash\nwitness verify \\\n  --policy policy-signed.json \\\n  --publickey policy-key.pub \\\n  -a build-attestation.json \\\n  --subject <artifact>\n```\n"}]}
{"messages": [{"role": "system", "content": "You are an expert in the Witness supply chain attestation framework. You help users instrument CI/CD pipelines with witness, create policy documents, and write Rego policies to validate attestations. You understand all attestors in go-witness and how to use them effectively."}, {"role": "user", "content": "How do I create a witness policy for a build step that uses these attestors: git?"}, {"role": "assistant", "content": "Here's a complete witness policy for your build step with git attestors:\n\n**Policy Document:**\n```json\n{\n  \"expires\": \"2026-11-08T10:52:59Z\",\n  \"publickeys\": {\n    \"build-key\": {\n      \"keyid\": \"sha256:f0a094d78adeb324e43362487172ec3f1f17bfb66b4c84a241b0eb59b874db45\",\n      \"key\": \"-----BEGIN PUBLIC KEY-----\\n...\\n-----END PUBLIC KEY-----\"\n    }\n  },\n  \"steps\": {\n    \"build\": {\n      \"name\": \"build\",\n      \"attestations\": [\n        {\n          \"type\": \"https://witness.dev/attestations/git/v0.1\"\n        }\n      ],\n      \"functionaries\": [\n        {\n          \"type\": \"publickey\",\n          \"publickeyid\": \"build-key\"\n        }\n      ]\n    }\n  }\n}\n```\n\n**Witness Run Command:**\n```bash\nwitness run --step build \\\n  --attestations git \\\n  --outfile build-attestation.json \\\n  --key signing-key.pem \\\n  -- <your-build-command>\n```\n\n**Rego Validation Rules:**\n```rego\npackage git\n\nimport rego.v1\n\n# Enforce builds from specific branch\ndeny contains msg if {\n    input.branch != \"master\"\n    msg := sprintf(\"Must build from master branch, got: %s\", [input.branch])\n}\n\n# Require clean working directory\ndeny contains msg if {\n    count(input.status) > 0\n    msg := \"Working directory must be clean (no uncommitted changes)\"\n}\n\n# Validate commit author\napproved_authors := {\n    \"alice.smith@example.com\",\n    \"bob.jones@company.com\",\n    \"ci-bot@company.com\"\n}\n\ndeny contains msg if {\n    not input.authoremail in approved_authors\n    msg := sprintf(\"Unauthorized commit author: %s\", [input.authoremail])\n}\n```\n\n**Verification:**\n```bash\nwitness verify \\\n  --policy policy-signed.json \\\n  --publickey policy-key.pub \\\n  -a build-attestation.json \\\n  --subject <artifact>\n```\n"}]}
{"messages": [{"role": "system", "content": "You are an expert in the Witness supply chain attestation framework. You help users instrument CI/CD pipelines with witness, create policy documents, and write Rego policies to validate attestations. You understand all attestors in go-witness and how to use them effectively."}, {"role": "user", "content": "How do I create a multi-step witness policy for a build \u2192 test \u2192 package pipeline?"}, {"role": "assistant", "content": "Here's a complete multi-step witness policy for your pipeline:\n\n**Policy Document:**\n```json\n{\n  \"expires\": \"2026-11-08T10:52:59Z\",\n  \"publickeys\": {\n    \"ci-key\": {\n      \"keyid\": \"sha256:a83958c90162ad9bae8ebc0b9eea0e93e483781d8b3bbd3d3b14d57fa8ed56e9\",\n      \"key\": \"-----BEGIN PUBLIC KEY-----\\n...\\n-----END PUBLIC KEY-----\"\n    }\n  },\n  \"steps\": {\n    \"build\": {\n      \"name\": \"build\",\n      \"attestations\": [\n        {\n          \"type\": \"https://witness.dev/attestations/git/v0.1\"\n        },\n        {\n          \"type\": \"https://witness.dev/attestations/command-run/v0.1\"\n        },\n        {\n          \"type\": \"https://witness.dev/attestations/product/v0.1\"\n        }\n      ],\n      \"functionaries\": [\n        {\n          \"type\": \"publickey\",\n          \"publickeyid\": \"ci-key\"\n        }\n      ]\n    },\n    \"test\": {\n      \"name\": \"test\",\n      \"attestations\": [\n        {\n          \"type\": \"https://witness.dev/attestations/material/v0.1\"\n        },\n        {\n          \"type\": \"https://witness.dev/attestations/command-run/v0.1\"\n        }\n      ],\n      \"functionaries\": [\n        {\n          \"type\": \"publickey\",\n          \"publickeyid\": \"ci-key\"\n        }\n      ]\n    },\n    \"package\": {\n      \"name\": \"package\",\n      \"attestations\": [\n        {\n          \"type\": \"https://witness.dev/attestations/material/v0.1\"\n        },\n        {\n          \"type\": \"https://witness.dev/attestations/product/v0.1\"\n        }\n      ],\n      \"functionaries\": [\n        {\n          \"type\": \"publickey\",\n          \"publickeyid\": \"ci-key\"\n        }\n      ]\n    }\n  }\n}\n```\n\n**Pipeline Commands:**\n\n```bash\n# Step 1: Build\nwitness run --step build \\\n  --attestations git,commandrun,product \\\n  -o build.json --key ci-key.pem \\\n  -- go build -o myapp\n\n# Step 2: Test\nwitness run --step test \\\n  --attestations material,commandrun \\\n  -o test.json --key ci-key.pem \\\n  -- go test ./...\n\n# Step 3: Package\nwitness run --step package \\\n  --attestations material,product \\\n  -o package.json --key ci-key.pem \\\n  -- tar czf myapp.tar.gz myapp\n\n# Verify entire pipeline\nwitness verify \\\n  --policy policy-signed.json \\\n  --publickey policy-key.pub \\\n  -a build.json -a test.json -a package.json\n```\n"}]}
{"messages": [{"role": "system", "content": "You are an expert in the Witness supply chain attestation framework. You help users instrument CI/CD pipelines with witness, create policy documents, and write Rego policies to validate attestations. You understand all attestors in go-witness and how to use them effectively."}, {"role": "user", "content": "How do I create a witness policy for a build step that uses these attestors: git, material, product?"}, {"role": "assistant", "content": "Here's a complete witness policy for your build step with git, material, product attestors:\n\n**Policy Document:**\n```json\n{\n  \"expires\": \"2026-11-08T10:52:59Z\",\n  \"publickeys\": {\n    \"build-key\": {\n      \"keyid\": \"sha256:f418688fb75c99a58d0fce168d76a474d2a64753fdaf02d824d7d8acc00dde88\",\n      \"key\": \"-----BEGIN PUBLIC KEY-----\\n...\\n-----END PUBLIC KEY-----\"\n    }\n  },\n  \"steps\": {\n    \"build\": {\n      \"name\": \"build\",\n      \"attestations\": [\n        {\n          \"type\": \"https://witness.dev/attestations/git/v0.1\"\n        },\n        {\n          \"type\": \"https://witness.dev/attestations/material/v0.1\"\n        },\n        {\n          \"type\": \"https://witness.dev/attestations/product/v0.1\"\n        }\n      ],\n      \"functionaries\": [\n        {\n          \"type\": \"publickey\",\n          \"publickeyid\": \"build-key\"\n        }\n      ]\n    }\n  }\n}\n```\n\n**Witness Run Command:**\n```bash\nwitness run --step build \\\n  --attestations git,material,product \\\n  --outfile build-attestation.json \\\n  --key signing-key.pem \\\n  -- <your-build-command>\n```\n\n**Rego Validation Rules:**\n```rego\npackage git\n\nimport rego.v1\n\n# Enforce builds from specific branch\ndeny contains msg if {\n    input.branch != \"master\"\n    msg := sprintf(\"Must build from master branch, got: %s\", [input.branch])\n}\n\n# Require clean working directory\ndeny contains msg if {\n    count(input.status) > 0\n    msg := \"Working directory must be clean (no uncommitted changes)\"\n}\n\n# Validate commit author\napproved_authors := {\n    \"alice.smith@example.com\",\n    \"bob.jones@company.com\",\n    \"ci-bot@company.com\"\n}\n\ndeny contains msg if {\n    not input.authoremail in approved_authors\n    msg := sprintf(\"Unauthorized commit author: %s\", [input.authoremail])\n}\n```\n\n**Verification:**\n```bash\nwitness verify \\\n  --policy policy-signed.json \\\n  --publickey policy-key.pub \\\n  -a build-attestation.json \\\n  --subject <artifact>\n```\n"}]}
{"messages": [{"role": "system", "content": "You are an expert in the Witness supply chain attestation framework. You help users instrument CI/CD pipelines with witness, create policy documents, and write Rego policies to validate attestations. You understand all attestors in go-witness and how to use them effectively."}, {"role": "user", "content": "How do I create a witness policy for a build step that uses these attestors: material?"}, {"role": "assistant", "content": "Here's a complete witness policy for your build step with material attestors:\n\n**Policy Document:**\n```json\n{\n  \"expires\": \"2026-11-08T10:52:59Z\",\n  \"publickeys\": {\n    \"build-key\": {\n      \"keyid\": \"sha256:4afefac9a1d40ea70fd49045110ed4b85b7856af5911e49f3f48ffc8cf524032\",\n      \"key\": \"-----BEGIN PUBLIC KEY-----\\n...\\n-----END PUBLIC KEY-----\"\n    }\n  },\n  \"steps\": {\n    \"build\": {\n      \"name\": \"build\",\n      \"attestations\": [\n        {\n          \"type\": \"https://witness.dev/attestations/material/v0.1\"\n        }\n      ],\n      \"functionaries\": [\n        {\n          \"type\": \"publickey\",\n          \"publickeyid\": \"build-key\"\n        }\n      ]\n    }\n  }\n}\n```\n\n**Witness Run Command:**\n```bash\nwitness run --step build \\\n  --attestations material \\\n  --outfile build-attestation.json \\\n  --key signing-key.pem \\\n  -- <your-build-command>\n```\n\n**Rego Validation Rules:**\n```rego\n\n```\n\n**Verification:**\n```bash\nwitness verify \\\n  --policy policy-signed.json \\\n  --publickey policy-key.pub \\\n  -a build-attestation.json \\\n  --subject <artifact>\n```\n"}]}
{"messages": [{"role": "system", "content": "You are an expert in the Witness supply chain attestation framework. You help users instrument CI/CD pipelines with witness, create policy documents, and write Rego policies to validate attestations. You understand all attestors in go-witness and how to use them effectively."}, {"role": "user", "content": "How do I create a witness policy for a build step that uses these attestors: product, git, github?"}, {"role": "assistant", "content": "Here's a complete witness policy for your build step with product, git, github attestors:\n\n**Policy Document:**\n```json\n{\n  \"expires\": \"2026-11-08T10:52:59Z\",\n  \"publickeys\": {\n    \"build-key\": {\n      \"keyid\": \"sha256:6bd5ed31ed92597556df338c308d51f2248ef4d71d426df7bce5b0810de758fe\",\n      \"key\": \"-----BEGIN PUBLIC KEY-----\\n...\\n-----END PUBLIC KEY-----\"\n    }\n  },\n  \"steps\": {\n    \"build\": {\n      \"name\": \"build\",\n      \"attestations\": [\n        {\n          \"type\": \"https://witness.dev/attestations/product/v0.1\"\n        },\n        {\n          \"type\": \"https://witness.dev/attestations/git/v0.1\"\n        },\n        {\n          \"type\": \"https://witness.dev/attestations/github/v0.1\"\n        }\n      ],\n      \"functionaries\": [\n        {\n          \"type\": \"publickey\",\n          \"publickeyid\": \"build-key\"\n        }\n      ]\n    }\n  }\n}\n```\n\n**Witness Run Command:**\n```bash\nwitness run --step build \\\n  --attestations product,git,github \\\n  --outfile build-attestation.json \\\n  --key signing-key.pem \\\n  -- <your-build-command>\n```\n\n**Rego Validation Rules:**\n```rego\n\n```\n\n**Verification:**\n```bash\nwitness verify \\\n  --policy policy-signed.json \\\n  --publickey policy-key.pub \\\n  -a build-attestation.json \\\n  --subject <artifact>\n```\n"}]}
{"messages": [{"role": "system", "content": "You are an expert in the Witness supply chain attestation framework. You help users instrument CI/CD pipelines with witness, create policy documents, and write Rego policies to validate attestations. You understand all attestors in go-witness and how to use them effectively."}, {"role": "user", "content": "How do I create a witness policy for a build step that uses these attestors: environment, commandrun, github, material?"}, {"role": "assistant", "content": "Here's a complete witness policy for your build step with environment, commandrun, github, material attestors:\n\n**Policy Document:**\n```json\n{\n  \"expires\": \"2026-11-08T10:52:59Z\",\n  \"publickeys\": {\n    \"build-key\": {\n      \"keyid\": \"sha256:55557ba1370e942dc9c91df328a515c0d80d22d05ecf4aba2f1b7d4f02e31c0f\",\n      \"key\": \"-----BEGIN PUBLIC KEY-----\\n...\\n-----END PUBLIC KEY-----\"\n    }\n  },\n  \"steps\": {\n    \"build\": {\n      \"name\": \"build\",\n      \"attestations\": [\n        {\n          \"type\": \"https://witness.dev/attestations/environment/v0.1\"\n        },\n        {\n          \"type\": \"https://witness.dev/attestations/command-run/v0.1\"\n        },\n        {\n          \"type\": \"https://witness.dev/attestations/github/v0.1\"\n        },\n        {\n          \"type\": \"https://witness.dev/attestations/material/v0.1\"\n        }\n      ],\n      \"functionaries\": [\n        {\n          \"type\": \"publickey\",\n          \"publickeyid\": \"build-key\"\n        }\n      ]\n    }\n  }\n}\n```\n\n**Witness Run Command:**\n```bash\nwitness run --step build \\\n  --attestations environment,commandrun,github,material \\\n  --outfile build-attestation.json \\\n  --key signing-key.pem \\\n  -- <your-build-command>\n```\n\n**Rego Validation Rules:**\n```rego\npackage environment\n\nimport rego.v1\n\n# Ensure correct OS\ndeny contains msg if {\n    input.os != \"windows\"\n    msg := sprintf(\"Must run on windows, got: %s\", [input.os])\n}\n\n# Require CI environment\ndeny contains msg if {\n    not \"CI\" in input.variables\n    msg := \"Must run in CI environment (CI variable not set)\"\n}\n```\n\n**Verification:**\n```bash\nwitness verify \\\n  --policy policy-signed.json \\\n  --publickey policy-key.pub \\\n  -a build-attestation.json \\\n  --subject <artifact>\n```\n"}]}
{"messages": [{"role": "system", "content": "You are an expert in the Witness supply chain attestation framework. You help users instrument CI/CD pipelines with witness, create policy documents, and write Rego policies to validate attestations. You understand all attestors in go-witness and how to use them effectively."}, {"role": "user", "content": "How do I create a witness policy for a build step that uses these attestors: github, material, git?"}, {"role": "assistant", "content": "Here's a complete witness policy for your build step with github, material, git attestors:\n\n**Policy Document:**\n```json\n{\n  \"expires\": \"2026-11-08T10:52:59Z\",\n  \"publickeys\": {\n    \"build-key\": {\n      \"keyid\": \"sha256:aef66b5911960e0d3aa52a351c9c8a743377807a8d6dbf3485e79df2e4e37c28\",\n      \"key\": \"-----BEGIN PUBLIC KEY-----\\n...\\n-----END PUBLIC KEY-----\"\n    }\n  },\n  \"steps\": {\n    \"build\": {\n      \"name\": \"build\",\n      \"attestations\": [\n        {\n          \"type\": \"https://witness.dev/attestations/github/v0.1\"\n        },\n        {\n          \"type\": \"https://witness.dev/attestations/material/v0.1\"\n        },\n        {\n          \"type\": \"https://witness.dev/attestations/git/v0.1\"\n        }\n      ],\n      \"functionaries\": [\n        {\n          \"type\": \"publickey\",\n          \"publickeyid\": \"build-key\"\n        }\n      ]\n    }\n  }\n}\n```\n\n**Witness Run Command:**\n```bash\nwitness run --step build \\\n  --attestations github,material,git \\\n  --outfile build-attestation.json \\\n  --key signing-key.pem \\\n  -- <your-build-command>\n```\n\n**Rego Validation Rules:**\n```rego\n\n```\n\n**Verification:**\n```bash\nwitness verify \\\n  --policy policy-signed.json \\\n  --publickey policy-key.pub \\\n  -a build-attestation.json \\\n  --subject <artifact>\n```\n"}]}
{"messages": [{"role": "system", "content": "You are an expert in the Witness supply chain attestation framework. You help users instrument CI/CD pipelines with witness, create policy documents, and write Rego policies to validate attestations. You understand all attestors in go-witness and how to use them effectively."}, {"role": "user", "content": "How do I create a witness policy for a build step that uses these attestors: product, github?"}, {"role": "assistant", "content": "Here's a complete witness policy for your build step with product, github attestors:\n\n**Policy Document:**\n```json\n{\n  \"expires\": \"2026-11-08T10:52:59Z\",\n  \"publickeys\": {\n    \"build-key\": {\n      \"keyid\": \"sha256:5ae8047573686e2f88d7122d6992e8f799105ac9b656f630c3edbdd32cfa639e\",\n      \"key\": \"-----BEGIN PUBLIC KEY-----\\n...\\n-----END PUBLIC KEY-----\"\n    }\n  },\n  \"steps\": {\n    \"build\": {\n      \"name\": \"build\",\n      \"attestations\": [\n        {\n          \"type\": \"https://witness.dev/attestations/product/v0.1\"\n        },\n        {\n          \"type\": \"https://witness.dev/attestations/github/v0.1\"\n        }\n      ],\n      \"functionaries\": [\n        {\n          \"type\": \"publickey\",\n          \"publickeyid\": \"build-key\"\n        }\n      ]\n    }\n  }\n}\n```\n\n**Witness Run Command:**\n```bash\nwitness run --step build \\\n  --attestations product,github \\\n  --outfile build-attestation.json \\\n  --key signing-key.pem \\\n  -- <your-build-command>\n```\n\n**Rego Validation Rules:**\n```rego\n\n```\n\n**Verification:**\n```bash\nwitness verify \\\n  --policy policy-signed.json \\\n  --publickey policy-key.pub \\\n  -a build-attestation.json \\\n  --subject <artifact>\n```\n"}]}
{"messages": [{"role": "system", "content": "You are an expert in the Witness supply chain attestation framework. You help users instrument CI/CD pipelines with witness, create policy documents, and write Rego policies to validate attestations. You understand all attestors in go-witness and how to use them effectively."}, {"role": "user", "content": "How do I create a witness policy for a build step that uses these attestors: environment?"}, {"role": "assistant", "content": "Here's a complete witness policy for your build step with environment attestors:\n\n**Policy Document:**\n```json\n{\n  \"expires\": \"2026-11-08T10:52:59Z\",\n  \"publickeys\": {\n    \"build-key\": {\n      \"keyid\": \"sha256:1540f5a340107b0a834006d0c0cd90eb001505bb8b592e7e99fb401bba9d6bea\",\n      \"key\": \"-----BEGIN PUBLIC KEY-----\\n...\\n-----END PUBLIC KEY-----\"\n    }\n  },\n  \"steps\": {\n    \"build\": {\n      \"name\": \"build\",\n      \"attestations\": [\n        {\n          \"type\": \"https://witness.dev/attestations/environment/v0.1\"\n        }\n      ],\n      \"functionaries\": [\n        {\n          \"type\": \"publickey\",\n          \"publickeyid\": \"build-key\"\n        }\n      ]\n    }\n  }\n}\n```\n\n**Witness Run Command:**\n```bash\nwitness run --step build \\\n  --attestations environment \\\n  --outfile build-attestation.json \\\n  --key signing-key.pem \\\n  -- <your-build-command>\n```\n\n**Rego Validation Rules:**\n```rego\npackage environment\n\nimport rego.v1\n\n# Ensure correct OS\ndeny contains msg if {\n    input.os != \"darwin\"\n    msg := sprintf(\"Must run on darwin, got: %s\", [input.os])\n}\n\n# Require CI environment\ndeny contains msg if {\n    not \"CI\" in input.variables\n    msg := \"Must run in CI environment (CI variable not set)\"\n}\n```\n\n**Verification:**\n```bash\nwitness verify \\\n  --policy policy-signed.json \\\n  --publickey policy-key.pub \\\n  -a build-attestation.json \\\n  --subject <artifact>\n```\n"}]}
{"messages": [{"role": "system", "content": "You are an expert in the Witness supply chain attestation framework. You help users instrument CI/CD pipelines with witness, create policy documents, and write Rego policies to validate attestations. You understand all attestors in go-witness and how to use them effectively."}, {"role": "user", "content": "How do I create a witness policy for a build step that uses these attestors: commandrun, product, github?"}, {"role": "assistant", "content": "Here's a complete witness policy for your build step with commandrun, product, github attestors:\n\n**Policy Document:**\n```json\n{\n  \"expires\": \"2026-11-08T10:52:59Z\",\n  \"publickeys\": {\n    \"build-key\": {\n      \"keyid\": \"sha256:b20d1c35ea25f756f6794c2a2829a987857c39b4b0175340ec96a685e3521e3d\",\n      \"key\": \"-----BEGIN PUBLIC KEY-----\\n...\\n-----END PUBLIC KEY-----\"\n    }\n  },\n  \"steps\": {\n    \"build\": {\n      \"name\": \"build\",\n      \"attestations\": [\n        {\n          \"type\": \"https://witness.dev/attestations/command-run/v0.1\"\n        },\n        {\n          \"type\": \"https://witness.dev/attestations/product/v0.1\"\n        },\n        {\n          \"type\": \"https://witness.dev/attestations/github/v0.1\"\n        }\n      ],\n      \"functionaries\": [\n        {\n          \"type\": \"publickey\",\n          \"publickeyid\": \"build-key\"\n        }\n      ]\n    }\n  }\n}\n```\n\n**Witness Run Command:**\n```bash\nwitness run --step build \\\n  --attestations commandrun,product,github \\\n  --outfile build-attestation.json \\\n  --key signing-key.pem \\\n  -- <your-build-command>\n```\n\n**Rego Validation Rules:**\n```rego\n\n```\n\n**Verification:**\n```bash\nwitness verify \\\n  --policy policy-signed.json \\\n  --publickey policy-key.pub \\\n  -a build-attestation.json \\\n  --subject <artifact>\n```\n"}]}
{"messages": [{"role": "system", "content": "You are an expert in the Witness supply chain attestation framework. You help users instrument CI/CD pipelines with witness, create policy documents, and write Rego policies to validate attestations. You understand all attestors in go-witness and how to use them effectively."}, {"role": "user", "content": "How do I create a witness policy for a build step that uses these attestors: material, git, environment?"}, {"role": "assistant", "content": "Here's a complete witness policy for your build step with material, git, environment attestors:\n\n**Policy Document:**\n```json\n{\n  \"expires\": \"2026-11-08T10:52:59Z\",\n  \"publickeys\": {\n    \"build-key\": {\n      \"keyid\": \"sha256:5cf26d726a20727caea5bd2adef03e6a05ef7b7d4c8dfdc62e9c583b361c8cef\",\n      \"key\": \"-----BEGIN PUBLIC KEY-----\\n...\\n-----END PUBLIC KEY-----\"\n    }\n  },\n  \"steps\": {\n    \"build\": {\n      \"name\": \"build\",\n      \"attestations\": [\n        {\n          \"type\": \"https://witness.dev/attestations/material/v0.1\"\n        },\n        {\n          \"type\": \"https://witness.dev/attestations/git/v0.1\"\n        },\n        {\n          \"type\": \"https://witness.dev/attestations/environment/v0.1\"\n        }\n      ],\n      \"functionaries\": [\n        {\n          \"type\": \"publickey\",\n          \"publickeyid\": \"build-key\"\n        }\n      ]\n    }\n  }\n}\n```\n\n**Witness Run Command:**\n```bash\nwitness run --step build \\\n  --attestations material,git,environment \\\n  --outfile build-attestation.json \\\n  --key signing-key.pem \\\n  -- <your-build-command>\n```\n\n**Rego Validation Rules:**\n```rego\n\n```\n\n**Verification:**\n```bash\nwitness verify \\\n  --policy policy-signed.json \\\n  --publickey policy-key.pub \\\n  -a build-attestation.json \\\n  --subject <artifact>\n```\n"}]}
{"messages": [{"role": "system", "content": "You are an expert in the Witness supply chain attestation framework. You help users instrument CI/CD pipelines with witness, create policy documents, and write Rego policies to validate attestations. You understand all attestors in go-witness and how to use them effectively."}, {"role": "user", "content": "How do I create a witness policy for a build step that uses these attestors: git, material, environment, product, commandrun?"}, {"role": "assistant", "content": "Here's a complete witness policy for your build step with git, material, environment, product, commandrun attestors:\n\n**Policy Document:**\n```json\n{\n  \"expires\": \"2026-11-08T10:52:59Z\",\n  \"publickeys\": {\n    \"build-key\": {\n      \"keyid\": \"sha256:5a61a2d95160dac78614a9012fd8a714eeb7766bc258b56e07312302e9faeda3\",\n      \"key\": \"-----BEGIN PUBLIC KEY-----\\n...\\n-----END PUBLIC KEY-----\"\n    }\n  },\n  \"steps\": {\n    \"build\": {\n      \"name\": \"build\",\n      \"attestations\": [\n        {\n          \"type\": \"https://witness.dev/attestations/git/v0.1\"\n        },\n        {\n          \"type\": \"https://witness.dev/attestations/material/v0.1\"\n        },\n        {\n          \"type\": \"https://witness.dev/attestations/environment/v0.1\"\n        },\n        {\n          \"type\": \"https://witness.dev/attestations/product/v0.1\"\n        },\n        {\n          \"type\": \"https://witness.dev/attestations/command-run/v0.1\"\n        }\n      ],\n      \"functionaries\": [\n        {\n          \"type\": \"publickey\",\n          \"publickeyid\": \"build-key\"\n        }\n      ]\n    }\n  }\n}\n```\n\n**Witness Run Command:**\n```bash\nwitness run --step build \\\n  --attestations git,material,environment,product,commandrun \\\n  --outfile build-attestation.json \\\n  --key signing-key.pem \\\n  -- <your-build-command>\n```\n\n**Rego Validation Rules:**\n```rego\npackage git\n\nimport rego.v1\n\n# Enforce builds from specific branch\ndeny contains msg if {\n    input.branch != \"bugfix/security\"\n    msg := sprintf(\"Must build from bugfix/security branch, got: %s\", [input.branch])\n}\n\n# Require clean working directory\ndeny contains msg if {\n    count(input.status) > 0\n    msg := \"Working directory must be clean (no uncommitted changes)\"\n}\n\n# Validate commit author\napproved_authors := {\n    \"alice.smith@example.com\",\n    \"bob.jones@company.com\",\n    \"ci-bot@company.com\"\n}\n\ndeny contains msg if {\n    not input.authoremail in approved_authors\n    msg := sprintf(\"Unauthorized commit author: %s\", [input.authoremail])\n}\n```\n\n**Verification:**\n```bash\nwitness verify \\\n  --policy policy-signed.json \\\n  --publickey policy-key.pub \\\n  -a build-attestation.json \\\n  --subject <artifact>\n```\n"}]}
{"messages": [{"role": "system", "content": "You are an expert in the Witness supply chain attestation framework. You help users instrument CI/CD pipelines with witness, create policy documents, and write Rego policies to validate attestations. You understand all attestors in go-witness and how to use them effectively."}, {"role": "user", "content": "How do I create a witness policy for a build step that uses these attestors: product?"}, {"role": "assistant", "content": "Here's a complete witness policy for your build step with product attestors:\n\n**Policy Document:**\n```json\n{\n  \"expires\": \"2026-11-08T10:52:59Z\",\n  \"publickeys\": {\n    \"build-key\": {\n      \"keyid\": \"sha256:13ed48407816f04ff6a82f4b5f3fb2d6041861c130b93bdaed6afce04a1573d5\",\n      \"key\": \"-----BEGIN PUBLIC KEY-----\\n...\\n-----END PUBLIC KEY-----\"\n    }\n  },\n  \"steps\": {\n    \"build\": {\n      \"name\": \"build\",\n      \"attestations\": [\n        {\n          \"type\": \"https://witness.dev/attestations/product/v0.1\"\n        }\n      ],\n      \"functionaries\": [\n        {\n          \"type\": \"publickey\",\n          \"publickeyid\": \"build-key\"\n        }\n      ]\n    }\n  }\n}\n```\n\n**Witness Run Command:**\n```bash\nwitness run --step build \\\n  --attestations product \\\n  --outfile build-attestation.json \\\n  --key signing-key.pem \\\n  -- <your-build-command>\n```\n\n**Rego Validation Rules:**\n```rego\n\n```\n\n**Verification:**\n```bash\nwitness verify \\\n  --policy policy-signed.json \\\n  --publickey policy-key.pub \\\n  -a build-attestation.json \\\n  --subject <artifact>\n```\n"}]}
{"messages": [{"role": "system", "content": "You are an expert in the Witness supply chain attestation framework. You help users instrument CI/CD pipelines with witness, create policy documents, and write Rego policies to validate attestations. You understand all attestors in go-witness and how to use them effectively."}, {"role": "user", "content": "How do I create a multi-step witness policy for a build \u2192 test \u2192 package pipeline?"}, {"role": "assistant", "content": "Here's a complete multi-step witness policy for your pipeline:\n\n**Policy Document:**\n```json\n{\n  \"expires\": \"2026-11-08T10:52:59Z\",\n  \"publickeys\": {\n    \"ci-key\": {\n      \"keyid\": \"sha256:1ee39143297dc79cd4bdabf92cbcdc037066e89a1b9f29effcf54362e49897a4\",\n      \"key\": \"-----BEGIN PUBLIC KEY-----\\n...\\n-----END PUBLIC KEY-----\"\n    }\n  },\n  \"steps\": {\n    \"build\": {\n      \"name\": \"build\",\n      \"attestations\": [\n        {\n          \"type\": \"https://witness.dev/attestations/git/v0.1\"\n        },\n        {\n          \"type\": \"https://witness.dev/attestations/command-run/v0.1\"\n        },\n        {\n          \"type\": \"https://witness.dev/attestations/product/v0.1\"\n        }\n      ],\n      \"functionaries\": [\n        {\n          \"type\": \"publickey\",\n          \"publickeyid\": \"ci-key\"\n        }\n      ]\n    },\n    \"test\": {\n      \"name\": \"test\",\n      \"attestations\": [\n        {\n          \"type\": \"https://witness.dev/attestations/material/v0.1\"\n        },\n        {\n          \"type\": \"https://witness.dev/attestations/command-run/v0.1\"\n        }\n      ],\n      \"functionaries\": [\n        {\n          \"type\": \"publickey\",\n          \"publickeyid\": \"ci-key\"\n        }\n      ]\n    },\n    \"package\": {\n      \"name\": \"package\",\n      \"attestations\": [\n        {\n          \"type\": \"https://witness.dev/attestations/material/v0.1\"\n        },\n        {\n          \"type\": \"https://witness.dev/attestations/product/v0.1\"\n        }\n      ],\n      \"functionaries\": [\n        {\n          \"type\": \"publickey\",\n          \"publickeyid\": \"ci-key\"\n        }\n      ]\n    }\n  }\n}\n```\n\n**Pipeline Commands:**\n\n```bash\n# Step 1: Build\nwitness run --step build \\\n  --attestations git,commandrun,product \\\n  -o build.json --key ci-key.pem \\\n  -- go build -o myapp\n\n# Step 2: Test\nwitness run --step test \\\n  --attestations material,commandrun \\\n  -o test.json --key ci-key.pem \\\n  -- go test ./...\n\n# Step 3: Package\nwitness run --step package \\\n  --attestations material,product \\\n  -o package.json --key ci-key.pem \\\n  -- tar czf myapp.tar.gz myapp\n\n# Verify entire pipeline\nwitness verify \\\n  --policy policy-signed.json \\\n  --publickey policy-key.pub \\\n  -a build.json -a test.json -a package.json\n```\n"}]}
{"messages": [{"role": "system", "content": "You are an expert in the Witness supply chain attestation framework. You help users instrument CI/CD pipelines with witness, create policy documents, and write Rego policies to validate attestations. You understand all attestors in go-witness and how to use them effectively."}, {"role": "user", "content": "How do I create a witness policy for a build step that uses these attestors: environment?"}, {"role": "assistant", "content": "Here's a complete witness policy for your build step with environment attestors:\n\n**Policy Document:**\n```json\n{\n  \"expires\": \"2026-11-08T10:52:59Z\",\n  \"publickeys\": {\n    \"build-key\": {\n      \"keyid\": \"sha256:0ea28f4145e00e4844ed120d05ad84d61301e0ed2afa7d0d6417f4edfba40a72\",\n      \"key\": \"-----BEGIN PUBLIC KEY-----\\n...\\n-----END PUBLIC KEY-----\"\n    }\n  },\n  \"steps\": {\n    \"build\": {\n      \"name\": \"build\",\n      \"attestations\": [\n        {\n          \"type\": \"https://witness.dev/attestations/environment/v0.1\"\n        }\n      ],\n      \"functionaries\": [\n        {\n          \"type\": \"publickey\",\n          \"publickeyid\": \"build-key\"\n        }\n      ]\n    }\n  }\n}\n```\n\n**Witness Run Command:**\n```bash\nwitness run --step build \\\n  --attestations environment \\\n  --outfile build-attestation.json \\\n  --key signing-key.pem \\\n  -- <your-build-command>\n```\n\n**Rego Validation Rules:**\n```rego\npackage environment\n\nimport rego.v1\n\n# Ensure correct OS\ndeny contains msg if {\n    input.os != \"darwin\"\n    msg := sprintf(\"Must run on darwin, got: %s\", [input.os])\n}\n\n# Require CI environment\ndeny contains msg if {\n    not \"CI\" in input.variables\n    msg := \"Must run in CI environment (CI variable not set)\"\n}\n```\n\n**Verification:**\n```bash\nwitness verify \\\n  --policy policy-signed.json \\\n  --publickey policy-key.pub \\\n  -a build-attestation.json \\\n  --subject <artifact>\n```\n"}]}
{"messages": [{"role": "system", "content": "You are an expert in the Witness supply chain attestation framework. You help users instrument CI/CD pipelines with witness, create policy documents, and write Rego policies to validate attestations. You understand all attestors in go-witness and how to use them effectively."}, {"role": "user", "content": "How do I create a witness policy for a build step that uses these attestors: product, environment, github, material?"}, {"role": "assistant", "content": "Here's a complete witness policy for your build step with product, environment, github, material attestors:\n\n**Policy Document:**\n```json\n{\n  \"expires\": \"2026-11-08T10:52:59Z\",\n  \"publickeys\": {\n    \"build-key\": {\n      \"keyid\": \"sha256:7f5ec55c9da55b0865c7bebd5d7d37bce2eedbb6ea7028f2f107adcfc2a3ac33\",\n      \"key\": \"-----BEGIN PUBLIC KEY-----\\n...\\n-----END PUBLIC KEY-----\"\n    }\n  },\n  \"steps\": {\n    \"build\": {\n      \"name\": \"build\",\n      \"attestations\": [\n        {\n          \"type\": \"https://witness.dev/attestations/product/v0.1\"\n        },\n        {\n          \"type\": \"https://witness.dev/attestations/environment/v0.1\"\n        },\n        {\n          \"type\": \"https://witness.dev/attestations/github/v0.1\"\n        },\n        {\n          \"type\": \"https://witness.dev/attestations/material/v0.1\"\n        }\n      ],\n      \"functionaries\": [\n        {\n          \"type\": \"publickey\",\n          \"publickeyid\": \"build-key\"\n        }\n      ]\n    }\n  }\n}\n```\n\n**Witness Run Command:**\n```bash\nwitness run --step build \\\n  --attestations product,environment,github,material \\\n  --outfile build-attestation.json \\\n  --key signing-key.pem \\\n  -- <your-build-command>\n```\n\n**Rego Validation Rules:**\n```rego\n\n```\n\n**Verification:**\n```bash\nwitness verify \\\n  --policy policy-signed.json \\\n  --publickey policy-key.pub \\\n  -a build-attestation.json \\\n  --subject <artifact>\n```\n"}]}
{"messages": [{"role": "system", "content": "You are an expert in the Witness supply chain attestation framework. You help users instrument CI/CD pipelines with witness, create policy documents, and write Rego policies to validate attestations. You understand all attestors in go-witness and how to use them effectively."}, {"role": "user", "content": "How do I create a witness policy for a build step that uses these attestors: material, product?"}, {"role": "assistant", "content": "Here's a complete witness policy for your build step with material, product attestors:\n\n**Policy Document:**\n```json\n{\n  \"expires\": \"2026-11-08T10:52:59Z\",\n  \"publickeys\": {\n    \"build-key\": {\n      \"keyid\": \"sha256:107b4ecefec41ec3a8ed169853eea9995bafa7dadfb3cf0c3b3cba7ec672cc1c\",\n      \"key\": \"-----BEGIN PUBLIC KEY-----\\n...\\n-----END PUBLIC KEY-----\"\n    }\n  },\n  \"steps\": {\n    \"build\": {\n      \"name\": \"build\",\n      \"attestations\": [\n        {\n          \"type\": \"https://witness.dev/attestations/material/v0.1\"\n        },\n        {\n          \"type\": \"https://witness.dev/attestations/product/v0.1\"\n        }\n      ],\n      \"functionaries\": [\n        {\n          \"type\": \"publickey\",\n          \"publickeyid\": \"build-key\"\n        }\n      ]\n    }\n  }\n}\n```\n\n**Witness Run Command:**\n```bash\nwitness run --step build \\\n  --attestations material,product \\\n  --outfile build-attestation.json \\\n  --key signing-key.pem \\\n  -- <your-build-command>\n```\n\n**Rego Validation Rules:**\n```rego\n\n```\n\n**Verification:**\n```bash\nwitness verify \\\n  --policy policy-signed.json \\\n  --publickey policy-key.pub \\\n  -a build-attestation.json \\\n  --subject <artifact>\n```\n"}]}
{"messages": [{"role": "system", "content": "You are an expert in the Witness supply chain attestation framework. You help users instrument CI/CD pipelines with witness, create policy documents, and write Rego policies to validate attestations. You understand all attestors in go-witness and how to use them effectively."}, {"role": "user", "content": "How do I create a witness policy for a build step that uses these attestors: git, github, commandrun, material?"}, {"role": "assistant", "content": "Here's a complete witness policy for your build step with git, github, commandrun, material attestors:\n\n**Policy Document:**\n```json\n{\n  \"expires\": \"2026-11-08T10:52:59Z\",\n  \"publickeys\": {\n    \"build-key\": {\n      \"keyid\": \"sha256:9d99bb7eb50aad33a17da0e249f4ca0b47aa281939146f3e40087537671701eb\",\n      \"key\": \"-----BEGIN PUBLIC KEY-----\\n...\\n-----END PUBLIC KEY-----\"\n    }\n  },\n  \"steps\": {\n    \"build\": {\n      \"name\": \"build\",\n      \"attestations\": [\n        {\n          \"type\": \"https://witness.dev/attestations/git/v0.1\"\n        },\n        {\n          \"type\": \"https://witness.dev/attestations/github/v0.1\"\n        },\n        {\n          \"type\": \"https://witness.dev/attestations/command-run/v0.1\"\n        },\n        {\n          \"type\": \"https://witness.dev/attestations/material/v0.1\"\n        }\n      ],\n      \"functionaries\": [\n        {\n          \"type\": \"publickey\",\n          \"publickeyid\": \"build-key\"\n        }\n      ]\n    }\n  }\n}\n```\n\n**Witness Run Command:**\n```bash\nwitness run --step build \\\n  --attestations git,github,commandrun,material \\\n  --outfile build-attestation.json \\\n  --key signing-key.pem \\\n  -- <your-build-command>\n```\n\n**Rego Validation Rules:**\n```rego\npackage git\n\nimport rego.v1\n\n# Enforce builds from specific branch\ndeny contains msg if {\n    input.branch != \"release/v1.0\"\n    msg := sprintf(\"Must build from release/v1.0 branch, got: %s\", [input.branch])\n}\n\n# Validate commit author\napproved_authors := {\n    \"alice.smith@example.com\",\n    \"bob.jones@company.com\",\n    \"ci-bot@company.com\"\n}\n\ndeny contains msg if {\n    not input.authoremail in approved_authors\n    msg := sprintf(\"Unauthorized commit author: %s\", [input.authoremail])\n}\n```\n\n**Verification:**\n```bash\nwitness verify \\\n  --policy policy-signed.json \\\n  --publickey policy-key.pub \\\n  -a build-attestation.json \\\n  --subject <artifact>\n```\n"}]}
{"messages": [{"role": "system", "content": "You are an expert in the Witness supply chain attestation framework. You help users instrument CI/CD pipelines with witness, create policy documents, and write Rego policies to validate attestations. You understand all attestors in go-witness and how to use them effectively."}, {"role": "user", "content": "How do I create a witness policy for a build step that uses these attestors: material, github, product?"}, {"role": "assistant", "content": "Here's a complete witness policy for your build step with material, github, product attestors:\n\n**Policy Document:**\n```json\n{\n  \"expires\": \"2026-11-08T10:52:59Z\",\n  \"publickeys\": {\n    \"build-key\": {\n      \"keyid\": \"sha256:cef813a9b8e7604b892b6c21f59e7188dc2e71638fee1941978e4bd3dc3f17ae\",\n      \"key\": \"-----BEGIN PUBLIC KEY-----\\n...\\n-----END PUBLIC KEY-----\"\n    }\n  },\n  \"steps\": {\n    \"build\": {\n      \"name\": \"build\",\n      \"attestations\": [\n        {\n          \"type\": \"https://witness.dev/attestations/material/v0.1\"\n        },\n        {\n          \"type\": \"https://witness.dev/attestations/github/v0.1\"\n        },\n        {\n          \"type\": \"https://witness.dev/attestations/product/v0.1\"\n        }\n      ],\n      \"functionaries\": [\n        {\n          \"type\": \"publickey\",\n          \"publickeyid\": \"build-key\"\n        }\n      ]\n    }\n  }\n}\n```\n\n**Witness Run Command:**\n```bash\nwitness run --step build \\\n  --attestations material,github,product \\\n  --outfile build-attestation.json \\\n  --key signing-key.pem \\\n  -- <your-build-command>\n```\n\n**Rego Validation Rules:**\n```rego\n\n```\n\n**Verification:**\n```bash\nwitness verify \\\n  --policy policy-signed.json \\\n  --publickey policy-key.pub \\\n  -a build-attestation.json \\\n  --subject <artifact>\n```\n"}]}
{"messages": [{"role": "system", "content": "You are an expert in the Witness supply chain attestation framework. You help users instrument CI/CD pipelines with witness, create policy documents, and write Rego policies to validate attestations. You understand all attestors in go-witness and how to use them effectively."}, {"role": "user", "content": "How do I create a multi-step witness policy for a build \u2192 test \u2192 package pipeline?"}, {"role": "assistant", "content": "Here's a complete multi-step witness policy for your pipeline:\n\n**Policy Document:**\n```json\n{\n  \"expires\": \"2026-11-08T10:52:59Z\",\n  \"publickeys\": {\n    \"ci-key\": {\n      \"keyid\": \"sha256:58f05ab0eeda35a805083f60a784a76be6b4d8665c5ab4719cbd83dbdb0cdcd1\",\n      \"key\": \"-----BEGIN PUBLIC KEY-----\\n...\\n-----END PUBLIC KEY-----\"\n    }\n  },\n  \"steps\": {\n    \"build\": {\n      \"name\": \"build\",\n      \"attestations\": [\n        {\n          \"type\": \"https://witness.dev/attestations/git/v0.1\"\n        },\n        {\n          \"type\": \"https://witness.dev/attestations/command-run/v0.1\"\n        },\n        {\n          \"type\": \"https://witness.dev/attestations/product/v0.1\"\n        }\n      ],\n      \"functionaries\": [\n        {\n          \"type\": \"publickey\",\n          \"publickeyid\": \"ci-key\"\n        }\n      ]\n    },\n    \"test\": {\n      \"name\": \"test\",\n      \"attestations\": [\n        {\n          \"type\": \"https://witness.dev/attestations/material/v0.1\"\n        },\n        {\n          \"type\": \"https://witness.dev/attestations/command-run/v0.1\"\n        }\n      ],\n      \"functionaries\": [\n        {\n          \"type\": \"publickey\",\n          \"publickeyid\": \"ci-key\"\n        }\n      ]\n    },\n    \"package\": {\n      \"name\": \"package\",\n      \"attestations\": [\n        {\n          \"type\": \"https://witness.dev/attestations/material/v0.1\"\n        },\n        {\n          \"type\": \"https://witness.dev/attestations/product/v0.1\"\n        }\n      ],\n      \"functionaries\": [\n        {\n          \"type\": \"publickey\",\n          \"publickeyid\": \"ci-key\"\n        }\n      ]\n    }\n  }\n}\n```\n\n**Pipeline Commands:**\n\n```bash\n# Step 1: Build\nwitness run --step build \\\n  --attestations git,commandrun,product \\\n  -o build.json --key ci-key.pem \\\n  -- go build -o myapp\n\n# Step 2: Test\nwitness run --step test \\\n  --attestations material,commandrun \\\n  -o test.json --key ci-key.pem \\\n  -- go test ./...\n\n# Step 3: Package\nwitness run --step package \\\n  --attestations material,product \\\n  -o package.json --key ci-key.pem \\\n  -- tar czf myapp.tar.gz myapp\n\n# Verify entire pipeline\nwitness verify \\\n  --policy policy-signed.json \\\n  --publickey policy-key.pub \\\n  -a build.json -a test.json -a package.json\n```\n"}]}
{"messages": [{"role": "system", "content": "You are an expert in the Witness supply chain attestation framework. You help users instrument CI/CD pipelines with witness, create policy documents, and write Rego policies to validate attestations. You understand all attestors in go-witness and how to use them effectively."}, {"role": "user", "content": "How do I create a witness policy for a build step that uses these attestors: environment, product, git, github, material?"}, {"role": "assistant", "content": "Here's a complete witness policy for your build step with environment, product, git, github, material attestors:\n\n**Policy Document:**\n```json\n{\n  \"expires\": \"2026-11-08T10:52:59Z\",\n  \"publickeys\": {\n    \"build-key\": {\n      \"keyid\": \"sha256:e77199b41c80610482b39e540dad992dc85653ab34eff95deabb3ce1b02ed253\",\n      \"key\": \"-----BEGIN PUBLIC KEY-----\\n...\\n-----END PUBLIC KEY-----\"\n    }\n  },\n  \"steps\": {\n    \"build\": {\n      \"name\": \"build\",\n      \"attestations\": [\n        {\n          \"type\": \"https://witness.dev/attestations/environment/v0.1\"\n        },\n        {\n          \"type\": \"https://witness.dev/attestations/product/v0.1\"\n        },\n        {\n          \"type\": \"https://witness.dev/attestations/git/v0.1\"\n        },\n        {\n          \"type\": \"https://witness.dev/attestations/github/v0.1\"\n        },\n        {\n          \"type\": \"https://witness.dev/attestations/material/v0.1\"\n        }\n      ],\n      \"functionaries\": [\n        {\n          \"type\": \"publickey\",\n          \"publickeyid\": \"build-key\"\n        }\n      ]\n    }\n  }\n}\n```\n\n**Witness Run Command:**\n```bash\nwitness run --step build \\\n  --attestations environment,product,git,github,material \\\n  --outfile build-attestation.json \\\n  --key signing-key.pem \\\n  -- <your-build-command>\n```\n\n**Rego Validation Rules:**\n```rego\npackage environment\n\nimport rego.v1\n\n# Ensure correct OS\ndeny contains msg if {\n    input.os != \"darwin\"\n    msg := sprintf(\"Must run on darwin, got: %s\", [input.os])\n}\n\n# Require CI environment\ndeny contains msg if {\n    not \"CI\" in input.variables\n    msg := \"Must run in CI environment (CI variable not set)\"\n}\n```\n\n**Verification:**\n```bash\nwitness verify \\\n  --policy policy-signed.json \\\n  --publickey policy-key.pub \\\n  -a build-attestation.json \\\n  --subject <artifact>\n```\n"}]}
{"messages": [{"role": "system", "content": "You are an expert in the Witness supply chain attestation framework. You help users instrument CI/CD pipelines with witness, create policy documents, and write Rego policies to validate attestations. You understand all attestors in go-witness and how to use them effectively."}, {"role": "user", "content": "How do I create a multi-step witness policy for a build \u2192 test \u2192 package pipeline?"}, {"role": "assistant", "content": "Here's a complete multi-step witness policy for your pipeline:\n\n**Policy Document:**\n```json\n{\n  \"expires\": \"2026-11-08T10:52:59Z\",\n  \"publickeys\": {\n    \"ci-key\": {\n      \"keyid\": \"sha256:0be5e3039e1056463938e2c0ee909c424656773fa0c444762e70bdea71bd9e67\",\n      \"key\": \"-----BEGIN PUBLIC KEY-----\\n...\\n-----END PUBLIC KEY-----\"\n    }\n  },\n  \"steps\": {\n    \"build\": {\n      \"name\": \"build\",\n      \"attestations\": [\n        {\n          \"type\": \"https://witness.dev/attestations/git/v0.1\"\n        },\n        {\n          \"type\": \"https://witness.dev/attestations/command-run/v0.1\"\n        },\n        {\n          \"type\": \"https://witness.dev/attestations/product/v0.1\"\n        }\n      ],\n      \"functionaries\": [\n        {\n          \"type\": \"publickey\",\n          \"publickeyid\": \"ci-key\"\n        }\n      ]\n    },\n    \"test\": {\n      \"name\": \"test\",\n      \"attestations\": [\n        {\n          \"type\": \"https://witness.dev/attestations/material/v0.1\"\n        },\n        {\n          \"type\": \"https://witness.dev/attestations/command-run/v0.1\"\n        }\n      ],\n      \"functionaries\": [\n        {\n          \"type\": \"publickey\",\n          \"publickeyid\": \"ci-key\"\n        }\n      ]\n    },\n    \"package\": {\n      \"name\": \"package\",\n      \"attestations\": [\n        {\n          \"type\": \"https://witness.dev/attestations/material/v0.1\"\n        },\n        {\n          \"type\": \"https://witness.dev/attestations/product/v0.1\"\n        }\n      ],\n      \"functionaries\": [\n        {\n          \"type\": \"publickey\",\n          \"publickeyid\": \"ci-key\"\n        }\n      ]\n    }\n  }\n}\n```\n\n**Pipeline Commands:**\n\n```bash\n# Step 1: Build\nwitness run --step build \\\n  --attestations git,commandrun,product \\\n  -o build.json --key ci-key.pem \\\n  -- go build -o myapp\n\n# Step 2: Test\nwitness run --step test \\\n  --attestations material,commandrun \\\n  -o test.json --key ci-key.pem \\\n  -- go test ./...\n\n# Step 3: Package\nwitness run --step package \\\n  --attestations material,product \\\n  -o package.json --key ci-key.pem \\\n  -- tar czf myapp.tar.gz myapp\n\n# Verify entire pipeline\nwitness verify \\\n  --policy policy-signed.json \\\n  --publickey policy-key.pub \\\n  -a build.json -a test.json -a package.json\n```\n"}]}
{"messages": [{"role": "system", "content": "You are an expert in the Witness supply chain attestation framework. You help users instrument CI/CD pipelines with witness, create policy documents, and write Rego policies to validate attestations. You understand all attestors in go-witness and how to use them effectively."}, {"role": "user", "content": "How do I create a witness policy for a build step that uses these attestors: product, github, commandrun, material?"}, {"role": "assistant", "content": "Here's a complete witness policy for your build step with product, github, commandrun, material attestors:\n\n**Policy Document:**\n```json\n{\n  \"expires\": \"2026-11-08T10:52:59Z\",\n  \"publickeys\": {\n    \"build-key\": {\n      \"keyid\": \"sha256:687d4706a7ddfcd8de217ced2ab08d18b65632d73418a2748933d2fa6614e315\",\n      \"key\": \"-----BEGIN PUBLIC KEY-----\\n...\\n-----END PUBLIC KEY-----\"\n    }\n  },\n  \"steps\": {\n    \"build\": {\n      \"name\": \"build\",\n      \"attestations\": [\n        {\n          \"type\": \"https://witness.dev/attestations/product/v0.1\"\n        },\n        {\n          \"type\": \"https://witness.dev/attestations/github/v0.1\"\n        },\n        {\n          \"type\": \"https://witness.dev/attestations/command-run/v0.1\"\n        },\n        {\n          \"type\": \"https://witness.dev/attestations/material/v0.1\"\n        }\n      ],\n      \"functionaries\": [\n        {\n          \"type\": \"publickey\",\n          \"publickeyid\": \"build-key\"\n        }\n      ]\n    }\n  }\n}\n```\n\n**Witness Run Command:**\n```bash\nwitness run --step build \\\n  --attestations product,github,commandrun,material \\\n  --outfile build-attestation.json \\\n  --key signing-key.pem \\\n  -- <your-build-command>\n```\n\n**Rego Validation Rules:**\n```rego\n\n```\n\n**Verification:**\n```bash\nwitness verify \\\n  --policy policy-signed.json \\\n  --publickey policy-key.pub \\\n  -a build-attestation.json \\\n  --subject <artifact>\n```\n"}]}
{"messages": [{"role": "system", "content": "You are an expert in the Witness supply chain attestation framework. You help users instrument CI/CD pipelines with witness, create policy documents, and write Rego policies to validate attestations. You understand all attestors in go-witness and how to use them effectively."}, {"role": "user", "content": "How do I create a witness policy for a build step that uses these attestors: github, product, environment?"}, {"role": "assistant", "content": "Here's a complete witness policy for your build step with github, product, environment attestors:\n\n**Policy Document:**\n```json\n{\n  \"expires\": \"2026-11-08T10:52:59Z\",\n  \"publickeys\": {\n    \"build-key\": {\n      \"keyid\": \"sha256:a537f881834fe4d54764d8c14438adc37f195708b89e951658362910153db446\",\n      \"key\": \"-----BEGIN PUBLIC KEY-----\\n...\\n-----END PUBLIC KEY-----\"\n    }\n  },\n  \"steps\": {\n    \"build\": {\n      \"name\": \"build\",\n      \"attestations\": [\n        {\n          \"type\": \"https://witness.dev/attestations/github/v0.1\"\n        },\n        {\n          \"type\": \"https://witness.dev/attestations/product/v0.1\"\n        },\n        {\n          \"type\": \"https://witness.dev/attestations/environment/v0.1\"\n        }\n      ],\n      \"functionaries\": [\n        {\n          \"type\": \"publickey\",\n          \"publickeyid\": \"build-key\"\n        }\n      ]\n    }\n  }\n}\n```\n\n**Witness Run Command:**\n```bash\nwitness run --step build \\\n  --attestations github,product,environment \\\n  --outfile build-attestation.json \\\n  --key signing-key.pem \\\n  -- <your-build-command>\n```\n\n**Rego Validation Rules:**\n```rego\n\n```\n\n**Verification:**\n```bash\nwitness verify \\\n  --policy policy-signed.json \\\n  --publickey policy-key.pub \\\n  -a build-attestation.json \\\n  --subject <artifact>\n```\n"}]}
{"messages": [{"role": "system", "content": "You are an expert in the Witness supply chain attestation framework. You help users instrument CI/CD pipelines with witness, create policy documents, and write Rego policies to validate attestations. You understand all attestors in go-witness and how to use them effectively."}, {"role": "user", "content": "How do I create a witness policy for a build step that uses these attestors: environment?"}, {"role": "assistant", "content": "Here's a complete witness policy for your build step with environment attestors:\n\n**Policy Document:**\n```json\n{\n  \"expires\": \"2026-11-08T10:52:59Z\",\n  \"publickeys\": {\n    \"build-key\": {\n      \"keyid\": \"sha256:7e2a9e1bc968e5dc68535839402099c85774b89da7ff5db1a452a0c5f746e377\",\n      \"key\": \"-----BEGIN PUBLIC KEY-----\\n...\\n-----END PUBLIC KEY-----\"\n    }\n  },\n  \"steps\": {\n    \"build\": {\n      \"name\": \"build\",\n      \"attestations\": [\n        {\n          \"type\": \"https://witness.dev/attestations/environment/v0.1\"\n        }\n      ],\n      \"functionaries\": [\n        {\n          \"type\": \"publickey\",\n          \"publickeyid\": \"build-key\"\n        }\n      ]\n    }\n  }\n}\n```\n\n**Witness Run Command:**\n```bash\nwitness run --step build \\\n  --attestations environment \\\n  --outfile build-attestation.json \\\n  --key signing-key.pem \\\n  -- <your-build-command>\n```\n\n**Rego Validation Rules:**\n```rego\npackage environment\n\nimport rego.v1\n\n# Ensure correct OS\ndeny contains msg if {\n    input.os != \"linux\"\n    msg := sprintf(\"Must run on linux, got: %s\", [input.os])\n}\n\n# Require CI environment\ndeny contains msg if {\n    not \"CI\" in input.variables\n    msg := \"Must run in CI environment (CI variable not set)\"\n}\n```\n\n**Verification:**\n```bash\nwitness verify \\\n  --policy policy-signed.json \\\n  --publickey policy-key.pub \\\n  -a build-attestation.json \\\n  --subject <artifact>\n```\n"}]}
{"messages": [{"role": "system", "content": "You are an expert in the Witness supply chain attestation framework. You help users instrument CI/CD pipelines with witness, create policy documents, and write Rego policies to validate attestations. You understand all attestors in go-witness and how to use them effectively."}, {"role": "user", "content": "How do I create a witness policy for a build step that uses these attestors: git?"}, {"role": "assistant", "content": "Here's a complete witness policy for your build step with git attestors:\n\n**Policy Document:**\n```json\n{\n  \"expires\": \"2026-11-08T10:52:59Z\",\n  \"publickeys\": {\n    \"build-key\": {\n      \"keyid\": \"sha256:5803631cf77dec356d85958951533d355ccd439d6ce2fbff5eb47f628ac3406b\",\n      \"key\": \"-----BEGIN PUBLIC KEY-----\\n...\\n-----END PUBLIC KEY-----\"\n    }\n  },\n  \"steps\": {\n    \"build\": {\n      \"name\": \"build\",\n      \"attestations\": [\n        {\n          \"type\": \"https://witness.dev/attestations/git/v0.1\"\n        }\n      ],\n      \"functionaries\": [\n        {\n          \"type\": \"publickey\",\n          \"publickeyid\": \"build-key\"\n        }\n      ]\n    }\n  }\n}\n```\n\n**Witness Run Command:**\n```bash\nwitness run --step build \\\n  --attestations git \\\n  --outfile build-attestation.json \\\n  --key signing-key.pem \\\n  -- <your-build-command>\n```\n\n**Rego Validation Rules:**\n```rego\npackage git\n\nimport rego.v1\n\n# Enforce builds from specific branch\ndeny contains msg if {\n    input.branch != \"hotfix/critical\"\n    msg := sprintf(\"Must build from hotfix/critical branch, got: %s\", [input.branch])\n}\n\n# Validate commit author\napproved_authors := {\n    \"alice.smith@example.com\",\n    \"bob.jones@company.com\",\n    \"ci-bot@company.com\"\n}\n\ndeny contains msg if {\n    not input.authoremail in approved_authors\n    msg := sprintf(\"Unauthorized commit author: %s\", [input.authoremail])\n}\n```\n\n**Verification:**\n```bash\nwitness verify \\\n  --policy policy-signed.json \\\n  --publickey policy-key.pub \\\n  -a build-attestation.json \\\n  --subject <artifact>\n```\n"}]}
{"messages": [{"role": "system", "content": "You are an expert in the Witness supply chain attestation framework. You help users instrument CI/CD pipelines with witness, create policy documents, and write Rego policies to validate attestations. You understand all attestors in go-witness and how to use them effectively."}, {"role": "user", "content": "How do I create a multi-step witness policy for a build \u2192 test \u2192 package pipeline?"}, {"role": "assistant", "content": "Here's a complete multi-step witness policy for your pipeline:\n\n**Policy Document:**\n```json\n{\n  \"expires\": \"2026-11-08T10:52:59Z\",\n  \"publickeys\": {\n    \"ci-key\": {\n      \"keyid\": \"sha256:8bdbb1a6619cb6b608027e89d3aff1c3d78fe206a32b2a141180432375b2aaa3\",\n      \"key\": \"-----BEGIN PUBLIC KEY-----\\n...\\n-----END PUBLIC KEY-----\"\n    }\n  },\n  \"steps\": {\n    \"build\": {\n      \"name\": \"build\",\n      \"attestations\": [\n        {\n          \"type\": \"https://witness.dev/attestations/git/v0.1\"\n        },\n        {\n          \"type\": \"https://witness.dev/attestations/command-run/v0.1\"\n        },\n        {\n          \"type\": \"https://witness.dev/attestations/product/v0.1\"\n        }\n      ],\n      \"functionaries\": [\n        {\n          \"type\": \"publickey\",\n          \"publickeyid\": \"ci-key\"\n        }\n      ]\n    },\n    \"test\": {\n      \"name\": \"test\",\n      \"attestations\": [\n        {\n          \"type\": \"https://witness.dev/attestations/material/v0.1\"\n        },\n        {\n          \"type\": \"https://witness.dev/attestations/command-run/v0.1\"\n        }\n      ],\n      \"functionaries\": [\n        {\n          \"type\": \"publickey\",\n          \"publickeyid\": \"ci-key\"\n        }\n      ]\n    },\n    \"package\": {\n      \"name\": \"package\",\n      \"attestations\": [\n        {\n          \"type\": \"https://witness.dev/attestations/material/v0.1\"\n        },\n        {\n          \"type\": \"https://witness.dev/attestations/product/v0.1\"\n        }\n      ],\n      \"functionaries\": [\n        {\n          \"type\": \"publickey\",\n          \"publickeyid\": \"ci-key\"\n        }\n      ]\n    }\n  }\n}\n```\n\n**Pipeline Commands:**\n\n```bash\n# Step 1: Build\nwitness run --step build \\\n  --attestations git,commandrun,product \\\n  -o build.json --key ci-key.pem \\\n  -- go build -o myapp\n\n# Step 2: Test\nwitness run --step test \\\n  --attestations material,commandrun \\\n  -o test.json --key ci-key.pem \\\n  -- go test ./...\n\n# Step 3: Package\nwitness run --step package \\\n  --attestations material,product \\\n  -o package.json --key ci-key.pem \\\n  -- tar czf myapp.tar.gz myapp\n\n# Verify entire pipeline\nwitness verify \\\n  --policy policy-signed.json \\\n  --publickey policy-key.pub \\\n  -a build.json -a test.json -a package.json\n```\n"}]}
{"messages": [{"role": "system", "content": "You are an expert in the Witness supply chain attestation framework. You help users instrument CI/CD pipelines with witness, create policy documents, and write Rego policies to validate attestations. You understand all attestors in go-witness and how to use them effectively."}, {"role": "user", "content": "How do I create a multi-step witness policy for a build \u2192 test \u2192 package pipeline?"}, {"role": "assistant", "content": "Here's a complete multi-step witness policy for your pipeline:\n\n**Policy Document:**\n```json\n{\n  \"expires\": \"2026-11-08T10:52:59Z\",\n  \"publickeys\": {\n    \"ci-key\": {\n      \"keyid\": \"sha256:0f5ff5b6a12bc56f005ce3b943b482133c9df568b166915134624a581d6dd042\",\n      \"key\": \"-----BEGIN PUBLIC KEY-----\\n...\\n-----END PUBLIC KEY-----\"\n    }\n  },\n  \"steps\": {\n    \"build\": {\n      \"name\": \"build\",\n      \"attestations\": [\n        {\n          \"type\": \"https://witness.dev/attestations/git/v0.1\"\n        },\n        {\n          \"type\": \"https://witness.dev/attestations/command-run/v0.1\"\n        },\n        {\n          \"type\": \"https://witness.dev/attestations/product/v0.1\"\n        }\n      ],\n      \"functionaries\": [\n        {\n          \"type\": \"publickey\",\n          \"publickeyid\": \"ci-key\"\n        }\n      ]\n    },\n    \"test\": {\n      \"name\": \"test\",\n      \"attestations\": [\n        {\n          \"type\": \"https://witness.dev/attestations/material/v0.1\"\n        },\n        {\n          \"type\": \"https://witness.dev/attestations/command-run/v0.1\"\n        }\n      ],\n      \"functionaries\": [\n        {\n          \"type\": \"publickey\",\n          \"publickeyid\": \"ci-key\"\n        }\n      ]\n    },\n    \"package\": {\n      \"name\": \"package\",\n      \"attestations\": [\n        {\n          \"type\": \"https://witness.dev/attestations/material/v0.1\"\n        },\n        {\n          \"type\": \"https://witness.dev/attestations/product/v0.1\"\n        }\n      ],\n      \"functionaries\": [\n        {\n          \"type\": \"publickey\",\n          \"publickeyid\": \"ci-key\"\n        }\n      ]\n    }\n  }\n}\n```\n\n**Pipeline Commands:**\n\n```bash\n# Step 1: Build\nwitness run --step build \\\n  --attestations git,commandrun,product \\\n  -o build.json --key ci-key.pem \\\n  -- go build -o myapp\n\n# Step 2: Test\nwitness run --step test \\\n  --attestations material,commandrun \\\n  -o test.json --key ci-key.pem \\\n  -- go test ./...\n\n# Step 3: Package\nwitness run --step package \\\n  --attestations material,product \\\n  -o package.json --key ci-key.pem \\\n  -- tar czf myapp.tar.gz myapp\n\n# Verify entire pipeline\nwitness verify \\\n  --policy policy-signed.json \\\n  --publickey policy-key.pub \\\n  -a build.json -a test.json -a package.json\n```\n"}]}
{"messages": [{"role": "system", "content": "You are an expert in the Witness supply chain attestation framework. You help users instrument CI/CD pipelines with witness, create policy documents, and write Rego policies to validate attestations. You understand all attestors in go-witness and how to use them effectively."}, {"role": "user", "content": "How do I create a multi-step witness policy for a build \u2192 test \u2192 package pipeline?"}, {"role": "assistant", "content": "Here's a complete multi-step witness policy for your pipeline:\n\n**Policy Document:**\n```json\n{\n  \"expires\": \"2026-11-08T10:52:59Z\",\n  \"publickeys\": {\n    \"ci-key\": {\n      \"keyid\": \"sha256:c3341159520173ba475c00995996b2107254050c1f8852f743bfe7fd20401976\",\n      \"key\": \"-----BEGIN PUBLIC KEY-----\\n...\\n-----END PUBLIC KEY-----\"\n    }\n  },\n  \"steps\": {\n    \"build\": {\n      \"name\": \"build\",\n      \"attestations\": [\n        {\n          \"type\": \"https://witness.dev/attestations/git/v0.1\"\n        },\n        {\n          \"type\": \"https://witness.dev/attestations/command-run/v0.1\"\n        },\n        {\n          \"type\": \"https://witness.dev/attestations/product/v0.1\"\n        }\n      ],\n      \"functionaries\": [\n        {\n          \"type\": \"publickey\",\n          \"publickeyid\": \"ci-key\"\n        }\n      ]\n    },\n    \"test\": {\n      \"name\": \"test\",\n      \"attestations\": [\n        {\n          \"type\": \"https://witness.dev/attestations/material/v0.1\"\n        },\n        {\n          \"type\": \"https://witness.dev/attestations/command-run/v0.1\"\n        }\n      ],\n      \"functionaries\": [\n        {\n          \"type\": \"publickey\",\n          \"publickeyid\": \"ci-key\"\n        }\n      ]\n    },\n    \"package\": {\n      \"name\": \"package\",\n      \"attestations\": [\n        {\n          \"type\": \"https://witness.dev/attestations/material/v0.1\"\n        },\n        {\n          \"type\": \"https://witness.dev/attestations/product/v0.1\"\n        }\n      ],\n      \"functionaries\": [\n        {\n          \"type\": \"publickey\",\n          \"publickeyid\": \"ci-key\"\n        }\n      ]\n    }\n  }\n}\n```\n\n**Pipeline Commands:**\n\n```bash\n# Step 1: Build\nwitness run --step build \\\n  --attestations git,commandrun,product \\\n  -o build.json --key ci-key.pem \\\n  -- go build -o myapp\n\n# Step 2: Test\nwitness run --step test \\\n  --attestations material,commandrun \\\n  -o test.json --key ci-key.pem \\\n  -- go test ./...\n\n# Step 3: Package\nwitness run --step package \\\n  --attestations material,product \\\n  -o package.json --key ci-key.pem \\\n  -- tar czf myapp.tar.gz myapp\n\n# Verify entire pipeline\nwitness verify \\\n  --policy policy-signed.json \\\n  --publickey policy-key.pub \\\n  -a build.json -a test.json -a package.json\n```\n"}]}
{"messages": [{"role": "system", "content": "You are an expert in the Witness supply chain attestation framework. You help users instrument CI/CD pipelines with witness, create policy documents, and write Rego policies to validate attestations. You understand all attestors in go-witness and how to use them effectively."}, {"role": "user", "content": "How do I create a multi-step witness policy for a build \u2192 test \u2192 package pipeline?"}, {"role": "assistant", "content": "Here's a complete multi-step witness policy for your pipeline:\n\n**Policy Document:**\n```json\n{\n  \"expires\": \"2026-11-08T10:52:59Z\",\n  \"publickeys\": {\n    \"ci-key\": {\n      \"keyid\": \"sha256:adff82454c4ff6fba580f14496abb4704f39b82a2b7a51f5556678b74d01757d\",\n      \"key\": \"-----BEGIN PUBLIC KEY-----\\n...\\n-----END PUBLIC KEY-----\"\n    }\n  },\n  \"steps\": {\n    \"build\": {\n      \"name\": \"build\",\n      \"attestations\": [\n        {\n          \"type\": \"https://witness.dev/attestations/git/v0.1\"\n        },\n        {\n          \"type\": \"https://witness.dev/attestations/command-run/v0.1\"\n        },\n        {\n          \"type\": \"https://witness.dev/attestations/product/v0.1\"\n        }\n      ],\n      \"functionaries\": [\n        {\n          \"type\": \"publickey\",\n          \"publickeyid\": \"ci-key\"\n        }\n      ]\n    },\n    \"test\": {\n      \"name\": \"test\",\n      \"attestations\": [\n        {\n          \"type\": \"https://witness.dev/attestations/material/v0.1\"\n        },\n        {\n          \"type\": \"https://witness.dev/attestations/command-run/v0.1\"\n        }\n      ],\n      \"functionaries\": [\n        {\n          \"type\": \"publickey\",\n          \"publickeyid\": \"ci-key\"\n        }\n      ]\n    },\n    \"package\": {\n      \"name\": \"package\",\n      \"attestations\": [\n        {\n          \"type\": \"https://witness.dev/attestations/material/v0.1\"\n        },\n        {\n          \"type\": \"https://witness.dev/attestations/product/v0.1\"\n        }\n      ],\n      \"functionaries\": [\n        {\n          \"type\": \"publickey\",\n          \"publickeyid\": \"ci-key\"\n        }\n      ]\n    }\n  }\n}\n```\n\n**Pipeline Commands:**\n\n```bash\n# Step 1: Build\nwitness run --step build \\\n  --attestations git,commandrun,product \\\n  -o build.json --key ci-key.pem \\\n  -- go build -o myapp\n\n# Step 2: Test\nwitness run --step test \\\n  --attestations material,commandrun \\\n  -o test.json --key ci-key.pem \\\n  -- go test ./...\n\n# Step 3: Package\nwitness run --step package \\\n  --attestations material,product \\\n  -o package.json --key ci-key.pem \\\n  -- tar czf myapp.tar.gz myapp\n\n# Verify entire pipeline\nwitness verify \\\n  --policy policy-signed.json \\\n  --publickey policy-key.pub \\\n  -a build.json -a test.json -a package.json\n```\n"}]}
{"messages": [{"role": "system", "content": "You are an expert in the Witness supply chain attestation framework. You help users instrument CI/CD pipelines with witness, create policy documents, and write Rego policies to validate attestations. You understand all attestors in go-witness and how to use them effectively."}, {"role": "user", "content": "How do I create a witness policy for a build step that uses these attestors: material, environment, product, git?"}, {"role": "assistant", "content": "Here's a complete witness policy for your build step with material, environment, product, git attestors:\n\n**Policy Document:**\n```json\n{\n  \"expires\": \"2026-11-08T10:52:59Z\",\n  \"publickeys\": {\n    \"build-key\": {\n      \"keyid\": \"sha256:1149ea9b60f4ea0e711e57dd36f8e8a9da6c2732643e6abe6b8fb9c4827d7914\",\n      \"key\": \"-----BEGIN PUBLIC KEY-----\\n...\\n-----END PUBLIC KEY-----\"\n    }\n  },\n  \"steps\": {\n    \"build\": {\n      \"name\": \"build\",\n      \"attestations\": [\n        {\n          \"type\": \"https://witness.dev/attestations/material/v0.1\"\n        },\n        {\n          \"type\": \"https://witness.dev/attestations/environment/v0.1\"\n        },\n        {\n          \"type\": \"https://witness.dev/attestations/product/v0.1\"\n        },\n        {\n          \"type\": \"https://witness.dev/attestations/git/v0.1\"\n        }\n      ],\n      \"functionaries\": [\n        {\n          \"type\": \"publickey\",\n          \"publickeyid\": \"build-key\"\n        }\n      ]\n    }\n  }\n}\n```\n\n**Witness Run Command:**\n```bash\nwitness run --step build \\\n  --attestations material,environment,product,git \\\n  --outfile build-attestation.json \\\n  --key signing-key.pem \\\n  -- <your-build-command>\n```\n\n**Rego Validation Rules:**\n```rego\n\n```\n\n**Verification:**\n```bash\nwitness verify \\\n  --policy policy-signed.json \\\n  --publickey policy-key.pub \\\n  -a build-attestation.json \\\n  --subject <artifact>\n```\n"}]}
{"messages": [{"role": "system", "content": "You are an expert in the Witness supply chain attestation framework. You help users instrument CI/CD pipelines with witness, create policy documents, and write Rego policies to validate attestations. You understand all attestors in go-witness and how to use them effectively."}, {"role": "user", "content": "How do I create a witness policy for a build step that uses these attestors: github, environment, product, material?"}, {"role": "assistant", "content": "Here's a complete witness policy for your build step with github, environment, product, material attestors:\n\n**Policy Document:**\n```json\n{\n  \"expires\": \"2026-11-08T10:52:59Z\",\n  \"publickeys\": {\n    \"build-key\": {\n      \"keyid\": \"sha256:9e5f649b851568dda7dde9b867cb52f7797f0f67a0b648291b382c5be9e8d64a\",\n      \"key\": \"-----BEGIN PUBLIC KEY-----\\n...\\n-----END PUBLIC KEY-----\"\n    }\n  },\n  \"steps\": {\n    \"build\": {\n      \"name\": \"build\",\n      \"attestations\": [\n        {\n          \"type\": \"https://witness.dev/attestations/github/v0.1\"\n        },\n        {\n          \"type\": \"https://witness.dev/attestations/environment/v0.1\"\n        },\n        {\n          \"type\": \"https://witness.dev/attestations/product/v0.1\"\n        },\n        {\n          \"type\": \"https://witness.dev/attestations/material/v0.1\"\n        }\n      ],\n      \"functionaries\": [\n        {\n          \"type\": \"publickey\",\n          \"publickeyid\": \"build-key\"\n        }\n      ]\n    }\n  }\n}\n```\n\n**Witness Run Command:**\n```bash\nwitness run --step build \\\n  --attestations github,environment,product,material \\\n  --outfile build-attestation.json \\\n  --key signing-key.pem \\\n  -- <your-build-command>\n```\n\n**Rego Validation Rules:**\n```rego\n\n```\n\n**Verification:**\n```bash\nwitness verify \\\n  --policy policy-signed.json \\\n  --publickey policy-key.pub \\\n  -a build-attestation.json \\\n  --subject <artifact>\n```\n"}]}
{"messages": [{"role": "system", "content": "You are an expert in the Witness supply chain attestation framework. You help users instrument CI/CD pipelines with witness, create policy documents, and write Rego policies to validate attestations. You understand all attestors in go-witness and how to use them effectively."}, {"role": "user", "content": "How do I create a witness policy for a build step that uses these attestors: environment, github, material?"}, {"role": "assistant", "content": "Here's a complete witness policy for your build step with environment, github, material attestors:\n\n**Policy Document:**\n```json\n{\n  \"expires\": \"2026-11-08T10:52:59Z\",\n  \"publickeys\": {\n    \"build-key\": {\n      \"keyid\": \"sha256:763a7b746f6a99a8814fbeeee6821067b953ff3b4789e1dc771d86beeb71f913\",\n      \"key\": \"-----BEGIN PUBLIC KEY-----\\n...\\n-----END PUBLIC KEY-----\"\n    }\n  },\n  \"steps\": {\n    \"build\": {\n      \"name\": \"build\",\n      \"attestations\": [\n        {\n          \"type\": \"https://witness.dev/attestations/environment/v0.1\"\n        },\n        {\n          \"type\": \"https://witness.dev/attestations/github/v0.1\"\n        },\n        {\n          \"type\": \"https://witness.dev/attestations/material/v0.1\"\n        }\n      ],\n      \"functionaries\": [\n        {\n          \"type\": \"publickey\",\n          \"publickeyid\": \"build-key\"\n        }\n      ]\n    }\n  }\n}\n```\n\n**Witness Run Command:**\n```bash\nwitness run --step build \\\n  --attestations environment,github,material \\\n  --outfile build-attestation.json \\\n  --key signing-key.pem \\\n  -- <your-build-command>\n```\n\n**Rego Validation Rules:**\n```rego\npackage environment\n\nimport rego.v1\n\n# Ensure correct OS\ndeny contains msg if {\n    input.os != \"linux\"\n    msg := sprintf(\"Must run on linux, got: %s\", [input.os])\n}\n\n# Require CI environment\ndeny contains msg if {\n    not \"CI\" in input.variables\n    msg := \"Must run in CI environment (CI variable not set)\"\n}\n```\n\n**Verification:**\n```bash\nwitness verify \\\n  --policy policy-signed.json \\\n  --publickey policy-key.pub \\\n  -a build-attestation.json \\\n  --subject <artifact>\n```\n"}]}
{"messages": [{"role": "system", "content": "You are an expert in the Witness supply chain attestation framework. You help users instrument CI/CD pipelines with witness, create policy documents, and write Rego policies to validate attestations. You understand all attestors in go-witness and how to use them effectively."}, {"role": "user", "content": "How do I create a witness policy for a build step that uses these attestors: commandrun, product, material?"}, {"role": "assistant", "content": "Here's a complete witness policy for your build step with commandrun, product, material attestors:\n\n**Policy Document:**\n```json\n{\n  \"expires\": \"2026-11-08T10:52:59Z\",\n  \"publickeys\": {\n    \"build-key\": {\n      \"keyid\": \"sha256:f7a43b0d3965b9ad89b076ea20f10fa0e790e7101529e0c9a0c9d9a16948f246\",\n      \"key\": \"-----BEGIN PUBLIC KEY-----\\n...\\n-----END PUBLIC KEY-----\"\n    }\n  },\n  \"steps\": {\n    \"build\": {\n      \"name\": \"build\",\n      \"attestations\": [\n        {\n          \"type\": \"https://witness.dev/attestations/command-run/v0.1\"\n        },\n        {\n          \"type\": \"https://witness.dev/attestations/product/v0.1\"\n        },\n        {\n          \"type\": \"https://witness.dev/attestations/material/v0.1\"\n        }\n      ],\n      \"functionaries\": [\n        {\n          \"type\": \"publickey\",\n          \"publickeyid\": \"build-key\"\n        }\n      ]\n    }\n  }\n}\n```\n\n**Witness Run Command:**\n```bash\nwitness run --step build \\\n  --attestations commandrun,product,material \\\n  --outfile build-attestation.json \\\n  --key signing-key.pem \\\n  -- <your-build-command>\n```\n\n**Rego Validation Rules:**\n```rego\n\n```\n\n**Verification:**\n```bash\nwitness verify \\\n  --policy policy-signed.json \\\n  --publickey policy-key.pub \\\n  -a build-attestation.json \\\n  --subject <artifact>\n```\n"}]}
{"messages": [{"role": "system", "content": "You are an expert in the Witness supply chain attestation framework. You help users instrument CI/CD pipelines with witness, create policy documents, and write Rego policies to validate attestations. You understand all attestors in go-witness and how to use them effectively."}, {"role": "user", "content": "How do I create a witness policy for a build step that uses these attestors: commandrun, product, material?"}, {"role": "assistant", "content": "Here's a complete witness policy for your build step with commandrun, product, material attestors:\n\n**Policy Document:**\n```json\n{\n  \"expires\": \"2026-11-08T10:52:59Z\",\n  \"publickeys\": {\n    \"build-key\": {\n      \"keyid\": \"sha256:d1c84ea2d3a77cb43095dd8dce3e4db1efaab7dbc3af6d1e348d4ffad4838c4f\",\n      \"key\": \"-----BEGIN PUBLIC KEY-----\\n...\\n-----END PUBLIC KEY-----\"\n    }\n  },\n  \"steps\": {\n    \"build\": {\n      \"name\": \"build\",\n      \"attestations\": [\n        {\n          \"type\": \"https://witness.dev/attestations/command-run/v0.1\"\n        },\n        {\n          \"type\": \"https://witness.dev/attestations/product/v0.1\"\n        },\n        {\n          \"type\": \"https://witness.dev/attestations/material/v0.1\"\n        }\n      ],\n      \"functionaries\": [\n        {\n          \"type\": \"publickey\",\n          \"publickeyid\": \"build-key\"\n        }\n      ]\n    }\n  }\n}\n```\n\n**Witness Run Command:**\n```bash\nwitness run --step build \\\n  --attestations commandrun,product,material \\\n  --outfile build-attestation.json \\\n  --key signing-key.pem \\\n  -- <your-build-command>\n```\n\n**Rego Validation Rules:**\n```rego\n\n```\n\n**Verification:**\n```bash\nwitness verify \\\n  --policy policy-signed.json \\\n  --publickey policy-key.pub \\\n  -a build-attestation.json \\\n  --subject <artifact>\n```\n"}]}
{"messages": [{"role": "system", "content": "You are an expert in the Witness supply chain attestation framework. You help users instrument CI/CD pipelines with witness, create policy documents, and write Rego policies to validate attestations. You understand all attestors in go-witness and how to use them effectively."}, {"role": "user", "content": "How do I create a witness policy for a build step that uses these attestors: git, material?"}, {"role": "assistant", "content": "Here's a complete witness policy for your build step with git, material attestors:\n\n**Policy Document:**\n```json\n{\n  \"expires\": \"2026-11-08T10:52:59Z\",\n  \"publickeys\": {\n    \"build-key\": {\n      \"keyid\": \"sha256:32f1b1a1aa84a005de5cb855e5acf842040c36f6c0dd8d91a9cdddcdc0b6852b\",\n      \"key\": \"-----BEGIN PUBLIC KEY-----\\n...\\n-----END PUBLIC KEY-----\"\n    }\n  },\n  \"steps\": {\n    \"build\": {\n      \"name\": \"build\",\n      \"attestations\": [\n        {\n          \"type\": \"https://witness.dev/attestations/git/v0.1\"\n        },\n        {\n          \"type\": \"https://witness.dev/attestations/material/v0.1\"\n        }\n      ],\n      \"functionaries\": [\n        {\n          \"type\": \"publickey\",\n          \"publickeyid\": \"build-key\"\n        }\n      ]\n    }\n  }\n}\n```\n\n**Witness Run Command:**\n```bash\nwitness run --step build \\\n  --attestations git,material \\\n  --outfile build-attestation.json \\\n  --key signing-key.pem \\\n  -- <your-build-command>\n```\n\n**Rego Validation Rules:**\n```rego\npackage git\n\nimport rego.v1\n\n# Enforce builds from specific branch\ndeny contains msg if {\n    input.branch != \"feature/api\"\n    msg := sprintf(\"Must build from feature/api branch, got: %s\", [input.branch])\n}\n\n# Require clean working directory\ndeny contains msg if {\n    count(input.status) > 0\n    msg := \"Working directory must be clean (no uncommitted changes)\"\n}\n\n# Validate commit author\napproved_authors := {\n    \"alice.smith@example.com\",\n    \"bob.jones@company.com\",\n    \"ci-bot@company.com\"\n}\n\ndeny contains msg if {\n    not input.authoremail in approved_authors\n    msg := sprintf(\"Unauthorized commit author: %s\", [input.authoremail])\n}\n```\n\n**Verification:**\n```bash\nwitness verify \\\n  --policy policy-signed.json \\\n  --publickey policy-key.pub \\\n  -a build-attestation.json \\\n  --subject <artifact>\n```\n"}]}
{"messages": [{"role": "system", "content": "You are an expert in the Witness supply chain attestation framework. You help users instrument CI/CD pipelines with witness, create policy documents, and write Rego policies to validate attestations. You understand all attestors in go-witness and how to use them effectively."}, {"role": "user", "content": "How do I create a multi-step witness policy for a build \u2192 test \u2192 package pipeline?"}, {"role": "assistant", "content": "Here's a complete multi-step witness policy for your pipeline:\n\n**Policy Document:**\n```json\n{\n  \"expires\": \"2026-11-08T10:52:59Z\",\n  \"publickeys\": {\n    \"ci-key\": {\n      \"keyid\": \"sha256:b55c6b3085f7f87b74c67f1e276f935fcbeaca1f42b5f3a74be8645992fb4977\",\n      \"key\": \"-----BEGIN PUBLIC KEY-----\\n...\\n-----END PUBLIC KEY-----\"\n    }\n  },\n  \"steps\": {\n    \"build\": {\n      \"name\": \"build\",\n      \"attestations\": [\n        {\n          \"type\": \"https://witness.dev/attestations/git/v0.1\"\n        },\n        {\n          \"type\": \"https://witness.dev/attestations/command-run/v0.1\"\n        },\n        {\n          \"type\": \"https://witness.dev/attestations/product/v0.1\"\n        }\n      ],\n      \"functionaries\": [\n        {\n          \"type\": \"publickey\",\n          \"publickeyid\": \"ci-key\"\n        }\n      ]\n    },\n    \"test\": {\n      \"name\": \"test\",\n      \"attestations\": [\n        {\n          \"type\": \"https://witness.dev/attestations/material/v0.1\"\n        },\n        {\n          \"type\": \"https://witness.dev/attestations/command-run/v0.1\"\n        }\n      ],\n      \"functionaries\": [\n        {\n          \"type\": \"publickey\",\n          \"publickeyid\": \"ci-key\"\n        }\n      ]\n    },\n    \"package\": {\n      \"name\": \"package\",\n      \"attestations\": [\n        {\n          \"type\": \"https://witness.dev/attestations/material/v0.1\"\n        },\n        {\n          \"type\": \"https://witness.dev/attestations/product/v0.1\"\n        }\n      ],\n      \"functionaries\": [\n        {\n          \"type\": \"publickey\",\n          \"publickeyid\": \"ci-key\"\n        }\n      ]\n    }\n  }\n}\n```\n\n**Pipeline Commands:**\n\n```bash\n# Step 1: Build\nwitness run --step build \\\n  --attestations git,commandrun,product \\\n  -o build.json --key ci-key.pem \\\n  -- go build -o myapp\n\n# Step 2: Test\nwitness run --step test \\\n  --attestations material,commandrun \\\n  -o test.json --key ci-key.pem \\\n  -- go test ./...\n\n# Step 3: Package\nwitness run --step package \\\n  --attestations material,product \\\n  -o package.json --key ci-key.pem \\\n  -- tar czf myapp.tar.gz myapp\n\n# Verify entire pipeline\nwitness verify \\\n  --policy policy-signed.json \\\n  --publickey policy-key.pub \\\n  -a build.json -a test.json -a package.json\n```\n"}]}
{"messages": [{"role": "system", "content": "You are an expert in the Witness supply chain attestation framework. You help users instrument CI/CD pipelines with witness, create policy documents, and write Rego policies to validate attestations. You understand all attestors in go-witness and how to use them effectively."}, {"role": "user", "content": "How do I create a multi-step witness policy for a build \u2192 test \u2192 package pipeline?"}, {"role": "assistant", "content": "Here's a complete multi-step witness policy for your pipeline:\n\n**Policy Document:**\n```json\n{\n  \"expires\": \"2026-11-08T10:52:59Z\",\n  \"publickeys\": {\n    \"ci-key\": {\n      \"keyid\": \"sha256:0fcdbbfb2fc629079d0163f178c6820fc2a4b2a3ec387047203f4f9fedc0f901\",\n      \"key\": \"-----BEGIN PUBLIC KEY-----\\n...\\n-----END PUBLIC KEY-----\"\n    }\n  },\n  \"steps\": {\n    \"build\": {\n      \"name\": \"build\",\n      \"attestations\": [\n        {\n          \"type\": \"https://witness.dev/attestations/git/v0.1\"\n        },\n        {\n          \"type\": \"https://witness.dev/attestations/command-run/v0.1\"\n        },\n        {\n          \"type\": \"https://witness.dev/attestations/product/v0.1\"\n        }\n      ],\n      \"functionaries\": [\n        {\n          \"type\": \"publickey\",\n          \"publickeyid\": \"ci-key\"\n        }\n      ]\n    },\n    \"test\": {\n      \"name\": \"test\",\n      \"attestations\": [\n        {\n          \"type\": \"https://witness.dev/attestations/material/v0.1\"\n        },\n        {\n          \"type\": \"https://witness.dev/attestations/command-run/v0.1\"\n        }\n      ],\n      \"functionaries\": [\n        {\n          \"type\": \"publickey\",\n          \"publickeyid\": \"ci-key\"\n        }\n      ]\n    },\n    \"package\": {\n      \"name\": \"package\",\n      \"attestations\": [\n        {\n          \"type\": \"https://witness.dev/attestations/material/v0.1\"\n        },\n        {\n          \"type\": \"https://witness.dev/attestations/product/v0.1\"\n        }\n      ],\n      \"functionaries\": [\n        {\n          \"type\": \"publickey\",\n          \"publickeyid\": \"ci-key\"\n        }\n      ]\n    }\n  }\n}\n```\n\n**Pipeline Commands:**\n\n```bash\n# Step 1: Build\nwitness run --step build \\\n  --attestations git,commandrun,product \\\n  -o build.json --key ci-key.pem \\\n  -- go build -o myapp\n\n# Step 2: Test\nwitness run --step test \\\n  --attestations material,commandrun \\\n  -o test.json --key ci-key.pem \\\n  -- go test ./...\n\n# Step 3: Package\nwitness run --step package \\\n  --attestations material,product \\\n  -o package.json --key ci-key.pem \\\n  -- tar czf myapp.tar.gz myapp\n\n# Verify entire pipeline\nwitness verify \\\n  --policy policy-signed.json \\\n  --publickey policy-key.pub \\\n  -a build.json -a test.json -a package.json\n```\n"}]}
{"messages": [{"role": "system", "content": "You are an expert in the Witness supply chain attestation framework. You help users instrument CI/CD pipelines with witness, create policy documents, and write Rego policies to validate attestations. You understand all attestors in go-witness and how to use them effectively."}, {"role": "user", "content": "How do I create a witness policy for a build step that uses these attestors: material, github, product, git, commandrun?"}, {"role": "assistant", "content": "Here's a complete witness policy for your build step with material, github, product, git, commandrun attestors:\n\n**Policy Document:**\n```json\n{\n  \"expires\": \"2026-11-08T10:52:59Z\",\n  \"publickeys\": {\n    \"build-key\": {\n      \"keyid\": \"sha256:232e30ad9b916f28e6ff8aec8fd137cf65585abd7836eb3fe4b41fd69283402a\",\n      \"key\": \"-----BEGIN PUBLIC KEY-----\\n...\\n-----END PUBLIC KEY-----\"\n    }\n  },\n  \"steps\": {\n    \"build\": {\n      \"name\": \"build\",\n      \"attestations\": [\n        {\n          \"type\": \"https://witness.dev/attestations/material/v0.1\"\n        },\n        {\n          \"type\": \"https://witness.dev/attestations/github/v0.1\"\n        },\n        {\n          \"type\": \"https://witness.dev/attestations/product/v0.1\"\n        },\n        {\n          \"type\": \"https://witness.dev/attestations/git/v0.1\"\n        },\n        {\n          \"type\": \"https://witness.dev/attestations/command-run/v0.1\"\n        }\n      ],\n      \"functionaries\": [\n        {\n          \"type\": \"publickey\",\n          \"publickeyid\": \"build-key\"\n        }\n      ]\n    }\n  }\n}\n```\n\n**Witness Run Command:**\n```bash\nwitness run --step build \\\n  --attestations material,github,product,git,commandrun \\\n  --outfile build-attestation.json \\\n  --key signing-key.pem \\\n  -- <your-build-command>\n```\n\n**Rego Validation Rules:**\n```rego\n\n```\n\n**Verification:**\n```bash\nwitness verify \\\n  --policy policy-signed.json \\\n  --publickey policy-key.pub \\\n  -a build-attestation.json \\\n  --subject <artifact>\n```\n"}]}
{"messages": [{"role": "system", "content": "You are an expert in the Witness supply chain attestation framework. You help users instrument CI/CD pipelines with witness, create policy documents, and write Rego policies to validate attestations. You understand all attestors in go-witness and how to use them effectively."}, {"role": "user", "content": "How do I create a multi-step witness policy for a build \u2192 test \u2192 package pipeline?"}, {"role": "assistant", "content": "Here's a complete multi-step witness policy for your pipeline:\n\n**Policy Document:**\n```json\n{\n  \"expires\": \"2026-11-08T10:52:59Z\",\n  \"publickeys\": {\n    \"ci-key\": {\n      \"keyid\": \"sha256:97af0f8f74a2dbe8ac2b903fcc5c8456a0fbd63c283e69c491cee1fe931b22a9\",\n      \"key\": \"-----BEGIN PUBLIC KEY-----\\n...\\n-----END PUBLIC KEY-----\"\n    }\n  },\n  \"steps\": {\n    \"build\": {\n      \"name\": \"build\",\n      \"attestations\": [\n        {\n          \"type\": \"https://witness.dev/attestations/git/v0.1\"\n        },\n        {\n          \"type\": \"https://witness.dev/attestations/command-run/v0.1\"\n        },\n        {\n          \"type\": \"https://witness.dev/attestations/product/v0.1\"\n        }\n      ],\n      \"functionaries\": [\n        {\n          \"type\": \"publickey\",\n          \"publickeyid\": \"ci-key\"\n        }\n      ]\n    },\n    \"test\": {\n      \"name\": \"test\",\n      \"attestations\": [\n        {\n          \"type\": \"https://witness.dev/attestations/material/v0.1\"\n        },\n        {\n          \"type\": \"https://witness.dev/attestations/command-run/v0.1\"\n        }\n      ],\n      \"functionaries\": [\n        {\n          \"type\": \"publickey\",\n          \"publickeyid\": \"ci-key\"\n        }\n      ]\n    },\n    \"package\": {\n      \"name\": \"package\",\n      \"attestations\": [\n        {\n          \"type\": \"https://witness.dev/attestations/material/v0.1\"\n        },\n        {\n          \"type\": \"https://witness.dev/attestations/product/v0.1\"\n        }\n      ],\n      \"functionaries\": [\n        {\n          \"type\": \"publickey\",\n          \"publickeyid\": \"ci-key\"\n        }\n      ]\n    }\n  }\n}\n```\n\n**Pipeline Commands:**\n\n```bash\n# Step 1: Build\nwitness run --step build \\\n  --attestations git,commandrun,product \\\n  -o build.json --key ci-key.pem \\\n  -- go build -o myapp\n\n# Step 2: Test\nwitness run --step test \\\n  --attestations material,commandrun \\\n  -o test.json --key ci-key.pem \\\n  -- go test ./...\n\n# Step 3: Package\nwitness run --step package \\\n  --attestations material,product \\\n  -o package.json --key ci-key.pem \\\n  -- tar czf myapp.tar.gz myapp\n\n# Verify entire pipeline\nwitness verify \\\n  --policy policy-signed.json \\\n  --publickey policy-key.pub \\\n  -a build.json -a test.json -a package.json\n```\n"}]}
{"messages": [{"role": "system", "content": "You are an expert in the Witness supply chain attestation framework. You help users instrument CI/CD pipelines with witness, create policy documents, and write Rego policies to validate attestations. You understand all attestors in go-witness and how to use them effectively."}, {"role": "user", "content": "How do I create a witness policy for a build step that uses these attestors: environment, material?"}, {"role": "assistant", "content": "Here's a complete witness policy for your build step with environment, material attestors:\n\n**Policy Document:**\n```json\n{\n  \"expires\": \"2026-11-08T10:52:59Z\",\n  \"publickeys\": {\n    \"build-key\": {\n      \"keyid\": \"sha256:daeed2f0b9aa55dc19c173fd737ec0a32ad92c3370959f1ef6f55e08e1f15f58\",\n      \"key\": \"-----BEGIN PUBLIC KEY-----\\n...\\n-----END PUBLIC KEY-----\"\n    }\n  },\n  \"steps\": {\n    \"build\": {\n      \"name\": \"build\",\n      \"attestations\": [\n        {\n          \"type\": \"https://witness.dev/attestations/environment/v0.1\"\n        },\n        {\n          \"type\": \"https://witness.dev/attestations/material/v0.1\"\n        }\n      ],\n      \"functionaries\": [\n        {\n          \"type\": \"publickey\",\n          \"publickeyid\": \"build-key\"\n        }\n      ]\n    }\n  }\n}\n```\n\n**Witness Run Command:**\n```bash\nwitness run --step build \\\n  --attestations environment,material \\\n  --outfile build-attestation.json \\\n  --key signing-key.pem \\\n  -- <your-build-command>\n```\n\n**Rego Validation Rules:**\n```rego\npackage environment\n\nimport rego.v1\n\n# Ensure correct OS\ndeny contains msg if {\n    input.os != \"windows\"\n    msg := sprintf(\"Must run on windows, got: %s\", [input.os])\n}\n\n# Require CI environment\ndeny contains msg if {\n    not \"CI\" in input.variables\n    msg := \"Must run in CI environment (CI variable not set)\"\n}\n```\n\n**Verification:**\n```bash\nwitness verify \\\n  --policy policy-signed.json \\\n  --publickey policy-key.pub \\\n  -a build-attestation.json \\\n  --subject <artifact>\n```\n"}]}
{"messages": [{"role": "system", "content": "You are an expert in the Witness supply chain attestation framework. You help users instrument CI/CD pipelines with witness, create policy documents, and write Rego policies to validate attestations. You understand all attestors in go-witness and how to use them effectively."}, {"role": "user", "content": "How do I create a witness policy for a build step that uses these attestors: github, commandrun?"}, {"role": "assistant", "content": "Here's a complete witness policy for your build step with github, commandrun attestors:\n\n**Policy Document:**\n```json\n{\n  \"expires\": \"2026-11-08T10:52:59Z\",\n  \"publickeys\": {\n    \"build-key\": {\n      \"keyid\": \"sha256:4746feeae6edb20b0d176a617038491365bb589d48457df72b2f4fb750c30b1b\",\n      \"key\": \"-----BEGIN PUBLIC KEY-----\\n...\\n-----END PUBLIC KEY-----\"\n    }\n  },\n  \"steps\": {\n    \"build\": {\n      \"name\": \"build\",\n      \"attestations\": [\n        {\n          \"type\": \"https://witness.dev/attestations/github/v0.1\"\n        },\n        {\n          \"type\": \"https://witness.dev/attestations/command-run/v0.1\"\n        }\n      ],\n      \"functionaries\": [\n        {\n          \"type\": \"publickey\",\n          \"publickeyid\": \"build-key\"\n        }\n      ]\n    }\n  }\n}\n```\n\n**Witness Run Command:**\n```bash\nwitness run --step build \\\n  --attestations github,commandrun \\\n  --outfile build-attestation.json \\\n  --key signing-key.pem \\\n  -- <your-build-command>\n```\n\n**Rego Validation Rules:**\n```rego\n\n```\n\n**Verification:**\n```bash\nwitness verify \\\n  --policy policy-signed.json \\\n  --publickey policy-key.pub \\\n  -a build-attestation.json \\\n  --subject <artifact>\n```\n"}]}
{"messages": [{"role": "system", "content": "You are an expert in the Witness supply chain attestation framework. You help users instrument CI/CD pipelines with witness, create policy documents, and write Rego policies to validate attestations. You understand all attestors in go-witness and how to use them effectively."}, {"role": "user", "content": "How do I create a witness policy for a build step that uses these attestors: commandrun, github, git, material, environment?"}, {"role": "assistant", "content": "Here's a complete witness policy for your build step with commandrun, github, git, material, environment attestors:\n\n**Policy Document:**\n```json\n{\n  \"expires\": \"2026-11-08T10:52:59Z\",\n  \"publickeys\": {\n    \"build-key\": {\n      \"keyid\": \"sha256:0449990f8f8616e37862345d5108d7cbf644f88b4fd663b17f2851e5d9ffe9e1\",\n      \"key\": \"-----BEGIN PUBLIC KEY-----\\n...\\n-----END PUBLIC KEY-----\"\n    }\n  },\n  \"steps\": {\n    \"build\": {\n      \"name\": \"build\",\n      \"attestations\": [\n        {\n          \"type\": \"https://witness.dev/attestations/command-run/v0.1\"\n        },\n        {\n          \"type\": \"https://witness.dev/attestations/github/v0.1\"\n        },\n        {\n          \"type\": \"https://witness.dev/attestations/git/v0.1\"\n        },\n        {\n          \"type\": \"https://witness.dev/attestations/material/v0.1\"\n        },\n        {\n          \"type\": \"https://witness.dev/attestations/environment/v0.1\"\n        }\n      ],\n      \"functionaries\": [\n        {\n          \"type\": \"publickey\",\n          \"publickeyid\": \"build-key\"\n        }\n      ]\n    }\n  }\n}\n```\n\n**Witness Run Command:**\n```bash\nwitness run --step build \\\n  --attestations commandrun,github,git,material,environment \\\n  --outfile build-attestation.json \\\n  --key signing-key.pem \\\n  -- <your-build-command>\n```\n\n**Rego Validation Rules:**\n```rego\n\n```\n\n**Verification:**\n```bash\nwitness verify \\\n  --policy policy-signed.json \\\n  --publickey policy-key.pub \\\n  -a build-attestation.json \\\n  --subject <artifact>\n```\n"}]}
{"messages": [{"role": "system", "content": "You are an expert in the Witness supply chain attestation framework. You help users instrument CI/CD pipelines with witness, create policy documents, and write Rego policies to validate attestations. You understand all attestors in go-witness and how to use them effectively."}, {"role": "user", "content": "How do I create a multi-step witness policy for a build \u2192 test \u2192 package pipeline?"}, {"role": "assistant", "content": "Here's a complete multi-step witness policy for your pipeline:\n\n**Policy Document:**\n```json\n{\n  \"expires\": \"2026-11-08T10:52:59Z\",\n  \"publickeys\": {\n    \"ci-key\": {\n      \"keyid\": \"sha256:3880024adda82864e43762e66bfdfb759e1a614c3f98de5e202f3fe732a33741\",\n      \"key\": \"-----BEGIN PUBLIC KEY-----\\n...\\n-----END PUBLIC KEY-----\"\n    }\n  },\n  \"steps\": {\n    \"build\": {\n      \"name\": \"build\",\n      \"attestations\": [\n        {\n          \"type\": \"https://witness.dev/attestations/git/v0.1\"\n        },\n        {\n          \"type\": \"https://witness.dev/attestations/command-run/v0.1\"\n        },\n        {\n          \"type\": \"https://witness.dev/attestations/product/v0.1\"\n        }\n      ],\n      \"functionaries\": [\n        {\n          \"type\": \"publickey\",\n          \"publickeyid\": \"ci-key\"\n        }\n      ]\n    },\n    \"test\": {\n      \"name\": \"test\",\n      \"attestations\": [\n        {\n          \"type\": \"https://witness.dev/attestations/material/v0.1\"\n        },\n        {\n          \"type\": \"https://witness.dev/attestations/command-run/v0.1\"\n        }\n      ],\n      \"functionaries\": [\n        {\n          \"type\": \"publickey\",\n          \"publickeyid\": \"ci-key\"\n        }\n      ]\n    },\n    \"package\": {\n      \"name\": \"package\",\n      \"attestations\": [\n        {\n          \"type\": \"https://witness.dev/attestations/material/v0.1\"\n        },\n        {\n          \"type\": \"https://witness.dev/attestations/product/v0.1\"\n        }\n      ],\n      \"functionaries\": [\n        {\n          \"type\": \"publickey\",\n          \"publickeyid\": \"ci-key\"\n        }\n      ]\n    }\n  }\n}\n```\n\n**Pipeline Commands:**\n\n```bash\n# Step 1: Build\nwitness run --step build \\\n  --attestations git,commandrun,product \\\n  -o build.json --key ci-key.pem \\\n  -- go build -o myapp\n\n# Step 2: Test\nwitness run --step test \\\n  --attestations material,commandrun \\\n  -o test.json --key ci-key.pem \\\n  -- go test ./...\n\n# Step 3: Package\nwitness run --step package \\\n  --attestations material,product \\\n  -o package.json --key ci-key.pem \\\n  -- tar czf myapp.tar.gz myapp\n\n# Verify entire pipeline\nwitness verify \\\n  --policy policy-signed.json \\\n  --publickey policy-key.pub \\\n  -a build.json -a test.json -a package.json\n```\n"}]}
{"messages": [{"role": "system", "content": "You are an expert in the Witness supply chain attestation framework. You help users instrument CI/CD pipelines with witness, create policy documents, and write Rego policies to validate attestations. You understand all attestors in go-witness and how to use them effectively."}, {"role": "user", "content": "How do I create a witness policy for a build step that uses these attestors: environment, material, github?"}, {"role": "assistant", "content": "Here's a complete witness policy for your build step with environment, material, github attestors:\n\n**Policy Document:**\n```json\n{\n  \"expires\": \"2026-11-08T10:52:59Z\",\n  \"publickeys\": {\n    \"build-key\": {\n      \"keyid\": \"sha256:18892138ec296f3ed74b2ee5e821dfbf0a1499dc31ea3dd43356eeeaffe49f97\",\n      \"key\": \"-----BEGIN PUBLIC KEY-----\\n...\\n-----END PUBLIC KEY-----\"\n    }\n  },\n  \"steps\": {\n    \"build\": {\n      \"name\": \"build\",\n      \"attestations\": [\n        {\n          \"type\": \"https://witness.dev/attestations/environment/v0.1\"\n        },\n        {\n          \"type\": \"https://witness.dev/attestations/material/v0.1\"\n        },\n        {\n          \"type\": \"https://witness.dev/attestations/github/v0.1\"\n        }\n      ],\n      \"functionaries\": [\n        {\n          \"type\": \"publickey\",\n          \"publickeyid\": \"build-key\"\n        }\n      ]\n    }\n  }\n}\n```\n\n**Witness Run Command:**\n```bash\nwitness run --step build \\\n  --attestations environment,material,github \\\n  --outfile build-attestation.json \\\n  --key signing-key.pem \\\n  -- <your-build-command>\n```\n\n**Rego Validation Rules:**\n```rego\npackage environment\n\nimport rego.v1\n\n# Ensure correct OS\ndeny contains msg if {\n    input.os != \"darwin\"\n    msg := sprintf(\"Must run on darwin, got: %s\", [input.os])\n}\n\n# Require CI environment\ndeny contains msg if {\n    not \"CI\" in input.variables\n    msg := \"Must run in CI environment (CI variable not set)\"\n}\n```\n\n**Verification:**\n```bash\nwitness verify \\\n  --policy policy-signed.json \\\n  --publickey policy-key.pub \\\n  -a build-attestation.json \\\n  --subject <artifact>\n```\n"}]}
{"messages": [{"role": "system", "content": "You are an expert in the Witness supply chain attestation framework. You help users instrument CI/CD pipelines with witness, create policy documents, and write Rego policies to validate attestations. You understand all attestors in go-witness and how to use them effectively."}, {"role": "user", "content": "How do I create a witness policy for a build step that uses these attestors: environment?"}, {"role": "assistant", "content": "Here's a complete witness policy for your build step with environment attestors:\n\n**Policy Document:**\n```json\n{\n  \"expires\": \"2026-11-08T10:52:59Z\",\n  \"publickeys\": {\n    \"build-key\": {\n      \"keyid\": \"sha256:83e78fa36b9554f1fe37e70d51bf12ed177ad09c44ad7216cea8cd301a06380f\",\n      \"key\": \"-----BEGIN PUBLIC KEY-----\\n...\\n-----END PUBLIC KEY-----\"\n    }\n  },\n  \"steps\": {\n    \"build\": {\n      \"name\": \"build\",\n      \"attestations\": [\n        {\n          \"type\": \"https://witness.dev/attestations/environment/v0.1\"\n        }\n      ],\n      \"functionaries\": [\n        {\n          \"type\": \"publickey\",\n          \"publickeyid\": \"build-key\"\n        }\n      ]\n    }\n  }\n}\n```\n\n**Witness Run Command:**\n```bash\nwitness run --step build \\\n  --attestations environment \\\n  --outfile build-attestation.json \\\n  --key signing-key.pem \\\n  -- <your-build-command>\n```\n\n**Rego Validation Rules:**\n```rego\npackage environment\n\nimport rego.v1\n\n# Ensure correct OS\ndeny contains msg if {\n    input.os != \"linux\"\n    msg := sprintf(\"Must run on linux, got: %s\", [input.os])\n}\n\n# Require CI environment\ndeny contains msg if {\n    not \"CI\" in input.variables\n    msg := \"Must run in CI environment (CI variable not set)\"\n}\n```\n\n**Verification:**\n```bash\nwitness verify \\\n  --policy policy-signed.json \\\n  --publickey policy-key.pub \\\n  -a build-attestation.json \\\n  --subject <artifact>\n```\n"}]}
{"messages": [{"role": "system", "content": "You are an expert in the Witness supply chain attestation framework. You help users instrument CI/CD pipelines with witness, create policy documents, and write Rego policies to validate attestations. You understand all attestors in go-witness and how to use them effectively."}, {"role": "user", "content": "How do I create a multi-step witness policy for a build \u2192 test \u2192 package pipeline?"}, {"role": "assistant", "content": "Here's a complete multi-step witness policy for your pipeline:\n\n**Policy Document:**\n```json\n{\n  \"expires\": \"2026-11-08T10:52:59Z\",\n  \"publickeys\": {\n    \"ci-key\": {\n      \"keyid\": \"sha256:cbfb53fa2732231ac07b502ea79d95ea02134b33f56a4f0fddfbe60c283d1fd1\",\n      \"key\": \"-----BEGIN PUBLIC KEY-----\\n...\\n-----END PUBLIC KEY-----\"\n    }\n  },\n  \"steps\": {\n    \"build\": {\n      \"name\": \"build\",\n      \"attestations\": [\n        {\n          \"type\": \"https://witness.dev/attestations/git/v0.1\"\n        },\n        {\n          \"type\": \"https://witness.dev/attestations/command-run/v0.1\"\n        },\n        {\n          \"type\": \"https://witness.dev/attestations/product/v0.1\"\n        }\n      ],\n      \"functionaries\": [\n        {\n          \"type\": \"publickey\",\n          \"publickeyid\": \"ci-key\"\n        }\n      ]\n    },\n    \"test\": {\n      \"name\": \"test\",\n      \"attestations\": [\n        {\n          \"type\": \"https://witness.dev/attestations/material/v0.1\"\n        },\n        {\n          \"type\": \"https://witness.dev/attestations/command-run/v0.1\"\n        }\n      ],\n      \"functionaries\": [\n        {\n          \"type\": \"publickey\",\n          \"publickeyid\": \"ci-key\"\n        }\n      ]\n    },\n    \"package\": {\n      \"name\": \"package\",\n      \"attestations\": [\n        {\n          \"type\": \"https://witness.dev/attestations/material/v0.1\"\n        },\n        {\n          \"type\": \"https://witness.dev/attestations/product/v0.1\"\n        }\n      ],\n      \"functionaries\": [\n        {\n          \"type\": \"publickey\",\n          \"publickeyid\": \"ci-key\"\n        }\n      ]\n    }\n  }\n}\n```\n\n**Pipeline Commands:**\n\n```bash\n# Step 1: Build\nwitness run --step build \\\n  --attestations git,commandrun,product \\\n  -o build.json --key ci-key.pem \\\n  -- go build -o myapp\n\n# Step 2: Test\nwitness run --step test \\\n  --attestations material,commandrun \\\n  -o test.json --key ci-key.pem \\\n  -- go test ./...\n\n# Step 3: Package\nwitness run --step package \\\n  --attestations material,product \\\n  -o package.json --key ci-key.pem \\\n  -- tar czf myapp.tar.gz myapp\n\n# Verify entire pipeline\nwitness verify \\\n  --policy policy-signed.json \\\n  --publickey policy-key.pub \\\n  -a build.json -a test.json -a package.json\n```\n"}]}
{"messages": [{"role": "system", "content": "You are an expert in the Witness supply chain attestation framework. You help users instrument CI/CD pipelines with witness, create policy documents, and write Rego policies to validate attestations. You understand all attestors in go-witness and how to use them effectively."}, {"role": "user", "content": "How do I create a witness policy for a build step that uses these attestors: git, commandrun?"}, {"role": "assistant", "content": "Here's a complete witness policy for your build step with git, commandrun attestors:\n\n**Policy Document:**\n```json\n{\n  \"expires\": \"2026-11-08T10:52:59Z\",\n  \"publickeys\": {\n    \"build-key\": {\n      \"keyid\": \"sha256:4ebf5bb716e289336a7a14bea465cbc4d71fa79910e16f91b3ab398bfa15bb0a\",\n      \"key\": \"-----BEGIN PUBLIC KEY-----\\n...\\n-----END PUBLIC KEY-----\"\n    }\n  },\n  \"steps\": {\n    \"build\": {\n      \"name\": \"build\",\n      \"attestations\": [\n        {\n          \"type\": \"https://witness.dev/attestations/git/v0.1\"\n        },\n        {\n          \"type\": \"https://witness.dev/attestations/command-run/v0.1\"\n        }\n      ],\n      \"functionaries\": [\n        {\n          \"type\": \"publickey\",\n          \"publickeyid\": \"build-key\"\n        }\n      ]\n    }\n  }\n}\n```\n\n**Witness Run Command:**\n```bash\nwitness run --step build \\\n  --attestations git,commandrun \\\n  --outfile build-attestation.json \\\n  --key signing-key.pem \\\n  -- <your-build-command>\n```\n\n**Rego Validation Rules:**\n```rego\npackage git\n\nimport rego.v1\n\n# Enforce builds from specific branch\ndeny contains msg if {\n    input.branch != \"release/v1.0\"\n    msg := sprintf(\"Must build from release/v1.0 branch, got: %s\", [input.branch])\n}\n\n# Require clean working directory\ndeny contains msg if {\n    count(input.status) > 0\n    msg := \"Working directory must be clean (no uncommitted changes)\"\n}\n\n# Validate commit author\napproved_authors := {\n    \"alice.smith@example.com\",\n    \"bob.jones@company.com\",\n    \"ci-bot@company.com\"\n}\n\ndeny contains msg if {\n    not input.authoremail in approved_authors\n    msg := sprintf(\"Unauthorized commit author: %s\", [input.authoremail])\n}\n```\n\n**Verification:**\n```bash\nwitness verify \\\n  --policy policy-signed.json \\\n  --publickey policy-key.pub \\\n  -a build-attestation.json \\\n  --subject <artifact>\n```\n"}]}
{"messages": [{"role": "system", "content": "You are an expert in the Witness supply chain attestation framework. You help users instrument CI/CD pipelines with witness, create policy documents, and write Rego policies to validate attestations. You understand all attestors in go-witness and how to use them effectively."}, {"role": "user", "content": "How do I create a multi-step witness policy for a build \u2192 test \u2192 package pipeline?"}, {"role": "assistant", "content": "Here's a complete multi-step witness policy for your pipeline:\n\n**Policy Document:**\n```json\n{\n  \"expires\": \"2026-11-08T10:52:59Z\",\n  \"publickeys\": {\n    \"ci-key\": {\n      \"keyid\": \"sha256:ab95b4cd8c9b155013603691cb34ea8571ceb96ab96ba07dee7483f5a1c2f400\",\n      \"key\": \"-----BEGIN PUBLIC KEY-----\\n...\\n-----END PUBLIC KEY-----\"\n    }\n  },\n  \"steps\": {\n    \"build\": {\n      \"name\": \"build\",\n      \"attestations\": [\n        {\n          \"type\": \"https://witness.dev/attestations/git/v0.1\"\n        },\n        {\n          \"type\": \"https://witness.dev/attestations/command-run/v0.1\"\n        },\n        {\n          \"type\": \"https://witness.dev/attestations/product/v0.1\"\n        }\n      ],\n      \"functionaries\": [\n        {\n          \"type\": \"publickey\",\n          \"publickeyid\": \"ci-key\"\n        }\n      ]\n    },\n    \"test\": {\n      \"name\": \"test\",\n      \"attestations\": [\n        {\n          \"type\": \"https://witness.dev/attestations/material/v0.1\"\n        },\n        {\n          \"type\": \"https://witness.dev/attestations/command-run/v0.1\"\n        }\n      ],\n      \"functionaries\": [\n        {\n          \"type\": \"publickey\",\n          \"publickeyid\": \"ci-key\"\n        }\n      ]\n    },\n    \"package\": {\n      \"name\": \"package\",\n      \"attestations\": [\n        {\n          \"type\": \"https://witness.dev/attestations/material/v0.1\"\n        },\n        {\n          \"type\": \"https://witness.dev/attestations/product/v0.1\"\n        }\n      ],\n      \"functionaries\": [\n        {\n          \"type\": \"publickey\",\n          \"publickeyid\": \"ci-key\"\n        }\n      ]\n    }\n  }\n}\n```\n\n**Pipeline Commands:**\n\n```bash\n# Step 1: Build\nwitness run --step build \\\n  --attestations git,commandrun,product \\\n  -o build.json --key ci-key.pem \\\n  -- go build -o myapp\n\n# Step 2: Test\nwitness run --step test \\\n  --attestations material,commandrun \\\n  -o test.json --key ci-key.pem \\\n  -- go test ./...\n\n# Step 3: Package\nwitness run --step package \\\n  --attestations material,product \\\n  -o package.json --key ci-key.pem \\\n  -- tar czf myapp.tar.gz myapp\n\n# Verify entire pipeline\nwitness verify \\\n  --policy policy-signed.json \\\n  --publickey policy-key.pub \\\n  -a build.json -a test.json -a package.json\n```\n"}]}
{"messages": [{"role": "system", "content": "You are an expert in the Witness supply chain attestation framework. You help users instrument CI/CD pipelines with witness, create policy documents, and write Rego policies to validate attestations. You understand all attestors in go-witness and how to use them effectively."}, {"role": "user", "content": "How do I create a witness policy for a build step that uses these attestors: material, git, product, github, commandrun?"}, {"role": "assistant", "content": "Here's a complete witness policy for your build step with material, git, product, github, commandrun attestors:\n\n**Policy Document:**\n```json\n{\n  \"expires\": \"2026-11-08T10:52:59Z\",\n  \"publickeys\": {\n    \"build-key\": {\n      \"keyid\": \"sha256:7e1422bbde1c8c1e02ebe768565734a6079b7c6480f0d208ad91f7a078cefa6f\",\n      \"key\": \"-----BEGIN PUBLIC KEY-----\\n...\\n-----END PUBLIC KEY-----\"\n    }\n  },\n  \"steps\": {\n    \"build\": {\n      \"name\": \"build\",\n      \"attestations\": [\n        {\n          \"type\": \"https://witness.dev/attestations/material/v0.1\"\n        },\n        {\n          \"type\": \"https://witness.dev/attestations/git/v0.1\"\n        },\n        {\n          \"type\": \"https://witness.dev/attestations/product/v0.1\"\n        },\n        {\n          \"type\": \"https://witness.dev/attestations/github/v0.1\"\n        },\n        {\n          \"type\": \"https://witness.dev/attestations/command-run/v0.1\"\n        }\n      ],\n      \"functionaries\": [\n        {\n          \"type\": \"publickey\",\n          \"publickeyid\": \"build-key\"\n        }\n      ]\n    }\n  }\n}\n```\n\n**Witness Run Command:**\n```bash\nwitness run --step build \\\n  --attestations material,git,product,github,commandrun \\\n  --outfile build-attestation.json \\\n  --key signing-key.pem \\\n  -- <your-build-command>\n```\n\n**Rego Validation Rules:**\n```rego\n\n```\n\n**Verification:**\n```bash\nwitness verify \\\n  --policy policy-signed.json \\\n  --publickey policy-key.pub \\\n  -a build-attestation.json \\\n  --subject <artifact>\n```\n"}]}
{"messages": [{"role": "system", "content": "You are an expert in the Witness supply chain attestation framework. You help users instrument CI/CD pipelines with witness, create policy documents, and write Rego policies to validate attestations. You understand all attestors in go-witness and how to use them effectively."}, {"role": "user", "content": "How do I create a multi-step witness policy for a build \u2192 test \u2192 package pipeline?"}, {"role": "assistant", "content": "Here's a complete multi-step witness policy for your pipeline:\n\n**Policy Document:**\n```json\n{\n  \"expires\": \"2026-11-08T10:52:59Z\",\n  \"publickeys\": {\n    \"ci-key\": {\n      \"keyid\": \"sha256:e7c35e6989c5ba8ebd0aef37dbcc3caec0bda9d31307f45680691d57e8fb1148\",\n      \"key\": \"-----BEGIN PUBLIC KEY-----\\n...\\n-----END PUBLIC KEY-----\"\n    }\n  },\n  \"steps\": {\n    \"build\": {\n      \"name\": \"build\",\n      \"attestations\": [\n        {\n          \"type\": \"https://witness.dev/attestations/git/v0.1\"\n        },\n        {\n          \"type\": \"https://witness.dev/attestations/command-run/v0.1\"\n        },\n        {\n          \"type\": \"https://witness.dev/attestations/product/v0.1\"\n        }\n      ],\n      \"functionaries\": [\n        {\n          \"type\": \"publickey\",\n          \"publickeyid\": \"ci-key\"\n        }\n      ]\n    },\n    \"test\": {\n      \"name\": \"test\",\n      \"attestations\": [\n        {\n          \"type\": \"https://witness.dev/attestations/material/v0.1\"\n        },\n        {\n          \"type\": \"https://witness.dev/attestations/command-run/v0.1\"\n        }\n      ],\n      \"functionaries\": [\n        {\n          \"type\": \"publickey\",\n          \"publickeyid\": \"ci-key\"\n        }\n      ]\n    },\n    \"package\": {\n      \"name\": \"package\",\n      \"attestations\": [\n        {\n          \"type\": \"https://witness.dev/attestations/material/v0.1\"\n        },\n        {\n          \"type\": \"https://witness.dev/attestations/product/v0.1\"\n        }\n      ],\n      \"functionaries\": [\n        {\n          \"type\": \"publickey\",\n          \"publickeyid\": \"ci-key\"\n        }\n      ]\n    }\n  }\n}\n```\n\n**Pipeline Commands:**\n\n```bash\n# Step 1: Build\nwitness run --step build \\\n  --attestations git,commandrun,product \\\n  -o build.json --key ci-key.pem \\\n  -- go build -o myapp\n\n# Step 2: Test\nwitness run --step test \\\n  --attestations material,commandrun \\\n  -o test.json --key ci-key.pem \\\n  -- go test ./...\n\n# Step 3: Package\nwitness run --step package \\\n  --attestations material,product \\\n  -o package.json --key ci-key.pem \\\n  -- tar czf myapp.tar.gz myapp\n\n# Verify entire pipeline\nwitness verify \\\n  --policy policy-signed.json \\\n  --publickey policy-key.pub \\\n  -a build.json -a test.json -a package.json\n```\n"}]}
{"messages": [{"role": "system", "content": "You are an expert in the Witness supply chain attestation framework. You help users instrument CI/CD pipelines with witness, create policy documents, and write Rego policies to validate attestations. You understand all attestors in go-witness and how to use them effectively."}, {"role": "user", "content": "How do I create a witness policy for a build step that uses these attestors: product?"}, {"role": "assistant", "content": "Here's a complete witness policy for your build step with product attestors:\n\n**Policy Document:**\n```json\n{\n  \"expires\": \"2026-11-08T10:52:59Z\",\n  \"publickeys\": {\n    \"build-key\": {\n      \"keyid\": \"sha256:27c375fd186ea7bb8829a6d9a3b574e5175c2a4233fa822f70c33ceff9d167fc\",\n      \"key\": \"-----BEGIN PUBLIC KEY-----\\n...\\n-----END PUBLIC KEY-----\"\n    }\n  },\n  \"steps\": {\n    \"build\": {\n      \"name\": \"build\",\n      \"attestations\": [\n        {\n          \"type\": \"https://witness.dev/attestations/product/v0.1\"\n        }\n      ],\n      \"functionaries\": [\n        {\n          \"type\": \"publickey\",\n          \"publickeyid\": \"build-key\"\n        }\n      ]\n    }\n  }\n}\n```\n\n**Witness Run Command:**\n```bash\nwitness run --step build \\\n  --attestations product \\\n  --outfile build-attestation.json \\\n  --key signing-key.pem \\\n  -- <your-build-command>\n```\n\n**Rego Validation Rules:**\n```rego\n\n```\n\n**Verification:**\n```bash\nwitness verify \\\n  --policy policy-signed.json \\\n  --publickey policy-key.pub \\\n  -a build-attestation.json \\\n  --subject <artifact>\n```\n"}]}
{"messages": [{"role": "system", "content": "You are an expert in the Witness supply chain attestation framework. You help users instrument CI/CD pipelines with witness, create policy documents, and write Rego policies to validate attestations. You understand all attestors in go-witness and how to use them effectively."}, {"role": "user", "content": "How do I create a witness policy for a build step that uses these attestors: github, product, material?"}, {"role": "assistant", "content": "Here's a complete witness policy for your build step with github, product, material attestors:\n\n**Policy Document:**\n```json\n{\n  \"expires\": \"2026-11-08T10:52:59Z\",\n  \"publickeys\": {\n    \"build-key\": {\n      \"keyid\": \"sha256:72e493de012082005716dceb13e224a9fc6219ba5f155dbf69cddcb2f217bf5f\",\n      \"key\": \"-----BEGIN PUBLIC KEY-----\\n...\\n-----END PUBLIC KEY-----\"\n    }\n  },\n  \"steps\": {\n    \"build\": {\n      \"name\": \"build\",\n      \"attestations\": [\n        {\n          \"type\": \"https://witness.dev/attestations/github/v0.1\"\n        },\n        {\n          \"type\": \"https://witness.dev/attestations/product/v0.1\"\n        },\n        {\n          \"type\": \"https://witness.dev/attestations/material/v0.1\"\n        }\n      ],\n      \"functionaries\": [\n        {\n          \"type\": \"publickey\",\n          \"publickeyid\": \"build-key\"\n        }\n      ]\n    }\n  }\n}\n```\n\n**Witness Run Command:**\n```bash\nwitness run --step build \\\n  --attestations github,product,material \\\n  --outfile build-attestation.json \\\n  --key signing-key.pem \\\n  -- <your-build-command>\n```\n\n**Rego Validation Rules:**\n```rego\n\n```\n\n**Verification:**\n```bash\nwitness verify \\\n  --policy policy-signed.json \\\n  --publickey policy-key.pub \\\n  -a build-attestation.json \\\n  --subject <artifact>\n```\n"}]}
{"messages": [{"role": "system", "content": "You are an expert in the Witness supply chain attestation framework. You help users instrument CI/CD pipelines with witness, create policy documents, and write Rego policies to validate attestations. You understand all attestors in go-witness and how to use them effectively."}, {"role": "user", "content": "How do I create a multi-step witness policy for a build \u2192 test \u2192 package pipeline?"}, {"role": "assistant", "content": "Here's a complete multi-step witness policy for your pipeline:\n\n**Policy Document:**\n```json\n{\n  \"expires\": \"2026-11-08T10:52:59Z\",\n  \"publickeys\": {\n    \"ci-key\": {\n      \"keyid\": \"sha256:f0726b9715e5592ff2d4aee4ffaf6d3fad7f9ada3cfe842f71d772015edcc9e3\",\n      \"key\": \"-----BEGIN PUBLIC KEY-----\\n...\\n-----END PUBLIC KEY-----\"\n    }\n  },\n  \"steps\": {\n    \"build\": {\n      \"name\": \"build\",\n      \"attestations\": [\n        {\n          \"type\": \"https://witness.dev/attestations/git/v0.1\"\n        },\n        {\n          \"type\": \"https://witness.dev/attestations/command-run/v0.1\"\n        },\n        {\n          \"type\": \"https://witness.dev/attestations/product/v0.1\"\n        }\n      ],\n      \"functionaries\": [\n        {\n          \"type\": \"publickey\",\n          \"publickeyid\": \"ci-key\"\n        }\n      ]\n    },\n    \"test\": {\n      \"name\": \"test\",\n      \"attestations\": [\n        {\n          \"type\": \"https://witness.dev/attestations/material/v0.1\"\n        },\n        {\n          \"type\": \"https://witness.dev/attestations/command-run/v0.1\"\n        }\n      ],\n      \"functionaries\": [\n        {\n          \"type\": \"publickey\",\n          \"publickeyid\": \"ci-key\"\n        }\n      ]\n    },\n    \"package\": {\n      \"name\": \"package\",\n      \"attestations\": [\n        {\n          \"type\": \"https://witness.dev/attestations/material/v0.1\"\n        },\n        {\n          \"type\": \"https://witness.dev/attestations/product/v0.1\"\n        }\n      ],\n      \"functionaries\": [\n        {\n          \"type\": \"publickey\",\n          \"publickeyid\": \"ci-key\"\n        }\n      ]\n    }\n  }\n}\n```\n\n**Pipeline Commands:**\n\n```bash\n# Step 1: Build\nwitness run --step build \\\n  --attestations git,commandrun,product \\\n  -o build.json --key ci-key.pem \\\n  -- go build -o myapp\n\n# Step 2: Test\nwitness run --step test \\\n  --attestations material,commandrun \\\n  -o test.json --key ci-key.pem \\\n  -- go test ./...\n\n# Step 3: Package\nwitness run --step package \\\n  --attestations material,product \\\n  -o package.json --key ci-key.pem \\\n  -- tar czf myapp.tar.gz myapp\n\n# Verify entire pipeline\nwitness verify \\\n  --policy policy-signed.json \\\n  --publickey policy-key.pub \\\n  -a build.json -a test.json -a package.json\n```\n"}]}
{"messages": [{"role": "system", "content": "You are an expert in the Witness supply chain attestation framework. You help users instrument CI/CD pipelines with witness, create policy documents, and write Rego policies to validate attestations. You understand all attestors in go-witness and how to use them effectively."}, {"role": "user", "content": "How do I create a witness policy for a build step that uses these attestors: commandrun, environment?"}, {"role": "assistant", "content": "Here's a complete witness policy for your build step with commandrun, environment attestors:\n\n**Policy Document:**\n```json\n{\n  \"expires\": \"2026-11-08T10:52:59Z\",\n  \"publickeys\": {\n    \"build-key\": {\n      \"keyid\": \"sha256:6242a5213f25acb3bac190c162cbff89b5c20b7e610107aaee7712ebc1d23b41\",\n      \"key\": \"-----BEGIN PUBLIC KEY-----\\n...\\n-----END PUBLIC KEY-----\"\n    }\n  },\n  \"steps\": {\n    \"build\": {\n      \"name\": \"build\",\n      \"attestations\": [\n        {\n          \"type\": \"https://witness.dev/attestations/command-run/v0.1\"\n        },\n        {\n          \"type\": \"https://witness.dev/attestations/environment/v0.1\"\n        }\n      ],\n      \"functionaries\": [\n        {\n          \"type\": \"publickey\",\n          \"publickeyid\": \"build-key\"\n        }\n      ]\n    }\n  }\n}\n```\n\n**Witness Run Command:**\n```bash\nwitness run --step build \\\n  --attestations commandrun,environment \\\n  --outfile build-attestation.json \\\n  --key signing-key.pem \\\n  -- <your-build-command>\n```\n\n**Rego Validation Rules:**\n```rego\n\n```\n\n**Verification:**\n```bash\nwitness verify \\\n  --policy policy-signed.json \\\n  --publickey policy-key.pub \\\n  -a build-attestation.json \\\n  --subject <artifact>\n```\n"}]}
{"messages": [{"role": "system", "content": "You are an expert in the Witness supply chain attestation framework. You help users instrument CI/CD pipelines with witness, create policy documents, and write Rego policies to validate attestations. You understand all attestors in go-witness and how to use them effectively."}, {"role": "user", "content": "How do I create a witness policy for a build step that uses these attestors: github, commandrun, git, material, product?"}, {"role": "assistant", "content": "Here's a complete witness policy for your build step with github, commandrun, git, material, product attestors:\n\n**Policy Document:**\n```json\n{\n  \"expires\": \"2026-11-08T10:52:59Z\",\n  \"publickeys\": {\n    \"build-key\": {\n      \"keyid\": \"sha256:edbf0f845533ee09c72b422dc923c72b5d6b44af27df1ff7da8498ccb887e4cf\",\n      \"key\": \"-----BEGIN PUBLIC KEY-----\\n...\\n-----END PUBLIC KEY-----\"\n    }\n  },\n  \"steps\": {\n    \"build\": {\n      \"name\": \"build\",\n      \"attestations\": [\n        {\n          \"type\": \"https://witness.dev/attestations/github/v0.1\"\n        },\n        {\n          \"type\": \"https://witness.dev/attestations/command-run/v0.1\"\n        },\n        {\n          \"type\": \"https://witness.dev/attestations/git/v0.1\"\n        },\n        {\n          \"type\": \"https://witness.dev/attestations/material/v0.1\"\n        },\n        {\n          \"type\": \"https://witness.dev/attestations/product/v0.1\"\n        }\n      ],\n      \"functionaries\": [\n        {\n          \"type\": \"publickey\",\n          \"publickeyid\": \"build-key\"\n        }\n      ]\n    }\n  }\n}\n```\n\n**Witness Run Command:**\n```bash\nwitness run --step build \\\n  --attestations github,commandrun,git,material,product \\\n  --outfile build-attestation.json \\\n  --key signing-key.pem \\\n  -- <your-build-command>\n```\n\n**Rego Validation Rules:**\n```rego\n\n```\n\n**Verification:**\n```bash\nwitness verify \\\n  --policy policy-signed.json \\\n  --publickey policy-key.pub \\\n  -a build-attestation.json \\\n  --subject <artifact>\n```\n"}]}
{"messages": [{"role": "system", "content": "You are an expert in the Witness supply chain attestation framework. You help users instrument CI/CD pipelines with witness, create policy documents, and write Rego policies to validate attestations. You understand all attestors in go-witness and how to use them effectively."}, {"role": "user", "content": "How do I create a multi-step witness policy for a build \u2192 test \u2192 package pipeline?"}, {"role": "assistant", "content": "Here's a complete multi-step witness policy for your pipeline:\n\n**Policy Document:**\n```json\n{\n  \"expires\": \"2026-11-08T10:52:59Z\",\n  \"publickeys\": {\n    \"ci-key\": {\n      \"keyid\": \"sha256:9fec1fad6a10874f5bfd549de3e7efa8f65c70facb8ad5beb213c0d7f38dfb31\",\n      \"key\": \"-----BEGIN PUBLIC KEY-----\\n...\\n-----END PUBLIC KEY-----\"\n    }\n  },\n  \"steps\": {\n    \"build\": {\n      \"name\": \"build\",\n      \"attestations\": [\n        {\n          \"type\": \"https://witness.dev/attestations/git/v0.1\"\n        },\n        {\n          \"type\": \"https://witness.dev/attestations/command-run/v0.1\"\n        },\n        {\n          \"type\": \"https://witness.dev/attestations/product/v0.1\"\n        }\n      ],\n      \"functionaries\": [\n        {\n          \"type\": \"publickey\",\n          \"publickeyid\": \"ci-key\"\n        }\n      ]\n    },\n    \"test\": {\n      \"name\": \"test\",\n      \"attestations\": [\n        {\n          \"type\": \"https://witness.dev/attestations/material/v0.1\"\n        },\n        {\n          \"type\": \"https://witness.dev/attestations/command-run/v0.1\"\n        }\n      ],\n      \"functionaries\": [\n        {\n          \"type\": \"publickey\",\n          \"publickeyid\": \"ci-key\"\n        }\n      ]\n    },\n    \"package\": {\n      \"name\": \"package\",\n      \"attestations\": [\n        {\n          \"type\": \"https://witness.dev/attestations/material/v0.1\"\n        },\n        {\n          \"type\": \"https://witness.dev/attestations/product/v0.1\"\n        }\n      ],\n      \"functionaries\": [\n        {\n          \"type\": \"publickey\",\n          \"publickeyid\": \"ci-key\"\n        }\n      ]\n    }\n  }\n}\n```\n\n**Pipeline Commands:**\n\n```bash\n# Step 1: Build\nwitness run --step build \\\n  --attestations git,commandrun,product \\\n  -o build.json --key ci-key.pem \\\n  -- go build -o myapp\n\n# Step 2: Test\nwitness run --step test \\\n  --attestations material,commandrun \\\n  -o test.json --key ci-key.pem \\\n  -- go test ./...\n\n# Step 3: Package\nwitness run --step package \\\n  --attestations material,product \\\n  -o package.json --key ci-key.pem \\\n  -- tar czf myapp.tar.gz myapp\n\n# Verify entire pipeline\nwitness verify \\\n  --policy policy-signed.json \\\n  --publickey policy-key.pub \\\n  -a build.json -a test.json -a package.json\n```\n"}]}
{"messages": [{"role": "system", "content": "You are an expert in the Witness supply chain attestation framework. You help users instrument CI/CD pipelines with witness, create policy documents, and write Rego policies to validate attestations. You understand all attestors in go-witness and how to use them effectively."}, {"role": "user", "content": "How do I create a witness policy for a build step that uses these attestors: material, product, git?"}, {"role": "assistant", "content": "Here's a complete witness policy for your build step with material, product, git attestors:\n\n**Policy Document:**\n```json\n{\n  \"expires\": \"2026-11-08T10:52:59Z\",\n  \"publickeys\": {\n    \"build-key\": {\n      \"keyid\": \"sha256:6cad6ff1675d99d8b83f9fbeae92a8a69ccf73e1da4262526550f7b4d2838892\",\n      \"key\": \"-----BEGIN PUBLIC KEY-----\\n...\\n-----END PUBLIC KEY-----\"\n    }\n  },\n  \"steps\": {\n    \"build\": {\n      \"name\": \"build\",\n      \"attestations\": [\n        {\n          \"type\": \"https://witness.dev/attestations/material/v0.1\"\n        },\n        {\n          \"type\": \"https://witness.dev/attestations/product/v0.1\"\n        },\n        {\n          \"type\": \"https://witness.dev/attestations/git/v0.1\"\n        }\n      ],\n      \"functionaries\": [\n        {\n          \"type\": \"publickey\",\n          \"publickeyid\": \"build-key\"\n        }\n      ]\n    }\n  }\n}\n```\n\n**Witness Run Command:**\n```bash\nwitness run --step build \\\n  --attestations material,product,git \\\n  --outfile build-attestation.json \\\n  --key signing-key.pem \\\n  -- <your-build-command>\n```\n\n**Rego Validation Rules:**\n```rego\n\n```\n\n**Verification:**\n```bash\nwitness verify \\\n  --policy policy-signed.json \\\n  --publickey policy-key.pub \\\n  -a build-attestation.json \\\n  --subject <artifact>\n```\n"}]}
{"messages": [{"role": "system", "content": "You are an expert in the Witness supply chain attestation framework. You help users instrument CI/CD pipelines with witness, create policy documents, and write Rego policies to validate attestations. You understand all attestors in go-witness and how to use them effectively."}, {"role": "user", "content": "How do I create a multi-step witness policy for a build \u2192 test \u2192 package pipeline?"}, {"role": "assistant", "content": "Here's a complete multi-step witness policy for your pipeline:\n\n**Policy Document:**\n```json\n{\n  \"expires\": \"2026-11-08T10:52:59Z\",\n  \"publickeys\": {\n    \"ci-key\": {\n      \"keyid\": \"sha256:a294f60d44cd6f22e28bfcac358a1dbfd4217335978de1933b5d6fc9cd14bdf3\",\n      \"key\": \"-----BEGIN PUBLIC KEY-----\\n...\\n-----END PUBLIC KEY-----\"\n    }\n  },\n  \"steps\": {\n    \"build\": {\n      \"name\": \"build\",\n      \"attestations\": [\n        {\n          \"type\": \"https://witness.dev/attestations/git/v0.1\"\n        },\n        {\n          \"type\": \"https://witness.dev/attestations/command-run/v0.1\"\n        },\n        {\n          \"type\": \"https://witness.dev/attestations/product/v0.1\"\n        }\n      ],\n      \"functionaries\": [\n        {\n          \"type\": \"publickey\",\n          \"publickeyid\": \"ci-key\"\n        }\n      ]\n    },\n    \"test\": {\n      \"name\": \"test\",\n      \"attestations\": [\n        {\n          \"type\": \"https://witness.dev/attestations/material/v0.1\"\n        },\n        {\n          \"type\": \"https://witness.dev/attestations/command-run/v0.1\"\n        }\n      ],\n      \"functionaries\": [\n        {\n          \"type\": \"publickey\",\n          \"publickeyid\": \"ci-key\"\n        }\n      ]\n    },\n    \"package\": {\n      \"name\": \"package\",\n      \"attestations\": [\n        {\n          \"type\": \"https://witness.dev/attestations/material/v0.1\"\n        },\n        {\n          \"type\": \"https://witness.dev/attestations/product/v0.1\"\n        }\n      ],\n      \"functionaries\": [\n        {\n          \"type\": \"publickey\",\n          \"publickeyid\": \"ci-key\"\n        }\n      ]\n    }\n  }\n}\n```\n\n**Pipeline Commands:**\n\n```bash\n# Step 1: Build\nwitness run --step build \\\n  --attestations git,commandrun,product \\\n  -o build.json --key ci-key.pem \\\n  -- go build -o myapp\n\n# Step 2: Test\nwitness run --step test \\\n  --attestations material,commandrun \\\n  -o test.json --key ci-key.pem \\\n  -- go test ./...\n\n# Step 3: Package\nwitness run --step package \\\n  --attestations material,product \\\n  -o package.json --key ci-key.pem \\\n  -- tar czf myapp.tar.gz myapp\n\n# Verify entire pipeline\nwitness verify \\\n  --policy policy-signed.json \\\n  --publickey policy-key.pub \\\n  -a build.json -a test.json -a package.json\n```\n"}]}
{"messages": [{"role": "system", "content": "You are an expert in the Witness supply chain attestation framework. You help users instrument CI/CD pipelines with witness, create policy documents, and write Rego policies to validate attestations. You understand all attestors in go-witness and how to use them effectively."}, {"role": "user", "content": "How do I create a multi-step witness policy for a build \u2192 test \u2192 package pipeline?"}, {"role": "assistant", "content": "Here's a complete multi-step witness policy for your pipeline:\n\n**Policy Document:**\n```json\n{\n  \"expires\": \"2026-11-08T10:52:59Z\",\n  \"publickeys\": {\n    \"ci-key\": {\n      \"keyid\": \"sha256:6da90231ee8af5c55c4fd40feed63a4c60df3cea5f177c194479cfa30d676003\",\n      \"key\": \"-----BEGIN PUBLIC KEY-----\\n...\\n-----END PUBLIC KEY-----\"\n    }\n  },\n  \"steps\": {\n    \"build\": {\n      \"name\": \"build\",\n      \"attestations\": [\n        {\n          \"type\": \"https://witness.dev/attestations/git/v0.1\"\n        },\n        {\n          \"type\": \"https://witness.dev/attestations/command-run/v0.1\"\n        },\n        {\n          \"type\": \"https://witness.dev/attestations/product/v0.1\"\n        }\n      ],\n      \"functionaries\": [\n        {\n          \"type\": \"publickey\",\n          \"publickeyid\": \"ci-key\"\n        }\n      ]\n    },\n    \"test\": {\n      \"name\": \"test\",\n      \"attestations\": [\n        {\n          \"type\": \"https://witness.dev/attestations/material/v0.1\"\n        },\n        {\n          \"type\": \"https://witness.dev/attestations/command-run/v0.1\"\n        }\n      ],\n      \"functionaries\": [\n        {\n          \"type\": \"publickey\",\n          \"publickeyid\": \"ci-key\"\n        }\n      ]\n    },\n    \"package\": {\n      \"name\": \"package\",\n      \"attestations\": [\n        {\n          \"type\": \"https://witness.dev/attestations/material/v0.1\"\n        },\n        {\n          \"type\": \"https://witness.dev/attestations/product/v0.1\"\n        }\n      ],\n      \"functionaries\": [\n        {\n          \"type\": \"publickey\",\n          \"publickeyid\": \"ci-key\"\n        }\n      ]\n    }\n  }\n}\n```\n\n**Pipeline Commands:**\n\n```bash\n# Step 1: Build\nwitness run --step build \\\n  --attestations git,commandrun,product \\\n  -o build.json --key ci-key.pem \\\n  -- go build -o myapp\n\n# Step 2: Test\nwitness run --step test \\\n  --attestations material,commandrun \\\n  -o test.json --key ci-key.pem \\\n  -- go test ./...\n\n# Step 3: Package\nwitness run --step package \\\n  --attestations material,product \\\n  -o package.json --key ci-key.pem \\\n  -- tar czf myapp.tar.gz myapp\n\n# Verify entire pipeline\nwitness verify \\\n  --policy policy-signed.json \\\n  --publickey policy-key.pub \\\n  -a build.json -a test.json -a package.json\n```\n"}]}
{"messages": [{"role": "system", "content": "You are an expert in the Witness supply chain attestation framework. You help users instrument CI/CD pipelines with witness, create policy documents, and write Rego policies to validate attestations. You understand all attestors in go-witness and how to use them effectively."}, {"role": "user", "content": "How do I create a multi-step witness policy for a build \u2192 test \u2192 package pipeline?"}, {"role": "assistant", "content": "Here's a complete multi-step witness policy for your pipeline:\n\n**Policy Document:**\n```json\n{\n  \"expires\": \"2026-11-08T10:52:59Z\",\n  \"publickeys\": {\n    \"ci-key\": {\n      \"keyid\": \"sha256:6b868686ceb2a54072556f042710b8b3a2063f183ef06e8d689cd15dcf53865c\",\n      \"key\": \"-----BEGIN PUBLIC KEY-----\\n...\\n-----END PUBLIC KEY-----\"\n    }\n  },\n  \"steps\": {\n    \"build\": {\n      \"name\": \"build\",\n      \"attestations\": [\n        {\n          \"type\": \"https://witness.dev/attestations/git/v0.1\"\n        },\n        {\n          \"type\": \"https://witness.dev/attestations/command-run/v0.1\"\n        },\n        {\n          \"type\": \"https://witness.dev/attestations/product/v0.1\"\n        }\n      ],\n      \"functionaries\": [\n        {\n          \"type\": \"publickey\",\n          \"publickeyid\": \"ci-key\"\n        }\n      ]\n    },\n    \"test\": {\n      \"name\": \"test\",\n      \"attestations\": [\n        {\n          \"type\": \"https://witness.dev/attestations/material/v0.1\"\n        },\n        {\n          \"type\": \"https://witness.dev/attestations/command-run/v0.1\"\n        }\n      ],\n      \"functionaries\": [\n        {\n          \"type\": \"publickey\",\n          \"publickeyid\": \"ci-key\"\n        }\n      ]\n    },\n    \"package\": {\n      \"name\": \"package\",\n      \"attestations\": [\n        {\n          \"type\": \"https://witness.dev/attestations/material/v0.1\"\n        },\n        {\n          \"type\": \"https://witness.dev/attestations/product/v0.1\"\n        }\n      ],\n      \"functionaries\": [\n        {\n          \"type\": \"publickey\",\n          \"publickeyid\": \"ci-key\"\n        }\n      ]\n    }\n  }\n}\n```\n\n**Pipeline Commands:**\n\n```bash\n# Step 1: Build\nwitness run --step build \\\n  --attestations git,commandrun,product \\\n  -o build.json --key ci-key.pem \\\n  -- go build -o myapp\n\n# Step 2: Test\nwitness run --step test \\\n  --attestations material,commandrun \\\n  -o test.json --key ci-key.pem \\\n  -- go test ./...\n\n# Step 3: Package\nwitness run --step package \\\n  --attestations material,product \\\n  -o package.json --key ci-key.pem \\\n  -- tar czf myapp.tar.gz myapp\n\n# Verify entire pipeline\nwitness verify \\\n  --policy policy-signed.json \\\n  --publickey policy-key.pub \\\n  -a build.json -a test.json -a package.json\n```\n"}]}
{"messages": [{"role": "system", "content": "You are an expert in the Witness supply chain attestation framework. You help users instrument CI/CD pipelines with witness, create policy documents, and write Rego policies to validate attestations. You understand all attestors in go-witness and how to use them effectively."}, {"role": "user", "content": "How do I create a witness policy for a build step that uses these attestors: commandrun, material, github, git?"}, {"role": "assistant", "content": "Here's a complete witness policy for your build step with commandrun, material, github, git attestors:\n\n**Policy Document:**\n```json\n{\n  \"expires\": \"2026-11-08T10:52:59Z\",\n  \"publickeys\": {\n    \"build-key\": {\n      \"keyid\": \"sha256:775ebc62dc8c7c9c5a1da3b6823a7fef23039d1ade13489f99e3a53f7e5ec09f\",\n      \"key\": \"-----BEGIN PUBLIC KEY-----\\n...\\n-----END PUBLIC KEY-----\"\n    }\n  },\n  \"steps\": {\n    \"build\": {\n      \"name\": \"build\",\n      \"attestations\": [\n        {\n          \"type\": \"https://witness.dev/attestations/command-run/v0.1\"\n        },\n        {\n          \"type\": \"https://witness.dev/attestations/material/v0.1\"\n        },\n        {\n          \"type\": \"https://witness.dev/attestations/github/v0.1\"\n        },\n        {\n          \"type\": \"https://witness.dev/attestations/git/v0.1\"\n        }\n      ],\n      \"functionaries\": [\n        {\n          \"type\": \"publickey\",\n          \"publickeyid\": \"build-key\"\n        }\n      ]\n    }\n  }\n}\n```\n\n**Witness Run Command:**\n```bash\nwitness run --step build \\\n  --attestations commandrun,material,github,git \\\n  --outfile build-attestation.json \\\n  --key signing-key.pem \\\n  -- <your-build-command>\n```\n\n**Rego Validation Rules:**\n```rego\n\n```\n\n**Verification:**\n```bash\nwitness verify \\\n  --policy policy-signed.json \\\n  --publickey policy-key.pub \\\n  -a build-attestation.json \\\n  --subject <artifact>\n```\n"}]}
{"messages": [{"role": "system", "content": "You are an expert in the Witness supply chain attestation framework. You help users instrument CI/CD pipelines with witness, create policy documents, and write Rego policies to validate attestations. You understand all attestors in go-witness and how to use them effectively."}, {"role": "user", "content": "How do I create a witness policy for a build step that uses these attestors: environment, github?"}, {"role": "assistant", "content": "Here's a complete witness policy for your build step with environment, github attestors:\n\n**Policy Document:**\n```json\n{\n  \"expires\": \"2026-11-08T10:52:59Z\",\n  \"publickeys\": {\n    \"build-key\": {\n      \"keyid\": \"sha256:c03c824b6526d6dc90ac0803c9fdd1b12437194b875024e036d49e649966738b\",\n      \"key\": \"-----BEGIN PUBLIC KEY-----\\n...\\n-----END PUBLIC KEY-----\"\n    }\n  },\n  \"steps\": {\n    \"build\": {\n      \"name\": \"build\",\n      \"attestations\": [\n        {\n          \"type\": \"https://witness.dev/attestations/environment/v0.1\"\n        },\n        {\n          \"type\": \"https://witness.dev/attestations/github/v0.1\"\n        }\n      ],\n      \"functionaries\": [\n        {\n          \"type\": \"publickey\",\n          \"publickeyid\": \"build-key\"\n        }\n      ]\n    }\n  }\n}\n```\n\n**Witness Run Command:**\n```bash\nwitness run --step build \\\n  --attestations environment,github \\\n  --outfile build-attestation.json \\\n  --key signing-key.pem \\\n  -- <your-build-command>\n```\n\n**Rego Validation Rules:**\n```rego\npackage environment\n\nimport rego.v1\n\n# Ensure correct OS\ndeny contains msg if {\n    input.os != \"windows\"\n    msg := sprintf(\"Must run on windows, got: %s\", [input.os])\n}\n\n# Require CI environment\ndeny contains msg if {\n    not \"CI\" in input.variables\n    msg := \"Must run in CI environment (CI variable not set)\"\n}\n```\n\n**Verification:**\n```bash\nwitness verify \\\n  --policy policy-signed.json \\\n  --publickey policy-key.pub \\\n  -a build-attestation.json \\\n  --subject <artifact>\n```\n"}]}
{"messages": [{"role": "system", "content": "You are an expert in the Witness supply chain attestation framework. You help users instrument CI/CD pipelines with witness, create policy documents, and write Rego policies to validate attestations. You understand all attestors in go-witness and how to use them effectively."}, {"role": "user", "content": "How do I create a multi-step witness policy for a build \u2192 test \u2192 package pipeline?"}, {"role": "assistant", "content": "Here's a complete multi-step witness policy for your pipeline:\n\n**Policy Document:**\n```json\n{\n  \"expires\": \"2026-11-08T10:52:59Z\",\n  \"publickeys\": {\n    \"ci-key\": {\n      \"keyid\": \"sha256:4c08aa224a61552e7103967dee3389efaf03402f12dd186daba0ae8312ee0d97\",\n      \"key\": \"-----BEGIN PUBLIC KEY-----\\n...\\n-----END PUBLIC KEY-----\"\n    }\n  },\n  \"steps\": {\n    \"build\": {\n      \"name\": \"build\",\n      \"attestations\": [\n        {\n          \"type\": \"https://witness.dev/attestations/git/v0.1\"\n        },\n        {\n          \"type\": \"https://witness.dev/attestations/command-run/v0.1\"\n        },\n        {\n          \"type\": \"https://witness.dev/attestations/product/v0.1\"\n        }\n      ],\n      \"functionaries\": [\n        {\n          \"type\": \"publickey\",\n          \"publickeyid\": \"ci-key\"\n        }\n      ]\n    },\n    \"test\": {\n      \"name\": \"test\",\n      \"attestations\": [\n        {\n          \"type\": \"https://witness.dev/attestations/material/v0.1\"\n        },\n        {\n          \"type\": \"https://witness.dev/attestations/command-run/v0.1\"\n        }\n      ],\n      \"functionaries\": [\n        {\n          \"type\": \"publickey\",\n          \"publickeyid\": \"ci-key\"\n        }\n      ]\n    },\n    \"package\": {\n      \"name\": \"package\",\n      \"attestations\": [\n        {\n          \"type\": \"https://witness.dev/attestations/material/v0.1\"\n        },\n        {\n          \"type\": \"https://witness.dev/attestations/product/v0.1\"\n        }\n      ],\n      \"functionaries\": [\n        {\n          \"type\": \"publickey\",\n          \"publickeyid\": \"ci-key\"\n        }\n      ]\n    }\n  }\n}\n```\n\n**Pipeline Commands:**\n\n```bash\n# Step 1: Build\nwitness run --step build \\\n  --attestations git,commandrun,product \\\n  -o build.json --key ci-key.pem \\\n  -- go build -o myapp\n\n# Step 2: Test\nwitness run --step test \\\n  --attestations material,commandrun \\\n  -o test.json --key ci-key.pem \\\n  -- go test ./...\n\n# Step 3: Package\nwitness run --step package \\\n  --attestations material,product \\\n  -o package.json --key ci-key.pem \\\n  -- tar czf myapp.tar.gz myapp\n\n# Verify entire pipeline\nwitness verify \\\n  --policy policy-signed.json \\\n  --publickey policy-key.pub \\\n  -a build.json -a test.json -a package.json\n```\n"}]}
{"messages": [{"role": "system", "content": "You are an expert in the Witness supply chain attestation framework. You help users instrument CI/CD pipelines with witness, create policy documents, and write Rego policies to validate attestations. You understand all attestors in go-witness and how to use them effectively."}, {"role": "user", "content": "How do I create a witness policy for a build step that uses these attestors: github, product, commandrun, environment, material?"}, {"role": "assistant", "content": "Here's a complete witness policy for your build step with github, product, commandrun, environment, material attestors:\n\n**Policy Document:**\n```json\n{\n  \"expires\": \"2026-11-08T10:52:59Z\",\n  \"publickeys\": {\n    \"build-key\": {\n      \"keyid\": \"sha256:d23959caf21fdd9d43b78fb034ffffa05306ab22c9206fcf611f291e372f98bf\",\n      \"key\": \"-----BEGIN PUBLIC KEY-----\\n...\\n-----END PUBLIC KEY-----\"\n    }\n  },\n  \"steps\": {\n    \"build\": {\n      \"name\": \"build\",\n      \"attestations\": [\n        {\n          \"type\": \"https://witness.dev/attestations/github/v0.1\"\n        },\n        {\n          \"type\": \"https://witness.dev/attestations/product/v0.1\"\n        },\n        {\n          \"type\": \"https://witness.dev/attestations/command-run/v0.1\"\n        },\n        {\n          \"type\": \"https://witness.dev/attestations/environment/v0.1\"\n        },\n        {\n          \"type\": \"https://witness.dev/attestations/material/v0.1\"\n        }\n      ],\n      \"functionaries\": [\n        {\n          \"type\": \"publickey\",\n          \"publickeyid\": \"build-key\"\n        }\n      ]\n    }\n  }\n}\n```\n\n**Witness Run Command:**\n```bash\nwitness run --step build \\\n  --attestations github,product,commandrun,environment,material \\\n  --outfile build-attestation.json \\\n  --key signing-key.pem \\\n  -- <your-build-command>\n```\n\n**Rego Validation Rules:**\n```rego\n\n```\n\n**Verification:**\n```bash\nwitness verify \\\n  --policy policy-signed.json \\\n  --publickey policy-key.pub \\\n  -a build-attestation.json \\\n  --subject <artifact>\n```\n"}]}
{"messages": [{"role": "system", "content": "You are an expert in the Witness supply chain attestation framework. You help users instrument CI/CD pipelines with witness, create policy documents, and write Rego policies to validate attestations. You understand all attestors in go-witness and how to use them effectively."}, {"role": "user", "content": "How do I create a multi-step witness policy for a build \u2192 test \u2192 package pipeline?"}, {"role": "assistant", "content": "Here's a complete multi-step witness policy for your pipeline:\n\n**Policy Document:**\n```json\n{\n  \"expires\": \"2026-11-08T10:52:59Z\",\n  \"publickeys\": {\n    \"ci-key\": {\n      \"keyid\": \"sha256:78e9e3a81623b62854efd2f1c01723cef8f3c99079303891971b33a3cde85c90\",\n      \"key\": \"-----BEGIN PUBLIC KEY-----\\n...\\n-----END PUBLIC KEY-----\"\n    }\n  },\n  \"steps\": {\n    \"build\": {\n      \"name\": \"build\",\n      \"attestations\": [\n        {\n          \"type\": \"https://witness.dev/attestations/git/v0.1\"\n        },\n        {\n          \"type\": \"https://witness.dev/attestations/command-run/v0.1\"\n        },\n        {\n          \"type\": \"https://witness.dev/attestations/product/v0.1\"\n        }\n      ],\n      \"functionaries\": [\n        {\n          \"type\": \"publickey\",\n          \"publickeyid\": \"ci-key\"\n        }\n      ]\n    },\n    \"test\": {\n      \"name\": \"test\",\n      \"attestations\": [\n        {\n          \"type\": \"https://witness.dev/attestations/material/v0.1\"\n        },\n        {\n          \"type\": \"https://witness.dev/attestations/command-run/v0.1\"\n        }\n      ],\n      \"functionaries\": [\n        {\n          \"type\": \"publickey\",\n          \"publickeyid\": \"ci-key\"\n        }\n      ]\n    },\n    \"package\": {\n      \"name\": \"package\",\n      \"attestations\": [\n        {\n          \"type\": \"https://witness.dev/attestations/material/v0.1\"\n        },\n        {\n          \"type\": \"https://witness.dev/attestations/product/v0.1\"\n        }\n      ],\n      \"functionaries\": [\n        {\n          \"type\": \"publickey\",\n          \"publickeyid\": \"ci-key\"\n        }\n      ]\n    }\n  }\n}\n```\n\n**Pipeline Commands:**\n\n```bash\n# Step 1: Build\nwitness run --step build \\\n  --attestations git,commandrun,product \\\n  -o build.json --key ci-key.pem \\\n  -- go build -o myapp\n\n# Step 2: Test\nwitness run --step test \\\n  --attestations material,commandrun \\\n  -o test.json --key ci-key.pem \\\n  -- go test ./...\n\n# Step 3: Package\nwitness run --step package \\\n  --attestations material,product \\\n  -o package.json --key ci-key.pem \\\n  -- tar czf myapp.tar.gz myapp\n\n# Verify entire pipeline\nwitness verify \\\n  --policy policy-signed.json \\\n  --publickey policy-key.pub \\\n  -a build.json -a test.json -a package.json\n```\n"}]}
{"messages": [{"role": "system", "content": "You are an expert in the Witness supply chain attestation framework. You help users instrument CI/CD pipelines with witness, create policy documents, and write Rego policies to validate attestations. You understand all attestors in go-witness and how to use them effectively."}, {"role": "user", "content": "How do I create a witness policy for a build step that uses these attestors: environment, product?"}, {"role": "assistant", "content": "Here's a complete witness policy for your build step with environment, product attestors:\n\n**Policy Document:**\n```json\n{\n  \"expires\": \"2026-11-08T10:52:59Z\",\n  \"publickeys\": {\n    \"build-key\": {\n      \"keyid\": \"sha256:f4a47bc10b6b58471d959ee6e4734d7b2338dca5be3bee9ce9c4b415c566e71e\",\n      \"key\": \"-----BEGIN PUBLIC KEY-----\\n...\\n-----END PUBLIC KEY-----\"\n    }\n  },\n  \"steps\": {\n    \"build\": {\n      \"name\": \"build\",\n      \"attestations\": [\n        {\n          \"type\": \"https://witness.dev/attestations/environment/v0.1\"\n        },\n        {\n          \"type\": \"https://witness.dev/attestations/product/v0.1\"\n        }\n      ],\n      \"functionaries\": [\n        {\n          \"type\": \"publickey\",\n          \"publickeyid\": \"build-key\"\n        }\n      ]\n    }\n  }\n}\n```\n\n**Witness Run Command:**\n```bash\nwitness run --step build \\\n  --attestations environment,product \\\n  --outfile build-attestation.json \\\n  --key signing-key.pem \\\n  -- <your-build-command>\n```\n\n**Rego Validation Rules:**\n```rego\npackage environment\n\nimport rego.v1\n\n# Ensure correct OS\ndeny contains msg if {\n    input.os != \"linux\"\n    msg := sprintf(\"Must run on linux, got: %s\", [input.os])\n}\n\n# Require CI environment\ndeny contains msg if {\n    not \"CI\" in input.variables\n    msg := \"Must run in CI environment (CI variable not set)\"\n}\n```\n\n**Verification:**\n```bash\nwitness verify \\\n  --policy policy-signed.json \\\n  --publickey policy-key.pub \\\n  -a build-attestation.json \\\n  --subject <artifact>\n```\n"}]}
{"messages": [{"role": "system", "content": "You are an expert in the Witness supply chain attestation framework. You help users instrument CI/CD pipelines with witness, create policy documents, and write Rego policies to validate attestations. You understand all attestors in go-witness and how to use them effectively."}, {"role": "user", "content": "How do I create a witness policy for a build step that uses these attestors: git, material, product?"}, {"role": "assistant", "content": "Here's a complete witness policy for your build step with git, material, product attestors:\n\n**Policy Document:**\n```json\n{\n  \"expires\": \"2026-11-08T10:52:59Z\",\n  \"publickeys\": {\n    \"build-key\": {\n      \"keyid\": \"sha256:1fe101f6488c45d249166d1450824feb9a87f8c4ac21ee505f36cf83d0921ec4\",\n      \"key\": \"-----BEGIN PUBLIC KEY-----\\n...\\n-----END PUBLIC KEY-----\"\n    }\n  },\n  \"steps\": {\n    \"build\": {\n      \"name\": \"build\",\n      \"attestations\": [\n        {\n          \"type\": \"https://witness.dev/attestations/git/v0.1\"\n        },\n        {\n          \"type\": \"https://witness.dev/attestations/material/v0.1\"\n        },\n        {\n          \"type\": \"https://witness.dev/attestations/product/v0.1\"\n        }\n      ],\n      \"functionaries\": [\n        {\n          \"type\": \"publickey\",\n          \"publickeyid\": \"build-key\"\n        }\n      ]\n    }\n  }\n}\n```\n\n**Witness Run Command:**\n```bash\nwitness run --step build \\\n  --attestations git,material,product \\\n  --outfile build-attestation.json \\\n  --key signing-key.pem \\\n  -- <your-build-command>\n```\n\n**Rego Validation Rules:**\n```rego\npackage git\n\nimport rego.v1\n\n# Enforce builds from specific branch\ndeny contains msg if {\n    input.branch != \"develop\"\n    msg := sprintf(\"Must build from develop branch, got: %s\", [input.branch])\n}\n\n# Validate commit author\napproved_authors := {\n    \"alice.smith@example.com\",\n    \"bob.jones@company.com\",\n    \"ci-bot@company.com\"\n}\n\ndeny contains msg if {\n    not input.authoremail in approved_authors\n    msg := sprintf(\"Unauthorized commit author: %s\", [input.authoremail])\n}\n```\n\n**Verification:**\n```bash\nwitness verify \\\n  --policy policy-signed.json \\\n  --publickey policy-key.pub \\\n  -a build-attestation.json \\\n  --subject <artifact>\n```\n"}]}
{"messages": [{"role": "system", "content": "You are an expert in the Witness supply chain attestation framework. You help users instrument CI/CD pipelines with witness, create policy documents, and write Rego policies to validate attestations. You understand all attestors in go-witness and how to use them effectively."}, {"role": "user", "content": "How do I create a multi-step witness policy for a build \u2192 test \u2192 package pipeline?"}, {"role": "assistant", "content": "Here's a complete multi-step witness policy for your pipeline:\n\n**Policy Document:**\n```json\n{\n  \"expires\": \"2026-11-08T10:52:59Z\",\n  \"publickeys\": {\n    \"ci-key\": {\n      \"keyid\": \"sha256:3fe0997745620bdbdc21c79631ba828d9f4b6e1e4907f2a8af9aa53131e93b73\",\n      \"key\": \"-----BEGIN PUBLIC KEY-----\\n...\\n-----END PUBLIC KEY-----\"\n    }\n  },\n  \"steps\": {\n    \"build\": {\n      \"name\": \"build\",\n      \"attestations\": [\n        {\n          \"type\": \"https://witness.dev/attestations/git/v0.1\"\n        },\n        {\n          \"type\": \"https://witness.dev/attestations/command-run/v0.1\"\n        },\n        {\n          \"type\": \"https://witness.dev/attestations/product/v0.1\"\n        }\n      ],\n      \"functionaries\": [\n        {\n          \"type\": \"publickey\",\n          \"publickeyid\": \"ci-key\"\n        }\n      ]\n    },\n    \"test\": {\n      \"name\": \"test\",\n      \"attestations\": [\n        {\n          \"type\": \"https://witness.dev/attestations/material/v0.1\"\n        },\n        {\n          \"type\": \"https://witness.dev/attestations/command-run/v0.1\"\n        }\n      ],\n      \"functionaries\": [\n        {\n          \"type\": \"publickey\",\n          \"publickeyid\": \"ci-key\"\n        }\n      ]\n    },\n    \"package\": {\n      \"name\": \"package\",\n      \"attestations\": [\n        {\n          \"type\": \"https://witness.dev/attestations/material/v0.1\"\n        },\n        {\n          \"type\": \"https://witness.dev/attestations/product/v0.1\"\n        }\n      ],\n      \"functionaries\": [\n        {\n          \"type\": \"publickey\",\n          \"publickeyid\": \"ci-key\"\n        }\n      ]\n    }\n  }\n}\n```\n\n**Pipeline Commands:**\n\n```bash\n# Step 1: Build\nwitness run --step build \\\n  --attestations git,commandrun,product \\\n  -o build.json --key ci-key.pem \\\n  -- go build -o myapp\n\n# Step 2: Test\nwitness run --step test \\\n  --attestations material,commandrun \\\n  -o test.json --key ci-key.pem \\\n  -- go test ./...\n\n# Step 3: Package\nwitness run --step package \\\n  --attestations material,product \\\n  -o package.json --key ci-key.pem \\\n  -- tar czf myapp.tar.gz myapp\n\n# Verify entire pipeline\nwitness verify \\\n  --policy policy-signed.json \\\n  --publickey policy-key.pub \\\n  -a build.json -a test.json -a package.json\n```\n"}]}
{"messages": [{"role": "system", "content": "You are an expert in the Witness supply chain attestation framework. You help users instrument CI/CD pipelines with witness, create policy documents, and write Rego policies to validate attestations. You understand all attestors in go-witness and how to use them effectively."}, {"role": "user", "content": "How do I create a multi-step witness policy for a build \u2192 test \u2192 package pipeline?"}, {"role": "assistant", "content": "Here's a complete multi-step witness policy for your pipeline:\n\n**Policy Document:**\n```json\n{\n  \"expires\": \"2026-11-08T10:52:59Z\",\n  \"publickeys\": {\n    \"ci-key\": {\n      \"keyid\": \"sha256:b156aae745b7418818a7be23fa07c7481d8dbd0404c6bedb911987bbd4a3a745\",\n      \"key\": \"-----BEGIN PUBLIC KEY-----\\n...\\n-----END PUBLIC KEY-----\"\n    }\n  },\n  \"steps\": {\n    \"build\": {\n      \"name\": \"build\",\n      \"attestations\": [\n        {\n          \"type\": \"https://witness.dev/attestations/git/v0.1\"\n        },\n        {\n          \"type\": \"https://witness.dev/attestations/command-run/v0.1\"\n        },\n        {\n          \"type\": \"https://witness.dev/attestations/product/v0.1\"\n        }\n      ],\n      \"functionaries\": [\n        {\n          \"type\": \"publickey\",\n          \"publickeyid\": \"ci-key\"\n        }\n      ]\n    },\n    \"test\": {\n      \"name\": \"test\",\n      \"attestations\": [\n        {\n          \"type\": \"https://witness.dev/attestations/material/v0.1\"\n        },\n        {\n          \"type\": \"https://witness.dev/attestations/command-run/v0.1\"\n        }\n      ],\n      \"functionaries\": [\n        {\n          \"type\": \"publickey\",\n          \"publickeyid\": \"ci-key\"\n        }\n      ]\n    },\n    \"package\": {\n      \"name\": \"package\",\n      \"attestations\": [\n        {\n          \"type\": \"https://witness.dev/attestations/material/v0.1\"\n        },\n        {\n          \"type\": \"https://witness.dev/attestations/product/v0.1\"\n        }\n      ],\n      \"functionaries\": [\n        {\n          \"type\": \"publickey\",\n          \"publickeyid\": \"ci-key\"\n        }\n      ]\n    }\n  }\n}\n```\n\n**Pipeline Commands:**\n\n```bash\n# Step 1: Build\nwitness run --step build \\\n  --attestations git,commandrun,product \\\n  -o build.json --key ci-key.pem \\\n  -- go build -o myapp\n\n# Step 2: Test\nwitness run --step test \\\n  --attestations material,commandrun \\\n  -o test.json --key ci-key.pem \\\n  -- go test ./...\n\n# Step 3: Package\nwitness run --step package \\\n  --attestations material,product \\\n  -o package.json --key ci-key.pem \\\n  -- tar czf myapp.tar.gz myapp\n\n# Verify entire pipeline\nwitness verify \\\n  --policy policy-signed.json \\\n  --publickey policy-key.pub \\\n  -a build.json -a test.json -a package.json\n```\n"}]}
{"messages": [{"role": "system", "content": "You are an expert in the Witness supply chain attestation framework. You help users instrument CI/CD pipelines with witness, create policy documents, and write Rego policies to validate attestations. You understand all attestors in go-witness and how to use them effectively."}, {"role": "user", "content": "How do I create a multi-step witness policy for a build \u2192 test \u2192 package pipeline?"}, {"role": "assistant", "content": "Here's a complete multi-step witness policy for your pipeline:\n\n**Policy Document:**\n```json\n{\n  \"expires\": \"2026-11-08T10:52:59Z\",\n  \"publickeys\": {\n    \"ci-key\": {\n      \"keyid\": \"sha256:7532aa217df72522f5a9f08b016e9ef8cadb11e5ba730ebfafad159e0ae9a699\",\n      \"key\": \"-----BEGIN PUBLIC KEY-----\\n...\\n-----END PUBLIC KEY-----\"\n    }\n  },\n  \"steps\": {\n    \"build\": {\n      \"name\": \"build\",\n      \"attestations\": [\n        {\n          \"type\": \"https://witness.dev/attestations/git/v0.1\"\n        },\n        {\n          \"type\": \"https://witness.dev/attestations/command-run/v0.1\"\n        },\n        {\n          \"type\": \"https://witness.dev/attestations/product/v0.1\"\n        }\n      ],\n      \"functionaries\": [\n        {\n          \"type\": \"publickey\",\n          \"publickeyid\": \"ci-key\"\n        }\n      ]\n    },\n    \"test\": {\n      \"name\": \"test\",\n      \"attestations\": [\n        {\n          \"type\": \"https://witness.dev/attestations/material/v0.1\"\n        },\n        {\n          \"type\": \"https://witness.dev/attestations/command-run/v0.1\"\n        }\n      ],\n      \"functionaries\": [\n        {\n          \"type\": \"publickey\",\n          \"publickeyid\": \"ci-key\"\n        }\n      ]\n    },\n    \"package\": {\n      \"name\": \"package\",\n      \"attestations\": [\n        {\n          \"type\": \"https://witness.dev/attestations/material/v0.1\"\n        },\n        {\n          \"type\": \"https://witness.dev/attestations/product/v0.1\"\n        }\n      ],\n      \"functionaries\": [\n        {\n          \"type\": \"publickey\",\n          \"publickeyid\": \"ci-key\"\n        }\n      ]\n    }\n  }\n}\n```\n\n**Pipeline Commands:**\n\n```bash\n# Step 1: Build\nwitness run --step build \\\n  --attestations git,commandrun,product \\\n  -o build.json --key ci-key.pem \\\n  -- go build -o myapp\n\n# Step 2: Test\nwitness run --step test \\\n  --attestations material,commandrun \\\n  -o test.json --key ci-key.pem \\\n  -- go test ./...\n\n# Step 3: Package\nwitness run --step package \\\n  --attestations material,product \\\n  -o package.json --key ci-key.pem \\\n  -- tar czf myapp.tar.gz myapp\n\n# Verify entire pipeline\nwitness verify \\\n  --policy policy-signed.json \\\n  --publickey policy-key.pub \\\n  -a build.json -a test.json -a package.json\n```\n"}]}
{"messages": [{"role": "system", "content": "You are an expert in the Witness supply chain attestation framework. You help users instrument CI/CD pipelines with witness, create policy documents, and write Rego policies to validate attestations. You understand all attestors in go-witness and how to use them effectively."}, {"role": "user", "content": "How do I create a multi-step witness policy for a build \u2192 test \u2192 package pipeline?"}, {"role": "assistant", "content": "Here's a complete multi-step witness policy for your pipeline:\n\n**Policy Document:**\n```json\n{\n  \"expires\": \"2026-11-08T10:52:59Z\",\n  \"publickeys\": {\n    \"ci-key\": {\n      \"keyid\": \"sha256:3e8e8c9a4699d00c6b83c67b9ed44142fd51ad7ee714092c16461b343e826453\",\n      \"key\": \"-----BEGIN PUBLIC KEY-----\\n...\\n-----END PUBLIC KEY-----\"\n    }\n  },\n  \"steps\": {\n    \"build\": {\n      \"name\": \"build\",\n      \"attestations\": [\n        {\n          \"type\": \"https://witness.dev/attestations/git/v0.1\"\n        },\n        {\n          \"type\": \"https://witness.dev/attestations/command-run/v0.1\"\n        },\n        {\n          \"type\": \"https://witness.dev/attestations/product/v0.1\"\n        }\n      ],\n      \"functionaries\": [\n        {\n          \"type\": \"publickey\",\n          \"publickeyid\": \"ci-key\"\n        }\n      ]\n    },\n    \"test\": {\n      \"name\": \"test\",\n      \"attestations\": [\n        {\n          \"type\": \"https://witness.dev/attestations/material/v0.1\"\n        },\n        {\n          \"type\": \"https://witness.dev/attestations/command-run/v0.1\"\n        }\n      ],\n      \"functionaries\": [\n        {\n          \"type\": \"publickey\",\n          \"publickeyid\": \"ci-key\"\n        }\n      ]\n    },\n    \"package\": {\n      \"name\": \"package\",\n      \"attestations\": [\n        {\n          \"type\": \"https://witness.dev/attestations/material/v0.1\"\n        },\n        {\n          \"type\": \"https://witness.dev/attestations/product/v0.1\"\n        }\n      ],\n      \"functionaries\": [\n        {\n          \"type\": \"publickey\",\n          \"publickeyid\": \"ci-key\"\n        }\n      ]\n    }\n  }\n}\n```\n\n**Pipeline Commands:**\n\n```bash\n# Step 1: Build\nwitness run --step build \\\n  --attestations git,commandrun,product \\\n  -o build.json --key ci-key.pem \\\n  -- go build -o myapp\n\n# Step 2: Test\nwitness run --step test \\\n  --attestations material,commandrun \\\n  -o test.json --key ci-key.pem \\\n  -- go test ./...\n\n# Step 3: Package\nwitness run --step package \\\n  --attestations material,product \\\n  -o package.json --key ci-key.pem \\\n  -- tar czf myapp.tar.gz myapp\n\n# Verify entire pipeline\nwitness verify \\\n  --policy policy-signed.json \\\n  --publickey policy-key.pub \\\n  -a build.json -a test.json -a package.json\n```\n"}]}
{"messages": [{"role": "system", "content": "You are an expert in the Witness supply chain attestation framework. You help users instrument CI/CD pipelines with witness, create policy documents, and write Rego policies to validate attestations. You understand all attestors in go-witness and how to use them effectively."}, {"role": "user", "content": "How do I create a witness policy for a build step that uses these attestors: environment, material, commandrun, product?"}, {"role": "assistant", "content": "Here's a complete witness policy for your build step with environment, material, commandrun, product attestors:\n\n**Policy Document:**\n```json\n{\n  \"expires\": \"2026-11-08T10:52:59Z\",\n  \"publickeys\": {\n    \"build-key\": {\n      \"keyid\": \"sha256:46b862f5fb1c9af3d55ced8a42692fd30a0be1e77de4dba948948f0fec45c670\",\n      \"key\": \"-----BEGIN PUBLIC KEY-----\\n...\\n-----END PUBLIC KEY-----\"\n    }\n  },\n  \"steps\": {\n    \"build\": {\n      \"name\": \"build\",\n      \"attestations\": [\n        {\n          \"type\": \"https://witness.dev/attestations/environment/v0.1\"\n        },\n        {\n          \"type\": \"https://witness.dev/attestations/material/v0.1\"\n        },\n        {\n          \"type\": \"https://witness.dev/attestations/command-run/v0.1\"\n        },\n        {\n          \"type\": \"https://witness.dev/attestations/product/v0.1\"\n        }\n      ],\n      \"functionaries\": [\n        {\n          \"type\": \"publickey\",\n          \"publickeyid\": \"build-key\"\n        }\n      ]\n    }\n  }\n}\n```\n\n**Witness Run Command:**\n```bash\nwitness run --step build \\\n  --attestations environment,material,commandrun,product \\\n  --outfile build-attestation.json \\\n  --key signing-key.pem \\\n  -- <your-build-command>\n```\n\n**Rego Validation Rules:**\n```rego\npackage environment\n\nimport rego.v1\n\n# Ensure correct OS\ndeny contains msg if {\n    input.os != \"windows\"\n    msg := sprintf(\"Must run on windows, got: %s\", [input.os])\n}\n\n# Require CI environment\ndeny contains msg if {\n    not \"CI\" in input.variables\n    msg := \"Must run in CI environment (CI variable not set)\"\n}\n```\n\n**Verification:**\n```bash\nwitness verify \\\n  --policy policy-signed.json \\\n  --publickey policy-key.pub \\\n  -a build-attestation.json \\\n  --subject <artifact>\n```\n"}]}
{"messages": [{"role": "system", "content": "You are an expert in the Witness supply chain attestation framework. You help users instrument CI/CD pipelines with witness, create policy documents, and write Rego policies to validate attestations. You understand all attestors in go-witness and how to use them effectively."}, {"role": "user", "content": "How do I create a witness policy for a build step that uses these attestors: github, product?"}, {"role": "assistant", "content": "Here's a complete witness policy for your build step with github, product attestors:\n\n**Policy Document:**\n```json\n{\n  \"expires\": \"2026-11-08T10:52:59Z\",\n  \"publickeys\": {\n    \"build-key\": {\n      \"keyid\": \"sha256:b9a5f338d662fb771fa5e60c480e1c92e8b73004a5d516284e0499f4193d7223\",\n      \"key\": \"-----BEGIN PUBLIC KEY-----\\n...\\n-----END PUBLIC KEY-----\"\n    }\n  },\n  \"steps\": {\n    \"build\": {\n      \"name\": \"build\",\n      \"attestations\": [\n        {\n          \"type\": \"https://witness.dev/attestations/github/v0.1\"\n        },\n        {\n          \"type\": \"https://witness.dev/attestations/product/v0.1\"\n        }\n      ],\n      \"functionaries\": [\n        {\n          \"type\": \"publickey\",\n          \"publickeyid\": \"build-key\"\n        }\n      ]\n    }\n  }\n}\n```\n\n**Witness Run Command:**\n```bash\nwitness run --step build \\\n  --attestations github,product \\\n  --outfile build-attestation.json \\\n  --key signing-key.pem \\\n  -- <your-build-command>\n```\n\n**Rego Validation Rules:**\n```rego\n\n```\n\n**Verification:**\n```bash\nwitness verify \\\n  --policy policy-signed.json \\\n  --publickey policy-key.pub \\\n  -a build-attestation.json \\\n  --subject <artifact>\n```\n"}]}
{"messages": [{"role": "system", "content": "You are an expert in the Witness supply chain attestation framework. You help users instrument CI/CD pipelines with witness, create policy documents, and write Rego policies to validate attestations. You understand all attestors in go-witness and how to use them effectively."}, {"role": "user", "content": "How do I create a multi-step witness policy for a build \u2192 test \u2192 package pipeline?"}, {"role": "assistant", "content": "Here's a complete multi-step witness policy for your pipeline:\n\n**Policy Document:**\n```json\n{\n  \"expires\": \"2026-11-08T10:52:59Z\",\n  \"publickeys\": {\n    \"ci-key\": {\n      \"keyid\": \"sha256:1cac308efcd1dd842f9bbca56fd2826c43976ce481eb7eaae62cb23cb80cbb18\",\n      \"key\": \"-----BEGIN PUBLIC KEY-----\\n...\\n-----END PUBLIC KEY-----\"\n    }\n  },\n  \"steps\": {\n    \"build\": {\n      \"name\": \"build\",\n      \"attestations\": [\n        {\n          \"type\": \"https://witness.dev/attestations/git/v0.1\"\n        },\n        {\n          \"type\": \"https://witness.dev/attestations/command-run/v0.1\"\n        },\n        {\n          \"type\": \"https://witness.dev/attestations/product/v0.1\"\n        }\n      ],\n      \"functionaries\": [\n        {\n          \"type\": \"publickey\",\n          \"publickeyid\": \"ci-key\"\n        }\n      ]\n    },\n    \"test\": {\n      \"name\": \"test\",\n      \"attestations\": [\n        {\n          \"type\": \"https://witness.dev/attestations/material/v0.1\"\n        },\n        {\n          \"type\": \"https://witness.dev/attestations/command-run/v0.1\"\n        }\n      ],\n      \"functionaries\": [\n        {\n          \"type\": \"publickey\",\n          \"publickeyid\": \"ci-key\"\n        }\n      ]\n    },\n    \"package\": {\n      \"name\": \"package\",\n      \"attestations\": [\n        {\n          \"type\": \"https://witness.dev/attestations/material/v0.1\"\n        },\n        {\n          \"type\": \"https://witness.dev/attestations/product/v0.1\"\n        }\n      ],\n      \"functionaries\": [\n        {\n          \"type\": \"publickey\",\n          \"publickeyid\": \"ci-key\"\n        }\n      ]\n    }\n  }\n}\n```\n\n**Pipeline Commands:**\n\n```bash\n# Step 1: Build\nwitness run --step build \\\n  --attestations git,commandrun,product \\\n  -o build.json --key ci-key.pem \\\n  -- go build -o myapp\n\n# Step 2: Test\nwitness run --step test \\\n  --attestations material,commandrun \\\n  -o test.json --key ci-key.pem \\\n  -- go test ./...\n\n# Step 3: Package\nwitness run --step package \\\n  --attestations material,product \\\n  -o package.json --key ci-key.pem \\\n  -- tar czf myapp.tar.gz myapp\n\n# Verify entire pipeline\nwitness verify \\\n  --policy policy-signed.json \\\n  --publickey policy-key.pub \\\n  -a build.json -a test.json -a package.json\n```\n"}]}
{"messages": [{"role": "system", "content": "You are an expert in the Witness supply chain attestation framework. You help users instrument CI/CD pipelines with witness, create policy documents, and write Rego policies to validate attestations. You understand all attestors in go-witness and how to use them effectively."}, {"role": "user", "content": "How do I create a witness policy for a build step that uses these attestors: environment?"}, {"role": "assistant", "content": "Here's a complete witness policy for your build step with environment attestors:\n\n**Policy Document:**\n```json\n{\n  \"expires\": \"2026-11-08T10:52:59Z\",\n  \"publickeys\": {\n    \"build-key\": {\n      \"keyid\": \"sha256:bbabbb1f7a1d3e51e6d3c2bb3bd3a9146130a067c9b36e9109f85877a3bdc78b\",\n      \"key\": \"-----BEGIN PUBLIC KEY-----\\n...\\n-----END PUBLIC KEY-----\"\n    }\n  },\n  \"steps\": {\n    \"build\": {\n      \"name\": \"build\",\n      \"attestations\": [\n        {\n          \"type\": \"https://witness.dev/attestations/environment/v0.1\"\n        }\n      ],\n      \"functionaries\": [\n        {\n          \"type\": \"publickey\",\n          \"publickeyid\": \"build-key\"\n        }\n      ]\n    }\n  }\n}\n```\n\n**Witness Run Command:**\n```bash\nwitness run --step build \\\n  --attestations environment \\\n  --outfile build-attestation.json \\\n  --key signing-key.pem \\\n  -- <your-build-command>\n```\n\n**Rego Validation Rules:**\n```rego\npackage environment\n\nimport rego.v1\n\n# Ensure correct OS\ndeny contains msg if {\n    input.os != \"linux\"\n    msg := sprintf(\"Must run on linux, got: %s\", [input.os])\n}\n\n# Require CI environment\ndeny contains msg if {\n    not \"CI\" in input.variables\n    msg := \"Must run in CI environment (CI variable not set)\"\n}\n```\n\n**Verification:**\n```bash\nwitness verify \\\n  --policy policy-signed.json \\\n  --publickey policy-key.pub \\\n  -a build-attestation.json \\\n  --subject <artifact>\n```\n"}]}
{"messages": [{"role": "system", "content": "You are an expert in the Witness supply chain attestation framework. You help users instrument CI/CD pipelines with witness, create policy documents, and write Rego policies to validate attestations. You understand all attestors in go-witness and how to use them effectively."}, {"role": "user", "content": "How do I create a witness policy for a build step that uses these attestors: product, github?"}, {"role": "assistant", "content": "Here's a complete witness policy for your build step with product, github attestors:\n\n**Policy Document:**\n```json\n{\n  \"expires\": \"2026-11-08T10:52:59Z\",\n  \"publickeys\": {\n    \"build-key\": {\n      \"keyid\": \"sha256:abe319e27e071daa5fe89bcaa98de6ad9594b3a6b8a26f635a8529083752f831\",\n      \"key\": \"-----BEGIN PUBLIC KEY-----\\n...\\n-----END PUBLIC KEY-----\"\n    }\n  },\n  \"steps\": {\n    \"build\": {\n      \"name\": \"build\",\n      \"attestations\": [\n        {\n          \"type\": \"https://witness.dev/attestations/product/v0.1\"\n        },\n        {\n          \"type\": \"https://witness.dev/attestations/github/v0.1\"\n        }\n      ],\n      \"functionaries\": [\n        {\n          \"type\": \"publickey\",\n          \"publickeyid\": \"build-key\"\n        }\n      ]\n    }\n  }\n}\n```\n\n**Witness Run Command:**\n```bash\nwitness run --step build \\\n  --attestations product,github \\\n  --outfile build-attestation.json \\\n  --key signing-key.pem \\\n  -- <your-build-command>\n```\n\n**Rego Validation Rules:**\n```rego\n\n```\n\n**Verification:**\n```bash\nwitness verify \\\n  --policy policy-signed.json \\\n  --publickey policy-key.pub \\\n  -a build-attestation.json \\\n  --subject <artifact>\n```\n"}]}
{"messages": [{"role": "system", "content": "You are an expert in the Witness supply chain attestation framework. You help users instrument CI/CD pipelines with witness, create policy documents, and write Rego policies to validate attestations. You understand all attestors in go-witness and how to use them effectively."}, {"role": "user", "content": "How do I create a multi-step witness policy for a build \u2192 test \u2192 package pipeline?"}, {"role": "assistant", "content": "Here's a complete multi-step witness policy for your pipeline:\n\n**Policy Document:**\n```json\n{\n  \"expires\": \"2026-11-08T10:52:59Z\",\n  \"publickeys\": {\n    \"ci-key\": {\n      \"keyid\": \"sha256:0f4c8d50dc3df4374bedd1e18ac33af6fac4c9bd214348446175a42842180ca6\",\n      \"key\": \"-----BEGIN PUBLIC KEY-----\\n...\\n-----END PUBLIC KEY-----\"\n    }\n  },\n  \"steps\": {\n    \"build\": {\n      \"name\": \"build\",\n      \"attestations\": [\n        {\n          \"type\": \"https://witness.dev/attestations/git/v0.1\"\n        },\n        {\n          \"type\": \"https://witness.dev/attestations/command-run/v0.1\"\n        },\n        {\n          \"type\": \"https://witness.dev/attestations/product/v0.1\"\n        }\n      ],\n      \"functionaries\": [\n        {\n          \"type\": \"publickey\",\n          \"publickeyid\": \"ci-key\"\n        }\n      ]\n    },\n    \"test\": {\n      \"name\": \"test\",\n      \"attestations\": [\n        {\n          \"type\": \"https://witness.dev/attestations/material/v0.1\"\n        },\n        {\n          \"type\": \"https://witness.dev/attestations/command-run/v0.1\"\n        }\n      ],\n      \"functionaries\": [\n        {\n          \"type\": \"publickey\",\n          \"publickeyid\": \"ci-key\"\n        }\n      ]\n    },\n    \"package\": {\n      \"name\": \"package\",\n      \"attestations\": [\n        {\n          \"type\": \"https://witness.dev/attestations/material/v0.1\"\n        },\n        {\n          \"type\": \"https://witness.dev/attestations/product/v0.1\"\n        }\n      ],\n      \"functionaries\": [\n        {\n          \"type\": \"publickey\",\n          \"publickeyid\": \"ci-key\"\n        }\n      ]\n    }\n  }\n}\n```\n\n**Pipeline Commands:**\n\n```bash\n# Step 1: Build\nwitness run --step build \\\n  --attestations git,commandrun,product \\\n  -o build.json --key ci-key.pem \\\n  -- go build -o myapp\n\n# Step 2: Test\nwitness run --step test \\\n  --attestations material,commandrun \\\n  -o test.json --key ci-key.pem \\\n  -- go test ./...\n\n# Step 3: Package\nwitness run --step package \\\n  --attestations material,product \\\n  -o package.json --key ci-key.pem \\\n  -- tar czf myapp.tar.gz myapp\n\n# Verify entire pipeline\nwitness verify \\\n  --policy policy-signed.json \\\n  --publickey policy-key.pub \\\n  -a build.json -a test.json -a package.json\n```\n"}]}
{"messages": [{"role": "system", "content": "You are an expert in the Witness supply chain attestation framework. You help users instrument CI/CD pipelines with witness, create policy documents, and write Rego policies to validate attestations. You understand all attestors in go-witness and how to use them effectively."}, {"role": "user", "content": "How do I create a multi-step witness policy for a build \u2192 test \u2192 package pipeline?"}, {"role": "assistant", "content": "Here's a complete multi-step witness policy for your pipeline:\n\n**Policy Document:**\n```json\n{\n  \"expires\": \"2026-11-08T10:52:59Z\",\n  \"publickeys\": {\n    \"ci-key\": {\n      \"keyid\": \"sha256:ac5ba65291b2182d3a401df1b7149d2f10c34e800fc7ad9fadccc4820f4e9357\",\n      \"key\": \"-----BEGIN PUBLIC KEY-----\\n...\\n-----END PUBLIC KEY-----\"\n    }\n  },\n  \"steps\": {\n    \"build\": {\n      \"name\": \"build\",\n      \"attestations\": [\n        {\n          \"type\": \"https://witness.dev/attestations/git/v0.1\"\n        },\n        {\n          \"type\": \"https://witness.dev/attestations/command-run/v0.1\"\n        },\n        {\n          \"type\": \"https://witness.dev/attestations/product/v0.1\"\n        }\n      ],\n      \"functionaries\": [\n        {\n          \"type\": \"publickey\",\n          \"publickeyid\": \"ci-key\"\n        }\n      ]\n    },\n    \"test\": {\n      \"name\": \"test\",\n      \"attestations\": [\n        {\n          \"type\": \"https://witness.dev/attestations/material/v0.1\"\n        },\n        {\n          \"type\": \"https://witness.dev/attestations/command-run/v0.1\"\n        }\n      ],\n      \"functionaries\": [\n        {\n          \"type\": \"publickey\",\n          \"publickeyid\": \"ci-key\"\n        }\n      ]\n    },\n    \"package\": {\n      \"name\": \"package\",\n      \"attestations\": [\n        {\n          \"type\": \"https://witness.dev/attestations/material/v0.1\"\n        },\n        {\n          \"type\": \"https://witness.dev/attestations/product/v0.1\"\n        }\n      ],\n      \"functionaries\": [\n        {\n          \"type\": \"publickey\",\n          \"publickeyid\": \"ci-key\"\n        }\n      ]\n    }\n  }\n}\n```\n\n**Pipeline Commands:**\n\n```bash\n# Step 1: Build\nwitness run --step build \\\n  --attestations git,commandrun,product \\\n  -o build.json --key ci-key.pem \\\n  -- go build -o myapp\n\n# Step 2: Test\nwitness run --step test \\\n  --attestations material,commandrun \\\n  -o test.json --key ci-key.pem \\\n  -- go test ./...\n\n# Step 3: Package\nwitness run --step package \\\n  --attestations material,product \\\n  -o package.json --key ci-key.pem \\\n  -- tar czf myapp.tar.gz myapp\n\n# Verify entire pipeline\nwitness verify \\\n  --policy policy-signed.json \\\n  --publickey policy-key.pub \\\n  -a build.json -a test.json -a package.json\n```\n"}]}
{"messages": [{"role": "system", "content": "You are an expert in the Witness supply chain attestation framework. You help users instrument CI/CD pipelines with witness, create policy documents, and write Rego policies to validate attestations. You understand all attestors in go-witness and how to use them effectively."}, {"role": "user", "content": "How do I create a witness policy for a build step that uses these attestors: environment, git?"}, {"role": "assistant", "content": "Here's a complete witness policy for your build step with environment, git attestors:\n\n**Policy Document:**\n```json\n{\n  \"expires\": \"2026-11-08T10:52:59Z\",\n  \"publickeys\": {\n    \"build-key\": {\n      \"keyid\": \"sha256:36f88270883798407a43a7ebc017883643c05ddf179f680e9bf96133a3e55de9\",\n      \"key\": \"-----BEGIN PUBLIC KEY-----\\n...\\n-----END PUBLIC KEY-----\"\n    }\n  },\n  \"steps\": {\n    \"build\": {\n      \"name\": \"build\",\n      \"attestations\": [\n        {\n          \"type\": \"https://witness.dev/attestations/environment/v0.1\"\n        },\n        {\n          \"type\": \"https://witness.dev/attestations/git/v0.1\"\n        }\n      ],\n      \"functionaries\": [\n        {\n          \"type\": \"publickey\",\n          \"publickeyid\": \"build-key\"\n        }\n      ]\n    }\n  }\n}\n```\n\n**Witness Run Command:**\n```bash\nwitness run --step build \\\n  --attestations environment,git \\\n  --outfile build-attestation.json \\\n  --key signing-key.pem \\\n  -- <your-build-command>\n```\n\n**Rego Validation Rules:**\n```rego\npackage environment\n\nimport rego.v1\n\n# Ensure correct OS\ndeny contains msg if {\n    input.os != \"darwin\"\n    msg := sprintf(\"Must run on darwin, got: %s\", [input.os])\n}\n\n# Require CI environment\ndeny contains msg if {\n    not \"CI\" in input.variables\n    msg := \"Must run in CI environment (CI variable not set)\"\n}\n```\n\n**Verification:**\n```bash\nwitness verify \\\n  --policy policy-signed.json \\\n  --publickey policy-key.pub \\\n  -a build-attestation.json \\\n  --subject <artifact>\n```\n"}]}
{"messages": [{"role": "system", "content": "You are an expert in the Witness supply chain attestation framework. You help users instrument CI/CD pipelines with witness, create policy documents, and write Rego policies to validate attestations. You understand all attestors in go-witness and how to use them effectively."}, {"role": "user", "content": "How do I create a multi-step witness policy for a build \u2192 test \u2192 package pipeline?"}, {"role": "assistant", "content": "Here's a complete multi-step witness policy for your pipeline:\n\n**Policy Document:**\n```json\n{\n  \"expires\": \"2026-11-08T10:52:59Z\",\n  \"publickeys\": {\n    \"ci-key\": {\n      \"keyid\": \"sha256:b792be081f578b7743ec5916a683303e241692f530fee3ab21a3631aa99826fa\",\n      \"key\": \"-----BEGIN PUBLIC KEY-----\\n...\\n-----END PUBLIC KEY-----\"\n    }\n  },\n  \"steps\": {\n    \"build\": {\n      \"name\": \"build\",\n      \"attestations\": [\n        {\n          \"type\": \"https://witness.dev/attestations/git/v0.1\"\n        },\n        {\n          \"type\": \"https://witness.dev/attestations/command-run/v0.1\"\n        },\n        {\n          \"type\": \"https://witness.dev/attestations/product/v0.1\"\n        }\n      ],\n      \"functionaries\": [\n        {\n          \"type\": \"publickey\",\n          \"publickeyid\": \"ci-key\"\n        }\n      ]\n    },\n    \"test\": {\n      \"name\": \"test\",\n      \"attestations\": [\n        {\n          \"type\": \"https://witness.dev/attestations/material/v0.1\"\n        },\n        {\n          \"type\": \"https://witness.dev/attestations/command-run/v0.1\"\n        }\n      ],\n      \"functionaries\": [\n        {\n          \"type\": \"publickey\",\n          \"publickeyid\": \"ci-key\"\n        }\n      ]\n    },\n    \"package\": {\n      \"name\": \"package\",\n      \"attestations\": [\n        {\n          \"type\": \"https://witness.dev/attestations/material/v0.1\"\n        },\n        {\n          \"type\": \"https://witness.dev/attestations/product/v0.1\"\n        }\n      ],\n      \"functionaries\": [\n        {\n          \"type\": \"publickey\",\n          \"publickeyid\": \"ci-key\"\n        }\n      ]\n    }\n  }\n}\n```\n\n**Pipeline Commands:**\n\n```bash\n# Step 1: Build\nwitness run --step build \\\n  --attestations git,commandrun,product \\\n  -o build.json --key ci-key.pem \\\n  -- go build -o myapp\n\n# Step 2: Test\nwitness run --step test \\\n  --attestations material,commandrun \\\n  -o test.json --key ci-key.pem \\\n  -- go test ./...\n\n# Step 3: Package\nwitness run --step package \\\n  --attestations material,product \\\n  -o package.json --key ci-key.pem \\\n  -- tar czf myapp.tar.gz myapp\n\n# Verify entire pipeline\nwitness verify \\\n  --policy policy-signed.json \\\n  --publickey policy-key.pub \\\n  -a build.json -a test.json -a package.json\n```\n"}]}
{"messages": [{"role": "system", "content": "You are an expert in the Witness supply chain attestation framework. You help users instrument CI/CD pipelines with witness, create policy documents, and write Rego policies to validate attestations. You understand all attestors in go-witness and how to use them effectively."}, {"role": "user", "content": "How do I create a witness policy for a build step that uses these attestors: material?"}, {"role": "assistant", "content": "Here's a complete witness policy for your build step with material attestors:\n\n**Policy Document:**\n```json\n{\n  \"expires\": \"2026-11-08T10:52:59Z\",\n  \"publickeys\": {\n    \"build-key\": {\n      \"keyid\": \"sha256:fcee1a7c2eb0db8dbfaa3f2a4056363cc29abad820053eeffa6972ed23308e56\",\n      \"key\": \"-----BEGIN PUBLIC KEY-----\\n...\\n-----END PUBLIC KEY-----\"\n    }\n  },\n  \"steps\": {\n    \"build\": {\n      \"name\": \"build\",\n      \"attestations\": [\n        {\n          \"type\": \"https://witness.dev/attestations/material/v0.1\"\n        }\n      ],\n      \"functionaries\": [\n        {\n          \"type\": \"publickey\",\n          \"publickeyid\": \"build-key\"\n        }\n      ]\n    }\n  }\n}\n```\n\n**Witness Run Command:**\n```bash\nwitness run --step build \\\n  --attestations material \\\n  --outfile build-attestation.json \\\n  --key signing-key.pem \\\n  -- <your-build-command>\n```\n\n**Rego Validation Rules:**\n```rego\n\n```\n\n**Verification:**\n```bash\nwitness verify \\\n  --policy policy-signed.json \\\n  --publickey policy-key.pub \\\n  -a build-attestation.json \\\n  --subject <artifact>\n```\n"}]}
{"messages": [{"role": "system", "content": "You are an expert in the Witness supply chain attestation framework. You help users instrument CI/CD pipelines with witness, create policy documents, and write Rego policies to validate attestations. You understand all attestors in go-witness and how to use them effectively."}, {"role": "user", "content": "How do I create a witness policy for a build step that uses these attestors: material, git?"}, {"role": "assistant", "content": "Here's a complete witness policy for your build step with material, git attestors:\n\n**Policy Document:**\n```json\n{\n  \"expires\": \"2026-11-08T10:52:59Z\",\n  \"publickeys\": {\n    \"build-key\": {\n      \"keyid\": \"sha256:e941f3c87ca72884384eafa55babf77001a98f6a0ba520c3f6dbacf9f320db26\",\n      \"key\": \"-----BEGIN PUBLIC KEY-----\\n...\\n-----END PUBLIC KEY-----\"\n    }\n  },\n  \"steps\": {\n    \"build\": {\n      \"name\": \"build\",\n      \"attestations\": [\n        {\n          \"type\": \"https://witness.dev/attestations/material/v0.1\"\n        },\n        {\n          \"type\": \"https://witness.dev/attestations/git/v0.1\"\n        }\n      ],\n      \"functionaries\": [\n        {\n          \"type\": \"publickey\",\n          \"publickeyid\": \"build-key\"\n        }\n      ]\n    }\n  }\n}\n```\n\n**Witness Run Command:**\n```bash\nwitness run --step build \\\n  --attestations material,git \\\n  --outfile build-attestation.json \\\n  --key signing-key.pem \\\n  -- <your-build-command>\n```\n\n**Rego Validation Rules:**\n```rego\n\n```\n\n**Verification:**\n```bash\nwitness verify \\\n  --policy policy-signed.json \\\n  --publickey policy-key.pub \\\n  -a build-attestation.json \\\n  --subject <artifact>\n```\n"}]}
{"messages": [{"role": "system", "content": "You are an expert in the Witness supply chain attestation framework. You help users instrument CI/CD pipelines with witness, create policy documents, and write Rego policies to validate attestations. You understand all attestors in go-witness and how to use them effectively."}, {"role": "user", "content": "How do I create a witness policy for a build step that uses these attestors: git, environment?"}, {"role": "assistant", "content": "Here's a complete witness policy for your build step with git, environment attestors:\n\n**Policy Document:**\n```json\n{\n  \"expires\": \"2026-11-08T10:52:59Z\",\n  \"publickeys\": {\n    \"build-key\": {\n      \"keyid\": \"sha256:e599eba4e61392ec00893484e820f6c8f2fff776b8019a3d954e0c9272656c36\",\n      \"key\": \"-----BEGIN PUBLIC KEY-----\\n...\\n-----END PUBLIC KEY-----\"\n    }\n  },\n  \"steps\": {\n    \"build\": {\n      \"name\": \"build\",\n      \"attestations\": [\n        {\n          \"type\": \"https://witness.dev/attestations/git/v0.1\"\n        },\n        {\n          \"type\": \"https://witness.dev/attestations/environment/v0.1\"\n        }\n      ],\n      \"functionaries\": [\n        {\n          \"type\": \"publickey\",\n          \"publickeyid\": \"build-key\"\n        }\n      ]\n    }\n  }\n}\n```\n\n**Witness Run Command:**\n```bash\nwitness run --step build \\\n  --attestations git,environment \\\n  --outfile build-attestation.json \\\n  --key signing-key.pem \\\n  -- <your-build-command>\n```\n\n**Rego Validation Rules:**\n```rego\npackage git\n\nimport rego.v1\n\n# Enforce builds from specific branch\ndeny contains msg if {\n    input.branch != \"feature/auth\"\n    msg := sprintf(\"Must build from feature/auth branch, got: %s\", [input.branch])\n}\n\n# Require clean working directory\ndeny contains msg if {\n    count(input.status) > 0\n    msg := \"Working directory must be clean (no uncommitted changes)\"\n}\n\n# Validate commit author\napproved_authors := {\n    \"alice.smith@example.com\",\n    \"bob.jones@company.com\",\n    \"ci-bot@company.com\"\n}\n\ndeny contains msg if {\n    not input.authoremail in approved_authors\n    msg := sprintf(\"Unauthorized commit author: %s\", [input.authoremail])\n}\n```\n\n**Verification:**\n```bash\nwitness verify \\\n  --policy policy-signed.json \\\n  --publickey policy-key.pub \\\n  -a build-attestation.json \\\n  --subject <artifact>\n```\n"}]}
{"messages": [{"role": "system", "content": "You are an expert in the Witness supply chain attestation framework. You help users instrument CI/CD pipelines with witness, create policy documents, and write Rego policies to validate attestations. You understand all attestors in go-witness and how to use them effectively."}, {"role": "user", "content": "How do I create a witness policy for a build step that uses these attestors: environment, git, github, commandrun?"}, {"role": "assistant", "content": "Here's a complete witness policy for your build step with environment, git, github, commandrun attestors:\n\n**Policy Document:**\n```json\n{\n  \"expires\": \"2026-11-08T10:52:59Z\",\n  \"publickeys\": {\n    \"build-key\": {\n      \"keyid\": \"sha256:fb1aa838c442092d25fca9ee1aa53d03f4873b9ff4d751ba525f6663051cf712\",\n      \"key\": \"-----BEGIN PUBLIC KEY-----\\n...\\n-----END PUBLIC KEY-----\"\n    }\n  },\n  \"steps\": {\n    \"build\": {\n      \"name\": \"build\",\n      \"attestations\": [\n        {\n          \"type\": \"https://witness.dev/attestations/environment/v0.1\"\n        },\n        {\n          \"type\": \"https://witness.dev/attestations/git/v0.1\"\n        },\n        {\n          \"type\": \"https://witness.dev/attestations/github/v0.1\"\n        },\n        {\n          \"type\": \"https://witness.dev/attestations/command-run/v0.1\"\n        }\n      ],\n      \"functionaries\": [\n        {\n          \"type\": \"publickey\",\n          \"publickeyid\": \"build-key\"\n        }\n      ]\n    }\n  }\n}\n```\n\n**Witness Run Command:**\n```bash\nwitness run --step build \\\n  --attestations environment,git,github,commandrun \\\n  --outfile build-attestation.json \\\n  --key signing-key.pem \\\n  -- <your-build-command>\n```\n\n**Rego Validation Rules:**\n```rego\npackage environment\n\nimport rego.v1\n\n# Ensure correct OS\ndeny contains msg if {\n    input.os != \"darwin\"\n    msg := sprintf(\"Must run on darwin, got: %s\", [input.os])\n}\n\n# Require CI environment\ndeny contains msg if {\n    not \"CI\" in input.variables\n    msg := \"Must run in CI environment (CI variable not set)\"\n}\n```\n\n**Verification:**\n```bash\nwitness verify \\\n  --policy policy-signed.json \\\n  --publickey policy-key.pub \\\n  -a build-attestation.json \\\n  --subject <artifact>\n```\n"}]}
{"messages": [{"role": "system", "content": "You are an expert in the Witness supply chain attestation framework. You help users instrument CI/CD pipelines with witness, create policy documents, and write Rego policies to validate attestations. You understand all attestors in go-witness and how to use them effectively."}, {"role": "user", "content": "How do I create a witness policy for a build step that uses these attestors: git, commandrun, product?"}, {"role": "assistant", "content": "Here's a complete witness policy for your build step with git, commandrun, product attestors:\n\n**Policy Document:**\n```json\n{\n  \"expires\": \"2026-11-08T10:52:59Z\",\n  \"publickeys\": {\n    \"build-key\": {\n      \"keyid\": \"sha256:2400a7177627f17f0c3ee948ce07582dccf690dc6ae10478ad686ea259ebee43\",\n      \"key\": \"-----BEGIN PUBLIC KEY-----\\n...\\n-----END PUBLIC KEY-----\"\n    }\n  },\n  \"steps\": {\n    \"build\": {\n      \"name\": \"build\",\n      \"attestations\": [\n        {\n          \"type\": \"https://witness.dev/attestations/git/v0.1\"\n        },\n        {\n          \"type\": \"https://witness.dev/attestations/command-run/v0.1\"\n        },\n        {\n          \"type\": \"https://witness.dev/attestations/product/v0.1\"\n        }\n      ],\n      \"functionaries\": [\n        {\n          \"type\": \"publickey\",\n          \"publickeyid\": \"build-key\"\n        }\n      ]\n    }\n  }\n}\n```\n\n**Witness Run Command:**\n```bash\nwitness run --step build \\\n  --attestations git,commandrun,product \\\n  --outfile build-attestation.json \\\n  --key signing-key.pem \\\n  -- <your-build-command>\n```\n\n**Rego Validation Rules:**\n```rego\npackage git\n\nimport rego.v1\n\n# Enforce builds from specific branch\ndeny contains msg if {\n    input.branch != \"bugfix/security\"\n    msg := sprintf(\"Must build from bugfix/security branch, got: %s\", [input.branch])\n}\n\n# Require clean working directory\ndeny contains msg if {\n    count(input.status) > 0\n    msg := \"Working directory must be clean (no uncommitted changes)\"\n}\n\n# Validate commit author\napproved_authors := {\n    \"alice.smith@example.com\",\n    \"bob.jones@company.com\",\n    \"ci-bot@company.com\"\n}\n\ndeny contains msg if {\n    not input.authoremail in approved_authors\n    msg := sprintf(\"Unauthorized commit author: %s\", [input.authoremail])\n}\n```\n\n**Verification:**\n```bash\nwitness verify \\\n  --policy policy-signed.json \\\n  --publickey policy-key.pub \\\n  -a build-attestation.json \\\n  --subject <artifact>\n```\n"}]}
{"messages": [{"role": "system", "content": "You are an expert in the Witness supply chain attestation framework. You help users instrument CI/CD pipelines with witness, create policy documents, and write Rego policies to validate attestations. You understand all attestors in go-witness and how to use them effectively."}, {"role": "user", "content": "How do I create a witness policy for a build step that uses these attestors: commandrun, git, product, environment?"}, {"role": "assistant", "content": "Here's a complete witness policy for your build step with commandrun, git, product, environment attestors:\n\n**Policy Document:**\n```json\n{\n  \"expires\": \"2026-11-08T10:52:59Z\",\n  \"publickeys\": {\n    \"build-key\": {\n      \"keyid\": \"sha256:b79e3e700178f9114bc934224fa5ee97a276e603e39f55a3dbb6a28190220c2d\",\n      \"key\": \"-----BEGIN PUBLIC KEY-----\\n...\\n-----END PUBLIC KEY-----\"\n    }\n  },\n  \"steps\": {\n    \"build\": {\n      \"name\": \"build\",\n      \"attestations\": [\n        {\n          \"type\": \"https://witness.dev/attestations/command-run/v0.1\"\n        },\n        {\n          \"type\": \"https://witness.dev/attestations/git/v0.1\"\n        },\n        {\n          \"type\": \"https://witness.dev/attestations/product/v0.1\"\n        },\n        {\n          \"type\": \"https://witness.dev/attestations/environment/v0.1\"\n        }\n      ],\n      \"functionaries\": [\n        {\n          \"type\": \"publickey\",\n          \"publickeyid\": \"build-key\"\n        }\n      ]\n    }\n  }\n}\n```\n\n**Witness Run Command:**\n```bash\nwitness run --step build \\\n  --attestations commandrun,git,product,environment \\\n  --outfile build-attestation.json \\\n  --key signing-key.pem \\\n  -- <your-build-command>\n```\n\n**Rego Validation Rules:**\n```rego\n\n```\n\n**Verification:**\n```bash\nwitness verify \\\n  --policy policy-signed.json \\\n  --publickey policy-key.pub \\\n  -a build-attestation.json \\\n  --subject <artifact>\n```\n"}]}
{"messages": [{"role": "system", "content": "You are an expert in the Witness supply chain attestation framework. You help users instrument CI/CD pipelines with witness, create policy documents, and write Rego policies to validate attestations. You understand all attestors in go-witness and how to use them effectively."}, {"role": "user", "content": "How do I create a multi-step witness policy for a build \u2192 test \u2192 package pipeline?"}, {"role": "assistant", "content": "Here's a complete multi-step witness policy for your pipeline:\n\n**Policy Document:**\n```json\n{\n  \"expires\": \"2026-11-08T10:52:59Z\",\n  \"publickeys\": {\n    \"ci-key\": {\n      \"keyid\": \"sha256:1f210daadec30c961833f9420436b6e964b803282fff11a86c065e841333aa9a\",\n      \"key\": \"-----BEGIN PUBLIC KEY-----\\n...\\n-----END PUBLIC KEY-----\"\n    }\n  },\n  \"steps\": {\n    \"build\": {\n      \"name\": \"build\",\n      \"attestations\": [\n        {\n          \"type\": \"https://witness.dev/attestations/git/v0.1\"\n        },\n        {\n          \"type\": \"https://witness.dev/attestations/command-run/v0.1\"\n        },\n        {\n          \"type\": \"https://witness.dev/attestations/product/v0.1\"\n        }\n      ],\n      \"functionaries\": [\n        {\n          \"type\": \"publickey\",\n          \"publickeyid\": \"ci-key\"\n        }\n      ]\n    },\n    \"test\": {\n      \"name\": \"test\",\n      \"attestations\": [\n        {\n          \"type\": \"https://witness.dev/attestations/material/v0.1\"\n        },\n        {\n          \"type\": \"https://witness.dev/attestations/command-run/v0.1\"\n        }\n      ],\n      \"functionaries\": [\n        {\n          \"type\": \"publickey\",\n          \"publickeyid\": \"ci-key\"\n        }\n      ]\n    },\n    \"package\": {\n      \"name\": \"package\",\n      \"attestations\": [\n        {\n          \"type\": \"https://witness.dev/attestations/material/v0.1\"\n        },\n        {\n          \"type\": \"https://witness.dev/attestations/product/v0.1\"\n        }\n      ],\n      \"functionaries\": [\n        {\n          \"type\": \"publickey\",\n          \"publickeyid\": \"ci-key\"\n        }\n      ]\n    }\n  }\n}\n```\n\n**Pipeline Commands:**\n\n```bash\n# Step 1: Build\nwitness run --step build \\\n  --attestations git,commandrun,product \\\n  -o build.json --key ci-key.pem \\\n  -- go build -o myapp\n\n# Step 2: Test\nwitness run --step test \\\n  --attestations material,commandrun \\\n  -o test.json --key ci-key.pem \\\n  -- go test ./...\n\n# Step 3: Package\nwitness run --step package \\\n  --attestations material,product \\\n  -o package.json --key ci-key.pem \\\n  -- tar czf myapp.tar.gz myapp\n\n# Verify entire pipeline\nwitness verify \\\n  --policy policy-signed.json \\\n  --publickey policy-key.pub \\\n  -a build.json -a test.json -a package.json\n```\n"}]}
{"messages": [{"role": "system", "content": "You are an expert in the Witness supply chain attestation framework. You help users instrument CI/CD pipelines with witness, create policy documents, and write Rego policies to validate attestations. You understand all attestors in go-witness and how to use them effectively."}, {"role": "user", "content": "How do I create a multi-step witness policy for a build \u2192 test \u2192 package pipeline?"}, {"role": "assistant", "content": "Here's a complete multi-step witness policy for your pipeline:\n\n**Policy Document:**\n```json\n{\n  \"expires\": \"2026-11-08T10:52:59Z\",\n  \"publickeys\": {\n    \"ci-key\": {\n      \"keyid\": \"sha256:12a020d0079f3a222bc0ac43eb1c1ee0cf34d55b80294b3625ae43d16477e55c\",\n      \"key\": \"-----BEGIN PUBLIC KEY-----\\n...\\n-----END PUBLIC KEY-----\"\n    }\n  },\n  \"steps\": {\n    \"build\": {\n      \"name\": \"build\",\n      \"attestations\": [\n        {\n          \"type\": \"https://witness.dev/attestations/git/v0.1\"\n        },\n        {\n          \"type\": \"https://witness.dev/attestations/command-run/v0.1\"\n        },\n        {\n          \"type\": \"https://witness.dev/attestations/product/v0.1\"\n        }\n      ],\n      \"functionaries\": [\n        {\n          \"type\": \"publickey\",\n          \"publickeyid\": \"ci-key\"\n        }\n      ]\n    },\n    \"test\": {\n      \"name\": \"test\",\n      \"attestations\": [\n        {\n          \"type\": \"https://witness.dev/attestations/material/v0.1\"\n        },\n        {\n          \"type\": \"https://witness.dev/attestations/command-run/v0.1\"\n        }\n      ],\n      \"functionaries\": [\n        {\n          \"type\": \"publickey\",\n          \"publickeyid\": \"ci-key\"\n        }\n      ]\n    },\n    \"package\": {\n      \"name\": \"package\",\n      \"attestations\": [\n        {\n          \"type\": \"https://witness.dev/attestations/material/v0.1\"\n        },\n        {\n          \"type\": \"https://witness.dev/attestations/product/v0.1\"\n        }\n      ],\n      \"functionaries\": [\n        {\n          \"type\": \"publickey\",\n          \"publickeyid\": \"ci-key\"\n        }\n      ]\n    }\n  }\n}\n```\n\n**Pipeline Commands:**\n\n```bash\n# Step 1: Build\nwitness run --step build \\\n  --attestations git,commandrun,product \\\n  -o build.json --key ci-key.pem \\\n  -- go build -o myapp\n\n# Step 2: Test\nwitness run --step test \\\n  --attestations material,commandrun \\\n  -o test.json --key ci-key.pem \\\n  -- go test ./...\n\n# Step 3: Package\nwitness run --step package \\\n  --attestations material,product \\\n  -o package.json --key ci-key.pem \\\n  -- tar czf myapp.tar.gz myapp\n\n# Verify entire pipeline\nwitness verify \\\n  --policy policy-signed.json \\\n  --publickey policy-key.pub \\\n  -a build.json -a test.json -a package.json\n```\n"}]}
{"messages": [{"role": "system", "content": "You are an expert in the Witness supply chain attestation framework. You help users instrument CI/CD pipelines with witness, create policy documents, and write Rego policies to validate attestations. You understand all attestors in go-witness and how to use them effectively."}, {"role": "user", "content": "How do I create a witness policy for a build step that uses these attestors: commandrun, github, git, environment?"}, {"role": "assistant", "content": "Here's a complete witness policy for your build step with commandrun, github, git, environment attestors:\n\n**Policy Document:**\n```json\n{\n  \"expires\": \"2026-11-08T10:52:59Z\",\n  \"publickeys\": {\n    \"build-key\": {\n      \"keyid\": \"sha256:d8f256727b3eb03564b5125b4f0bb49b42ca9382ac7fba0c40c9bcfbdeeea9eb\",\n      \"key\": \"-----BEGIN PUBLIC KEY-----\\n...\\n-----END PUBLIC KEY-----\"\n    }\n  },\n  \"steps\": {\n    \"build\": {\n      \"name\": \"build\",\n      \"attestations\": [\n        {\n          \"type\": \"https://witness.dev/attestations/command-run/v0.1\"\n        },\n        {\n          \"type\": \"https://witness.dev/attestations/github/v0.1\"\n        },\n        {\n          \"type\": \"https://witness.dev/attestations/git/v0.1\"\n        },\n        {\n          \"type\": \"https://witness.dev/attestations/environment/v0.1\"\n        }\n      ],\n      \"functionaries\": [\n        {\n          \"type\": \"publickey\",\n          \"publickeyid\": \"build-key\"\n        }\n      ]\n    }\n  }\n}\n```\n\n**Witness Run Command:**\n```bash\nwitness run --step build \\\n  --attestations commandrun,github,git,environment \\\n  --outfile build-attestation.json \\\n  --key signing-key.pem \\\n  -- <your-build-command>\n```\n\n**Rego Validation Rules:**\n```rego\n\n```\n\n**Verification:**\n```bash\nwitness verify \\\n  --policy policy-signed.json \\\n  --publickey policy-key.pub \\\n  -a build-attestation.json \\\n  --subject <artifact>\n```\n"}]}
{"messages": [{"role": "system", "content": "You are an expert in the Witness supply chain attestation framework. You help users instrument CI/CD pipelines with witness, create policy documents, and write Rego policies to validate attestations. You understand all attestors in go-witness and how to use them effectively."}, {"role": "user", "content": "How do I create a witness policy for a build step that uses these attestors: github, material, commandrun, git?"}, {"role": "assistant", "content": "Here's a complete witness policy for your build step with github, material, commandrun, git attestors:\n\n**Policy Document:**\n```json\n{\n  \"expires\": \"2026-11-08T10:52:59Z\",\n  \"publickeys\": {\n    \"build-key\": {\n      \"keyid\": \"sha256:2afdb152e6adfd1400a93332fd62fc0374ad7ec3d4e43d0e7aff7dc8752e71f5\",\n      \"key\": \"-----BEGIN PUBLIC KEY-----\\n...\\n-----END PUBLIC KEY-----\"\n    }\n  },\n  \"steps\": {\n    \"build\": {\n      \"name\": \"build\",\n      \"attestations\": [\n        {\n          \"type\": \"https://witness.dev/attestations/github/v0.1\"\n        },\n        {\n          \"type\": \"https://witness.dev/attestations/material/v0.1\"\n        },\n        {\n          \"type\": \"https://witness.dev/attestations/command-run/v0.1\"\n        },\n        {\n          \"type\": \"https://witness.dev/attestations/git/v0.1\"\n        }\n      ],\n      \"functionaries\": [\n        {\n          \"type\": \"publickey\",\n          \"publickeyid\": \"build-key\"\n        }\n      ]\n    }\n  }\n}\n```\n\n**Witness Run Command:**\n```bash\nwitness run --step build \\\n  --attestations github,material,commandrun,git \\\n  --outfile build-attestation.json \\\n  --key signing-key.pem \\\n  -- <your-build-command>\n```\n\n**Rego Validation Rules:**\n```rego\n\n```\n\n**Verification:**\n```bash\nwitness verify \\\n  --policy policy-signed.json \\\n  --publickey policy-key.pub \\\n  -a build-attestation.json \\\n  --subject <artifact>\n```\n"}]}
{"messages": [{"role": "system", "content": "You are an expert in the Witness supply chain attestation framework. You help users instrument CI/CD pipelines with witness, create policy documents, and write Rego policies to validate attestations. You understand all attestors in go-witness and how to use them effectively."}, {"role": "user", "content": "How do I create a multi-step witness policy for a build \u2192 test \u2192 package pipeline?"}, {"role": "assistant", "content": "Here's a complete multi-step witness policy for your pipeline:\n\n**Policy Document:**\n```json\n{\n  \"expires\": \"2026-11-08T10:52:59Z\",\n  \"publickeys\": {\n    \"ci-key\": {\n      \"keyid\": \"sha256:1fd2c4464fb26318b49c1d26b93fa5654f82e29233efe263e11287356224f4ad\",\n      \"key\": \"-----BEGIN PUBLIC KEY-----\\n...\\n-----END PUBLIC KEY-----\"\n    }\n  },\n  \"steps\": {\n    \"build\": {\n      \"name\": \"build\",\n      \"attestations\": [\n        {\n          \"type\": \"https://witness.dev/attestations/git/v0.1\"\n        },\n        {\n          \"type\": \"https://witness.dev/attestations/command-run/v0.1\"\n        },\n        {\n          \"type\": \"https://witness.dev/attestations/product/v0.1\"\n        }\n      ],\n      \"functionaries\": [\n        {\n          \"type\": \"publickey\",\n          \"publickeyid\": \"ci-key\"\n        }\n      ]\n    },\n    \"test\": {\n      \"name\": \"test\",\n      \"attestations\": [\n        {\n          \"type\": \"https://witness.dev/attestations/material/v0.1\"\n        },\n        {\n          \"type\": \"https://witness.dev/attestations/command-run/v0.1\"\n        }\n      ],\n      \"functionaries\": [\n        {\n          \"type\": \"publickey\",\n          \"publickeyid\": \"ci-key\"\n        }\n      ]\n    },\n    \"package\": {\n      \"name\": \"package\",\n      \"attestations\": [\n        {\n          \"type\": \"https://witness.dev/attestations/material/v0.1\"\n        },\n        {\n          \"type\": \"https://witness.dev/attestations/product/v0.1\"\n        }\n      ],\n      \"functionaries\": [\n        {\n          \"type\": \"publickey\",\n          \"publickeyid\": \"ci-key\"\n        }\n      ]\n    }\n  }\n}\n```\n\n**Pipeline Commands:**\n\n```bash\n# Step 1: Build\nwitness run --step build \\\n  --attestations git,commandrun,product \\\n  -o build.json --key ci-key.pem \\\n  -- go build -o myapp\n\n# Step 2: Test\nwitness run --step test \\\n  --attestations material,commandrun \\\n  -o test.json --key ci-key.pem \\\n  -- go test ./...\n\n# Step 3: Package\nwitness run --step package \\\n  --attestations material,product \\\n  -o package.json --key ci-key.pem \\\n  -- tar czf myapp.tar.gz myapp\n\n# Verify entire pipeline\nwitness verify \\\n  --policy policy-signed.json \\\n  --publickey policy-key.pub \\\n  -a build.json -a test.json -a package.json\n```\n"}]}
{"messages": [{"role": "system", "content": "You are an expert in the Witness supply chain attestation framework. You help users instrument CI/CD pipelines with witness, create policy documents, and write Rego policies to validate attestations. You understand all attestors in go-witness and how to use them effectively."}, {"role": "user", "content": "How do I create a multi-step witness policy for a build \u2192 test \u2192 package pipeline?"}, {"role": "assistant", "content": "Here's a complete multi-step witness policy for your pipeline:\n\n**Policy Document:**\n```json\n{\n  \"expires\": \"2026-11-08T10:52:59Z\",\n  \"publickeys\": {\n    \"ci-key\": {\n      \"keyid\": \"sha256:265252816aa5bd6a2f901fa8891f2dfecc932c8ddf9f922ea32971689fabfc90\",\n      \"key\": \"-----BEGIN PUBLIC KEY-----\\n...\\n-----END PUBLIC KEY-----\"\n    }\n  },\n  \"steps\": {\n    \"build\": {\n      \"name\": \"build\",\n      \"attestations\": [\n        {\n          \"type\": \"https://witness.dev/attestations/git/v0.1\"\n        },\n        {\n          \"type\": \"https://witness.dev/attestations/command-run/v0.1\"\n        },\n        {\n          \"type\": \"https://witness.dev/attestations/product/v0.1\"\n        }\n      ],\n      \"functionaries\": [\n        {\n          \"type\": \"publickey\",\n          \"publickeyid\": \"ci-key\"\n        }\n      ]\n    },\n    \"test\": {\n      \"name\": \"test\",\n      \"attestations\": [\n        {\n          \"type\": \"https://witness.dev/attestations/material/v0.1\"\n        },\n        {\n          \"type\": \"https://witness.dev/attestations/command-run/v0.1\"\n        }\n      ],\n      \"functionaries\": [\n        {\n          \"type\": \"publickey\",\n          \"publickeyid\": \"ci-key\"\n        }\n      ]\n    },\n    \"package\": {\n      \"name\": \"package\",\n      \"attestations\": [\n        {\n          \"type\": \"https://witness.dev/attestations/material/v0.1\"\n        },\n        {\n          \"type\": \"https://witness.dev/attestations/product/v0.1\"\n        }\n      ],\n      \"functionaries\": [\n        {\n          \"type\": \"publickey\",\n          \"publickeyid\": \"ci-key\"\n        }\n      ]\n    }\n  }\n}\n```\n\n**Pipeline Commands:**\n\n```bash\n# Step 1: Build\nwitness run --step build \\\n  --attestations git,commandrun,product \\\n  -o build.json --key ci-key.pem \\\n  -- go build -o myapp\n\n# Step 2: Test\nwitness run --step test \\\n  --attestations material,commandrun \\\n  -o test.json --key ci-key.pem \\\n  -- go test ./...\n\n# Step 3: Package\nwitness run --step package \\\n  --attestations material,product \\\n  -o package.json --key ci-key.pem \\\n  -- tar czf myapp.tar.gz myapp\n\n# Verify entire pipeline\nwitness verify \\\n  --policy policy-signed.json \\\n  --publickey policy-key.pub \\\n  -a build.json -a test.json -a package.json\n```\n"}]}
{"messages": [{"role": "system", "content": "You are an expert in the Witness supply chain attestation framework. You help users instrument CI/CD pipelines with witness, create policy documents, and write Rego policies to validate attestations. You understand all attestors in go-witness and how to use them effectively."}, {"role": "user", "content": "How do I create a witness policy for a build step that uses these attestors: product, environment?"}, {"role": "assistant", "content": "Here's a complete witness policy for your build step with product, environment attestors:\n\n**Policy Document:**\n```json\n{\n  \"expires\": \"2026-11-08T10:52:59Z\",\n  \"publickeys\": {\n    \"build-key\": {\n      \"keyid\": \"sha256:24d5976276b8fd38c27698967ba8c51f7e9d110872073167ccea51e6ec10d36b\",\n      \"key\": \"-----BEGIN PUBLIC KEY-----\\n...\\n-----END PUBLIC KEY-----\"\n    }\n  },\n  \"steps\": {\n    \"build\": {\n      \"name\": \"build\",\n      \"attestations\": [\n        {\n          \"type\": \"https://witness.dev/attestations/product/v0.1\"\n        },\n        {\n          \"type\": \"https://witness.dev/attestations/environment/v0.1\"\n        }\n      ],\n      \"functionaries\": [\n        {\n          \"type\": \"publickey\",\n          \"publickeyid\": \"build-key\"\n        }\n      ]\n    }\n  }\n}\n```\n\n**Witness Run Command:**\n```bash\nwitness run --step build \\\n  --attestations product,environment \\\n  --outfile build-attestation.json \\\n  --key signing-key.pem \\\n  -- <your-build-command>\n```\n\n**Rego Validation Rules:**\n```rego\n\n```\n\n**Verification:**\n```bash\nwitness verify \\\n  --policy policy-signed.json \\\n  --publickey policy-key.pub \\\n  -a build-attestation.json \\\n  --subject <artifact>\n```\n"}]}
{"messages": [{"role": "system", "content": "You are an expert in the Witness supply chain attestation framework. You help users instrument CI/CD pipelines with witness, create policy documents, and write Rego policies to validate attestations. You understand all attestors in go-witness and how to use them effectively."}, {"role": "user", "content": "How do I create a witness policy for a build step that uses these attestors: environment, github?"}, {"role": "assistant", "content": "Here's a complete witness policy for your build step with environment, github attestors:\n\n**Policy Document:**\n```json\n{\n  \"expires\": \"2026-11-08T10:52:59Z\",\n  \"publickeys\": {\n    \"build-key\": {\n      \"keyid\": \"sha256:6fd2da4ca7dfaa49802dd0c4a2662450924cc1ce04e010972da258a7303254fb\",\n      \"key\": \"-----BEGIN PUBLIC KEY-----\\n...\\n-----END PUBLIC KEY-----\"\n    }\n  },\n  \"steps\": {\n    \"build\": {\n      \"name\": \"build\",\n      \"attestations\": [\n        {\n          \"type\": \"https://witness.dev/attestations/environment/v0.1\"\n        },\n        {\n          \"type\": \"https://witness.dev/attestations/github/v0.1\"\n        }\n      ],\n      \"functionaries\": [\n        {\n          \"type\": \"publickey\",\n          \"publickeyid\": \"build-key\"\n        }\n      ]\n    }\n  }\n}\n```\n\n**Witness Run Command:**\n```bash\nwitness run --step build \\\n  --attestations environment,github \\\n  --outfile build-attestation.json \\\n  --key signing-key.pem \\\n  -- <your-build-command>\n```\n\n**Rego Validation Rules:**\n```rego\npackage environment\n\nimport rego.v1\n\n# Ensure correct OS\ndeny contains msg if {\n    input.os != \"windows\"\n    msg := sprintf(\"Must run on windows, got: %s\", [input.os])\n}\n\n# Require CI environment\ndeny contains msg if {\n    not \"CI\" in input.variables\n    msg := \"Must run in CI environment (CI variable not set)\"\n}\n```\n\n**Verification:**\n```bash\nwitness verify \\\n  --policy policy-signed.json \\\n  --publickey policy-key.pub \\\n  -a build-attestation.json \\\n  --subject <artifact>\n```\n"}]}
{"messages": [{"role": "system", "content": "You are an expert in the Witness supply chain attestation framework. You help users instrument CI/CD pipelines with witness, create policy documents, and write Rego policies to validate attestations. You understand all attestors in go-witness and how to use them effectively."}, {"role": "user", "content": "How do I create a multi-step witness policy for a build \u2192 test \u2192 package pipeline?"}, {"role": "assistant", "content": "Here's a complete multi-step witness policy for your pipeline:\n\n**Policy Document:**\n```json\n{\n  \"expires\": \"2026-11-08T10:52:59Z\",\n  \"publickeys\": {\n    \"ci-key\": {\n      \"keyid\": \"sha256:78804752de84307bcb1311352247a76fbc5e9102ac6f3c8d1f37801dde9a5dbc\",\n      \"key\": \"-----BEGIN PUBLIC KEY-----\\n...\\n-----END PUBLIC KEY-----\"\n    }\n  },\n  \"steps\": {\n    \"build\": {\n      \"name\": \"build\",\n      \"attestations\": [\n        {\n          \"type\": \"https://witness.dev/attestations/git/v0.1\"\n        },\n        {\n          \"type\": \"https://witness.dev/attestations/command-run/v0.1\"\n        },\n        {\n          \"type\": \"https://witness.dev/attestations/product/v0.1\"\n        }\n      ],\n      \"functionaries\": [\n        {\n          \"type\": \"publickey\",\n          \"publickeyid\": \"ci-key\"\n        }\n      ]\n    },\n    \"test\": {\n      \"name\": \"test\",\n      \"attestations\": [\n        {\n          \"type\": \"https://witness.dev/attestations/material/v0.1\"\n        },\n        {\n          \"type\": \"https://witness.dev/attestations/command-run/v0.1\"\n        }\n      ],\n      \"functionaries\": [\n        {\n          \"type\": \"publickey\",\n          \"publickeyid\": \"ci-key\"\n        }\n      ]\n    },\n    \"package\": {\n      \"name\": \"package\",\n      \"attestations\": [\n        {\n          \"type\": \"https://witness.dev/attestations/material/v0.1\"\n        },\n        {\n          \"type\": \"https://witness.dev/attestations/product/v0.1\"\n        }\n      ],\n      \"functionaries\": [\n        {\n          \"type\": \"publickey\",\n          \"publickeyid\": \"ci-key\"\n        }\n      ]\n    }\n  }\n}\n```\n\n**Pipeline Commands:**\n\n```bash\n# Step 1: Build\nwitness run --step build \\\n  --attestations git,commandrun,product \\\n  -o build.json --key ci-key.pem \\\n  -- go build -o myapp\n\n# Step 2: Test\nwitness run --step test \\\n  --attestations material,commandrun \\\n  -o test.json --key ci-key.pem \\\n  -- go test ./...\n\n# Step 3: Package\nwitness run --step package \\\n  --attestations material,product \\\n  -o package.json --key ci-key.pem \\\n  -- tar czf myapp.tar.gz myapp\n\n# Verify entire pipeline\nwitness verify \\\n  --policy policy-signed.json \\\n  --publickey policy-key.pub \\\n  -a build.json -a test.json -a package.json\n```\n"}]}
{"messages": [{"role": "system", "content": "You are an expert in the Witness supply chain attestation framework. You help users instrument CI/CD pipelines with witness, create policy documents, and write Rego policies to validate attestations. You understand all attestors in go-witness and how to use them effectively."}, {"role": "user", "content": "How do I create a multi-step witness policy for a build \u2192 test \u2192 package pipeline?"}, {"role": "assistant", "content": "Here's a complete multi-step witness policy for your pipeline:\n\n**Policy Document:**\n```json\n{\n  \"expires\": \"2026-11-08T10:52:59Z\",\n  \"publickeys\": {\n    \"ci-key\": {\n      \"keyid\": \"sha256:4626f8cd2be1afd672ef560ff0d67c41165b5c5135bc4378a919893ad3c8c362\",\n      \"key\": \"-----BEGIN PUBLIC KEY-----\\n...\\n-----END PUBLIC KEY-----\"\n    }\n  },\n  \"steps\": {\n    \"build\": {\n      \"name\": \"build\",\n      \"attestations\": [\n        {\n          \"type\": \"https://witness.dev/attestations/git/v0.1\"\n        },\n        {\n          \"type\": \"https://witness.dev/attestations/command-run/v0.1\"\n        },\n        {\n          \"type\": \"https://witness.dev/attestations/product/v0.1\"\n        }\n      ],\n      \"functionaries\": [\n        {\n          \"type\": \"publickey\",\n          \"publickeyid\": \"ci-key\"\n        }\n      ]\n    },\n    \"test\": {\n      \"name\": \"test\",\n      \"attestations\": [\n        {\n          \"type\": \"https://witness.dev/attestations/material/v0.1\"\n        },\n        {\n          \"type\": \"https://witness.dev/attestations/command-run/v0.1\"\n        }\n      ],\n      \"functionaries\": [\n        {\n          \"type\": \"publickey\",\n          \"publickeyid\": \"ci-key\"\n        }\n      ]\n    },\n    \"package\": {\n      \"name\": \"package\",\n      \"attestations\": [\n        {\n          \"type\": \"https://witness.dev/attestations/material/v0.1\"\n        },\n        {\n          \"type\": \"https://witness.dev/attestations/product/v0.1\"\n        }\n      ],\n      \"functionaries\": [\n        {\n          \"type\": \"publickey\",\n          \"publickeyid\": \"ci-key\"\n        }\n      ]\n    }\n  }\n}\n```\n\n**Pipeline Commands:**\n\n```bash\n# Step 1: Build\nwitness run --step build \\\n  --attestations git,commandrun,product \\\n  -o build.json --key ci-key.pem \\\n  -- go build -o myapp\n\n# Step 2: Test\nwitness run --step test \\\n  --attestations material,commandrun \\\n  -o test.json --key ci-key.pem \\\n  -- go test ./...\n\n# Step 3: Package\nwitness run --step package \\\n  --attestations material,product \\\n  -o package.json --key ci-key.pem \\\n  -- tar czf myapp.tar.gz myapp\n\n# Verify entire pipeline\nwitness verify \\\n  --policy policy-signed.json \\\n  --publickey policy-key.pub \\\n  -a build.json -a test.json -a package.json\n```\n"}]}
{"messages": [{"role": "system", "content": "You are an expert in the Witness supply chain attestation framework. You help users instrument CI/CD pipelines with witness, create policy documents, and write Rego policies to validate attestations. You understand all attestors in go-witness and how to use them effectively."}, {"role": "user", "content": "How do I create a witness policy for a build step that uses these attestors: product, git, material, github?"}, {"role": "assistant", "content": "Here's a complete witness policy for your build step with product, git, material, github attestors:\n\n**Policy Document:**\n```json\n{\n  \"expires\": \"2026-11-08T10:52:59Z\",\n  \"publickeys\": {\n    \"build-key\": {\n      \"keyid\": \"sha256:711205cb01bbb28b5ff8a9ec1772f7693d67858eb2e67aab642696d7bbc865dd\",\n      \"key\": \"-----BEGIN PUBLIC KEY-----\\n...\\n-----END PUBLIC KEY-----\"\n    }\n  },\n  \"steps\": {\n    \"build\": {\n      \"name\": \"build\",\n      \"attestations\": [\n        {\n          \"type\": \"https://witness.dev/attestations/product/v0.1\"\n        },\n        {\n          \"type\": \"https://witness.dev/attestations/git/v0.1\"\n        },\n        {\n          \"type\": \"https://witness.dev/attestations/material/v0.1\"\n        },\n        {\n          \"type\": \"https://witness.dev/attestations/github/v0.1\"\n        }\n      ],\n      \"functionaries\": [\n        {\n          \"type\": \"publickey\",\n          \"publickeyid\": \"build-key\"\n        }\n      ]\n    }\n  }\n}\n```\n\n**Witness Run Command:**\n```bash\nwitness run --step build \\\n  --attestations product,git,material,github \\\n  --outfile build-attestation.json \\\n  --key signing-key.pem \\\n  -- <your-build-command>\n```\n\n**Rego Validation Rules:**\n```rego\n\n```\n\n**Verification:**\n```bash\nwitness verify \\\n  --policy policy-signed.json \\\n  --publickey policy-key.pub \\\n  -a build-attestation.json \\\n  --subject <artifact>\n```\n"}]}
{"messages": [{"role": "system", "content": "You are an expert in the Witness supply chain attestation framework. You help users instrument CI/CD pipelines with witness, create policy documents, and write Rego policies to validate attestations. You understand all attestors in go-witness and how to use them effectively."}, {"role": "user", "content": "How do I create a multi-step witness policy for a build \u2192 test \u2192 package pipeline?"}, {"role": "assistant", "content": "Here's a complete multi-step witness policy for your pipeline:\n\n**Policy Document:**\n```json\n{\n  \"expires\": \"2026-11-08T10:52:59Z\",\n  \"publickeys\": {\n    \"ci-key\": {\n      \"keyid\": \"sha256:af9e732ab2d1ead9391de103b9956c1910055dd7514be01e46a203883acfa69e\",\n      \"key\": \"-----BEGIN PUBLIC KEY-----\\n...\\n-----END PUBLIC KEY-----\"\n    }\n  },\n  \"steps\": {\n    \"build\": {\n      \"name\": \"build\",\n      \"attestations\": [\n        {\n          \"type\": \"https://witness.dev/attestations/git/v0.1\"\n        },\n        {\n          \"type\": \"https://witness.dev/attestations/command-run/v0.1\"\n        },\n        {\n          \"type\": \"https://witness.dev/attestations/product/v0.1\"\n        }\n      ],\n      \"functionaries\": [\n        {\n          \"type\": \"publickey\",\n          \"publickeyid\": \"ci-key\"\n        }\n      ]\n    },\n    \"test\": {\n      \"name\": \"test\",\n      \"attestations\": [\n        {\n          \"type\": \"https://witness.dev/attestations/material/v0.1\"\n        },\n        {\n          \"type\": \"https://witness.dev/attestations/command-run/v0.1\"\n        }\n      ],\n      \"functionaries\": [\n        {\n          \"type\": \"publickey\",\n          \"publickeyid\": \"ci-key\"\n        }\n      ]\n    },\n    \"package\": {\n      \"name\": \"package\",\n      \"attestations\": [\n        {\n          \"type\": \"https://witness.dev/attestations/material/v0.1\"\n        },\n        {\n          \"type\": \"https://witness.dev/attestations/product/v0.1\"\n        }\n      ],\n      \"functionaries\": [\n        {\n          \"type\": \"publickey\",\n          \"publickeyid\": \"ci-key\"\n        }\n      ]\n    }\n  }\n}\n```\n\n**Pipeline Commands:**\n\n```bash\n# Step 1: Build\nwitness run --step build \\\n  --attestations git,commandrun,product \\\n  -o build.json --key ci-key.pem \\\n  -- go build -o myapp\n\n# Step 2: Test\nwitness run --step test \\\n  --attestations material,commandrun \\\n  -o test.json --key ci-key.pem \\\n  -- go test ./...\n\n# Step 3: Package\nwitness run --step package \\\n  --attestations material,product \\\n  -o package.json --key ci-key.pem \\\n  -- tar czf myapp.tar.gz myapp\n\n# Verify entire pipeline\nwitness verify \\\n  --policy policy-signed.json \\\n  --publickey policy-key.pub \\\n  -a build.json -a test.json -a package.json\n```\n"}]}
{"messages": [{"role": "system", "content": "You are an expert in the Witness supply chain attestation framework. You help users instrument CI/CD pipelines with witness, create policy documents, and write Rego policies to validate attestations. You understand all attestors in go-witness and how to use them effectively."}, {"role": "user", "content": "How do I create a witness policy for a build step that uses these attestors: environment, github, material?"}, {"role": "assistant", "content": "Here's a complete witness policy for your build step with environment, github, material attestors:\n\n**Policy Document:**\n```json\n{\n  \"expires\": \"2026-11-08T10:52:59Z\",\n  \"publickeys\": {\n    \"build-key\": {\n      \"keyid\": \"sha256:54dfe5c04e765fed8752c7aac3c69aabc63903706aea6c3d0bfbd09bc6ff0a0a\",\n      \"key\": \"-----BEGIN PUBLIC KEY-----\\n...\\n-----END PUBLIC KEY-----\"\n    }\n  },\n  \"steps\": {\n    \"build\": {\n      \"name\": \"build\",\n      \"attestations\": [\n        {\n          \"type\": \"https://witness.dev/attestations/environment/v0.1\"\n        },\n        {\n          \"type\": \"https://witness.dev/attestations/github/v0.1\"\n        },\n        {\n          \"type\": \"https://witness.dev/attestations/material/v0.1\"\n        }\n      ],\n      \"functionaries\": [\n        {\n          \"type\": \"publickey\",\n          \"publickeyid\": \"build-key\"\n        }\n      ]\n    }\n  }\n}\n```\n\n**Witness Run Command:**\n```bash\nwitness run --step build \\\n  --attestations environment,github,material \\\n  --outfile build-attestation.json \\\n  --key signing-key.pem \\\n  -- <your-build-command>\n```\n\n**Rego Validation Rules:**\n```rego\npackage environment\n\nimport rego.v1\n\n# Ensure correct OS\ndeny contains msg if {\n    input.os != \"darwin\"\n    msg := sprintf(\"Must run on darwin, got: %s\", [input.os])\n}\n\n# Require CI environment\ndeny contains msg if {\n    not \"CI\" in input.variables\n    msg := \"Must run in CI environment (CI variable not set)\"\n}\n```\n\n**Verification:**\n```bash\nwitness verify \\\n  --policy policy-signed.json \\\n  --publickey policy-key.pub \\\n  -a build-attestation.json \\\n  --subject <artifact>\n```\n"}]}
{"messages": [{"role": "system", "content": "You are an expert in the Witness supply chain attestation framework. You help users instrument CI/CD pipelines with witness, create policy documents, and write Rego policies to validate attestations. You understand all attestors in go-witness and how to use them effectively."}, {"role": "user", "content": "How do I create a witness policy for a build step that uses these attestors: product, environment?"}, {"role": "assistant", "content": "Here's a complete witness policy for your build step with product, environment attestors:\n\n**Policy Document:**\n```json\n{\n  \"expires\": \"2026-11-08T10:52:59Z\",\n  \"publickeys\": {\n    \"build-key\": {\n      \"keyid\": \"sha256:f49f7b40185b447333ad661b3bc66fd7c5c4d3dc9655c19f24008b13724520c4\",\n      \"key\": \"-----BEGIN PUBLIC KEY-----\\n...\\n-----END PUBLIC KEY-----\"\n    }\n  },\n  \"steps\": {\n    \"build\": {\n      \"name\": \"build\",\n      \"attestations\": [\n        {\n          \"type\": \"https://witness.dev/attestations/product/v0.1\"\n        },\n        {\n          \"type\": \"https://witness.dev/attestations/environment/v0.1\"\n        }\n      ],\n      \"functionaries\": [\n        {\n          \"type\": \"publickey\",\n          \"publickeyid\": \"build-key\"\n        }\n      ]\n    }\n  }\n}\n```\n\n**Witness Run Command:**\n```bash\nwitness run --step build \\\n  --attestations product,environment \\\n  --outfile build-attestation.json \\\n  --key signing-key.pem \\\n  -- <your-build-command>\n```\n\n**Rego Validation Rules:**\n```rego\n\n```\n\n**Verification:**\n```bash\nwitness verify \\\n  --policy policy-signed.json \\\n  --publickey policy-key.pub \\\n  -a build-attestation.json \\\n  --subject <artifact>\n```\n"}]}
{"messages": [{"role": "system", "content": "You are an expert in the Witness supply chain attestation framework. You help users instrument CI/CD pipelines with witness, create policy documents, and write Rego policies to validate attestations. You understand all attestors in go-witness and how to use them effectively."}, {"role": "user", "content": "How do I create a witness policy for a build step that uses these attestors: environment, product?"}, {"role": "assistant", "content": "Here's a complete witness policy for your build step with environment, product attestors:\n\n**Policy Document:**\n```json\n{\n  \"expires\": \"2026-11-08T10:52:59Z\",\n  \"publickeys\": {\n    \"build-key\": {\n      \"keyid\": \"sha256:63c6bef7eff0033b7dd0197d33bc3322dd9b81d6d8c5f2aeece7d6c30b3300d9\",\n      \"key\": \"-----BEGIN PUBLIC KEY-----\\n...\\n-----END PUBLIC KEY-----\"\n    }\n  },\n  \"steps\": {\n    \"build\": {\n      \"name\": \"build\",\n      \"attestations\": [\n        {\n          \"type\": \"https://witness.dev/attestations/environment/v0.1\"\n        },\n        {\n          \"type\": \"https://witness.dev/attestations/product/v0.1\"\n        }\n      ],\n      \"functionaries\": [\n        {\n          \"type\": \"publickey\",\n          \"publickeyid\": \"build-key\"\n        }\n      ]\n    }\n  }\n}\n```\n\n**Witness Run Command:**\n```bash\nwitness run --step build \\\n  --attestations environment,product \\\n  --outfile build-attestation.json \\\n  --key signing-key.pem \\\n  -- <your-build-command>\n```\n\n**Rego Validation Rules:**\n```rego\npackage environment\n\nimport rego.v1\n\n# Ensure correct OS\ndeny contains msg if {\n    input.os != \"linux\"\n    msg := sprintf(\"Must run on linux, got: %s\", [input.os])\n}\n\n# Require CI environment\ndeny contains msg if {\n    not \"CI\" in input.variables\n    msg := \"Must run in CI environment (CI variable not set)\"\n}\n```\n\n**Verification:**\n```bash\nwitness verify \\\n  --policy policy-signed.json \\\n  --publickey policy-key.pub \\\n  -a build-attestation.json \\\n  --subject <artifact>\n```\n"}]}
{"messages": [{"role": "system", "content": "You are an expert in the Witness supply chain attestation framework. You help users instrument CI/CD pipelines with witness, create policy documents, and write Rego policies to validate attestations. You understand all attestors in go-witness and how to use them effectively."}, {"role": "user", "content": "How do I create a witness policy for a build step that uses these attestors: github, commandrun, git, material?"}, {"role": "assistant", "content": "Here's a complete witness policy for your build step with github, commandrun, git, material attestors:\n\n**Policy Document:**\n```json\n{\n  \"expires\": \"2026-11-08T10:52:59Z\",\n  \"publickeys\": {\n    \"build-key\": {\n      \"keyid\": \"sha256:e4d08ba0d1a84b382b2ab68b6721337eaf33216a1188e2d79592e0374de3e5f1\",\n      \"key\": \"-----BEGIN PUBLIC KEY-----\\n...\\n-----END PUBLIC KEY-----\"\n    }\n  },\n  \"steps\": {\n    \"build\": {\n      \"name\": \"build\",\n      \"attestations\": [\n        {\n          \"type\": \"https://witness.dev/attestations/github/v0.1\"\n        },\n        {\n          \"type\": \"https://witness.dev/attestations/command-run/v0.1\"\n        },\n        {\n          \"type\": \"https://witness.dev/attestations/git/v0.1\"\n        },\n        {\n          \"type\": \"https://witness.dev/attestations/material/v0.1\"\n        }\n      ],\n      \"functionaries\": [\n        {\n          \"type\": \"publickey\",\n          \"publickeyid\": \"build-key\"\n        }\n      ]\n    }\n  }\n}\n```\n\n**Witness Run Command:**\n```bash\nwitness run --step build \\\n  --attestations github,commandrun,git,material \\\n  --outfile build-attestation.json \\\n  --key signing-key.pem \\\n  -- <your-build-command>\n```\n\n**Rego Validation Rules:**\n```rego\n\n```\n\n**Verification:**\n```bash\nwitness verify \\\n  --policy policy-signed.json \\\n  --publickey policy-key.pub \\\n  -a build-attestation.json \\\n  --subject <artifact>\n```\n"}]}
{"messages": [{"role": "system", "content": "You are an expert in the Witness supply chain attestation framework. You help users instrument CI/CD pipelines with witness, create policy documents, and write Rego policies to validate attestations. You understand all attestors in go-witness and how to use them effectively."}, {"role": "user", "content": "How do I create a multi-step witness policy for a build \u2192 test \u2192 package pipeline?"}, {"role": "assistant", "content": "Here's a complete multi-step witness policy for your pipeline:\n\n**Policy Document:**\n```json\n{\n  \"expires\": \"2026-11-08T10:52:59Z\",\n  \"publickeys\": {\n    \"ci-key\": {\n      \"keyid\": \"sha256:170e28c1c96a1557b95c3f80674fd1fc3089de2912a5e62180e6017e7bb2ac92\",\n      \"key\": \"-----BEGIN PUBLIC KEY-----\\n...\\n-----END PUBLIC KEY-----\"\n    }\n  },\n  \"steps\": {\n    \"build\": {\n      \"name\": \"build\",\n      \"attestations\": [\n        {\n          \"type\": \"https://witness.dev/attestations/git/v0.1\"\n        },\n        {\n          \"type\": \"https://witness.dev/attestations/command-run/v0.1\"\n        },\n        {\n          \"type\": \"https://witness.dev/attestations/product/v0.1\"\n        }\n      ],\n      \"functionaries\": [\n        {\n          \"type\": \"publickey\",\n          \"publickeyid\": \"ci-key\"\n        }\n      ]\n    },\n    \"test\": {\n      \"name\": \"test\",\n      \"attestations\": [\n        {\n          \"type\": \"https://witness.dev/attestations/material/v0.1\"\n        },\n        {\n          \"type\": \"https://witness.dev/attestations/command-run/v0.1\"\n        }\n      ],\n      \"functionaries\": [\n        {\n          \"type\": \"publickey\",\n          \"publickeyid\": \"ci-key\"\n        }\n      ]\n    },\n    \"package\": {\n      \"name\": \"package\",\n      \"attestations\": [\n        {\n          \"type\": \"https://witness.dev/attestations/material/v0.1\"\n        },\n        {\n          \"type\": \"https://witness.dev/attestations/product/v0.1\"\n        }\n      ],\n      \"functionaries\": [\n        {\n          \"type\": \"publickey\",\n          \"publickeyid\": \"ci-key\"\n        }\n      ]\n    }\n  }\n}\n```\n\n**Pipeline Commands:**\n\n```bash\n# Step 1: Build\nwitness run --step build \\\n  --attestations git,commandrun,product \\\n  -o build.json --key ci-key.pem \\\n  -- go build -o myapp\n\n# Step 2: Test\nwitness run --step test \\\n  --attestations material,commandrun \\\n  -o test.json --key ci-key.pem \\\n  -- go test ./...\n\n# Step 3: Package\nwitness run --step package \\\n  --attestations material,product \\\n  -o package.json --key ci-key.pem \\\n  -- tar czf myapp.tar.gz myapp\n\n# Verify entire pipeline\nwitness verify \\\n  --policy policy-signed.json \\\n  --publickey policy-key.pub \\\n  -a build.json -a test.json -a package.json\n```\n"}]}
{"messages": [{"role": "system", "content": "You are an expert in the Witness supply chain attestation framework. You help users instrument CI/CD pipelines with witness, create policy documents, and write Rego policies to validate attestations. You understand all attestors in go-witness and how to use them effectively."}, {"role": "user", "content": "How do I create a witness policy for a build step that uses these attestors: commandrun, github, material, git, product?"}, {"role": "assistant", "content": "Here's a complete witness policy for your build step with commandrun, github, material, git, product attestors:\n\n**Policy Document:**\n```json\n{\n  \"expires\": \"2026-11-08T10:52:59Z\",\n  \"publickeys\": {\n    \"build-key\": {\n      \"keyid\": \"sha256:002ce9666f338af92dc6c3bfa2a51288644f405f6fdc14c0e21c8278f69be315\",\n      \"key\": \"-----BEGIN PUBLIC KEY-----\\n...\\n-----END PUBLIC KEY-----\"\n    }\n  },\n  \"steps\": {\n    \"build\": {\n      \"name\": \"build\",\n      \"attestations\": [\n        {\n          \"type\": \"https://witness.dev/attestations/command-run/v0.1\"\n        },\n        {\n          \"type\": \"https://witness.dev/attestations/github/v0.1\"\n        },\n        {\n          \"type\": \"https://witness.dev/attestations/material/v0.1\"\n        },\n        {\n          \"type\": \"https://witness.dev/attestations/git/v0.1\"\n        },\n        {\n          \"type\": \"https://witness.dev/attestations/product/v0.1\"\n        }\n      ],\n      \"functionaries\": [\n        {\n          \"type\": \"publickey\",\n          \"publickeyid\": \"build-key\"\n        }\n      ]\n    }\n  }\n}\n```\n\n**Witness Run Command:**\n```bash\nwitness run --step build \\\n  --attestations commandrun,github,material,git,product \\\n  --outfile build-attestation.json \\\n  --key signing-key.pem \\\n  -- <your-build-command>\n```\n\n**Rego Validation Rules:**\n```rego\n\n```\n\n**Verification:**\n```bash\nwitness verify \\\n  --policy policy-signed.json \\\n  --publickey policy-key.pub \\\n  -a build-attestation.json \\\n  --subject <artifact>\n```\n"}]}
{"messages": [{"role": "system", "content": "You are an expert in the Witness supply chain attestation framework. You help users instrument CI/CD pipelines with witness, create policy documents, and write Rego policies to validate attestations. You understand all attestors in go-witness and how to use them effectively."}, {"role": "user", "content": "How do I create a multi-step witness policy for a build \u2192 test \u2192 package pipeline?"}, {"role": "assistant", "content": "Here's a complete multi-step witness policy for your pipeline:\n\n**Policy Document:**\n```json\n{\n  \"expires\": \"2026-11-08T10:52:59Z\",\n  \"publickeys\": {\n    \"ci-key\": {\n      \"keyid\": \"sha256:ea335fca7e976ec2195ec434c8cf7be5a05506b66bf110e50118a5e900e0ad07\",\n      \"key\": \"-----BEGIN PUBLIC KEY-----\\n...\\n-----END PUBLIC KEY-----\"\n    }\n  },\n  \"steps\": {\n    \"build\": {\n      \"name\": \"build\",\n      \"attestations\": [\n        {\n          \"type\": \"https://witness.dev/attestations/git/v0.1\"\n        },\n        {\n          \"type\": \"https://witness.dev/attestations/command-run/v0.1\"\n        },\n        {\n          \"type\": \"https://witness.dev/attestations/product/v0.1\"\n        }\n      ],\n      \"functionaries\": [\n        {\n          \"type\": \"publickey\",\n          \"publickeyid\": \"ci-key\"\n        }\n      ]\n    },\n    \"test\": {\n      \"name\": \"test\",\n      \"attestations\": [\n        {\n          \"type\": \"https://witness.dev/attestations/material/v0.1\"\n        },\n        {\n          \"type\": \"https://witness.dev/attestations/command-run/v0.1\"\n        }\n      ],\n      \"functionaries\": [\n        {\n          \"type\": \"publickey\",\n          \"publickeyid\": \"ci-key\"\n        }\n      ]\n    },\n    \"package\": {\n      \"name\": \"package\",\n      \"attestations\": [\n        {\n          \"type\": \"https://witness.dev/attestations/material/v0.1\"\n        },\n        {\n          \"type\": \"https://witness.dev/attestations/product/v0.1\"\n        }\n      ],\n      \"functionaries\": [\n        {\n          \"type\": \"publickey\",\n          \"publickeyid\": \"ci-key\"\n        }\n      ]\n    }\n  }\n}\n```\n\n**Pipeline Commands:**\n\n```bash\n# Step 1: Build\nwitness run --step build \\\n  --attestations git,commandrun,product \\\n  -o build.json --key ci-key.pem \\\n  -- go build -o myapp\n\n# Step 2: Test\nwitness run --step test \\\n  --attestations material,commandrun \\\n  -o test.json --key ci-key.pem \\\n  -- go test ./...\n\n# Step 3: Package\nwitness run --step package \\\n  --attestations material,product \\\n  -o package.json --key ci-key.pem \\\n  -- tar czf myapp.tar.gz myapp\n\n# Verify entire pipeline\nwitness verify \\\n  --policy policy-signed.json \\\n  --publickey policy-key.pub \\\n  -a build.json -a test.json -a package.json\n```\n"}]}
{"messages": [{"role": "system", "content": "You are an expert in the Witness supply chain attestation framework. You help users instrument CI/CD pipelines with witness, create policy documents, and write Rego policies to validate attestations. You understand all attestors in go-witness and how to use them effectively."}, {"role": "user", "content": "How do I create a witness policy for a build step that uses these attestors: environment, material?"}, {"role": "assistant", "content": "Here's a complete witness policy for your build step with environment, material attestors:\n\n**Policy Document:**\n```json\n{\n  \"expires\": \"2026-11-08T10:52:59Z\",\n  \"publickeys\": {\n    \"build-key\": {\n      \"keyid\": \"sha256:cf3e026aefafc963fdae2b56816e9dacf345692eb7008e0e612a531572a72b00\",\n      \"key\": \"-----BEGIN PUBLIC KEY-----\\n...\\n-----END PUBLIC KEY-----\"\n    }\n  },\n  \"steps\": {\n    \"build\": {\n      \"name\": \"build\",\n      \"attestations\": [\n        {\n          \"type\": \"https://witness.dev/attestations/environment/v0.1\"\n        },\n        {\n          \"type\": \"https://witness.dev/attestations/material/v0.1\"\n        }\n      ],\n      \"functionaries\": [\n        {\n          \"type\": \"publickey\",\n          \"publickeyid\": \"build-key\"\n        }\n      ]\n    }\n  }\n}\n```\n\n**Witness Run Command:**\n```bash\nwitness run --step build \\\n  --attestations environment,material \\\n  --outfile build-attestation.json \\\n  --key signing-key.pem \\\n  -- <your-build-command>\n```\n\n**Rego Validation Rules:**\n```rego\npackage environment\n\nimport rego.v1\n\n# Ensure correct OS\ndeny contains msg if {\n    input.os != \"linux\"\n    msg := sprintf(\"Must run on linux, got: %s\", [input.os])\n}\n\n# Require CI environment\ndeny contains msg if {\n    not \"CI\" in input.variables\n    msg := \"Must run in CI environment (CI variable not set)\"\n}\n```\n\n**Verification:**\n```bash\nwitness verify \\\n  --policy policy-signed.json \\\n  --publickey policy-key.pub \\\n  -a build-attestation.json \\\n  --subject <artifact>\n```\n"}]}
{"messages": [{"role": "system", "content": "You are an expert in the Witness supply chain attestation framework. You help users instrument CI/CD pipelines with witness, create policy documents, and write Rego policies to validate attestations. You understand all attestors in go-witness and how to use them effectively."}, {"role": "user", "content": "How do I create a witness policy for a build step that uses these attestors: github, environment, git?"}, {"role": "assistant", "content": "Here's a complete witness policy for your build step with github, environment, git attestors:\n\n**Policy Document:**\n```json\n{\n  \"expires\": \"2026-11-08T10:52:59Z\",\n  \"publickeys\": {\n    \"build-key\": {\n      \"keyid\": \"sha256:938059b749555fc94feacf2e637d98a1d081ea4fe69804860b76d5da7e922f08\",\n      \"key\": \"-----BEGIN PUBLIC KEY-----\\n...\\n-----END PUBLIC KEY-----\"\n    }\n  },\n  \"steps\": {\n    \"build\": {\n      \"name\": \"build\",\n      \"attestations\": [\n        {\n          \"type\": \"https://witness.dev/attestations/github/v0.1\"\n        },\n        {\n          \"type\": \"https://witness.dev/attestations/environment/v0.1\"\n        },\n        {\n          \"type\": \"https://witness.dev/attestations/git/v0.1\"\n        }\n      ],\n      \"functionaries\": [\n        {\n          \"type\": \"publickey\",\n          \"publickeyid\": \"build-key\"\n        }\n      ]\n    }\n  }\n}\n```\n\n**Witness Run Command:**\n```bash\nwitness run --step build \\\n  --attestations github,environment,git \\\n  --outfile build-attestation.json \\\n  --key signing-key.pem \\\n  -- <your-build-command>\n```\n\n**Rego Validation Rules:**\n```rego\n\n```\n\n**Verification:**\n```bash\nwitness verify \\\n  --policy policy-signed.json \\\n  --publickey policy-key.pub \\\n  -a build-attestation.json \\\n  --subject <artifact>\n```\n"}]}
{"messages": [{"role": "system", "content": "You are an expert in the Witness supply chain attestation framework. You help users instrument CI/CD pipelines with witness, create policy documents, and write Rego policies to validate attestations. You understand all attestors in go-witness and how to use them effectively."}, {"role": "user", "content": "How do I create a multi-step witness policy for a build \u2192 test \u2192 package pipeline?"}, {"role": "assistant", "content": "Here's a complete multi-step witness policy for your pipeline:\n\n**Policy Document:**\n```json\n{\n  \"expires\": \"2026-11-08T10:52:59Z\",\n  \"publickeys\": {\n    \"ci-key\": {\n      \"keyid\": \"sha256:9fe4ab0bdadfc651d8774675472851f2443b06747658b6f6b8542c28de515b51\",\n      \"key\": \"-----BEGIN PUBLIC KEY-----\\n...\\n-----END PUBLIC KEY-----\"\n    }\n  },\n  \"steps\": {\n    \"build\": {\n      \"name\": \"build\",\n      \"attestations\": [\n        {\n          \"type\": \"https://witness.dev/attestations/git/v0.1\"\n        },\n        {\n          \"type\": \"https://witness.dev/attestations/command-run/v0.1\"\n        },\n        {\n          \"type\": \"https://witness.dev/attestations/product/v0.1\"\n        }\n      ],\n      \"functionaries\": [\n        {\n          \"type\": \"publickey\",\n          \"publickeyid\": \"ci-key\"\n        }\n      ]\n    },\n    \"test\": {\n      \"name\": \"test\",\n      \"attestations\": [\n        {\n          \"type\": \"https://witness.dev/attestations/material/v0.1\"\n        },\n        {\n          \"type\": \"https://witness.dev/attestations/command-run/v0.1\"\n        }\n      ],\n      \"functionaries\": [\n        {\n          \"type\": \"publickey\",\n          \"publickeyid\": \"ci-key\"\n        }\n      ]\n    },\n    \"package\": {\n      \"name\": \"package\",\n      \"attestations\": [\n        {\n          \"type\": \"https://witness.dev/attestations/material/v0.1\"\n        },\n        {\n          \"type\": \"https://witness.dev/attestations/product/v0.1\"\n        }\n      ],\n      \"functionaries\": [\n        {\n          \"type\": \"publickey\",\n          \"publickeyid\": \"ci-key\"\n        }\n      ]\n    }\n  }\n}\n```\n\n**Pipeline Commands:**\n\n```bash\n# Step 1: Build\nwitness run --step build \\\n  --attestations git,commandrun,product \\\n  -o build.json --key ci-key.pem \\\n  -- go build -o myapp\n\n# Step 2: Test\nwitness run --step test \\\n  --attestations material,commandrun \\\n  -o test.json --key ci-key.pem \\\n  -- go test ./...\n\n# Step 3: Package\nwitness run --step package \\\n  --attestations material,product \\\n  -o package.json --key ci-key.pem \\\n  -- tar czf myapp.tar.gz myapp\n\n# Verify entire pipeline\nwitness verify \\\n  --policy policy-signed.json \\\n  --publickey policy-key.pub \\\n  -a build.json -a test.json -a package.json\n```\n"}]}
{"messages": [{"role": "system", "content": "You are an expert in the Witness supply chain attestation framework. You help users instrument CI/CD pipelines with witness, create policy documents, and write Rego policies to validate attestations. You understand all attestors in go-witness and how to use them effectively."}, {"role": "user", "content": "How do I create a witness policy for a build step that uses these attestors: git, commandrun, environment, github, product?"}, {"role": "assistant", "content": "Here's a complete witness policy for your build step with git, commandrun, environment, github, product attestors:\n\n**Policy Document:**\n```json\n{\n  \"expires\": \"2026-11-08T10:52:59Z\",\n  \"publickeys\": {\n    \"build-key\": {\n      \"keyid\": \"sha256:e78c08013a6af800d0b27251a0765eb19bc0e663d3c53a2709f1df58a2215a6a\",\n      \"key\": \"-----BEGIN PUBLIC KEY-----\\n...\\n-----END PUBLIC KEY-----\"\n    }\n  },\n  \"steps\": {\n    \"build\": {\n      \"name\": \"build\",\n      \"attestations\": [\n        {\n          \"type\": \"https://witness.dev/attestations/git/v0.1\"\n        },\n        {\n          \"type\": \"https://witness.dev/attestations/command-run/v0.1\"\n        },\n        {\n          \"type\": \"https://witness.dev/attestations/environment/v0.1\"\n        },\n        {\n          \"type\": \"https://witness.dev/attestations/github/v0.1\"\n        },\n        {\n          \"type\": \"https://witness.dev/attestations/product/v0.1\"\n        }\n      ],\n      \"functionaries\": [\n        {\n          \"type\": \"publickey\",\n          \"publickeyid\": \"build-key\"\n        }\n      ]\n    }\n  }\n}\n```\n\n**Witness Run Command:**\n```bash\nwitness run --step build \\\n  --attestations git,commandrun,environment,github,product \\\n  --outfile build-attestation.json \\\n  --key signing-key.pem \\\n  -- <your-build-command>\n```\n\n**Rego Validation Rules:**\n```rego\npackage git\n\nimport rego.v1\n\n# Enforce builds from specific branch\ndeny contains msg if {\n    input.branch != \"release/v1.0\"\n    msg := sprintf(\"Must build from release/v1.0 branch, got: %s\", [input.branch])\n}\n\n# Require clean working directory\ndeny contains msg if {\n    count(input.status) > 0\n    msg := \"Working directory must be clean (no uncommitted changes)\"\n}\n\n# Validate commit author\napproved_authors := {\n    \"alice.smith@example.com\",\n    \"bob.jones@company.com\",\n    \"ci-bot@company.com\"\n}\n\ndeny contains msg if {\n    not input.authoremail in approved_authors\n    msg := sprintf(\"Unauthorized commit author: %s\", [input.authoremail])\n}\n```\n\n**Verification:**\n```bash\nwitness verify \\\n  --policy policy-signed.json \\\n  --publickey policy-key.pub \\\n  -a build-attestation.json \\\n  --subject <artifact>\n```\n"}]}
{"messages": [{"role": "system", "content": "You are an expert in the Witness supply chain attestation framework. You help users instrument CI/CD pipelines with witness, create policy documents, and write Rego policies to validate attestations. You understand all attestors in go-witness and how to use them effectively."}, {"role": "user", "content": "How do I create a multi-step witness policy for a build \u2192 test \u2192 package pipeline?"}, {"role": "assistant", "content": "Here's a complete multi-step witness policy for your pipeline:\n\n**Policy Document:**\n```json\n{\n  \"expires\": \"2026-11-08T10:52:59Z\",\n  \"publickeys\": {\n    \"ci-key\": {\n      \"keyid\": \"sha256:5ee4b5cbb01212fff27df218193ca7b8a7db15dce03874f03144195451f9cbca\",\n      \"key\": \"-----BEGIN PUBLIC KEY-----\\n...\\n-----END PUBLIC KEY-----\"\n    }\n  },\n  \"steps\": {\n    \"build\": {\n      \"name\": \"build\",\n      \"attestations\": [\n        {\n          \"type\": \"https://witness.dev/attestations/git/v0.1\"\n        },\n        {\n          \"type\": \"https://witness.dev/attestations/command-run/v0.1\"\n        },\n        {\n          \"type\": \"https://witness.dev/attestations/product/v0.1\"\n        }\n      ],\n      \"functionaries\": [\n        {\n          \"type\": \"publickey\",\n          \"publickeyid\": \"ci-key\"\n        }\n      ]\n    },\n    \"test\": {\n      \"name\": \"test\",\n      \"attestations\": [\n        {\n          \"type\": \"https://witness.dev/attestations/material/v0.1\"\n        },\n        {\n          \"type\": \"https://witness.dev/attestations/command-run/v0.1\"\n        }\n      ],\n      \"functionaries\": [\n        {\n          \"type\": \"publickey\",\n          \"publickeyid\": \"ci-key\"\n        }\n      ]\n    },\n    \"package\": {\n      \"name\": \"package\",\n      \"attestations\": [\n        {\n          \"type\": \"https://witness.dev/attestations/material/v0.1\"\n        },\n        {\n          \"type\": \"https://witness.dev/attestations/product/v0.1\"\n        }\n      ],\n      \"functionaries\": [\n        {\n          \"type\": \"publickey\",\n          \"publickeyid\": \"ci-key\"\n        }\n      ]\n    }\n  }\n}\n```\n\n**Pipeline Commands:**\n\n```bash\n# Step 1: Build\nwitness run --step build \\\n  --attestations git,commandrun,product \\\n  -o build.json --key ci-key.pem \\\n  -- go build -o myapp\n\n# Step 2: Test\nwitness run --step test \\\n  --attestations material,commandrun \\\n  -o test.json --key ci-key.pem \\\n  -- go test ./...\n\n# Step 3: Package\nwitness run --step package \\\n  --attestations material,product \\\n  -o package.json --key ci-key.pem \\\n  -- tar czf myapp.tar.gz myapp\n\n# Verify entire pipeline\nwitness verify \\\n  --policy policy-signed.json \\\n  --publickey policy-key.pub \\\n  -a build.json -a test.json -a package.json\n```\n"}]}
{"messages": [{"role": "system", "content": "You are an expert in the Witness supply chain attestation framework. You help users instrument CI/CD pipelines with witness, create policy documents, and write Rego policies to validate attestations. You understand all attestors in go-witness and how to use them effectively."}, {"role": "user", "content": "How do I create a witness policy for a build step that uses these attestors: material, git?"}, {"role": "assistant", "content": "Here's a complete witness policy for your build step with material, git attestors:\n\n**Policy Document:**\n```json\n{\n  \"expires\": \"2026-11-08T10:52:59Z\",\n  \"publickeys\": {\n    \"build-key\": {\n      \"keyid\": \"sha256:866a49881ee4f6f850fdc6877c225e920850a896392ab931b072d194457a7279\",\n      \"key\": \"-----BEGIN PUBLIC KEY-----\\n...\\n-----END PUBLIC KEY-----\"\n    }\n  },\n  \"steps\": {\n    \"build\": {\n      \"name\": \"build\",\n      \"attestations\": [\n        {\n          \"type\": \"https://witness.dev/attestations/material/v0.1\"\n        },\n        {\n          \"type\": \"https://witness.dev/attestations/git/v0.1\"\n        }\n      ],\n      \"functionaries\": [\n        {\n          \"type\": \"publickey\",\n          \"publickeyid\": \"build-key\"\n        }\n      ]\n    }\n  }\n}\n```\n\n**Witness Run Command:**\n```bash\nwitness run --step build \\\n  --attestations material,git \\\n  --outfile build-attestation.json \\\n  --key signing-key.pem \\\n  -- <your-build-command>\n```\n\n**Rego Validation Rules:**\n```rego\n\n```\n\n**Verification:**\n```bash\nwitness verify \\\n  --policy policy-signed.json \\\n  --publickey policy-key.pub \\\n  -a build-attestation.json \\\n  --subject <artifact>\n```\n"}]}
{"messages": [{"role": "system", "content": "You are an expert in the Witness supply chain attestation framework. You help users instrument CI/CD pipelines with witness, create policy documents, and write Rego policies to validate attestations. You understand all attestors in go-witness and how to use them effectively."}, {"role": "user", "content": "How do I create a witness policy for a build step that uses these attestors: environment, product?"}, {"role": "assistant", "content": "Here's a complete witness policy for your build step with environment, product attestors:\n\n**Policy Document:**\n```json\n{\n  \"expires\": \"2026-11-08T10:52:59Z\",\n  \"publickeys\": {\n    \"build-key\": {\n      \"keyid\": \"sha256:649d14252806215239d63516710a1d46c58f964578b7f82999794955f02934b6\",\n      \"key\": \"-----BEGIN PUBLIC KEY-----\\n...\\n-----END PUBLIC KEY-----\"\n    }\n  },\n  \"steps\": {\n    \"build\": {\n      \"name\": \"build\",\n      \"attestations\": [\n        {\n          \"type\": \"https://witness.dev/attestations/environment/v0.1\"\n        },\n        {\n          \"type\": \"https://witness.dev/attestations/product/v0.1\"\n        }\n      ],\n      \"functionaries\": [\n        {\n          \"type\": \"publickey\",\n          \"publickeyid\": \"build-key\"\n        }\n      ]\n    }\n  }\n}\n```\n\n**Witness Run Command:**\n```bash\nwitness run --step build \\\n  --attestations environment,product \\\n  --outfile build-attestation.json \\\n  --key signing-key.pem \\\n  -- <your-build-command>\n```\n\n**Rego Validation Rules:**\n```rego\npackage environment\n\nimport rego.v1\n\n# Ensure correct OS\ndeny contains msg if {\n    input.os != \"darwin\"\n    msg := sprintf(\"Must run on darwin, got: %s\", [input.os])\n}\n\n# Require CI environment\ndeny contains msg if {\n    not \"CI\" in input.variables\n    msg := \"Must run in CI environment (CI variable not set)\"\n}\n```\n\n**Verification:**\n```bash\nwitness verify \\\n  --policy policy-signed.json \\\n  --publickey policy-key.pub \\\n  -a build-attestation.json \\\n  --subject <artifact>\n```\n"}]}
{"messages": [{"role": "system", "content": "You are an expert in the Witness supply chain attestation framework. You help users instrument CI/CD pipelines with witness, create policy documents, and write Rego policies to validate attestations. You understand all attestors in go-witness and how to use them effectively."}, {"role": "user", "content": "How do I create a witness policy for a build step that uses these attestors: environment, github, product?"}, {"role": "assistant", "content": "Here's a complete witness policy for your build step with environment, github, product attestors:\n\n**Policy Document:**\n```json\n{\n  \"expires\": \"2026-11-08T10:52:59Z\",\n  \"publickeys\": {\n    \"build-key\": {\n      \"keyid\": \"sha256:14182ca883a30379d6c4d6f83f69553631f1b0ca45445cf2591cfcf1e1fef577\",\n      \"key\": \"-----BEGIN PUBLIC KEY-----\\n...\\n-----END PUBLIC KEY-----\"\n    }\n  },\n  \"steps\": {\n    \"build\": {\n      \"name\": \"build\",\n      \"attestations\": [\n        {\n          \"type\": \"https://witness.dev/attestations/environment/v0.1\"\n        },\n        {\n          \"type\": \"https://witness.dev/attestations/github/v0.1\"\n        },\n        {\n          \"type\": \"https://witness.dev/attestations/product/v0.1\"\n        }\n      ],\n      \"functionaries\": [\n        {\n          \"type\": \"publickey\",\n          \"publickeyid\": \"build-key\"\n        }\n      ]\n    }\n  }\n}\n```\n\n**Witness Run Command:**\n```bash\nwitness run --step build \\\n  --attestations environment,github,product \\\n  --outfile build-attestation.json \\\n  --key signing-key.pem \\\n  -- <your-build-command>\n```\n\n**Rego Validation Rules:**\n```rego\npackage environment\n\nimport rego.v1\n\n# Ensure correct OS\ndeny contains msg if {\n    input.os != \"linux\"\n    msg := sprintf(\"Must run on linux, got: %s\", [input.os])\n}\n\n# Require CI environment\ndeny contains msg if {\n    not \"CI\" in input.variables\n    msg := \"Must run in CI environment (CI variable not set)\"\n}\n```\n\n**Verification:**\n```bash\nwitness verify \\\n  --policy policy-signed.json \\\n  --publickey policy-key.pub \\\n  -a build-attestation.json \\\n  --subject <artifact>\n```\n"}]}
{"messages": [{"role": "system", "content": "You are an expert in the Witness supply chain attestation framework. You help users instrument CI/CD pipelines with witness, create policy documents, and write Rego policies to validate attestations. You understand all attestors in go-witness and how to use them effectively."}, {"role": "user", "content": "How do I create a witness policy for a build step that uses these attestors: product, git, material, github?"}, {"role": "assistant", "content": "Here's a complete witness policy for your build step with product, git, material, github attestors:\n\n**Policy Document:**\n```json\n{\n  \"expires\": \"2026-11-08T10:52:59Z\",\n  \"publickeys\": {\n    \"build-key\": {\n      \"keyid\": \"sha256:a09821223b83e4f60f0c23b21571b5d8ade607ba270011f435f476d037d50fe7\",\n      \"key\": \"-----BEGIN PUBLIC KEY-----\\n...\\n-----END PUBLIC KEY-----\"\n    }\n  },\n  \"steps\": {\n    \"build\": {\n      \"name\": \"build\",\n      \"attestations\": [\n        {\n          \"type\": \"https://witness.dev/attestations/product/v0.1\"\n        },\n        {\n          \"type\": \"https://witness.dev/attestations/git/v0.1\"\n        },\n        {\n          \"type\": \"https://witness.dev/attestations/material/v0.1\"\n        },\n        {\n          \"type\": \"https://witness.dev/attestations/github/v0.1\"\n        }\n      ],\n      \"functionaries\": [\n        {\n          \"type\": \"publickey\",\n          \"publickeyid\": \"build-key\"\n        }\n      ]\n    }\n  }\n}\n```\n\n**Witness Run Command:**\n```bash\nwitness run --step build \\\n  --attestations product,git,material,github \\\n  --outfile build-attestation.json \\\n  --key signing-key.pem \\\n  -- <your-build-command>\n```\n\n**Rego Validation Rules:**\n```rego\n\n```\n\n**Verification:**\n```bash\nwitness verify \\\n  --policy policy-signed.json \\\n  --publickey policy-key.pub \\\n  -a build-attestation.json \\\n  --subject <artifact>\n```\n"}]}
{"messages": [{"role": "system", "content": "You are an expert in the Witness supply chain attestation framework. You help users instrument CI/CD pipelines with witness, create policy documents, and write Rego policies to validate attestations. You understand all attestors in go-witness and how to use them effectively."}, {"role": "user", "content": "How do I create a witness policy for a build step that uses these attestors: commandrun, product, git, environment, material?"}, {"role": "assistant", "content": "Here's a complete witness policy for your build step with commandrun, product, git, environment, material attestors:\n\n**Policy Document:**\n```json\n{\n  \"expires\": \"2026-11-08T10:52:59Z\",\n  \"publickeys\": {\n    \"build-key\": {\n      \"keyid\": \"sha256:815d8dd015965d8681ce3913c7658658191e9ba3fc075245a4bcffe3eb94daea\",\n      \"key\": \"-----BEGIN PUBLIC KEY-----\\n...\\n-----END PUBLIC KEY-----\"\n    }\n  },\n  \"steps\": {\n    \"build\": {\n      \"name\": \"build\",\n      \"attestations\": [\n        {\n          \"type\": \"https://witness.dev/attestations/command-run/v0.1\"\n        },\n        {\n          \"type\": \"https://witness.dev/attestations/product/v0.1\"\n        },\n        {\n          \"type\": \"https://witness.dev/attestations/git/v0.1\"\n        },\n        {\n          \"type\": \"https://witness.dev/attestations/environment/v0.1\"\n        },\n        {\n          \"type\": \"https://witness.dev/attestations/material/v0.1\"\n        }\n      ],\n      \"functionaries\": [\n        {\n          \"type\": \"publickey\",\n          \"publickeyid\": \"build-key\"\n        }\n      ]\n    }\n  }\n}\n```\n\n**Witness Run Command:**\n```bash\nwitness run --step build \\\n  --attestations commandrun,product,git,environment,material \\\n  --outfile build-attestation.json \\\n  --key signing-key.pem \\\n  -- <your-build-command>\n```\n\n**Rego Validation Rules:**\n```rego\n\n```\n\n**Verification:**\n```bash\nwitness verify \\\n  --policy policy-signed.json \\\n  --publickey policy-key.pub \\\n  -a build-attestation.json \\\n  --subject <artifact>\n```\n"}]}
{"messages": [{"role": "system", "content": "You are an expert in the Witness supply chain attestation framework. You help users instrument CI/CD pipelines with witness, create policy documents, and write Rego policies to validate attestations. You understand all attestors in go-witness and how to use them effectively."}, {"role": "user", "content": "How do I create a witness policy for a build step that uses these attestors: environment, material?"}, {"role": "assistant", "content": "Here's a complete witness policy for your build step with environment, material attestors:\n\n**Policy Document:**\n```json\n{\n  \"expires\": \"2026-11-08T10:52:59Z\",\n  \"publickeys\": {\n    \"build-key\": {\n      \"keyid\": \"sha256:2b52aacd1f73033710e5b8debde111d2fd628a26f1ef35d07fcd2b62146ef52c\",\n      \"key\": \"-----BEGIN PUBLIC KEY-----\\n...\\n-----END PUBLIC KEY-----\"\n    }\n  },\n  \"steps\": {\n    \"build\": {\n      \"name\": \"build\",\n      \"attestations\": [\n        {\n          \"type\": \"https://witness.dev/attestations/environment/v0.1\"\n        },\n        {\n          \"type\": \"https://witness.dev/attestations/material/v0.1\"\n        }\n      ],\n      \"functionaries\": [\n        {\n          \"type\": \"publickey\",\n          \"publickeyid\": \"build-key\"\n        }\n      ]\n    }\n  }\n}\n```\n\n**Witness Run Command:**\n```bash\nwitness run --step build \\\n  --attestations environment,material \\\n  --outfile build-attestation.json \\\n  --key signing-key.pem \\\n  -- <your-build-command>\n```\n\n**Rego Validation Rules:**\n```rego\npackage environment\n\nimport rego.v1\n\n# Ensure correct OS\ndeny contains msg if {\n    input.os != \"windows\"\n    msg := sprintf(\"Must run on windows, got: %s\", [input.os])\n}\n\n# Require CI environment\ndeny contains msg if {\n    not \"CI\" in input.variables\n    msg := \"Must run in CI environment (CI variable not set)\"\n}\n```\n\n**Verification:**\n```bash\nwitness verify \\\n  --policy policy-signed.json \\\n  --publickey policy-key.pub \\\n  -a build-attestation.json \\\n  --subject <artifact>\n```\n"}]}
{"messages": [{"role": "system", "content": "You are an expert in the Witness supply chain attestation framework. You help users instrument CI/CD pipelines with witness, create policy documents, and write Rego policies to validate attestations. You understand all attestors in go-witness and how to use them effectively."}, {"role": "user", "content": "How do I create a witness policy for a build step that uses these attestors: commandrun, product, github?"}, {"role": "assistant", "content": "Here's a complete witness policy for your build step with commandrun, product, github attestors:\n\n**Policy Document:**\n```json\n{\n  \"expires\": \"2026-11-08T10:52:59Z\",\n  \"publickeys\": {\n    \"build-key\": {\n      \"keyid\": \"sha256:a588dc132a7a2521744cb5ca131786be29b38f4c17f5b0251be1ed69cb69e9d3\",\n      \"key\": \"-----BEGIN PUBLIC KEY-----\\n...\\n-----END PUBLIC KEY-----\"\n    }\n  },\n  \"steps\": {\n    \"build\": {\n      \"name\": \"build\",\n      \"attestations\": [\n        {\n          \"type\": \"https://witness.dev/attestations/command-run/v0.1\"\n        },\n        {\n          \"type\": \"https://witness.dev/attestations/product/v0.1\"\n        },\n        {\n          \"type\": \"https://witness.dev/attestations/github/v0.1\"\n        }\n      ],\n      \"functionaries\": [\n        {\n          \"type\": \"publickey\",\n          \"publickeyid\": \"build-key\"\n        }\n      ]\n    }\n  }\n}\n```\n\n**Witness Run Command:**\n```bash\nwitness run --step build \\\n  --attestations commandrun,product,github \\\n  --outfile build-attestation.json \\\n  --key signing-key.pem \\\n  -- <your-build-command>\n```\n\n**Rego Validation Rules:**\n```rego\n\n```\n\n**Verification:**\n```bash\nwitness verify \\\n  --policy policy-signed.json \\\n  --publickey policy-key.pub \\\n  -a build-attestation.json \\\n  --subject <artifact>\n```\n"}]}
{"messages": [{"role": "system", "content": "You are an expert in the Witness supply chain attestation framework. You help users instrument CI/CD pipelines with witness, create policy documents, and write Rego policies to validate attestations. You understand all attestors in go-witness and how to use them effectively."}, {"role": "user", "content": "How do I create a witness policy for a build step that uses these attestors: commandrun, environment, github, material?"}, {"role": "assistant", "content": "Here's a complete witness policy for your build step with commandrun, environment, github, material attestors:\n\n**Policy Document:**\n```json\n{\n  \"expires\": \"2026-11-08T10:52:59Z\",\n  \"publickeys\": {\n    \"build-key\": {\n      \"keyid\": \"sha256:ec48a04931ac7ec4943533cab58ad980c0ff8cd053c93a1885b53dcb96204bca\",\n      \"key\": \"-----BEGIN PUBLIC KEY-----\\n...\\n-----END PUBLIC KEY-----\"\n    }\n  },\n  \"steps\": {\n    \"build\": {\n      \"name\": \"build\",\n      \"attestations\": [\n        {\n          \"type\": \"https://witness.dev/attestations/command-run/v0.1\"\n        },\n        {\n          \"type\": \"https://witness.dev/attestations/environment/v0.1\"\n        },\n        {\n          \"type\": \"https://witness.dev/attestations/github/v0.1\"\n        },\n        {\n          \"type\": \"https://witness.dev/attestations/material/v0.1\"\n        }\n      ],\n      \"functionaries\": [\n        {\n          \"type\": \"publickey\",\n          \"publickeyid\": \"build-key\"\n        }\n      ]\n    }\n  }\n}\n```\n\n**Witness Run Command:**\n```bash\nwitness run --step build \\\n  --attestations commandrun,environment,github,material \\\n  --outfile build-attestation.json \\\n  --key signing-key.pem \\\n  -- <your-build-command>\n```\n\n**Rego Validation Rules:**\n```rego\n\n```\n\n**Verification:**\n```bash\nwitness verify \\\n  --policy policy-signed.json \\\n  --publickey policy-key.pub \\\n  -a build-attestation.json \\\n  --subject <artifact>\n```\n"}]}
{"messages": [{"role": "system", "content": "You are an expert in the Witness supply chain attestation framework. You help users instrument CI/CD pipelines with witness, create policy documents, and write Rego policies to validate attestations. You understand all attestors in go-witness and how to use them effectively."}, {"role": "user", "content": "How do I create a witness policy for a build step that uses these attestors: product, material, github, git?"}, {"role": "assistant", "content": "Here's a complete witness policy for your build step with product, material, github, git attestors:\n\n**Policy Document:**\n```json\n{\n  \"expires\": \"2026-11-08T10:52:59Z\",\n  \"publickeys\": {\n    \"build-key\": {\n      \"keyid\": \"sha256:5b9414bb315c02f45b55bc9a1b3d892740f0f6b3905aa5df2ecda500675e49fd\",\n      \"key\": \"-----BEGIN PUBLIC KEY-----\\n...\\n-----END PUBLIC KEY-----\"\n    }\n  },\n  \"steps\": {\n    \"build\": {\n      \"name\": \"build\",\n      \"attestations\": [\n        {\n          \"type\": \"https://witness.dev/attestations/product/v0.1\"\n        },\n        {\n          \"type\": \"https://witness.dev/attestations/material/v0.1\"\n        },\n        {\n          \"type\": \"https://witness.dev/attestations/github/v0.1\"\n        },\n        {\n          \"type\": \"https://witness.dev/attestations/git/v0.1\"\n        }\n      ],\n      \"functionaries\": [\n        {\n          \"type\": \"publickey\",\n          \"publickeyid\": \"build-key\"\n        }\n      ]\n    }\n  }\n}\n```\n\n**Witness Run Command:**\n```bash\nwitness run --step build \\\n  --attestations product,material,github,git \\\n  --outfile build-attestation.json \\\n  --key signing-key.pem \\\n  -- <your-build-command>\n```\n\n**Rego Validation Rules:**\n```rego\n\n```\n\n**Verification:**\n```bash\nwitness verify \\\n  --policy policy-signed.json \\\n  --publickey policy-key.pub \\\n  -a build-attestation.json \\\n  --subject <artifact>\n```\n"}]}
{"messages": [{"role": "system", "content": "You are an expert in the Witness supply chain attestation framework. You help users instrument CI/CD pipelines with witness, create policy documents, and write Rego policies to validate attestations. You understand all attestors in go-witness and how to use them effectively."}, {"role": "user", "content": "How do I create a witness policy for a build step that uses these attestors: material, git?"}, {"role": "assistant", "content": "Here's a complete witness policy for your build step with material, git attestors:\n\n**Policy Document:**\n```json\n{\n  \"expires\": \"2026-11-08T10:52:59Z\",\n  \"publickeys\": {\n    \"build-key\": {\n      \"keyid\": \"sha256:da73429305e05cc996f20393904962d5734e885272145fbc1915b25d7b259f37\",\n      \"key\": \"-----BEGIN PUBLIC KEY-----\\n...\\n-----END PUBLIC KEY-----\"\n    }\n  },\n  \"steps\": {\n    \"build\": {\n      \"name\": \"build\",\n      \"attestations\": [\n        {\n          \"type\": \"https://witness.dev/attestations/material/v0.1\"\n        },\n        {\n          \"type\": \"https://witness.dev/attestations/git/v0.1\"\n        }\n      ],\n      \"functionaries\": [\n        {\n          \"type\": \"publickey\",\n          \"publickeyid\": \"build-key\"\n        }\n      ]\n    }\n  }\n}\n```\n\n**Witness Run Command:**\n```bash\nwitness run --step build \\\n  --attestations material,git \\\n  --outfile build-attestation.json \\\n  --key signing-key.pem \\\n  -- <your-build-command>\n```\n\n**Rego Validation Rules:**\n```rego\n\n```\n\n**Verification:**\n```bash\nwitness verify \\\n  --policy policy-signed.json \\\n  --publickey policy-key.pub \\\n  -a build-attestation.json \\\n  --subject <artifact>\n```\n"}]}
{"messages": [{"role": "system", "content": "You are an expert in the Witness supply chain attestation framework. You help users instrument CI/CD pipelines with witness, create policy documents, and write Rego policies to validate attestations. You understand all attestors in go-witness and how to use them effectively."}, {"role": "user", "content": "How do I create a witness policy for a build step that uses these attestors: environment?"}, {"role": "assistant", "content": "Here's a complete witness policy for your build step with environment attestors:\n\n**Policy Document:**\n```json\n{\n  \"expires\": \"2026-11-08T10:52:59Z\",\n  \"publickeys\": {\n    \"build-key\": {\n      \"keyid\": \"sha256:4a70b07668d658f73dd8a51124ad502ab778b3d4df07c58e6b769e6d1cd7fc6e\",\n      \"key\": \"-----BEGIN PUBLIC KEY-----\\n...\\n-----END PUBLIC KEY-----\"\n    }\n  },\n  \"steps\": {\n    \"build\": {\n      \"name\": \"build\",\n      \"attestations\": [\n        {\n          \"type\": \"https://witness.dev/attestations/environment/v0.1\"\n        }\n      ],\n      \"functionaries\": [\n        {\n          \"type\": \"publickey\",\n          \"publickeyid\": \"build-key\"\n        }\n      ]\n    }\n  }\n}\n```\n\n**Witness Run Command:**\n```bash\nwitness run --step build \\\n  --attestations environment \\\n  --outfile build-attestation.json \\\n  --key signing-key.pem \\\n  -- <your-build-command>\n```\n\n**Rego Validation Rules:**\n```rego\npackage environment\n\nimport rego.v1\n\n# Ensure correct OS\ndeny contains msg if {\n    input.os != \"darwin\"\n    msg := sprintf(\"Must run on darwin, got: %s\", [input.os])\n}\n\n# Require CI environment\ndeny contains msg if {\n    not \"CI\" in input.variables\n    msg := \"Must run in CI environment (CI variable not set)\"\n}\n```\n\n**Verification:**\n```bash\nwitness verify \\\n  --policy policy-signed.json \\\n  --publickey policy-key.pub \\\n  -a build-attestation.json \\\n  --subject <artifact>\n```\n"}]}
{"messages": [{"role": "system", "content": "You are an expert in the Witness supply chain attestation framework. You help users instrument CI/CD pipelines with witness, create policy documents, and write Rego policies to validate attestations. You understand all attestors in go-witness and how to use them effectively."}, {"role": "user", "content": "How do I create a witness policy for a build step that uses these attestors: commandrun, product, git?"}, {"role": "assistant", "content": "Here's a complete witness policy for your build step with commandrun, product, git attestors:\n\n**Policy Document:**\n```json\n{\n  \"expires\": \"2026-11-08T10:52:59Z\",\n  \"publickeys\": {\n    \"build-key\": {\n      \"keyid\": \"sha256:6bf952480c69552fd030a1f32b65b9be8a35cf2e7965c280150c988445a93ccc\",\n      \"key\": \"-----BEGIN PUBLIC KEY-----\\n...\\n-----END PUBLIC KEY-----\"\n    }\n  },\n  \"steps\": {\n    \"build\": {\n      \"name\": \"build\",\n      \"attestations\": [\n        {\n          \"type\": \"https://witness.dev/attestations/command-run/v0.1\"\n        },\n        {\n          \"type\": \"https://witness.dev/attestations/product/v0.1\"\n        },\n        {\n          \"type\": \"https://witness.dev/attestations/git/v0.1\"\n        }\n      ],\n      \"functionaries\": [\n        {\n          \"type\": \"publickey\",\n          \"publickeyid\": \"build-key\"\n        }\n      ]\n    }\n  }\n}\n```\n\n**Witness Run Command:**\n```bash\nwitness run --step build \\\n  --attestations commandrun,product,git \\\n  --outfile build-attestation.json \\\n  --key signing-key.pem \\\n  -- <your-build-command>\n```\n\n**Rego Validation Rules:**\n```rego\n\n```\n\n**Verification:**\n```bash\nwitness verify \\\n  --policy policy-signed.json \\\n  --publickey policy-key.pub \\\n  -a build-attestation.json \\\n  --subject <artifact>\n```\n"}]}
{"messages": [{"role": "system", "content": "You are an expert in the Witness supply chain attestation framework. You help users instrument CI/CD pipelines with witness, create policy documents, and write Rego policies to validate attestations. You understand all attestors in go-witness and how to use them effectively."}, {"role": "user", "content": "How do I create a witness policy for a build step that uses these attestors: commandrun, git, product, environment, github?"}, {"role": "assistant", "content": "Here's a complete witness policy for your build step with commandrun, git, product, environment, github attestors:\n\n**Policy Document:**\n```json\n{\n  \"expires\": \"2026-11-08T10:52:59Z\",\n  \"publickeys\": {\n    \"build-key\": {\n      \"keyid\": \"sha256:29184115f4baa614d797fddcaea4fbd6596d1c22a48f200ef8e7118ee5a185a8\",\n      \"key\": \"-----BEGIN PUBLIC KEY-----\\n...\\n-----END PUBLIC KEY-----\"\n    }\n  },\n  \"steps\": {\n    \"build\": {\n      \"name\": \"build\",\n      \"attestations\": [\n        {\n          \"type\": \"https://witness.dev/attestations/command-run/v0.1\"\n        },\n        {\n          \"type\": \"https://witness.dev/attestations/git/v0.1\"\n        },\n        {\n          \"type\": \"https://witness.dev/attestations/product/v0.1\"\n        },\n        {\n          \"type\": \"https://witness.dev/attestations/environment/v0.1\"\n        },\n        {\n          \"type\": \"https://witness.dev/attestations/github/v0.1\"\n        }\n      ],\n      \"functionaries\": [\n        {\n          \"type\": \"publickey\",\n          \"publickeyid\": \"build-key\"\n        }\n      ]\n    }\n  }\n}\n```\n\n**Witness Run Command:**\n```bash\nwitness run --step build \\\n  --attestations commandrun,git,product,environment,github \\\n  --outfile build-attestation.json \\\n  --key signing-key.pem \\\n  -- <your-build-command>\n```\n\n**Rego Validation Rules:**\n```rego\n\n```\n\n**Verification:**\n```bash\nwitness verify \\\n  --policy policy-signed.json \\\n  --publickey policy-key.pub \\\n  -a build-attestation.json \\\n  --subject <artifact>\n```\n"}]}
{"messages": [{"role": "system", "content": "You are an expert in the Witness supply chain attestation framework. You help users instrument CI/CD pipelines with witness, create policy documents, and write Rego policies to validate attestations. You understand all attestors in go-witness and how to use them effectively."}, {"role": "user", "content": "How do I create a witness policy for a build step that uses these attestors: environment, commandrun, github, product?"}, {"role": "assistant", "content": "Here's a complete witness policy for your build step with environment, commandrun, github, product attestors:\n\n**Policy Document:**\n```json\n{\n  \"expires\": \"2026-11-08T10:52:59Z\",\n  \"publickeys\": {\n    \"build-key\": {\n      \"keyid\": \"sha256:a0933bb5832efb4e26559511aee5d3b65e43475a03534b12d1c929ec1f145c0e\",\n      \"key\": \"-----BEGIN PUBLIC KEY-----\\n...\\n-----END PUBLIC KEY-----\"\n    }\n  },\n  \"steps\": {\n    \"build\": {\n      \"name\": \"build\",\n      \"attestations\": [\n        {\n          \"type\": \"https://witness.dev/attestations/environment/v0.1\"\n        },\n        {\n          \"type\": \"https://witness.dev/attestations/command-run/v0.1\"\n        },\n        {\n          \"type\": \"https://witness.dev/attestations/github/v0.1\"\n        },\n        {\n          \"type\": \"https://witness.dev/attestations/product/v0.1\"\n        }\n      ],\n      \"functionaries\": [\n        {\n          \"type\": \"publickey\",\n          \"publickeyid\": \"build-key\"\n        }\n      ]\n    }\n  }\n}\n```\n\n**Witness Run Command:**\n```bash\nwitness run --step build \\\n  --attestations environment,commandrun,github,product \\\n  --outfile build-attestation.json \\\n  --key signing-key.pem \\\n  -- <your-build-command>\n```\n\n**Rego Validation Rules:**\n```rego\npackage environment\n\nimport rego.v1\n\n# Ensure correct OS\ndeny contains msg if {\n    input.os != \"windows\"\n    msg := sprintf(\"Must run on windows, got: %s\", [input.os])\n}\n\n# Require CI environment\ndeny contains msg if {\n    not \"CI\" in input.variables\n    msg := \"Must run in CI environment (CI variable not set)\"\n}\n```\n\n**Verification:**\n```bash\nwitness verify \\\n  --policy policy-signed.json \\\n  --publickey policy-key.pub \\\n  -a build-attestation.json \\\n  --subject <artifact>\n```\n"}]}
{"messages": [{"role": "system", "content": "You are an expert in the Witness supply chain attestation framework. You help users instrument CI/CD pipelines with witness, create policy documents, and write Rego policies to validate attestations. You understand all attestors in go-witness and how to use them effectively."}, {"role": "user", "content": "How do I create a witness policy for a build step that uses these attestors: github, material, product, commandrun, environment?"}, {"role": "assistant", "content": "Here's a complete witness policy for your build step with github, material, product, commandrun, environment attestors:\n\n**Policy Document:**\n```json\n{\n  \"expires\": \"2026-11-08T10:52:59Z\",\n  \"publickeys\": {\n    \"build-key\": {\n      \"keyid\": \"sha256:e25a6786f75fb5dc5f1286d98925017d65961d8a08dc8e41d207f52eb8ec057c\",\n      \"key\": \"-----BEGIN PUBLIC KEY-----\\n...\\n-----END PUBLIC KEY-----\"\n    }\n  },\n  \"steps\": {\n    \"build\": {\n      \"name\": \"build\",\n      \"attestations\": [\n        {\n          \"type\": \"https://witness.dev/attestations/github/v0.1\"\n        },\n        {\n          \"type\": \"https://witness.dev/attestations/material/v0.1\"\n        },\n        {\n          \"type\": \"https://witness.dev/attestations/product/v0.1\"\n        },\n        {\n          \"type\": \"https://witness.dev/attestations/command-run/v0.1\"\n        },\n        {\n          \"type\": \"https://witness.dev/attestations/environment/v0.1\"\n        }\n      ],\n      \"functionaries\": [\n        {\n          \"type\": \"publickey\",\n          \"publickeyid\": \"build-key\"\n        }\n      ]\n    }\n  }\n}\n```\n\n**Witness Run Command:**\n```bash\nwitness run --step build \\\n  --attestations github,material,product,commandrun,environment \\\n  --outfile build-attestation.json \\\n  --key signing-key.pem \\\n  -- <your-build-command>\n```\n\n**Rego Validation Rules:**\n```rego\n\n```\n\n**Verification:**\n```bash\nwitness verify \\\n  --policy policy-signed.json \\\n  --publickey policy-key.pub \\\n  -a build-attestation.json \\\n  --subject <artifact>\n```\n"}]}
{"messages": [{"role": "system", "content": "You are an expert in the Witness supply chain attestation framework. You help users instrument CI/CD pipelines with witness, create policy documents, and write Rego policies to validate attestations. You understand all attestors in go-witness and how to use them effectively."}, {"role": "user", "content": "How do I create a witness policy for a build step that uses these attestors: product, github?"}, {"role": "assistant", "content": "Here's a complete witness policy for your build step with product, github attestors:\n\n**Policy Document:**\n```json\n{\n  \"expires\": \"2026-11-08T10:52:59Z\",\n  \"publickeys\": {\n    \"build-key\": {\n      \"keyid\": \"sha256:2e56b7380595b88fbc7a2a15e79f1dd85d8a59e5b75ba14f59dece7fe78e3a25\",\n      \"key\": \"-----BEGIN PUBLIC KEY-----\\n...\\n-----END PUBLIC KEY-----\"\n    }\n  },\n  \"steps\": {\n    \"build\": {\n      \"name\": \"build\",\n      \"attestations\": [\n        {\n          \"type\": \"https://witness.dev/attestations/product/v0.1\"\n        },\n        {\n          \"type\": \"https://witness.dev/attestations/github/v0.1\"\n        }\n      ],\n      \"functionaries\": [\n        {\n          \"type\": \"publickey\",\n          \"publickeyid\": \"build-key\"\n        }\n      ]\n    }\n  }\n}\n```\n\n**Witness Run Command:**\n```bash\nwitness run --step build \\\n  --attestations product,github \\\n  --outfile build-attestation.json \\\n  --key signing-key.pem \\\n  -- <your-build-command>\n```\n\n**Rego Validation Rules:**\n```rego\n\n```\n\n**Verification:**\n```bash\nwitness verify \\\n  --policy policy-signed.json \\\n  --publickey policy-key.pub \\\n  -a build-attestation.json \\\n  --subject <artifact>\n```\n"}]}
{"messages": [{"role": "system", "content": "You are an expert in the Witness supply chain attestation framework. You help users instrument CI/CD pipelines with witness, create policy documents, and write Rego policies to validate attestations. You understand all attestors in go-witness and how to use them effectively."}, {"role": "user", "content": "How do I create a multi-step witness policy for a build \u2192 test \u2192 package pipeline?"}, {"role": "assistant", "content": "Here's a complete multi-step witness policy for your pipeline:\n\n**Policy Document:**\n```json\n{\n  \"expires\": \"2026-11-08T10:52:59Z\",\n  \"publickeys\": {\n    \"ci-key\": {\n      \"keyid\": \"sha256:f363ace502f072a0c51ddddcca26051a4eba22e0b66295e748d50eb4385ef6b2\",\n      \"key\": \"-----BEGIN PUBLIC KEY-----\\n...\\n-----END PUBLIC KEY-----\"\n    }\n  },\n  \"steps\": {\n    \"build\": {\n      \"name\": \"build\",\n      \"attestations\": [\n        {\n          \"type\": \"https://witness.dev/attestations/git/v0.1\"\n        },\n        {\n          \"type\": \"https://witness.dev/attestations/command-run/v0.1\"\n        },\n        {\n          \"type\": \"https://witness.dev/attestations/product/v0.1\"\n        }\n      ],\n      \"functionaries\": [\n        {\n          \"type\": \"publickey\",\n          \"publickeyid\": \"ci-key\"\n        }\n      ]\n    },\n    \"test\": {\n      \"name\": \"test\",\n      \"attestations\": [\n        {\n          \"type\": \"https://witness.dev/attestations/material/v0.1\"\n        },\n        {\n          \"type\": \"https://witness.dev/attestations/command-run/v0.1\"\n        }\n      ],\n      \"functionaries\": [\n        {\n          \"type\": \"publickey\",\n          \"publickeyid\": \"ci-key\"\n        }\n      ]\n    },\n    \"package\": {\n      \"name\": \"package\",\n      \"attestations\": [\n        {\n          \"type\": \"https://witness.dev/attestations/material/v0.1\"\n        },\n        {\n          \"type\": \"https://witness.dev/attestations/product/v0.1\"\n        }\n      ],\n      \"functionaries\": [\n        {\n          \"type\": \"publickey\",\n          \"publickeyid\": \"ci-key\"\n        }\n      ]\n    }\n  }\n}\n```\n\n**Pipeline Commands:**\n\n```bash\n# Step 1: Build\nwitness run --step build \\\n  --attestations git,commandrun,product \\\n  -o build.json --key ci-key.pem \\\n  -- go build -o myapp\n\n# Step 2: Test\nwitness run --step test \\\n  --attestations material,commandrun \\\n  -o test.json --key ci-key.pem \\\n  -- go test ./...\n\n# Step 3: Package\nwitness run --step package \\\n  --attestations material,product \\\n  -o package.json --key ci-key.pem \\\n  -- tar czf myapp.tar.gz myapp\n\n# Verify entire pipeline\nwitness verify \\\n  --policy policy-signed.json \\\n  --publickey policy-key.pub \\\n  -a build.json -a test.json -a package.json\n```\n"}]}
{"messages": [{"role": "system", "content": "You are an expert in the Witness supply chain attestation framework. You help users instrument CI/CD pipelines with witness, create policy documents, and write Rego policies to validate attestations. You understand all attestors in go-witness and how to use them effectively."}, {"role": "user", "content": "How do I create a multi-step witness policy for a build \u2192 test \u2192 package pipeline?"}, {"role": "assistant", "content": "Here's a complete multi-step witness policy for your pipeline:\n\n**Policy Document:**\n```json\n{\n  \"expires\": \"2026-11-08T10:52:59Z\",\n  \"publickeys\": {\n    \"ci-key\": {\n      \"keyid\": \"sha256:560c75312be98e6537629f8034d5f34648e5eebafe2ccf9505c01386aa655d50\",\n      \"key\": \"-----BEGIN PUBLIC KEY-----\\n...\\n-----END PUBLIC KEY-----\"\n    }\n  },\n  \"steps\": {\n    \"build\": {\n      \"name\": \"build\",\n      \"attestations\": [\n        {\n          \"type\": \"https://witness.dev/attestations/git/v0.1\"\n        },\n        {\n          \"type\": \"https://witness.dev/attestations/command-run/v0.1\"\n        },\n        {\n          \"type\": \"https://witness.dev/attestations/product/v0.1\"\n        }\n      ],\n      \"functionaries\": [\n        {\n          \"type\": \"publickey\",\n          \"publickeyid\": \"ci-key\"\n        }\n      ]\n    },\n    \"test\": {\n      \"name\": \"test\",\n      \"attestations\": [\n        {\n          \"type\": \"https://witness.dev/attestations/material/v0.1\"\n        },\n        {\n          \"type\": \"https://witness.dev/attestations/command-run/v0.1\"\n        }\n      ],\n      \"functionaries\": [\n        {\n          \"type\": \"publickey\",\n          \"publickeyid\": \"ci-key\"\n        }\n      ]\n    },\n    \"package\": {\n      \"name\": \"package\",\n      \"attestations\": [\n        {\n          \"type\": \"https://witness.dev/attestations/material/v0.1\"\n        },\n        {\n          \"type\": \"https://witness.dev/attestations/product/v0.1\"\n        }\n      ],\n      \"functionaries\": [\n        {\n          \"type\": \"publickey\",\n          \"publickeyid\": \"ci-key\"\n        }\n      ]\n    }\n  }\n}\n```\n\n**Pipeline Commands:**\n\n```bash\n# Step 1: Build\nwitness run --step build \\\n  --attestations git,commandrun,product \\\n  -o build.json --key ci-key.pem \\\n  -- go build -o myapp\n\n# Step 2: Test\nwitness run --step test \\\n  --attestations material,commandrun \\\n  -o test.json --key ci-key.pem \\\n  -- go test ./...\n\n# Step 3: Package\nwitness run --step package \\\n  --attestations material,product \\\n  -o package.json --key ci-key.pem \\\n  -- tar czf myapp.tar.gz myapp\n\n# Verify entire pipeline\nwitness verify \\\n  --policy policy-signed.json \\\n  --publickey policy-key.pub \\\n  -a build.json -a test.json -a package.json\n```\n"}]}
{"messages": [{"role": "system", "content": "You are an expert in the Witness supply chain attestation framework. You help users instrument CI/CD pipelines with witness, create policy documents, and write Rego policies to validate attestations. You understand all attestors in go-witness and how to use them effectively."}, {"role": "user", "content": "How do I create a witness policy for a build step that uses these attestors: environment, material, commandrun, product?"}, {"role": "assistant", "content": "Here's a complete witness policy for your build step with environment, material, commandrun, product attestors:\n\n**Policy Document:**\n```json\n{\n  \"expires\": \"2026-11-08T10:52:59Z\",\n  \"publickeys\": {\n    \"build-key\": {\n      \"keyid\": \"sha256:b121d8a9770d155907d1ef705265dfbe4618aee1eba34a73c6a2bd72b3273499\",\n      \"key\": \"-----BEGIN PUBLIC KEY-----\\n...\\n-----END PUBLIC KEY-----\"\n    }\n  },\n  \"steps\": {\n    \"build\": {\n      \"name\": \"build\",\n      \"attestations\": [\n        {\n          \"type\": \"https://witness.dev/attestations/environment/v0.1\"\n        },\n        {\n          \"type\": \"https://witness.dev/attestations/material/v0.1\"\n        },\n        {\n          \"type\": \"https://witness.dev/attestations/command-run/v0.1\"\n        },\n        {\n          \"type\": \"https://witness.dev/attestations/product/v0.1\"\n        }\n      ],\n      \"functionaries\": [\n        {\n          \"type\": \"publickey\",\n          \"publickeyid\": \"build-key\"\n        }\n      ]\n    }\n  }\n}\n```\n\n**Witness Run Command:**\n```bash\nwitness run --step build \\\n  --attestations environment,material,commandrun,product \\\n  --outfile build-attestation.json \\\n  --key signing-key.pem \\\n  -- <your-build-command>\n```\n\n**Rego Validation Rules:**\n```rego\npackage environment\n\nimport rego.v1\n\n# Ensure correct OS\ndeny contains msg if {\n    input.os != \"windows\"\n    msg := sprintf(\"Must run on windows, got: %s\", [input.os])\n}\n\n# Require CI environment\ndeny contains msg if {\n    not \"CI\" in input.variables\n    msg := \"Must run in CI environment (CI variable not set)\"\n}\n```\n\n**Verification:**\n```bash\nwitness verify \\\n  --policy policy-signed.json \\\n  --publickey policy-key.pub \\\n  -a build-attestation.json \\\n  --subject <artifact>\n```\n"}]}
{"messages": [{"role": "system", "content": "You are an expert in the Witness supply chain attestation framework. You help users instrument CI/CD pipelines with witness, create policy documents, and write Rego policies to validate attestations. You understand all attestors in go-witness and how to use them effectively."}, {"role": "user", "content": "How do I create a multi-step witness policy for a build \u2192 test \u2192 package pipeline?"}, {"role": "assistant", "content": "Here's a complete multi-step witness policy for your pipeline:\n\n**Policy Document:**\n```json\n{\n  \"expires\": \"2026-11-08T10:52:59Z\",\n  \"publickeys\": {\n    \"ci-key\": {\n      \"keyid\": \"sha256:9b342bb6da38ed95e0369c915f8faaa827185151bc5ccc23c4600e39e0c20174\",\n      \"key\": \"-----BEGIN PUBLIC KEY-----\\n...\\n-----END PUBLIC KEY-----\"\n    }\n  },\n  \"steps\": {\n    \"build\": {\n      \"name\": \"build\",\n      \"attestations\": [\n        {\n          \"type\": \"https://witness.dev/attestations/git/v0.1\"\n        },\n        {\n          \"type\": \"https://witness.dev/attestations/command-run/v0.1\"\n        },\n        {\n          \"type\": \"https://witness.dev/attestations/product/v0.1\"\n        }\n      ],\n      \"functionaries\": [\n        {\n          \"type\": \"publickey\",\n          \"publickeyid\": \"ci-key\"\n        }\n      ]\n    },\n    \"test\": {\n      \"name\": \"test\",\n      \"attestations\": [\n        {\n          \"type\": \"https://witness.dev/attestations/material/v0.1\"\n        },\n        {\n          \"type\": \"https://witness.dev/attestations/command-run/v0.1\"\n        }\n      ],\n      \"functionaries\": [\n        {\n          \"type\": \"publickey\",\n          \"publickeyid\": \"ci-key\"\n        }\n      ]\n    },\n    \"package\": {\n      \"name\": \"package\",\n      \"attestations\": [\n        {\n          \"type\": \"https://witness.dev/attestations/material/v0.1\"\n        },\n        {\n          \"type\": \"https://witness.dev/attestations/product/v0.1\"\n        }\n      ],\n      \"functionaries\": [\n        {\n          \"type\": \"publickey\",\n          \"publickeyid\": \"ci-key\"\n        }\n      ]\n    }\n  }\n}\n```\n\n**Pipeline Commands:**\n\n```bash\n# Step 1: Build\nwitness run --step build \\\n  --attestations git,commandrun,product \\\n  -o build.json --key ci-key.pem \\\n  -- go build -o myapp\n\n# Step 2: Test\nwitness run --step test \\\n  --attestations material,commandrun \\\n  -o test.json --key ci-key.pem \\\n  -- go test ./...\n\n# Step 3: Package\nwitness run --step package \\\n  --attestations material,product \\\n  -o package.json --key ci-key.pem \\\n  -- tar czf myapp.tar.gz myapp\n\n# Verify entire pipeline\nwitness verify \\\n  --policy policy-signed.json \\\n  --publickey policy-key.pub \\\n  -a build.json -a test.json -a package.json\n```\n"}]}
{"messages": [{"role": "system", "content": "You are an expert in the Witness supply chain attestation framework. You help users instrument CI/CD pipelines with witness, create policy documents, and write Rego policies to validate attestations. You understand all attestors in go-witness and how to use them effectively."}, {"role": "user", "content": "How do I create a witness policy for a build step that uses these attestors: github, git, material, product?"}, {"role": "assistant", "content": "Here's a complete witness policy for your build step with github, git, material, product attestors:\n\n**Policy Document:**\n```json\n{\n  \"expires\": \"2026-11-08T10:52:59Z\",\n  \"publickeys\": {\n    \"build-key\": {\n      \"keyid\": \"sha256:9ce2a33f5342a259c566f434bb0e6965fdf39c71fd13c59065f4ecdf38d92eae\",\n      \"key\": \"-----BEGIN PUBLIC KEY-----\\n...\\n-----END PUBLIC KEY-----\"\n    }\n  },\n  \"steps\": {\n    \"build\": {\n      \"name\": \"build\",\n      \"attestations\": [\n        {\n          \"type\": \"https://witness.dev/attestations/github/v0.1\"\n        },\n        {\n          \"type\": \"https://witness.dev/attestations/git/v0.1\"\n        },\n        {\n          \"type\": \"https://witness.dev/attestations/material/v0.1\"\n        },\n        {\n          \"type\": \"https://witness.dev/attestations/product/v0.1\"\n        }\n      ],\n      \"functionaries\": [\n        {\n          \"type\": \"publickey\",\n          \"publickeyid\": \"build-key\"\n        }\n      ]\n    }\n  }\n}\n```\n\n**Witness Run Command:**\n```bash\nwitness run --step build \\\n  --attestations github,git,material,product \\\n  --outfile build-attestation.json \\\n  --key signing-key.pem \\\n  -- <your-build-command>\n```\n\n**Rego Validation Rules:**\n```rego\n\n```\n\n**Verification:**\n```bash\nwitness verify \\\n  --policy policy-signed.json \\\n  --publickey policy-key.pub \\\n  -a build-attestation.json \\\n  --subject <artifact>\n```\n"}]}
{"messages": [{"role": "system", "content": "You are an expert in the Witness supply chain attestation framework. You help users instrument CI/CD pipelines with witness, create policy documents, and write Rego policies to validate attestations. You understand all attestors in go-witness and how to use them effectively."}, {"role": "user", "content": "How do I create a witness policy for a build step that uses these attestors: github, environment, git, product, material?"}, {"role": "assistant", "content": "Here's a complete witness policy for your build step with github, environment, git, product, material attestors:\n\n**Policy Document:**\n```json\n{\n  \"expires\": \"2026-11-08T10:52:59Z\",\n  \"publickeys\": {\n    \"build-key\": {\n      \"keyid\": \"sha256:04f7622c3699639d9dd33691472429812fada5c7e3ba71ae6da3a3335651ba77\",\n      \"key\": \"-----BEGIN PUBLIC KEY-----\\n...\\n-----END PUBLIC KEY-----\"\n    }\n  },\n  \"steps\": {\n    \"build\": {\n      \"name\": \"build\",\n      \"attestations\": [\n        {\n          \"type\": \"https://witness.dev/attestations/github/v0.1\"\n        },\n        {\n          \"type\": \"https://witness.dev/attestations/environment/v0.1\"\n        },\n        {\n          \"type\": \"https://witness.dev/attestations/git/v0.1\"\n        },\n        {\n          \"type\": \"https://witness.dev/attestations/product/v0.1\"\n        },\n        {\n          \"type\": \"https://witness.dev/attestations/material/v0.1\"\n        }\n      ],\n      \"functionaries\": [\n        {\n          \"type\": \"publickey\",\n          \"publickeyid\": \"build-key\"\n        }\n      ]\n    }\n  }\n}\n```\n\n**Witness Run Command:**\n```bash\nwitness run --step build \\\n  --attestations github,environment,git,product,material \\\n  --outfile build-attestation.json \\\n  --key signing-key.pem \\\n  -- <your-build-command>\n```\n\n**Rego Validation Rules:**\n```rego\n\n```\n\n**Verification:**\n```bash\nwitness verify \\\n  --policy policy-signed.json \\\n  --publickey policy-key.pub \\\n  -a build-attestation.json \\\n  --subject <artifact>\n```\n"}]}
{"messages": [{"role": "system", "content": "You are an expert in the Witness supply chain attestation framework. You help users instrument CI/CD pipelines with witness, create policy documents, and write Rego policies to validate attestations. You understand all attestors in go-witness and how to use them effectively."}, {"role": "user", "content": "How do I create a witness policy for a build step that uses these attestors: github, commandrun, git, material, environment?"}, {"role": "assistant", "content": "Here's a complete witness policy for your build step with github, commandrun, git, material, environment attestors:\n\n**Policy Document:**\n```json\n{\n  \"expires\": \"2026-11-08T10:52:59Z\",\n  \"publickeys\": {\n    \"build-key\": {\n      \"keyid\": \"sha256:1e9e552fcb0605fc2f0cbf3f1676b6c357bf2cc518913a442035c275e54a3b94\",\n      \"key\": \"-----BEGIN PUBLIC KEY-----\\n...\\n-----END PUBLIC KEY-----\"\n    }\n  },\n  \"steps\": {\n    \"build\": {\n      \"name\": \"build\",\n      \"attestations\": [\n        {\n          \"type\": \"https://witness.dev/attestations/github/v0.1\"\n        },\n        {\n          \"type\": \"https://witness.dev/attestations/command-run/v0.1\"\n        },\n        {\n          \"type\": \"https://witness.dev/attestations/git/v0.1\"\n        },\n        {\n          \"type\": \"https://witness.dev/attestations/material/v0.1\"\n        },\n        {\n          \"type\": \"https://witness.dev/attestations/environment/v0.1\"\n        }\n      ],\n      \"functionaries\": [\n        {\n          \"type\": \"publickey\",\n          \"publickeyid\": \"build-key\"\n        }\n      ]\n    }\n  }\n}\n```\n\n**Witness Run Command:**\n```bash\nwitness run --step build \\\n  --attestations github,commandrun,git,material,environment \\\n  --outfile build-attestation.json \\\n  --key signing-key.pem \\\n  -- <your-build-command>\n```\n\n**Rego Validation Rules:**\n```rego\n\n```\n\n**Verification:**\n```bash\nwitness verify \\\n  --policy policy-signed.json \\\n  --publickey policy-key.pub \\\n  -a build-attestation.json \\\n  --subject <artifact>\n```\n"}]}
{"messages": [{"role": "system", "content": "You are an expert in the Witness supply chain attestation framework. You help users instrument CI/CD pipelines with witness, create policy documents, and write Rego policies to validate attestations. You understand all attestors in go-witness and how to use them effectively."}, {"role": "user", "content": "How do I create a witness policy for a build step that uses these attestors: commandrun, github, product, git?"}, {"role": "assistant", "content": "Here's a complete witness policy for your build step with commandrun, github, product, git attestors:\n\n**Policy Document:**\n```json\n{\n  \"expires\": \"2026-11-08T10:52:59Z\",\n  \"publickeys\": {\n    \"build-key\": {\n      \"keyid\": \"sha256:de99c33e117a9c1e4fe2445e6297098c7f764dc758fa80725892f086c0df2cb2\",\n      \"key\": \"-----BEGIN PUBLIC KEY-----\\n...\\n-----END PUBLIC KEY-----\"\n    }\n  },\n  \"steps\": {\n    \"build\": {\n      \"name\": \"build\",\n      \"attestations\": [\n        {\n          \"type\": \"https://witness.dev/attestations/command-run/v0.1\"\n        },\n        {\n          \"type\": \"https://witness.dev/attestations/github/v0.1\"\n        },\n        {\n          \"type\": \"https://witness.dev/attestations/product/v0.1\"\n        },\n        {\n          \"type\": \"https://witness.dev/attestations/git/v0.1\"\n        }\n      ],\n      \"functionaries\": [\n        {\n          \"type\": \"publickey\",\n          \"publickeyid\": \"build-key\"\n        }\n      ]\n    }\n  }\n}\n```\n\n**Witness Run Command:**\n```bash\nwitness run --step build \\\n  --attestations commandrun,github,product,git \\\n  --outfile build-attestation.json \\\n  --key signing-key.pem \\\n  -- <your-build-command>\n```\n\n**Rego Validation Rules:**\n```rego\n\n```\n\n**Verification:**\n```bash\nwitness verify \\\n  --policy policy-signed.json \\\n  --publickey policy-key.pub \\\n  -a build-attestation.json \\\n  --subject <artifact>\n```\n"}]}
{"messages": [{"role": "system", "content": "You are an expert in the Witness supply chain attestation framework. You help users instrument CI/CD pipelines with witness, create policy documents, and write Rego policies to validate attestations. You understand all attestors in go-witness and how to use them effectively."}, {"role": "user", "content": "How do I create a multi-step witness policy for a build \u2192 test \u2192 package pipeline?"}, {"role": "assistant", "content": "Here's a complete multi-step witness policy for your pipeline:\n\n**Policy Document:**\n```json\n{\n  \"expires\": \"2026-11-08T10:52:59Z\",\n  \"publickeys\": {\n    \"ci-key\": {\n      \"keyid\": \"sha256:0abd2df45e08558a0ec45082f66f9c3b04c5ea7e37db2ae82cf44f7f84773b91\",\n      \"key\": \"-----BEGIN PUBLIC KEY-----\\n...\\n-----END PUBLIC KEY-----\"\n    }\n  },\n  \"steps\": {\n    \"build\": {\n      \"name\": \"build\",\n      \"attestations\": [\n        {\n          \"type\": \"https://witness.dev/attestations/git/v0.1\"\n        },\n        {\n          \"type\": \"https://witness.dev/attestations/command-run/v0.1\"\n        },\n        {\n          \"type\": \"https://witness.dev/attestations/product/v0.1\"\n        }\n      ],\n      \"functionaries\": [\n        {\n          \"type\": \"publickey\",\n          \"publickeyid\": \"ci-key\"\n        }\n      ]\n    },\n    \"test\": {\n      \"name\": \"test\",\n      \"attestations\": [\n        {\n          \"type\": \"https://witness.dev/attestations/material/v0.1\"\n        },\n        {\n          \"type\": \"https://witness.dev/attestations/command-run/v0.1\"\n        }\n      ],\n      \"functionaries\": [\n        {\n          \"type\": \"publickey\",\n          \"publickeyid\": \"ci-key\"\n        }\n      ]\n    },\n    \"package\": {\n      \"name\": \"package\",\n      \"attestations\": [\n        {\n          \"type\": \"https://witness.dev/attestations/material/v0.1\"\n        },\n        {\n          \"type\": \"https://witness.dev/attestations/product/v0.1\"\n        }\n      ],\n      \"functionaries\": [\n        {\n          \"type\": \"publickey\",\n          \"publickeyid\": \"ci-key\"\n        }\n      ]\n    }\n  }\n}\n```\n\n**Pipeline Commands:**\n\n```bash\n# Step 1: Build\nwitness run --step build \\\n  --attestations git,commandrun,product \\\n  -o build.json --key ci-key.pem \\\n  -- go build -o myapp\n\n# Step 2: Test\nwitness run --step test \\\n  --attestations material,commandrun \\\n  -o test.json --key ci-key.pem \\\n  -- go test ./...\n\n# Step 3: Package\nwitness run --step package \\\n  --attestations material,product \\\n  -o package.json --key ci-key.pem \\\n  -- tar czf myapp.tar.gz myapp\n\n# Verify entire pipeline\nwitness verify \\\n  --policy policy-signed.json \\\n  --publickey policy-key.pub \\\n  -a build.json -a test.json -a package.json\n```\n"}]}
{"messages": [{"role": "system", "content": "You are an expert in the Witness supply chain attestation framework. You help users instrument CI/CD pipelines with witness, create policy documents, and write Rego policies to validate attestations. You understand all attestors in go-witness and how to use them effectively."}, {"role": "user", "content": "How do I create a witness policy for a build step that uses these attestors: environment?"}, {"role": "assistant", "content": "Here's a complete witness policy for your build step with environment attestors:\n\n**Policy Document:**\n```json\n{\n  \"expires\": \"2026-11-08T10:52:59Z\",\n  \"publickeys\": {\n    \"build-key\": {\n      \"keyid\": \"sha256:ba3868021243838bffb9f142cb164ab725ea80732e87017c4f6a8a456685a180\",\n      \"key\": \"-----BEGIN PUBLIC KEY-----\\n...\\n-----END PUBLIC KEY-----\"\n    }\n  },\n  \"steps\": {\n    \"build\": {\n      \"name\": \"build\",\n      \"attestations\": [\n        {\n          \"type\": \"https://witness.dev/attestations/environment/v0.1\"\n        }\n      ],\n      \"functionaries\": [\n        {\n          \"type\": \"publickey\",\n          \"publickeyid\": \"build-key\"\n        }\n      ]\n    }\n  }\n}\n```\n\n**Witness Run Command:**\n```bash\nwitness run --step build \\\n  --attestations environment \\\n  --outfile build-attestation.json \\\n  --key signing-key.pem \\\n  -- <your-build-command>\n```\n\n**Rego Validation Rules:**\n```rego\npackage environment\n\nimport rego.v1\n\n# Ensure correct OS\ndeny contains msg if {\n    input.os != \"windows\"\n    msg := sprintf(\"Must run on windows, got: %s\", [input.os])\n}\n\n# Require CI environment\ndeny contains msg if {\n    not \"CI\" in input.variables\n    msg := \"Must run in CI environment (CI variable not set)\"\n}\n```\n\n**Verification:**\n```bash\nwitness verify \\\n  --policy policy-signed.json \\\n  --publickey policy-key.pub \\\n  -a build-attestation.json \\\n  --subject <artifact>\n```\n"}]}
{"messages": [{"role": "system", "content": "You are an expert in the Witness supply chain attestation framework. You help users instrument CI/CD pipelines with witness, create policy documents, and write Rego policies to validate attestations. You understand all attestors in go-witness and how to use them effectively."}, {"role": "user", "content": "How do I create a witness policy for a build step that uses these attestors: github, environment?"}, {"role": "assistant", "content": "Here's a complete witness policy for your build step with github, environment attestors:\n\n**Policy Document:**\n```json\n{\n  \"expires\": \"2026-11-08T10:52:59Z\",\n  \"publickeys\": {\n    \"build-key\": {\n      \"keyid\": \"sha256:9ef0a2105a662cb820f84da2e2af38913ecde7992552ab1200bc64ca83086c70\",\n      \"key\": \"-----BEGIN PUBLIC KEY-----\\n...\\n-----END PUBLIC KEY-----\"\n    }\n  },\n  \"steps\": {\n    \"build\": {\n      \"name\": \"build\",\n      \"attestations\": [\n        {\n          \"type\": \"https://witness.dev/attestations/github/v0.1\"\n        },\n        {\n          \"type\": \"https://witness.dev/attestations/environment/v0.1\"\n        }\n      ],\n      \"functionaries\": [\n        {\n          \"type\": \"publickey\",\n          \"publickeyid\": \"build-key\"\n        }\n      ]\n    }\n  }\n}\n```\n\n**Witness Run Command:**\n```bash\nwitness run --step build \\\n  --attestations github,environment \\\n  --outfile build-attestation.json \\\n  --key signing-key.pem \\\n  -- <your-build-command>\n```\n\n**Rego Validation Rules:**\n```rego\n\n```\n\n**Verification:**\n```bash\nwitness verify \\\n  --policy policy-signed.json \\\n  --publickey policy-key.pub \\\n  -a build-attestation.json \\\n  --subject <artifact>\n```\n"}]}
{"messages": [{"role": "system", "content": "You are an expert in the Witness supply chain attestation framework. You help users instrument CI/CD pipelines with witness, create policy documents, and write Rego policies to validate attestations. You understand all attestors in go-witness and how to use them effectively."}, {"role": "user", "content": "How do I create a witness policy for a build step that uses these attestors: product, commandrun, material?"}, {"role": "assistant", "content": "Here's a complete witness policy for your build step with product, commandrun, material attestors:\n\n**Policy Document:**\n```json\n{\n  \"expires\": \"2026-11-08T10:52:59Z\",\n  \"publickeys\": {\n    \"build-key\": {\n      \"keyid\": \"sha256:2425e4e0975a200ea0b1839fe35d4817b02d7f6e39612d41b4e8a008b1e21b42\",\n      \"key\": \"-----BEGIN PUBLIC KEY-----\\n...\\n-----END PUBLIC KEY-----\"\n    }\n  },\n  \"steps\": {\n    \"build\": {\n      \"name\": \"build\",\n      \"attestations\": [\n        {\n          \"type\": \"https://witness.dev/attestations/product/v0.1\"\n        },\n        {\n          \"type\": \"https://witness.dev/attestations/command-run/v0.1\"\n        },\n        {\n          \"type\": \"https://witness.dev/attestations/material/v0.1\"\n        }\n      ],\n      \"functionaries\": [\n        {\n          \"type\": \"publickey\",\n          \"publickeyid\": \"build-key\"\n        }\n      ]\n    }\n  }\n}\n```\n\n**Witness Run Command:**\n```bash\nwitness run --step build \\\n  --attestations product,commandrun,material \\\n  --outfile build-attestation.json \\\n  --key signing-key.pem \\\n  -- <your-build-command>\n```\n\n**Rego Validation Rules:**\n```rego\n\n```\n\n**Verification:**\n```bash\nwitness verify \\\n  --policy policy-signed.json \\\n  --publickey policy-key.pub \\\n  -a build-attestation.json \\\n  --subject <artifact>\n```\n"}]}
{"messages": [{"role": "system", "content": "You are an expert in the Witness supply chain attestation framework. You help users instrument CI/CD pipelines with witness, create policy documents, and write Rego policies to validate attestations. You understand all attestors in go-witness and how to use them effectively."}, {"role": "user", "content": "How do I create a multi-step witness policy for a build \u2192 test \u2192 package pipeline?"}, {"role": "assistant", "content": "Here's a complete multi-step witness policy for your pipeline:\n\n**Policy Document:**\n```json\n{\n  \"expires\": \"2026-11-08T10:52:59Z\",\n  \"publickeys\": {\n    \"ci-key\": {\n      \"keyid\": \"sha256:3f4e35c5d6bc9c530f577648737056d307dfa6e3d7e001220ae9208f91651179\",\n      \"key\": \"-----BEGIN PUBLIC KEY-----\\n...\\n-----END PUBLIC KEY-----\"\n    }\n  },\n  \"steps\": {\n    \"build\": {\n      \"name\": \"build\",\n      \"attestations\": [\n        {\n          \"type\": \"https://witness.dev/attestations/git/v0.1\"\n        },\n        {\n          \"type\": \"https://witness.dev/attestations/command-run/v0.1\"\n        },\n        {\n          \"type\": \"https://witness.dev/attestations/product/v0.1\"\n        }\n      ],\n      \"functionaries\": [\n        {\n          \"type\": \"publickey\",\n          \"publickeyid\": \"ci-key\"\n        }\n      ]\n    },\n    \"test\": {\n      \"name\": \"test\",\n      \"attestations\": [\n        {\n          \"type\": \"https://witness.dev/attestations/material/v0.1\"\n        },\n        {\n          \"type\": \"https://witness.dev/attestations/command-run/v0.1\"\n        }\n      ],\n      \"functionaries\": [\n        {\n          \"type\": \"publickey\",\n          \"publickeyid\": \"ci-key\"\n        }\n      ]\n    },\n    \"package\": {\n      \"name\": \"package\",\n      \"attestations\": [\n        {\n          \"type\": \"https://witness.dev/attestations/material/v0.1\"\n        },\n        {\n          \"type\": \"https://witness.dev/attestations/product/v0.1\"\n        }\n      ],\n      \"functionaries\": [\n        {\n          \"type\": \"publickey\",\n          \"publickeyid\": \"ci-key\"\n        }\n      ]\n    }\n  }\n}\n```\n\n**Pipeline Commands:**\n\n```bash\n# Step 1: Build\nwitness run --step build \\\n  --attestations git,commandrun,product \\\n  -o build.json --key ci-key.pem \\\n  -- go build -o myapp\n\n# Step 2: Test\nwitness run --step test \\\n  --attestations material,commandrun \\\n  -o test.json --key ci-key.pem \\\n  -- go test ./...\n\n# Step 3: Package\nwitness run --step package \\\n  --attestations material,product \\\n  -o package.json --key ci-key.pem \\\n  -- tar czf myapp.tar.gz myapp\n\n# Verify entire pipeline\nwitness verify \\\n  --policy policy-signed.json \\\n  --publickey policy-key.pub \\\n  -a build.json -a test.json -a package.json\n```\n"}]}
{"messages": [{"role": "system", "content": "You are an expert in the Witness supply chain attestation framework. You help users instrument CI/CD pipelines with witness, create policy documents, and write Rego policies to validate attestations. You understand all attestors in go-witness and how to use them effectively."}, {"role": "user", "content": "How do I create a multi-step witness policy for a build \u2192 test \u2192 package pipeline?"}, {"role": "assistant", "content": "Here's a complete multi-step witness policy for your pipeline:\n\n**Policy Document:**\n```json\n{\n  \"expires\": \"2026-11-08T10:52:59Z\",\n  \"publickeys\": {\n    \"ci-key\": {\n      \"keyid\": \"sha256:1fddac5e56f190cf6833a4e69fbefa1758ca21759daeeb17afe6d169051ae06c\",\n      \"key\": \"-----BEGIN PUBLIC KEY-----\\n...\\n-----END PUBLIC KEY-----\"\n    }\n  },\n  \"steps\": {\n    \"build\": {\n      \"name\": \"build\",\n      \"attestations\": [\n        {\n          \"type\": \"https://witness.dev/attestations/git/v0.1\"\n        },\n        {\n          \"type\": \"https://witness.dev/attestations/command-run/v0.1\"\n        },\n        {\n          \"type\": \"https://witness.dev/attestations/product/v0.1\"\n        }\n      ],\n      \"functionaries\": [\n        {\n          \"type\": \"publickey\",\n          \"publickeyid\": \"ci-key\"\n        }\n      ]\n    },\n    \"test\": {\n      \"name\": \"test\",\n      \"attestations\": [\n        {\n          \"type\": \"https://witness.dev/attestations/material/v0.1\"\n        },\n        {\n          \"type\": \"https://witness.dev/attestations/command-run/v0.1\"\n        }\n      ],\n      \"functionaries\": [\n        {\n          \"type\": \"publickey\",\n          \"publickeyid\": \"ci-key\"\n        }\n      ]\n    },\n    \"package\": {\n      \"name\": \"package\",\n      \"attestations\": [\n        {\n          \"type\": \"https://witness.dev/attestations/material/v0.1\"\n        },\n        {\n          \"type\": \"https://witness.dev/attestations/product/v0.1\"\n        }\n      ],\n      \"functionaries\": [\n        {\n          \"type\": \"publickey\",\n          \"publickeyid\": \"ci-key\"\n        }\n      ]\n    }\n  }\n}\n```\n\n**Pipeline Commands:**\n\n```bash\n# Step 1: Build\nwitness run --step build \\\n  --attestations git,commandrun,product \\\n  -o build.json --key ci-key.pem \\\n  -- go build -o myapp\n\n# Step 2: Test\nwitness run --step test \\\n  --attestations material,commandrun \\\n  -o test.json --key ci-key.pem \\\n  -- go test ./...\n\n# Step 3: Package\nwitness run --step package \\\n  --attestations material,product \\\n  -o package.json --key ci-key.pem \\\n  -- tar czf myapp.tar.gz myapp\n\n# Verify entire pipeline\nwitness verify \\\n  --policy policy-signed.json \\\n  --publickey policy-key.pub \\\n  -a build.json -a test.json -a package.json\n```\n"}]}
{"messages": [{"role": "system", "content": "You are an expert in the Witness supply chain attestation framework. You help users instrument CI/CD pipelines with witness, create policy documents, and write Rego policies to validate attestations. You understand all attestors in go-witness and how to use them effectively."}, {"role": "user", "content": "How do I create a multi-step witness policy for a build \u2192 test \u2192 package pipeline?"}, {"role": "assistant", "content": "Here's a complete multi-step witness policy for your pipeline:\n\n**Policy Document:**\n```json\n{\n  \"expires\": \"2026-11-08T10:52:59Z\",\n  \"publickeys\": {\n    \"ci-key\": {\n      \"keyid\": \"sha256:4ef4a5bf23c7d4c0f23963f06269cfdec418d621e3abc2bb4cbe877c897edfb6\",\n      \"key\": \"-----BEGIN PUBLIC KEY-----\\n...\\n-----END PUBLIC KEY-----\"\n    }\n  },\n  \"steps\": {\n    \"build\": {\n      \"name\": \"build\",\n      \"attestations\": [\n        {\n          \"type\": \"https://witness.dev/attestations/git/v0.1\"\n        },\n        {\n          \"type\": \"https://witness.dev/attestations/command-run/v0.1\"\n        },\n        {\n          \"type\": \"https://witness.dev/attestations/product/v0.1\"\n        }\n      ],\n      \"functionaries\": [\n        {\n          \"type\": \"publickey\",\n          \"publickeyid\": \"ci-key\"\n        }\n      ]\n    },\n    \"test\": {\n      \"name\": \"test\",\n      \"attestations\": [\n        {\n          \"type\": \"https://witness.dev/attestations/material/v0.1\"\n        },\n        {\n          \"type\": \"https://witness.dev/attestations/command-run/v0.1\"\n        }\n      ],\n      \"functionaries\": [\n        {\n          \"type\": \"publickey\",\n          \"publickeyid\": \"ci-key\"\n        }\n      ]\n    },\n    \"package\": {\n      \"name\": \"package\",\n      \"attestations\": [\n        {\n          \"type\": \"https://witness.dev/attestations/material/v0.1\"\n        },\n        {\n          \"type\": \"https://witness.dev/attestations/product/v0.1\"\n        }\n      ],\n      \"functionaries\": [\n        {\n          \"type\": \"publickey\",\n          \"publickeyid\": \"ci-key\"\n        }\n      ]\n    }\n  }\n}\n```\n\n**Pipeline Commands:**\n\n```bash\n# Step 1: Build\nwitness run --step build \\\n  --attestations git,commandrun,product \\\n  -o build.json --key ci-key.pem \\\n  -- go build -o myapp\n\n# Step 2: Test\nwitness run --step test \\\n  --attestations material,commandrun \\\n  -o test.json --key ci-key.pem \\\n  -- go test ./...\n\n# Step 3: Package\nwitness run --step package \\\n  --attestations material,product \\\n  -o package.json --key ci-key.pem \\\n  -- tar czf myapp.tar.gz myapp\n\n# Verify entire pipeline\nwitness verify \\\n  --policy policy-signed.json \\\n  --publickey policy-key.pub \\\n  -a build.json -a test.json -a package.json\n```\n"}]}
{"messages": [{"role": "system", "content": "You are an expert in the Witness supply chain attestation framework. You help users instrument CI/CD pipelines with witness, create policy documents, and write Rego policies to validate attestations. You understand all attestors in go-witness and how to use them effectively."}, {"role": "user", "content": "How do I create a witness policy for a build step that uses these attestors: commandrun, environment, product?"}, {"role": "assistant", "content": "Here's a complete witness policy for your build step with commandrun, environment, product attestors:\n\n**Policy Document:**\n```json\n{\n  \"expires\": \"2026-11-08T10:52:59Z\",\n  \"publickeys\": {\n    \"build-key\": {\n      \"keyid\": \"sha256:c46b695878c1bb6ab913c175b582d0633a3173cf05208392f7ca6581b177d802\",\n      \"key\": \"-----BEGIN PUBLIC KEY-----\\n...\\n-----END PUBLIC KEY-----\"\n    }\n  },\n  \"steps\": {\n    \"build\": {\n      \"name\": \"build\",\n      \"attestations\": [\n        {\n          \"type\": \"https://witness.dev/attestations/command-run/v0.1\"\n        },\n        {\n          \"type\": \"https://witness.dev/attestations/environment/v0.1\"\n        },\n        {\n          \"type\": \"https://witness.dev/attestations/product/v0.1\"\n        }\n      ],\n      \"functionaries\": [\n        {\n          \"type\": \"publickey\",\n          \"publickeyid\": \"build-key\"\n        }\n      ]\n    }\n  }\n}\n```\n\n**Witness Run Command:**\n```bash\nwitness run --step build \\\n  --attestations commandrun,environment,product \\\n  --outfile build-attestation.json \\\n  --key signing-key.pem \\\n  -- <your-build-command>\n```\n\n**Rego Validation Rules:**\n```rego\n\n```\n\n**Verification:**\n```bash\nwitness verify \\\n  --policy policy-signed.json \\\n  --publickey policy-key.pub \\\n  -a build-attestation.json \\\n  --subject <artifact>\n```\n"}]}
{"messages": [{"role": "system", "content": "You are an expert in the Witness supply chain attestation framework. You help users instrument CI/CD pipelines with witness, create policy documents, and write Rego policies to validate attestations. You understand all attestors in go-witness and how to use them effectively."}, {"role": "user", "content": "How do I create a witness policy for a build step that uses these attestors: git, commandrun, material?"}, {"role": "assistant", "content": "Here's a complete witness policy for your build step with git, commandrun, material attestors:\n\n**Policy Document:**\n```json\n{\n  \"expires\": \"2026-11-08T10:52:59Z\",\n  \"publickeys\": {\n    \"build-key\": {\n      \"keyid\": \"sha256:b1713c406145ee90ed6fee4181348595b02227fa8109990cfacbbd50ad761258\",\n      \"key\": \"-----BEGIN PUBLIC KEY-----\\n...\\n-----END PUBLIC KEY-----\"\n    }\n  },\n  \"steps\": {\n    \"build\": {\n      \"name\": \"build\",\n      \"attestations\": [\n        {\n          \"type\": \"https://witness.dev/attestations/git/v0.1\"\n        },\n        {\n          \"type\": \"https://witness.dev/attestations/command-run/v0.1\"\n        },\n        {\n          \"type\": \"https://witness.dev/attestations/material/v0.1\"\n        }\n      ],\n      \"functionaries\": [\n        {\n          \"type\": \"publickey\",\n          \"publickeyid\": \"build-key\"\n        }\n      ]\n    }\n  }\n}\n```\n\n**Witness Run Command:**\n```bash\nwitness run --step build \\\n  --attestations git,commandrun,material \\\n  --outfile build-attestation.json \\\n  --key signing-key.pem \\\n  -- <your-build-command>\n```\n\n**Rego Validation Rules:**\n```rego\npackage git\n\nimport rego.v1\n\n# Enforce builds from specific branch\ndeny contains msg if {\n    input.branch != \"hotfix/critical\"\n    msg := sprintf(\"Must build from hotfix/critical branch, got: %s\", [input.branch])\n}\n\n# Require clean working directory\ndeny contains msg if {\n    count(input.status) > 0\n    msg := \"Working directory must be clean (no uncommitted changes)\"\n}\n\n# Validate commit author\napproved_authors := {\n    \"alice.smith@example.com\",\n    \"bob.jones@company.com\",\n    \"ci-bot@company.com\"\n}\n\ndeny contains msg if {\n    not input.authoremail in approved_authors\n    msg := sprintf(\"Unauthorized commit author: %s\", [input.authoremail])\n}\n```\n\n**Verification:**\n```bash\nwitness verify \\\n  --policy policy-signed.json \\\n  --publickey policy-key.pub \\\n  -a build-attestation.json \\\n  --subject <artifact>\n```\n"}]}
{"messages": [{"role": "system", "content": "You are an expert in the Witness supply chain attestation framework. You help users instrument CI/CD pipelines with witness, create policy documents, and write Rego policies to validate attestations. You understand all attestors in go-witness and how to use them effectively."}, {"role": "user", "content": "How do I create a multi-step witness policy for a build \u2192 test \u2192 package pipeline?"}, {"role": "assistant", "content": "Here's a complete multi-step witness policy for your pipeline:\n\n**Policy Document:**\n```json\n{\n  \"expires\": \"2026-11-08T10:52:59Z\",\n  \"publickeys\": {\n    \"ci-key\": {\n      \"keyid\": \"sha256:ef9dc67a923803854ede8d4e0659e4ff55ac42d5cc9a973c724b987d56c814d3\",\n      \"key\": \"-----BEGIN PUBLIC KEY-----\\n...\\n-----END PUBLIC KEY-----\"\n    }\n  },\n  \"steps\": {\n    \"build\": {\n      \"name\": \"build\",\n      \"attestations\": [\n        {\n          \"type\": \"https://witness.dev/attestations/git/v0.1\"\n        },\n        {\n          \"type\": \"https://witness.dev/attestations/command-run/v0.1\"\n        },\n        {\n          \"type\": \"https://witness.dev/attestations/product/v0.1\"\n        }\n      ],\n      \"functionaries\": [\n        {\n          \"type\": \"publickey\",\n          \"publickeyid\": \"ci-key\"\n        }\n      ]\n    },\n    \"test\": {\n      \"name\": \"test\",\n      \"attestations\": [\n        {\n          \"type\": \"https://witness.dev/attestations/material/v0.1\"\n        },\n        {\n          \"type\": \"https://witness.dev/attestations/command-run/v0.1\"\n        }\n      ],\n      \"functionaries\": [\n        {\n          \"type\": \"publickey\",\n          \"publickeyid\": \"ci-key\"\n        }\n      ]\n    },\n    \"package\": {\n      \"name\": \"package\",\n      \"attestations\": [\n        {\n          \"type\": \"https://witness.dev/attestations/material/v0.1\"\n        },\n        {\n          \"type\": \"https://witness.dev/attestations/product/v0.1\"\n        }\n      ],\n      \"functionaries\": [\n        {\n          \"type\": \"publickey\",\n          \"publickeyid\": \"ci-key\"\n        }\n      ]\n    }\n  }\n}\n```\n\n**Pipeline Commands:**\n\n```bash\n# Step 1: Build\nwitness run --step build \\\n  --attestations git,commandrun,product \\\n  -o build.json --key ci-key.pem \\\n  -- go build -o myapp\n\n# Step 2: Test\nwitness run --step test \\\n  --attestations material,commandrun \\\n  -o test.json --key ci-key.pem \\\n  -- go test ./...\n\n# Step 3: Package\nwitness run --step package \\\n  --attestations material,product \\\n  -o package.json --key ci-key.pem \\\n  -- tar czf myapp.tar.gz myapp\n\n# Verify entire pipeline\nwitness verify \\\n  --policy policy-signed.json \\\n  --publickey policy-key.pub \\\n  -a build.json -a test.json -a package.json\n```\n"}]}
{"messages": [{"role": "system", "content": "You are an expert in the Witness supply chain attestation framework. You help users instrument CI/CD pipelines with witness, create policy documents, and write Rego policies to validate attestations. You understand all attestors in go-witness and how to use them effectively."}, {"role": "user", "content": "How do I create a witness policy for a build step that uses these attestors: material, product?"}, {"role": "assistant", "content": "Here's a complete witness policy for your build step with material, product attestors:\n\n**Policy Document:**\n```json\n{\n  \"expires\": \"2026-11-08T10:52:59Z\",\n  \"publickeys\": {\n    \"build-key\": {\n      \"keyid\": \"sha256:123c3ad2c086b5d74b31557d8953aa4f08566a02f919e8c6f00acd6a92b553bc\",\n      \"key\": \"-----BEGIN PUBLIC KEY-----\\n...\\n-----END PUBLIC KEY-----\"\n    }\n  },\n  \"steps\": {\n    \"build\": {\n      \"name\": \"build\",\n      \"attestations\": [\n        {\n          \"type\": \"https://witness.dev/attestations/material/v0.1\"\n        },\n        {\n          \"type\": \"https://witness.dev/attestations/product/v0.1\"\n        }\n      ],\n      \"functionaries\": [\n        {\n          \"type\": \"publickey\",\n          \"publickeyid\": \"build-key\"\n        }\n      ]\n    }\n  }\n}\n```\n\n**Witness Run Command:**\n```bash\nwitness run --step build \\\n  --attestations material,product \\\n  --outfile build-attestation.json \\\n  --key signing-key.pem \\\n  -- <your-build-command>\n```\n\n**Rego Validation Rules:**\n```rego\n\n```\n\n**Verification:**\n```bash\nwitness verify \\\n  --policy policy-signed.json \\\n  --publickey policy-key.pub \\\n  -a build-attestation.json \\\n  --subject <artifact>\n```\n"}]}
{"messages": [{"role": "system", "content": "You are an expert in the Witness supply chain attestation framework. You help users instrument CI/CD pipelines with witness, create policy documents, and write Rego policies to validate attestations. You understand all attestors in go-witness and how to use them effectively."}, {"role": "user", "content": "How do I create a multi-step witness policy for a build \u2192 test \u2192 package pipeline?"}, {"role": "assistant", "content": "Here's a complete multi-step witness policy for your pipeline:\n\n**Policy Document:**\n```json\n{\n  \"expires\": \"2026-11-08T10:52:59Z\",\n  \"publickeys\": {\n    \"ci-key\": {\n      \"keyid\": \"sha256:fc4d874b1dcee5a89b3563f66d9954d834ce0c6f0dc646f7627ab1ae91095228\",\n      \"key\": \"-----BEGIN PUBLIC KEY-----\\n...\\n-----END PUBLIC KEY-----\"\n    }\n  },\n  \"steps\": {\n    \"build\": {\n      \"name\": \"build\",\n      \"attestations\": [\n        {\n          \"type\": \"https://witness.dev/attestations/git/v0.1\"\n        },\n        {\n          \"type\": \"https://witness.dev/attestations/command-run/v0.1\"\n        },\n        {\n          \"type\": \"https://witness.dev/attestations/product/v0.1\"\n        }\n      ],\n      \"functionaries\": [\n        {\n          \"type\": \"publickey\",\n          \"publickeyid\": \"ci-key\"\n        }\n      ]\n    },\n    \"test\": {\n      \"name\": \"test\",\n      \"attestations\": [\n        {\n          \"type\": \"https://witness.dev/attestations/material/v0.1\"\n        },\n        {\n          \"type\": \"https://witness.dev/attestations/command-run/v0.1\"\n        }\n      ],\n      \"functionaries\": [\n        {\n          \"type\": \"publickey\",\n          \"publickeyid\": \"ci-key\"\n        }\n      ]\n    },\n    \"package\": {\n      \"name\": \"package\",\n      \"attestations\": [\n        {\n          \"type\": \"https://witness.dev/attestations/material/v0.1\"\n        },\n        {\n          \"type\": \"https://witness.dev/attestations/product/v0.1\"\n        }\n      ],\n      \"functionaries\": [\n        {\n          \"type\": \"publickey\",\n          \"publickeyid\": \"ci-key\"\n        }\n      ]\n    }\n  }\n}\n```\n\n**Pipeline Commands:**\n\n```bash\n# Step 1: Build\nwitness run --step build \\\n  --attestations git,commandrun,product \\\n  -o build.json --key ci-key.pem \\\n  -- go build -o myapp\n\n# Step 2: Test\nwitness run --step test \\\n  --attestations material,commandrun \\\n  -o test.json --key ci-key.pem \\\n  -- go test ./...\n\n# Step 3: Package\nwitness run --step package \\\n  --attestations material,product \\\n  -o package.json --key ci-key.pem \\\n  -- tar czf myapp.tar.gz myapp\n\n# Verify entire pipeline\nwitness verify \\\n  --policy policy-signed.json \\\n  --publickey policy-key.pub \\\n  -a build.json -a test.json -a package.json\n```\n"}]}
{"messages": [{"role": "system", "content": "You are an expert in the Witness supply chain attestation framework. You help users instrument CI/CD pipelines with witness, create policy documents, and write Rego policies to validate attestations. You understand all attestors in go-witness and how to use them effectively."}, {"role": "user", "content": "How do I create a witness policy for a build step that uses these attestors: product, material?"}, {"role": "assistant", "content": "Here's a complete witness policy for your build step with product, material attestors:\n\n**Policy Document:**\n```json\n{\n  \"expires\": \"2026-11-08T10:52:59Z\",\n  \"publickeys\": {\n    \"build-key\": {\n      \"keyid\": \"sha256:3c5e362ee88617698e26e330743ce42e6ee5466b04b0d398ad99f42b66b035d7\",\n      \"key\": \"-----BEGIN PUBLIC KEY-----\\n...\\n-----END PUBLIC KEY-----\"\n    }\n  },\n  \"steps\": {\n    \"build\": {\n      \"name\": \"build\",\n      \"attestations\": [\n        {\n          \"type\": \"https://witness.dev/attestations/product/v0.1\"\n        },\n        {\n          \"type\": \"https://witness.dev/attestations/material/v0.1\"\n        }\n      ],\n      \"functionaries\": [\n        {\n          \"type\": \"publickey\",\n          \"publickeyid\": \"build-key\"\n        }\n      ]\n    }\n  }\n}\n```\n\n**Witness Run Command:**\n```bash\nwitness run --step build \\\n  --attestations product,material \\\n  --outfile build-attestation.json \\\n  --key signing-key.pem \\\n  -- <your-build-command>\n```\n\n**Rego Validation Rules:**\n```rego\n\n```\n\n**Verification:**\n```bash\nwitness verify \\\n  --policy policy-signed.json \\\n  --publickey policy-key.pub \\\n  -a build-attestation.json \\\n  --subject <artifact>\n```\n"}]}
{"messages": [{"role": "system", "content": "You are an expert in the Witness supply chain attestation framework. You help users instrument CI/CD pipelines with witness, create policy documents, and write Rego policies to validate attestations. You understand all attestors in go-witness and how to use them effectively."}, {"role": "user", "content": "How do I create a multi-step witness policy for a build \u2192 test \u2192 package pipeline?"}, {"role": "assistant", "content": "Here's a complete multi-step witness policy for your pipeline:\n\n**Policy Document:**\n```json\n{\n  \"expires\": \"2026-11-08T10:52:59Z\",\n  \"publickeys\": {\n    \"ci-key\": {\n      \"keyid\": \"sha256:47e869b0af2e16ad272b9d95d281d2aeebd479a53455d306041bdb06d1cc65f4\",\n      \"key\": \"-----BEGIN PUBLIC KEY-----\\n...\\n-----END PUBLIC KEY-----\"\n    }\n  },\n  \"steps\": {\n    \"build\": {\n      \"name\": \"build\",\n      \"attestations\": [\n        {\n          \"type\": \"https://witness.dev/attestations/git/v0.1\"\n        },\n        {\n          \"type\": \"https://witness.dev/attestations/command-run/v0.1\"\n        },\n        {\n          \"type\": \"https://witness.dev/attestations/product/v0.1\"\n        }\n      ],\n      \"functionaries\": [\n        {\n          \"type\": \"publickey\",\n          \"publickeyid\": \"ci-key\"\n        }\n      ]\n    },\n    \"test\": {\n      \"name\": \"test\",\n      \"attestations\": [\n        {\n          \"type\": \"https://witness.dev/attestations/material/v0.1\"\n        },\n        {\n          \"type\": \"https://witness.dev/attestations/command-run/v0.1\"\n        }\n      ],\n      \"functionaries\": [\n        {\n          \"type\": \"publickey\",\n          \"publickeyid\": \"ci-key\"\n        }\n      ]\n    },\n    \"package\": {\n      \"name\": \"package\",\n      \"attestations\": [\n        {\n          \"type\": \"https://witness.dev/attestations/material/v0.1\"\n        },\n        {\n          \"type\": \"https://witness.dev/attestations/product/v0.1\"\n        }\n      ],\n      \"functionaries\": [\n        {\n          \"type\": \"publickey\",\n          \"publickeyid\": \"ci-key\"\n        }\n      ]\n    }\n  }\n}\n```\n\n**Pipeline Commands:**\n\n```bash\n# Step 1: Build\nwitness run --step build \\\n  --attestations git,commandrun,product \\\n  -o build.json --key ci-key.pem \\\n  -- go build -o myapp\n\n# Step 2: Test\nwitness run --step test \\\n  --attestations material,commandrun \\\n  -o test.json --key ci-key.pem \\\n  -- go test ./...\n\n# Step 3: Package\nwitness run --step package \\\n  --attestations material,product \\\n  -o package.json --key ci-key.pem \\\n  -- tar czf myapp.tar.gz myapp\n\n# Verify entire pipeline\nwitness verify \\\n  --policy policy-signed.json \\\n  --publickey policy-key.pub \\\n  -a build.json -a test.json -a package.json\n```\n"}]}
{"messages": [{"role": "system", "content": "You are an expert in the Witness supply chain attestation framework. You help users instrument CI/CD pipelines with witness, create policy documents, and write Rego policies to validate attestations. You understand all attestors in go-witness and how to use them effectively."}, {"role": "user", "content": "How do I create a witness policy for a build step that uses these attestors: git?"}, {"role": "assistant", "content": "Here's a complete witness policy for your build step with git attestors:\n\n**Policy Document:**\n```json\n{\n  \"expires\": \"2026-11-08T10:52:59Z\",\n  \"publickeys\": {\n    \"build-key\": {\n      \"keyid\": \"sha256:9442510cf9da7cc25244781fff4621e9c8d2ee98e636ae2633419d4c402731ab\",\n      \"key\": \"-----BEGIN PUBLIC KEY-----\\n...\\n-----END PUBLIC KEY-----\"\n    }\n  },\n  \"steps\": {\n    \"build\": {\n      \"name\": \"build\",\n      \"attestations\": [\n        {\n          \"type\": \"https://witness.dev/attestations/git/v0.1\"\n        }\n      ],\n      \"functionaries\": [\n        {\n          \"type\": \"publickey\",\n          \"publickeyid\": \"build-key\"\n        }\n      ]\n    }\n  }\n}\n```\n\n**Witness Run Command:**\n```bash\nwitness run --step build \\\n  --attestations git \\\n  --outfile build-attestation.json \\\n  --key signing-key.pem \\\n  -- <your-build-command>\n```\n\n**Rego Validation Rules:**\n```rego\npackage git\n\nimport rego.v1\n\n# Enforce builds from specific branch\ndeny contains msg if {\n    input.branch != \"feature/auth\"\n    msg := sprintf(\"Must build from feature/auth branch, got: %s\", [input.branch])\n}\n\n# Validate commit author\napproved_authors := {\n    \"alice.smith@example.com\",\n    \"bob.jones@company.com\",\n    \"ci-bot@company.com\"\n}\n\ndeny contains msg if {\n    not input.authoremail in approved_authors\n    msg := sprintf(\"Unauthorized commit author: %s\", [input.authoremail])\n}\n```\n\n**Verification:**\n```bash\nwitness verify \\\n  --policy policy-signed.json \\\n  --publickey policy-key.pub \\\n  -a build-attestation.json \\\n  --subject <artifact>\n```\n"}]}
{"messages": [{"role": "system", "content": "You are an expert in the Witness supply chain attestation framework. You help users instrument CI/CD pipelines with witness, create policy documents, and write Rego policies to validate attestations. You understand all attestors in go-witness and how to use them effectively."}, {"role": "user", "content": "How do I create a witness policy for a build step that uses these attestors: commandrun, environment, git?"}, {"role": "assistant", "content": "Here's a complete witness policy for your build step with commandrun, environment, git attestors:\n\n**Policy Document:**\n```json\n{\n  \"expires\": \"2026-11-08T10:52:59Z\",\n  \"publickeys\": {\n    \"build-key\": {\n      \"keyid\": \"sha256:b9c8b6b6ce0aa4a48d9577ae52b05ca0806752a2f1808d86e3f0d6292bd25e0a\",\n      \"key\": \"-----BEGIN PUBLIC KEY-----\\n...\\n-----END PUBLIC KEY-----\"\n    }\n  },\n  \"steps\": {\n    \"build\": {\n      \"name\": \"build\",\n      \"attestations\": [\n        {\n          \"type\": \"https://witness.dev/attestations/command-run/v0.1\"\n        },\n        {\n          \"type\": \"https://witness.dev/attestations/environment/v0.1\"\n        },\n        {\n          \"type\": \"https://witness.dev/attestations/git/v0.1\"\n        }\n      ],\n      \"functionaries\": [\n        {\n          \"type\": \"publickey\",\n          \"publickeyid\": \"build-key\"\n        }\n      ]\n    }\n  }\n}\n```\n\n**Witness Run Command:**\n```bash\nwitness run --step build \\\n  --attestations commandrun,environment,git \\\n  --outfile build-attestation.json \\\n  --key signing-key.pem \\\n  -- <your-build-command>\n```\n\n**Rego Validation Rules:**\n```rego\n\n```\n\n**Verification:**\n```bash\nwitness verify \\\n  --policy policy-signed.json \\\n  --publickey policy-key.pub \\\n  -a build-attestation.json \\\n  --subject <artifact>\n```\n"}]}
{"messages": [{"role": "system", "content": "You are an expert in the Witness supply chain attestation framework. You help users instrument CI/CD pipelines with witness, create policy documents, and write Rego policies to validate attestations. You understand all attestors in go-witness and how to use them effectively."}, {"role": "user", "content": "How do I create a witness policy for a build step that uses these attestors: product, environment, commandrun, github, material?"}, {"role": "assistant", "content": "Here's a complete witness policy for your build step with product, environment, commandrun, github, material attestors:\n\n**Policy Document:**\n```json\n{\n  \"expires\": \"2026-11-08T10:52:59Z\",\n  \"publickeys\": {\n    \"build-key\": {\n      \"keyid\": \"sha256:0eec03c4c562ad44c17d5801b3560aae9a7b53414ad0020c87561a3711d96a3f\",\n      \"key\": \"-----BEGIN PUBLIC KEY-----\\n...\\n-----END PUBLIC KEY-----\"\n    }\n  },\n  \"steps\": {\n    \"build\": {\n      \"name\": \"build\",\n      \"attestations\": [\n        {\n          \"type\": \"https://witness.dev/attestations/product/v0.1\"\n        },\n        {\n          \"type\": \"https://witness.dev/attestations/environment/v0.1\"\n        },\n        {\n          \"type\": \"https://witness.dev/attestations/command-run/v0.1\"\n        },\n        {\n          \"type\": \"https://witness.dev/attestations/github/v0.1\"\n        },\n        {\n          \"type\": \"https://witness.dev/attestations/material/v0.1\"\n        }\n      ],\n      \"functionaries\": [\n        {\n          \"type\": \"publickey\",\n          \"publickeyid\": \"build-key\"\n        }\n      ]\n    }\n  }\n}\n```\n\n**Witness Run Command:**\n```bash\nwitness run --step build \\\n  --attestations product,environment,commandrun,github,material \\\n  --outfile build-attestation.json \\\n  --key signing-key.pem \\\n  -- <your-build-command>\n```\n\n**Rego Validation Rules:**\n```rego\n\n```\n\n**Verification:**\n```bash\nwitness verify \\\n  --policy policy-signed.json \\\n  --publickey policy-key.pub \\\n  -a build-attestation.json \\\n  --subject <artifact>\n```\n"}]}
{"messages": [{"role": "system", "content": "You are an expert in the Witness supply chain attestation framework. You help users instrument CI/CD pipelines with witness, create policy documents, and write Rego policies to validate attestations. You understand all attestors in go-witness and how to use them effectively."}, {"role": "user", "content": "How do I create a witness policy for a build step that uses these attestors: material, commandrun, github, environment?"}, {"role": "assistant", "content": "Here's a complete witness policy for your build step with material, commandrun, github, environment attestors:\n\n**Policy Document:**\n```json\n{\n  \"expires\": \"2026-11-08T10:52:59Z\",\n  \"publickeys\": {\n    \"build-key\": {\n      \"keyid\": \"sha256:ad8bbb5918cd57922d07a895997174107ebd864ea1dfebfb55a48a39f6281dc6\",\n      \"key\": \"-----BEGIN PUBLIC KEY-----\\n...\\n-----END PUBLIC KEY-----\"\n    }\n  },\n  \"steps\": {\n    \"build\": {\n      \"name\": \"build\",\n      \"attestations\": [\n        {\n          \"type\": \"https://witness.dev/attestations/material/v0.1\"\n        },\n        {\n          \"type\": \"https://witness.dev/attestations/command-run/v0.1\"\n        },\n        {\n          \"type\": \"https://witness.dev/attestations/github/v0.1\"\n        },\n        {\n          \"type\": \"https://witness.dev/attestations/environment/v0.1\"\n        }\n      ],\n      \"functionaries\": [\n        {\n          \"type\": \"publickey\",\n          \"publickeyid\": \"build-key\"\n        }\n      ]\n    }\n  }\n}\n```\n\n**Witness Run Command:**\n```bash\nwitness run --step build \\\n  --attestations material,commandrun,github,environment \\\n  --outfile build-attestation.json \\\n  --key signing-key.pem \\\n  -- <your-build-command>\n```\n\n**Rego Validation Rules:**\n```rego\n\n```\n\n**Verification:**\n```bash\nwitness verify \\\n  --policy policy-signed.json \\\n  --publickey policy-key.pub \\\n  -a build-attestation.json \\\n  --subject <artifact>\n```\n"}]}
{"messages": [{"role": "system", "content": "You are an expert in the Witness supply chain attestation framework. You help users instrument CI/CD pipelines with witness, create policy documents, and write Rego policies to validate attestations. You understand all attestors in go-witness and how to use them effectively."}, {"role": "user", "content": "How do I create a witness policy for a build step that uses these attestors: commandrun, environment?"}, {"role": "assistant", "content": "Here's a complete witness policy for your build step with commandrun, environment attestors:\n\n**Policy Document:**\n```json\n{\n  \"expires\": \"2026-11-08T10:52:59Z\",\n  \"publickeys\": {\n    \"build-key\": {\n      \"keyid\": \"sha256:c74677c59e32ef882227b15d906eaa7f56a17dc5de8417b60f0f1e26e2678798\",\n      \"key\": \"-----BEGIN PUBLIC KEY-----\\n...\\n-----END PUBLIC KEY-----\"\n    }\n  },\n  \"steps\": {\n    \"build\": {\n      \"name\": \"build\",\n      \"attestations\": [\n        {\n          \"type\": \"https://witness.dev/attestations/command-run/v0.1\"\n        },\n        {\n          \"type\": \"https://witness.dev/attestations/environment/v0.1\"\n        }\n      ],\n      \"functionaries\": [\n        {\n          \"type\": \"publickey\",\n          \"publickeyid\": \"build-key\"\n        }\n      ]\n    }\n  }\n}\n```\n\n**Witness Run Command:**\n```bash\nwitness run --step build \\\n  --attestations commandrun,environment \\\n  --outfile build-attestation.json \\\n  --key signing-key.pem \\\n  -- <your-build-command>\n```\n\n**Rego Validation Rules:**\n```rego\n\n```\n\n**Verification:**\n```bash\nwitness verify \\\n  --policy policy-signed.json \\\n  --publickey policy-key.pub \\\n  -a build-attestation.json \\\n  --subject <artifact>\n```\n"}]}
{"messages": [{"role": "system", "content": "You are an expert in the Witness supply chain attestation framework. You help users instrument CI/CD pipelines with witness, create policy documents, and write Rego policies to validate attestations. You understand all attestors in go-witness and how to use them effectively."}, {"role": "user", "content": "How do I create a witness policy for a build step that uses these attestors: github, product, git?"}, {"role": "assistant", "content": "Here's a complete witness policy for your build step with github, product, git attestors:\n\n**Policy Document:**\n```json\n{\n  \"expires\": \"2026-11-08T10:52:59Z\",\n  \"publickeys\": {\n    \"build-key\": {\n      \"keyid\": \"sha256:6578a99638426a07b01b5de2a52ac157f2cb4fe5134d03e74c78ae4d0d51e050\",\n      \"key\": \"-----BEGIN PUBLIC KEY-----\\n...\\n-----END PUBLIC KEY-----\"\n    }\n  },\n  \"steps\": {\n    \"build\": {\n      \"name\": \"build\",\n      \"attestations\": [\n        {\n          \"type\": \"https://witness.dev/attestations/github/v0.1\"\n        },\n        {\n          \"type\": \"https://witness.dev/attestations/product/v0.1\"\n        },\n        {\n          \"type\": \"https://witness.dev/attestations/git/v0.1\"\n        }\n      ],\n      \"functionaries\": [\n        {\n          \"type\": \"publickey\",\n          \"publickeyid\": \"build-key\"\n        }\n      ]\n    }\n  }\n}\n```\n\n**Witness Run Command:**\n```bash\nwitness run --step build \\\n  --attestations github,product,git \\\n  --outfile build-attestation.json \\\n  --key signing-key.pem \\\n  -- <your-build-command>\n```\n\n**Rego Validation Rules:**\n```rego\n\n```\n\n**Verification:**\n```bash\nwitness verify \\\n  --policy policy-signed.json \\\n  --publickey policy-key.pub \\\n  -a build-attestation.json \\\n  --subject <artifact>\n```\n"}]}
{"messages": [{"role": "system", "content": "You are an expert in the Witness supply chain attestation framework. You help users instrument CI/CD pipelines with witness, create policy documents, and write Rego policies to validate attestations. You understand all attestors in go-witness and how to use them effectively."}, {"role": "user", "content": "How do I create a witness policy for a build step that uses these attestors: git, github, commandrun, material, environment?"}, {"role": "assistant", "content": "Here's a complete witness policy for your build step with git, github, commandrun, material, environment attestors:\n\n**Policy Document:**\n```json\n{\n  \"expires\": \"2026-11-08T10:52:59Z\",\n  \"publickeys\": {\n    \"build-key\": {\n      \"keyid\": \"sha256:e2535876931802da5feb5881afc87d78eb617cdb402a013497d9b60d28b40e48\",\n      \"key\": \"-----BEGIN PUBLIC KEY-----\\n...\\n-----END PUBLIC KEY-----\"\n    }\n  },\n  \"steps\": {\n    \"build\": {\n      \"name\": \"build\",\n      \"attestations\": [\n        {\n          \"type\": \"https://witness.dev/attestations/git/v0.1\"\n        },\n        {\n          \"type\": \"https://witness.dev/attestations/github/v0.1\"\n        },\n        {\n          \"type\": \"https://witness.dev/attestations/command-run/v0.1\"\n        },\n        {\n          \"type\": \"https://witness.dev/attestations/material/v0.1\"\n        },\n        {\n          \"type\": \"https://witness.dev/attestations/environment/v0.1\"\n        }\n      ],\n      \"functionaries\": [\n        {\n          \"type\": \"publickey\",\n          \"publickeyid\": \"build-key\"\n        }\n      ]\n    }\n  }\n}\n```\n\n**Witness Run Command:**\n```bash\nwitness run --step build \\\n  --attestations git,github,commandrun,material,environment \\\n  --outfile build-attestation.json \\\n  --key signing-key.pem \\\n  -- <your-build-command>\n```\n\n**Rego Validation Rules:**\n```rego\npackage git\n\nimport rego.v1\n\n# Enforce builds from specific branch\ndeny contains msg if {\n    input.branch != \"feature/api\"\n    msg := sprintf(\"Must build from feature/api branch, got: %s\", [input.branch])\n}\n\n# Require clean working directory\ndeny contains msg if {\n    count(input.status) > 0\n    msg := \"Working directory must be clean (no uncommitted changes)\"\n}\n\n# Validate commit author\napproved_authors := {\n    \"alice.smith@example.com\",\n    \"bob.jones@company.com\",\n    \"ci-bot@company.com\"\n}\n\ndeny contains msg if {\n    not input.authoremail in approved_authors\n    msg := sprintf(\"Unauthorized commit author: %s\", [input.authoremail])\n}\n```\n\n**Verification:**\n```bash\nwitness verify \\\n  --policy policy-signed.json \\\n  --publickey policy-key.pub \\\n  -a build-attestation.json \\\n  --subject <artifact>\n```\n"}]}
{"messages": [{"role": "system", "content": "You are an expert in the Witness supply chain attestation framework. You help users instrument CI/CD pipelines with witness, create policy documents, and write Rego policies to validate attestations. You understand all attestors in go-witness and how to use them effectively."}, {"role": "user", "content": "How do I create a witness policy for a build step that uses these attestors: commandrun, git, environment, material?"}, {"role": "assistant", "content": "Here's a complete witness policy for your build step with commandrun, git, environment, material attestors:\n\n**Policy Document:**\n```json\n{\n  \"expires\": \"2026-11-08T10:52:59Z\",\n  \"publickeys\": {\n    \"build-key\": {\n      \"keyid\": \"sha256:4f1250d509d855360cece069ac544eeb1ad5de286180cc575fb6133d97d38e28\",\n      \"key\": \"-----BEGIN PUBLIC KEY-----\\n...\\n-----END PUBLIC KEY-----\"\n    }\n  },\n  \"steps\": {\n    \"build\": {\n      \"name\": \"build\",\n      \"attestations\": [\n        {\n          \"type\": \"https://witness.dev/attestations/command-run/v0.1\"\n        },\n        {\n          \"type\": \"https://witness.dev/attestations/git/v0.1\"\n        },\n        {\n          \"type\": \"https://witness.dev/attestations/environment/v0.1\"\n        },\n        {\n          \"type\": \"https://witness.dev/attestations/material/v0.1\"\n        }\n      ],\n      \"functionaries\": [\n        {\n          \"type\": \"publickey\",\n          \"publickeyid\": \"build-key\"\n        }\n      ]\n    }\n  }\n}\n```\n\n**Witness Run Command:**\n```bash\nwitness run --step build \\\n  --attestations commandrun,git,environment,material \\\n  --outfile build-attestation.json \\\n  --key signing-key.pem \\\n  -- <your-build-command>\n```\n\n**Rego Validation Rules:**\n```rego\n\n```\n\n**Verification:**\n```bash\nwitness verify \\\n  --policy policy-signed.json \\\n  --publickey policy-key.pub \\\n  -a build-attestation.json \\\n  --subject <artifact>\n```\n"}]}
{"messages": [{"role": "system", "content": "You are an expert in the Witness supply chain attestation framework. You help users instrument CI/CD pipelines with witness, create policy documents, and write Rego policies to validate attestations. You understand all attestors in go-witness and how to use them effectively."}, {"role": "user", "content": "How do I create a multi-step witness policy for a build \u2192 test \u2192 package pipeline?"}, {"role": "assistant", "content": "Here's a complete multi-step witness policy for your pipeline:\n\n**Policy Document:**\n```json\n{\n  \"expires\": \"2026-11-08T10:52:59Z\",\n  \"publickeys\": {\n    \"ci-key\": {\n      \"keyid\": \"sha256:47aeb3ca701e09d7ce68434f97e5725691b3db10134eb5525ff74223134daf5c\",\n      \"key\": \"-----BEGIN PUBLIC KEY-----\\n...\\n-----END PUBLIC KEY-----\"\n    }\n  },\n  \"steps\": {\n    \"build\": {\n      \"name\": \"build\",\n      \"attestations\": [\n        {\n          \"type\": \"https://witness.dev/attestations/git/v0.1\"\n        },\n        {\n          \"type\": \"https://witness.dev/attestations/command-run/v0.1\"\n        },\n        {\n          \"type\": \"https://witness.dev/attestations/product/v0.1\"\n        }\n      ],\n      \"functionaries\": [\n        {\n          \"type\": \"publickey\",\n          \"publickeyid\": \"ci-key\"\n        }\n      ]\n    },\n    \"test\": {\n      \"name\": \"test\",\n      \"attestations\": [\n        {\n          \"type\": \"https://witness.dev/attestations/material/v0.1\"\n        },\n        {\n          \"type\": \"https://witness.dev/attestations/command-run/v0.1\"\n        }\n      ],\n      \"functionaries\": [\n        {\n          \"type\": \"publickey\",\n          \"publickeyid\": \"ci-key\"\n        }\n      ]\n    },\n    \"package\": {\n      \"name\": \"package\",\n      \"attestations\": [\n        {\n          \"type\": \"https://witness.dev/attestations/material/v0.1\"\n        },\n        {\n          \"type\": \"https://witness.dev/attestations/product/v0.1\"\n        }\n      ],\n      \"functionaries\": [\n        {\n          \"type\": \"publickey\",\n          \"publickeyid\": \"ci-key\"\n        }\n      ]\n    }\n  }\n}\n```\n\n**Pipeline Commands:**\n\n```bash\n# Step 1: Build\nwitness run --step build \\\n  --attestations git,commandrun,product \\\n  -o build.json --key ci-key.pem \\\n  -- go build -o myapp\n\n# Step 2: Test\nwitness run --step test \\\n  --attestations material,commandrun \\\n  -o test.json --key ci-key.pem \\\n  -- go test ./...\n\n# Step 3: Package\nwitness run --step package \\\n  --attestations material,product \\\n  -o package.json --key ci-key.pem \\\n  -- tar czf myapp.tar.gz myapp\n\n# Verify entire pipeline\nwitness verify \\\n  --policy policy-signed.json \\\n  --publickey policy-key.pub \\\n  -a build.json -a test.json -a package.json\n```\n"}]}
{"messages": [{"role": "system", "content": "You are an expert in the Witness supply chain attestation framework. You help users instrument CI/CD pipelines with witness, create policy documents, and write Rego policies to validate attestations. You understand all attestors in go-witness and how to use them effectively."}, {"role": "user", "content": "How do I create a witness policy for a build step that uses these attestors: commandrun, product?"}, {"role": "assistant", "content": "Here's a complete witness policy for your build step with commandrun, product attestors:\n\n**Policy Document:**\n```json\n{\n  \"expires\": \"2026-11-08T10:52:59Z\",\n  \"publickeys\": {\n    \"build-key\": {\n      \"keyid\": \"sha256:f1065624a58feb567b47907146d9de2ffd780b552faf752cef55688a628f087e\",\n      \"key\": \"-----BEGIN PUBLIC KEY-----\\n...\\n-----END PUBLIC KEY-----\"\n    }\n  },\n  \"steps\": {\n    \"build\": {\n      \"name\": \"build\",\n      \"attestations\": [\n        {\n          \"type\": \"https://witness.dev/attestations/command-run/v0.1\"\n        },\n        {\n          \"type\": \"https://witness.dev/attestations/product/v0.1\"\n        }\n      ],\n      \"functionaries\": [\n        {\n          \"type\": \"publickey\",\n          \"publickeyid\": \"build-key\"\n        }\n      ]\n    }\n  }\n}\n```\n\n**Witness Run Command:**\n```bash\nwitness run --step build \\\n  --attestations commandrun,product \\\n  --outfile build-attestation.json \\\n  --key signing-key.pem \\\n  -- <your-build-command>\n```\n\n**Rego Validation Rules:**\n```rego\n\n```\n\n**Verification:**\n```bash\nwitness verify \\\n  --policy policy-signed.json \\\n  --publickey policy-key.pub \\\n  -a build-attestation.json \\\n  --subject <artifact>\n```\n"}]}
{"messages": [{"role": "system", "content": "You are an expert in the Witness supply chain attestation framework. You help users instrument CI/CD pipelines with witness, create policy documents, and write Rego policies to validate attestations. You understand all attestors in go-witness and how to use them effectively."}, {"role": "user", "content": "How do I create a witness policy for a build step that uses these attestors: github, material, git, environment?"}, {"role": "assistant", "content": "Here's a complete witness policy for your build step with github, material, git, environment attestors:\n\n**Policy Document:**\n```json\n{\n  \"expires\": \"2026-11-08T10:52:59Z\",\n  \"publickeys\": {\n    \"build-key\": {\n      \"keyid\": \"sha256:9c4a1da9bf609b048241552a3f3f86174c70a7eac3c34781b095b21501f1c9d8\",\n      \"key\": \"-----BEGIN PUBLIC KEY-----\\n...\\n-----END PUBLIC KEY-----\"\n    }\n  },\n  \"steps\": {\n    \"build\": {\n      \"name\": \"build\",\n      \"attestations\": [\n        {\n          \"type\": \"https://witness.dev/attestations/github/v0.1\"\n        },\n        {\n          \"type\": \"https://witness.dev/attestations/material/v0.1\"\n        },\n        {\n          \"type\": \"https://witness.dev/attestations/git/v0.1\"\n        },\n        {\n          \"type\": \"https://witness.dev/attestations/environment/v0.1\"\n        }\n      ],\n      \"functionaries\": [\n        {\n          \"type\": \"publickey\",\n          \"publickeyid\": \"build-key\"\n        }\n      ]\n    }\n  }\n}\n```\n\n**Witness Run Command:**\n```bash\nwitness run --step build \\\n  --attestations github,material,git,environment \\\n  --outfile build-attestation.json \\\n  --key signing-key.pem \\\n  -- <your-build-command>\n```\n\n**Rego Validation Rules:**\n```rego\n\n```\n\n**Verification:**\n```bash\nwitness verify \\\n  --policy policy-signed.json \\\n  --publickey policy-key.pub \\\n  -a build-attestation.json \\\n  --subject <artifact>\n```\n"}]}
{"messages": [{"role": "system", "content": "You are an expert in the Witness supply chain attestation framework. You help users instrument CI/CD pipelines with witness, create policy documents, and write Rego policies to validate attestations. You understand all attestors in go-witness and how to use them effectively."}, {"role": "user", "content": "How do I create a multi-step witness policy for a build \u2192 test \u2192 package pipeline?"}, {"role": "assistant", "content": "Here's a complete multi-step witness policy for your pipeline:\n\n**Policy Document:**\n```json\n{\n  \"expires\": \"2026-11-08T10:52:59Z\",\n  \"publickeys\": {\n    \"ci-key\": {\n      \"keyid\": \"sha256:e987e9f6d76ff1930b0db0f5001f61d74743f4e433fdee0a484cebc345496425\",\n      \"key\": \"-----BEGIN PUBLIC KEY-----\\n...\\n-----END PUBLIC KEY-----\"\n    }\n  },\n  \"steps\": {\n    \"build\": {\n      \"name\": \"build\",\n      \"attestations\": [\n        {\n          \"type\": \"https://witness.dev/attestations/git/v0.1\"\n        },\n        {\n          \"type\": \"https://witness.dev/attestations/command-run/v0.1\"\n        },\n        {\n          \"type\": \"https://witness.dev/attestations/product/v0.1\"\n        }\n      ],\n      \"functionaries\": [\n        {\n          \"type\": \"publickey\",\n          \"publickeyid\": \"ci-key\"\n        }\n      ]\n    },\n    \"test\": {\n      \"name\": \"test\",\n      \"attestations\": [\n        {\n          \"type\": \"https://witness.dev/attestations/material/v0.1\"\n        },\n        {\n          \"type\": \"https://witness.dev/attestations/command-run/v0.1\"\n        }\n      ],\n      \"functionaries\": [\n        {\n          \"type\": \"publickey\",\n          \"publickeyid\": \"ci-key\"\n        }\n      ]\n    },\n    \"package\": {\n      \"name\": \"package\",\n      \"attestations\": [\n        {\n          \"type\": \"https://witness.dev/attestations/material/v0.1\"\n        },\n        {\n          \"type\": \"https://witness.dev/attestations/product/v0.1\"\n        }\n      ],\n      \"functionaries\": [\n        {\n          \"type\": \"publickey\",\n          \"publickeyid\": \"ci-key\"\n        }\n      ]\n    }\n  }\n}\n```\n\n**Pipeline Commands:**\n\n```bash\n# Step 1: Build\nwitness run --step build \\\n  --attestations git,commandrun,product \\\n  -o build.json --key ci-key.pem \\\n  -- go build -o myapp\n\n# Step 2: Test\nwitness run --step test \\\n  --attestations material,commandrun \\\n  -o test.json --key ci-key.pem \\\n  -- go test ./...\n\n# Step 3: Package\nwitness run --step package \\\n  --attestations material,product \\\n  -o package.json --key ci-key.pem \\\n  -- tar czf myapp.tar.gz myapp\n\n# Verify entire pipeline\nwitness verify \\\n  --policy policy-signed.json \\\n  --publickey policy-key.pub \\\n  -a build.json -a test.json -a package.json\n```\n"}]}
{"messages": [{"role": "system", "content": "You are an expert in the Witness supply chain attestation framework. You help users instrument CI/CD pipelines with witness, create policy documents, and write Rego policies to validate attestations. You understand all attestors in go-witness and how to use them effectively."}, {"role": "user", "content": "How do I create a multi-step witness policy for a build \u2192 test \u2192 package pipeline?"}, {"role": "assistant", "content": "Here's a complete multi-step witness policy for your pipeline:\n\n**Policy Document:**\n```json\n{\n  \"expires\": \"2026-11-08T10:52:59Z\",\n  \"publickeys\": {\n    \"ci-key\": {\n      \"keyid\": \"sha256:73d22d73829643b84254dd46ae6bbd4e97298be2c9c9f21a98764873b539c059\",\n      \"key\": \"-----BEGIN PUBLIC KEY-----\\n...\\n-----END PUBLIC KEY-----\"\n    }\n  },\n  \"steps\": {\n    \"build\": {\n      \"name\": \"build\",\n      \"attestations\": [\n        {\n          \"type\": \"https://witness.dev/attestations/git/v0.1\"\n        },\n        {\n          \"type\": \"https://witness.dev/attestations/command-run/v0.1\"\n        },\n        {\n          \"type\": \"https://witness.dev/attestations/product/v0.1\"\n        }\n      ],\n      \"functionaries\": [\n        {\n          \"type\": \"publickey\",\n          \"publickeyid\": \"ci-key\"\n        }\n      ]\n    },\n    \"test\": {\n      \"name\": \"test\",\n      \"attestations\": [\n        {\n          \"type\": \"https://witness.dev/attestations/material/v0.1\"\n        },\n        {\n          \"type\": \"https://witness.dev/attestations/command-run/v0.1\"\n        }\n      ],\n      \"functionaries\": [\n        {\n          \"type\": \"publickey\",\n          \"publickeyid\": \"ci-key\"\n        }\n      ]\n    },\n    \"package\": {\n      \"name\": \"package\",\n      \"attestations\": [\n        {\n          \"type\": \"https://witness.dev/attestations/material/v0.1\"\n        },\n        {\n          \"type\": \"https://witness.dev/attestations/product/v0.1\"\n        }\n      ],\n      \"functionaries\": [\n        {\n          \"type\": \"publickey\",\n          \"publickeyid\": \"ci-key\"\n        }\n      ]\n    }\n  }\n}\n```\n\n**Pipeline Commands:**\n\n```bash\n# Step 1: Build\nwitness run --step build \\\n  --attestations git,commandrun,product \\\n  -o build.json --key ci-key.pem \\\n  -- go build -o myapp\n\n# Step 2: Test\nwitness run --step test \\\n  --attestations material,commandrun \\\n  -o test.json --key ci-key.pem \\\n  -- go test ./...\n\n# Step 3: Package\nwitness run --step package \\\n  --attestations material,product \\\n  -o package.json --key ci-key.pem \\\n  -- tar czf myapp.tar.gz myapp\n\n# Verify entire pipeline\nwitness verify \\\n  --policy policy-signed.json \\\n  --publickey policy-key.pub \\\n  -a build.json -a test.json -a package.json\n```\n"}]}
{"messages": [{"role": "system", "content": "You are an expert in the Witness supply chain attestation framework. You help users instrument CI/CD pipelines with witness, create policy documents, and write Rego policies to validate attestations. You understand all attestors in go-witness and how to use them effectively."}, {"role": "user", "content": "How do I create a witness policy for a build step that uses these attestors: product, github?"}, {"role": "assistant", "content": "Here's a complete witness policy for your build step with product, github attestors:\n\n**Policy Document:**\n```json\n{\n  \"expires\": \"2026-11-08T10:52:59Z\",\n  \"publickeys\": {\n    \"build-key\": {\n      \"keyid\": \"sha256:fc770f4b1296399bcc847eb6ebfbca469ab2d2788ecee02010228ebba664ed64\",\n      \"key\": \"-----BEGIN PUBLIC KEY-----\\n...\\n-----END PUBLIC KEY-----\"\n    }\n  },\n  \"steps\": {\n    \"build\": {\n      \"name\": \"build\",\n      \"attestations\": [\n        {\n          \"type\": \"https://witness.dev/attestations/product/v0.1\"\n        },\n        {\n          \"type\": \"https://witness.dev/attestations/github/v0.1\"\n        }\n      ],\n      \"functionaries\": [\n        {\n          \"type\": \"publickey\",\n          \"publickeyid\": \"build-key\"\n        }\n      ]\n    }\n  }\n}\n```\n\n**Witness Run Command:**\n```bash\nwitness run --step build \\\n  --attestations product,github \\\n  --outfile build-attestation.json \\\n  --key signing-key.pem \\\n  -- <your-build-command>\n```\n\n**Rego Validation Rules:**\n```rego\n\n```\n\n**Verification:**\n```bash\nwitness verify \\\n  --policy policy-signed.json \\\n  --publickey policy-key.pub \\\n  -a build-attestation.json \\\n  --subject <artifact>\n```\n"}]}
{"messages": [{"role": "system", "content": "You are an expert in the Witness supply chain attestation framework. You help users instrument CI/CD pipelines with witness, create policy documents, and write Rego policies to validate attestations. You understand all attestors in go-witness and how to use them effectively."}, {"role": "user", "content": "How do I create a witness policy for a build step that uses these attestors: environment, commandrun?"}, {"role": "assistant", "content": "Here's a complete witness policy for your build step with environment, commandrun attestors:\n\n**Policy Document:**\n```json\n{\n  \"expires\": \"2026-11-08T10:52:59Z\",\n  \"publickeys\": {\n    \"build-key\": {\n      \"keyid\": \"sha256:ec1cd811ae9f7698609c06bebbb8d0f2b28f8e599b0f302f0c454b55d6456329\",\n      \"key\": \"-----BEGIN PUBLIC KEY-----\\n...\\n-----END PUBLIC KEY-----\"\n    }\n  },\n  \"steps\": {\n    \"build\": {\n      \"name\": \"build\",\n      \"attestations\": [\n        {\n          \"type\": \"https://witness.dev/attestations/environment/v0.1\"\n        },\n        {\n          \"type\": \"https://witness.dev/attestations/command-run/v0.1\"\n        }\n      ],\n      \"functionaries\": [\n        {\n          \"type\": \"publickey\",\n          \"publickeyid\": \"build-key\"\n        }\n      ]\n    }\n  }\n}\n```\n\n**Witness Run Command:**\n```bash\nwitness run --step build \\\n  --attestations environment,commandrun \\\n  --outfile build-attestation.json \\\n  --key signing-key.pem \\\n  -- <your-build-command>\n```\n\n**Rego Validation Rules:**\n```rego\npackage environment\n\nimport rego.v1\n\n# Ensure correct OS\ndeny contains msg if {\n    input.os != \"linux\"\n    msg := sprintf(\"Must run on linux, got: %s\", [input.os])\n}\n\n# Require CI environment\ndeny contains msg if {\n    not \"CI\" in input.variables\n    msg := \"Must run in CI environment (CI variable not set)\"\n}\n```\n\n**Verification:**\n```bash\nwitness verify \\\n  --policy policy-signed.json \\\n  --publickey policy-key.pub \\\n  -a build-attestation.json \\\n  --subject <artifact>\n```\n"}]}
{"messages": [{"role": "system", "content": "You are an expert in the Witness supply chain attestation framework. You help users instrument CI/CD pipelines with witness, create policy documents, and write Rego policies to validate attestations. You understand all attestors in go-witness and how to use them effectively."}, {"role": "user", "content": "How do I create a witness policy for a build step that uses these attestors: material, github?"}, {"role": "assistant", "content": "Here's a complete witness policy for your build step with material, github attestors:\n\n**Policy Document:**\n```json\n{\n  \"expires\": \"2026-11-08T10:52:59Z\",\n  \"publickeys\": {\n    \"build-key\": {\n      \"keyid\": \"sha256:8c124a575747c7b8e5cfe8d7c0a2722bf07c1480283d71b0421bed1dbf9c5b37\",\n      \"key\": \"-----BEGIN PUBLIC KEY-----\\n...\\n-----END PUBLIC KEY-----\"\n    }\n  },\n  \"steps\": {\n    \"build\": {\n      \"name\": \"build\",\n      \"attestations\": [\n        {\n          \"type\": \"https://witness.dev/attestations/material/v0.1\"\n        },\n        {\n          \"type\": \"https://witness.dev/attestations/github/v0.1\"\n        }\n      ],\n      \"functionaries\": [\n        {\n          \"type\": \"publickey\",\n          \"publickeyid\": \"build-key\"\n        }\n      ]\n    }\n  }\n}\n```\n\n**Witness Run Command:**\n```bash\nwitness run --step build \\\n  --attestations material,github \\\n  --outfile build-attestation.json \\\n  --key signing-key.pem \\\n  -- <your-build-command>\n```\n\n**Rego Validation Rules:**\n```rego\n\n```\n\n**Verification:**\n```bash\nwitness verify \\\n  --policy policy-signed.json \\\n  --publickey policy-key.pub \\\n  -a build-attestation.json \\\n  --subject <artifact>\n```\n"}]}
{"messages": [{"role": "system", "content": "You are an expert in the Witness supply chain attestation framework. You help users instrument CI/CD pipelines with witness, create policy documents, and write Rego policies to validate attestations. You understand all attestors in go-witness and how to use them effectively."}, {"role": "user", "content": "How do I create a witness policy for a build step that uses these attestors: product, material?"}, {"role": "assistant", "content": "Here's a complete witness policy for your build step with product, material attestors:\n\n**Policy Document:**\n```json\n{\n  \"expires\": \"2026-11-08T10:52:59Z\",\n  \"publickeys\": {\n    \"build-key\": {\n      \"keyid\": \"sha256:2fd4ae33683b18626781ff9e5a0b1125db4dc24a2ee09176961fc8920826a71e\",\n      \"key\": \"-----BEGIN PUBLIC KEY-----\\n...\\n-----END PUBLIC KEY-----\"\n    }\n  },\n  \"steps\": {\n    \"build\": {\n      \"name\": \"build\",\n      \"attestations\": [\n        {\n          \"type\": \"https://witness.dev/attestations/product/v0.1\"\n        },\n        {\n          \"type\": \"https://witness.dev/attestations/material/v0.1\"\n        }\n      ],\n      \"functionaries\": [\n        {\n          \"type\": \"publickey\",\n          \"publickeyid\": \"build-key\"\n        }\n      ]\n    }\n  }\n}\n```\n\n**Witness Run Command:**\n```bash\nwitness run --step build \\\n  --attestations product,material \\\n  --outfile build-attestation.json \\\n  --key signing-key.pem \\\n  -- <your-build-command>\n```\n\n**Rego Validation Rules:**\n```rego\n\n```\n\n**Verification:**\n```bash\nwitness verify \\\n  --policy policy-signed.json \\\n  --publickey policy-key.pub \\\n  -a build-attestation.json \\\n  --subject <artifact>\n```\n"}]}
{"messages": [{"role": "system", "content": "You are an expert in the Witness supply chain attestation framework. You help users instrument CI/CD pipelines with witness, create policy documents, and write Rego policies to validate attestations. You understand all attestors in go-witness and how to use them effectively."}, {"role": "user", "content": "How do I create a witness policy for a build step that uses these attestors: git?"}, {"role": "assistant", "content": "Here's a complete witness policy for your build step with git attestors:\n\n**Policy Document:**\n```json\n{\n  \"expires\": \"2026-11-08T10:52:59Z\",\n  \"publickeys\": {\n    \"build-key\": {\n      \"keyid\": \"sha256:276067d4bbc5d1fbb3dcd58bc8f950fd385733585d4702e460b45a904810aa49\",\n      \"key\": \"-----BEGIN PUBLIC KEY-----\\n...\\n-----END PUBLIC KEY-----\"\n    }\n  },\n  \"steps\": {\n    \"build\": {\n      \"name\": \"build\",\n      \"attestations\": [\n        {\n          \"type\": \"https://witness.dev/attestations/git/v0.1\"\n        }\n      ],\n      \"functionaries\": [\n        {\n          \"type\": \"publickey\",\n          \"publickeyid\": \"build-key\"\n        }\n      ]\n    }\n  }\n}\n```\n\n**Witness Run Command:**\n```bash\nwitness run --step build \\\n  --attestations git \\\n  --outfile build-attestation.json \\\n  --key signing-key.pem \\\n  -- <your-build-command>\n```\n\n**Rego Validation Rules:**\n```rego\npackage git\n\nimport rego.v1\n\n# Enforce builds from specific branch\ndeny contains msg if {\n    input.branch != \"feature/api\"\n    msg := sprintf(\"Must build from feature/api branch, got: %s\", [input.branch])\n}\n\n# Require clean working directory\ndeny contains msg if {\n    count(input.status) > 0\n    msg := \"Working directory must be clean (no uncommitted changes)\"\n}\n\n# Validate commit author\napproved_authors := {\n    \"alice.smith@example.com\",\n    \"bob.jones@company.com\",\n    \"ci-bot@company.com\"\n}\n\ndeny contains msg if {\n    not input.authoremail in approved_authors\n    msg := sprintf(\"Unauthorized commit author: %s\", [input.authoremail])\n}\n```\n\n**Verification:**\n```bash\nwitness verify \\\n  --policy policy-signed.json \\\n  --publickey policy-key.pub \\\n  -a build-attestation.json \\\n  --subject <artifact>\n```\n"}]}
{"messages": [{"role": "system", "content": "You are an expert in the Witness supply chain attestation framework. You help users instrument CI/CD pipelines with witness, create policy documents, and write Rego policies to validate attestations. You understand all attestors in go-witness and how to use them effectively."}, {"role": "user", "content": "How do I create a witness policy for a build step that uses these attestors: commandrun, git?"}, {"role": "assistant", "content": "Here's a complete witness policy for your build step with commandrun, git attestors:\n\n**Policy Document:**\n```json\n{\n  \"expires\": \"2026-11-08T10:52:59Z\",\n  \"publickeys\": {\n    \"build-key\": {\n      \"keyid\": \"sha256:ffe35e776b8b1ea1585f154948e09039f148b684518967cc04d8ec31fb8cafbe\",\n      \"key\": \"-----BEGIN PUBLIC KEY-----\\n...\\n-----END PUBLIC KEY-----\"\n    }\n  },\n  \"steps\": {\n    \"build\": {\n      \"name\": \"build\",\n      \"attestations\": [\n        {\n          \"type\": \"https://witness.dev/attestations/command-run/v0.1\"\n        },\n        {\n          \"type\": \"https://witness.dev/attestations/git/v0.1\"\n        }\n      ],\n      \"functionaries\": [\n        {\n          \"type\": \"publickey\",\n          \"publickeyid\": \"build-key\"\n        }\n      ]\n    }\n  }\n}\n```\n\n**Witness Run Command:**\n```bash\nwitness run --step build \\\n  --attestations commandrun,git \\\n  --outfile build-attestation.json \\\n  --key signing-key.pem \\\n  -- <your-build-command>\n```\n\n**Rego Validation Rules:**\n```rego\n\n```\n\n**Verification:**\n```bash\nwitness verify \\\n  --policy policy-signed.json \\\n  --publickey policy-key.pub \\\n  -a build-attestation.json \\\n  --subject <artifact>\n```\n"}]}
{"messages": [{"role": "system", "content": "You are an expert in the Witness supply chain attestation framework. You help users instrument CI/CD pipelines with witness, create policy documents, and write Rego policies to validate attestations. You understand all attestors in go-witness and how to use them effectively."}, {"role": "user", "content": "How do I create a witness policy for a build step that uses these attestors: material, github?"}, {"role": "assistant", "content": "Here's a complete witness policy for your build step with material, github attestors:\n\n**Policy Document:**\n```json\n{\n  \"expires\": \"2026-11-08T10:52:59Z\",\n  \"publickeys\": {\n    \"build-key\": {\n      \"keyid\": \"sha256:bb96e2065e73fa6761dba3b1bb0ccc00d5556503a8b3477742c4e751ef8c4017\",\n      \"key\": \"-----BEGIN PUBLIC KEY-----\\n...\\n-----END PUBLIC KEY-----\"\n    }\n  },\n  \"steps\": {\n    \"build\": {\n      \"name\": \"build\",\n      \"attestations\": [\n        {\n          \"type\": \"https://witness.dev/attestations/material/v0.1\"\n        },\n        {\n          \"type\": \"https://witness.dev/attestations/github/v0.1\"\n        }\n      ],\n      \"functionaries\": [\n        {\n          \"type\": \"publickey\",\n          \"publickeyid\": \"build-key\"\n        }\n      ]\n    }\n  }\n}\n```\n\n**Witness Run Command:**\n```bash\nwitness run --step build \\\n  --attestations material,github \\\n  --outfile build-attestation.json \\\n  --key signing-key.pem \\\n  -- <your-build-command>\n```\n\n**Rego Validation Rules:**\n```rego\n\n```\n\n**Verification:**\n```bash\nwitness verify \\\n  --policy policy-signed.json \\\n  --publickey policy-key.pub \\\n  -a build-attestation.json \\\n  --subject <artifact>\n```\n"}]}
{"messages": [{"role": "system", "content": "You are an expert in the Witness supply chain attestation framework. You help users instrument CI/CD pipelines with witness, create policy documents, and write Rego policies to validate attestations. You understand all attestors in go-witness and how to use them effectively."}, {"role": "user", "content": "How do I create a multi-step witness policy for a build \u2192 test \u2192 package pipeline?"}, {"role": "assistant", "content": "Here's a complete multi-step witness policy for your pipeline:\n\n**Policy Document:**\n```json\n{\n  \"expires\": \"2026-11-08T10:52:59Z\",\n  \"publickeys\": {\n    \"ci-key\": {\n      \"keyid\": \"sha256:bd4fc5086c59b3e16b063dcdb93dd5cf96e41dba5b2b898bd39c3cef9763a87f\",\n      \"key\": \"-----BEGIN PUBLIC KEY-----\\n...\\n-----END PUBLIC KEY-----\"\n    }\n  },\n  \"steps\": {\n    \"build\": {\n      \"name\": \"build\",\n      \"attestations\": [\n        {\n          \"type\": \"https://witness.dev/attestations/git/v0.1\"\n        },\n        {\n          \"type\": \"https://witness.dev/attestations/command-run/v0.1\"\n        },\n        {\n          \"type\": \"https://witness.dev/attestations/product/v0.1\"\n        }\n      ],\n      \"functionaries\": [\n        {\n          \"type\": \"publickey\",\n          \"publickeyid\": \"ci-key\"\n        }\n      ]\n    },\n    \"test\": {\n      \"name\": \"test\",\n      \"attestations\": [\n        {\n          \"type\": \"https://witness.dev/attestations/material/v0.1\"\n        },\n        {\n          \"type\": \"https://witness.dev/attestations/command-run/v0.1\"\n        }\n      ],\n      \"functionaries\": [\n        {\n          \"type\": \"publickey\",\n          \"publickeyid\": \"ci-key\"\n        }\n      ]\n    },\n    \"package\": {\n      \"name\": \"package\",\n      \"attestations\": [\n        {\n          \"type\": \"https://witness.dev/attestations/material/v0.1\"\n        },\n        {\n          \"type\": \"https://witness.dev/attestations/product/v0.1\"\n        }\n      ],\n      \"functionaries\": [\n        {\n          \"type\": \"publickey\",\n          \"publickeyid\": \"ci-key\"\n        }\n      ]\n    }\n  }\n}\n```\n\n**Pipeline Commands:**\n\n```bash\n# Step 1: Build\nwitness run --step build \\\n  --attestations git,commandrun,product \\\n  -o build.json --key ci-key.pem \\\n  -- go build -o myapp\n\n# Step 2: Test\nwitness run --step test \\\n  --attestations material,commandrun \\\n  -o test.json --key ci-key.pem \\\n  -- go test ./...\n\n# Step 3: Package\nwitness run --step package \\\n  --attestations material,product \\\n  -o package.json --key ci-key.pem \\\n  -- tar czf myapp.tar.gz myapp\n\n# Verify entire pipeline\nwitness verify \\\n  --policy policy-signed.json \\\n  --publickey policy-key.pub \\\n  -a build.json -a test.json -a package.json\n```\n"}]}
{"messages": [{"role": "system", "content": "You are an expert in the Witness supply chain attestation framework. You help users instrument CI/CD pipelines with witness, create policy documents, and write Rego policies to validate attestations. You understand all attestors in go-witness and how to use them effectively."}, {"role": "user", "content": "How do I create a witness policy for a build step that uses these attestors: commandrun?"}, {"role": "assistant", "content": "Here's a complete witness policy for your build step with commandrun attestors:\n\n**Policy Document:**\n```json\n{\n  \"expires\": \"2026-11-08T10:52:59Z\",\n  \"publickeys\": {\n    \"build-key\": {\n      \"keyid\": \"sha256:c60ea894df0162ca92733ee1acf3bc4f2ea38884ccc8010c92cac8079c1548d4\",\n      \"key\": \"-----BEGIN PUBLIC KEY-----\\n...\\n-----END PUBLIC KEY-----\"\n    }\n  },\n  \"steps\": {\n    \"build\": {\n      \"name\": \"build\",\n      \"attestations\": [\n        {\n          \"type\": \"https://witness.dev/attestations/command-run/v0.1\"\n        }\n      ],\n      \"functionaries\": [\n        {\n          \"type\": \"publickey\",\n          \"publickeyid\": \"build-key\"\n        }\n      ]\n    }\n  }\n}\n```\n\n**Witness Run Command:**\n```bash\nwitness run --step build \\\n  --attestations commandrun \\\n  --outfile build-attestation.json \\\n  --key signing-key.pem \\\n  -- <your-build-command>\n```\n\n**Rego Validation Rules:**\n```rego\n\n```\n\n**Verification:**\n```bash\nwitness verify \\\n  --policy policy-signed.json \\\n  --publickey policy-key.pub \\\n  -a build-attestation.json \\\n  --subject <artifact>\n```\n"}]}
{"messages": [{"role": "system", "content": "You are an expert in the Witness supply chain attestation framework. You help users instrument CI/CD pipelines with witness, create policy documents, and write Rego policies to validate attestations. You understand all attestors in go-witness and how to use them effectively."}, {"role": "user", "content": "How do I create a witness policy for a build step that uses these attestors: commandrun?"}, {"role": "assistant", "content": "Here's a complete witness policy for your build step with commandrun attestors:\n\n**Policy Document:**\n```json\n{\n  \"expires\": \"2026-11-08T10:52:59Z\",\n  \"publickeys\": {\n    \"build-key\": {\n      \"keyid\": \"sha256:f96a566ab2ac3cf2d7289712a20160d33e0adc7627ab5735034d7c2ec7c5af22\",\n      \"key\": \"-----BEGIN PUBLIC KEY-----\\n...\\n-----END PUBLIC KEY-----\"\n    }\n  },\n  \"steps\": {\n    \"build\": {\n      \"name\": \"build\",\n      \"attestations\": [\n        {\n          \"type\": \"https://witness.dev/attestations/command-run/v0.1\"\n        }\n      ],\n      \"functionaries\": [\n        {\n          \"type\": \"publickey\",\n          \"publickeyid\": \"build-key\"\n        }\n      ]\n    }\n  }\n}\n```\n\n**Witness Run Command:**\n```bash\nwitness run --step build \\\n  --attestations commandrun \\\n  --outfile build-attestation.json \\\n  --key signing-key.pem \\\n  -- <your-build-command>\n```\n\n**Rego Validation Rules:**\n```rego\n\n```\n\n**Verification:**\n```bash\nwitness verify \\\n  --policy policy-signed.json \\\n  --publickey policy-key.pub \\\n  -a build-attestation.json \\\n  --subject <artifact>\n```\n"}]}
{"messages": [{"role": "system", "content": "You are an expert in the Witness supply chain attestation framework. You help users instrument CI/CD pipelines with witness, create policy documents, and write Rego policies to validate attestations. You understand all attestors in go-witness and how to use them effectively."}, {"role": "user", "content": "How do I create a witness policy for a build step that uses these attestors: git, material?"}, {"role": "assistant", "content": "Here's a complete witness policy for your build step with git, material attestors:\n\n**Policy Document:**\n```json\n{\n  \"expires\": \"2026-11-08T10:52:59Z\",\n  \"publickeys\": {\n    \"build-key\": {\n      \"keyid\": \"sha256:50207ea40f7522abbb185cbae4dadc869a896fc5a68eccb82f7a27c87d722c5b\",\n      \"key\": \"-----BEGIN PUBLIC KEY-----\\n...\\n-----END PUBLIC KEY-----\"\n    }\n  },\n  \"steps\": {\n    \"build\": {\n      \"name\": \"build\",\n      \"attestations\": [\n        {\n          \"type\": \"https://witness.dev/attestations/git/v0.1\"\n        },\n        {\n          \"type\": \"https://witness.dev/attestations/material/v0.1\"\n        }\n      ],\n      \"functionaries\": [\n        {\n          \"type\": \"publickey\",\n          \"publickeyid\": \"build-key\"\n        }\n      ]\n    }\n  }\n}\n```\n\n**Witness Run Command:**\n```bash\nwitness run --step build \\\n  --attestations git,material \\\n  --outfile build-attestation.json \\\n  --key signing-key.pem \\\n  -- <your-build-command>\n```\n\n**Rego Validation Rules:**\n```rego\npackage git\n\nimport rego.v1\n\n# Enforce builds from specific branch\ndeny contains msg if {\n    input.branch != \"hotfix/critical\"\n    msg := sprintf(\"Must build from hotfix/critical branch, got: %s\", [input.branch])\n}\n\n# Require clean working directory\ndeny contains msg if {\n    count(input.status) > 0\n    msg := \"Working directory must be clean (no uncommitted changes)\"\n}\n\n# Validate commit author\napproved_authors := {\n    \"alice.smith@example.com\",\n    \"bob.jones@company.com\",\n    \"ci-bot@company.com\"\n}\n\ndeny contains msg if {\n    not input.authoremail in approved_authors\n    msg := sprintf(\"Unauthorized commit author: %s\", [input.authoremail])\n}\n```\n\n**Verification:**\n```bash\nwitness verify \\\n  --policy policy-signed.json \\\n  --publickey policy-key.pub \\\n  -a build-attestation.json \\\n  --subject <artifact>\n```\n"}]}
{"messages": [{"role": "system", "content": "You are an expert in the Witness supply chain attestation framework. You help users instrument CI/CD pipelines with witness, create policy documents, and write Rego policies to validate attestations. You understand all attestors in go-witness and how to use them effectively."}, {"role": "user", "content": "How do I create a multi-step witness policy for a build \u2192 test \u2192 package pipeline?"}, {"role": "assistant", "content": "Here's a complete multi-step witness policy for your pipeline:\n\n**Policy Document:**\n```json\n{\n  \"expires\": \"2026-11-08T10:52:59Z\",\n  \"publickeys\": {\n    \"ci-key\": {\n      \"keyid\": \"sha256:63cc3c71902a1827da1ff5f4839ab43a1402574ed77fe24190a8ef8e67caee84\",\n      \"key\": \"-----BEGIN PUBLIC KEY-----\\n...\\n-----END PUBLIC KEY-----\"\n    }\n  },\n  \"steps\": {\n    \"build\": {\n      \"name\": \"build\",\n      \"attestations\": [\n        {\n          \"type\": \"https://witness.dev/attestations/git/v0.1\"\n        },\n        {\n          \"type\": \"https://witness.dev/attestations/command-run/v0.1\"\n        },\n        {\n          \"type\": \"https://witness.dev/attestations/product/v0.1\"\n        }\n      ],\n      \"functionaries\": [\n        {\n          \"type\": \"publickey\",\n          \"publickeyid\": \"ci-key\"\n        }\n      ]\n    },\n    \"test\": {\n      \"name\": \"test\",\n      \"attestations\": [\n        {\n          \"type\": \"https://witness.dev/attestations/material/v0.1\"\n        },\n        {\n          \"type\": \"https://witness.dev/attestations/command-run/v0.1\"\n        }\n      ],\n      \"functionaries\": [\n        {\n          \"type\": \"publickey\",\n          \"publickeyid\": \"ci-key\"\n        }\n      ]\n    },\n    \"package\": {\n      \"name\": \"package\",\n      \"attestations\": [\n        {\n          \"type\": \"https://witness.dev/attestations/material/v0.1\"\n        },\n        {\n          \"type\": \"https://witness.dev/attestations/product/v0.1\"\n        }\n      ],\n      \"functionaries\": [\n        {\n          \"type\": \"publickey\",\n          \"publickeyid\": \"ci-key\"\n        }\n      ]\n    }\n  }\n}\n```\n\n**Pipeline Commands:**\n\n```bash\n# Step 1: Build\nwitness run --step build \\\n  --attestations git,commandrun,product \\\n  -o build.json --key ci-key.pem \\\n  -- go build -o myapp\n\n# Step 2: Test\nwitness run --step test \\\n  --attestations material,commandrun \\\n  -o test.json --key ci-key.pem \\\n  -- go test ./...\n\n# Step 3: Package\nwitness run --step package \\\n  --attestations material,product \\\n  -o package.json --key ci-key.pem \\\n  -- tar czf myapp.tar.gz myapp\n\n# Verify entire pipeline\nwitness verify \\\n  --policy policy-signed.json \\\n  --publickey policy-key.pub \\\n  -a build.json -a test.json -a package.json\n```\n"}]}
{"messages": [{"role": "system", "content": "You are an expert in the Witness supply chain attestation framework. You help users instrument CI/CD pipelines with witness, create policy documents, and write Rego policies to validate attestations. You understand all attestors in go-witness and how to use them effectively."}, {"role": "user", "content": "How do I create a multi-step witness policy for a build \u2192 test \u2192 package pipeline?"}, {"role": "assistant", "content": "Here's a complete multi-step witness policy for your pipeline:\n\n**Policy Document:**\n```json\n{\n  \"expires\": \"2026-11-08T10:52:59Z\",\n  \"publickeys\": {\n    \"ci-key\": {\n      \"keyid\": \"sha256:dc7acecd007440580c65b45f879f5643149cbb18f49490824c5c947d5e2f95b9\",\n      \"key\": \"-----BEGIN PUBLIC KEY-----\\n...\\n-----END PUBLIC KEY-----\"\n    }\n  },\n  \"steps\": {\n    \"build\": {\n      \"name\": \"build\",\n      \"attestations\": [\n        {\n          \"type\": \"https://witness.dev/attestations/git/v0.1\"\n        },\n        {\n          \"type\": \"https://witness.dev/attestations/command-run/v0.1\"\n        },\n        {\n          \"type\": \"https://witness.dev/attestations/product/v0.1\"\n        }\n      ],\n      \"functionaries\": [\n        {\n          \"type\": \"publickey\",\n          \"publickeyid\": \"ci-key\"\n        }\n      ]\n    },\n    \"test\": {\n      \"name\": \"test\",\n      \"attestations\": [\n        {\n          \"type\": \"https://witness.dev/attestations/material/v0.1\"\n        },\n        {\n          \"type\": \"https://witness.dev/attestations/command-run/v0.1\"\n        }\n      ],\n      \"functionaries\": [\n        {\n          \"type\": \"publickey\",\n          \"publickeyid\": \"ci-key\"\n        }\n      ]\n    },\n    \"package\": {\n      \"name\": \"package\",\n      \"attestations\": [\n        {\n          \"type\": \"https://witness.dev/attestations/material/v0.1\"\n        },\n        {\n          \"type\": \"https://witness.dev/attestations/product/v0.1\"\n        }\n      ],\n      \"functionaries\": [\n        {\n          \"type\": \"publickey\",\n          \"publickeyid\": \"ci-key\"\n        }\n      ]\n    }\n  }\n}\n```\n\n**Pipeline Commands:**\n\n```bash\n# Step 1: Build\nwitness run --step build \\\n  --attestations git,commandrun,product \\\n  -o build.json --key ci-key.pem \\\n  -- go build -o myapp\n\n# Step 2: Test\nwitness run --step test \\\n  --attestations material,commandrun \\\n  -o test.json --key ci-key.pem \\\n  -- go test ./...\n\n# Step 3: Package\nwitness run --step package \\\n  --attestations material,product \\\n  -o package.json --key ci-key.pem \\\n  -- tar czf myapp.tar.gz myapp\n\n# Verify entire pipeline\nwitness verify \\\n  --policy policy-signed.json \\\n  --publickey policy-key.pub \\\n  -a build.json -a test.json -a package.json\n```\n"}]}
{"messages": [{"role": "system", "content": "You are an expert in the Witness supply chain attestation framework. You help users instrument CI/CD pipelines with witness, create policy documents, and write Rego policies to validate attestations. You understand all attestors in go-witness and how to use them effectively."}, {"role": "user", "content": "How do I create a witness policy for a build step that uses these attestors: github, product, material, git?"}, {"role": "assistant", "content": "Here's a complete witness policy for your build step with github, product, material, git attestors:\n\n**Policy Document:**\n```json\n{\n  \"expires\": \"2026-11-08T10:52:59Z\",\n  \"publickeys\": {\n    \"build-key\": {\n      \"keyid\": \"sha256:aaedb256490979575cb1197df242594ad6050f3886f5e995797cec1ed18e0039\",\n      \"key\": \"-----BEGIN PUBLIC KEY-----\\n...\\n-----END PUBLIC KEY-----\"\n    }\n  },\n  \"steps\": {\n    \"build\": {\n      \"name\": \"build\",\n      \"attestations\": [\n        {\n          \"type\": \"https://witness.dev/attestations/github/v0.1\"\n        },\n        {\n          \"type\": \"https://witness.dev/attestations/product/v0.1\"\n        },\n        {\n          \"type\": \"https://witness.dev/attestations/material/v0.1\"\n        },\n        {\n          \"type\": \"https://witness.dev/attestations/git/v0.1\"\n        }\n      ],\n      \"functionaries\": [\n        {\n          \"type\": \"publickey\",\n          \"publickeyid\": \"build-key\"\n        }\n      ]\n    }\n  }\n}\n```\n\n**Witness Run Command:**\n```bash\nwitness run --step build \\\n  --attestations github,product,material,git \\\n  --outfile build-attestation.json \\\n  --key signing-key.pem \\\n  -- <your-build-command>\n```\n\n**Rego Validation Rules:**\n```rego\n\n```\n\n**Verification:**\n```bash\nwitness verify \\\n  --policy policy-signed.json \\\n  --publickey policy-key.pub \\\n  -a build-attestation.json \\\n  --subject <artifact>\n```\n"}]}
{"messages": [{"role": "system", "content": "You are an expert in the Witness supply chain attestation framework. You help users instrument CI/CD pipelines with witness, create policy documents, and write Rego policies to validate attestations. You understand all attestors in go-witness and how to use them effectively."}, {"role": "user", "content": "How do I create a witness policy for a build step that uses these attestors: product?"}, {"role": "assistant", "content": "Here's a complete witness policy for your build step with product attestors:\n\n**Policy Document:**\n```json\n{\n  \"expires\": \"2026-11-08T10:52:59Z\",\n  \"publickeys\": {\n    \"build-key\": {\n      \"keyid\": \"sha256:00b519b032fb9a8509ac6c84301f97703a7b55f1d090ff89b25c0cb290346ae9\",\n      \"key\": \"-----BEGIN PUBLIC KEY-----\\n...\\n-----END PUBLIC KEY-----\"\n    }\n  },\n  \"steps\": {\n    \"build\": {\n      \"name\": \"build\",\n      \"attestations\": [\n        {\n          \"type\": \"https://witness.dev/attestations/product/v0.1\"\n        }\n      ],\n      \"functionaries\": [\n        {\n          \"type\": \"publickey\",\n          \"publickeyid\": \"build-key\"\n        }\n      ]\n    }\n  }\n}\n```\n\n**Witness Run Command:**\n```bash\nwitness run --step build \\\n  --attestations product \\\n  --outfile build-attestation.json \\\n  --key signing-key.pem \\\n  -- <your-build-command>\n```\n\n**Rego Validation Rules:**\n```rego\n\n```\n\n**Verification:**\n```bash\nwitness verify \\\n  --policy policy-signed.json \\\n  --publickey policy-key.pub \\\n  -a build-attestation.json \\\n  --subject <artifact>\n```\n"}]}
{"messages": [{"role": "system", "content": "You are an expert in the Witness supply chain attestation framework. You help users instrument CI/CD pipelines with witness, create policy documents, and write Rego policies to validate attestations. You understand all attestors in go-witness and how to use them effectively."}, {"role": "user", "content": "How do I create a witness policy for a build step that uses these attestors: commandrun, github?"}, {"role": "assistant", "content": "Here's a complete witness policy for your build step with commandrun, github attestors:\n\n**Policy Document:**\n```json\n{\n  \"expires\": \"2026-11-08T10:52:59Z\",\n  \"publickeys\": {\n    \"build-key\": {\n      \"keyid\": \"sha256:4847c91fa614ba6b16285fdc488636a1dd1d4f4535407a286f2dcd299a3f6f36\",\n      \"key\": \"-----BEGIN PUBLIC KEY-----\\n...\\n-----END PUBLIC KEY-----\"\n    }\n  },\n  \"steps\": {\n    \"build\": {\n      \"name\": \"build\",\n      \"attestations\": [\n        {\n          \"type\": \"https://witness.dev/attestations/command-run/v0.1\"\n        },\n        {\n          \"type\": \"https://witness.dev/attestations/github/v0.1\"\n        }\n      ],\n      \"functionaries\": [\n        {\n          \"type\": \"publickey\",\n          \"publickeyid\": \"build-key\"\n        }\n      ]\n    }\n  }\n}\n```\n\n**Witness Run Command:**\n```bash\nwitness run --step build \\\n  --attestations commandrun,github \\\n  --outfile build-attestation.json \\\n  --key signing-key.pem \\\n  -- <your-build-command>\n```\n\n**Rego Validation Rules:**\n```rego\n\n```\n\n**Verification:**\n```bash\nwitness verify \\\n  --policy policy-signed.json \\\n  --publickey policy-key.pub \\\n  -a build-attestation.json \\\n  --subject <artifact>\n```\n"}]}
{"messages": [{"role": "system", "content": "You are an expert in the Witness supply chain attestation framework. You help users instrument CI/CD pipelines with witness, create policy documents, and write Rego policies to validate attestations. You understand all attestors in go-witness and how to use them effectively."}, {"role": "user", "content": "How do I create a witness policy for a build step that uses these attestors: product?"}, {"role": "assistant", "content": "Here's a complete witness policy for your build step with product attestors:\n\n**Policy Document:**\n```json\n{\n  \"expires\": \"2026-11-08T10:52:59Z\",\n  \"publickeys\": {\n    \"build-key\": {\n      \"keyid\": \"sha256:30fed7ba848acf8e182d31c50b1393860be7a6b307df617d005fa7eddf59ad18\",\n      \"key\": \"-----BEGIN PUBLIC KEY-----\\n...\\n-----END PUBLIC KEY-----\"\n    }\n  },\n  \"steps\": {\n    \"build\": {\n      \"name\": \"build\",\n      \"attestations\": [\n        {\n          \"type\": \"https://witness.dev/attestations/product/v0.1\"\n        }\n      ],\n      \"functionaries\": [\n        {\n          \"type\": \"publickey\",\n          \"publickeyid\": \"build-key\"\n        }\n      ]\n    }\n  }\n}\n```\n\n**Witness Run Command:**\n```bash\nwitness run --step build \\\n  --attestations product \\\n  --outfile build-attestation.json \\\n  --key signing-key.pem \\\n  -- <your-build-command>\n```\n\n**Rego Validation Rules:**\n```rego\n\n```\n\n**Verification:**\n```bash\nwitness verify \\\n  --policy policy-signed.json \\\n  --publickey policy-key.pub \\\n  -a build-attestation.json \\\n  --subject <artifact>\n```\n"}]}
{"messages": [{"role": "system", "content": "You are an expert in the Witness supply chain attestation framework. You help users instrument CI/CD pipelines with witness, create policy documents, and write Rego policies to validate attestations. You understand all attestors in go-witness and how to use them effectively."}, {"role": "user", "content": "How do I create a witness policy for a build step that uses these attestors: git?"}, {"role": "assistant", "content": "Here's a complete witness policy for your build step with git attestors:\n\n**Policy Document:**\n```json\n{\n  \"expires\": \"2026-11-08T10:52:59Z\",\n  \"publickeys\": {\n    \"build-key\": {\n      \"keyid\": \"sha256:66bacf1b4ed54a1f48adcfa6fd7fc2f44af5576767cc305ec091386d60b0e17d\",\n      \"key\": \"-----BEGIN PUBLIC KEY-----\\n...\\n-----END PUBLIC KEY-----\"\n    }\n  },\n  \"steps\": {\n    \"build\": {\n      \"name\": \"build\",\n      \"attestations\": [\n        {\n          \"type\": \"https://witness.dev/attestations/git/v0.1\"\n        }\n      ],\n      \"functionaries\": [\n        {\n          \"type\": \"publickey\",\n          \"publickeyid\": \"build-key\"\n        }\n      ]\n    }\n  }\n}\n```\n\n**Witness Run Command:**\n```bash\nwitness run --step build \\\n  --attestations git \\\n  --outfile build-attestation.json \\\n  --key signing-key.pem \\\n  -- <your-build-command>\n```\n\n**Rego Validation Rules:**\n```rego\npackage git\n\nimport rego.v1\n\n# Enforce builds from specific branch\ndeny contains msg if {\n    input.branch != \"master\"\n    msg := sprintf(\"Must build from master branch, got: %s\", [input.branch])\n}\n\n# Require clean working directory\ndeny contains msg if {\n    count(input.status) > 0\n    msg := \"Working directory must be clean (no uncommitted changes)\"\n}\n\n# Validate commit author\napproved_authors := {\n    \"alice.smith@example.com\",\n    \"bob.jones@company.com\",\n    \"ci-bot@company.com\"\n}\n\ndeny contains msg if {\n    not input.authoremail in approved_authors\n    msg := sprintf(\"Unauthorized commit author: %s\", [input.authoremail])\n}\n```\n\n**Verification:**\n```bash\nwitness verify \\\n  --policy policy-signed.json \\\n  --publickey policy-key.pub \\\n  -a build-attestation.json \\\n  --subject <artifact>\n```\n"}]}
{"messages": [{"role": "system", "content": "You are an expert in the Witness supply chain attestation framework. You help users instrument CI/CD pipelines with witness, create policy documents, and write Rego policies to validate attestations. You understand all attestors in go-witness and how to use them effectively."}, {"role": "user", "content": "How do I create a multi-step witness policy for a build \u2192 test \u2192 package pipeline?"}, {"role": "assistant", "content": "Here's a complete multi-step witness policy for your pipeline:\n\n**Policy Document:**\n```json\n{\n  \"expires\": \"2026-11-08T10:52:59Z\",\n  \"publickeys\": {\n    \"ci-key\": {\n      \"keyid\": \"sha256:2c695a9c113e0c12f90a9e9eeef656b99d58f88ad507004f3514e5895c292d7e\",\n      \"key\": \"-----BEGIN PUBLIC KEY-----\\n...\\n-----END PUBLIC KEY-----\"\n    }\n  },\n  \"steps\": {\n    \"build\": {\n      \"name\": \"build\",\n      \"attestations\": [\n        {\n          \"type\": \"https://witness.dev/attestations/git/v0.1\"\n        },\n        {\n          \"type\": \"https://witness.dev/attestations/command-run/v0.1\"\n        },\n        {\n          \"type\": \"https://witness.dev/attestations/product/v0.1\"\n        }\n      ],\n      \"functionaries\": [\n        {\n          \"type\": \"publickey\",\n          \"publickeyid\": \"ci-key\"\n        }\n      ]\n    },\n    \"test\": {\n      \"name\": \"test\",\n      \"attestations\": [\n        {\n          \"type\": \"https://witness.dev/attestations/material/v0.1\"\n        },\n        {\n          \"type\": \"https://witness.dev/attestations/command-run/v0.1\"\n        }\n      ],\n      \"functionaries\": [\n        {\n          \"type\": \"publickey\",\n          \"publickeyid\": \"ci-key\"\n        }\n      ]\n    },\n    \"package\": {\n      \"name\": \"package\",\n      \"attestations\": [\n        {\n          \"type\": \"https://witness.dev/attestations/material/v0.1\"\n        },\n        {\n          \"type\": \"https://witness.dev/attestations/product/v0.1\"\n        }\n      ],\n      \"functionaries\": [\n        {\n          \"type\": \"publickey\",\n          \"publickeyid\": \"ci-key\"\n        }\n      ]\n    }\n  }\n}\n```\n\n**Pipeline Commands:**\n\n```bash\n# Step 1: Build\nwitness run --step build \\\n  --attestations git,commandrun,product \\\n  -o build.json --key ci-key.pem \\\n  -- go build -o myapp\n\n# Step 2: Test\nwitness run --step test \\\n  --attestations material,commandrun \\\n  -o test.json --key ci-key.pem \\\n  -- go test ./...\n\n# Step 3: Package\nwitness run --step package \\\n  --attestations material,product \\\n  -o package.json --key ci-key.pem \\\n  -- tar czf myapp.tar.gz myapp\n\n# Verify entire pipeline\nwitness verify \\\n  --policy policy-signed.json \\\n  --publickey policy-key.pub \\\n  -a build.json -a test.json -a package.json\n```\n"}]}
{"messages": [{"role": "system", "content": "You are an expert in the Witness supply chain attestation framework. You help users instrument CI/CD pipelines with witness, create policy documents, and write Rego policies to validate attestations. You understand all attestors in go-witness and how to use them effectively."}, {"role": "user", "content": "How do I create a witness policy for a build step that uses these attestors: environment?"}, {"role": "assistant", "content": "Here's a complete witness policy for your build step with environment attestors:\n\n**Policy Document:**\n```json\n{\n  \"expires\": \"2026-11-08T10:52:59Z\",\n  \"publickeys\": {\n    \"build-key\": {\n      \"keyid\": \"sha256:ca4bcd5f7a6c3b8f0d86e7ddad99f6e647404c7e730ac15f7f3df63ed287bc8f\",\n      \"key\": \"-----BEGIN PUBLIC KEY-----\\n...\\n-----END PUBLIC KEY-----\"\n    }\n  },\n  \"steps\": {\n    \"build\": {\n      \"name\": \"build\",\n      \"attestations\": [\n        {\n          \"type\": \"https://witness.dev/attestations/environment/v0.1\"\n        }\n      ],\n      \"functionaries\": [\n        {\n          \"type\": \"publickey\",\n          \"publickeyid\": \"build-key\"\n        }\n      ]\n    }\n  }\n}\n```\n\n**Witness Run Command:**\n```bash\nwitness run --step build \\\n  --attestations environment \\\n  --outfile build-attestation.json \\\n  --key signing-key.pem \\\n  -- <your-build-command>\n```\n\n**Rego Validation Rules:**\n```rego\npackage environment\n\nimport rego.v1\n\n# Ensure correct OS\ndeny contains msg if {\n    input.os != \"linux\"\n    msg := sprintf(\"Must run on linux, got: %s\", [input.os])\n}\n\n# Require CI environment\ndeny contains msg if {\n    not \"CI\" in input.variables\n    msg := \"Must run in CI environment (CI variable not set)\"\n}\n```\n\n**Verification:**\n```bash\nwitness verify \\\n  --policy policy-signed.json \\\n  --publickey policy-key.pub \\\n  -a build-attestation.json \\\n  --subject <artifact>\n```\n"}]}
{"messages": [{"role": "system", "content": "You are an expert in the Witness supply chain attestation framework. You help users instrument CI/CD pipelines with witness, create policy documents, and write Rego policies to validate attestations. You understand all attestors in go-witness and how to use them effectively."}, {"role": "user", "content": "How do I create a witness policy for a build step that uses these attestors: material, environment, commandrun, product, git?"}, {"role": "assistant", "content": "Here's a complete witness policy for your build step with material, environment, commandrun, product, git attestors:\n\n**Policy Document:**\n```json\n{\n  \"expires\": \"2026-11-08T10:52:59Z\",\n  \"publickeys\": {\n    \"build-key\": {\n      \"keyid\": \"sha256:3c764c57a944bffa15fbe8006ad8e8eed067fcc8e2ae38cc37ba4cf537575d22\",\n      \"key\": \"-----BEGIN PUBLIC KEY-----\\n...\\n-----END PUBLIC KEY-----\"\n    }\n  },\n  \"steps\": {\n    \"build\": {\n      \"name\": \"build\",\n      \"attestations\": [\n        {\n          \"type\": \"https://witness.dev/attestations/material/v0.1\"\n        },\n        {\n          \"type\": \"https://witness.dev/attestations/environment/v0.1\"\n        },\n        {\n          \"type\": \"https://witness.dev/attestations/command-run/v0.1\"\n        },\n        {\n          \"type\": \"https://witness.dev/attestations/product/v0.1\"\n        },\n        {\n          \"type\": \"https://witness.dev/attestations/git/v0.1\"\n        }\n      ],\n      \"functionaries\": [\n        {\n          \"type\": \"publickey\",\n          \"publickeyid\": \"build-key\"\n        }\n      ]\n    }\n  }\n}\n```\n\n**Witness Run Command:**\n```bash\nwitness run --step build \\\n  --attestations material,environment,commandrun,product,git \\\n  --outfile build-attestation.json \\\n  --key signing-key.pem \\\n  -- <your-build-command>\n```\n\n**Rego Validation Rules:**\n```rego\n\n```\n\n**Verification:**\n```bash\nwitness verify \\\n  --policy policy-signed.json \\\n  --publickey policy-key.pub \\\n  -a build-attestation.json \\\n  --subject <artifact>\n```\n"}]}
{"messages": [{"role": "system", "content": "You are an expert in the Witness supply chain attestation framework. You help users instrument CI/CD pipelines with witness, create policy documents, and write Rego policies to validate attestations. You understand all attestors in go-witness and how to use them effectively."}, {"role": "user", "content": "How do I create a witness policy for a build step that uses these attestors: product?"}, {"role": "assistant", "content": "Here's a complete witness policy for your build step with product attestors:\n\n**Policy Document:**\n```json\n{\n  \"expires\": \"2026-11-08T10:52:59Z\",\n  \"publickeys\": {\n    \"build-key\": {\n      \"keyid\": \"sha256:988c2ba8a5c6d71d7690e5602f0d63027d991db90c60600055101805a6d333ed\",\n      \"key\": \"-----BEGIN PUBLIC KEY-----\\n...\\n-----END PUBLIC KEY-----\"\n    }\n  },\n  \"steps\": {\n    \"build\": {\n      \"name\": \"build\",\n      \"attestations\": [\n        {\n          \"type\": \"https://witness.dev/attestations/product/v0.1\"\n        }\n      ],\n      \"functionaries\": [\n        {\n          \"type\": \"publickey\",\n          \"publickeyid\": \"build-key\"\n        }\n      ]\n    }\n  }\n}\n```\n\n**Witness Run Command:**\n```bash\nwitness run --step build \\\n  --attestations product \\\n  --outfile build-attestation.json \\\n  --key signing-key.pem \\\n  -- <your-build-command>\n```\n\n**Rego Validation Rules:**\n```rego\n\n```\n\n**Verification:**\n```bash\nwitness verify \\\n  --policy policy-signed.json \\\n  --publickey policy-key.pub \\\n  -a build-attestation.json \\\n  --subject <artifact>\n```\n"}]}
{"messages": [{"role": "system", "content": "You are an expert in the Witness supply chain attestation framework. You help users instrument CI/CD pipelines with witness, create policy documents, and write Rego policies to validate attestations. You understand all attestors in go-witness and how to use them effectively."}, {"role": "user", "content": "How do I create a witness policy for a build step that uses these attestors: commandrun, github, git, product, environment?"}, {"role": "assistant", "content": "Here's a complete witness policy for your build step with commandrun, github, git, product, environment attestors:\n\n**Policy Document:**\n```json\n{\n  \"expires\": \"2026-11-08T10:52:59Z\",\n  \"publickeys\": {\n    \"build-key\": {\n      \"keyid\": \"sha256:69d80fd5a620e33e132bcd8ddc170879d9c5335c02c27571b31266a7f39784ec\",\n      \"key\": \"-----BEGIN PUBLIC KEY-----\\n...\\n-----END PUBLIC KEY-----\"\n    }\n  },\n  \"steps\": {\n    \"build\": {\n      \"name\": \"build\",\n      \"attestations\": [\n        {\n          \"type\": \"https://witness.dev/attestations/command-run/v0.1\"\n        },\n        {\n          \"type\": \"https://witness.dev/attestations/github/v0.1\"\n        },\n        {\n          \"type\": \"https://witness.dev/attestations/git/v0.1\"\n        },\n        {\n          \"type\": \"https://witness.dev/attestations/product/v0.1\"\n        },\n        {\n          \"type\": \"https://witness.dev/attestations/environment/v0.1\"\n        }\n      ],\n      \"functionaries\": [\n        {\n          \"type\": \"publickey\",\n          \"publickeyid\": \"build-key\"\n        }\n      ]\n    }\n  }\n}\n```\n\n**Witness Run Command:**\n```bash\nwitness run --step build \\\n  --attestations commandrun,github,git,product,environment \\\n  --outfile build-attestation.json \\\n  --key signing-key.pem \\\n  -- <your-build-command>\n```\n\n**Rego Validation Rules:**\n```rego\n\n```\n\n**Verification:**\n```bash\nwitness verify \\\n  --policy policy-signed.json \\\n  --publickey policy-key.pub \\\n  -a build-attestation.json \\\n  --subject <artifact>\n```\n"}]}
{"messages": [{"role": "system", "content": "You are an expert in the Witness supply chain attestation framework. You help users instrument CI/CD pipelines with witness, create policy documents, and write Rego policies to validate attestations. You understand all attestors in go-witness and how to use them effectively."}, {"role": "user", "content": "How do I create a witness policy for a build step that uses these attestors: product, material?"}, {"role": "assistant", "content": "Here's a complete witness policy for your build step with product, material attestors:\n\n**Policy Document:**\n```json\n{\n  \"expires\": \"2026-11-08T10:52:59Z\",\n  \"publickeys\": {\n    \"build-key\": {\n      \"keyid\": \"sha256:a8e356d5af50fcc0614fdc7990e698dd97e546156007abe79ae667bf8ba4b8b3\",\n      \"key\": \"-----BEGIN PUBLIC KEY-----\\n...\\n-----END PUBLIC KEY-----\"\n    }\n  },\n  \"steps\": {\n    \"build\": {\n      \"name\": \"build\",\n      \"attestations\": [\n        {\n          \"type\": \"https://witness.dev/attestations/product/v0.1\"\n        },\n        {\n          \"type\": \"https://witness.dev/attestations/material/v0.1\"\n        }\n      ],\n      \"functionaries\": [\n        {\n          \"type\": \"publickey\",\n          \"publickeyid\": \"build-key\"\n        }\n      ]\n    }\n  }\n}\n```\n\n**Witness Run Command:**\n```bash\nwitness run --step build \\\n  --attestations product,material \\\n  --outfile build-attestation.json \\\n  --key signing-key.pem \\\n  -- <your-build-command>\n```\n\n**Rego Validation Rules:**\n```rego\n\n```\n\n**Verification:**\n```bash\nwitness verify \\\n  --policy policy-signed.json \\\n  --publickey policy-key.pub \\\n  -a build-attestation.json \\\n  --subject <artifact>\n```\n"}]}
{"messages": [{"role": "system", "content": "You are an expert in the Witness supply chain attestation framework. You help users instrument CI/CD pipelines with witness, create policy documents, and write Rego policies to validate attestations. You understand all attestors in go-witness and how to use them effectively."}, {"role": "user", "content": "How do I create a multi-step witness policy for a build \u2192 test \u2192 package pipeline?"}, {"role": "assistant", "content": "Here's a complete multi-step witness policy for your pipeline:\n\n**Policy Document:**\n```json\n{\n  \"expires\": \"2026-11-08T10:52:59Z\",\n  \"publickeys\": {\n    \"ci-key\": {\n      \"keyid\": \"sha256:813a99479c4cc298747ef2becf70519e40a5446dae81912fcbc0e0af4646b610\",\n      \"key\": \"-----BEGIN PUBLIC KEY-----\\n...\\n-----END PUBLIC KEY-----\"\n    }\n  },\n  \"steps\": {\n    \"build\": {\n      \"name\": \"build\",\n      \"attestations\": [\n        {\n          \"type\": \"https://witness.dev/attestations/git/v0.1\"\n        },\n        {\n          \"type\": \"https://witness.dev/attestations/command-run/v0.1\"\n        },\n        {\n          \"type\": \"https://witness.dev/attestations/product/v0.1\"\n        }\n      ],\n      \"functionaries\": [\n        {\n          \"type\": \"publickey\",\n          \"publickeyid\": \"ci-key\"\n        }\n      ]\n    },\n    \"test\": {\n      \"name\": \"test\",\n      \"attestations\": [\n        {\n          \"type\": \"https://witness.dev/attestations/material/v0.1\"\n        },\n        {\n          \"type\": \"https://witness.dev/attestations/command-run/v0.1\"\n        }\n      ],\n      \"functionaries\": [\n        {\n          \"type\": \"publickey\",\n          \"publickeyid\": \"ci-key\"\n        }\n      ]\n    },\n    \"package\": {\n      \"name\": \"package\",\n      \"attestations\": [\n        {\n          \"type\": \"https://witness.dev/attestations/material/v0.1\"\n        },\n        {\n          \"type\": \"https://witness.dev/attestations/product/v0.1\"\n        }\n      ],\n      \"functionaries\": [\n        {\n          \"type\": \"publickey\",\n          \"publickeyid\": \"ci-key\"\n        }\n      ]\n    }\n  }\n}\n```\n\n**Pipeline Commands:**\n\n```bash\n# Step 1: Build\nwitness run --step build \\\n  --attestations git,commandrun,product \\\n  -o build.json --key ci-key.pem \\\n  -- go build -o myapp\n\n# Step 2: Test\nwitness run --step test \\\n  --attestations material,commandrun \\\n  -o test.json --key ci-key.pem \\\n  -- go test ./...\n\n# Step 3: Package\nwitness run --step package \\\n  --attestations material,product \\\n  -o package.json --key ci-key.pem \\\n  -- tar czf myapp.tar.gz myapp\n\n# Verify entire pipeline\nwitness verify \\\n  --policy policy-signed.json \\\n  --publickey policy-key.pub \\\n  -a build.json -a test.json -a package.json\n```\n"}]}
{"messages": [{"role": "system", "content": "You are an expert in the Witness supply chain attestation framework. You help users instrument CI/CD pipelines with witness, create policy documents, and write Rego policies to validate attestations. You understand all attestors in go-witness and how to use them effectively."}, {"role": "user", "content": "How do I create a multi-step witness policy for a build \u2192 test \u2192 package pipeline?"}, {"role": "assistant", "content": "Here's a complete multi-step witness policy for your pipeline:\n\n**Policy Document:**\n```json\n{\n  \"expires\": \"2026-11-08T10:52:59Z\",\n  \"publickeys\": {\n    \"ci-key\": {\n      \"keyid\": \"sha256:060bd0540898cb1eec6ea1fa3f49707662ba0efb79902b8b68214ae01233a327\",\n      \"key\": \"-----BEGIN PUBLIC KEY-----\\n...\\n-----END PUBLIC KEY-----\"\n    }\n  },\n  \"steps\": {\n    \"build\": {\n      \"name\": \"build\",\n      \"attestations\": [\n        {\n          \"type\": \"https://witness.dev/attestations/git/v0.1\"\n        },\n        {\n          \"type\": \"https://witness.dev/attestations/command-run/v0.1\"\n        },\n        {\n          \"type\": \"https://witness.dev/attestations/product/v0.1\"\n        }\n      ],\n      \"functionaries\": [\n        {\n          \"type\": \"publickey\",\n          \"publickeyid\": \"ci-key\"\n        }\n      ]\n    },\n    \"test\": {\n      \"name\": \"test\",\n      \"attestations\": [\n        {\n          \"type\": \"https://witness.dev/attestations/material/v0.1\"\n        },\n        {\n          \"type\": \"https://witness.dev/attestations/command-run/v0.1\"\n        }\n      ],\n      \"functionaries\": [\n        {\n          \"type\": \"publickey\",\n          \"publickeyid\": \"ci-key\"\n        }\n      ]\n    },\n    \"package\": {\n      \"name\": \"package\",\n      \"attestations\": [\n        {\n          \"type\": \"https://witness.dev/attestations/material/v0.1\"\n        },\n        {\n          \"type\": \"https://witness.dev/attestations/product/v0.1\"\n        }\n      ],\n      \"functionaries\": [\n        {\n          \"type\": \"publickey\",\n          \"publickeyid\": \"ci-key\"\n        }\n      ]\n    }\n  }\n}\n```\n\n**Pipeline Commands:**\n\n```bash\n# Step 1: Build\nwitness run --step build \\\n  --attestations git,commandrun,product \\\n  -o build.json --key ci-key.pem \\\n  -- go build -o myapp\n\n# Step 2: Test\nwitness run --step test \\\n  --attestations material,commandrun \\\n  -o test.json --key ci-key.pem \\\n  -- go test ./...\n\n# Step 3: Package\nwitness run --step package \\\n  --attestations material,product \\\n  -o package.json --key ci-key.pem \\\n  -- tar czf myapp.tar.gz myapp\n\n# Verify entire pipeline\nwitness verify \\\n  --policy policy-signed.json \\\n  --publickey policy-key.pub \\\n  -a build.json -a test.json -a package.json\n```\n"}]}
{"messages": [{"role": "system", "content": "You are an expert in the Witness supply chain attestation framework. You help users instrument CI/CD pipelines with witness, create policy documents, and write Rego policies to validate attestations. You understand all attestors in go-witness and how to use them effectively."}, {"role": "user", "content": "How do I create a witness policy for a build step that uses these attestors: material?"}, {"role": "assistant", "content": "Here's a complete witness policy for your build step with material attestors:\n\n**Policy Document:**\n```json\n{\n  \"expires\": \"2026-11-08T10:52:59Z\",\n  \"publickeys\": {\n    \"build-key\": {\n      \"keyid\": \"sha256:07bb28f91a7e7ad0f7d4e9888fdec002666d342772e279a78ae7b5f912a9e7f7\",\n      \"key\": \"-----BEGIN PUBLIC KEY-----\\n...\\n-----END PUBLIC KEY-----\"\n    }\n  },\n  \"steps\": {\n    \"build\": {\n      \"name\": \"build\",\n      \"attestations\": [\n        {\n          \"type\": \"https://witness.dev/attestations/material/v0.1\"\n        }\n      ],\n      \"functionaries\": [\n        {\n          \"type\": \"publickey\",\n          \"publickeyid\": \"build-key\"\n        }\n      ]\n    }\n  }\n}\n```\n\n**Witness Run Command:**\n```bash\nwitness run --step build \\\n  --attestations material \\\n  --outfile build-attestation.json \\\n  --key signing-key.pem \\\n  -- <your-build-command>\n```\n\n**Rego Validation Rules:**\n```rego\n\n```\n\n**Verification:**\n```bash\nwitness verify \\\n  --policy policy-signed.json \\\n  --publickey policy-key.pub \\\n  -a build-attestation.json \\\n  --subject <artifact>\n```\n"}]}
{"messages": [{"role": "system", "content": "You are an expert in the Witness supply chain attestation framework. You help users instrument CI/CD pipelines with witness, create policy documents, and write Rego policies to validate attestations. You understand all attestors in go-witness and how to use them effectively."}, {"role": "user", "content": "How do I create a witness policy for a build step that uses these attestors: github, environment?"}, {"role": "assistant", "content": "Here's a complete witness policy for your build step with github, environment attestors:\n\n**Policy Document:**\n```json\n{\n  \"expires\": \"2026-11-08T10:52:59Z\",\n  \"publickeys\": {\n    \"build-key\": {\n      \"keyid\": \"sha256:50a868c9fb4a3206f46412488f71e943d1f0940555078cfdce2a72e11f016a9b\",\n      \"key\": \"-----BEGIN PUBLIC KEY-----\\n...\\n-----END PUBLIC KEY-----\"\n    }\n  },\n  \"steps\": {\n    \"build\": {\n      \"name\": \"build\",\n      \"attestations\": [\n        {\n          \"type\": \"https://witness.dev/attestations/github/v0.1\"\n        },\n        {\n          \"type\": \"https://witness.dev/attestations/environment/v0.1\"\n        }\n      ],\n      \"functionaries\": [\n        {\n          \"type\": \"publickey\",\n          \"publickeyid\": \"build-key\"\n        }\n      ]\n    }\n  }\n}\n```\n\n**Witness Run Command:**\n```bash\nwitness run --step build \\\n  --attestations github,environment \\\n  --outfile build-attestation.json \\\n  --key signing-key.pem \\\n  -- <your-build-command>\n```\n\n**Rego Validation Rules:**\n```rego\n\n```\n\n**Verification:**\n```bash\nwitness verify \\\n  --policy policy-signed.json \\\n  --publickey policy-key.pub \\\n  -a build-attestation.json \\\n  --subject <artifact>\n```\n"}]}
{"messages": [{"role": "system", "content": "You are an expert in the Witness supply chain attestation framework. You help users instrument CI/CD pipelines with witness, create policy documents, and write Rego policies to validate attestations. You understand all attestors in go-witness and how to use them effectively."}, {"role": "user", "content": "How do I create a multi-step witness policy for a build \u2192 test \u2192 package pipeline?"}, {"role": "assistant", "content": "Here's a complete multi-step witness policy for your pipeline:\n\n**Policy Document:**\n```json\n{\n  \"expires\": \"2026-11-08T10:52:59Z\",\n  \"publickeys\": {\n    \"ci-key\": {\n      \"keyid\": \"sha256:c00cb1efeec015aff974076c356e896026254291ee620141be166336d00ad196\",\n      \"key\": \"-----BEGIN PUBLIC KEY-----\\n...\\n-----END PUBLIC KEY-----\"\n    }\n  },\n  \"steps\": {\n    \"build\": {\n      \"name\": \"build\",\n      \"attestations\": [\n        {\n          \"type\": \"https://witness.dev/attestations/git/v0.1\"\n        },\n        {\n          \"type\": \"https://witness.dev/attestations/command-run/v0.1\"\n        },\n        {\n          \"type\": \"https://witness.dev/attestations/product/v0.1\"\n        }\n      ],\n      \"functionaries\": [\n        {\n          \"type\": \"publickey\",\n          \"publickeyid\": \"ci-key\"\n        }\n      ]\n    },\n    \"test\": {\n      \"name\": \"test\",\n      \"attestations\": [\n        {\n          \"type\": \"https://witness.dev/attestations/material/v0.1\"\n        },\n        {\n          \"type\": \"https://witness.dev/attestations/command-run/v0.1\"\n        }\n      ],\n      \"functionaries\": [\n        {\n          \"type\": \"publickey\",\n          \"publickeyid\": \"ci-key\"\n        }\n      ]\n    },\n    \"package\": {\n      \"name\": \"package\",\n      \"attestations\": [\n        {\n          \"type\": \"https://witness.dev/attestations/material/v0.1\"\n        },\n        {\n          \"type\": \"https://witness.dev/attestations/product/v0.1\"\n        }\n      ],\n      \"functionaries\": [\n        {\n          \"type\": \"publickey\",\n          \"publickeyid\": \"ci-key\"\n        }\n      ]\n    }\n  }\n}\n```\n\n**Pipeline Commands:**\n\n```bash\n# Step 1: Build\nwitness run --step build \\\n  --attestations git,commandrun,product \\\n  -o build.json --key ci-key.pem \\\n  -- go build -o myapp\n\n# Step 2: Test\nwitness run --step test \\\n  --attestations material,commandrun \\\n  -o test.json --key ci-key.pem \\\n  -- go test ./...\n\n# Step 3: Package\nwitness run --step package \\\n  --attestations material,product \\\n  -o package.json --key ci-key.pem \\\n  -- tar czf myapp.tar.gz myapp\n\n# Verify entire pipeline\nwitness verify \\\n  --policy policy-signed.json \\\n  --publickey policy-key.pub \\\n  -a build.json -a test.json -a package.json\n```\n"}]}
{"messages": [{"role": "system", "content": "You are an expert in the Witness supply chain attestation framework. You help users instrument CI/CD pipelines with witness, create policy documents, and write Rego policies to validate attestations. You understand all attestors in go-witness and how to use them effectively."}, {"role": "user", "content": "How do I create a witness policy for a build step that uses these attestors: material, environment, commandrun, product?"}, {"role": "assistant", "content": "Here's a complete witness policy for your build step with material, environment, commandrun, product attestors:\n\n**Policy Document:**\n```json\n{\n  \"expires\": \"2026-11-08T10:52:59Z\",\n  \"publickeys\": {\n    \"build-key\": {\n      \"keyid\": \"sha256:3c2fd9cb509e57afaeb337fcb74c189c20e1735a6197985904a570b19322aa59\",\n      \"key\": \"-----BEGIN PUBLIC KEY-----\\n...\\n-----END PUBLIC KEY-----\"\n    }\n  },\n  \"steps\": {\n    \"build\": {\n      \"name\": \"build\",\n      \"attestations\": [\n        {\n          \"type\": \"https://witness.dev/attestations/material/v0.1\"\n        },\n        {\n          \"type\": \"https://witness.dev/attestations/environment/v0.1\"\n        },\n        {\n          \"type\": \"https://witness.dev/attestations/command-run/v0.1\"\n        },\n        {\n          \"type\": \"https://witness.dev/attestations/product/v0.1\"\n        }\n      ],\n      \"functionaries\": [\n        {\n          \"type\": \"publickey\",\n          \"publickeyid\": \"build-key\"\n        }\n      ]\n    }\n  }\n}\n```\n\n**Witness Run Command:**\n```bash\nwitness run --step build \\\n  --attestations material,environment,commandrun,product \\\n  --outfile build-attestation.json \\\n  --key signing-key.pem \\\n  -- <your-build-command>\n```\n\n**Rego Validation Rules:**\n```rego\n\n```\n\n**Verification:**\n```bash\nwitness verify \\\n  --policy policy-signed.json \\\n  --publickey policy-key.pub \\\n  -a build-attestation.json \\\n  --subject <artifact>\n```\n"}]}
{"messages": [{"role": "system", "content": "You are an expert in the Witness supply chain attestation framework. You help users instrument CI/CD pipelines with witness, create policy documents, and write Rego policies to validate attestations. You understand all attestors in go-witness and how to use them effectively."}, {"role": "user", "content": "How do I create a multi-step witness policy for a build \u2192 test \u2192 package pipeline?"}, {"role": "assistant", "content": "Here's a complete multi-step witness policy for your pipeline:\n\n**Policy Document:**\n```json\n{\n  \"expires\": \"2026-11-08T10:52:59Z\",\n  \"publickeys\": {\n    \"ci-key\": {\n      \"keyid\": \"sha256:5bc9cd043d17ff133bf0221d17b97eae2822ac6e6ad5a548cc3b73bc50c5b5c4\",\n      \"key\": \"-----BEGIN PUBLIC KEY-----\\n...\\n-----END PUBLIC KEY-----\"\n    }\n  },\n  \"steps\": {\n    \"build\": {\n      \"name\": \"build\",\n      \"attestations\": [\n        {\n          \"type\": \"https://witness.dev/attestations/git/v0.1\"\n        },\n        {\n          \"type\": \"https://witness.dev/attestations/command-run/v0.1\"\n        },\n        {\n          \"type\": \"https://witness.dev/attestations/product/v0.1\"\n        }\n      ],\n      \"functionaries\": [\n        {\n          \"type\": \"publickey\",\n          \"publickeyid\": \"ci-key\"\n        }\n      ]\n    },\n    \"test\": {\n      \"name\": \"test\",\n      \"attestations\": [\n        {\n          \"type\": \"https://witness.dev/attestations/material/v0.1\"\n        },\n        {\n          \"type\": \"https://witness.dev/attestations/command-run/v0.1\"\n        }\n      ],\n      \"functionaries\": [\n        {\n          \"type\": \"publickey\",\n          \"publickeyid\": \"ci-key\"\n        }\n      ]\n    },\n    \"package\": {\n      \"name\": \"package\",\n      \"attestations\": [\n        {\n          \"type\": \"https://witness.dev/attestations/material/v0.1\"\n        },\n        {\n          \"type\": \"https://witness.dev/attestations/product/v0.1\"\n        }\n      ],\n      \"functionaries\": [\n        {\n          \"type\": \"publickey\",\n          \"publickeyid\": \"ci-key\"\n        }\n      ]\n    }\n  }\n}\n```\n\n**Pipeline Commands:**\n\n```bash\n# Step 1: Build\nwitness run --step build \\\n  --attestations git,commandrun,product \\\n  -o build.json --key ci-key.pem \\\n  -- go build -o myapp\n\n# Step 2: Test\nwitness run --step test \\\n  --attestations material,commandrun \\\n  -o test.json --key ci-key.pem \\\n  -- go test ./...\n\n# Step 3: Package\nwitness run --step package \\\n  --attestations material,product \\\n  -o package.json --key ci-key.pem \\\n  -- tar czf myapp.tar.gz myapp\n\n# Verify entire pipeline\nwitness verify \\\n  --policy policy-signed.json \\\n  --publickey policy-key.pub \\\n  -a build.json -a test.json -a package.json\n```\n"}]}
{"messages": [{"role": "system", "content": "You are an expert in the Witness supply chain attestation framework. You help users instrument CI/CD pipelines with witness, create policy documents, and write Rego policies to validate attestations. You understand all attestors in go-witness and how to use them effectively."}, {"role": "user", "content": "How do I create a multi-step witness policy for a build \u2192 test \u2192 package pipeline?"}, {"role": "assistant", "content": "Here's a complete multi-step witness policy for your pipeline:\n\n**Policy Document:**\n```json\n{\n  \"expires\": \"2026-11-08T10:52:59Z\",\n  \"publickeys\": {\n    \"ci-key\": {\n      \"keyid\": \"sha256:7216001c2db6c9e032dee0438d0369d2c2811ac12fad11c572b1b76061c624ea\",\n      \"key\": \"-----BEGIN PUBLIC KEY-----\\n...\\n-----END PUBLIC KEY-----\"\n    }\n  },\n  \"steps\": {\n    \"build\": {\n      \"name\": \"build\",\n      \"attestations\": [\n        {\n          \"type\": \"https://witness.dev/attestations/git/v0.1\"\n        },\n        {\n          \"type\": \"https://witness.dev/attestations/command-run/v0.1\"\n        },\n        {\n          \"type\": \"https://witness.dev/attestations/product/v0.1\"\n        }\n      ],\n      \"functionaries\": [\n        {\n          \"type\": \"publickey\",\n          \"publickeyid\": \"ci-key\"\n        }\n      ]\n    },\n    \"test\": {\n      \"name\": \"test\",\n      \"attestations\": [\n        {\n          \"type\": \"https://witness.dev/attestations/material/v0.1\"\n        },\n        {\n          \"type\": \"https://witness.dev/attestations/command-run/v0.1\"\n        }\n      ],\n      \"functionaries\": [\n        {\n          \"type\": \"publickey\",\n          \"publickeyid\": \"ci-key\"\n        }\n      ]\n    },\n    \"package\": {\n      \"name\": \"package\",\n      \"attestations\": [\n        {\n          \"type\": \"https://witness.dev/attestations/material/v0.1\"\n        },\n        {\n          \"type\": \"https://witness.dev/attestations/product/v0.1\"\n        }\n      ],\n      \"functionaries\": [\n        {\n          \"type\": \"publickey\",\n          \"publickeyid\": \"ci-key\"\n        }\n      ]\n    }\n  }\n}\n```\n\n**Pipeline Commands:**\n\n```bash\n# Step 1: Build\nwitness run --step build \\\n  --attestations git,commandrun,product \\\n  -o build.json --key ci-key.pem \\\n  -- go build -o myapp\n\n# Step 2: Test\nwitness run --step test \\\n  --attestations material,commandrun \\\n  -o test.json --key ci-key.pem \\\n  -- go test ./...\n\n# Step 3: Package\nwitness run --step package \\\n  --attestations material,product \\\n  -o package.json --key ci-key.pem \\\n  -- tar czf myapp.tar.gz myapp\n\n# Verify entire pipeline\nwitness verify \\\n  --policy policy-signed.json \\\n  --publickey policy-key.pub \\\n  -a build.json -a test.json -a package.json\n```\n"}]}
{"messages": [{"role": "system", "content": "You are an expert in the Witness supply chain attestation framework. You help users instrument CI/CD pipelines with witness, create policy documents, and write Rego policies to validate attestations. You understand all attestors in go-witness and how to use them effectively."}, {"role": "user", "content": "How do I create a multi-step witness policy for a build \u2192 test \u2192 package pipeline?"}, {"role": "assistant", "content": "Here's a complete multi-step witness policy for your pipeline:\n\n**Policy Document:**\n```json\n{\n  \"expires\": \"2026-11-08T10:52:59Z\",\n  \"publickeys\": {\n    \"ci-key\": {\n      \"keyid\": \"sha256:feea7155239fe635e83f1ee656497abb8ea10d9532fdee4dcd2b14d5a0c58872\",\n      \"key\": \"-----BEGIN PUBLIC KEY-----\\n...\\n-----END PUBLIC KEY-----\"\n    }\n  },\n  \"steps\": {\n    \"build\": {\n      \"name\": \"build\",\n      \"attestations\": [\n        {\n          \"type\": \"https://witness.dev/attestations/git/v0.1\"\n        },\n        {\n          \"type\": \"https://witness.dev/attestations/command-run/v0.1\"\n        },\n        {\n          \"type\": \"https://witness.dev/attestations/product/v0.1\"\n        }\n      ],\n      \"functionaries\": [\n        {\n          \"type\": \"publickey\",\n          \"publickeyid\": \"ci-key\"\n        }\n      ]\n    },\n    \"test\": {\n      \"name\": \"test\",\n      \"attestations\": [\n        {\n          \"type\": \"https://witness.dev/attestations/material/v0.1\"\n        },\n        {\n          \"type\": \"https://witness.dev/attestations/command-run/v0.1\"\n        }\n      ],\n      \"functionaries\": [\n        {\n          \"type\": \"publickey\",\n          \"publickeyid\": \"ci-key\"\n        }\n      ]\n    },\n    \"package\": {\n      \"name\": \"package\",\n      \"attestations\": [\n        {\n          \"type\": \"https://witness.dev/attestations/material/v0.1\"\n        },\n        {\n          \"type\": \"https://witness.dev/attestations/product/v0.1\"\n        }\n      ],\n      \"functionaries\": [\n        {\n          \"type\": \"publickey\",\n          \"publickeyid\": \"ci-key\"\n        }\n      ]\n    }\n  }\n}\n```\n\n**Pipeline Commands:**\n\n```bash\n# Step 1: Build\nwitness run --step build \\\n  --attestations git,commandrun,product \\\n  -o build.json --key ci-key.pem \\\n  -- go build -o myapp\n\n# Step 2: Test\nwitness run --step test \\\n  --attestations material,commandrun \\\n  -o test.json --key ci-key.pem \\\n  -- go test ./...\n\n# Step 3: Package\nwitness run --step package \\\n  --attestations material,product \\\n  -o package.json --key ci-key.pem \\\n  -- tar czf myapp.tar.gz myapp\n\n# Verify entire pipeline\nwitness verify \\\n  --policy policy-signed.json \\\n  --publickey policy-key.pub \\\n  -a build.json -a test.json -a package.json\n```\n"}]}
{"messages": [{"role": "system", "content": "You are an expert in the Witness supply chain attestation framework. You help users instrument CI/CD pipelines with witness, create policy documents, and write Rego policies to validate attestations. You understand all attestors in go-witness and how to use them effectively."}, {"role": "user", "content": "How do I create a multi-step witness policy for a build \u2192 test \u2192 package pipeline?"}, {"role": "assistant", "content": "Here's a complete multi-step witness policy for your pipeline:\n\n**Policy Document:**\n```json\n{\n  \"expires\": \"2026-11-08T10:52:59Z\",\n  \"publickeys\": {\n    \"ci-key\": {\n      \"keyid\": \"sha256:e55e4973ad586031cf094c6d5b9b9a9cd9d76483e0413f23f4b1d9a40c87002a\",\n      \"key\": \"-----BEGIN PUBLIC KEY-----\\n...\\n-----END PUBLIC KEY-----\"\n    }\n  },\n  \"steps\": {\n    \"build\": {\n      \"name\": \"build\",\n      \"attestations\": [\n        {\n          \"type\": \"https://witness.dev/attestations/git/v0.1\"\n        },\n        {\n          \"type\": \"https://witness.dev/attestations/command-run/v0.1\"\n        },\n        {\n          \"type\": \"https://witness.dev/attestations/product/v0.1\"\n        }\n      ],\n      \"functionaries\": [\n        {\n          \"type\": \"publickey\",\n          \"publickeyid\": \"ci-key\"\n        }\n      ]\n    },\n    \"test\": {\n      \"name\": \"test\",\n      \"attestations\": [\n        {\n          \"type\": \"https://witness.dev/attestations/material/v0.1\"\n        },\n        {\n          \"type\": \"https://witness.dev/attestations/command-run/v0.1\"\n        }\n      ],\n      \"functionaries\": [\n        {\n          \"type\": \"publickey\",\n          \"publickeyid\": \"ci-key\"\n        }\n      ]\n    },\n    \"package\": {\n      \"name\": \"package\",\n      \"attestations\": [\n        {\n          \"type\": \"https://witness.dev/attestations/material/v0.1\"\n        },\n        {\n          \"type\": \"https://witness.dev/attestations/product/v0.1\"\n        }\n      ],\n      \"functionaries\": [\n        {\n          \"type\": \"publickey\",\n          \"publickeyid\": \"ci-key\"\n        }\n      ]\n    }\n  }\n}\n```\n\n**Pipeline Commands:**\n\n```bash\n# Step 1: Build\nwitness run --step build \\\n  --attestations git,commandrun,product \\\n  -o build.json --key ci-key.pem \\\n  -- go build -o myapp\n\n# Step 2: Test\nwitness run --step test \\\n  --attestations material,commandrun \\\n  -o test.json --key ci-key.pem \\\n  -- go test ./...\n\n# Step 3: Package\nwitness run --step package \\\n  --attestations material,product \\\n  -o package.json --key ci-key.pem \\\n  -- tar czf myapp.tar.gz myapp\n\n# Verify entire pipeline\nwitness verify \\\n  --policy policy-signed.json \\\n  --publickey policy-key.pub \\\n  -a build.json -a test.json -a package.json\n```\n"}]}
{"messages": [{"role": "system", "content": "You are an expert in the Witness supply chain attestation framework. You help users instrument CI/CD pipelines with witness, create policy documents, and write Rego policies to validate attestations. You understand all attestors in go-witness and how to use them effectively."}, {"role": "user", "content": "How do I create a witness policy for a build step that uses these attestors: git?"}, {"role": "assistant", "content": "Here's a complete witness policy for your build step with git attestors:\n\n**Policy Document:**\n```json\n{\n  \"expires\": \"2026-11-08T10:52:59Z\",\n  \"publickeys\": {\n    \"build-key\": {\n      \"keyid\": \"sha256:8a4a47b20f06ef11dc541b497686fb0a80dd9458a161dc61afc82ee29fe8cabe\",\n      \"key\": \"-----BEGIN PUBLIC KEY-----\\n...\\n-----END PUBLIC KEY-----\"\n    }\n  },\n  \"steps\": {\n    \"build\": {\n      \"name\": \"build\",\n      \"attestations\": [\n        {\n          \"type\": \"https://witness.dev/attestations/git/v0.1\"\n        }\n      ],\n      \"functionaries\": [\n        {\n          \"type\": \"publickey\",\n          \"publickeyid\": \"build-key\"\n        }\n      ]\n    }\n  }\n}\n```\n\n**Witness Run Command:**\n```bash\nwitness run --step build \\\n  --attestations git \\\n  --outfile build-attestation.json \\\n  --key signing-key.pem \\\n  -- <your-build-command>\n```\n\n**Rego Validation Rules:**\n```rego\npackage git\n\nimport rego.v1\n\n# Enforce builds from specific branch\ndeny contains msg if {\n    input.branch != \"release/v1.0\"\n    msg := sprintf(\"Must build from release/v1.0 branch, got: %s\", [input.branch])\n}\n\n# Require clean working directory\ndeny contains msg if {\n    count(input.status) > 0\n    msg := \"Working directory must be clean (no uncommitted changes)\"\n}\n\n# Validate commit author\napproved_authors := {\n    \"alice.smith@example.com\",\n    \"bob.jones@company.com\",\n    \"ci-bot@company.com\"\n}\n\ndeny contains msg if {\n    not input.authoremail in approved_authors\n    msg := sprintf(\"Unauthorized commit author: %s\", [input.authoremail])\n}\n```\n\n**Verification:**\n```bash\nwitness verify \\\n  --policy policy-signed.json \\\n  --publickey policy-key.pub \\\n  -a build-attestation.json \\\n  --subject <artifact>\n```\n"}]}
{"messages": [{"role": "system", "content": "You are an expert in the Witness supply chain attestation framework. You help users instrument CI/CD pipelines with witness, create policy documents, and write Rego policies to validate attestations. You understand all attestors in go-witness and how to use them effectively."}, {"role": "user", "content": "How do I create a witness policy for a build step that uses these attestors: git, product?"}, {"role": "assistant", "content": "Here's a complete witness policy for your build step with git, product attestors:\n\n**Policy Document:**\n```json\n{\n  \"expires\": \"2026-11-08T10:52:59Z\",\n  \"publickeys\": {\n    \"build-key\": {\n      \"keyid\": \"sha256:42273b119d47502fe47469971b2e6edcd658c7208acde4c6cdaa82d37a0d5920\",\n      \"key\": \"-----BEGIN PUBLIC KEY-----\\n...\\n-----END PUBLIC KEY-----\"\n    }\n  },\n  \"steps\": {\n    \"build\": {\n      \"name\": \"build\",\n      \"attestations\": [\n        {\n          \"type\": \"https://witness.dev/attestations/git/v0.1\"\n        },\n        {\n          \"type\": \"https://witness.dev/attestations/product/v0.1\"\n        }\n      ],\n      \"functionaries\": [\n        {\n          \"type\": \"publickey\",\n          \"publickeyid\": \"build-key\"\n        }\n      ]\n    }\n  }\n}\n```\n\n**Witness Run Command:**\n```bash\nwitness run --step build \\\n  --attestations git,product \\\n  --outfile build-attestation.json \\\n  --key signing-key.pem \\\n  -- <your-build-command>\n```\n\n**Rego Validation Rules:**\n```rego\npackage git\n\nimport rego.v1\n\n# Enforce builds from specific branch\ndeny contains msg if {\n    input.branch != \"bugfix/security\"\n    msg := sprintf(\"Must build from bugfix/security branch, got: %s\", [input.branch])\n}\n\n# Validate commit author\napproved_authors := {\n    \"alice.smith@example.com\",\n    \"bob.jones@company.com\",\n    \"ci-bot@company.com\"\n}\n\ndeny contains msg if {\n    not input.authoremail in approved_authors\n    msg := sprintf(\"Unauthorized commit author: %s\", [input.authoremail])\n}\n```\n\n**Verification:**\n```bash\nwitness verify \\\n  --policy policy-signed.json \\\n  --publickey policy-key.pub \\\n  -a build-attestation.json \\\n  --subject <artifact>\n```\n"}]}
{"messages": [{"role": "system", "content": "You are an expert in the Witness supply chain attestation framework. You help users instrument CI/CD pipelines with witness, create policy documents, and write Rego policies to validate attestations. You understand all attestors in go-witness and how to use them effectively."}, {"role": "user", "content": "How do I create a witness policy for a build step that uses these attestors: github?"}, {"role": "assistant", "content": "Here's a complete witness policy for your build step with github attestors:\n\n**Policy Document:**\n```json\n{\n  \"expires\": \"2026-11-08T10:52:59Z\",\n  \"publickeys\": {\n    \"build-key\": {\n      \"keyid\": \"sha256:97f404cbfacae4bc1466019a5de3045a5ac48c71e5446a6dfdc5e363f79de2cb\",\n      \"key\": \"-----BEGIN PUBLIC KEY-----\\n...\\n-----END PUBLIC KEY-----\"\n    }\n  },\n  \"steps\": {\n    \"build\": {\n      \"name\": \"build\",\n      \"attestations\": [\n        {\n          \"type\": \"https://witness.dev/attestations/github/v0.1\"\n        }\n      ],\n      \"functionaries\": [\n        {\n          \"type\": \"publickey\",\n          \"publickeyid\": \"build-key\"\n        }\n      ]\n    }\n  }\n}\n```\n\n**Witness Run Command:**\n```bash\nwitness run --step build \\\n  --attestations github \\\n  --outfile build-attestation.json \\\n  --key signing-key.pem \\\n  -- <your-build-command>\n```\n\n**Rego Validation Rules:**\n```rego\n\n```\n\n**Verification:**\n```bash\nwitness verify \\\n  --policy policy-signed.json \\\n  --publickey policy-key.pub \\\n  -a build-attestation.json \\\n  --subject <artifact>\n```\n"}]}
{"messages": [{"role": "system", "content": "You are an expert in the Witness supply chain attestation framework. You help users instrument CI/CD pipelines with witness, create policy documents, and write Rego policies to validate attestations. You understand all attestors in go-witness and how to use them effectively."}, {"role": "user", "content": "How do I create a witness policy for a build step that uses these attestors: github, environment, commandrun?"}, {"role": "assistant", "content": "Here's a complete witness policy for your build step with github, environment, commandrun attestors:\n\n**Policy Document:**\n```json\n{\n  \"expires\": \"2026-11-08T10:52:59Z\",\n  \"publickeys\": {\n    \"build-key\": {\n      \"keyid\": \"sha256:f8e48a10d8523cf54ffcf9894dfaf7c2f9657d2d903eb66641819033c2c7efef\",\n      \"key\": \"-----BEGIN PUBLIC KEY-----\\n...\\n-----END PUBLIC KEY-----\"\n    }\n  },\n  \"steps\": {\n    \"build\": {\n      \"name\": \"build\",\n      \"attestations\": [\n        {\n          \"type\": \"https://witness.dev/attestations/github/v0.1\"\n        },\n        {\n          \"type\": \"https://witness.dev/attestations/environment/v0.1\"\n        },\n        {\n          \"type\": \"https://witness.dev/attestations/command-run/v0.1\"\n        }\n      ],\n      \"functionaries\": [\n        {\n          \"type\": \"publickey\",\n          \"publickeyid\": \"build-key\"\n        }\n      ]\n    }\n  }\n}\n```\n\n**Witness Run Command:**\n```bash\nwitness run --step build \\\n  --attestations github,environment,commandrun \\\n  --outfile build-attestation.json \\\n  --key signing-key.pem \\\n  -- <your-build-command>\n```\n\n**Rego Validation Rules:**\n```rego\n\n```\n\n**Verification:**\n```bash\nwitness verify \\\n  --policy policy-signed.json \\\n  --publickey policy-key.pub \\\n  -a build-attestation.json \\\n  --subject <artifact>\n```\n"}]}
{"messages": [{"role": "system", "content": "You are an expert in the Witness supply chain attestation framework. You help users instrument CI/CD pipelines with witness, create policy documents, and write Rego policies to validate attestations. You understand all attestors in go-witness and how to use them effectively."}, {"role": "user", "content": "How do I create a witness policy for a build step that uses these attestors: material, commandrun, product, github, git?"}, {"role": "assistant", "content": "Here's a complete witness policy for your build step with material, commandrun, product, github, git attestors:\n\n**Policy Document:**\n```json\n{\n  \"expires\": \"2026-11-08T10:52:59Z\",\n  \"publickeys\": {\n    \"build-key\": {\n      \"keyid\": \"sha256:37f747b5de167b263de7cae50457f267d72f59eade58fba97f7e0c3d410b8aee\",\n      \"key\": \"-----BEGIN PUBLIC KEY-----\\n...\\n-----END PUBLIC KEY-----\"\n    }\n  },\n  \"steps\": {\n    \"build\": {\n      \"name\": \"build\",\n      \"attestations\": [\n        {\n          \"type\": \"https://witness.dev/attestations/material/v0.1\"\n        },\n        {\n          \"type\": \"https://witness.dev/attestations/command-run/v0.1\"\n        },\n        {\n          \"type\": \"https://witness.dev/attestations/product/v0.1\"\n        },\n        {\n          \"type\": \"https://witness.dev/attestations/github/v0.1\"\n        },\n        {\n          \"type\": \"https://witness.dev/attestations/git/v0.1\"\n        }\n      ],\n      \"functionaries\": [\n        {\n          \"type\": \"publickey\",\n          \"publickeyid\": \"build-key\"\n        }\n      ]\n    }\n  }\n}\n```\n\n**Witness Run Command:**\n```bash\nwitness run --step build \\\n  --attestations material,commandrun,product,github,git \\\n  --outfile build-attestation.json \\\n  --key signing-key.pem \\\n  -- <your-build-command>\n```\n\n**Rego Validation Rules:**\n```rego\n\n```\n\n**Verification:**\n```bash\nwitness verify \\\n  --policy policy-signed.json \\\n  --publickey policy-key.pub \\\n  -a build-attestation.json \\\n  --subject <artifact>\n```\n"}]}
{"messages": [{"role": "system", "content": "You are an expert in the Witness supply chain attestation framework. You help users instrument CI/CD pipelines with witness, create policy documents, and write Rego policies to validate attestations. You understand all attestors in go-witness and how to use them effectively."}, {"role": "user", "content": "How do I create a multi-step witness policy for a build \u2192 test \u2192 package pipeline?"}, {"role": "assistant", "content": "Here's a complete multi-step witness policy for your pipeline:\n\n**Policy Document:**\n```json\n{\n  \"expires\": \"2026-11-08T10:52:59Z\",\n  \"publickeys\": {\n    \"ci-key\": {\n      \"keyid\": \"sha256:c29619f332ac2495c2178b4952886af5f806d6cae8a58208f8165fbaf53e4fe3\",\n      \"key\": \"-----BEGIN PUBLIC KEY-----\\n...\\n-----END PUBLIC KEY-----\"\n    }\n  },\n  \"steps\": {\n    \"build\": {\n      \"name\": \"build\",\n      \"attestations\": [\n        {\n          \"type\": \"https://witness.dev/attestations/git/v0.1\"\n        },\n        {\n          \"type\": \"https://witness.dev/attestations/command-run/v0.1\"\n        },\n        {\n          \"type\": \"https://witness.dev/attestations/product/v0.1\"\n        }\n      ],\n      \"functionaries\": [\n        {\n          \"type\": \"publickey\",\n          \"publickeyid\": \"ci-key\"\n        }\n      ]\n    },\n    \"test\": {\n      \"name\": \"test\",\n      \"attestations\": [\n        {\n          \"type\": \"https://witness.dev/attestations/material/v0.1\"\n        },\n        {\n          \"type\": \"https://witness.dev/attestations/command-run/v0.1\"\n        }\n      ],\n      \"functionaries\": [\n        {\n          \"type\": \"publickey\",\n          \"publickeyid\": \"ci-key\"\n        }\n      ]\n    },\n    \"package\": {\n      \"name\": \"package\",\n      \"attestations\": [\n        {\n          \"type\": \"https://witness.dev/attestations/material/v0.1\"\n        },\n        {\n          \"type\": \"https://witness.dev/attestations/product/v0.1\"\n        }\n      ],\n      \"functionaries\": [\n        {\n          \"type\": \"publickey\",\n          \"publickeyid\": \"ci-key\"\n        }\n      ]\n    }\n  }\n}\n```\n\n**Pipeline Commands:**\n\n```bash\n# Step 1: Build\nwitness run --step build \\\n  --attestations git,commandrun,product \\\n  -o build.json --key ci-key.pem \\\n  -- go build -o myapp\n\n# Step 2: Test\nwitness run --step test \\\n  --attestations material,commandrun \\\n  -o test.json --key ci-key.pem \\\n  -- go test ./...\n\n# Step 3: Package\nwitness run --step package \\\n  --attestations material,product \\\n  -o package.json --key ci-key.pem \\\n  -- tar czf myapp.tar.gz myapp\n\n# Verify entire pipeline\nwitness verify \\\n  --policy policy-signed.json \\\n  --publickey policy-key.pub \\\n  -a build.json -a test.json -a package.json\n```\n"}]}
{"messages": [{"role": "system", "content": "You are an expert in the Witness supply chain attestation framework. You help users instrument CI/CD pipelines with witness, create policy documents, and write Rego policies to validate attestations. You understand all attestors in go-witness and how to use them effectively."}, {"role": "user", "content": "How do I create a witness policy for a build step that uses these attestors: git, commandrun, environment, material?"}, {"role": "assistant", "content": "Here's a complete witness policy for your build step with git, commandrun, environment, material attestors:\n\n**Policy Document:**\n```json\n{\n  \"expires\": \"2026-11-08T10:52:59Z\",\n  \"publickeys\": {\n    \"build-key\": {\n      \"keyid\": \"sha256:b0ff90b43bd1f1e0d375a354ab9d566b6df9d7e705d8380ac562243dc64828d5\",\n      \"key\": \"-----BEGIN PUBLIC KEY-----\\n...\\n-----END PUBLIC KEY-----\"\n    }\n  },\n  \"steps\": {\n    \"build\": {\n      \"name\": \"build\",\n      \"attestations\": [\n        {\n          \"type\": \"https://witness.dev/attestations/git/v0.1\"\n        },\n        {\n          \"type\": \"https://witness.dev/attestations/command-run/v0.1\"\n        },\n        {\n          \"type\": \"https://witness.dev/attestations/environment/v0.1\"\n        },\n        {\n          \"type\": \"https://witness.dev/attestations/material/v0.1\"\n        }\n      ],\n      \"functionaries\": [\n        {\n          \"type\": \"publickey\",\n          \"publickeyid\": \"build-key\"\n        }\n      ]\n    }\n  }\n}\n```\n\n**Witness Run Command:**\n```bash\nwitness run --step build \\\n  --attestations git,commandrun,environment,material \\\n  --outfile build-attestation.json \\\n  --key signing-key.pem \\\n  -- <your-build-command>\n```\n\n**Rego Validation Rules:**\n```rego\npackage git\n\nimport rego.v1\n\n# Enforce builds from specific branch\ndeny contains msg if {\n    input.branch != \"staging\"\n    msg := sprintf(\"Must build from staging branch, got: %s\", [input.branch])\n}\n\n# Require clean working directory\ndeny contains msg if {\n    count(input.status) > 0\n    msg := \"Working directory must be clean (no uncommitted changes)\"\n}\n\n# Validate commit author\napproved_authors := {\n    \"alice.smith@example.com\",\n    \"bob.jones@company.com\",\n    \"ci-bot@company.com\"\n}\n\ndeny contains msg if {\n    not input.authoremail in approved_authors\n    msg := sprintf(\"Unauthorized commit author: %s\", [input.authoremail])\n}\n```\n\n**Verification:**\n```bash\nwitness verify \\\n  --policy policy-signed.json \\\n  --publickey policy-key.pub \\\n  -a build-attestation.json \\\n  --subject <artifact>\n```\n"}]}
{"messages": [{"role": "system", "content": "You are an expert in the Witness supply chain attestation framework. You help users instrument CI/CD pipelines with witness, create policy documents, and write Rego policies to validate attestations. You understand all attestors in go-witness and how to use them effectively."}, {"role": "user", "content": "How do I create a witness policy for a build step that uses these attestors: git, github, product?"}, {"role": "assistant", "content": "Here's a complete witness policy for your build step with git, github, product attestors:\n\n**Policy Document:**\n```json\n{\n  \"expires\": \"2026-11-08T10:52:59Z\",\n  \"publickeys\": {\n    \"build-key\": {\n      \"keyid\": \"sha256:93b7899e6dc723b0063eddc382e6ac883b330fedbf089f4d5938a13f6883c3b8\",\n      \"key\": \"-----BEGIN PUBLIC KEY-----\\n...\\n-----END PUBLIC KEY-----\"\n    }\n  },\n  \"steps\": {\n    \"build\": {\n      \"name\": \"build\",\n      \"attestations\": [\n        {\n          \"type\": \"https://witness.dev/attestations/git/v0.1\"\n        },\n        {\n          \"type\": \"https://witness.dev/attestations/github/v0.1\"\n        },\n        {\n          \"type\": \"https://witness.dev/attestations/product/v0.1\"\n        }\n      ],\n      \"functionaries\": [\n        {\n          \"type\": \"publickey\",\n          \"publickeyid\": \"build-key\"\n        }\n      ]\n    }\n  }\n}\n```\n\n**Witness Run Command:**\n```bash\nwitness run --step build \\\n  --attestations git,github,product \\\n  --outfile build-attestation.json \\\n  --key signing-key.pem \\\n  -- <your-build-command>\n```\n\n**Rego Validation Rules:**\n```rego\npackage git\n\nimport rego.v1\n\n# Enforce builds from specific branch\ndeny contains msg if {\n    input.branch != \"main\"\n    msg := sprintf(\"Must build from main branch, got: %s\", [input.branch])\n}\n\n# Require clean working directory\ndeny contains msg if {\n    count(input.status) > 0\n    msg := \"Working directory must be clean (no uncommitted changes)\"\n}\n\n# Validate commit author\napproved_authors := {\n    \"alice.smith@example.com\",\n    \"bob.jones@company.com\",\n    \"ci-bot@company.com\"\n}\n\ndeny contains msg if {\n    not input.authoremail in approved_authors\n    msg := sprintf(\"Unauthorized commit author: %s\", [input.authoremail])\n}\n```\n\n**Verification:**\n```bash\nwitness verify \\\n  --policy policy-signed.json \\\n  --publickey policy-key.pub \\\n  -a build-attestation.json \\\n  --subject <artifact>\n```\n"}]}
{"messages": [{"role": "system", "content": "You are an expert in the Witness supply chain attestation framework. You help users instrument CI/CD pipelines with witness, create policy documents, and write Rego policies to validate attestations. You understand all attestors in go-witness and how to use them effectively."}, {"role": "user", "content": "How do I create a multi-step witness policy for a build \u2192 test \u2192 package pipeline?"}, {"role": "assistant", "content": "Here's a complete multi-step witness policy for your pipeline:\n\n**Policy Document:**\n```json\n{\n  \"expires\": \"2026-11-08T10:52:59Z\",\n  \"publickeys\": {\n    \"ci-key\": {\n      \"keyid\": \"sha256:77cfea08423e502045e4b93f5432d334342ede82e90c7dce39c587556e6fb9ed\",\n      \"key\": \"-----BEGIN PUBLIC KEY-----\\n...\\n-----END PUBLIC KEY-----\"\n    }\n  },\n  \"steps\": {\n    \"build\": {\n      \"name\": \"build\",\n      \"attestations\": [\n        {\n          \"type\": \"https://witness.dev/attestations/git/v0.1\"\n        },\n        {\n          \"type\": \"https://witness.dev/attestations/command-run/v0.1\"\n        },\n        {\n          \"type\": \"https://witness.dev/attestations/product/v0.1\"\n        }\n      ],\n      \"functionaries\": [\n        {\n          \"type\": \"publickey\",\n          \"publickeyid\": \"ci-key\"\n        }\n      ]\n    },\n    \"test\": {\n      \"name\": \"test\",\n      \"attestations\": [\n        {\n          \"type\": \"https://witness.dev/attestations/material/v0.1\"\n        },\n        {\n          \"type\": \"https://witness.dev/attestations/command-run/v0.1\"\n        }\n      ],\n      \"functionaries\": [\n        {\n          \"type\": \"publickey\",\n          \"publickeyid\": \"ci-key\"\n        }\n      ]\n    },\n    \"package\": {\n      \"name\": \"package\",\n      \"attestations\": [\n        {\n          \"type\": \"https://witness.dev/attestations/material/v0.1\"\n        },\n        {\n          \"type\": \"https://witness.dev/attestations/product/v0.1\"\n        }\n      ],\n      \"functionaries\": [\n        {\n          \"type\": \"publickey\",\n          \"publickeyid\": \"ci-key\"\n        }\n      ]\n    }\n  }\n}\n```\n\n**Pipeline Commands:**\n\n```bash\n# Step 1: Build\nwitness run --step build \\\n  --attestations git,commandrun,product \\\n  -o build.json --key ci-key.pem \\\n  -- go build -o myapp\n\n# Step 2: Test\nwitness run --step test \\\n  --attestations material,commandrun \\\n  -o test.json --key ci-key.pem \\\n  -- go test ./...\n\n# Step 3: Package\nwitness run --step package \\\n  --attestations material,product \\\n  -o package.json --key ci-key.pem \\\n  -- tar czf myapp.tar.gz myapp\n\n# Verify entire pipeline\nwitness verify \\\n  --policy policy-signed.json \\\n  --publickey policy-key.pub \\\n  -a build.json -a test.json -a package.json\n```\n"}]}
{"messages": [{"role": "system", "content": "You are an expert in the Witness supply chain attestation framework. You help users instrument CI/CD pipelines with witness, create policy documents, and write Rego policies to validate attestations. You understand all attestors in go-witness and how to use them effectively."}, {"role": "user", "content": "How do I create a witness policy for a build step that uses these attestors: commandrun, git, github, environment?"}, {"role": "assistant", "content": "Here's a complete witness policy for your build step with commandrun, git, github, environment attestors:\n\n**Policy Document:**\n```json\n{\n  \"expires\": \"2026-11-08T10:52:59Z\",\n  \"publickeys\": {\n    \"build-key\": {\n      \"keyid\": \"sha256:16de456fe27e2b20370c1f098b49f57db80c486275ac7cf2aa377412068f549a\",\n      \"key\": \"-----BEGIN PUBLIC KEY-----\\n...\\n-----END PUBLIC KEY-----\"\n    }\n  },\n  \"steps\": {\n    \"build\": {\n      \"name\": \"build\",\n      \"attestations\": [\n        {\n          \"type\": \"https://witness.dev/attestations/command-run/v0.1\"\n        },\n        {\n          \"type\": \"https://witness.dev/attestations/git/v0.1\"\n        },\n        {\n          \"type\": \"https://witness.dev/attestations/github/v0.1\"\n        },\n        {\n          \"type\": \"https://witness.dev/attestations/environment/v0.1\"\n        }\n      ],\n      \"functionaries\": [\n        {\n          \"type\": \"publickey\",\n          \"publickeyid\": \"build-key\"\n        }\n      ]\n    }\n  }\n}\n```\n\n**Witness Run Command:**\n```bash\nwitness run --step build \\\n  --attestations commandrun,git,github,environment \\\n  --outfile build-attestation.json \\\n  --key signing-key.pem \\\n  -- <your-build-command>\n```\n\n**Rego Validation Rules:**\n```rego\n\n```\n\n**Verification:**\n```bash\nwitness verify \\\n  --policy policy-signed.json \\\n  --publickey policy-key.pub \\\n  -a build-attestation.json \\\n  --subject <artifact>\n```\n"}]}
{"messages": [{"role": "system", "content": "You are an expert in the Witness supply chain attestation framework. You help users instrument CI/CD pipelines with witness, create policy documents, and write Rego policies to validate attestations. You understand all attestors in go-witness and how to use them effectively."}, {"role": "user", "content": "How do I create a witness policy for a build step that uses these attestors: commandrun, git, product, github?"}, {"role": "assistant", "content": "Here's a complete witness policy for your build step with commandrun, git, product, github attestors:\n\n**Policy Document:**\n```json\n{\n  \"expires\": \"2026-11-08T10:52:59Z\",\n  \"publickeys\": {\n    \"build-key\": {\n      \"keyid\": \"sha256:912d41c8677dad23c8d770bf1a4d45ec977c79dc43bf3839ffd4d98012ebe4b4\",\n      \"key\": \"-----BEGIN PUBLIC KEY-----\\n...\\n-----END PUBLIC KEY-----\"\n    }\n  },\n  \"steps\": {\n    \"build\": {\n      \"name\": \"build\",\n      \"attestations\": [\n        {\n          \"type\": \"https://witness.dev/attestations/command-run/v0.1\"\n        },\n        {\n          \"type\": \"https://witness.dev/attestations/git/v0.1\"\n        },\n        {\n          \"type\": \"https://witness.dev/attestations/product/v0.1\"\n        },\n        {\n          \"type\": \"https://witness.dev/attestations/github/v0.1\"\n        }\n      ],\n      \"functionaries\": [\n        {\n          \"type\": \"publickey\",\n          \"publickeyid\": \"build-key\"\n        }\n      ]\n    }\n  }\n}\n```\n\n**Witness Run Command:**\n```bash\nwitness run --step build \\\n  --attestations commandrun,git,product,github \\\n  --outfile build-attestation.json \\\n  --key signing-key.pem \\\n  -- <your-build-command>\n```\n\n**Rego Validation Rules:**\n```rego\n\n```\n\n**Verification:**\n```bash\nwitness verify \\\n  --policy policy-signed.json \\\n  --publickey policy-key.pub \\\n  -a build-attestation.json \\\n  --subject <artifact>\n```\n"}]}
{"messages": [{"role": "system", "content": "You are an expert in the Witness supply chain attestation framework. You help users instrument CI/CD pipelines with witness, create policy documents, and write Rego policies to validate attestations. You understand all attestors in go-witness and how to use them effectively."}, {"role": "user", "content": "How do I create a multi-step witness policy for a build \u2192 test \u2192 package pipeline?"}, {"role": "assistant", "content": "Here's a complete multi-step witness policy for your pipeline:\n\n**Policy Document:**\n```json\n{\n  \"expires\": \"2026-11-08T10:52:59Z\",\n  \"publickeys\": {\n    \"ci-key\": {\n      \"keyid\": \"sha256:51981c5f742bdb81857d4b56cb4f6f5b70dabcef78cf2c08da3cd8e6e186a372\",\n      \"key\": \"-----BEGIN PUBLIC KEY-----\\n...\\n-----END PUBLIC KEY-----\"\n    }\n  },\n  \"steps\": {\n    \"build\": {\n      \"name\": \"build\",\n      \"attestations\": [\n        {\n          \"type\": \"https://witness.dev/attestations/git/v0.1\"\n        },\n        {\n          \"type\": \"https://witness.dev/attestations/command-run/v0.1\"\n        },\n        {\n          \"type\": \"https://witness.dev/attestations/product/v0.1\"\n        }\n      ],\n      \"functionaries\": [\n        {\n          \"type\": \"publickey\",\n          \"publickeyid\": \"ci-key\"\n        }\n      ]\n    },\n    \"test\": {\n      \"name\": \"test\",\n      \"attestations\": [\n        {\n          \"type\": \"https://witness.dev/attestations/material/v0.1\"\n        },\n        {\n          \"type\": \"https://witness.dev/attestations/command-run/v0.1\"\n        }\n      ],\n      \"functionaries\": [\n        {\n          \"type\": \"publickey\",\n          \"publickeyid\": \"ci-key\"\n        }\n      ]\n    },\n    \"package\": {\n      \"name\": \"package\",\n      \"attestations\": [\n        {\n          \"type\": \"https://witness.dev/attestations/material/v0.1\"\n        },\n        {\n          \"type\": \"https://witness.dev/attestations/product/v0.1\"\n        }\n      ],\n      \"functionaries\": [\n        {\n          \"type\": \"publickey\",\n          \"publickeyid\": \"ci-key\"\n        }\n      ]\n    }\n  }\n}\n```\n\n**Pipeline Commands:**\n\n```bash\n# Step 1: Build\nwitness run --step build \\\n  --attestations git,commandrun,product \\\n  -o build.json --key ci-key.pem \\\n  -- go build -o myapp\n\n# Step 2: Test\nwitness run --step test \\\n  --attestations material,commandrun \\\n  -o test.json --key ci-key.pem \\\n  -- go test ./...\n\n# Step 3: Package\nwitness run --step package \\\n  --attestations material,product \\\n  -o package.json --key ci-key.pem \\\n  -- tar czf myapp.tar.gz myapp\n\n# Verify entire pipeline\nwitness verify \\\n  --policy policy-signed.json \\\n  --publickey policy-key.pub \\\n  -a build.json -a test.json -a package.json\n```\n"}]}
{"messages": [{"role": "system", "content": "You are an expert in the Witness supply chain attestation framework. You help users instrument CI/CD pipelines with witness, create policy documents, and write Rego policies to validate attestations. You understand all attestors in go-witness and how to use them effectively."}, {"role": "user", "content": "How do I create a witness policy for a build step that uses these attestors: github, environment, commandrun, product?"}, {"role": "assistant", "content": "Here's a complete witness policy for your build step with github, environment, commandrun, product attestors:\n\n**Policy Document:**\n```json\n{\n  \"expires\": \"2026-11-08T10:52:59Z\",\n  \"publickeys\": {\n    \"build-key\": {\n      \"keyid\": \"sha256:c07bc546d12c8f937689b7cae4cb93e129e1f9388fb6f7d03e970ba61cf6fbaf\",\n      \"key\": \"-----BEGIN PUBLIC KEY-----\\n...\\n-----END PUBLIC KEY-----\"\n    }\n  },\n  \"steps\": {\n    \"build\": {\n      \"name\": \"build\",\n      \"attestations\": [\n        {\n          \"type\": \"https://witness.dev/attestations/github/v0.1\"\n        },\n        {\n          \"type\": \"https://witness.dev/attestations/environment/v0.1\"\n        },\n        {\n          \"type\": \"https://witness.dev/attestations/command-run/v0.1\"\n        },\n        {\n          \"type\": \"https://witness.dev/attestations/product/v0.1\"\n        }\n      ],\n      \"functionaries\": [\n        {\n          \"type\": \"publickey\",\n          \"publickeyid\": \"build-key\"\n        }\n      ]\n    }\n  }\n}\n```\n\n**Witness Run Command:**\n```bash\nwitness run --step build \\\n  --attestations github,environment,commandrun,product \\\n  --outfile build-attestation.json \\\n  --key signing-key.pem \\\n  -- <your-build-command>\n```\n\n**Rego Validation Rules:**\n```rego\n\n```\n\n**Verification:**\n```bash\nwitness verify \\\n  --policy policy-signed.json \\\n  --publickey policy-key.pub \\\n  -a build-attestation.json \\\n  --subject <artifact>\n```\n"}]}
{"messages": [{"role": "system", "content": "You are an expert in the Witness supply chain attestation framework. You help users instrument CI/CD pipelines with witness, create policy documents, and write Rego policies to validate attestations. You understand all attestors in go-witness and how to use them effectively."}, {"role": "user", "content": "How do I create a multi-step witness policy for a build \u2192 test \u2192 package pipeline?"}, {"role": "assistant", "content": "Here's a complete multi-step witness policy for your pipeline:\n\n**Policy Document:**\n```json\n{\n  \"expires\": \"2026-11-08T10:52:59Z\",\n  \"publickeys\": {\n    \"ci-key\": {\n      \"keyid\": \"sha256:71472f8c9a07d26b6b1663e4466aff9be88eb76b559265ded02ac7d79e49670c\",\n      \"key\": \"-----BEGIN PUBLIC KEY-----\\n...\\n-----END PUBLIC KEY-----\"\n    }\n  },\n  \"steps\": {\n    \"build\": {\n      \"name\": \"build\",\n      \"attestations\": [\n        {\n          \"type\": \"https://witness.dev/attestations/git/v0.1\"\n        },\n        {\n          \"type\": \"https://witness.dev/attestations/command-run/v0.1\"\n        },\n        {\n          \"type\": \"https://witness.dev/attestations/product/v0.1\"\n        }\n      ],\n      \"functionaries\": [\n        {\n          \"type\": \"publickey\",\n          \"publickeyid\": \"ci-key\"\n        }\n      ]\n    },\n    \"test\": {\n      \"name\": \"test\",\n      \"attestations\": [\n        {\n          \"type\": \"https://witness.dev/attestations/material/v0.1\"\n        },\n        {\n          \"type\": \"https://witness.dev/attestations/command-run/v0.1\"\n        }\n      ],\n      \"functionaries\": [\n        {\n          \"type\": \"publickey\",\n          \"publickeyid\": \"ci-key\"\n        }\n      ]\n    },\n    \"package\": {\n      \"name\": \"package\",\n      \"attestations\": [\n        {\n          \"type\": \"https://witness.dev/attestations/material/v0.1\"\n        },\n        {\n          \"type\": \"https://witness.dev/attestations/product/v0.1\"\n        }\n      ],\n      \"functionaries\": [\n        {\n          \"type\": \"publickey\",\n          \"publickeyid\": \"ci-key\"\n        }\n      ]\n    }\n  }\n}\n```\n\n**Pipeline Commands:**\n\n```bash\n# Step 1: Build\nwitness run --step build \\\n  --attestations git,commandrun,product \\\n  -o build.json --key ci-key.pem \\\n  -- go build -o myapp\n\n# Step 2: Test\nwitness run --step test \\\n  --attestations material,commandrun \\\n  -o test.json --key ci-key.pem \\\n  -- go test ./...\n\n# Step 3: Package\nwitness run --step package \\\n  --attestations material,product \\\n  -o package.json --key ci-key.pem \\\n  -- tar czf myapp.tar.gz myapp\n\n# Verify entire pipeline\nwitness verify \\\n  --policy policy-signed.json \\\n  --publickey policy-key.pub \\\n  -a build.json -a test.json -a package.json\n```\n"}]}
{"messages": [{"role": "system", "content": "You are an expert in the Witness supply chain attestation framework. You help users instrument CI/CD pipelines with witness, create policy documents, and write Rego policies to validate attestations. You understand all attestors in go-witness and how to use them effectively."}, {"role": "user", "content": "How do I create a witness policy for a build step that uses these attestors: material, github, environment, commandrun, git?"}, {"role": "assistant", "content": "Here's a complete witness policy for your build step with material, github, environment, commandrun, git attestors:\n\n**Policy Document:**\n```json\n{\n  \"expires\": \"2026-11-08T10:52:59Z\",\n  \"publickeys\": {\n    \"build-key\": {\n      \"keyid\": \"sha256:e61c636957d806e4978c4ff4c5c6ce7fcaf2c17fc027ddfc5c8786777c027709\",\n      \"key\": \"-----BEGIN PUBLIC KEY-----\\n...\\n-----END PUBLIC KEY-----\"\n    }\n  },\n  \"steps\": {\n    \"build\": {\n      \"name\": \"build\",\n      \"attestations\": [\n        {\n          \"type\": \"https://witness.dev/attestations/material/v0.1\"\n        },\n        {\n          \"type\": \"https://witness.dev/attestations/github/v0.1\"\n        },\n        {\n          \"type\": \"https://witness.dev/attestations/environment/v0.1\"\n        },\n        {\n          \"type\": \"https://witness.dev/attestations/command-run/v0.1\"\n        },\n        {\n          \"type\": \"https://witness.dev/attestations/git/v0.1\"\n        }\n      ],\n      \"functionaries\": [\n        {\n          \"type\": \"publickey\",\n          \"publickeyid\": \"build-key\"\n        }\n      ]\n    }\n  }\n}\n```\n\n**Witness Run Command:**\n```bash\nwitness run --step build \\\n  --attestations material,github,environment,commandrun,git \\\n  --outfile build-attestation.json \\\n  --key signing-key.pem \\\n  -- <your-build-command>\n```\n\n**Rego Validation Rules:**\n```rego\n\n```\n\n**Verification:**\n```bash\nwitness verify \\\n  --policy policy-signed.json \\\n  --publickey policy-key.pub \\\n  -a build-attestation.json \\\n  --subject <artifact>\n```\n"}]}
{"messages": [{"role": "system", "content": "You are an expert in the Witness supply chain attestation framework. You help users instrument CI/CD pipelines with witness, create policy documents, and write Rego policies to validate attestations. You understand all attestors in go-witness and how to use them effectively."}, {"role": "user", "content": "How do I create a witness policy for a build step that uses these attestors: github, product, material, commandrun, git?"}, {"role": "assistant", "content": "Here's a complete witness policy for your build step with github, product, material, commandrun, git attestors:\n\n**Policy Document:**\n```json\n{\n  \"expires\": \"2026-11-08T10:52:59Z\",\n  \"publickeys\": {\n    \"build-key\": {\n      \"keyid\": \"sha256:0f2bcfde0b760d7a92482c3b720ef576f2131775f24b242031bb0f7e6a51581d\",\n      \"key\": \"-----BEGIN PUBLIC KEY-----\\n...\\n-----END PUBLIC KEY-----\"\n    }\n  },\n  \"steps\": {\n    \"build\": {\n      \"name\": \"build\",\n      \"attestations\": [\n        {\n          \"type\": \"https://witness.dev/attestations/github/v0.1\"\n        },\n        {\n          \"type\": \"https://witness.dev/attestations/product/v0.1\"\n        },\n        {\n          \"type\": \"https://witness.dev/attestations/material/v0.1\"\n        },\n        {\n          \"type\": \"https://witness.dev/attestations/command-run/v0.1\"\n        },\n        {\n          \"type\": \"https://witness.dev/attestations/git/v0.1\"\n        }\n      ],\n      \"functionaries\": [\n        {\n          \"type\": \"publickey\",\n          \"publickeyid\": \"build-key\"\n        }\n      ]\n    }\n  }\n}\n```\n\n**Witness Run Command:**\n```bash\nwitness run --step build \\\n  --attestations github,product,material,commandrun,git \\\n  --outfile build-attestation.json \\\n  --key signing-key.pem \\\n  -- <your-build-command>\n```\n\n**Rego Validation Rules:**\n```rego\n\n```\n\n**Verification:**\n```bash\nwitness verify \\\n  --policy policy-signed.json \\\n  --publickey policy-key.pub \\\n  -a build-attestation.json \\\n  --subject <artifact>\n```\n"}]}
{"messages": [{"role": "system", "content": "You are an expert in the Witness supply chain attestation framework. You help users instrument CI/CD pipelines with witness, create policy documents, and write Rego policies to validate attestations. You understand all attestors in go-witness and how to use them effectively."}, {"role": "user", "content": "How do I create a witness policy for a build step that uses these attestors: github, environment, git, commandrun, material?"}, {"role": "assistant", "content": "Here's a complete witness policy for your build step with github, environment, git, commandrun, material attestors:\n\n**Policy Document:**\n```json\n{\n  \"expires\": \"2026-11-08T10:52:59Z\",\n  \"publickeys\": {\n    \"build-key\": {\n      \"keyid\": \"sha256:70a87de2a050d28222fe027e303db4a038b3d40ecd6ff6241f5d888f4408dfa3\",\n      \"key\": \"-----BEGIN PUBLIC KEY-----\\n...\\n-----END PUBLIC KEY-----\"\n    }\n  },\n  \"steps\": {\n    \"build\": {\n      \"name\": \"build\",\n      \"attestations\": [\n        {\n          \"type\": \"https://witness.dev/attestations/github/v0.1\"\n        },\n        {\n          \"type\": \"https://witness.dev/attestations/environment/v0.1\"\n        },\n        {\n          \"type\": \"https://witness.dev/attestations/git/v0.1\"\n        },\n        {\n          \"type\": \"https://witness.dev/attestations/command-run/v0.1\"\n        },\n        {\n          \"type\": \"https://witness.dev/attestations/material/v0.1\"\n        }\n      ],\n      \"functionaries\": [\n        {\n          \"type\": \"publickey\",\n          \"publickeyid\": \"build-key\"\n        }\n      ]\n    }\n  }\n}\n```\n\n**Witness Run Command:**\n```bash\nwitness run --step build \\\n  --attestations github,environment,git,commandrun,material \\\n  --outfile build-attestation.json \\\n  --key signing-key.pem \\\n  -- <your-build-command>\n```\n\n**Rego Validation Rules:**\n```rego\n\n```\n\n**Verification:**\n```bash\nwitness verify \\\n  --policy policy-signed.json \\\n  --publickey policy-key.pub \\\n  -a build-attestation.json \\\n  --subject <artifact>\n```\n"}]}
{"messages": [{"role": "system", "content": "You are an expert in the Witness supply chain attestation framework. You help users instrument CI/CD pipelines with witness, create policy documents, and write Rego policies to validate attestations. You understand all attestors in go-witness and how to use them effectively."}, {"role": "user", "content": "How do I create a multi-step witness policy for a build \u2192 test \u2192 package pipeline?"}, {"role": "assistant", "content": "Here's a complete multi-step witness policy for your pipeline:\n\n**Policy Document:**\n```json\n{\n  \"expires\": \"2026-11-08T10:52:59Z\",\n  \"publickeys\": {\n    \"ci-key\": {\n      \"keyid\": \"sha256:b69881b335c1c39079d6539949c047abeab95b49e9fe858682d87444622b2899\",\n      \"key\": \"-----BEGIN PUBLIC KEY-----\\n...\\n-----END PUBLIC KEY-----\"\n    }\n  },\n  \"steps\": {\n    \"build\": {\n      \"name\": \"build\",\n      \"attestations\": [\n        {\n          \"type\": \"https://witness.dev/attestations/git/v0.1\"\n        },\n        {\n          \"type\": \"https://witness.dev/attestations/command-run/v0.1\"\n        },\n        {\n          \"type\": \"https://witness.dev/attestations/product/v0.1\"\n        }\n      ],\n      \"functionaries\": [\n        {\n          \"type\": \"publickey\",\n          \"publickeyid\": \"ci-key\"\n        }\n      ]\n    },\n    \"test\": {\n      \"name\": \"test\",\n      \"attestations\": [\n        {\n          \"type\": \"https://witness.dev/attestations/material/v0.1\"\n        },\n        {\n          \"type\": \"https://witness.dev/attestations/command-run/v0.1\"\n        }\n      ],\n      \"functionaries\": [\n        {\n          \"type\": \"publickey\",\n          \"publickeyid\": \"ci-key\"\n        }\n      ]\n    },\n    \"package\": {\n      \"name\": \"package\",\n      \"attestations\": [\n        {\n          \"type\": \"https://witness.dev/attestations/material/v0.1\"\n        },\n        {\n          \"type\": \"https://witness.dev/attestations/product/v0.1\"\n        }\n      ],\n      \"functionaries\": [\n        {\n          \"type\": \"publickey\",\n          \"publickeyid\": \"ci-key\"\n        }\n      ]\n    }\n  }\n}\n```\n\n**Pipeline Commands:**\n\n```bash\n# Step 1: Build\nwitness run --step build \\\n  --attestations git,commandrun,product \\\n  -o build.json --key ci-key.pem \\\n  -- go build -o myapp\n\n# Step 2: Test\nwitness run --step test \\\n  --attestations material,commandrun \\\n  -o test.json --key ci-key.pem \\\n  -- go test ./...\n\n# Step 3: Package\nwitness run --step package \\\n  --attestations material,product \\\n  -o package.json --key ci-key.pem \\\n  -- tar czf myapp.tar.gz myapp\n\n# Verify entire pipeline\nwitness verify \\\n  --policy policy-signed.json \\\n  --publickey policy-key.pub \\\n  -a build.json -a test.json -a package.json\n```\n"}]}
{"messages": [{"role": "system", "content": "You are an expert in the Witness supply chain attestation framework. You help users instrument CI/CD pipelines with witness, create policy documents, and write Rego policies to validate attestations. You understand all attestors in go-witness and how to use them effectively."}, {"role": "user", "content": "How do I create a witness policy for a build step that uses these attestors: git, commandrun, github, environment?"}, {"role": "assistant", "content": "Here's a complete witness policy for your build step with git, commandrun, github, environment attestors:\n\n**Policy Document:**\n```json\n{\n  \"expires\": \"2026-11-08T10:52:59Z\",\n  \"publickeys\": {\n    \"build-key\": {\n      \"keyid\": \"sha256:f900f19266ec51f04af2689128de627665cc43b30fac06f0012b5415cabc52dd\",\n      \"key\": \"-----BEGIN PUBLIC KEY-----\\n...\\n-----END PUBLIC KEY-----\"\n    }\n  },\n  \"steps\": {\n    \"build\": {\n      \"name\": \"build\",\n      \"attestations\": [\n        {\n          \"type\": \"https://witness.dev/attestations/git/v0.1\"\n        },\n        {\n          \"type\": \"https://witness.dev/attestations/command-run/v0.1\"\n        },\n        {\n          \"type\": \"https://witness.dev/attestations/github/v0.1\"\n        },\n        {\n          \"type\": \"https://witness.dev/attestations/environment/v0.1\"\n        }\n      ],\n      \"functionaries\": [\n        {\n          \"type\": \"publickey\",\n          \"publickeyid\": \"build-key\"\n        }\n      ]\n    }\n  }\n}\n```\n\n**Witness Run Command:**\n```bash\nwitness run --step build \\\n  --attestations git,commandrun,github,environment \\\n  --outfile build-attestation.json \\\n  --key signing-key.pem \\\n  -- <your-build-command>\n```\n\n**Rego Validation Rules:**\n```rego\npackage git\n\nimport rego.v1\n\n# Enforce builds from specific branch\ndeny contains msg if {\n    input.branch != \"bugfix/security\"\n    msg := sprintf(\"Must build from bugfix/security branch, got: %s\", [input.branch])\n}\n\n# Validate commit author\napproved_authors := {\n    \"alice.smith@example.com\",\n    \"bob.jones@company.com\",\n    \"ci-bot@company.com\"\n}\n\ndeny contains msg if {\n    not input.authoremail in approved_authors\n    msg := sprintf(\"Unauthorized commit author: %s\", [input.authoremail])\n}\n```\n\n**Verification:**\n```bash\nwitness verify \\\n  --policy policy-signed.json \\\n  --publickey policy-key.pub \\\n  -a build-attestation.json \\\n  --subject <artifact>\n```\n"}]}
{"messages": [{"role": "system", "content": "You are an expert in the Witness supply chain attestation framework. You help users instrument CI/CD pipelines with witness, create policy documents, and write Rego policies to validate attestations. You understand all attestors in go-witness and how to use them effectively."}, {"role": "user", "content": "How do I create a multi-step witness policy for a build \u2192 test \u2192 package pipeline?"}, {"role": "assistant", "content": "Here's a complete multi-step witness policy for your pipeline:\n\n**Policy Document:**\n```json\n{\n  \"expires\": \"2026-11-08T10:52:59Z\",\n  \"publickeys\": {\n    \"ci-key\": {\n      \"keyid\": \"sha256:60ac13f67fc1de561573ad07f431ac77c677191e270b899e9950c927ab9f96d9\",\n      \"key\": \"-----BEGIN PUBLIC KEY-----\\n...\\n-----END PUBLIC KEY-----\"\n    }\n  },\n  \"steps\": {\n    \"build\": {\n      \"name\": \"build\",\n      \"attestations\": [\n        {\n          \"type\": \"https://witness.dev/attestations/git/v0.1\"\n        },\n        {\n          \"type\": \"https://witness.dev/attestations/command-run/v0.1\"\n        },\n        {\n          \"type\": \"https://witness.dev/attestations/product/v0.1\"\n        }\n      ],\n      \"functionaries\": [\n        {\n          \"type\": \"publickey\",\n          \"publickeyid\": \"ci-key\"\n        }\n      ]\n    },\n    \"test\": {\n      \"name\": \"test\",\n      \"attestations\": [\n        {\n          \"type\": \"https://witness.dev/attestations/material/v0.1\"\n        },\n        {\n          \"type\": \"https://witness.dev/attestations/command-run/v0.1\"\n        }\n      ],\n      \"functionaries\": [\n        {\n          \"type\": \"publickey\",\n          \"publickeyid\": \"ci-key\"\n        }\n      ]\n    },\n    \"package\": {\n      \"name\": \"package\",\n      \"attestations\": [\n        {\n          \"type\": \"https://witness.dev/attestations/material/v0.1\"\n        },\n        {\n          \"type\": \"https://witness.dev/attestations/product/v0.1\"\n        }\n      ],\n      \"functionaries\": [\n        {\n          \"type\": \"publickey\",\n          \"publickeyid\": \"ci-key\"\n        }\n      ]\n    }\n  }\n}\n```\n\n**Pipeline Commands:**\n\n```bash\n# Step 1: Build\nwitness run --step build \\\n  --attestations git,commandrun,product \\\n  -o build.json --key ci-key.pem \\\n  -- go build -o myapp\n\n# Step 2: Test\nwitness run --step test \\\n  --attestations material,commandrun \\\n  -o test.json --key ci-key.pem \\\n  -- go test ./...\n\n# Step 3: Package\nwitness run --step package \\\n  --attestations material,product \\\n  -o package.json --key ci-key.pem \\\n  -- tar czf myapp.tar.gz myapp\n\n# Verify entire pipeline\nwitness verify \\\n  --policy policy-signed.json \\\n  --publickey policy-key.pub \\\n  -a build.json -a test.json -a package.json\n```\n"}]}
{"messages": [{"role": "system", "content": "You are an expert in the Witness supply chain attestation framework. You help users instrument CI/CD pipelines with witness, create policy documents, and write Rego policies to validate attestations. You understand all attestors in go-witness and how to use them effectively."}, {"role": "user", "content": "How do I create a multi-step witness policy for a build \u2192 test \u2192 package pipeline?"}, {"role": "assistant", "content": "Here's a complete multi-step witness policy for your pipeline:\n\n**Policy Document:**\n```json\n{\n  \"expires\": \"2026-11-08T10:52:59Z\",\n  \"publickeys\": {\n    \"ci-key\": {\n      \"keyid\": \"sha256:2212708611112537f5356aac4c6f9207ddd3da428f8c6c3c8c5140117beaca17\",\n      \"key\": \"-----BEGIN PUBLIC KEY-----\\n...\\n-----END PUBLIC KEY-----\"\n    }\n  },\n  \"steps\": {\n    \"build\": {\n      \"name\": \"build\",\n      \"attestations\": [\n        {\n          \"type\": \"https://witness.dev/attestations/git/v0.1\"\n        },\n        {\n          \"type\": \"https://witness.dev/attestations/command-run/v0.1\"\n        },\n        {\n          \"type\": \"https://witness.dev/attestations/product/v0.1\"\n        }\n      ],\n      \"functionaries\": [\n        {\n          \"type\": \"publickey\",\n          \"publickeyid\": \"ci-key\"\n        }\n      ]\n    },\n    \"test\": {\n      \"name\": \"test\",\n      \"attestations\": [\n        {\n          \"type\": \"https://witness.dev/attestations/material/v0.1\"\n        },\n        {\n          \"type\": \"https://witness.dev/attestations/command-run/v0.1\"\n        }\n      ],\n      \"functionaries\": [\n        {\n          \"type\": \"publickey\",\n          \"publickeyid\": \"ci-key\"\n        }\n      ]\n    },\n    \"package\": {\n      \"name\": \"package\",\n      \"attestations\": [\n        {\n          \"type\": \"https://witness.dev/attestations/material/v0.1\"\n        },\n        {\n          \"type\": \"https://witness.dev/attestations/product/v0.1\"\n        }\n      ],\n      \"functionaries\": [\n        {\n          \"type\": \"publickey\",\n          \"publickeyid\": \"ci-key\"\n        }\n      ]\n    }\n  }\n}\n```\n\n**Pipeline Commands:**\n\n```bash\n# Step 1: Build\nwitness run --step build \\\n  --attestations git,commandrun,product \\\n  -o build.json --key ci-key.pem \\\n  -- go build -o myapp\n\n# Step 2: Test\nwitness run --step test \\\n  --attestations material,commandrun \\\n  -o test.json --key ci-key.pem \\\n  -- go test ./...\n\n# Step 3: Package\nwitness run --step package \\\n  --attestations material,product \\\n  -o package.json --key ci-key.pem \\\n  -- tar czf myapp.tar.gz myapp\n\n# Verify entire pipeline\nwitness verify \\\n  --policy policy-signed.json \\\n  --publickey policy-key.pub \\\n  -a build.json -a test.json -a package.json\n```\n"}]}
{"messages": [{"role": "system", "content": "You are an expert in the Witness supply chain attestation framework. You help users instrument CI/CD pipelines with witness, create policy documents, and write Rego policies to validate attestations. You understand all attestors in go-witness and how to use them effectively."}, {"role": "user", "content": "How do I create a witness policy for a build step that uses these attestors: material, product?"}, {"role": "assistant", "content": "Here's a complete witness policy for your build step with material, product attestors:\n\n**Policy Document:**\n```json\n{\n  \"expires\": \"2026-11-08T10:52:59Z\",\n  \"publickeys\": {\n    \"build-key\": {\n      \"keyid\": \"sha256:3734e36ee68435a97e44dbbc6bd4a0646dcb2cfbc02975185fcc3d1d32f88a90\",\n      \"key\": \"-----BEGIN PUBLIC KEY-----\\n...\\n-----END PUBLIC KEY-----\"\n    }\n  },\n  \"steps\": {\n    \"build\": {\n      \"name\": \"build\",\n      \"attestations\": [\n        {\n          \"type\": \"https://witness.dev/attestations/material/v0.1\"\n        },\n        {\n          \"type\": \"https://witness.dev/attestations/product/v0.1\"\n        }\n      ],\n      \"functionaries\": [\n        {\n          \"type\": \"publickey\",\n          \"publickeyid\": \"build-key\"\n        }\n      ]\n    }\n  }\n}\n```\n\n**Witness Run Command:**\n```bash\nwitness run --step build \\\n  --attestations material,product \\\n  --outfile build-attestation.json \\\n  --key signing-key.pem \\\n  -- <your-build-command>\n```\n\n**Rego Validation Rules:**\n```rego\n\n```\n\n**Verification:**\n```bash\nwitness verify \\\n  --policy policy-signed.json \\\n  --publickey policy-key.pub \\\n  -a build-attestation.json \\\n  --subject <artifact>\n```\n"}]}
{"messages": [{"role": "system", "content": "You are an expert in the Witness supply chain attestation framework. You help users instrument CI/CD pipelines with witness, create policy documents, and write Rego policies to validate attestations. You understand all attestors in go-witness and how to use them effectively."}, {"role": "user", "content": "How do I create a multi-step witness policy for a build \u2192 test \u2192 package pipeline?"}, {"role": "assistant", "content": "Here's a complete multi-step witness policy for your pipeline:\n\n**Policy Document:**\n```json\n{\n  \"expires\": \"2026-11-08T10:52:59Z\",\n  \"publickeys\": {\n    \"ci-key\": {\n      \"keyid\": \"sha256:2ec0c7a35eb2e0456fb961be5fe462865f5a7be77f8ec45cbeffd1e38cceead1\",\n      \"key\": \"-----BEGIN PUBLIC KEY-----\\n...\\n-----END PUBLIC KEY-----\"\n    }\n  },\n  \"steps\": {\n    \"build\": {\n      \"name\": \"build\",\n      \"attestations\": [\n        {\n          \"type\": \"https://witness.dev/attestations/git/v0.1\"\n        },\n        {\n          \"type\": \"https://witness.dev/attestations/command-run/v0.1\"\n        },\n        {\n          \"type\": \"https://witness.dev/attestations/product/v0.1\"\n        }\n      ],\n      \"functionaries\": [\n        {\n          \"type\": \"publickey\",\n          \"publickeyid\": \"ci-key\"\n        }\n      ]\n    },\n    \"test\": {\n      \"name\": \"test\",\n      \"attestations\": [\n        {\n          \"type\": \"https://witness.dev/attestations/material/v0.1\"\n        },\n        {\n          \"type\": \"https://witness.dev/attestations/command-run/v0.1\"\n        }\n      ],\n      \"functionaries\": [\n        {\n          \"type\": \"publickey\",\n          \"publickeyid\": \"ci-key\"\n        }\n      ]\n    },\n    \"package\": {\n      \"name\": \"package\",\n      \"attestations\": [\n        {\n          \"type\": \"https://witness.dev/attestations/material/v0.1\"\n        },\n        {\n          \"type\": \"https://witness.dev/attestations/product/v0.1\"\n        }\n      ],\n      \"functionaries\": [\n        {\n          \"type\": \"publickey\",\n          \"publickeyid\": \"ci-key\"\n        }\n      ]\n    }\n  }\n}\n```\n\n**Pipeline Commands:**\n\n```bash\n# Step 1: Build\nwitness run --step build \\\n  --attestations git,commandrun,product \\\n  -o build.json --key ci-key.pem \\\n  -- go build -o myapp\n\n# Step 2: Test\nwitness run --step test \\\n  --attestations material,commandrun \\\n  -o test.json --key ci-key.pem \\\n  -- go test ./...\n\n# Step 3: Package\nwitness run --step package \\\n  --attestations material,product \\\n  -o package.json --key ci-key.pem \\\n  -- tar czf myapp.tar.gz myapp\n\n# Verify entire pipeline\nwitness verify \\\n  --policy policy-signed.json \\\n  --publickey policy-key.pub \\\n  -a build.json -a test.json -a package.json\n```\n"}]}
{"messages": [{"role": "system", "content": "You are an expert in the Witness supply chain attestation framework. You help users instrument CI/CD pipelines with witness, create policy documents, and write Rego policies to validate attestations. You understand all attestors in go-witness and how to use them effectively."}, {"role": "user", "content": "How do I create a witness policy for a build step that uses these attestors: product, material, git?"}, {"role": "assistant", "content": "Here's a complete witness policy for your build step with product, material, git attestors:\n\n**Policy Document:**\n```json\n{\n  \"expires\": \"2026-11-08T10:52:59Z\",\n  \"publickeys\": {\n    \"build-key\": {\n      \"keyid\": \"sha256:34226ed39eec61db7a7e12c3de59c8fc6a7a59f64f0915dbf888ddea6c4f85f5\",\n      \"key\": \"-----BEGIN PUBLIC KEY-----\\n...\\n-----END PUBLIC KEY-----\"\n    }\n  },\n  \"steps\": {\n    \"build\": {\n      \"name\": \"build\",\n      \"attestations\": [\n        {\n          \"type\": \"https://witness.dev/attestations/product/v0.1\"\n        },\n        {\n          \"type\": \"https://witness.dev/attestations/material/v0.1\"\n        },\n        {\n          \"type\": \"https://witness.dev/attestations/git/v0.1\"\n        }\n      ],\n      \"functionaries\": [\n        {\n          \"type\": \"publickey\",\n          \"publickeyid\": \"build-key\"\n        }\n      ]\n    }\n  }\n}\n```\n\n**Witness Run Command:**\n```bash\nwitness run --step build \\\n  --attestations product,material,git \\\n  --outfile build-attestation.json \\\n  --key signing-key.pem \\\n  -- <your-build-command>\n```\n\n**Rego Validation Rules:**\n```rego\n\n```\n\n**Verification:**\n```bash\nwitness verify \\\n  --policy policy-signed.json \\\n  --publickey policy-key.pub \\\n  -a build-attestation.json \\\n  --subject <artifact>\n```\n"}]}
{"messages": [{"role": "system", "content": "You are an expert in the Witness supply chain attestation framework. You help users instrument CI/CD pipelines with witness, create policy documents, and write Rego policies to validate attestations. You understand all attestors in go-witness and how to use them effectively."}, {"role": "user", "content": "How do I create a witness policy for a build step that uses these attestors: git, material, commandrun, github, product?"}, {"role": "assistant", "content": "Here's a complete witness policy for your build step with git, material, commandrun, github, product attestors:\n\n**Policy Document:**\n```json\n{\n  \"expires\": \"2026-11-08T10:52:59Z\",\n  \"publickeys\": {\n    \"build-key\": {\n      \"keyid\": \"sha256:599fd19147e18f704abc04e34d5fc20ff822d45ba0eae27908468bc8e58eeb76\",\n      \"key\": \"-----BEGIN PUBLIC KEY-----\\n...\\n-----END PUBLIC KEY-----\"\n    }\n  },\n  \"steps\": {\n    \"build\": {\n      \"name\": \"build\",\n      \"attestations\": [\n        {\n          \"type\": \"https://witness.dev/attestations/git/v0.1\"\n        },\n        {\n          \"type\": \"https://witness.dev/attestations/material/v0.1\"\n        },\n        {\n          \"type\": \"https://witness.dev/attestations/command-run/v0.1\"\n        },\n        {\n          \"type\": \"https://witness.dev/attestations/github/v0.1\"\n        },\n        {\n          \"type\": \"https://witness.dev/attestations/product/v0.1\"\n        }\n      ],\n      \"functionaries\": [\n        {\n          \"type\": \"publickey\",\n          \"publickeyid\": \"build-key\"\n        }\n      ]\n    }\n  }\n}\n```\n\n**Witness Run Command:**\n```bash\nwitness run --step build \\\n  --attestations git,material,commandrun,github,product \\\n  --outfile build-attestation.json \\\n  --key signing-key.pem \\\n  -- <your-build-command>\n```\n\n**Rego Validation Rules:**\n```rego\npackage git\n\nimport rego.v1\n\n# Enforce builds from specific branch\ndeny contains msg if {\n    input.branch != \"hotfix/critical\"\n    msg := sprintf(\"Must build from hotfix/critical branch, got: %s\", [input.branch])\n}\n\n# Require clean working directory\ndeny contains msg if {\n    count(input.status) > 0\n    msg := \"Working directory must be clean (no uncommitted changes)\"\n}\n\n# Validate commit author\napproved_authors := {\n    \"alice.smith@example.com\",\n    \"bob.jones@company.com\",\n    \"ci-bot@company.com\"\n}\n\ndeny contains msg if {\n    not input.authoremail in approved_authors\n    msg := sprintf(\"Unauthorized commit author: %s\", [input.authoremail])\n}\n```\n\n**Verification:**\n```bash\nwitness verify \\\n  --policy policy-signed.json \\\n  --publickey policy-key.pub \\\n  -a build-attestation.json \\\n  --subject <artifact>\n```\n"}]}
{"messages": [{"role": "system", "content": "You are an expert in the Witness supply chain attestation framework. You help users instrument CI/CD pipelines with witness, create policy documents, and write Rego policies to validate attestations. You understand all attestors in go-witness and how to use them effectively."}, {"role": "user", "content": "How do I create a witness policy for a build step that uses these attestors: environment, commandrun, git, github?"}, {"role": "assistant", "content": "Here's a complete witness policy for your build step with environment, commandrun, git, github attestors:\n\n**Policy Document:**\n```json\n{\n  \"expires\": \"2026-11-08T10:52:59Z\",\n  \"publickeys\": {\n    \"build-key\": {\n      \"keyid\": \"sha256:a4afa9243cc58c3ca95d16ed19de7cce972c1616a95f0b8380fea27ba8d6e5f4\",\n      \"key\": \"-----BEGIN PUBLIC KEY-----\\n...\\n-----END PUBLIC KEY-----\"\n    }\n  },\n  \"steps\": {\n    \"build\": {\n      \"name\": \"build\",\n      \"attestations\": [\n        {\n          \"type\": \"https://witness.dev/attestations/environment/v0.1\"\n        },\n        {\n          \"type\": \"https://witness.dev/attestations/command-run/v0.1\"\n        },\n        {\n          \"type\": \"https://witness.dev/attestations/git/v0.1\"\n        },\n        {\n          \"type\": \"https://witness.dev/attestations/github/v0.1\"\n        }\n      ],\n      \"functionaries\": [\n        {\n          \"type\": \"publickey\",\n          \"publickeyid\": \"build-key\"\n        }\n      ]\n    }\n  }\n}\n```\n\n**Witness Run Command:**\n```bash\nwitness run --step build \\\n  --attestations environment,commandrun,git,github \\\n  --outfile build-attestation.json \\\n  --key signing-key.pem \\\n  -- <your-build-command>\n```\n\n**Rego Validation Rules:**\n```rego\npackage environment\n\nimport rego.v1\n\n# Ensure correct OS\ndeny contains msg if {\n    input.os != \"windows\"\n    msg := sprintf(\"Must run on windows, got: %s\", [input.os])\n}\n\n# Require CI environment\ndeny contains msg if {\n    not \"CI\" in input.variables\n    msg := \"Must run in CI environment (CI variable not set)\"\n}\n```\n\n**Verification:**\n```bash\nwitness verify \\\n  --policy policy-signed.json \\\n  --publickey policy-key.pub \\\n  -a build-attestation.json \\\n  --subject <artifact>\n```\n"}]}
{"messages": [{"role": "system", "content": "You are an expert in the Witness supply chain attestation framework. You help users instrument CI/CD pipelines with witness, create policy documents, and write Rego policies to validate attestations. You understand all attestors in go-witness and how to use them effectively."}, {"role": "user", "content": "How do I create a multi-step witness policy for a build \u2192 test \u2192 package pipeline?"}, {"role": "assistant", "content": "Here's a complete multi-step witness policy for your pipeline:\n\n**Policy Document:**\n```json\n{\n  \"expires\": \"2026-11-08T10:52:59Z\",\n  \"publickeys\": {\n    \"ci-key\": {\n      \"keyid\": \"sha256:980fa742fb5cd249fd8843fc6c36d1f2dc2268fe5e47f0057a62ad160fd07fe0\",\n      \"key\": \"-----BEGIN PUBLIC KEY-----\\n...\\n-----END PUBLIC KEY-----\"\n    }\n  },\n  \"steps\": {\n    \"build\": {\n      \"name\": \"build\",\n      \"attestations\": [\n        {\n          \"type\": \"https://witness.dev/attestations/git/v0.1\"\n        },\n        {\n          \"type\": \"https://witness.dev/attestations/command-run/v0.1\"\n        },\n        {\n          \"type\": \"https://witness.dev/attestations/product/v0.1\"\n        }\n      ],\n      \"functionaries\": [\n        {\n          \"type\": \"publickey\",\n          \"publickeyid\": \"ci-key\"\n        }\n      ]\n    },\n    \"test\": {\n      \"name\": \"test\",\n      \"attestations\": [\n        {\n          \"type\": \"https://witness.dev/attestations/material/v0.1\"\n        },\n        {\n          \"type\": \"https://witness.dev/attestations/command-run/v0.1\"\n        }\n      ],\n      \"functionaries\": [\n        {\n          \"type\": \"publickey\",\n          \"publickeyid\": \"ci-key\"\n        }\n      ]\n    },\n    \"package\": {\n      \"name\": \"package\",\n      \"attestations\": [\n        {\n          \"type\": \"https://witness.dev/attestations/material/v0.1\"\n        },\n        {\n          \"type\": \"https://witness.dev/attestations/product/v0.1\"\n        }\n      ],\n      \"functionaries\": [\n        {\n          \"type\": \"publickey\",\n          \"publickeyid\": \"ci-key\"\n        }\n      ]\n    }\n  }\n}\n```\n\n**Pipeline Commands:**\n\n```bash\n# Step 1: Build\nwitness run --step build \\\n  --attestations git,commandrun,product \\\n  -o build.json --key ci-key.pem \\\n  -- go build -o myapp\n\n# Step 2: Test\nwitness run --step test \\\n  --attestations material,commandrun \\\n  -o test.json --key ci-key.pem \\\n  -- go test ./...\n\n# Step 3: Package\nwitness run --step package \\\n  --attestations material,product \\\n  -o package.json --key ci-key.pem \\\n  -- tar czf myapp.tar.gz myapp\n\n# Verify entire pipeline\nwitness verify \\\n  --policy policy-signed.json \\\n  --publickey policy-key.pub \\\n  -a build.json -a test.json -a package.json\n```\n"}]}
{"messages": [{"role": "system", "content": "You are an expert in the Witness supply chain attestation framework. You help users instrument CI/CD pipelines with witness, create policy documents, and write Rego policies to validate attestations. You understand all attestors in go-witness and how to use them effectively."}, {"role": "user", "content": "How do I create a witness policy for a build step that uses these attestors: github?"}, {"role": "assistant", "content": "Here's a complete witness policy for your build step with github attestors:\n\n**Policy Document:**\n```json\n{\n  \"expires\": \"2026-11-08T10:52:59Z\",\n  \"publickeys\": {\n    \"build-key\": {\n      \"keyid\": \"sha256:1cd97b2ce62e79bc7d9a1802b58632ce4e4254c63229d4021e8c1b4667ab0286\",\n      \"key\": \"-----BEGIN PUBLIC KEY-----\\n...\\n-----END PUBLIC KEY-----\"\n    }\n  },\n  \"steps\": {\n    \"build\": {\n      \"name\": \"build\",\n      \"attestations\": [\n        {\n          \"type\": \"https://witness.dev/attestations/github/v0.1\"\n        }\n      ],\n      \"functionaries\": [\n        {\n          \"type\": \"publickey\",\n          \"publickeyid\": \"build-key\"\n        }\n      ]\n    }\n  }\n}\n```\n\n**Witness Run Command:**\n```bash\nwitness run --step build \\\n  --attestations github \\\n  --outfile build-attestation.json \\\n  --key signing-key.pem \\\n  -- <your-build-command>\n```\n\n**Rego Validation Rules:**\n```rego\n\n```\n\n**Verification:**\n```bash\nwitness verify \\\n  --policy policy-signed.json \\\n  --publickey policy-key.pub \\\n  -a build-attestation.json \\\n  --subject <artifact>\n```\n"}]}
{"messages": [{"role": "system", "content": "You are an expert in the Witness supply chain attestation framework. You help users instrument CI/CD pipelines with witness, create policy documents, and write Rego policies to validate attestations. You understand all attestors in go-witness and how to use them effectively."}, {"role": "user", "content": "How do I create a witness policy for a build step that uses these attestors: material?"}, {"role": "assistant", "content": "Here's a complete witness policy for your build step with material attestors:\n\n**Policy Document:**\n```json\n{\n  \"expires\": \"2026-11-08T10:52:59Z\",\n  \"publickeys\": {\n    \"build-key\": {\n      \"keyid\": \"sha256:2244151a0297b91ba8bec8ca6d9e8732b9bbd565d41a2cbd99545d7ddfbbcd62\",\n      \"key\": \"-----BEGIN PUBLIC KEY-----\\n...\\n-----END PUBLIC KEY-----\"\n    }\n  },\n  \"steps\": {\n    \"build\": {\n      \"name\": \"build\",\n      \"attestations\": [\n        {\n          \"type\": \"https://witness.dev/attestations/material/v0.1\"\n        }\n      ],\n      \"functionaries\": [\n        {\n          \"type\": \"publickey\",\n          \"publickeyid\": \"build-key\"\n        }\n      ]\n    }\n  }\n}\n```\n\n**Witness Run Command:**\n```bash\nwitness run --step build \\\n  --attestations material \\\n  --outfile build-attestation.json \\\n  --key signing-key.pem \\\n  -- <your-build-command>\n```\n\n**Rego Validation Rules:**\n```rego\n\n```\n\n**Verification:**\n```bash\nwitness verify \\\n  --policy policy-signed.json \\\n  --publickey policy-key.pub \\\n  -a build-attestation.json \\\n  --subject <artifact>\n```\n"}]}
{"messages": [{"role": "system", "content": "You are an expert in the Witness supply chain attestation framework. You help users instrument CI/CD pipelines with witness, create policy documents, and write Rego policies to validate attestations. You understand all attestors in go-witness and how to use them effectively."}, {"role": "user", "content": "How do I create a witness policy for a build step that uses these attestors: environment?"}, {"role": "assistant", "content": "Here's a complete witness policy for your build step with environment attestors:\n\n**Policy Document:**\n```json\n{\n  \"expires\": \"2026-11-08T10:52:59Z\",\n  \"publickeys\": {\n    \"build-key\": {\n      \"keyid\": \"sha256:34e1c95a1dec8116e7599a922b52467cb5aada54bdad5c644e746595d76dbe47\",\n      \"key\": \"-----BEGIN PUBLIC KEY-----\\n...\\n-----END PUBLIC KEY-----\"\n    }\n  },\n  \"steps\": {\n    \"build\": {\n      \"name\": \"build\",\n      \"attestations\": [\n        {\n          \"type\": \"https://witness.dev/attestations/environment/v0.1\"\n        }\n      ],\n      \"functionaries\": [\n        {\n          \"type\": \"publickey\",\n          \"publickeyid\": \"build-key\"\n        }\n      ]\n    }\n  }\n}\n```\n\n**Witness Run Command:**\n```bash\nwitness run --step build \\\n  --attestations environment \\\n  --outfile build-attestation.json \\\n  --key signing-key.pem \\\n  -- <your-build-command>\n```\n\n**Rego Validation Rules:**\n```rego\npackage environment\n\nimport rego.v1\n\n# Ensure correct OS\ndeny contains msg if {\n    input.os != \"windows\"\n    msg := sprintf(\"Must run on windows, got: %s\", [input.os])\n}\n\n# Require CI environment\ndeny contains msg if {\n    not \"CI\" in input.variables\n    msg := \"Must run in CI environment (CI variable not set)\"\n}\n```\n\n**Verification:**\n```bash\nwitness verify \\\n  --policy policy-signed.json \\\n  --publickey policy-key.pub \\\n  -a build-attestation.json \\\n  --subject <artifact>\n```\n"}]}
{"messages": [{"role": "system", "content": "You are an expert in the Witness supply chain attestation framework. You help users instrument CI/CD pipelines with witness, create policy documents, and write Rego policies to validate attestations. You understand all attestors in go-witness and how to use them effectively."}, {"role": "user", "content": "How do I create a witness policy for a build step that uses these attestors: github?"}, {"role": "assistant", "content": "Here's a complete witness policy for your build step with github attestors:\n\n**Policy Document:**\n```json\n{\n  \"expires\": \"2026-11-08T10:52:59Z\",\n  \"publickeys\": {\n    \"build-key\": {\n      \"keyid\": \"sha256:29413a559e68de44e9c93e72677ba43a558e3922f79d9dc54769106afaea8290\",\n      \"key\": \"-----BEGIN PUBLIC KEY-----\\n...\\n-----END PUBLIC KEY-----\"\n    }\n  },\n  \"steps\": {\n    \"build\": {\n      \"name\": \"build\",\n      \"attestations\": [\n        {\n          \"type\": \"https://witness.dev/attestations/github/v0.1\"\n        }\n      ],\n      \"functionaries\": [\n        {\n          \"type\": \"publickey\",\n          \"publickeyid\": \"build-key\"\n        }\n      ]\n    }\n  }\n}\n```\n\n**Witness Run Command:**\n```bash\nwitness run --step build \\\n  --attestations github \\\n  --outfile build-attestation.json \\\n  --key signing-key.pem \\\n  -- <your-build-command>\n```\n\n**Rego Validation Rules:**\n```rego\n\n```\n\n**Verification:**\n```bash\nwitness verify \\\n  --policy policy-signed.json \\\n  --publickey policy-key.pub \\\n  -a build-attestation.json \\\n  --subject <artifact>\n```\n"}]}
{"messages": [{"role": "system", "content": "You are an expert in the Witness supply chain attestation framework. You help users instrument CI/CD pipelines with witness, create policy documents, and write Rego policies to validate attestations. You understand all attestors in go-witness and how to use them effectively."}, {"role": "user", "content": "How do I create a witness policy for a build step that uses these attestors: git, commandrun, material, environment?"}, {"role": "assistant", "content": "Here's a complete witness policy for your build step with git, commandrun, material, environment attestors:\n\n**Policy Document:**\n```json\n{\n  \"expires\": \"2026-11-08T10:52:59Z\",\n  \"publickeys\": {\n    \"build-key\": {\n      \"keyid\": \"sha256:f5cc214458ffe0be10ec365a968e26ec0b90d8f5c8e49f29723bf256900e2c21\",\n      \"key\": \"-----BEGIN PUBLIC KEY-----\\n...\\n-----END PUBLIC KEY-----\"\n    }\n  },\n  \"steps\": {\n    \"build\": {\n      \"name\": \"build\",\n      \"attestations\": [\n        {\n          \"type\": \"https://witness.dev/attestations/git/v0.1\"\n        },\n        {\n          \"type\": \"https://witness.dev/attestations/command-run/v0.1\"\n        },\n        {\n          \"type\": \"https://witness.dev/attestations/material/v0.1\"\n        },\n        {\n          \"type\": \"https://witness.dev/attestations/environment/v0.1\"\n        }\n      ],\n      \"functionaries\": [\n        {\n          \"type\": \"publickey\",\n          \"publickeyid\": \"build-key\"\n        }\n      ]\n    }\n  }\n}\n```\n\n**Witness Run Command:**\n```bash\nwitness run --step build \\\n  --attestations git,commandrun,material,environment \\\n  --outfile build-attestation.json \\\n  --key signing-key.pem \\\n  -- <your-build-command>\n```\n\n**Rego Validation Rules:**\n```rego\npackage git\n\nimport rego.v1\n\n# Enforce builds from specific branch\ndeny contains msg if {\n    input.branch != \"feature/auth\"\n    msg := sprintf(\"Must build from feature/auth branch, got: %s\", [input.branch])\n}\n\n# Require clean working directory\ndeny contains msg if {\n    count(input.status) > 0\n    msg := \"Working directory must be clean (no uncommitted changes)\"\n}\n\n# Validate commit author\napproved_authors := {\n    \"alice.smith@example.com\",\n    \"bob.jones@company.com\",\n    \"ci-bot@company.com\"\n}\n\ndeny contains msg if {\n    not input.authoremail in approved_authors\n    msg := sprintf(\"Unauthorized commit author: %s\", [input.authoremail])\n}\n```\n\n**Verification:**\n```bash\nwitness verify \\\n  --policy policy-signed.json \\\n  --publickey policy-key.pub \\\n  -a build-attestation.json \\\n  --subject <artifact>\n```\n"}]}
{"messages": [{"role": "system", "content": "You are an expert in the Witness supply chain attestation framework. You help users instrument CI/CD pipelines with witness, create policy documents, and write Rego policies to validate attestations. You understand all attestors in go-witness and how to use them effectively."}, {"role": "user", "content": "How do I create a witness policy for a build step that uses these attestors: product, environment, github, git?"}, {"role": "assistant", "content": "Here's a complete witness policy for your build step with product, environment, github, git attestors:\n\n**Policy Document:**\n```json\n{\n  \"expires\": \"2026-11-08T10:52:59Z\",\n  \"publickeys\": {\n    \"build-key\": {\n      \"keyid\": \"sha256:ca71c3c837a4d01f1afde580b3fdf335399c363609987e13bd87c1676d38613a\",\n      \"key\": \"-----BEGIN PUBLIC KEY-----\\n...\\n-----END PUBLIC KEY-----\"\n    }\n  },\n  \"steps\": {\n    \"build\": {\n      \"name\": \"build\",\n      \"attestations\": [\n        {\n          \"type\": \"https://witness.dev/attestations/product/v0.1\"\n        },\n        {\n          \"type\": \"https://witness.dev/attestations/environment/v0.1\"\n        },\n        {\n          \"type\": \"https://witness.dev/attestations/github/v0.1\"\n        },\n        {\n          \"type\": \"https://witness.dev/attestations/git/v0.1\"\n        }\n      ],\n      \"functionaries\": [\n        {\n          \"type\": \"publickey\",\n          \"publickeyid\": \"build-key\"\n        }\n      ]\n    }\n  }\n}\n```\n\n**Witness Run Command:**\n```bash\nwitness run --step build \\\n  --attestations product,environment,github,git \\\n  --outfile build-attestation.json \\\n  --key signing-key.pem \\\n  -- <your-build-command>\n```\n\n**Rego Validation Rules:**\n```rego\n\n```\n\n**Verification:**\n```bash\nwitness verify \\\n  --policy policy-signed.json \\\n  --publickey policy-key.pub \\\n  -a build-attestation.json \\\n  --subject <artifact>\n```\n"}]}
{"messages": [{"role": "system", "content": "You are an expert in the Witness supply chain attestation framework. You help users instrument CI/CD pipelines with witness, create policy documents, and write Rego policies to validate attestations. You understand all attestors in go-witness and how to use them effectively."}, {"role": "user", "content": "How do I create a multi-step witness policy for a build \u2192 test \u2192 package pipeline?"}, {"role": "assistant", "content": "Here's a complete multi-step witness policy for your pipeline:\n\n**Policy Document:**\n```json\n{\n  \"expires\": \"2026-11-08T10:52:59Z\",\n  \"publickeys\": {\n    \"ci-key\": {\n      \"keyid\": \"sha256:3243dcc37c986a3f1a914b284f9bb942d6873ee3a810bb210ded92f48e4dfee0\",\n      \"key\": \"-----BEGIN PUBLIC KEY-----\\n...\\n-----END PUBLIC KEY-----\"\n    }\n  },\n  \"steps\": {\n    \"build\": {\n      \"name\": \"build\",\n      \"attestations\": [\n        {\n          \"type\": \"https://witness.dev/attestations/git/v0.1\"\n        },\n        {\n          \"type\": \"https://witness.dev/attestations/command-run/v0.1\"\n        },\n        {\n          \"type\": \"https://witness.dev/attestations/product/v0.1\"\n        }\n      ],\n      \"functionaries\": [\n        {\n          \"type\": \"publickey\",\n          \"publickeyid\": \"ci-key\"\n        }\n      ]\n    },\n    \"test\": {\n      \"name\": \"test\",\n      \"attestations\": [\n        {\n          \"type\": \"https://witness.dev/attestations/material/v0.1\"\n        },\n        {\n          \"type\": \"https://witness.dev/attestations/command-run/v0.1\"\n        }\n      ],\n      \"functionaries\": [\n        {\n          \"type\": \"publickey\",\n          \"publickeyid\": \"ci-key\"\n        }\n      ]\n    },\n    \"package\": {\n      \"name\": \"package\",\n      \"attestations\": [\n        {\n          \"type\": \"https://witness.dev/attestations/material/v0.1\"\n        },\n        {\n          \"type\": \"https://witness.dev/attestations/product/v0.1\"\n        }\n      ],\n      \"functionaries\": [\n        {\n          \"type\": \"publickey\",\n          \"publickeyid\": \"ci-key\"\n        }\n      ]\n    }\n  }\n}\n```\n\n**Pipeline Commands:**\n\n```bash\n# Step 1: Build\nwitness run --step build \\\n  --attestations git,commandrun,product \\\n  -o build.json --key ci-key.pem \\\n  -- go build -o myapp\n\n# Step 2: Test\nwitness run --step test \\\n  --attestations material,commandrun \\\n  -o test.json --key ci-key.pem \\\n  -- go test ./...\n\n# Step 3: Package\nwitness run --step package \\\n  --attestations material,product \\\n  -o package.json --key ci-key.pem \\\n  -- tar czf myapp.tar.gz myapp\n\n# Verify entire pipeline\nwitness verify \\\n  --policy policy-signed.json \\\n  --publickey policy-key.pub \\\n  -a build.json -a test.json -a package.json\n```\n"}]}
{"messages": [{"role": "system", "content": "You are an expert in the Witness supply chain attestation framework. You help users instrument CI/CD pipelines with witness, create policy documents, and write Rego policies to validate attestations. You understand all attestors in go-witness and how to use them effectively."}, {"role": "user", "content": "How do I create a multi-step witness policy for a build \u2192 test \u2192 package pipeline?"}, {"role": "assistant", "content": "Here's a complete multi-step witness policy for your pipeline:\n\n**Policy Document:**\n```json\n{\n  \"expires\": \"2026-11-08T10:52:59Z\",\n  \"publickeys\": {\n    \"ci-key\": {\n      \"keyid\": \"sha256:f7061db7c6fcd319bcef0bdea9829abbff1e44011c15bcf0f6f5f9d5c2dbb1d3\",\n      \"key\": \"-----BEGIN PUBLIC KEY-----\\n...\\n-----END PUBLIC KEY-----\"\n    }\n  },\n  \"steps\": {\n    \"build\": {\n      \"name\": \"build\",\n      \"attestations\": [\n        {\n          \"type\": \"https://witness.dev/attestations/git/v0.1\"\n        },\n        {\n          \"type\": \"https://witness.dev/attestations/command-run/v0.1\"\n        },\n        {\n          \"type\": \"https://witness.dev/attestations/product/v0.1\"\n        }\n      ],\n      \"functionaries\": [\n        {\n          \"type\": \"publickey\",\n          \"publickeyid\": \"ci-key\"\n        }\n      ]\n    },\n    \"test\": {\n      \"name\": \"test\",\n      \"attestations\": [\n        {\n          \"type\": \"https://witness.dev/attestations/material/v0.1\"\n        },\n        {\n          \"type\": \"https://witness.dev/attestations/command-run/v0.1\"\n        }\n      ],\n      \"functionaries\": [\n        {\n          \"type\": \"publickey\",\n          \"publickeyid\": \"ci-key\"\n        }\n      ]\n    },\n    \"package\": {\n      \"name\": \"package\",\n      \"attestations\": [\n        {\n          \"type\": \"https://witness.dev/attestations/material/v0.1\"\n        },\n        {\n          \"type\": \"https://witness.dev/attestations/product/v0.1\"\n        }\n      ],\n      \"functionaries\": [\n        {\n          \"type\": \"publickey\",\n          \"publickeyid\": \"ci-key\"\n        }\n      ]\n    }\n  }\n}\n```\n\n**Pipeline Commands:**\n\n```bash\n# Step 1: Build\nwitness run --step build \\\n  --attestations git,commandrun,product \\\n  -o build.json --key ci-key.pem \\\n  -- go build -o myapp\n\n# Step 2: Test\nwitness run --step test \\\n  --attestations material,commandrun \\\n  -o test.json --key ci-key.pem \\\n  -- go test ./...\n\n# Step 3: Package\nwitness run --step package \\\n  --attestations material,product \\\n  -o package.json --key ci-key.pem \\\n  -- tar czf myapp.tar.gz myapp\n\n# Verify entire pipeline\nwitness verify \\\n  --policy policy-signed.json \\\n  --publickey policy-key.pub \\\n  -a build.json -a test.json -a package.json\n```\n"}]}
{"messages": [{"role": "system", "content": "You are an expert in the Witness supply chain attestation framework. You help users instrument CI/CD pipelines with witness, create policy documents, and write Rego policies to validate attestations. You understand all attestors in go-witness and how to use them effectively."}, {"role": "user", "content": "How do I create a witness policy for a build step that uses these attestors: git, material, environment, commandrun?"}, {"role": "assistant", "content": "Here's a complete witness policy for your build step with git, material, environment, commandrun attestors:\n\n**Policy Document:**\n```json\n{\n  \"expires\": \"2026-11-08T10:52:59Z\",\n  \"publickeys\": {\n    \"build-key\": {\n      \"keyid\": \"sha256:bef3ee60099b220a01c8a7d61c73f3d0cfc7ee8a968844b10b89d21d34048074\",\n      \"key\": \"-----BEGIN PUBLIC KEY-----\\n...\\n-----END PUBLIC KEY-----\"\n    }\n  },\n  \"steps\": {\n    \"build\": {\n      \"name\": \"build\",\n      \"attestations\": [\n        {\n          \"type\": \"https://witness.dev/attestations/git/v0.1\"\n        },\n        {\n          \"type\": \"https://witness.dev/attestations/material/v0.1\"\n        },\n        {\n          \"type\": \"https://witness.dev/attestations/environment/v0.1\"\n        },\n        {\n          \"type\": \"https://witness.dev/attestations/command-run/v0.1\"\n        }\n      ],\n      \"functionaries\": [\n        {\n          \"type\": \"publickey\",\n          \"publickeyid\": \"build-key\"\n        }\n      ]\n    }\n  }\n}\n```\n\n**Witness Run Command:**\n```bash\nwitness run --step build \\\n  --attestations git,material,environment,commandrun \\\n  --outfile build-attestation.json \\\n  --key signing-key.pem \\\n  -- <your-build-command>\n```\n\n**Rego Validation Rules:**\n```rego\npackage git\n\nimport rego.v1\n\n# Enforce builds from specific branch\ndeny contains msg if {\n    input.branch != \"main\"\n    msg := sprintf(\"Must build from main branch, got: %s\", [input.branch])\n}\n\n# Require clean working directory\ndeny contains msg if {\n    count(input.status) > 0\n    msg := \"Working directory must be clean (no uncommitted changes)\"\n}\n\n# Validate commit author\napproved_authors := {\n    \"alice.smith@example.com\",\n    \"bob.jones@company.com\",\n    \"ci-bot@company.com\"\n}\n\ndeny contains msg if {\n    not input.authoremail in approved_authors\n    msg := sprintf(\"Unauthorized commit author: %s\", [input.authoremail])\n}\n```\n\n**Verification:**\n```bash\nwitness verify \\\n  --policy policy-signed.json \\\n  --publickey policy-key.pub \\\n  -a build-attestation.json \\\n  --subject <artifact>\n```\n"}]}
{"messages": [{"role": "system", "content": "You are an expert in the Witness supply chain attestation framework. You help users instrument CI/CD pipelines with witness, create policy documents, and write Rego policies to validate attestations. You understand all attestors in go-witness and how to use them effectively."}, {"role": "user", "content": "How do I create a witness policy for a build step that uses these attestors: environment, github, product?"}, {"role": "assistant", "content": "Here's a complete witness policy for your build step with environment, github, product attestors:\n\n**Policy Document:**\n```json\n{\n  \"expires\": \"2026-11-08T10:52:59Z\",\n  \"publickeys\": {\n    \"build-key\": {\n      \"keyid\": \"sha256:98be4d8764df9aa23377b2133c25f02cc2f69c069d76984d9e0692ab8786d9e1\",\n      \"key\": \"-----BEGIN PUBLIC KEY-----\\n...\\n-----END PUBLIC KEY-----\"\n    }\n  },\n  \"steps\": {\n    \"build\": {\n      \"name\": \"build\",\n      \"attestations\": [\n        {\n          \"type\": \"https://witness.dev/attestations/environment/v0.1\"\n        },\n        {\n          \"type\": \"https://witness.dev/attestations/github/v0.1\"\n        },\n        {\n          \"type\": \"https://witness.dev/attestations/product/v0.1\"\n        }\n      ],\n      \"functionaries\": [\n        {\n          \"type\": \"publickey\",\n          \"publickeyid\": \"build-key\"\n        }\n      ]\n    }\n  }\n}\n```\n\n**Witness Run Command:**\n```bash\nwitness run --step build \\\n  --attestations environment,github,product \\\n  --outfile build-attestation.json \\\n  --key signing-key.pem \\\n  -- <your-build-command>\n```\n\n**Rego Validation Rules:**\n```rego\npackage environment\n\nimport rego.v1\n\n# Ensure correct OS\ndeny contains msg if {\n    input.os != \"linux\"\n    msg := sprintf(\"Must run on linux, got: %s\", [input.os])\n}\n\n# Require CI environment\ndeny contains msg if {\n    not \"CI\" in input.variables\n    msg := \"Must run in CI environment (CI variable not set)\"\n}\n```\n\n**Verification:**\n```bash\nwitness verify \\\n  --policy policy-signed.json \\\n  --publickey policy-key.pub \\\n  -a build-attestation.json \\\n  --subject <artifact>\n```\n"}]}
{"messages": [{"role": "system", "content": "You are an expert in the Witness supply chain attestation framework. You help users instrument CI/CD pipelines with witness, create policy documents, and write Rego policies to validate attestations. You understand all attestors in go-witness and how to use them effectively."}, {"role": "user", "content": "How do I create a multi-step witness policy for a build \u2192 test \u2192 package pipeline?"}, {"role": "assistant", "content": "Here's a complete multi-step witness policy for your pipeline:\n\n**Policy Document:**\n```json\n{\n  \"expires\": \"2026-11-08T10:52:59Z\",\n  \"publickeys\": {\n    \"ci-key\": {\n      \"keyid\": \"sha256:60a9cc2614eb8c6188babebb42248d889455979ac35ccd975b7fc0d84b432cdc\",\n      \"key\": \"-----BEGIN PUBLIC KEY-----\\n...\\n-----END PUBLIC KEY-----\"\n    }\n  },\n  \"steps\": {\n    \"build\": {\n      \"name\": \"build\",\n      \"attestations\": [\n        {\n          \"type\": \"https://witness.dev/attestations/git/v0.1\"\n        },\n        {\n          \"type\": \"https://witness.dev/attestations/command-run/v0.1\"\n        },\n        {\n          \"type\": \"https://witness.dev/attestations/product/v0.1\"\n        }\n      ],\n      \"functionaries\": [\n        {\n          \"type\": \"publickey\",\n          \"publickeyid\": \"ci-key\"\n        }\n      ]\n    },\n    \"test\": {\n      \"name\": \"test\",\n      \"attestations\": [\n        {\n          \"type\": \"https://witness.dev/attestations/material/v0.1\"\n        },\n        {\n          \"type\": \"https://witness.dev/attestations/command-run/v0.1\"\n        }\n      ],\n      \"functionaries\": [\n        {\n          \"type\": \"publickey\",\n          \"publickeyid\": \"ci-key\"\n        }\n      ]\n    },\n    \"package\": {\n      \"name\": \"package\",\n      \"attestations\": [\n        {\n          \"type\": \"https://witness.dev/attestations/material/v0.1\"\n        },\n        {\n          \"type\": \"https://witness.dev/attestations/product/v0.1\"\n        }\n      ],\n      \"functionaries\": [\n        {\n          \"type\": \"publickey\",\n          \"publickeyid\": \"ci-key\"\n        }\n      ]\n    }\n  }\n}\n```\n\n**Pipeline Commands:**\n\n```bash\n# Step 1: Build\nwitness run --step build \\\n  --attestations git,commandrun,product \\\n  -o build.json --key ci-key.pem \\\n  -- go build -o myapp\n\n# Step 2: Test\nwitness run --step test \\\n  --attestations material,commandrun \\\n  -o test.json --key ci-key.pem \\\n  -- go test ./...\n\n# Step 3: Package\nwitness run --step package \\\n  --attestations material,product \\\n  -o package.json --key ci-key.pem \\\n  -- tar czf myapp.tar.gz myapp\n\n# Verify entire pipeline\nwitness verify \\\n  --policy policy-signed.json \\\n  --publickey policy-key.pub \\\n  -a build.json -a test.json -a package.json\n```\n"}]}
{"messages": [{"role": "system", "content": "You are an expert in the Witness supply chain attestation framework. You help users instrument CI/CD pipelines with witness, create policy documents, and write Rego policies to validate attestations. You understand all attestors in go-witness and how to use them effectively."}, {"role": "user", "content": "How do I create a witness policy for a build step that uses these attestors: git?"}, {"role": "assistant", "content": "Here's a complete witness policy for your build step with git attestors:\n\n**Policy Document:**\n```json\n{\n  \"expires\": \"2026-11-08T10:52:59Z\",\n  \"publickeys\": {\n    \"build-key\": {\n      \"keyid\": \"sha256:748c57e8b55e02cc475edb0110de9237dab636d1d5f04f7b80d19270f06f93e7\",\n      \"key\": \"-----BEGIN PUBLIC KEY-----\\n...\\n-----END PUBLIC KEY-----\"\n    }\n  },\n  \"steps\": {\n    \"build\": {\n      \"name\": \"build\",\n      \"attestations\": [\n        {\n          \"type\": \"https://witness.dev/attestations/git/v0.1\"\n        }\n      ],\n      \"functionaries\": [\n        {\n          \"type\": \"publickey\",\n          \"publickeyid\": \"build-key\"\n        }\n      ]\n    }\n  }\n}\n```\n\n**Witness Run Command:**\n```bash\nwitness run --step build \\\n  --attestations git \\\n  --outfile build-attestation.json \\\n  --key signing-key.pem \\\n  -- <your-build-command>\n```\n\n**Rego Validation Rules:**\n```rego\npackage git\n\nimport rego.v1\n\n# Enforce builds from specific branch\ndeny contains msg if {\n    input.branch != \"feature/auth\"\n    msg := sprintf(\"Must build from feature/auth branch, got: %s\", [input.branch])\n}\n\n# Validate commit author\napproved_authors := {\n    \"alice.smith@example.com\",\n    \"bob.jones@company.com\",\n    \"ci-bot@company.com\"\n}\n\ndeny contains msg if {\n    not input.authoremail in approved_authors\n    msg := sprintf(\"Unauthorized commit author: %s\", [input.authoremail])\n}\n```\n\n**Verification:**\n```bash\nwitness verify \\\n  --policy policy-signed.json \\\n  --publickey policy-key.pub \\\n  -a build-attestation.json \\\n  --subject <artifact>\n```\n"}]}
{"messages": [{"role": "system", "content": "You are an expert in the Witness supply chain attestation framework. You help users instrument CI/CD pipelines with witness, create policy documents, and write Rego policies to validate attestations. You understand all attestors in go-witness and how to use them effectively."}, {"role": "user", "content": "How do I create a witness policy for a build step that uses these attestors: github, product, material, environment?"}, {"role": "assistant", "content": "Here's a complete witness policy for your build step with github, product, material, environment attestors:\n\n**Policy Document:**\n```json\n{\n  \"expires\": \"2026-11-08T10:52:59Z\",\n  \"publickeys\": {\n    \"build-key\": {\n      \"keyid\": \"sha256:4a8c8d8a37263c370168c88f716f3dc213ce1441bfe3facecf796845093c0286\",\n      \"key\": \"-----BEGIN PUBLIC KEY-----\\n...\\n-----END PUBLIC KEY-----\"\n    }\n  },\n  \"steps\": {\n    \"build\": {\n      \"name\": \"build\",\n      \"attestations\": [\n        {\n          \"type\": \"https://witness.dev/attestations/github/v0.1\"\n        },\n        {\n          \"type\": \"https://witness.dev/attestations/product/v0.1\"\n        },\n        {\n          \"type\": \"https://witness.dev/attestations/material/v0.1\"\n        },\n        {\n          \"type\": \"https://witness.dev/attestations/environment/v0.1\"\n        }\n      ],\n      \"functionaries\": [\n        {\n          \"type\": \"publickey\",\n          \"publickeyid\": \"build-key\"\n        }\n      ]\n    }\n  }\n}\n```\n\n**Witness Run Command:**\n```bash\nwitness run --step build \\\n  --attestations github,product,material,environment \\\n  --outfile build-attestation.json \\\n  --key signing-key.pem \\\n  -- <your-build-command>\n```\n\n**Rego Validation Rules:**\n```rego\n\n```\n\n**Verification:**\n```bash\nwitness verify \\\n  --policy policy-signed.json \\\n  --publickey policy-key.pub \\\n  -a build-attestation.json \\\n  --subject <artifact>\n```\n"}]}
{"messages": [{"role": "system", "content": "You are an expert in the Witness supply chain attestation framework. You help users instrument CI/CD pipelines with witness, create policy documents, and write Rego policies to validate attestations. You understand all attestors in go-witness and how to use them effectively."}, {"role": "user", "content": "How do I create a multi-step witness policy for a build \u2192 test \u2192 package pipeline?"}, {"role": "assistant", "content": "Here's a complete multi-step witness policy for your pipeline:\n\n**Policy Document:**\n```json\n{\n  \"expires\": \"2026-11-08T10:52:59Z\",\n  \"publickeys\": {\n    \"ci-key\": {\n      \"keyid\": \"sha256:e1601d4855b2f3e0415bb4078724e0c6fde787b4129affb2e4bd18a9ab770c52\",\n      \"key\": \"-----BEGIN PUBLIC KEY-----\\n...\\n-----END PUBLIC KEY-----\"\n    }\n  },\n  \"steps\": {\n    \"build\": {\n      \"name\": \"build\",\n      \"attestations\": [\n        {\n          \"type\": \"https://witness.dev/attestations/git/v0.1\"\n        },\n        {\n          \"type\": \"https://witness.dev/attestations/command-run/v0.1\"\n        },\n        {\n          \"type\": \"https://witness.dev/attestations/product/v0.1\"\n        }\n      ],\n      \"functionaries\": [\n        {\n          \"type\": \"publickey\",\n          \"publickeyid\": \"ci-key\"\n        }\n      ]\n    },\n    \"test\": {\n      \"name\": \"test\",\n      \"attestations\": [\n        {\n          \"type\": \"https://witness.dev/attestations/material/v0.1\"\n        },\n        {\n          \"type\": \"https://witness.dev/attestations/command-run/v0.1\"\n        }\n      ],\n      \"functionaries\": [\n        {\n          \"type\": \"publickey\",\n          \"publickeyid\": \"ci-key\"\n        }\n      ]\n    },\n    \"package\": {\n      \"name\": \"package\",\n      \"attestations\": [\n        {\n          \"type\": \"https://witness.dev/attestations/material/v0.1\"\n        },\n        {\n          \"type\": \"https://witness.dev/attestations/product/v0.1\"\n        }\n      ],\n      \"functionaries\": [\n        {\n          \"type\": \"publickey\",\n          \"publickeyid\": \"ci-key\"\n        }\n      ]\n    }\n  }\n}\n```\n\n**Pipeline Commands:**\n\n```bash\n# Step 1: Build\nwitness run --step build \\\n  --attestations git,commandrun,product \\\n  -o build.json --key ci-key.pem \\\n  -- go build -o myapp\n\n# Step 2: Test\nwitness run --step test \\\n  --attestations material,commandrun \\\n  -o test.json --key ci-key.pem \\\n  -- go test ./...\n\n# Step 3: Package\nwitness run --step package \\\n  --attestations material,product \\\n  -o package.json --key ci-key.pem \\\n  -- tar czf myapp.tar.gz myapp\n\n# Verify entire pipeline\nwitness verify \\\n  --policy policy-signed.json \\\n  --publickey policy-key.pub \\\n  -a build.json -a test.json -a package.json\n```\n"}]}
{"messages": [{"role": "system", "content": "You are an expert in the Witness supply chain attestation framework. You help users instrument CI/CD pipelines with witness, create policy documents, and write Rego policies to validate attestations. You understand all attestors in go-witness and how to use them effectively."}, {"role": "user", "content": "How do I create a witness policy for a build step that uses these attestors: product, github, git, environment, material?"}, {"role": "assistant", "content": "Here's a complete witness policy for your build step with product, github, git, environment, material attestors:\n\n**Policy Document:**\n```json\n{\n  \"expires\": \"2026-11-08T10:52:59Z\",\n  \"publickeys\": {\n    \"build-key\": {\n      \"keyid\": \"sha256:dbb95fb63fd5234b3749cf9077eef15f84042cd707adb775e89256cc4b61824f\",\n      \"key\": \"-----BEGIN PUBLIC KEY-----\\n...\\n-----END PUBLIC KEY-----\"\n    }\n  },\n  \"steps\": {\n    \"build\": {\n      \"name\": \"build\",\n      \"attestations\": [\n        {\n          \"type\": \"https://witness.dev/attestations/product/v0.1\"\n        },\n        {\n          \"type\": \"https://witness.dev/attestations/github/v0.1\"\n        },\n        {\n          \"type\": \"https://witness.dev/attestations/git/v0.1\"\n        },\n        {\n          \"type\": \"https://witness.dev/attestations/environment/v0.1\"\n        },\n        {\n          \"type\": \"https://witness.dev/attestations/material/v0.1\"\n        }\n      ],\n      \"functionaries\": [\n        {\n          \"type\": \"publickey\",\n          \"publickeyid\": \"build-key\"\n        }\n      ]\n    }\n  }\n}\n```\n\n**Witness Run Command:**\n```bash\nwitness run --step build \\\n  --attestations product,github,git,environment,material \\\n  --outfile build-attestation.json \\\n  --key signing-key.pem \\\n  -- <your-build-command>\n```\n\n**Rego Validation Rules:**\n```rego\n\n```\n\n**Verification:**\n```bash\nwitness verify \\\n  --policy policy-signed.json \\\n  --publickey policy-key.pub \\\n  -a build-attestation.json \\\n  --subject <artifact>\n```\n"}]}
{"messages": [{"role": "system", "content": "You are an expert in the Witness supply chain attestation framework. You help users instrument CI/CD pipelines with witness, create policy documents, and write Rego policies to validate attestations. You understand all attestors in go-witness and how to use them effectively."}, {"role": "user", "content": "How do I create a witness policy for a build step that uses these attestors: product, environment, material?"}, {"role": "assistant", "content": "Here's a complete witness policy for your build step with product, environment, material attestors:\n\n**Policy Document:**\n```json\n{\n  \"expires\": \"2026-11-08T10:52:59Z\",\n  \"publickeys\": {\n    \"build-key\": {\n      \"keyid\": \"sha256:5f90d5094db9e8a2dea01bd2092121e48b8a2cb51d3256a75cff3c9ef877b13f\",\n      \"key\": \"-----BEGIN PUBLIC KEY-----\\n...\\n-----END PUBLIC KEY-----\"\n    }\n  },\n  \"steps\": {\n    \"build\": {\n      \"name\": \"build\",\n      \"attestations\": [\n        {\n          \"type\": \"https://witness.dev/attestations/product/v0.1\"\n        },\n        {\n          \"type\": \"https://witness.dev/attestations/environment/v0.1\"\n        },\n        {\n          \"type\": \"https://witness.dev/attestations/material/v0.1\"\n        }\n      ],\n      \"functionaries\": [\n        {\n          \"type\": \"publickey\",\n          \"publickeyid\": \"build-key\"\n        }\n      ]\n    }\n  }\n}\n```\n\n**Witness Run Command:**\n```bash\nwitness run --step build \\\n  --attestations product,environment,material \\\n  --outfile build-attestation.json \\\n  --key signing-key.pem \\\n  -- <your-build-command>\n```\n\n**Rego Validation Rules:**\n```rego\n\n```\n\n**Verification:**\n```bash\nwitness verify \\\n  --policy policy-signed.json \\\n  --publickey policy-key.pub \\\n  -a build-attestation.json \\\n  --subject <artifact>\n```\n"}]}
{"messages": [{"role": "system", "content": "You are an expert in the Witness supply chain attestation framework. You help users instrument CI/CD pipelines with witness, create policy documents, and write Rego policies to validate attestations. You understand all attestors in go-witness and how to use them effectively."}, {"role": "user", "content": "How do I create a multi-step witness policy for a build \u2192 test \u2192 package pipeline?"}, {"role": "assistant", "content": "Here's a complete multi-step witness policy for your pipeline:\n\n**Policy Document:**\n```json\n{\n  \"expires\": \"2026-11-08T10:52:59Z\",\n  \"publickeys\": {\n    \"ci-key\": {\n      \"keyid\": \"sha256:5e34d4c0b36d21816c2e4bb80a61617d0d336aae52b5a9cf4fdb71ff7ba11ec8\",\n      \"key\": \"-----BEGIN PUBLIC KEY-----\\n...\\n-----END PUBLIC KEY-----\"\n    }\n  },\n  \"steps\": {\n    \"build\": {\n      \"name\": \"build\",\n      \"attestations\": [\n        {\n          \"type\": \"https://witness.dev/attestations/git/v0.1\"\n        },\n        {\n          \"type\": \"https://witness.dev/attestations/command-run/v0.1\"\n        },\n        {\n          \"type\": \"https://witness.dev/attestations/product/v0.1\"\n        }\n      ],\n      \"functionaries\": [\n        {\n          \"type\": \"publickey\",\n          \"publickeyid\": \"ci-key\"\n        }\n      ]\n    },\n    \"test\": {\n      \"name\": \"test\",\n      \"attestations\": [\n        {\n          \"type\": \"https://witness.dev/attestations/material/v0.1\"\n        },\n        {\n          \"type\": \"https://witness.dev/attestations/command-run/v0.1\"\n        }\n      ],\n      \"functionaries\": [\n        {\n          \"type\": \"publickey\",\n          \"publickeyid\": \"ci-key\"\n        }\n      ]\n    },\n    \"package\": {\n      \"name\": \"package\",\n      \"attestations\": [\n        {\n          \"type\": \"https://witness.dev/attestations/material/v0.1\"\n        },\n        {\n          \"type\": \"https://witness.dev/attestations/product/v0.1\"\n        }\n      ],\n      \"functionaries\": [\n        {\n          \"type\": \"publickey\",\n          \"publickeyid\": \"ci-key\"\n        }\n      ]\n    }\n  }\n}\n```\n\n**Pipeline Commands:**\n\n```bash\n# Step 1: Build\nwitness run --step build \\\n  --attestations git,commandrun,product \\\n  -o build.json --key ci-key.pem \\\n  -- go build -o myapp\n\n# Step 2: Test\nwitness run --step test \\\n  --attestations material,commandrun \\\n  -o test.json --key ci-key.pem \\\n  -- go test ./...\n\n# Step 3: Package\nwitness run --step package \\\n  --attestations material,product \\\n  -o package.json --key ci-key.pem \\\n  -- tar czf myapp.tar.gz myapp\n\n# Verify entire pipeline\nwitness verify \\\n  --policy policy-signed.json \\\n  --publickey policy-key.pub \\\n  -a build.json -a test.json -a package.json\n```\n"}]}
{"messages": [{"role": "system", "content": "You are an expert in the Witness supply chain attestation framework. You help users instrument CI/CD pipelines with witness, create policy documents, and write Rego policies to validate attestations. You understand all attestors in go-witness and how to use them effectively."}, {"role": "user", "content": "How do I create a witness policy for a build step that uses these attestors: material, product, environment?"}, {"role": "assistant", "content": "Here's a complete witness policy for your build step with material, product, environment attestors:\n\n**Policy Document:**\n```json\n{\n  \"expires\": \"2026-11-08T10:52:59Z\",\n  \"publickeys\": {\n    \"build-key\": {\n      \"keyid\": \"sha256:372db3b47ef33c5786f239947c901f45eb5018a81a8cf06b167f7472d74865b7\",\n      \"key\": \"-----BEGIN PUBLIC KEY-----\\n...\\n-----END PUBLIC KEY-----\"\n    }\n  },\n  \"steps\": {\n    \"build\": {\n      \"name\": \"build\",\n      \"attestations\": [\n        {\n          \"type\": \"https://witness.dev/attestations/material/v0.1\"\n        },\n        {\n          \"type\": \"https://witness.dev/attestations/product/v0.1\"\n        },\n        {\n          \"type\": \"https://witness.dev/attestations/environment/v0.1\"\n        }\n      ],\n      \"functionaries\": [\n        {\n          \"type\": \"publickey\",\n          \"publickeyid\": \"build-key\"\n        }\n      ]\n    }\n  }\n}\n```\n\n**Witness Run Command:**\n```bash\nwitness run --step build \\\n  --attestations material,product,environment \\\n  --outfile build-attestation.json \\\n  --key signing-key.pem \\\n  -- <your-build-command>\n```\n\n**Rego Validation Rules:**\n```rego\n\n```\n\n**Verification:**\n```bash\nwitness verify \\\n  --policy policy-signed.json \\\n  --publickey policy-key.pub \\\n  -a build-attestation.json \\\n  --subject <artifact>\n```\n"}]}
{"messages": [{"role": "system", "content": "You are an expert in the Witness supply chain attestation framework. You help users instrument CI/CD pipelines with witness, create policy documents, and write Rego policies to validate attestations. You understand all attestors in go-witness and how to use them effectively."}, {"role": "user", "content": "How do I create a witness policy for a build step that uses these attestors: commandrun, github?"}, {"role": "assistant", "content": "Here's a complete witness policy for your build step with commandrun, github attestors:\n\n**Policy Document:**\n```json\n{\n  \"expires\": \"2026-11-08T10:52:59Z\",\n  \"publickeys\": {\n    \"build-key\": {\n      \"keyid\": \"sha256:e5a9da529d3ce55f311d98f1cb050646f6a33eb9864b06e8fd63e898b3343fce\",\n      \"key\": \"-----BEGIN PUBLIC KEY-----\\n...\\n-----END PUBLIC KEY-----\"\n    }\n  },\n  \"steps\": {\n    \"build\": {\n      \"name\": \"build\",\n      \"attestations\": [\n        {\n          \"type\": \"https://witness.dev/attestations/command-run/v0.1\"\n        },\n        {\n          \"type\": \"https://witness.dev/attestations/github/v0.1\"\n        }\n      ],\n      \"functionaries\": [\n        {\n          \"type\": \"publickey\",\n          \"publickeyid\": \"build-key\"\n        }\n      ]\n    }\n  }\n}\n```\n\n**Witness Run Command:**\n```bash\nwitness run --step build \\\n  --attestations commandrun,github \\\n  --outfile build-attestation.json \\\n  --key signing-key.pem \\\n  -- <your-build-command>\n```\n\n**Rego Validation Rules:**\n```rego\n\n```\n\n**Verification:**\n```bash\nwitness verify \\\n  --policy policy-signed.json \\\n  --publickey policy-key.pub \\\n  -a build-attestation.json \\\n  --subject <artifact>\n```\n"}]}
{"messages": [{"role": "system", "content": "You are an expert in the Witness supply chain attestation framework. You help users instrument CI/CD pipelines with witness, create policy documents, and write Rego policies to validate attestations. You understand all attestors in go-witness and how to use them effectively."}, {"role": "user", "content": "How do I create a witness policy for a build step that uses these attestors: material, product, git?"}, {"role": "assistant", "content": "Here's a complete witness policy for your build step with material, product, git attestors:\n\n**Policy Document:**\n```json\n{\n  \"expires\": \"2026-11-08T10:52:59Z\",\n  \"publickeys\": {\n    \"build-key\": {\n      \"keyid\": \"sha256:f2d1030743523c3114a7f293f6a9cb78e4e26ad29f68e2b165d59c7d26966059\",\n      \"key\": \"-----BEGIN PUBLIC KEY-----\\n...\\n-----END PUBLIC KEY-----\"\n    }\n  },\n  \"steps\": {\n    \"build\": {\n      \"name\": \"build\",\n      \"attestations\": [\n        {\n          \"type\": \"https://witness.dev/attestations/material/v0.1\"\n        },\n        {\n          \"type\": \"https://witness.dev/attestations/product/v0.1\"\n        },\n        {\n          \"type\": \"https://witness.dev/attestations/git/v0.1\"\n        }\n      ],\n      \"functionaries\": [\n        {\n          \"type\": \"publickey\",\n          \"publickeyid\": \"build-key\"\n        }\n      ]\n    }\n  }\n}\n```\n\n**Witness Run Command:**\n```bash\nwitness run --step build \\\n  --attestations material,product,git \\\n  --outfile build-attestation.json \\\n  --key signing-key.pem \\\n  -- <your-build-command>\n```\n\n**Rego Validation Rules:**\n```rego\n\n```\n\n**Verification:**\n```bash\nwitness verify \\\n  --policy policy-signed.json \\\n  --publickey policy-key.pub \\\n  -a build-attestation.json \\\n  --subject <artifact>\n```\n"}]}
{"messages": [{"role": "system", "content": "You are an expert in the Witness supply chain attestation framework. You help users instrument CI/CD pipelines with witness, create policy documents, and write Rego policies to validate attestations. You understand all attestors in go-witness and how to use them effectively."}, {"role": "user", "content": "How do I create a multi-step witness policy for a build \u2192 test \u2192 package pipeline?"}, {"role": "assistant", "content": "Here's a complete multi-step witness policy for your pipeline:\n\n**Policy Document:**\n```json\n{\n  \"expires\": \"2026-11-08T10:52:59Z\",\n  \"publickeys\": {\n    \"ci-key\": {\n      \"keyid\": \"sha256:38874eaf53d7f730f4a1de47e96d5dd63e7cd86ff25a1e19e3e12f583f6a06bb\",\n      \"key\": \"-----BEGIN PUBLIC KEY-----\\n...\\n-----END PUBLIC KEY-----\"\n    }\n  },\n  \"steps\": {\n    \"build\": {\n      \"name\": \"build\",\n      \"attestations\": [\n        {\n          \"type\": \"https://witness.dev/attestations/git/v0.1\"\n        },\n        {\n          \"type\": \"https://witness.dev/attestations/command-run/v0.1\"\n        },\n        {\n          \"type\": \"https://witness.dev/attestations/product/v0.1\"\n        }\n      ],\n      \"functionaries\": [\n        {\n          \"type\": \"publickey\",\n          \"publickeyid\": \"ci-key\"\n        }\n      ]\n    },\n    \"test\": {\n      \"name\": \"test\",\n      \"attestations\": [\n        {\n          \"type\": \"https://witness.dev/attestations/material/v0.1\"\n        },\n        {\n          \"type\": \"https://witness.dev/attestations/command-run/v0.1\"\n        }\n      ],\n      \"functionaries\": [\n        {\n          \"type\": \"publickey\",\n          \"publickeyid\": \"ci-key\"\n        }\n      ]\n    },\n    \"package\": {\n      \"name\": \"package\",\n      \"attestations\": [\n        {\n          \"type\": \"https://witness.dev/attestations/material/v0.1\"\n        },\n        {\n          \"type\": \"https://witness.dev/attestations/product/v0.1\"\n        }\n      ],\n      \"functionaries\": [\n        {\n          \"type\": \"publickey\",\n          \"publickeyid\": \"ci-key\"\n        }\n      ]\n    }\n  }\n}\n```\n\n**Pipeline Commands:**\n\n```bash\n# Step 1: Build\nwitness run --step build \\\n  --attestations git,commandrun,product \\\n  -o build.json --key ci-key.pem \\\n  -- go build -o myapp\n\n# Step 2: Test\nwitness run --step test \\\n  --attestations material,commandrun \\\n  -o test.json --key ci-key.pem \\\n  -- go test ./...\n\n# Step 3: Package\nwitness run --step package \\\n  --attestations material,product \\\n  -o package.json --key ci-key.pem \\\n  -- tar czf myapp.tar.gz myapp\n\n# Verify entire pipeline\nwitness verify \\\n  --policy policy-signed.json \\\n  --publickey policy-key.pub \\\n  -a build.json -a test.json -a package.json\n```\n"}]}
{"messages": [{"role": "system", "content": "You are an expert in the Witness supply chain attestation framework. You help users instrument CI/CD pipelines with witness, create policy documents, and write Rego policies to validate attestations. You understand all attestors in go-witness and how to use them effectively."}, {"role": "user", "content": "How do I create a multi-step witness policy for a build \u2192 test \u2192 package pipeline?"}, {"role": "assistant", "content": "Here's a complete multi-step witness policy for your pipeline:\n\n**Policy Document:**\n```json\n{\n  \"expires\": \"2026-11-08T10:52:59Z\",\n  \"publickeys\": {\n    \"ci-key\": {\n      \"keyid\": \"sha256:eba597ec2270e7e568a06ed591a61a255b554971b3c2e3b95027bf9a11062b39\",\n      \"key\": \"-----BEGIN PUBLIC KEY-----\\n...\\n-----END PUBLIC KEY-----\"\n    }\n  },\n  \"steps\": {\n    \"build\": {\n      \"name\": \"build\",\n      \"attestations\": [\n        {\n          \"type\": \"https://witness.dev/attestations/git/v0.1\"\n        },\n        {\n          \"type\": \"https://witness.dev/attestations/command-run/v0.1\"\n        },\n        {\n          \"type\": \"https://witness.dev/attestations/product/v0.1\"\n        }\n      ],\n      \"functionaries\": [\n        {\n          \"type\": \"publickey\",\n          \"publickeyid\": \"ci-key\"\n        }\n      ]\n    },\n    \"test\": {\n      \"name\": \"test\",\n      \"attestations\": [\n        {\n          \"type\": \"https://witness.dev/attestations/material/v0.1\"\n        },\n        {\n          \"type\": \"https://witness.dev/attestations/command-run/v0.1\"\n        }\n      ],\n      \"functionaries\": [\n        {\n          \"type\": \"publickey\",\n          \"publickeyid\": \"ci-key\"\n        }\n      ]\n    },\n    \"package\": {\n      \"name\": \"package\",\n      \"attestations\": [\n        {\n          \"type\": \"https://witness.dev/attestations/material/v0.1\"\n        },\n        {\n          \"type\": \"https://witness.dev/attestations/product/v0.1\"\n        }\n      ],\n      \"functionaries\": [\n        {\n          \"type\": \"publickey\",\n          \"publickeyid\": \"ci-key\"\n        }\n      ]\n    }\n  }\n}\n```\n\n**Pipeline Commands:**\n\n```bash\n# Step 1: Build\nwitness run --step build \\\n  --attestations git,commandrun,product \\\n  -o build.json --key ci-key.pem \\\n  -- go build -o myapp\n\n# Step 2: Test\nwitness run --step test \\\n  --attestations material,commandrun \\\n  -o test.json --key ci-key.pem \\\n  -- go test ./...\n\n# Step 3: Package\nwitness run --step package \\\n  --attestations material,product \\\n  -o package.json --key ci-key.pem \\\n  -- tar czf myapp.tar.gz myapp\n\n# Verify entire pipeline\nwitness verify \\\n  --policy policy-signed.json \\\n  --publickey policy-key.pub \\\n  -a build.json -a test.json -a package.json\n```\n"}]}
{"messages": [{"role": "system", "content": "You are an expert in the Witness supply chain attestation framework. You help users instrument CI/CD pipelines with witness, create policy documents, and write Rego policies to validate attestations. You understand all attestors in go-witness and how to use them effectively."}, {"role": "user", "content": "How do I create a multi-step witness policy for a build \u2192 test \u2192 package pipeline?"}, {"role": "assistant", "content": "Here's a complete multi-step witness policy for your pipeline:\n\n**Policy Document:**\n```json\n{\n  \"expires\": \"2026-11-08T10:52:59Z\",\n  \"publickeys\": {\n    \"ci-key\": {\n      \"keyid\": \"sha256:133a66c299d70da51840d5c5526e8f9bd10e8d198a8b5a48afa52600304be5be\",\n      \"key\": \"-----BEGIN PUBLIC KEY-----\\n...\\n-----END PUBLIC KEY-----\"\n    }\n  },\n  \"steps\": {\n    \"build\": {\n      \"name\": \"build\",\n      \"attestations\": [\n        {\n          \"type\": \"https://witness.dev/attestations/git/v0.1\"\n        },\n        {\n          \"type\": \"https://witness.dev/attestations/command-run/v0.1\"\n        },\n        {\n          \"type\": \"https://witness.dev/attestations/product/v0.1\"\n        }\n      ],\n      \"functionaries\": [\n        {\n          \"type\": \"publickey\",\n          \"publickeyid\": \"ci-key\"\n        }\n      ]\n    },\n    \"test\": {\n      \"name\": \"test\",\n      \"attestations\": [\n        {\n          \"type\": \"https://witness.dev/attestations/material/v0.1\"\n        },\n        {\n          \"type\": \"https://witness.dev/attestations/command-run/v0.1\"\n        }\n      ],\n      \"functionaries\": [\n        {\n          \"type\": \"publickey\",\n          \"publickeyid\": \"ci-key\"\n        }\n      ]\n    },\n    \"package\": {\n      \"name\": \"package\",\n      \"attestations\": [\n        {\n          \"type\": \"https://witness.dev/attestations/material/v0.1\"\n        },\n        {\n          \"type\": \"https://witness.dev/attestations/product/v0.1\"\n        }\n      ],\n      \"functionaries\": [\n        {\n          \"type\": \"publickey\",\n          \"publickeyid\": \"ci-key\"\n        }\n      ]\n    }\n  }\n}\n```\n\n**Pipeline Commands:**\n\n```bash\n# Step 1: Build\nwitness run --step build \\\n  --attestations git,commandrun,product \\\n  -o build.json --key ci-key.pem \\\n  -- go build -o myapp\n\n# Step 2: Test\nwitness run --step test \\\n  --attestations material,commandrun \\\n  -o test.json --key ci-key.pem \\\n  -- go test ./...\n\n# Step 3: Package\nwitness run --step package \\\n  --attestations material,product \\\n  -o package.json --key ci-key.pem \\\n  -- tar czf myapp.tar.gz myapp\n\n# Verify entire pipeline\nwitness verify \\\n  --policy policy-signed.json \\\n  --publickey policy-key.pub \\\n  -a build.json -a test.json -a package.json\n```\n"}]}
{"messages": [{"role": "system", "content": "You are an expert in the Witness supply chain attestation framework. You help users instrument CI/CD pipelines with witness, create policy documents, and write Rego policies to validate attestations. You understand all attestors in go-witness and how to use them effectively."}, {"role": "user", "content": "How do I create a multi-step witness policy for a build \u2192 test \u2192 package pipeline?"}, {"role": "assistant", "content": "Here's a complete multi-step witness policy for your pipeline:\n\n**Policy Document:**\n```json\n{\n  \"expires\": \"2026-11-08T10:52:59Z\",\n  \"publickeys\": {\n    \"ci-key\": {\n      \"keyid\": \"sha256:7dab321f2eaa5b434b7447633826c7d8a9b860ad8bb342a298674d317797a0fb\",\n      \"key\": \"-----BEGIN PUBLIC KEY-----\\n...\\n-----END PUBLIC KEY-----\"\n    }\n  },\n  \"steps\": {\n    \"build\": {\n      \"name\": \"build\",\n      \"attestations\": [\n        {\n          \"type\": \"https://witness.dev/attestations/git/v0.1\"\n        },\n        {\n          \"type\": \"https://witness.dev/attestations/command-run/v0.1\"\n        },\n        {\n          \"type\": \"https://witness.dev/attestations/product/v0.1\"\n        }\n      ],\n      \"functionaries\": [\n        {\n          \"type\": \"publickey\",\n          \"publickeyid\": \"ci-key\"\n        }\n      ]\n    },\n    \"test\": {\n      \"name\": \"test\",\n      \"attestations\": [\n        {\n          \"type\": \"https://witness.dev/attestations/material/v0.1\"\n        },\n        {\n          \"type\": \"https://witness.dev/attestations/command-run/v0.1\"\n        }\n      ],\n      \"functionaries\": [\n        {\n          \"type\": \"publickey\",\n          \"publickeyid\": \"ci-key\"\n        }\n      ]\n    },\n    \"package\": {\n      \"name\": \"package\",\n      \"attestations\": [\n        {\n          \"type\": \"https://witness.dev/attestations/material/v0.1\"\n        },\n        {\n          \"type\": \"https://witness.dev/attestations/product/v0.1\"\n        }\n      ],\n      \"functionaries\": [\n        {\n          \"type\": \"publickey\",\n          \"publickeyid\": \"ci-key\"\n        }\n      ]\n    }\n  }\n}\n```\n\n**Pipeline Commands:**\n\n```bash\n# Step 1: Build\nwitness run --step build \\\n  --attestations git,commandrun,product \\\n  -o build.json --key ci-key.pem \\\n  -- go build -o myapp\n\n# Step 2: Test\nwitness run --step test \\\n  --attestations material,commandrun \\\n  -o test.json --key ci-key.pem \\\n  -- go test ./...\n\n# Step 3: Package\nwitness run --step package \\\n  --attestations material,product \\\n  -o package.json --key ci-key.pem \\\n  -- tar czf myapp.tar.gz myapp\n\n# Verify entire pipeline\nwitness verify \\\n  --policy policy-signed.json \\\n  --publickey policy-key.pub \\\n  -a build.json -a test.json -a package.json\n```\n"}]}
{"messages": [{"role": "system", "content": "You are an expert in the Witness supply chain attestation framework. You help users instrument CI/CD pipelines with witness, create policy documents, and write Rego policies to validate attestations. You understand all attestors in go-witness and how to use them effectively."}, {"role": "user", "content": "How do I create a witness policy for a build step that uses these attestors: git, material?"}, {"role": "assistant", "content": "Here's a complete witness policy for your build step with git, material attestors:\n\n**Policy Document:**\n```json\n{\n  \"expires\": \"2026-11-08T10:52:59Z\",\n  \"publickeys\": {\n    \"build-key\": {\n      \"keyid\": \"sha256:45835866337306d4c58ead9f3c14b7a0eb2698658adbab81b5001ad2e3ab48fe\",\n      \"key\": \"-----BEGIN PUBLIC KEY-----\\n...\\n-----END PUBLIC KEY-----\"\n    }\n  },\n  \"steps\": {\n    \"build\": {\n      \"name\": \"build\",\n      \"attestations\": [\n        {\n          \"type\": \"https://witness.dev/attestations/git/v0.1\"\n        },\n        {\n          \"type\": \"https://witness.dev/attestations/material/v0.1\"\n        }\n      ],\n      \"functionaries\": [\n        {\n          \"type\": \"publickey\",\n          \"publickeyid\": \"build-key\"\n        }\n      ]\n    }\n  }\n}\n```\n\n**Witness Run Command:**\n```bash\nwitness run --step build \\\n  --attestations git,material \\\n  --outfile build-attestation.json \\\n  --key signing-key.pem \\\n  -- <your-build-command>\n```\n\n**Rego Validation Rules:**\n```rego\npackage git\n\nimport rego.v1\n\n# Enforce builds from specific branch\ndeny contains msg if {\n    input.branch != \"feature/auth\"\n    msg := sprintf(\"Must build from feature/auth branch, got: %s\", [input.branch])\n}\n\n# Require clean working directory\ndeny contains msg if {\n    count(input.status) > 0\n    msg := \"Working directory must be clean (no uncommitted changes)\"\n}\n\n# Validate commit author\napproved_authors := {\n    \"alice.smith@example.com\",\n    \"bob.jones@company.com\",\n    \"ci-bot@company.com\"\n}\n\ndeny contains msg if {\n    not input.authoremail in approved_authors\n    msg := sprintf(\"Unauthorized commit author: %s\", [input.authoremail])\n}\n```\n\n**Verification:**\n```bash\nwitness verify \\\n  --policy policy-signed.json \\\n  --publickey policy-key.pub \\\n  -a build-attestation.json \\\n  --subject <artifact>\n```\n"}]}
{"messages": [{"role": "system", "content": "You are an expert in the Witness supply chain attestation framework. You help users instrument CI/CD pipelines with witness, create policy documents, and write Rego policies to validate attestations. You understand all attestors in go-witness and how to use them effectively."}, {"role": "user", "content": "How do I create a witness policy for a build step that uses these attestors: git, product?"}, {"role": "assistant", "content": "Here's a complete witness policy for your build step with git, product attestors:\n\n**Policy Document:**\n```json\n{\n  \"expires\": \"2026-11-08T10:52:59Z\",\n  \"publickeys\": {\n    \"build-key\": {\n      \"keyid\": \"sha256:a09ab4bc21f0c1a175991041fb2736517b368ca1e80da7bcc5d054dc19bc294d\",\n      \"key\": \"-----BEGIN PUBLIC KEY-----\\n...\\n-----END PUBLIC KEY-----\"\n    }\n  },\n  \"steps\": {\n    \"build\": {\n      \"name\": \"build\",\n      \"attestations\": [\n        {\n          \"type\": \"https://witness.dev/attestations/git/v0.1\"\n        },\n        {\n          \"type\": \"https://witness.dev/attestations/product/v0.1\"\n        }\n      ],\n      \"functionaries\": [\n        {\n          \"type\": \"publickey\",\n          \"publickeyid\": \"build-key\"\n        }\n      ]\n    }\n  }\n}\n```\n\n**Witness Run Command:**\n```bash\nwitness run --step build \\\n  --attestations git,product \\\n  --outfile build-attestation.json \\\n  --key signing-key.pem \\\n  -- <your-build-command>\n```\n\n**Rego Validation Rules:**\n```rego\npackage git\n\nimport rego.v1\n\n# Enforce builds from specific branch\ndeny contains msg if {\n    input.branch != \"bugfix/security\"\n    msg := sprintf(\"Must build from bugfix/security branch, got: %s\", [input.branch])\n}\n\n# Require clean working directory\ndeny contains msg if {\n    count(input.status) > 0\n    msg := \"Working directory must be clean (no uncommitted changes)\"\n}\n\n# Validate commit author\napproved_authors := {\n    \"alice.smith@example.com\",\n    \"bob.jones@company.com\",\n    \"ci-bot@company.com\"\n}\n\ndeny contains msg if {\n    not input.authoremail in approved_authors\n    msg := sprintf(\"Unauthorized commit author: %s\", [input.authoremail])\n}\n```\n\n**Verification:**\n```bash\nwitness verify \\\n  --policy policy-signed.json \\\n  --publickey policy-key.pub \\\n  -a build-attestation.json \\\n  --subject <artifact>\n```\n"}]}
{"messages": [{"role": "system", "content": "You are an expert in the Witness supply chain attestation framework. You help users instrument CI/CD pipelines with witness, create policy documents, and write Rego policies to validate attestations. You understand all attestors in go-witness and how to use them effectively."}, {"role": "user", "content": "How do I create a witness policy for a build step that uses these attestors: github?"}, {"role": "assistant", "content": "Here's a complete witness policy for your build step with github attestors:\n\n**Policy Document:**\n```json\n{\n  \"expires\": \"2026-11-08T10:52:59Z\",\n  \"publickeys\": {\n    \"build-key\": {\n      \"keyid\": \"sha256:809ab07cb396e966827b29125ac5a719ec2f065ed7279271b6f48d21bba816d9\",\n      \"key\": \"-----BEGIN PUBLIC KEY-----\\n...\\n-----END PUBLIC KEY-----\"\n    }\n  },\n  \"steps\": {\n    \"build\": {\n      \"name\": \"build\",\n      \"attestations\": [\n        {\n          \"type\": \"https://witness.dev/attestations/github/v0.1\"\n        }\n      ],\n      \"functionaries\": [\n        {\n          \"type\": \"publickey\",\n          \"publickeyid\": \"build-key\"\n        }\n      ]\n    }\n  }\n}\n```\n\n**Witness Run Command:**\n```bash\nwitness run --step build \\\n  --attestations github \\\n  --outfile build-attestation.json \\\n  --key signing-key.pem \\\n  -- <your-build-command>\n```\n\n**Rego Validation Rules:**\n```rego\n\n```\n\n**Verification:**\n```bash\nwitness verify \\\n  --policy policy-signed.json \\\n  --publickey policy-key.pub \\\n  -a build-attestation.json \\\n  --subject <artifact>\n```\n"}]}
{"messages": [{"role": "system", "content": "You are an expert in the Witness supply chain attestation framework. You help users instrument CI/CD pipelines with witness, create policy documents, and write Rego policies to validate attestations. You understand all attestors in go-witness and how to use them effectively."}, {"role": "user", "content": "How do I create a multi-step witness policy for a build \u2192 test \u2192 package pipeline?"}, {"role": "assistant", "content": "Here's a complete multi-step witness policy for your pipeline:\n\n**Policy Document:**\n```json\n{\n  \"expires\": \"2026-11-08T10:52:59Z\",\n  \"publickeys\": {\n    \"ci-key\": {\n      \"keyid\": \"sha256:2512d7a2162c143630fa147729179149733320d3f288d9a191ef904c5767b884\",\n      \"key\": \"-----BEGIN PUBLIC KEY-----\\n...\\n-----END PUBLIC KEY-----\"\n    }\n  },\n  \"steps\": {\n    \"build\": {\n      \"name\": \"build\",\n      \"attestations\": [\n        {\n          \"type\": \"https://witness.dev/attestations/git/v0.1\"\n        },\n        {\n          \"type\": \"https://witness.dev/attestations/command-run/v0.1\"\n        },\n        {\n          \"type\": \"https://witness.dev/attestations/product/v0.1\"\n        }\n      ],\n      \"functionaries\": [\n        {\n          \"type\": \"publickey\",\n          \"publickeyid\": \"ci-key\"\n        }\n      ]\n    },\n    \"test\": {\n      \"name\": \"test\",\n      \"attestations\": [\n        {\n          \"type\": \"https://witness.dev/attestations/material/v0.1\"\n        },\n        {\n          \"type\": \"https://witness.dev/attestations/command-run/v0.1\"\n        }\n      ],\n      \"functionaries\": [\n        {\n          \"type\": \"publickey\",\n          \"publickeyid\": \"ci-key\"\n        }\n      ]\n    },\n    \"package\": {\n      \"name\": \"package\",\n      \"attestations\": [\n        {\n          \"type\": \"https://witness.dev/attestations/material/v0.1\"\n        },\n        {\n          \"type\": \"https://witness.dev/attestations/product/v0.1\"\n        }\n      ],\n      \"functionaries\": [\n        {\n          \"type\": \"publickey\",\n          \"publickeyid\": \"ci-key\"\n        }\n      ]\n    }\n  }\n}\n```\n\n**Pipeline Commands:**\n\n```bash\n# Step 1: Build\nwitness run --step build \\\n  --attestations git,commandrun,product \\\n  -o build.json --key ci-key.pem \\\n  -- go build -o myapp\n\n# Step 2: Test\nwitness run --step test \\\n  --attestations material,commandrun \\\n  -o test.json --key ci-key.pem \\\n  -- go test ./...\n\n# Step 3: Package\nwitness run --step package \\\n  --attestations material,product \\\n  -o package.json --key ci-key.pem \\\n  -- tar czf myapp.tar.gz myapp\n\n# Verify entire pipeline\nwitness verify \\\n  --policy policy-signed.json \\\n  --publickey policy-key.pub \\\n  -a build.json -a test.json -a package.json\n```\n"}]}
{"messages": [{"role": "system", "content": "You are an expert in the Witness supply chain attestation framework. You help users instrument CI/CD pipelines with witness, create policy documents, and write Rego policies to validate attestations. You understand all attestors in go-witness and how to use them effectively."}, {"role": "user", "content": "How do I create a witness policy for a build step that uses these attestors: environment, commandrun, git?"}, {"role": "assistant", "content": "Here's a complete witness policy for your build step with environment, commandrun, git attestors:\n\n**Policy Document:**\n```json\n{\n  \"expires\": \"2026-11-08T10:52:59Z\",\n  \"publickeys\": {\n    \"build-key\": {\n      \"keyid\": \"sha256:e74f298d91ca146a0623103a4c468a7564d3010eac42fb44403ebd9dccf10927\",\n      \"key\": \"-----BEGIN PUBLIC KEY-----\\n...\\n-----END PUBLIC KEY-----\"\n    }\n  },\n  \"steps\": {\n    \"build\": {\n      \"name\": \"build\",\n      \"attestations\": [\n        {\n          \"type\": \"https://witness.dev/attestations/environment/v0.1\"\n        },\n        {\n          \"type\": \"https://witness.dev/attestations/command-run/v0.1\"\n        },\n        {\n          \"type\": \"https://witness.dev/attestations/git/v0.1\"\n        }\n      ],\n      \"functionaries\": [\n        {\n          \"type\": \"publickey\",\n          \"publickeyid\": \"build-key\"\n        }\n      ]\n    }\n  }\n}\n```\n\n**Witness Run Command:**\n```bash\nwitness run --step build \\\n  --attestations environment,commandrun,git \\\n  --outfile build-attestation.json \\\n  --key signing-key.pem \\\n  -- <your-build-command>\n```\n\n**Rego Validation Rules:**\n```rego\npackage environment\n\nimport rego.v1\n\n# Ensure correct OS\ndeny contains msg if {\n    input.os != \"windows\"\n    msg := sprintf(\"Must run on windows, got: %s\", [input.os])\n}\n\n# Require CI environment\ndeny contains msg if {\n    not \"CI\" in input.variables\n    msg := \"Must run in CI environment (CI variable not set)\"\n}\n```\n\n**Verification:**\n```bash\nwitness verify \\\n  --policy policy-signed.json \\\n  --publickey policy-key.pub \\\n  -a build-attestation.json \\\n  --subject <artifact>\n```\n"}]}
{"messages": [{"role": "system", "content": "You are an expert in the Witness supply chain attestation framework. You help users instrument CI/CD pipelines with witness, create policy documents, and write Rego policies to validate attestations. You understand all attestors in go-witness and how to use them effectively."}, {"role": "user", "content": "How do I create a witness policy for a build step that uses these attestors: git, github, material, environment?"}, {"role": "assistant", "content": "Here's a complete witness policy for your build step with git, github, material, environment attestors:\n\n**Policy Document:**\n```json\n{\n  \"expires\": \"2026-11-08T10:52:59Z\",\n  \"publickeys\": {\n    \"build-key\": {\n      \"keyid\": \"sha256:b9fa6e45e20bf1a3edc1cf8b930cc2a97a8c545af3c3d33a7ae4922a76e68012\",\n      \"key\": \"-----BEGIN PUBLIC KEY-----\\n...\\n-----END PUBLIC KEY-----\"\n    }\n  },\n  \"steps\": {\n    \"build\": {\n      \"name\": \"build\",\n      \"attestations\": [\n        {\n          \"type\": \"https://witness.dev/attestations/git/v0.1\"\n        },\n        {\n          \"type\": \"https://witness.dev/attestations/github/v0.1\"\n        },\n        {\n          \"type\": \"https://witness.dev/attestations/material/v0.1\"\n        },\n        {\n          \"type\": \"https://witness.dev/attestations/environment/v0.1\"\n        }\n      ],\n      \"functionaries\": [\n        {\n          \"type\": \"publickey\",\n          \"publickeyid\": \"build-key\"\n        }\n      ]\n    }\n  }\n}\n```\n\n**Witness Run Command:**\n```bash\nwitness run --step build \\\n  --attestations git,github,material,environment \\\n  --outfile build-attestation.json \\\n  --key signing-key.pem \\\n  -- <your-build-command>\n```\n\n**Rego Validation Rules:**\n```rego\npackage git\n\nimport rego.v1\n\n# Enforce builds from specific branch\ndeny contains msg if {\n    input.branch != \"develop\"\n    msg := sprintf(\"Must build from develop branch, got: %s\", [input.branch])\n}\n\n# Require clean working directory\ndeny contains msg if {\n    count(input.status) > 0\n    msg := \"Working directory must be clean (no uncommitted changes)\"\n}\n\n# Validate commit author\napproved_authors := {\n    \"alice.smith@example.com\",\n    \"bob.jones@company.com\",\n    \"ci-bot@company.com\"\n}\n\ndeny contains msg if {\n    not input.authoremail in approved_authors\n    msg := sprintf(\"Unauthorized commit author: %s\", [input.authoremail])\n}\n```\n\n**Verification:**\n```bash\nwitness verify \\\n  --policy policy-signed.json \\\n  --publickey policy-key.pub \\\n  -a build-attestation.json \\\n  --subject <artifact>\n```\n"}]}
{"messages": [{"role": "system", "content": "You are an expert in the Witness supply chain attestation framework. You help users instrument CI/CD pipelines with witness, create policy documents, and write Rego policies to validate attestations. You understand all attestors in go-witness and how to use them effectively."}, {"role": "user", "content": "How do I create a multi-step witness policy for a build \u2192 test \u2192 package pipeline?"}, {"role": "assistant", "content": "Here's a complete multi-step witness policy for your pipeline:\n\n**Policy Document:**\n```json\n{\n  \"expires\": \"2026-11-08T10:52:59Z\",\n  \"publickeys\": {\n    \"ci-key\": {\n      \"keyid\": \"sha256:56a78b494d3275869b565f2e8580aaea3a30415a6484fdd3dec6df5b758c386c\",\n      \"key\": \"-----BEGIN PUBLIC KEY-----\\n...\\n-----END PUBLIC KEY-----\"\n    }\n  },\n  \"steps\": {\n    \"build\": {\n      \"name\": \"build\",\n      \"attestations\": [\n        {\n          \"type\": \"https://witness.dev/attestations/git/v0.1\"\n        },\n        {\n          \"type\": \"https://witness.dev/attestations/command-run/v0.1\"\n        },\n        {\n          \"type\": \"https://witness.dev/attestations/product/v0.1\"\n        }\n      ],\n      \"functionaries\": [\n        {\n          \"type\": \"publickey\",\n          \"publickeyid\": \"ci-key\"\n        }\n      ]\n    },\n    \"test\": {\n      \"name\": \"test\",\n      \"attestations\": [\n        {\n          \"type\": \"https://witness.dev/attestations/material/v0.1\"\n        },\n        {\n          \"type\": \"https://witness.dev/attestations/command-run/v0.1\"\n        }\n      ],\n      \"functionaries\": [\n        {\n          \"type\": \"publickey\",\n          \"publickeyid\": \"ci-key\"\n        }\n      ]\n    },\n    \"package\": {\n      \"name\": \"package\",\n      \"attestations\": [\n        {\n          \"type\": \"https://witness.dev/attestations/material/v0.1\"\n        },\n        {\n          \"type\": \"https://witness.dev/attestations/product/v0.1\"\n        }\n      ],\n      \"functionaries\": [\n        {\n          \"type\": \"publickey\",\n          \"publickeyid\": \"ci-key\"\n        }\n      ]\n    }\n  }\n}\n```\n\n**Pipeline Commands:**\n\n```bash\n# Step 1: Build\nwitness run --step build \\\n  --attestations git,commandrun,product \\\n  -o build.json --key ci-key.pem \\\n  -- go build -o myapp\n\n# Step 2: Test\nwitness run --step test \\\n  --attestations material,commandrun \\\n  -o test.json --key ci-key.pem \\\n  -- go test ./...\n\n# Step 3: Package\nwitness run --step package \\\n  --attestations material,product \\\n  -o package.json --key ci-key.pem \\\n  -- tar czf myapp.tar.gz myapp\n\n# Verify entire pipeline\nwitness verify \\\n  --policy policy-signed.json \\\n  --publickey policy-key.pub \\\n  -a build.json -a test.json -a package.json\n```\n"}]}
{"messages": [{"role": "system", "content": "You are an expert in the Witness supply chain attestation framework. You help users instrument CI/CD pipelines with witness, create policy documents, and write Rego policies to validate attestations. You understand all attestors in go-witness and how to use them effectively."}, {"role": "user", "content": "How do I create a witness policy for a build step that uses these attestors: github, environment, product, git?"}, {"role": "assistant", "content": "Here's a complete witness policy for your build step with github, environment, product, git attestors:\n\n**Policy Document:**\n```json\n{\n  \"expires\": \"2026-11-08T10:52:59Z\",\n  \"publickeys\": {\n    \"build-key\": {\n      \"keyid\": \"sha256:da23d8aaa96cbaa0043637c01e36b5abc9e8f179af9324f722f211d4f54b8693\",\n      \"key\": \"-----BEGIN PUBLIC KEY-----\\n...\\n-----END PUBLIC KEY-----\"\n    }\n  },\n  \"steps\": {\n    \"build\": {\n      \"name\": \"build\",\n      \"attestations\": [\n        {\n          \"type\": \"https://witness.dev/attestations/github/v0.1\"\n        },\n        {\n          \"type\": \"https://witness.dev/attestations/environment/v0.1\"\n        },\n        {\n          \"type\": \"https://witness.dev/attestations/product/v0.1\"\n        },\n        {\n          \"type\": \"https://witness.dev/attestations/git/v0.1\"\n        }\n      ],\n      \"functionaries\": [\n        {\n          \"type\": \"publickey\",\n          \"publickeyid\": \"build-key\"\n        }\n      ]\n    }\n  }\n}\n```\n\n**Witness Run Command:**\n```bash\nwitness run --step build \\\n  --attestations github,environment,product,git \\\n  --outfile build-attestation.json \\\n  --key signing-key.pem \\\n  -- <your-build-command>\n```\n\n**Rego Validation Rules:**\n```rego\n\n```\n\n**Verification:**\n```bash\nwitness verify \\\n  --policy policy-signed.json \\\n  --publickey policy-key.pub \\\n  -a build-attestation.json \\\n  --subject <artifact>\n```\n"}]}
{"messages": [{"role": "system", "content": "You are an expert in the Witness supply chain attestation framework. You help users instrument CI/CD pipelines with witness, create policy documents, and write Rego policies to validate attestations. You understand all attestors in go-witness and how to use them effectively."}, {"role": "user", "content": "How do I create a multi-step witness policy for a build \u2192 test \u2192 package pipeline?"}, {"role": "assistant", "content": "Here's a complete multi-step witness policy for your pipeline:\n\n**Policy Document:**\n```json\n{\n  \"expires\": \"2026-11-08T10:52:59Z\",\n  \"publickeys\": {\n    \"ci-key\": {\n      \"keyid\": \"sha256:c7823d6d2f2d3fce04e632f0875f4f09760e90db8e26f8e33c85593d99971151\",\n      \"key\": \"-----BEGIN PUBLIC KEY-----\\n...\\n-----END PUBLIC KEY-----\"\n    }\n  },\n  \"steps\": {\n    \"build\": {\n      \"name\": \"build\",\n      \"attestations\": [\n        {\n          \"type\": \"https://witness.dev/attestations/git/v0.1\"\n        },\n        {\n          \"type\": \"https://witness.dev/attestations/command-run/v0.1\"\n        },\n        {\n          \"type\": \"https://witness.dev/attestations/product/v0.1\"\n        }\n      ],\n      \"functionaries\": [\n        {\n          \"type\": \"publickey\",\n          \"publickeyid\": \"ci-key\"\n        }\n      ]\n    },\n    \"test\": {\n      \"name\": \"test\",\n      \"attestations\": [\n        {\n          \"type\": \"https://witness.dev/attestations/material/v0.1\"\n        },\n        {\n          \"type\": \"https://witness.dev/attestations/command-run/v0.1\"\n        }\n      ],\n      \"functionaries\": [\n        {\n          \"type\": \"publickey\",\n          \"publickeyid\": \"ci-key\"\n        }\n      ]\n    },\n    \"package\": {\n      \"name\": \"package\",\n      \"attestations\": [\n        {\n          \"type\": \"https://witness.dev/attestations/material/v0.1\"\n        },\n        {\n          \"type\": \"https://witness.dev/attestations/product/v0.1\"\n        }\n      ],\n      \"functionaries\": [\n        {\n          \"type\": \"publickey\",\n          \"publickeyid\": \"ci-key\"\n        }\n      ]\n    }\n  }\n}\n```\n\n**Pipeline Commands:**\n\n```bash\n# Step 1: Build\nwitness run --step build \\\n  --attestations git,commandrun,product \\\n  -o build.json --key ci-key.pem \\\n  -- go build -o myapp\n\n# Step 2: Test\nwitness run --step test \\\n  --attestations material,commandrun \\\n  -o test.json --key ci-key.pem \\\n  -- go test ./...\n\n# Step 3: Package\nwitness run --step package \\\n  --attestations material,product \\\n  -o package.json --key ci-key.pem \\\n  -- tar czf myapp.tar.gz myapp\n\n# Verify entire pipeline\nwitness verify \\\n  --policy policy-signed.json \\\n  --publickey policy-key.pub \\\n  -a build.json -a test.json -a package.json\n```\n"}]}
{"messages": [{"role": "system", "content": "You are an expert in the Witness supply chain attestation framework. You help users instrument CI/CD pipelines with witness, create policy documents, and write Rego policies to validate attestations. You understand all attestors in go-witness and how to use them effectively."}, {"role": "user", "content": "How do I create a multi-step witness policy for a build \u2192 test \u2192 package pipeline?"}, {"role": "assistant", "content": "Here's a complete multi-step witness policy for your pipeline:\n\n**Policy Document:**\n```json\n{\n  \"expires\": \"2026-11-08T10:52:59Z\",\n  \"publickeys\": {\n    \"ci-key\": {\n      \"keyid\": \"sha256:87ceb650372b9c20855036266b32612cee5519d66acbf46862a9370089adf7ae\",\n      \"key\": \"-----BEGIN PUBLIC KEY-----\\n...\\n-----END PUBLIC KEY-----\"\n    }\n  },\n  \"steps\": {\n    \"build\": {\n      \"name\": \"build\",\n      \"attestations\": [\n        {\n          \"type\": \"https://witness.dev/attestations/git/v0.1\"\n        },\n        {\n          \"type\": \"https://witness.dev/attestations/command-run/v0.1\"\n        },\n        {\n          \"type\": \"https://witness.dev/attestations/product/v0.1\"\n        }\n      ],\n      \"functionaries\": [\n        {\n          \"type\": \"publickey\",\n          \"publickeyid\": \"ci-key\"\n        }\n      ]\n    },\n    \"test\": {\n      \"name\": \"test\",\n      \"attestations\": [\n        {\n          \"type\": \"https://witness.dev/attestations/material/v0.1\"\n        },\n        {\n          \"type\": \"https://witness.dev/attestations/command-run/v0.1\"\n        }\n      ],\n      \"functionaries\": [\n        {\n          \"type\": \"publickey\",\n          \"publickeyid\": \"ci-key\"\n        }\n      ]\n    },\n    \"package\": {\n      \"name\": \"package\",\n      \"attestations\": [\n        {\n          \"type\": \"https://witness.dev/attestations/material/v0.1\"\n        },\n        {\n          \"type\": \"https://witness.dev/attestations/product/v0.1\"\n        }\n      ],\n      \"functionaries\": [\n        {\n          \"type\": \"publickey\",\n          \"publickeyid\": \"ci-key\"\n        }\n      ]\n    }\n  }\n}\n```\n\n**Pipeline Commands:**\n\n```bash\n# Step 1: Build\nwitness run --step build \\\n  --attestations git,commandrun,product \\\n  -o build.json --key ci-key.pem \\\n  -- go build -o myapp\n\n# Step 2: Test\nwitness run --step test \\\n  --attestations material,commandrun \\\n  -o test.json --key ci-key.pem \\\n  -- go test ./...\n\n# Step 3: Package\nwitness run --step package \\\n  --attestations material,product \\\n  -o package.json --key ci-key.pem \\\n  -- tar czf myapp.tar.gz myapp\n\n# Verify entire pipeline\nwitness verify \\\n  --policy policy-signed.json \\\n  --publickey policy-key.pub \\\n  -a build.json -a test.json -a package.json\n```\n"}]}
{"messages": [{"role": "system", "content": "You are an expert in the Witness supply chain attestation framework. You help users instrument CI/CD pipelines with witness, create policy documents, and write Rego policies to validate attestations. You understand all attestors in go-witness and how to use them effectively."}, {"role": "user", "content": "How do I create a multi-step witness policy for a build \u2192 test \u2192 package pipeline?"}, {"role": "assistant", "content": "Here's a complete multi-step witness policy for your pipeline:\n\n**Policy Document:**\n```json\n{\n  \"expires\": \"2026-11-08T10:52:59Z\",\n  \"publickeys\": {\n    \"ci-key\": {\n      \"keyid\": \"sha256:d34d5d34b6a7b34f5868cda83eec0fe6e894e5895f33358181bec4c072303bd8\",\n      \"key\": \"-----BEGIN PUBLIC KEY-----\\n...\\n-----END PUBLIC KEY-----\"\n    }\n  },\n  \"steps\": {\n    \"build\": {\n      \"name\": \"build\",\n      \"attestations\": [\n        {\n          \"type\": \"https://witness.dev/attestations/git/v0.1\"\n        },\n        {\n          \"type\": \"https://witness.dev/attestations/command-run/v0.1\"\n        },\n        {\n          \"type\": \"https://witness.dev/attestations/product/v0.1\"\n        }\n      ],\n      \"functionaries\": [\n        {\n          \"type\": \"publickey\",\n          \"publickeyid\": \"ci-key\"\n        }\n      ]\n    },\n    \"test\": {\n      \"name\": \"test\",\n      \"attestations\": [\n        {\n          \"type\": \"https://witness.dev/attestations/material/v0.1\"\n        },\n        {\n          \"type\": \"https://witness.dev/attestations/command-run/v0.1\"\n        }\n      ],\n      \"functionaries\": [\n        {\n          \"type\": \"publickey\",\n          \"publickeyid\": \"ci-key\"\n        }\n      ]\n    },\n    \"package\": {\n      \"name\": \"package\",\n      \"attestations\": [\n        {\n          \"type\": \"https://witness.dev/attestations/material/v0.1\"\n        },\n        {\n          \"type\": \"https://witness.dev/attestations/product/v0.1\"\n        }\n      ],\n      \"functionaries\": [\n        {\n          \"type\": \"publickey\",\n          \"publickeyid\": \"ci-key\"\n        }\n      ]\n    }\n  }\n}\n```\n\n**Pipeline Commands:**\n\n```bash\n# Step 1: Build\nwitness run --step build \\\n  --attestations git,commandrun,product \\\n  -o build.json --key ci-key.pem \\\n  -- go build -o myapp\n\n# Step 2: Test\nwitness run --step test \\\n  --attestations material,commandrun \\\n  -o test.json --key ci-key.pem \\\n  -- go test ./...\n\n# Step 3: Package\nwitness run --step package \\\n  --attestations material,product \\\n  -o package.json --key ci-key.pem \\\n  -- tar czf myapp.tar.gz myapp\n\n# Verify entire pipeline\nwitness verify \\\n  --policy policy-signed.json \\\n  --publickey policy-key.pub \\\n  -a build.json -a test.json -a package.json\n```\n"}]}
{"messages": [{"role": "system", "content": "You are an expert in the Witness supply chain attestation framework. You help users instrument CI/CD pipelines with witness, create policy documents, and write Rego policies to validate attestations. You understand all attestors in go-witness and how to use them effectively."}, {"role": "user", "content": "How do I create a witness policy for a build step that uses these attestors: git?"}, {"role": "assistant", "content": "Here's a complete witness policy for your build step with git attestors:\n\n**Policy Document:**\n```json\n{\n  \"expires\": \"2026-11-08T10:52:59Z\",\n  \"publickeys\": {\n    \"build-key\": {\n      \"keyid\": \"sha256:3ebfcac0034512b95f146dbd6c0c4f620f999ff59542fcf4043bbc21d2f0b95e\",\n      \"key\": \"-----BEGIN PUBLIC KEY-----\\n...\\n-----END PUBLIC KEY-----\"\n    }\n  },\n  \"steps\": {\n    \"build\": {\n      \"name\": \"build\",\n      \"attestations\": [\n        {\n          \"type\": \"https://witness.dev/attestations/git/v0.1\"\n        }\n      ],\n      \"functionaries\": [\n        {\n          \"type\": \"publickey\",\n          \"publickeyid\": \"build-key\"\n        }\n      ]\n    }\n  }\n}\n```\n\n**Witness Run Command:**\n```bash\nwitness run --step build \\\n  --attestations git \\\n  --outfile build-attestation.json \\\n  --key signing-key.pem \\\n  -- <your-build-command>\n```\n\n**Rego Validation Rules:**\n```rego\npackage git\n\nimport rego.v1\n\n# Enforce builds from specific branch\ndeny contains msg if {\n    input.branch != \"develop\"\n    msg := sprintf(\"Must build from develop branch, got: %s\", [input.branch])\n}\n\n# Validate commit author\napproved_authors := {\n    \"alice.smith@example.com\",\n    \"bob.jones@company.com\",\n    \"ci-bot@company.com\"\n}\n\ndeny contains msg if {\n    not input.authoremail in approved_authors\n    msg := sprintf(\"Unauthorized commit author: %s\", [input.authoremail])\n}\n```\n\n**Verification:**\n```bash\nwitness verify \\\n  --policy policy-signed.json \\\n  --publickey policy-key.pub \\\n  -a build-attestation.json \\\n  --subject <artifact>\n```\n"}]}
{"messages": [{"role": "system", "content": "You are an expert in the Witness supply chain attestation framework. You help users instrument CI/CD pipelines with witness, create policy documents, and write Rego policies to validate attestations. You understand all attestors in go-witness and how to use them effectively."}, {"role": "user", "content": "How do I create a witness policy for a build step that uses these attestors: git, environment, material?"}, {"role": "assistant", "content": "Here's a complete witness policy for your build step with git, environment, material attestors:\n\n**Policy Document:**\n```json\n{\n  \"expires\": \"2026-11-08T10:52:59Z\",\n  \"publickeys\": {\n    \"build-key\": {\n      \"keyid\": \"sha256:9ae7e450999a6135abc2ae97963985679fb7b8be9409d780d1e5d3cb2450682a\",\n      \"key\": \"-----BEGIN PUBLIC KEY-----\\n...\\n-----END PUBLIC KEY-----\"\n    }\n  },\n  \"steps\": {\n    \"build\": {\n      \"name\": \"build\",\n      \"attestations\": [\n        {\n          \"type\": \"https://witness.dev/attestations/git/v0.1\"\n        },\n        {\n          \"type\": \"https://witness.dev/attestations/environment/v0.1\"\n        },\n        {\n          \"type\": \"https://witness.dev/attestations/material/v0.1\"\n        }\n      ],\n      \"functionaries\": [\n        {\n          \"type\": \"publickey\",\n          \"publickeyid\": \"build-key\"\n        }\n      ]\n    }\n  }\n}\n```\n\n**Witness Run Command:**\n```bash\nwitness run --step build \\\n  --attestations git,environment,material \\\n  --outfile build-attestation.json \\\n  --key signing-key.pem \\\n  -- <your-build-command>\n```\n\n**Rego Validation Rules:**\n```rego\npackage git\n\nimport rego.v1\n\n# Enforce builds from specific branch\ndeny contains msg if {\n    input.branch != \"feature/api\"\n    msg := sprintf(\"Must build from feature/api branch, got: %s\", [input.branch])\n}\n\n# Validate commit author\napproved_authors := {\n    \"alice.smith@example.com\",\n    \"bob.jones@company.com\",\n    \"ci-bot@company.com\"\n}\n\ndeny contains msg if {\n    not input.authoremail in approved_authors\n    msg := sprintf(\"Unauthorized commit author: %s\", [input.authoremail])\n}\n```\n\n**Verification:**\n```bash\nwitness verify \\\n  --policy policy-signed.json \\\n  --publickey policy-key.pub \\\n  -a build-attestation.json \\\n  --subject <artifact>\n```\n"}]}
{"messages": [{"role": "system", "content": "You are an expert in the Witness supply chain attestation framework. You help users instrument CI/CD pipelines with witness, create policy documents, and write Rego policies to validate attestations. You understand all attestors in go-witness and how to use them effectively."}, {"role": "user", "content": "How do I create a witness policy for a build step that uses these attestors: material, product?"}, {"role": "assistant", "content": "Here's a complete witness policy for your build step with material, product attestors:\n\n**Policy Document:**\n```json\n{\n  \"expires\": \"2026-11-08T10:52:59Z\",\n  \"publickeys\": {\n    \"build-key\": {\n      \"keyid\": \"sha256:fde2402dc47c99fc5787ba96d8a648d086ede22bc4d943b27acd542a7e4a5077\",\n      \"key\": \"-----BEGIN PUBLIC KEY-----\\n...\\n-----END PUBLIC KEY-----\"\n    }\n  },\n  \"steps\": {\n    \"build\": {\n      \"name\": \"build\",\n      \"attestations\": [\n        {\n          \"type\": \"https://witness.dev/attestations/material/v0.1\"\n        },\n        {\n          \"type\": \"https://witness.dev/attestations/product/v0.1\"\n        }\n      ],\n      \"functionaries\": [\n        {\n          \"type\": \"publickey\",\n          \"publickeyid\": \"build-key\"\n        }\n      ]\n    }\n  }\n}\n```\n\n**Witness Run Command:**\n```bash\nwitness run --step build \\\n  --attestations material,product \\\n  --outfile build-attestation.json \\\n  --key signing-key.pem \\\n  -- <your-build-command>\n```\n\n**Rego Validation Rules:**\n```rego\n\n```\n\n**Verification:**\n```bash\nwitness verify \\\n  --policy policy-signed.json \\\n  --publickey policy-key.pub \\\n  -a build-attestation.json \\\n  --subject <artifact>\n```\n"}]}
{"messages": [{"role": "system", "content": "You are an expert in the Witness supply chain attestation framework. You help users instrument CI/CD pipelines with witness, create policy documents, and write Rego policies to validate attestations. You understand all attestors in go-witness and how to use them effectively."}, {"role": "user", "content": "How do I create a multi-step witness policy for a build \u2192 test \u2192 package pipeline?"}, {"role": "assistant", "content": "Here's a complete multi-step witness policy for your pipeline:\n\n**Policy Document:**\n```json\n{\n  \"expires\": \"2026-11-08T10:52:59Z\",\n  \"publickeys\": {\n    \"ci-key\": {\n      \"keyid\": \"sha256:57732546f7d2f3bb9c085268e325ee00ba69f71b6c8bf7ecb90a8d6cfe20b1f2\",\n      \"key\": \"-----BEGIN PUBLIC KEY-----\\n...\\n-----END PUBLIC KEY-----\"\n    }\n  },\n  \"steps\": {\n    \"build\": {\n      \"name\": \"build\",\n      \"attestations\": [\n        {\n          \"type\": \"https://witness.dev/attestations/git/v0.1\"\n        },\n        {\n          \"type\": \"https://witness.dev/attestations/command-run/v0.1\"\n        },\n        {\n          \"type\": \"https://witness.dev/attestations/product/v0.1\"\n        }\n      ],\n      \"functionaries\": [\n        {\n          \"type\": \"publickey\",\n          \"publickeyid\": \"ci-key\"\n        }\n      ]\n    },\n    \"test\": {\n      \"name\": \"test\",\n      \"attestations\": [\n        {\n          \"type\": \"https://witness.dev/attestations/material/v0.1\"\n        },\n        {\n          \"type\": \"https://witness.dev/attestations/command-run/v0.1\"\n        }\n      ],\n      \"functionaries\": [\n        {\n          \"type\": \"publickey\",\n          \"publickeyid\": \"ci-key\"\n        }\n      ]\n    },\n    \"package\": {\n      \"name\": \"package\",\n      \"attestations\": [\n        {\n          \"type\": \"https://witness.dev/attestations/material/v0.1\"\n        },\n        {\n          \"type\": \"https://witness.dev/attestations/product/v0.1\"\n        }\n      ],\n      \"functionaries\": [\n        {\n          \"type\": \"publickey\",\n          \"publickeyid\": \"ci-key\"\n        }\n      ]\n    }\n  }\n}\n```\n\n**Pipeline Commands:**\n\n```bash\n# Step 1: Build\nwitness run --step build \\\n  --attestations git,commandrun,product \\\n  -o build.json --key ci-key.pem \\\n  -- go build -o myapp\n\n# Step 2: Test\nwitness run --step test \\\n  --attestations material,commandrun \\\n  -o test.json --key ci-key.pem \\\n  -- go test ./...\n\n# Step 3: Package\nwitness run --step package \\\n  --attestations material,product \\\n  -o package.json --key ci-key.pem \\\n  -- tar czf myapp.tar.gz myapp\n\n# Verify entire pipeline\nwitness verify \\\n  --policy policy-signed.json \\\n  --publickey policy-key.pub \\\n  -a build.json -a test.json -a package.json\n```\n"}]}
{"messages": [{"role": "system", "content": "You are an expert in the Witness supply chain attestation framework. You help users instrument CI/CD pipelines with witness, create policy documents, and write Rego policies to validate attestations. You understand all attestors in go-witness and how to use them effectively."}, {"role": "user", "content": "How do I create a witness policy for a build step that uses these attestors: material, github, commandrun, product, git?"}, {"role": "assistant", "content": "Here's a complete witness policy for your build step with material, github, commandrun, product, git attestors:\n\n**Policy Document:**\n```json\n{\n  \"expires\": \"2026-11-08T10:52:59Z\",\n  \"publickeys\": {\n    \"build-key\": {\n      \"keyid\": \"sha256:976961f05bab5709238eb7dbc82c2d97ad29f92a0c800777f010d7cfe96b56f3\",\n      \"key\": \"-----BEGIN PUBLIC KEY-----\\n...\\n-----END PUBLIC KEY-----\"\n    }\n  },\n  \"steps\": {\n    \"build\": {\n      \"name\": \"build\",\n      \"attestations\": [\n        {\n          \"type\": \"https://witness.dev/attestations/material/v0.1\"\n        },\n        {\n          \"type\": \"https://witness.dev/attestations/github/v0.1\"\n        },\n        {\n          \"type\": \"https://witness.dev/attestations/command-run/v0.1\"\n        },\n        {\n          \"type\": \"https://witness.dev/attestations/product/v0.1\"\n        },\n        {\n          \"type\": \"https://witness.dev/attestations/git/v0.1\"\n        }\n      ],\n      \"functionaries\": [\n        {\n          \"type\": \"publickey\",\n          \"publickeyid\": \"build-key\"\n        }\n      ]\n    }\n  }\n}\n```\n\n**Witness Run Command:**\n```bash\nwitness run --step build \\\n  --attestations material,github,commandrun,product,git \\\n  --outfile build-attestation.json \\\n  --key signing-key.pem \\\n  -- <your-build-command>\n```\n\n**Rego Validation Rules:**\n```rego\n\n```\n\n**Verification:**\n```bash\nwitness verify \\\n  --policy policy-signed.json \\\n  --publickey policy-key.pub \\\n  -a build-attestation.json \\\n  --subject <artifact>\n```\n"}]}
{"messages": [{"role": "system", "content": "You are an expert in the Witness supply chain attestation framework. You help users instrument CI/CD pipelines with witness, create policy documents, and write Rego policies to validate attestations. You understand all attestors in go-witness and how to use them effectively."}, {"role": "user", "content": "How do I create a witness policy for a build step that uses these attestors: environment, git, product, github, material?"}, {"role": "assistant", "content": "Here's a complete witness policy for your build step with environment, git, product, github, material attestors:\n\n**Policy Document:**\n```json\n{\n  \"expires\": \"2026-11-08T10:52:59Z\",\n  \"publickeys\": {\n    \"build-key\": {\n      \"keyid\": \"sha256:1fc7cf72c28b88a3fa3a0c876bd5d9f0d1eb17fc9dff078cc4bf55fdaff13293\",\n      \"key\": \"-----BEGIN PUBLIC KEY-----\\n...\\n-----END PUBLIC KEY-----\"\n    }\n  },\n  \"steps\": {\n    \"build\": {\n      \"name\": \"build\",\n      \"attestations\": [\n        {\n          \"type\": \"https://witness.dev/attestations/environment/v0.1\"\n        },\n        {\n          \"type\": \"https://witness.dev/attestations/git/v0.1\"\n        },\n        {\n          \"type\": \"https://witness.dev/attestations/product/v0.1\"\n        },\n        {\n          \"type\": \"https://witness.dev/attestations/github/v0.1\"\n        },\n        {\n          \"type\": \"https://witness.dev/attestations/material/v0.1\"\n        }\n      ],\n      \"functionaries\": [\n        {\n          \"type\": \"publickey\",\n          \"publickeyid\": \"build-key\"\n        }\n      ]\n    }\n  }\n}\n```\n\n**Witness Run Command:**\n```bash\nwitness run --step build \\\n  --attestations environment,git,product,github,material \\\n  --outfile build-attestation.json \\\n  --key signing-key.pem \\\n  -- <your-build-command>\n```\n\n**Rego Validation Rules:**\n```rego\npackage environment\n\nimport rego.v1\n\n# Ensure correct OS\ndeny contains msg if {\n    input.os != \"windows\"\n    msg := sprintf(\"Must run on windows, got: %s\", [input.os])\n}\n\n# Require CI environment\ndeny contains msg if {\n    not \"CI\" in input.variables\n    msg := \"Must run in CI environment (CI variable not set)\"\n}\n```\n\n**Verification:**\n```bash\nwitness verify \\\n  --policy policy-signed.json \\\n  --publickey policy-key.pub \\\n  -a build-attestation.json \\\n  --subject <artifact>\n```\n"}]}
{"messages": [{"role": "system", "content": "You are an expert in the Witness supply chain attestation framework. You help users instrument CI/CD pipelines with witness, create policy documents, and write Rego policies to validate attestations. You understand all attestors in go-witness and how to use them effectively."}, {"role": "user", "content": "How do I create a multi-step witness policy for a build \u2192 test \u2192 package pipeline?"}, {"role": "assistant", "content": "Here's a complete multi-step witness policy for your pipeline:\n\n**Policy Document:**\n```json\n{\n  \"expires\": \"2026-11-08T10:52:59Z\",\n  \"publickeys\": {\n    \"ci-key\": {\n      \"keyid\": \"sha256:e5561256711c35c8406aad281aba51add905dabf29a001e541b073b0872493d0\",\n      \"key\": \"-----BEGIN PUBLIC KEY-----\\n...\\n-----END PUBLIC KEY-----\"\n    }\n  },\n  \"steps\": {\n    \"build\": {\n      \"name\": \"build\",\n      \"attestations\": [\n        {\n          \"type\": \"https://witness.dev/attestations/git/v0.1\"\n        },\n        {\n          \"type\": \"https://witness.dev/attestations/command-run/v0.1\"\n        },\n        {\n          \"type\": \"https://witness.dev/attestations/product/v0.1\"\n        }\n      ],\n      \"functionaries\": [\n        {\n          \"type\": \"publickey\",\n          \"publickeyid\": \"ci-key\"\n        }\n      ]\n    },\n    \"test\": {\n      \"name\": \"test\",\n      \"attestations\": [\n        {\n          \"type\": \"https://witness.dev/attestations/material/v0.1\"\n        },\n        {\n          \"type\": \"https://witness.dev/attestations/command-run/v0.1\"\n        }\n      ],\n      \"functionaries\": [\n        {\n          \"type\": \"publickey\",\n          \"publickeyid\": \"ci-key\"\n        }\n      ]\n    },\n    \"package\": {\n      \"name\": \"package\",\n      \"attestations\": [\n        {\n          \"type\": \"https://witness.dev/attestations/material/v0.1\"\n        },\n        {\n          \"type\": \"https://witness.dev/attestations/product/v0.1\"\n        }\n      ],\n      \"functionaries\": [\n        {\n          \"type\": \"publickey\",\n          \"publickeyid\": \"ci-key\"\n        }\n      ]\n    }\n  }\n}\n```\n\n**Pipeline Commands:**\n\n```bash\n# Step 1: Build\nwitness run --step build \\\n  --attestations git,commandrun,product \\\n  -o build.json --key ci-key.pem \\\n  -- go build -o myapp\n\n# Step 2: Test\nwitness run --step test \\\n  --attestations material,commandrun \\\n  -o test.json --key ci-key.pem \\\n  -- go test ./...\n\n# Step 3: Package\nwitness run --step package \\\n  --attestations material,product \\\n  -o package.json --key ci-key.pem \\\n  -- tar czf myapp.tar.gz myapp\n\n# Verify entire pipeline\nwitness verify \\\n  --policy policy-signed.json \\\n  --publickey policy-key.pub \\\n  -a build.json -a test.json -a package.json\n```\n"}]}
{"messages": [{"role": "system", "content": "You are an expert in the Witness supply chain attestation framework. You help users instrument CI/CD pipelines with witness, create policy documents, and write Rego policies to validate attestations. You understand all attestors in go-witness and how to use them effectively."}, {"role": "user", "content": "How do I create a multi-step witness policy for a build \u2192 test \u2192 package pipeline?"}, {"role": "assistant", "content": "Here's a complete multi-step witness policy for your pipeline:\n\n**Policy Document:**\n```json\n{\n  \"expires\": \"2026-11-08T10:52:59Z\",\n  \"publickeys\": {\n    \"ci-key\": {\n      \"keyid\": \"sha256:53b42c6635a2d9d872b989113ef781d56cb4affd5cb4b43a24fb0d56f2296cd4\",\n      \"key\": \"-----BEGIN PUBLIC KEY-----\\n...\\n-----END PUBLIC KEY-----\"\n    }\n  },\n  \"steps\": {\n    \"build\": {\n      \"name\": \"build\",\n      \"attestations\": [\n        {\n          \"type\": \"https://witness.dev/attestations/git/v0.1\"\n        },\n        {\n          \"type\": \"https://witness.dev/attestations/command-run/v0.1\"\n        },\n        {\n          \"type\": \"https://witness.dev/attestations/product/v0.1\"\n        }\n      ],\n      \"functionaries\": [\n        {\n          \"type\": \"publickey\",\n          \"publickeyid\": \"ci-key\"\n        }\n      ]\n    },\n    \"test\": {\n      \"name\": \"test\",\n      \"attestations\": [\n        {\n          \"type\": \"https://witness.dev/attestations/material/v0.1\"\n        },\n        {\n          \"type\": \"https://witness.dev/attestations/command-run/v0.1\"\n        }\n      ],\n      \"functionaries\": [\n        {\n          \"type\": \"publickey\",\n          \"publickeyid\": \"ci-key\"\n        }\n      ]\n    },\n    \"package\": {\n      \"name\": \"package\",\n      \"attestations\": [\n        {\n          \"type\": \"https://witness.dev/attestations/material/v0.1\"\n        },\n        {\n          \"type\": \"https://witness.dev/attestations/product/v0.1\"\n        }\n      ],\n      \"functionaries\": [\n        {\n          \"type\": \"publickey\",\n          \"publickeyid\": \"ci-key\"\n        }\n      ]\n    }\n  }\n}\n```\n\n**Pipeline Commands:**\n\n```bash\n# Step 1: Build\nwitness run --step build \\\n  --attestations git,commandrun,product \\\n  -o build.json --key ci-key.pem \\\n  -- go build -o myapp\n\n# Step 2: Test\nwitness run --step test \\\n  --attestations material,commandrun \\\n  -o test.json --key ci-key.pem \\\n  -- go test ./...\n\n# Step 3: Package\nwitness run --step package \\\n  --attestations material,product \\\n  -o package.json --key ci-key.pem \\\n  -- tar czf myapp.tar.gz myapp\n\n# Verify entire pipeline\nwitness verify \\\n  --policy policy-signed.json \\\n  --publickey policy-key.pub \\\n  -a build.json -a test.json -a package.json\n```\n"}]}
{"messages": [{"role": "system", "content": "You are an expert in the Witness supply chain attestation framework. You help users instrument CI/CD pipelines with witness, create policy documents, and write Rego policies to validate attestations. You understand all attestors in go-witness and how to use them effectively."}, {"role": "user", "content": "How do I create a multi-step witness policy for a build \u2192 test \u2192 package pipeline?"}, {"role": "assistant", "content": "Here's a complete multi-step witness policy for your pipeline:\n\n**Policy Document:**\n```json\n{\n  \"expires\": \"2026-11-08T10:52:59Z\",\n  \"publickeys\": {\n    \"ci-key\": {\n      \"keyid\": \"sha256:3192273f07fbaa743eb40a09183821546416ffe4a80759a07d0a42e619cb4f33\",\n      \"key\": \"-----BEGIN PUBLIC KEY-----\\n...\\n-----END PUBLIC KEY-----\"\n    }\n  },\n  \"steps\": {\n    \"build\": {\n      \"name\": \"build\",\n      \"attestations\": [\n        {\n          \"type\": \"https://witness.dev/attestations/git/v0.1\"\n        },\n        {\n          \"type\": \"https://witness.dev/attestations/command-run/v0.1\"\n        },\n        {\n          \"type\": \"https://witness.dev/attestations/product/v0.1\"\n        }\n      ],\n      \"functionaries\": [\n        {\n          \"type\": \"publickey\",\n          \"publickeyid\": \"ci-key\"\n        }\n      ]\n    },\n    \"test\": {\n      \"name\": \"test\",\n      \"attestations\": [\n        {\n          \"type\": \"https://witness.dev/attestations/material/v0.1\"\n        },\n        {\n          \"type\": \"https://witness.dev/attestations/command-run/v0.1\"\n        }\n      ],\n      \"functionaries\": [\n        {\n          \"type\": \"publickey\",\n          \"publickeyid\": \"ci-key\"\n        }\n      ]\n    },\n    \"package\": {\n      \"name\": \"package\",\n      \"attestations\": [\n        {\n          \"type\": \"https://witness.dev/attestations/material/v0.1\"\n        },\n        {\n          \"type\": \"https://witness.dev/attestations/product/v0.1\"\n        }\n      ],\n      \"functionaries\": [\n        {\n          \"type\": \"publickey\",\n          \"publickeyid\": \"ci-key\"\n        }\n      ]\n    }\n  }\n}\n```\n\n**Pipeline Commands:**\n\n```bash\n# Step 1: Build\nwitness run --step build \\\n  --attestations git,commandrun,product \\\n  -o build.json --key ci-key.pem \\\n  -- go build -o myapp\n\n# Step 2: Test\nwitness run --step test \\\n  --attestations material,commandrun \\\n  -o test.json --key ci-key.pem \\\n  -- go test ./...\n\n# Step 3: Package\nwitness run --step package \\\n  --attestations material,product \\\n  -o package.json --key ci-key.pem \\\n  -- tar czf myapp.tar.gz myapp\n\n# Verify entire pipeline\nwitness verify \\\n  --policy policy-signed.json \\\n  --publickey policy-key.pub \\\n  -a build.json -a test.json -a package.json\n```\n"}]}
{"messages": [{"role": "system", "content": "You are an expert in the Witness supply chain attestation framework. You help users instrument CI/CD pipelines with witness, create policy documents, and write Rego policies to validate attestations. You understand all attestors in go-witness and how to use them effectively."}, {"role": "user", "content": "How do I create a multi-step witness policy for a build \u2192 test \u2192 package pipeline?"}, {"role": "assistant", "content": "Here's a complete multi-step witness policy for your pipeline:\n\n**Policy Document:**\n```json\n{\n  \"expires\": \"2026-11-08T10:52:59Z\",\n  \"publickeys\": {\n    \"ci-key\": {\n      \"keyid\": \"sha256:4e3756eb00c5f91f4b1fb98ad1de8678dcbeb25c67309291c3eda4ec8943d9c4\",\n      \"key\": \"-----BEGIN PUBLIC KEY-----\\n...\\n-----END PUBLIC KEY-----\"\n    }\n  },\n  \"steps\": {\n    \"build\": {\n      \"name\": \"build\",\n      \"attestations\": [\n        {\n          \"type\": \"https://witness.dev/attestations/git/v0.1\"\n        },\n        {\n          \"type\": \"https://witness.dev/attestations/command-run/v0.1\"\n        },\n        {\n          \"type\": \"https://witness.dev/attestations/product/v0.1\"\n        }\n      ],\n      \"functionaries\": [\n        {\n          \"type\": \"publickey\",\n          \"publickeyid\": \"ci-key\"\n        }\n      ]\n    },\n    \"test\": {\n      \"name\": \"test\",\n      \"attestations\": [\n        {\n          \"type\": \"https://witness.dev/attestations/material/v0.1\"\n        },\n        {\n          \"type\": \"https://witness.dev/attestations/command-run/v0.1\"\n        }\n      ],\n      \"functionaries\": [\n        {\n          \"type\": \"publickey\",\n          \"publickeyid\": \"ci-key\"\n        }\n      ]\n    },\n    \"package\": {\n      \"name\": \"package\",\n      \"attestations\": [\n        {\n          \"type\": \"https://witness.dev/attestations/material/v0.1\"\n        },\n        {\n          \"type\": \"https://witness.dev/attestations/product/v0.1\"\n        }\n      ],\n      \"functionaries\": [\n        {\n          \"type\": \"publickey\",\n          \"publickeyid\": \"ci-key\"\n        }\n      ]\n    }\n  }\n}\n```\n\n**Pipeline Commands:**\n\n```bash\n# Step 1: Build\nwitness run --step build \\\n  --attestations git,commandrun,product \\\n  -o build.json --key ci-key.pem \\\n  -- go build -o myapp\n\n# Step 2: Test\nwitness run --step test \\\n  --attestations material,commandrun \\\n  -o test.json --key ci-key.pem \\\n  -- go test ./...\n\n# Step 3: Package\nwitness run --step package \\\n  --attestations material,product \\\n  -o package.json --key ci-key.pem \\\n  -- tar czf myapp.tar.gz myapp\n\n# Verify entire pipeline\nwitness verify \\\n  --policy policy-signed.json \\\n  --publickey policy-key.pub \\\n  -a build.json -a test.json -a package.json\n```\n"}]}
{"messages": [{"role": "system", "content": "You are an expert in the Witness supply chain attestation framework. You help users instrument CI/CD pipelines with witness, create policy documents, and write Rego policies to validate attestations. You understand all attestors in go-witness and how to use them effectively."}, {"role": "user", "content": "How do I create a multi-step witness policy for a build \u2192 test \u2192 package pipeline?"}, {"role": "assistant", "content": "Here's a complete multi-step witness policy for your pipeline:\n\n**Policy Document:**\n```json\n{\n  \"expires\": \"2026-11-08T10:52:59Z\",\n  \"publickeys\": {\n    \"ci-key\": {\n      \"keyid\": \"sha256:667dfc178252f0cd8f4dafe9769209e990c88cf29b2d8541982f05131277e4f2\",\n      \"key\": \"-----BEGIN PUBLIC KEY-----\\n...\\n-----END PUBLIC KEY-----\"\n    }\n  },\n  \"steps\": {\n    \"build\": {\n      \"name\": \"build\",\n      \"attestations\": [\n        {\n          \"type\": \"https://witness.dev/attestations/git/v0.1\"\n        },\n        {\n          \"type\": \"https://witness.dev/attestations/command-run/v0.1\"\n        },\n        {\n          \"type\": \"https://witness.dev/attestations/product/v0.1\"\n        }\n      ],\n      \"functionaries\": [\n        {\n          \"type\": \"publickey\",\n          \"publickeyid\": \"ci-key\"\n        }\n      ]\n    },\n    \"test\": {\n      \"name\": \"test\",\n      \"attestations\": [\n        {\n          \"type\": \"https://witness.dev/attestations/material/v0.1\"\n        },\n        {\n          \"type\": \"https://witness.dev/attestations/command-run/v0.1\"\n        }\n      ],\n      \"functionaries\": [\n        {\n          \"type\": \"publickey\",\n          \"publickeyid\": \"ci-key\"\n        }\n      ]\n    },\n    \"package\": {\n      \"name\": \"package\",\n      \"attestations\": [\n        {\n          \"type\": \"https://witness.dev/attestations/material/v0.1\"\n        },\n        {\n          \"type\": \"https://witness.dev/attestations/product/v0.1\"\n        }\n      ],\n      \"functionaries\": [\n        {\n          \"type\": \"publickey\",\n          \"publickeyid\": \"ci-key\"\n        }\n      ]\n    }\n  }\n}\n```\n\n**Pipeline Commands:**\n\n```bash\n# Step 1: Build\nwitness run --step build \\\n  --attestations git,commandrun,product \\\n  -o build.json --key ci-key.pem \\\n  -- go build -o myapp\n\n# Step 2: Test\nwitness run --step test \\\n  --attestations material,commandrun \\\n  -o test.json --key ci-key.pem \\\n  -- go test ./...\n\n# Step 3: Package\nwitness run --step package \\\n  --attestations material,product \\\n  -o package.json --key ci-key.pem \\\n  -- tar czf myapp.tar.gz myapp\n\n# Verify entire pipeline\nwitness verify \\\n  --policy policy-signed.json \\\n  --publickey policy-key.pub \\\n  -a build.json -a test.json -a package.json\n```\n"}]}
{"messages": [{"role": "system", "content": "You are an expert in the Witness supply chain attestation framework. You help users instrument CI/CD pipelines with witness, create policy documents, and write Rego policies to validate attestations. You understand all attestors in go-witness and how to use them effectively."}, {"role": "user", "content": "How do I create a multi-step witness policy for a build \u2192 test \u2192 package pipeline?"}, {"role": "assistant", "content": "Here's a complete multi-step witness policy for your pipeline:\n\n**Policy Document:**\n```json\n{\n  \"expires\": \"2026-11-08T10:52:59Z\",\n  \"publickeys\": {\n    \"ci-key\": {\n      \"keyid\": \"sha256:a371ab37ac2fd2f500adcc6ad225faf2914f0989cd2f35663f3dfd2900ab751f\",\n      \"key\": \"-----BEGIN PUBLIC KEY-----\\n...\\n-----END PUBLIC KEY-----\"\n    }\n  },\n  \"steps\": {\n    \"build\": {\n      \"name\": \"build\",\n      \"attestations\": [\n        {\n          \"type\": \"https://witness.dev/attestations/git/v0.1\"\n        },\n        {\n          \"type\": \"https://witness.dev/attestations/command-run/v0.1\"\n        },\n        {\n          \"type\": \"https://witness.dev/attestations/product/v0.1\"\n        }\n      ],\n      \"functionaries\": [\n        {\n          \"type\": \"publickey\",\n          \"publickeyid\": \"ci-key\"\n        }\n      ]\n    },\n    \"test\": {\n      \"name\": \"test\",\n      \"attestations\": [\n        {\n          \"type\": \"https://witness.dev/attestations/material/v0.1\"\n        },\n        {\n          \"type\": \"https://witness.dev/attestations/command-run/v0.1\"\n        }\n      ],\n      \"functionaries\": [\n        {\n          \"type\": \"publickey\",\n          \"publickeyid\": \"ci-key\"\n        }\n      ]\n    },\n    \"package\": {\n      \"name\": \"package\",\n      \"attestations\": [\n        {\n          \"type\": \"https://witness.dev/attestations/material/v0.1\"\n        },\n        {\n          \"type\": \"https://witness.dev/attestations/product/v0.1\"\n        }\n      ],\n      \"functionaries\": [\n        {\n          \"type\": \"publickey\",\n          \"publickeyid\": \"ci-key\"\n        }\n      ]\n    }\n  }\n}\n```\n\n**Pipeline Commands:**\n\n```bash\n# Step 1: Build\nwitness run --step build \\\n  --attestations git,commandrun,product \\\n  -o build.json --key ci-key.pem \\\n  -- go build -o myapp\n\n# Step 2: Test\nwitness run --step test \\\n  --attestations material,commandrun \\\n  -o test.json --key ci-key.pem \\\n  -- go test ./...\n\n# Step 3: Package\nwitness run --step package \\\n  --attestations material,product \\\n  -o package.json --key ci-key.pem \\\n  -- tar czf myapp.tar.gz myapp\n\n# Verify entire pipeline\nwitness verify \\\n  --policy policy-signed.json \\\n  --publickey policy-key.pub \\\n  -a build.json -a test.json -a package.json\n```\n"}]}
{"messages": [{"role": "system", "content": "You are an expert in the Witness supply chain attestation framework. You help users instrument CI/CD pipelines with witness, create policy documents, and write Rego policies to validate attestations. You understand all attestors in go-witness and how to use them effectively."}, {"role": "user", "content": "How do I create a witness policy for a build step that uses these attestors: environment, github?"}, {"role": "assistant", "content": "Here's a complete witness policy for your build step with environment, github attestors:\n\n**Policy Document:**\n```json\n{\n  \"expires\": \"2026-11-08T10:52:59Z\",\n  \"publickeys\": {\n    \"build-key\": {\n      \"keyid\": \"sha256:fabaa44e830bf904415d9a067ea91d5935d3bf92c236fae5bd5c93647d092fd6\",\n      \"key\": \"-----BEGIN PUBLIC KEY-----\\n...\\n-----END PUBLIC KEY-----\"\n    }\n  },\n  \"steps\": {\n    \"build\": {\n      \"name\": \"build\",\n      \"attestations\": [\n        {\n          \"type\": \"https://witness.dev/attestations/environment/v0.1\"\n        },\n        {\n          \"type\": \"https://witness.dev/attestations/github/v0.1\"\n        }\n      ],\n      \"functionaries\": [\n        {\n          \"type\": \"publickey\",\n          \"publickeyid\": \"build-key\"\n        }\n      ]\n    }\n  }\n}\n```\n\n**Witness Run Command:**\n```bash\nwitness run --step build \\\n  --attestations environment,github \\\n  --outfile build-attestation.json \\\n  --key signing-key.pem \\\n  -- <your-build-command>\n```\n\n**Rego Validation Rules:**\n```rego\npackage environment\n\nimport rego.v1\n\n# Ensure correct OS\ndeny contains msg if {\n    input.os != \"windows\"\n    msg := sprintf(\"Must run on windows, got: %s\", [input.os])\n}\n\n# Require CI environment\ndeny contains msg if {\n    not \"CI\" in input.variables\n    msg := \"Must run in CI environment (CI variable not set)\"\n}\n```\n\n**Verification:**\n```bash\nwitness verify \\\n  --policy policy-signed.json \\\n  --publickey policy-key.pub \\\n  -a build-attestation.json \\\n  --subject <artifact>\n```\n"}]}
{"messages": [{"role": "system", "content": "You are an expert in the Witness supply chain attestation framework. You help users instrument CI/CD pipelines with witness, create policy documents, and write Rego policies to validate attestations. You understand all attestors in go-witness and how to use them effectively."}, {"role": "user", "content": "How do I create a witness policy for a build step that uses these attestors: commandrun, git?"}, {"role": "assistant", "content": "Here's a complete witness policy for your build step with commandrun, git attestors:\n\n**Policy Document:**\n```json\n{\n  \"expires\": \"2026-11-08T10:52:59Z\",\n  \"publickeys\": {\n    \"build-key\": {\n      \"keyid\": \"sha256:e1f1d38762724a01175fcaf546e35f87b6f2b06be72701fd03f0a7d9043698d3\",\n      \"key\": \"-----BEGIN PUBLIC KEY-----\\n...\\n-----END PUBLIC KEY-----\"\n    }\n  },\n  \"steps\": {\n    \"build\": {\n      \"name\": \"build\",\n      \"attestations\": [\n        {\n          \"type\": \"https://witness.dev/attestations/command-run/v0.1\"\n        },\n        {\n          \"type\": \"https://witness.dev/attestations/git/v0.1\"\n        }\n      ],\n      \"functionaries\": [\n        {\n          \"type\": \"publickey\",\n          \"publickeyid\": \"build-key\"\n        }\n      ]\n    }\n  }\n}\n```\n\n**Witness Run Command:**\n```bash\nwitness run --step build \\\n  --attestations commandrun,git \\\n  --outfile build-attestation.json \\\n  --key signing-key.pem \\\n  -- <your-build-command>\n```\n\n**Rego Validation Rules:**\n```rego\n\n```\n\n**Verification:**\n```bash\nwitness verify \\\n  --policy policy-signed.json \\\n  --publickey policy-key.pub \\\n  -a build-attestation.json \\\n  --subject <artifact>\n```\n"}]}
{"messages": [{"role": "system", "content": "You are an expert in the Witness supply chain attestation framework. You help users instrument CI/CD pipelines with witness, create policy documents, and write Rego policies to validate attestations. You understand all attestors in go-witness and how to use them effectively."}, {"role": "user", "content": "How do I create a witness policy for a build step that uses these attestors: git?"}, {"role": "assistant", "content": "Here's a complete witness policy for your build step with git attestors:\n\n**Policy Document:**\n```json\n{\n  \"expires\": \"2026-11-08T10:52:59Z\",\n  \"publickeys\": {\n    \"build-key\": {\n      \"keyid\": \"sha256:e24c78b8b05d58d432cee99a5a0c0f6522b4634d556af60d91d3355362f3b57b\",\n      \"key\": \"-----BEGIN PUBLIC KEY-----\\n...\\n-----END PUBLIC KEY-----\"\n    }\n  },\n  \"steps\": {\n    \"build\": {\n      \"name\": \"build\",\n      \"attestations\": [\n        {\n          \"type\": \"https://witness.dev/attestations/git/v0.1\"\n        }\n      ],\n      \"functionaries\": [\n        {\n          \"type\": \"publickey\",\n          \"publickeyid\": \"build-key\"\n        }\n      ]\n    }\n  }\n}\n```\n\n**Witness Run Command:**\n```bash\nwitness run --step build \\\n  --attestations git \\\n  --outfile build-attestation.json \\\n  --key signing-key.pem \\\n  -- <your-build-command>\n```\n\n**Rego Validation Rules:**\n```rego\npackage git\n\nimport rego.v1\n\n# Enforce builds from specific branch\ndeny contains msg if {\n    input.branch != \"feature/auth\"\n    msg := sprintf(\"Must build from feature/auth branch, got: %s\", [input.branch])\n}\n\n# Validate commit author\napproved_authors := {\n    \"alice.smith@example.com\",\n    \"bob.jones@company.com\",\n    \"ci-bot@company.com\"\n}\n\ndeny contains msg if {\n    not input.authoremail in approved_authors\n    msg := sprintf(\"Unauthorized commit author: %s\", [input.authoremail])\n}\n```\n\n**Verification:**\n```bash\nwitness verify \\\n  --policy policy-signed.json \\\n  --publickey policy-key.pub \\\n  -a build-attestation.json \\\n  --subject <artifact>\n```\n"}]}
{"messages": [{"role": "system", "content": "You are an expert in the Witness supply chain attestation framework. You help users instrument CI/CD pipelines with witness, create policy documents, and write Rego policies to validate attestations. You understand all attestors in go-witness and how to use them effectively."}, {"role": "user", "content": "How do I create a witness policy for a build step that uses these attestors: git, material, environment, commandrun, github?"}, {"role": "assistant", "content": "Here's a complete witness policy for your build step with git, material, environment, commandrun, github attestors:\n\n**Policy Document:**\n```json\n{\n  \"expires\": \"2026-11-08T10:52:59Z\",\n  \"publickeys\": {\n    \"build-key\": {\n      \"keyid\": \"sha256:15c750b93e6b4679bec35352b3ec5d960724b45fff84ee6f586a6b8534bce65f\",\n      \"key\": \"-----BEGIN PUBLIC KEY-----\\n...\\n-----END PUBLIC KEY-----\"\n    }\n  },\n  \"steps\": {\n    \"build\": {\n      \"name\": \"build\",\n      \"attestations\": [\n        {\n          \"type\": \"https://witness.dev/attestations/git/v0.1\"\n        },\n        {\n          \"type\": \"https://witness.dev/attestations/material/v0.1\"\n        },\n        {\n          \"type\": \"https://witness.dev/attestations/environment/v0.1\"\n        },\n        {\n          \"type\": \"https://witness.dev/attestations/command-run/v0.1\"\n        },\n        {\n          \"type\": \"https://witness.dev/attestations/github/v0.1\"\n        }\n      ],\n      \"functionaries\": [\n        {\n          \"type\": \"publickey\",\n          \"publickeyid\": \"build-key\"\n        }\n      ]\n    }\n  }\n}\n```\n\n**Witness Run Command:**\n```bash\nwitness run --step build \\\n  --attestations git,material,environment,commandrun,github \\\n  --outfile build-attestation.json \\\n  --key signing-key.pem \\\n  -- <your-build-command>\n```\n\n**Rego Validation Rules:**\n```rego\npackage git\n\nimport rego.v1\n\n# Enforce builds from specific branch\ndeny contains msg if {\n    input.branch != \"main\"\n    msg := sprintf(\"Must build from main branch, got: %s\", [input.branch])\n}\n\n# Require clean working directory\ndeny contains msg if {\n    count(input.status) > 0\n    msg := \"Working directory must be clean (no uncommitted changes)\"\n}\n\n# Validate commit author\napproved_authors := {\n    \"alice.smith@example.com\",\n    \"bob.jones@company.com\",\n    \"ci-bot@company.com\"\n}\n\ndeny contains msg if {\n    not input.authoremail in approved_authors\n    msg := sprintf(\"Unauthorized commit author: %s\", [input.authoremail])\n}\n```\n\n**Verification:**\n```bash\nwitness verify \\\n  --policy policy-signed.json \\\n  --publickey policy-key.pub \\\n  -a build-attestation.json \\\n  --subject <artifact>\n```\n"}]}
{"messages": [{"role": "system", "content": "You are an expert in the Witness supply chain attestation framework. You help users instrument CI/CD pipelines with witness, create policy documents, and write Rego policies to validate attestations. You understand all attestors in go-witness and how to use them effectively."}, {"role": "user", "content": "How do I create a witness policy for a build step that uses these attestors: product, environment, material, git, commandrun?"}, {"role": "assistant", "content": "Here's a complete witness policy for your build step with product, environment, material, git, commandrun attestors:\n\n**Policy Document:**\n```json\n{\n  \"expires\": \"2026-11-08T10:52:59Z\",\n  \"publickeys\": {\n    \"build-key\": {\n      \"keyid\": \"sha256:6dabc9a7a93271f24b5aca0f2c5c3906b34ec483058a76b4811521d1ef78d6f5\",\n      \"key\": \"-----BEGIN PUBLIC KEY-----\\n...\\n-----END PUBLIC KEY-----\"\n    }\n  },\n  \"steps\": {\n    \"build\": {\n      \"name\": \"build\",\n      \"attestations\": [\n        {\n          \"type\": \"https://witness.dev/attestations/product/v0.1\"\n        },\n        {\n          \"type\": \"https://witness.dev/attestations/environment/v0.1\"\n        },\n        {\n          \"type\": \"https://witness.dev/attestations/material/v0.1\"\n        },\n        {\n          \"type\": \"https://witness.dev/attestations/git/v0.1\"\n        },\n        {\n          \"type\": \"https://witness.dev/attestations/command-run/v0.1\"\n        }\n      ],\n      \"functionaries\": [\n        {\n          \"type\": \"publickey\",\n          \"publickeyid\": \"build-key\"\n        }\n      ]\n    }\n  }\n}\n```\n\n**Witness Run Command:**\n```bash\nwitness run --step build \\\n  --attestations product,environment,material,git,commandrun \\\n  --outfile build-attestation.json \\\n  --key signing-key.pem \\\n  -- <your-build-command>\n```\n\n**Rego Validation Rules:**\n```rego\n\n```\n\n**Verification:**\n```bash\nwitness verify \\\n  --policy policy-signed.json \\\n  --publickey policy-key.pub \\\n  -a build-attestation.json \\\n  --subject <artifact>\n```\n"}]}
{"messages": [{"role": "system", "content": "You are an expert in the Witness supply chain attestation framework. You help users instrument CI/CD pipelines with witness, create policy documents, and write Rego policies to validate attestations. You understand all attestors in go-witness and how to use them effectively."}, {"role": "user", "content": "How do I create a witness policy for a build step that uses these attestors: material, environment?"}, {"role": "assistant", "content": "Here's a complete witness policy for your build step with material, environment attestors:\n\n**Policy Document:**\n```json\n{\n  \"expires\": \"2026-11-08T10:52:59Z\",\n  \"publickeys\": {\n    \"build-key\": {\n      \"keyid\": \"sha256:34636e89ae0f58fbce9dfb904462b6cfce571077fcf32f551c49c052db9efb04\",\n      \"key\": \"-----BEGIN PUBLIC KEY-----\\n...\\n-----END PUBLIC KEY-----\"\n    }\n  },\n  \"steps\": {\n    \"build\": {\n      \"name\": \"build\",\n      \"attestations\": [\n        {\n          \"type\": \"https://witness.dev/attestations/material/v0.1\"\n        },\n        {\n          \"type\": \"https://witness.dev/attestations/environment/v0.1\"\n        }\n      ],\n      \"functionaries\": [\n        {\n          \"type\": \"publickey\",\n          \"publickeyid\": \"build-key\"\n        }\n      ]\n    }\n  }\n}\n```\n\n**Witness Run Command:**\n```bash\nwitness run --step build \\\n  --attestations material,environment \\\n  --outfile build-attestation.json \\\n  --key signing-key.pem \\\n  -- <your-build-command>\n```\n\n**Rego Validation Rules:**\n```rego\n\n```\n\n**Verification:**\n```bash\nwitness verify \\\n  --policy policy-signed.json \\\n  --publickey policy-key.pub \\\n  -a build-attestation.json \\\n  --subject <artifact>\n```\n"}]}
{"messages": [{"role": "system", "content": "You are an expert in the Witness supply chain attestation framework. You help users instrument CI/CD pipelines with witness, create policy documents, and write Rego policies to validate attestations. You understand all attestors in go-witness and how to use them effectively."}, {"role": "user", "content": "How do I create a multi-step witness policy for a build \u2192 test \u2192 package pipeline?"}, {"role": "assistant", "content": "Here's a complete multi-step witness policy for your pipeline:\n\n**Policy Document:**\n```json\n{\n  \"expires\": \"2026-11-08T10:52:59Z\",\n  \"publickeys\": {\n    \"ci-key\": {\n      \"keyid\": \"sha256:b4af19628a29fd264fba9c5c8206a2b6b043cae86345fc23b34d46ba0b8e3db1\",\n      \"key\": \"-----BEGIN PUBLIC KEY-----\\n...\\n-----END PUBLIC KEY-----\"\n    }\n  },\n  \"steps\": {\n    \"build\": {\n      \"name\": \"build\",\n      \"attestations\": [\n        {\n          \"type\": \"https://witness.dev/attestations/git/v0.1\"\n        },\n        {\n          \"type\": \"https://witness.dev/attestations/command-run/v0.1\"\n        },\n        {\n          \"type\": \"https://witness.dev/attestations/product/v0.1\"\n        }\n      ],\n      \"functionaries\": [\n        {\n          \"type\": \"publickey\",\n          \"publickeyid\": \"ci-key\"\n        }\n      ]\n    },\n    \"test\": {\n      \"name\": \"test\",\n      \"attestations\": [\n        {\n          \"type\": \"https://witness.dev/attestations/material/v0.1\"\n        },\n        {\n          \"type\": \"https://witness.dev/attestations/command-run/v0.1\"\n        }\n      ],\n      \"functionaries\": [\n        {\n          \"type\": \"publickey\",\n          \"publickeyid\": \"ci-key\"\n        }\n      ]\n    },\n    \"package\": {\n      \"name\": \"package\",\n      \"attestations\": [\n        {\n          \"type\": \"https://witness.dev/attestations/material/v0.1\"\n        },\n        {\n          \"type\": \"https://witness.dev/attestations/product/v0.1\"\n        }\n      ],\n      \"functionaries\": [\n        {\n          \"type\": \"publickey\",\n          \"publickeyid\": \"ci-key\"\n        }\n      ]\n    }\n  }\n}\n```\n\n**Pipeline Commands:**\n\n```bash\n# Step 1: Build\nwitness run --step build \\\n  --attestations git,commandrun,product \\\n  -o build.json --key ci-key.pem \\\n  -- go build -o myapp\n\n# Step 2: Test\nwitness run --step test \\\n  --attestations material,commandrun \\\n  -o test.json --key ci-key.pem \\\n  -- go test ./...\n\n# Step 3: Package\nwitness run --step package \\\n  --attestations material,product \\\n  -o package.json --key ci-key.pem \\\n  -- tar czf myapp.tar.gz myapp\n\n# Verify entire pipeline\nwitness verify \\\n  --policy policy-signed.json \\\n  --publickey policy-key.pub \\\n  -a build.json -a test.json -a package.json\n```\n"}]}
{"messages": [{"role": "system", "content": "You are an expert in the Witness supply chain attestation framework. You help users instrument CI/CD pipelines with witness, create policy documents, and write Rego policies to validate attestations. You understand all attestors in go-witness and how to use them effectively."}, {"role": "user", "content": "How do I create a multi-step witness policy for a build \u2192 test \u2192 package pipeline?"}, {"role": "assistant", "content": "Here's a complete multi-step witness policy for your pipeline:\n\n**Policy Document:**\n```json\n{\n  \"expires\": \"2026-11-08T10:52:59Z\",\n  \"publickeys\": {\n    \"ci-key\": {\n      \"keyid\": \"sha256:2e1b8fb05fffbed4d52ea610c45b10beb224a015b77c2585a869550c3dbb358b\",\n      \"key\": \"-----BEGIN PUBLIC KEY-----\\n...\\n-----END PUBLIC KEY-----\"\n    }\n  },\n  \"steps\": {\n    \"build\": {\n      \"name\": \"build\",\n      \"attestations\": [\n        {\n          \"type\": \"https://witness.dev/attestations/git/v0.1\"\n        },\n        {\n          \"type\": \"https://witness.dev/attestations/command-run/v0.1\"\n        },\n        {\n          \"type\": \"https://witness.dev/attestations/product/v0.1\"\n        }\n      ],\n      \"functionaries\": [\n        {\n          \"type\": \"publickey\",\n          \"publickeyid\": \"ci-key\"\n        }\n      ]\n    },\n    \"test\": {\n      \"name\": \"test\",\n      \"attestations\": [\n        {\n          \"type\": \"https://witness.dev/attestations/material/v0.1\"\n        },\n        {\n          \"type\": \"https://witness.dev/attestations/command-run/v0.1\"\n        }\n      ],\n      \"functionaries\": [\n        {\n          \"type\": \"publickey\",\n          \"publickeyid\": \"ci-key\"\n        }\n      ]\n    },\n    \"package\": {\n      \"name\": \"package\",\n      \"attestations\": [\n        {\n          \"type\": \"https://witness.dev/attestations/material/v0.1\"\n        },\n        {\n          \"type\": \"https://witness.dev/attestations/product/v0.1\"\n        }\n      ],\n      \"functionaries\": [\n        {\n          \"type\": \"publickey\",\n          \"publickeyid\": \"ci-key\"\n        }\n      ]\n    }\n  }\n}\n```\n\n**Pipeline Commands:**\n\n```bash\n# Step 1: Build\nwitness run --step build \\\n  --attestations git,commandrun,product \\\n  -o build.json --key ci-key.pem \\\n  -- go build -o myapp\n\n# Step 2: Test\nwitness run --step test \\\n  --attestations material,commandrun \\\n  -o test.json --key ci-key.pem \\\n  -- go test ./...\n\n# Step 3: Package\nwitness run --step package \\\n  --attestations material,product \\\n  -o package.json --key ci-key.pem \\\n  -- tar czf myapp.tar.gz myapp\n\n# Verify entire pipeline\nwitness verify \\\n  --policy policy-signed.json \\\n  --publickey policy-key.pub \\\n  -a build.json -a test.json -a package.json\n```\n"}]}
{"messages": [{"role": "system", "content": "You are an expert in the Witness supply chain attestation framework. You help users instrument CI/CD pipelines with witness, create policy documents, and write Rego policies to validate attestations. You understand all attestors in go-witness and how to use them effectively."}, {"role": "user", "content": "How do I create a witness policy for a build step that uses these attestors: github?"}, {"role": "assistant", "content": "Here's a complete witness policy for your build step with github attestors:\n\n**Policy Document:**\n```json\n{\n  \"expires\": \"2026-11-08T10:52:59Z\",\n  \"publickeys\": {\n    \"build-key\": {\n      \"keyid\": \"sha256:f279f5b557389b5d55c368a0ba05ec15681b42eb193c893f6fc5e97604d4a9eb\",\n      \"key\": \"-----BEGIN PUBLIC KEY-----\\n...\\n-----END PUBLIC KEY-----\"\n    }\n  },\n  \"steps\": {\n    \"build\": {\n      \"name\": \"build\",\n      \"attestations\": [\n        {\n          \"type\": \"https://witness.dev/attestations/github/v0.1\"\n        }\n      ],\n      \"functionaries\": [\n        {\n          \"type\": \"publickey\",\n          \"publickeyid\": \"build-key\"\n        }\n      ]\n    }\n  }\n}\n```\n\n**Witness Run Command:**\n```bash\nwitness run --step build \\\n  --attestations github \\\n  --outfile build-attestation.json \\\n  --key signing-key.pem \\\n  -- <your-build-command>\n```\n\n**Rego Validation Rules:**\n```rego\n\n```\n\n**Verification:**\n```bash\nwitness verify \\\n  --policy policy-signed.json \\\n  --publickey policy-key.pub \\\n  -a build-attestation.json \\\n  --subject <artifact>\n```\n"}]}
{"messages": [{"role": "system", "content": "You are an expert in the Witness supply chain attestation framework. You help users instrument CI/CD pipelines with witness, create policy documents, and write Rego policies to validate attestations. You understand all attestors in go-witness and how to use them effectively."}, {"role": "user", "content": "How do I create a multi-step witness policy for a build \u2192 test \u2192 package pipeline?"}, {"role": "assistant", "content": "Here's a complete multi-step witness policy for your pipeline:\n\n**Policy Document:**\n```json\n{\n  \"expires\": \"2026-11-08T10:52:59Z\",\n  \"publickeys\": {\n    \"ci-key\": {\n      \"keyid\": \"sha256:20834b98e526093755af8f05e06eba641bf12235deb121fae64cdddb41c91f63\",\n      \"key\": \"-----BEGIN PUBLIC KEY-----\\n...\\n-----END PUBLIC KEY-----\"\n    }\n  },\n  \"steps\": {\n    \"build\": {\n      \"name\": \"build\",\n      \"attestations\": [\n        {\n          \"type\": \"https://witness.dev/attestations/git/v0.1\"\n        },\n        {\n          \"type\": \"https://witness.dev/attestations/command-run/v0.1\"\n        },\n        {\n          \"type\": \"https://witness.dev/attestations/product/v0.1\"\n        }\n      ],\n      \"functionaries\": [\n        {\n          \"type\": \"publickey\",\n          \"publickeyid\": \"ci-key\"\n        }\n      ]\n    },\n    \"test\": {\n      \"name\": \"test\",\n      \"attestations\": [\n        {\n          \"type\": \"https://witness.dev/attestations/material/v0.1\"\n        },\n        {\n          \"type\": \"https://witness.dev/attestations/command-run/v0.1\"\n        }\n      ],\n      \"functionaries\": [\n        {\n          \"type\": \"publickey\",\n          \"publickeyid\": \"ci-key\"\n        }\n      ]\n    },\n    \"package\": {\n      \"name\": \"package\",\n      \"attestations\": [\n        {\n          \"type\": \"https://witness.dev/attestations/material/v0.1\"\n        },\n        {\n          \"type\": \"https://witness.dev/attestations/product/v0.1\"\n        }\n      ],\n      \"functionaries\": [\n        {\n          \"type\": \"publickey\",\n          \"publickeyid\": \"ci-key\"\n        }\n      ]\n    }\n  }\n}\n```\n\n**Pipeline Commands:**\n\n```bash\n# Step 1: Build\nwitness run --step build \\\n  --attestations git,commandrun,product \\\n  -o build.json --key ci-key.pem \\\n  -- go build -o myapp\n\n# Step 2: Test\nwitness run --step test \\\n  --attestations material,commandrun \\\n  -o test.json --key ci-key.pem \\\n  -- go test ./...\n\n# Step 3: Package\nwitness run --step package \\\n  --attestations material,product \\\n  -o package.json --key ci-key.pem \\\n  -- tar czf myapp.tar.gz myapp\n\n# Verify entire pipeline\nwitness verify \\\n  --policy policy-signed.json \\\n  --publickey policy-key.pub \\\n  -a build.json -a test.json -a package.json\n```\n"}]}
{"messages": [{"role": "system", "content": "You are an expert in the Witness supply chain attestation framework. You help users instrument CI/CD pipelines with witness, create policy documents, and write Rego policies to validate attestations. You understand all attestors in go-witness and how to use them effectively."}, {"role": "user", "content": "How do I create a witness policy for a build step that uses these attestors: environment, github, material, commandrun?"}, {"role": "assistant", "content": "Here's a complete witness policy for your build step with environment, github, material, commandrun attestors:\n\n**Policy Document:**\n```json\n{\n  \"expires\": \"2026-11-08T10:52:59Z\",\n  \"publickeys\": {\n    \"build-key\": {\n      \"keyid\": \"sha256:4602e9a383c56e4934f7a8bf2bd9c4dd07eaf8c07a2c72eed4c6dc9a8dc92ef2\",\n      \"key\": \"-----BEGIN PUBLIC KEY-----\\n...\\n-----END PUBLIC KEY-----\"\n    }\n  },\n  \"steps\": {\n    \"build\": {\n      \"name\": \"build\",\n      \"attestations\": [\n        {\n          \"type\": \"https://witness.dev/attestations/environment/v0.1\"\n        },\n        {\n          \"type\": \"https://witness.dev/attestations/github/v0.1\"\n        },\n        {\n          \"type\": \"https://witness.dev/attestations/material/v0.1\"\n        },\n        {\n          \"type\": \"https://witness.dev/attestations/command-run/v0.1\"\n        }\n      ],\n      \"functionaries\": [\n        {\n          \"type\": \"publickey\",\n          \"publickeyid\": \"build-key\"\n        }\n      ]\n    }\n  }\n}\n```\n\n**Witness Run Command:**\n```bash\nwitness run --step build \\\n  --attestations environment,github,material,commandrun \\\n  --outfile build-attestation.json \\\n  --key signing-key.pem \\\n  -- <your-build-command>\n```\n\n**Rego Validation Rules:**\n```rego\npackage environment\n\nimport rego.v1\n\n# Ensure correct OS\ndeny contains msg if {\n    input.os != \"darwin\"\n    msg := sprintf(\"Must run on darwin, got: %s\", [input.os])\n}\n\n# Require CI environment\ndeny contains msg if {\n    not \"CI\" in input.variables\n    msg := \"Must run in CI environment (CI variable not set)\"\n}\n```\n\n**Verification:**\n```bash\nwitness verify \\\n  --policy policy-signed.json \\\n  --publickey policy-key.pub \\\n  -a build-attestation.json \\\n  --subject <artifact>\n```\n"}]}
{"messages": [{"role": "system", "content": "You are an expert in the Witness supply chain attestation framework. You help users instrument CI/CD pipelines with witness, create policy documents, and write Rego policies to validate attestations. You understand all attestors in go-witness and how to use them effectively."}, {"role": "user", "content": "How do I create a witness policy for a build step that uses these attestors: environment, product, commandrun, github, git?"}, {"role": "assistant", "content": "Here's a complete witness policy for your build step with environment, product, commandrun, github, git attestors:\n\n**Policy Document:**\n```json\n{\n  \"expires\": \"2026-11-08T10:52:59Z\",\n  \"publickeys\": {\n    \"build-key\": {\n      \"keyid\": \"sha256:4f09ccdf9319a275eaa6d2d767bad220d7451d379c36c2689891d4200893d868\",\n      \"key\": \"-----BEGIN PUBLIC KEY-----\\n...\\n-----END PUBLIC KEY-----\"\n    }\n  },\n  \"steps\": {\n    \"build\": {\n      \"name\": \"build\",\n      \"attestations\": [\n        {\n          \"type\": \"https://witness.dev/attestations/environment/v0.1\"\n        },\n        {\n          \"type\": \"https://witness.dev/attestations/product/v0.1\"\n        },\n        {\n          \"type\": \"https://witness.dev/attestations/command-run/v0.1\"\n        },\n        {\n          \"type\": \"https://witness.dev/attestations/github/v0.1\"\n        },\n        {\n          \"type\": \"https://witness.dev/attestations/git/v0.1\"\n        }\n      ],\n      \"functionaries\": [\n        {\n          \"type\": \"publickey\",\n          \"publickeyid\": \"build-key\"\n        }\n      ]\n    }\n  }\n}\n```\n\n**Witness Run Command:**\n```bash\nwitness run --step build \\\n  --attestations environment,product,commandrun,github,git \\\n  --outfile build-attestation.json \\\n  --key signing-key.pem \\\n  -- <your-build-command>\n```\n\n**Rego Validation Rules:**\n```rego\npackage environment\n\nimport rego.v1\n\n# Ensure correct OS\ndeny contains msg if {\n    input.os != \"darwin\"\n    msg := sprintf(\"Must run on darwin, got: %s\", [input.os])\n}\n\n# Require CI environment\ndeny contains msg if {\n    not \"CI\" in input.variables\n    msg := \"Must run in CI environment (CI variable not set)\"\n}\n```\n\n**Verification:**\n```bash\nwitness verify \\\n  --policy policy-signed.json \\\n  --publickey policy-key.pub \\\n  -a build-attestation.json \\\n  --subject <artifact>\n```\n"}]}
{"messages": [{"role": "system", "content": "You are an expert in the Witness supply chain attestation framework. You help users instrument CI/CD pipelines with witness, create policy documents, and write Rego policies to validate attestations. You understand all attestors in go-witness and how to use them effectively."}, {"role": "user", "content": "How do I create a multi-step witness policy for a build \u2192 test \u2192 package pipeline?"}, {"role": "assistant", "content": "Here's a complete multi-step witness policy for your pipeline:\n\n**Policy Document:**\n```json\n{\n  \"expires\": \"2026-11-08T10:52:59Z\",\n  \"publickeys\": {\n    \"ci-key\": {\n      \"keyid\": \"sha256:fe255893edc767cffacdfac709cb8f29b90967b34fb78917e04e3cb4739c4284\",\n      \"key\": \"-----BEGIN PUBLIC KEY-----\\n...\\n-----END PUBLIC KEY-----\"\n    }\n  },\n  \"steps\": {\n    \"build\": {\n      \"name\": \"build\",\n      \"attestations\": [\n        {\n          \"type\": \"https://witness.dev/attestations/git/v0.1\"\n        },\n        {\n          \"type\": \"https://witness.dev/attestations/command-run/v0.1\"\n        },\n        {\n          \"type\": \"https://witness.dev/attestations/product/v0.1\"\n        }\n      ],\n      \"functionaries\": [\n        {\n          \"type\": \"publickey\",\n          \"publickeyid\": \"ci-key\"\n        }\n      ]\n    },\n    \"test\": {\n      \"name\": \"test\",\n      \"attestations\": [\n        {\n          \"type\": \"https://witness.dev/attestations/material/v0.1\"\n        },\n        {\n          \"type\": \"https://witness.dev/attestations/command-run/v0.1\"\n        }\n      ],\n      \"functionaries\": [\n        {\n          \"type\": \"publickey\",\n          \"publickeyid\": \"ci-key\"\n        }\n      ]\n    },\n    \"package\": {\n      \"name\": \"package\",\n      \"attestations\": [\n        {\n          \"type\": \"https://witness.dev/attestations/material/v0.1\"\n        },\n        {\n          \"type\": \"https://witness.dev/attestations/product/v0.1\"\n        }\n      ],\n      \"functionaries\": [\n        {\n          \"type\": \"publickey\",\n          \"publickeyid\": \"ci-key\"\n        }\n      ]\n    }\n  }\n}\n```\n\n**Pipeline Commands:**\n\n```bash\n# Step 1: Build\nwitness run --step build \\\n  --attestations git,commandrun,product \\\n  -o build.json --key ci-key.pem \\\n  -- go build -o myapp\n\n# Step 2: Test\nwitness run --step test \\\n  --attestations material,commandrun \\\n  -o test.json --key ci-key.pem \\\n  -- go test ./...\n\n# Step 3: Package\nwitness run --step package \\\n  --attestations material,product \\\n  -o package.json --key ci-key.pem \\\n  -- tar czf myapp.tar.gz myapp\n\n# Verify entire pipeline\nwitness verify \\\n  --policy policy-signed.json \\\n  --publickey policy-key.pub \\\n  -a build.json -a test.json -a package.json\n```\n"}]}
{"messages": [{"role": "system", "content": "You are an expert in the Witness supply chain attestation framework. You help users instrument CI/CD pipelines with witness, create policy documents, and write Rego policies to validate attestations. You understand all attestors in go-witness and how to use them effectively."}, {"role": "user", "content": "How do I create a witness policy for a build step that uses these attestors: github?"}, {"role": "assistant", "content": "Here's a complete witness policy for your build step with github attestors:\n\n**Policy Document:**\n```json\n{\n  \"expires\": \"2026-11-08T10:52:59Z\",\n  \"publickeys\": {\n    \"build-key\": {\n      \"keyid\": \"sha256:4d6e75bc124e6fd205b1ec0c672654add2fd1072e0c637815797d3ccc6209cfb\",\n      \"key\": \"-----BEGIN PUBLIC KEY-----\\n...\\n-----END PUBLIC KEY-----\"\n    }\n  },\n  \"steps\": {\n    \"build\": {\n      \"name\": \"build\",\n      \"attestations\": [\n        {\n          \"type\": \"https://witness.dev/attestations/github/v0.1\"\n        }\n      ],\n      \"functionaries\": [\n        {\n          \"type\": \"publickey\",\n          \"publickeyid\": \"build-key\"\n        }\n      ]\n    }\n  }\n}\n```\n\n**Witness Run Command:**\n```bash\nwitness run --step build \\\n  --attestations github \\\n  --outfile build-attestation.json \\\n  --key signing-key.pem \\\n  -- <your-build-command>\n```\n\n**Rego Validation Rules:**\n```rego\n\n```\n\n**Verification:**\n```bash\nwitness verify \\\n  --policy policy-signed.json \\\n  --publickey policy-key.pub \\\n  -a build-attestation.json \\\n  --subject <artifact>\n```\n"}]}
{"messages": [{"role": "system", "content": "You are an expert in the Witness supply chain attestation framework. You help users instrument CI/CD pipelines with witness, create policy documents, and write Rego policies to validate attestations. You understand all attestors in go-witness and how to use them effectively."}, {"role": "user", "content": "How do I create a witness policy for a build step that uses these attestors: git?"}, {"role": "assistant", "content": "Here's a complete witness policy for your build step with git attestors:\n\n**Policy Document:**\n```json\n{\n  \"expires\": \"2026-11-08T10:52:59Z\",\n  \"publickeys\": {\n    \"build-key\": {\n      \"keyid\": \"sha256:5be02009fb4413d9ef6397fa973e3a287173684f09af23ec7b20b328744ba01c\",\n      \"key\": \"-----BEGIN PUBLIC KEY-----\\n...\\n-----END PUBLIC KEY-----\"\n    }\n  },\n  \"steps\": {\n    \"build\": {\n      \"name\": \"build\",\n      \"attestations\": [\n        {\n          \"type\": \"https://witness.dev/attestations/git/v0.1\"\n        }\n      ],\n      \"functionaries\": [\n        {\n          \"type\": \"publickey\",\n          \"publickeyid\": \"build-key\"\n        }\n      ]\n    }\n  }\n}\n```\n\n**Witness Run Command:**\n```bash\nwitness run --step build \\\n  --attestations git \\\n  --outfile build-attestation.json \\\n  --key signing-key.pem \\\n  -- <your-build-command>\n```\n\n**Rego Validation Rules:**\n```rego\npackage git\n\nimport rego.v1\n\n# Enforce builds from specific branch\ndeny contains msg if {\n    input.branch != \"release/v1.0\"\n    msg := sprintf(\"Must build from release/v1.0 branch, got: %s\", [input.branch])\n}\n\n# Require clean working directory\ndeny contains msg if {\n    count(input.status) > 0\n    msg := \"Working directory must be clean (no uncommitted changes)\"\n}\n\n# Validate commit author\napproved_authors := {\n    \"alice.smith@example.com\",\n    \"bob.jones@company.com\",\n    \"ci-bot@company.com\"\n}\n\ndeny contains msg if {\n    not input.authoremail in approved_authors\n    msg := sprintf(\"Unauthorized commit author: %s\", [input.authoremail])\n}\n```\n\n**Verification:**\n```bash\nwitness verify \\\n  --policy policy-signed.json \\\n  --publickey policy-key.pub \\\n  -a build-attestation.json \\\n  --subject <artifact>\n```\n"}]}
{"messages": [{"role": "system", "content": "You are an expert in the Witness supply chain attestation framework. You help users instrument CI/CD pipelines with witness, create policy documents, and write Rego policies to validate attestations. You understand all attestors in go-witness and how to use them effectively."}, {"role": "user", "content": "How do I create a witness policy for a build step that uses these attestors: github, environment, git, material?"}, {"role": "assistant", "content": "Here's a complete witness policy for your build step with github, environment, git, material attestors:\n\n**Policy Document:**\n```json\n{\n  \"expires\": \"2026-11-08T10:52:59Z\",\n  \"publickeys\": {\n    \"build-key\": {\n      \"keyid\": \"sha256:433698075efbf2c56b5f36ac1400848651ba03faba3c5a663137d9e16dbdd0be\",\n      \"key\": \"-----BEGIN PUBLIC KEY-----\\n...\\n-----END PUBLIC KEY-----\"\n    }\n  },\n  \"steps\": {\n    \"build\": {\n      \"name\": \"build\",\n      \"attestations\": [\n        {\n          \"type\": \"https://witness.dev/attestations/github/v0.1\"\n        },\n        {\n          \"type\": \"https://witness.dev/attestations/environment/v0.1\"\n        },\n        {\n          \"type\": \"https://witness.dev/attestations/git/v0.1\"\n        },\n        {\n          \"type\": \"https://witness.dev/attestations/material/v0.1\"\n        }\n      ],\n      \"functionaries\": [\n        {\n          \"type\": \"publickey\",\n          \"publickeyid\": \"build-key\"\n        }\n      ]\n    }\n  }\n}\n```\n\n**Witness Run Command:**\n```bash\nwitness run --step build \\\n  --attestations github,environment,git,material \\\n  --outfile build-attestation.json \\\n  --key signing-key.pem \\\n  -- <your-build-command>\n```\n\n**Rego Validation Rules:**\n```rego\n\n```\n\n**Verification:**\n```bash\nwitness verify \\\n  --policy policy-signed.json \\\n  --publickey policy-key.pub \\\n  -a build-attestation.json \\\n  --subject <artifact>\n```\n"}]}
{"messages": [{"role": "system", "content": "You are an expert in the Witness supply chain attestation framework. You help users instrument CI/CD pipelines with witness, create policy documents, and write Rego policies to validate attestations. You understand all attestors in go-witness and how to use them effectively."}, {"role": "user", "content": "How do I create a witness policy for a build step that uses these attestors: environment, git, material, commandrun, product?"}, {"role": "assistant", "content": "Here's a complete witness policy for your build step with environment, git, material, commandrun, product attestors:\n\n**Policy Document:**\n```json\n{\n  \"expires\": \"2026-11-08T10:52:59Z\",\n  \"publickeys\": {\n    \"build-key\": {\n      \"keyid\": \"sha256:4db3569673b12e81f30591b1d417797348378932e46d5e323cb8b5fbf44df197\",\n      \"key\": \"-----BEGIN PUBLIC KEY-----\\n...\\n-----END PUBLIC KEY-----\"\n    }\n  },\n  \"steps\": {\n    \"build\": {\n      \"name\": \"build\",\n      \"attestations\": [\n        {\n          \"type\": \"https://witness.dev/attestations/environment/v0.1\"\n        },\n        {\n          \"type\": \"https://witness.dev/attestations/git/v0.1\"\n        },\n        {\n          \"type\": \"https://witness.dev/attestations/material/v0.1\"\n        },\n        {\n          \"type\": \"https://witness.dev/attestations/command-run/v0.1\"\n        },\n        {\n          \"type\": \"https://witness.dev/attestations/product/v0.1\"\n        }\n      ],\n      \"functionaries\": [\n        {\n          \"type\": \"publickey\",\n          \"publickeyid\": \"build-key\"\n        }\n      ]\n    }\n  }\n}\n```\n\n**Witness Run Command:**\n```bash\nwitness run --step build \\\n  --attestations environment,git,material,commandrun,product \\\n  --outfile build-attestation.json \\\n  --key signing-key.pem \\\n  -- <your-build-command>\n```\n\n**Rego Validation Rules:**\n```rego\npackage environment\n\nimport rego.v1\n\n# Ensure correct OS\ndeny contains msg if {\n    input.os != \"windows\"\n    msg := sprintf(\"Must run on windows, got: %s\", [input.os])\n}\n\n# Require CI environment\ndeny contains msg if {\n    not \"CI\" in input.variables\n    msg := \"Must run in CI environment (CI variable not set)\"\n}\n```\n\n**Verification:**\n```bash\nwitness verify \\\n  --policy policy-signed.json \\\n  --publickey policy-key.pub \\\n  -a build-attestation.json \\\n  --subject <artifact>\n```\n"}]}
{"messages": [{"role": "system", "content": "You are an expert in the Witness supply chain attestation framework. You help users instrument CI/CD pipelines with witness, create policy documents, and write Rego policies to validate attestations. You understand all attestors in go-witness and how to use them effectively."}, {"role": "user", "content": "How do I create a witness policy for a build step that uses these attestors: product, material, git, environment?"}, {"role": "assistant", "content": "Here's a complete witness policy for your build step with product, material, git, environment attestors:\n\n**Policy Document:**\n```json\n{\n  \"expires\": \"2026-11-08T10:52:59Z\",\n  \"publickeys\": {\n    \"build-key\": {\n      \"keyid\": \"sha256:ca9169d1fff020c9739657cbed22e6ce145c8cd7edfe7c01cd5b0d23ca98fd5b\",\n      \"key\": \"-----BEGIN PUBLIC KEY-----\\n...\\n-----END PUBLIC KEY-----\"\n    }\n  },\n  \"steps\": {\n    \"build\": {\n      \"name\": \"build\",\n      \"attestations\": [\n        {\n          \"type\": \"https://witness.dev/attestations/product/v0.1\"\n        },\n        {\n          \"type\": \"https://witness.dev/attestations/material/v0.1\"\n        },\n        {\n          \"type\": \"https://witness.dev/attestations/git/v0.1\"\n        },\n        {\n          \"type\": \"https://witness.dev/attestations/environment/v0.1\"\n        }\n      ],\n      \"functionaries\": [\n        {\n          \"type\": \"publickey\",\n          \"publickeyid\": \"build-key\"\n        }\n      ]\n    }\n  }\n}\n```\n\n**Witness Run Command:**\n```bash\nwitness run --step build \\\n  --attestations product,material,git,environment \\\n  --outfile build-attestation.json \\\n  --key signing-key.pem \\\n  -- <your-build-command>\n```\n\n**Rego Validation Rules:**\n```rego\n\n```\n\n**Verification:**\n```bash\nwitness verify \\\n  --policy policy-signed.json \\\n  --publickey policy-key.pub \\\n  -a build-attestation.json \\\n  --subject <artifact>\n```\n"}]}
{"messages": [{"role": "system", "content": "You are an expert in the Witness supply chain attestation framework. You help users instrument CI/CD pipelines with witness, create policy documents, and write Rego policies to validate attestations. You understand all attestors in go-witness and how to use them effectively."}, {"role": "user", "content": "How do I create a witness policy for a build step that uses these attestors: github, environment, product?"}, {"role": "assistant", "content": "Here's a complete witness policy for your build step with github, environment, product attestors:\n\n**Policy Document:**\n```json\n{\n  \"expires\": \"2026-11-08T10:52:59Z\",\n  \"publickeys\": {\n    \"build-key\": {\n      \"keyid\": \"sha256:4b00f240ff65be33022a5e880277125981870f793d9d4298971ee5f71b91f49f\",\n      \"key\": \"-----BEGIN PUBLIC KEY-----\\n...\\n-----END PUBLIC KEY-----\"\n    }\n  },\n  \"steps\": {\n    \"build\": {\n      \"name\": \"build\",\n      \"attestations\": [\n        {\n          \"type\": \"https://witness.dev/attestations/github/v0.1\"\n        },\n        {\n          \"type\": \"https://witness.dev/attestations/environment/v0.1\"\n        },\n        {\n          \"type\": \"https://witness.dev/attestations/product/v0.1\"\n        }\n      ],\n      \"functionaries\": [\n        {\n          \"type\": \"publickey\",\n          \"publickeyid\": \"build-key\"\n        }\n      ]\n    }\n  }\n}\n```\n\n**Witness Run Command:**\n```bash\nwitness run --step build \\\n  --attestations github,environment,product \\\n  --outfile build-attestation.json \\\n  --key signing-key.pem \\\n  -- <your-build-command>\n```\n\n**Rego Validation Rules:**\n```rego\n\n```\n\n**Verification:**\n```bash\nwitness verify \\\n  --policy policy-signed.json \\\n  --publickey policy-key.pub \\\n  -a build-attestation.json \\\n  --subject <artifact>\n```\n"}]}
{"messages": [{"role": "system", "content": "You are an expert in the Witness supply chain attestation framework. You help users instrument CI/CD pipelines with witness, create policy documents, and write Rego policies to validate attestations. You understand all attestors in go-witness and how to use them effectively."}, {"role": "user", "content": "How do I create a multi-step witness policy for a build \u2192 test \u2192 package pipeline?"}, {"role": "assistant", "content": "Here's a complete multi-step witness policy for your pipeline:\n\n**Policy Document:**\n```json\n{\n  \"expires\": \"2026-11-08T10:52:59Z\",\n  \"publickeys\": {\n    \"ci-key\": {\n      \"keyid\": \"sha256:8480491a641e873c148c95c8ced6ff82f9e2454ba0ee0e3ccef8ea94c987e6c7\",\n      \"key\": \"-----BEGIN PUBLIC KEY-----\\n...\\n-----END PUBLIC KEY-----\"\n    }\n  },\n  \"steps\": {\n    \"build\": {\n      \"name\": \"build\",\n      \"attestations\": [\n        {\n          \"type\": \"https://witness.dev/attestations/git/v0.1\"\n        },\n        {\n          \"type\": \"https://witness.dev/attestations/command-run/v0.1\"\n        },\n        {\n          \"type\": \"https://witness.dev/attestations/product/v0.1\"\n        }\n      ],\n      \"functionaries\": [\n        {\n          \"type\": \"publickey\",\n          \"publickeyid\": \"ci-key\"\n        }\n      ]\n    },\n    \"test\": {\n      \"name\": \"test\",\n      \"attestations\": [\n        {\n          \"type\": \"https://witness.dev/attestations/material/v0.1\"\n        },\n        {\n          \"type\": \"https://witness.dev/attestations/command-run/v0.1\"\n        }\n      ],\n      \"functionaries\": [\n        {\n          \"type\": \"publickey\",\n          \"publickeyid\": \"ci-key\"\n        }\n      ]\n    },\n    \"package\": {\n      \"name\": \"package\",\n      \"attestations\": [\n        {\n          \"type\": \"https://witness.dev/attestations/material/v0.1\"\n        },\n        {\n          \"type\": \"https://witness.dev/attestations/product/v0.1\"\n        }\n      ],\n      \"functionaries\": [\n        {\n          \"type\": \"publickey\",\n          \"publickeyid\": \"ci-key\"\n        }\n      ]\n    }\n  }\n}\n```\n\n**Pipeline Commands:**\n\n```bash\n# Step 1: Build\nwitness run --step build \\\n  --attestations git,commandrun,product \\\n  -o build.json --key ci-key.pem \\\n  -- go build -o myapp\n\n# Step 2: Test\nwitness run --step test \\\n  --attestations material,commandrun \\\n  -o test.json --key ci-key.pem \\\n  -- go test ./...\n\n# Step 3: Package\nwitness run --step package \\\n  --attestations material,product \\\n  -o package.json --key ci-key.pem \\\n  -- tar czf myapp.tar.gz myapp\n\n# Verify entire pipeline\nwitness verify \\\n  --policy policy-signed.json \\\n  --publickey policy-key.pub \\\n  -a build.json -a test.json -a package.json\n```\n"}]}
{"messages": [{"role": "system", "content": "You are an expert in the Witness supply chain attestation framework. You help users instrument CI/CD pipelines with witness, create policy documents, and write Rego policies to validate attestations. You understand all attestors in go-witness and how to use them effectively."}, {"role": "user", "content": "How do I create a witness policy for a build step that uses these attestors: material, environment, commandrun, product, github?"}, {"role": "assistant", "content": "Here's a complete witness policy for your build step with material, environment, commandrun, product, github attestors:\n\n**Policy Document:**\n```json\n{\n  \"expires\": \"2026-11-08T10:52:59Z\",\n  \"publickeys\": {\n    \"build-key\": {\n      \"keyid\": \"sha256:e41334ef20dcc92e34909c7775f77c47c775e2de22f1127efadfa2ad7b0d7866\",\n      \"key\": \"-----BEGIN PUBLIC KEY-----\\n...\\n-----END PUBLIC KEY-----\"\n    }\n  },\n  \"steps\": {\n    \"build\": {\n      \"name\": \"build\",\n      \"attestations\": [\n        {\n          \"type\": \"https://witness.dev/attestations/material/v0.1\"\n        },\n        {\n          \"type\": \"https://witness.dev/attestations/environment/v0.1\"\n        },\n        {\n          \"type\": \"https://witness.dev/attestations/command-run/v0.1\"\n        },\n        {\n          \"type\": \"https://witness.dev/attestations/product/v0.1\"\n        },\n        {\n          \"type\": \"https://witness.dev/attestations/github/v0.1\"\n        }\n      ],\n      \"functionaries\": [\n        {\n          \"type\": \"publickey\",\n          \"publickeyid\": \"build-key\"\n        }\n      ]\n    }\n  }\n}\n```\n\n**Witness Run Command:**\n```bash\nwitness run --step build \\\n  --attestations material,environment,commandrun,product,github \\\n  --outfile build-attestation.json \\\n  --key signing-key.pem \\\n  -- <your-build-command>\n```\n\n**Rego Validation Rules:**\n```rego\n\n```\n\n**Verification:**\n```bash\nwitness verify \\\n  --policy policy-signed.json \\\n  --publickey policy-key.pub \\\n  -a build-attestation.json \\\n  --subject <artifact>\n```\n"}]}
{"messages": [{"role": "system", "content": "You are an expert in the Witness supply chain attestation framework. You help users instrument CI/CD pipelines with witness, create policy documents, and write Rego policies to validate attestations. You understand all attestors in go-witness and how to use them effectively."}, {"role": "user", "content": "How do I create a witness policy for a build step that uses these attestors: environment, material?"}, {"role": "assistant", "content": "Here's a complete witness policy for your build step with environment, material attestors:\n\n**Policy Document:**\n```json\n{\n  \"expires\": \"2026-11-08T10:52:59Z\",\n  \"publickeys\": {\n    \"build-key\": {\n      \"keyid\": \"sha256:676f684f873e3ebaafb7da4d095365a20536b2302c9734240493d76dd1a0874e\",\n      \"key\": \"-----BEGIN PUBLIC KEY-----\\n...\\n-----END PUBLIC KEY-----\"\n    }\n  },\n  \"steps\": {\n    \"build\": {\n      \"name\": \"build\",\n      \"attestations\": [\n        {\n          \"type\": \"https://witness.dev/attestations/environment/v0.1\"\n        },\n        {\n          \"type\": \"https://witness.dev/attestations/material/v0.1\"\n        }\n      ],\n      \"functionaries\": [\n        {\n          \"type\": \"publickey\",\n          \"publickeyid\": \"build-key\"\n        }\n      ]\n    }\n  }\n}\n```\n\n**Witness Run Command:**\n```bash\nwitness run --step build \\\n  --attestations environment,material \\\n  --outfile build-attestation.json \\\n  --key signing-key.pem \\\n  -- <your-build-command>\n```\n\n**Rego Validation Rules:**\n```rego\npackage environment\n\nimport rego.v1\n\n# Ensure correct OS\ndeny contains msg if {\n    input.os != \"linux\"\n    msg := sprintf(\"Must run on linux, got: %s\", [input.os])\n}\n\n# Require CI environment\ndeny contains msg if {\n    not \"CI\" in input.variables\n    msg := \"Must run in CI environment (CI variable not set)\"\n}\n```\n\n**Verification:**\n```bash\nwitness verify \\\n  --policy policy-signed.json \\\n  --publickey policy-key.pub \\\n  -a build-attestation.json \\\n  --subject <artifact>\n```\n"}]}
{"messages": [{"role": "system", "content": "You are an expert in the Witness supply chain attestation framework. You help users instrument CI/CD pipelines with witness, create policy documents, and write Rego policies to validate attestations. You understand all attestors in go-witness and how to use them effectively."}, {"role": "user", "content": "How do I create a witness policy for a build step that uses these attestors: github, product, material, git?"}, {"role": "assistant", "content": "Here's a complete witness policy for your build step with github, product, material, git attestors:\n\n**Policy Document:**\n```json\n{\n  \"expires\": \"2026-11-08T10:52:59Z\",\n  \"publickeys\": {\n    \"build-key\": {\n      \"keyid\": \"sha256:8708451fce0483647e0270133641fb0a9f48ac725c999e4044c807a5d9529ac4\",\n      \"key\": \"-----BEGIN PUBLIC KEY-----\\n...\\n-----END PUBLIC KEY-----\"\n    }\n  },\n  \"steps\": {\n    \"build\": {\n      \"name\": \"build\",\n      \"attestations\": [\n        {\n          \"type\": \"https://witness.dev/attestations/github/v0.1\"\n        },\n        {\n          \"type\": \"https://witness.dev/attestations/product/v0.1\"\n        },\n        {\n          \"type\": \"https://witness.dev/attestations/material/v0.1\"\n        },\n        {\n          \"type\": \"https://witness.dev/attestations/git/v0.1\"\n        }\n      ],\n      \"functionaries\": [\n        {\n          \"type\": \"publickey\",\n          \"publickeyid\": \"build-key\"\n        }\n      ]\n    }\n  }\n}\n```\n\n**Witness Run Command:**\n```bash\nwitness run --step build \\\n  --attestations github,product,material,git \\\n  --outfile build-attestation.json \\\n  --key signing-key.pem \\\n  -- <your-build-command>\n```\n\n**Rego Validation Rules:**\n```rego\n\n```\n\n**Verification:**\n```bash\nwitness verify \\\n  --policy policy-signed.json \\\n  --publickey policy-key.pub \\\n  -a build-attestation.json \\\n  --subject <artifact>\n```\n"}]}
{"messages": [{"role": "system", "content": "You are an expert in the Witness supply chain attestation framework. You help users instrument CI/CD pipelines with witness, create policy documents, and write Rego policies to validate attestations. You understand all attestors in go-witness and how to use them effectively."}, {"role": "user", "content": "How do I create a witness policy for a build step that uses these attestors: product?"}, {"role": "assistant", "content": "Here's a complete witness policy for your build step with product attestors:\n\n**Policy Document:**\n```json\n{\n  \"expires\": \"2026-11-08T10:52:59Z\",\n  \"publickeys\": {\n    \"build-key\": {\n      \"keyid\": \"sha256:0ae5058aca938c05ee7c89b0798184acfb14c9f626a655b17aba988821b0bce2\",\n      \"key\": \"-----BEGIN PUBLIC KEY-----\\n...\\n-----END PUBLIC KEY-----\"\n    }\n  },\n  \"steps\": {\n    \"build\": {\n      \"name\": \"build\",\n      \"attestations\": [\n        {\n          \"type\": \"https://witness.dev/attestations/product/v0.1\"\n        }\n      ],\n      \"functionaries\": [\n        {\n          \"type\": \"publickey\",\n          \"publickeyid\": \"build-key\"\n        }\n      ]\n    }\n  }\n}\n```\n\n**Witness Run Command:**\n```bash\nwitness run --step build \\\n  --attestations product \\\n  --outfile build-attestation.json \\\n  --key signing-key.pem \\\n  -- <your-build-command>\n```\n\n**Rego Validation Rules:**\n```rego\n\n```\n\n**Verification:**\n```bash\nwitness verify \\\n  --policy policy-signed.json \\\n  --publickey policy-key.pub \\\n  -a build-attestation.json \\\n  --subject <artifact>\n```\n"}]}
{"messages": [{"role": "system", "content": "You are an expert in the Witness supply chain attestation framework. You help users instrument CI/CD pipelines with witness, create policy documents, and write Rego policies to validate attestations. You understand all attestors in go-witness and how to use them effectively."}, {"role": "user", "content": "How do I create a multi-step witness policy for a build \u2192 test \u2192 package pipeline?"}, {"role": "assistant", "content": "Here's a complete multi-step witness policy for your pipeline:\n\n**Policy Document:**\n```json\n{\n  \"expires\": \"2026-11-08T10:52:59Z\",\n  \"publickeys\": {\n    \"ci-key\": {\n      \"keyid\": \"sha256:8668b4163fc6aa26adcefd870e95f994f6a439c50cf39ef0570cea1bb3430585\",\n      \"key\": \"-----BEGIN PUBLIC KEY-----\\n...\\n-----END PUBLIC KEY-----\"\n    }\n  },\n  \"steps\": {\n    \"build\": {\n      \"name\": \"build\",\n      \"attestations\": [\n        {\n          \"type\": \"https://witness.dev/attestations/git/v0.1\"\n        },\n        {\n          \"type\": \"https://witness.dev/attestations/command-run/v0.1\"\n        },\n        {\n          \"type\": \"https://witness.dev/attestations/product/v0.1\"\n        }\n      ],\n      \"functionaries\": [\n        {\n          \"type\": \"publickey\",\n          \"publickeyid\": \"ci-key\"\n        }\n      ]\n    },\n    \"test\": {\n      \"name\": \"test\",\n      \"attestations\": [\n        {\n          \"type\": \"https://witness.dev/attestations/material/v0.1\"\n        },\n        {\n          \"type\": \"https://witness.dev/attestations/command-run/v0.1\"\n        }\n      ],\n      \"functionaries\": [\n        {\n          \"type\": \"publickey\",\n          \"publickeyid\": \"ci-key\"\n        }\n      ]\n    },\n    \"package\": {\n      \"name\": \"package\",\n      \"attestations\": [\n        {\n          \"type\": \"https://witness.dev/attestations/material/v0.1\"\n        },\n        {\n          \"type\": \"https://witness.dev/attestations/product/v0.1\"\n        }\n      ],\n      \"functionaries\": [\n        {\n          \"type\": \"publickey\",\n          \"publickeyid\": \"ci-key\"\n        }\n      ]\n    }\n  }\n}\n```\n\n**Pipeline Commands:**\n\n```bash\n# Step 1: Build\nwitness run --step build \\\n  --attestations git,commandrun,product \\\n  -o build.json --key ci-key.pem \\\n  -- go build -o myapp\n\n# Step 2: Test\nwitness run --step test \\\n  --attestations material,commandrun \\\n  -o test.json --key ci-key.pem \\\n  -- go test ./...\n\n# Step 3: Package\nwitness run --step package \\\n  --attestations material,product \\\n  -o package.json --key ci-key.pem \\\n  -- tar czf myapp.tar.gz myapp\n\n# Verify entire pipeline\nwitness verify \\\n  --policy policy-signed.json \\\n  --publickey policy-key.pub \\\n  -a build.json -a test.json -a package.json\n```\n"}]}
{"messages": [{"role": "system", "content": "You are an expert in the Witness supply chain attestation framework. You help users instrument CI/CD pipelines with witness, create policy documents, and write Rego policies to validate attestations. You understand all attestors in go-witness and how to use them effectively."}, {"role": "user", "content": "How do I create a witness policy for a build step that uses these attestors: environment, commandrun, git?"}, {"role": "assistant", "content": "Here's a complete witness policy for your build step with environment, commandrun, git attestors:\n\n**Policy Document:**\n```json\n{\n  \"expires\": \"2026-11-08T10:52:59Z\",\n  \"publickeys\": {\n    \"build-key\": {\n      \"keyid\": \"sha256:c04467ea7eafd04dbe91174e6069d6b3c03eceea91fad3ac0a910e84221b8ca1\",\n      \"key\": \"-----BEGIN PUBLIC KEY-----\\n...\\n-----END PUBLIC KEY-----\"\n    }\n  },\n  \"steps\": {\n    \"build\": {\n      \"name\": \"build\",\n      \"attestations\": [\n        {\n          \"type\": \"https://witness.dev/attestations/environment/v0.1\"\n        },\n        {\n          \"type\": \"https://witness.dev/attestations/command-run/v0.1\"\n        },\n        {\n          \"type\": \"https://witness.dev/attestations/git/v0.1\"\n        }\n      ],\n      \"functionaries\": [\n        {\n          \"type\": \"publickey\",\n          \"publickeyid\": \"build-key\"\n        }\n      ]\n    }\n  }\n}\n```\n\n**Witness Run Command:**\n```bash\nwitness run --step build \\\n  --attestations environment,commandrun,git \\\n  --outfile build-attestation.json \\\n  --key signing-key.pem \\\n  -- <your-build-command>\n```\n\n**Rego Validation Rules:**\n```rego\npackage environment\n\nimport rego.v1\n\n# Ensure correct OS\ndeny contains msg if {\n    input.os != \"linux\"\n    msg := sprintf(\"Must run on linux, got: %s\", [input.os])\n}\n\n# Require CI environment\ndeny contains msg if {\n    not \"CI\" in input.variables\n    msg := \"Must run in CI environment (CI variable not set)\"\n}\n```\n\n**Verification:**\n```bash\nwitness verify \\\n  --policy policy-signed.json \\\n  --publickey policy-key.pub \\\n  -a build-attestation.json \\\n  --subject <artifact>\n```\n"}]}
{"messages": [{"role": "system", "content": "You are an expert in the Witness supply chain attestation framework. You help users instrument CI/CD pipelines with witness, create policy documents, and write Rego policies to validate attestations. You understand all attestors in go-witness and how to use them effectively."}, {"role": "user", "content": "How do I create a witness policy for a build step that uses these attestors: git?"}, {"role": "assistant", "content": "Here's a complete witness policy for your build step with git attestors:\n\n**Policy Document:**\n```json\n{\n  \"expires\": \"2026-11-08T10:52:59Z\",\n  \"publickeys\": {\n    \"build-key\": {\n      \"keyid\": \"sha256:d62599c7e4341295ba097127e2e96e258dc3dbf7b27f6bdd382a8b922657d2b0\",\n      \"key\": \"-----BEGIN PUBLIC KEY-----\\n...\\n-----END PUBLIC KEY-----\"\n    }\n  },\n  \"steps\": {\n    \"build\": {\n      \"name\": \"build\",\n      \"attestations\": [\n        {\n          \"type\": \"https://witness.dev/attestations/git/v0.1\"\n        }\n      ],\n      \"functionaries\": [\n        {\n          \"type\": \"publickey\",\n          \"publickeyid\": \"build-key\"\n        }\n      ]\n    }\n  }\n}\n```\n\n**Witness Run Command:**\n```bash\nwitness run --step build \\\n  --attestations git \\\n  --outfile build-attestation.json \\\n  --key signing-key.pem \\\n  -- <your-build-command>\n```\n\n**Rego Validation Rules:**\n```rego\npackage git\n\nimport rego.v1\n\n# Enforce builds from specific branch\ndeny contains msg if {\n    input.branch != \"release/v1.0\"\n    msg := sprintf(\"Must build from release/v1.0 branch, got: %s\", [input.branch])\n}\n\n# Require clean working directory\ndeny contains msg if {\n    count(input.status) > 0\n    msg := \"Working directory must be clean (no uncommitted changes)\"\n}\n\n# Validate commit author\napproved_authors := {\n    \"alice.smith@example.com\",\n    \"bob.jones@company.com\",\n    \"ci-bot@company.com\"\n}\n\ndeny contains msg if {\n    not input.authoremail in approved_authors\n    msg := sprintf(\"Unauthorized commit author: %s\", [input.authoremail])\n}\n```\n\n**Verification:**\n```bash\nwitness verify \\\n  --policy policy-signed.json \\\n  --publickey policy-key.pub \\\n  -a build-attestation.json \\\n  --subject <artifact>\n```\n"}]}
{"messages": [{"role": "system", "content": "You are an expert in the Witness supply chain attestation framework. You help users instrument CI/CD pipelines with witness, create policy documents, and write Rego policies to validate attestations. You understand all attestors in go-witness and how to use them effectively."}, {"role": "user", "content": "How do I create a witness policy for a build step that uses these attestors: git, material, environment?"}, {"role": "assistant", "content": "Here's a complete witness policy for your build step with git, material, environment attestors:\n\n**Policy Document:**\n```json\n{\n  \"expires\": \"2026-11-08T10:52:59Z\",\n  \"publickeys\": {\n    \"build-key\": {\n      \"keyid\": \"sha256:454fe4937214e98717e683fc893b56db5e8f5277b1305326ee9b48c8b385a3f2\",\n      \"key\": \"-----BEGIN PUBLIC KEY-----\\n...\\n-----END PUBLIC KEY-----\"\n    }\n  },\n  \"steps\": {\n    \"build\": {\n      \"name\": \"build\",\n      \"attestations\": [\n        {\n          \"type\": \"https://witness.dev/attestations/git/v0.1\"\n        },\n        {\n          \"type\": \"https://witness.dev/attestations/material/v0.1\"\n        },\n        {\n          \"type\": \"https://witness.dev/attestations/environment/v0.1\"\n        }\n      ],\n      \"functionaries\": [\n        {\n          \"type\": \"publickey\",\n          \"publickeyid\": \"build-key\"\n        }\n      ]\n    }\n  }\n}\n```\n\n**Witness Run Command:**\n```bash\nwitness run --step build \\\n  --attestations git,material,environment \\\n  --outfile build-attestation.json \\\n  --key signing-key.pem \\\n  -- <your-build-command>\n```\n\n**Rego Validation Rules:**\n```rego\npackage git\n\nimport rego.v1\n\n# Enforce builds from specific branch\ndeny contains msg if {\n    input.branch != \"develop\"\n    msg := sprintf(\"Must build from develop branch, got: %s\", [input.branch])\n}\n\n# Require clean working directory\ndeny contains msg if {\n    count(input.status) > 0\n    msg := \"Working directory must be clean (no uncommitted changes)\"\n}\n\n# Validate commit author\napproved_authors := {\n    \"alice.smith@example.com\",\n    \"bob.jones@company.com\",\n    \"ci-bot@company.com\"\n}\n\ndeny contains msg if {\n    not input.authoremail in approved_authors\n    msg := sprintf(\"Unauthorized commit author: %s\", [input.authoremail])\n}\n```\n\n**Verification:**\n```bash\nwitness verify \\\n  --policy policy-signed.json \\\n  --publickey policy-key.pub \\\n  -a build-attestation.json \\\n  --subject <artifact>\n```\n"}]}
{"messages": [{"role": "system", "content": "You are an expert in the Witness supply chain attestation framework. You help users instrument CI/CD pipelines with witness, create policy documents, and write Rego policies to validate attestations. You understand all attestors in go-witness and how to use them effectively."}, {"role": "user", "content": "How do I create a witness policy for a build step that uses these attestors: github, product, environment?"}, {"role": "assistant", "content": "Here's a complete witness policy for your build step with github, product, environment attestors:\n\n**Policy Document:**\n```json\n{\n  \"expires\": \"2026-11-08T10:52:59Z\",\n  \"publickeys\": {\n    \"build-key\": {\n      \"keyid\": \"sha256:7444d379aecde25de0e31373f373dad98584868a7c5fb5fde51a8058c51e3baa\",\n      \"key\": \"-----BEGIN PUBLIC KEY-----\\n...\\n-----END PUBLIC KEY-----\"\n    }\n  },\n  \"steps\": {\n    \"build\": {\n      \"name\": \"build\",\n      \"attestations\": [\n        {\n          \"type\": \"https://witness.dev/attestations/github/v0.1\"\n        },\n        {\n          \"type\": \"https://witness.dev/attestations/product/v0.1\"\n        },\n        {\n          \"type\": \"https://witness.dev/attestations/environment/v0.1\"\n        }\n      ],\n      \"functionaries\": [\n        {\n          \"type\": \"publickey\",\n          \"publickeyid\": \"build-key\"\n        }\n      ]\n    }\n  }\n}\n```\n\n**Witness Run Command:**\n```bash\nwitness run --step build \\\n  --attestations github,product,environment \\\n  --outfile build-attestation.json \\\n  --key signing-key.pem \\\n  -- <your-build-command>\n```\n\n**Rego Validation Rules:**\n```rego\n\n```\n\n**Verification:**\n```bash\nwitness verify \\\n  --policy policy-signed.json \\\n  --publickey policy-key.pub \\\n  -a build-attestation.json \\\n  --subject <artifact>\n```\n"}]}
{"messages": [{"role": "system", "content": "You are an expert in the Witness supply chain attestation framework. You help users instrument CI/CD pipelines with witness, create policy documents, and write Rego policies to validate attestations. You understand all attestors in go-witness and how to use them effectively."}, {"role": "user", "content": "How do I create a witness policy for a build step that uses these attestors: github, product?"}, {"role": "assistant", "content": "Here's a complete witness policy for your build step with github, product attestors:\n\n**Policy Document:**\n```json\n{\n  \"expires\": \"2026-11-08T10:52:59Z\",\n  \"publickeys\": {\n    \"build-key\": {\n      \"keyid\": \"sha256:cd592ee62b5b15f5e4b2f6f393b8504e479a86160b399c7b363499ce70286f15\",\n      \"key\": \"-----BEGIN PUBLIC KEY-----\\n...\\n-----END PUBLIC KEY-----\"\n    }\n  },\n  \"steps\": {\n    \"build\": {\n      \"name\": \"build\",\n      \"attestations\": [\n        {\n          \"type\": \"https://witness.dev/attestations/github/v0.1\"\n        },\n        {\n          \"type\": \"https://witness.dev/attestations/product/v0.1\"\n        }\n      ],\n      \"functionaries\": [\n        {\n          \"type\": \"publickey\",\n          \"publickeyid\": \"build-key\"\n        }\n      ]\n    }\n  }\n}\n```\n\n**Witness Run Command:**\n```bash\nwitness run --step build \\\n  --attestations github,product \\\n  --outfile build-attestation.json \\\n  --key signing-key.pem \\\n  -- <your-build-command>\n```\n\n**Rego Validation Rules:**\n```rego\n\n```\n\n**Verification:**\n```bash\nwitness verify \\\n  --policy policy-signed.json \\\n  --publickey policy-key.pub \\\n  -a build-attestation.json \\\n  --subject <artifact>\n```\n"}]}
{"messages": [{"role": "system", "content": "You are an expert in the Witness supply chain attestation framework. You help users instrument CI/CD pipelines with witness, create policy documents, and write Rego policies to validate attestations. You understand all attestors in go-witness and how to use them effectively."}, {"role": "user", "content": "How do I create a witness policy for a build step that uses these attestors: commandrun, git, material, environment, product?"}, {"role": "assistant", "content": "Here's a complete witness policy for your build step with commandrun, git, material, environment, product attestors:\n\n**Policy Document:**\n```json\n{\n  \"expires\": \"2026-11-08T10:52:59Z\",\n  \"publickeys\": {\n    \"build-key\": {\n      \"keyid\": \"sha256:98ecafb2ca4bcb2f8f2aca97f10a41d74634c690848365a53bd4da4f95583380\",\n      \"key\": \"-----BEGIN PUBLIC KEY-----\\n...\\n-----END PUBLIC KEY-----\"\n    }\n  },\n  \"steps\": {\n    \"build\": {\n      \"name\": \"build\",\n      \"attestations\": [\n        {\n          \"type\": \"https://witness.dev/attestations/command-run/v0.1\"\n        },\n        {\n          \"type\": \"https://witness.dev/attestations/git/v0.1\"\n        },\n        {\n          \"type\": \"https://witness.dev/attestations/material/v0.1\"\n        },\n        {\n          \"type\": \"https://witness.dev/attestations/environment/v0.1\"\n        },\n        {\n          \"type\": \"https://witness.dev/attestations/product/v0.1\"\n        }\n      ],\n      \"functionaries\": [\n        {\n          \"type\": \"publickey\",\n          \"publickeyid\": \"build-key\"\n        }\n      ]\n    }\n  }\n}\n```\n\n**Witness Run Command:**\n```bash\nwitness run --step build \\\n  --attestations commandrun,git,material,environment,product \\\n  --outfile build-attestation.json \\\n  --key signing-key.pem \\\n  -- <your-build-command>\n```\n\n**Rego Validation Rules:**\n```rego\n\n```\n\n**Verification:**\n```bash\nwitness verify \\\n  --policy policy-signed.json \\\n  --publickey policy-key.pub \\\n  -a build-attestation.json \\\n  --subject <artifact>\n```\n"}]}
{"messages": [{"role": "system", "content": "You are an expert in the Witness supply chain attestation framework. You help users instrument CI/CD pipelines with witness, create policy documents, and write Rego policies to validate attestations. You understand all attestors in go-witness and how to use them effectively."}, {"role": "user", "content": "How do I create a witness policy for a build step that uses these attestors: git, github?"}, {"role": "assistant", "content": "Here's a complete witness policy for your build step with git, github attestors:\n\n**Policy Document:**\n```json\n{\n  \"expires\": \"2026-11-08T10:52:59Z\",\n  \"publickeys\": {\n    \"build-key\": {\n      \"keyid\": \"sha256:14e94a4b7dcc25913b35fd7c6a9a57f936959d5f12f22bf7704c99487587e892\",\n      \"key\": \"-----BEGIN PUBLIC KEY-----\\n...\\n-----END PUBLIC KEY-----\"\n    }\n  },\n  \"steps\": {\n    \"build\": {\n      \"name\": \"build\",\n      \"attestations\": [\n        {\n          \"type\": \"https://witness.dev/attestations/git/v0.1\"\n        },\n        {\n          \"type\": \"https://witness.dev/attestations/github/v0.1\"\n        }\n      ],\n      \"functionaries\": [\n        {\n          \"type\": \"publickey\",\n          \"publickeyid\": \"build-key\"\n        }\n      ]\n    }\n  }\n}\n```\n\n**Witness Run Command:**\n```bash\nwitness run --step build \\\n  --attestations git,github \\\n  --outfile build-attestation.json \\\n  --key signing-key.pem \\\n  -- <your-build-command>\n```\n\n**Rego Validation Rules:**\n```rego\npackage git\n\nimport rego.v1\n\n# Enforce builds from specific branch\ndeny contains msg if {\n    input.branch != \"feature/api\"\n    msg := sprintf(\"Must build from feature/api branch, got: %s\", [input.branch])\n}\n\n# Require clean working directory\ndeny contains msg if {\n    count(input.status) > 0\n    msg := \"Working directory must be clean (no uncommitted changes)\"\n}\n\n# Validate commit author\napproved_authors := {\n    \"alice.smith@example.com\",\n    \"bob.jones@company.com\",\n    \"ci-bot@company.com\"\n}\n\ndeny contains msg if {\n    not input.authoremail in approved_authors\n    msg := sprintf(\"Unauthorized commit author: %s\", [input.authoremail])\n}\n```\n\n**Verification:**\n```bash\nwitness verify \\\n  --policy policy-signed.json \\\n  --publickey policy-key.pub \\\n  -a build-attestation.json \\\n  --subject <artifact>\n```\n"}]}
{"messages": [{"role": "system", "content": "You are an expert in the Witness supply chain attestation framework. You help users instrument CI/CD pipelines with witness, create policy documents, and write Rego policies to validate attestations. You understand all attestors in go-witness and how to use them effectively."}, {"role": "user", "content": "How do I create a witness policy for a build step that uses these attestors: environment?"}, {"role": "assistant", "content": "Here's a complete witness policy for your build step with environment attestors:\n\n**Policy Document:**\n```json\n{\n  \"expires\": \"2026-11-08T10:52:59Z\",\n  \"publickeys\": {\n    \"build-key\": {\n      \"keyid\": \"sha256:c3d056d27872e57c6f376363e506d082383c7787ea60002a9953739621944be7\",\n      \"key\": \"-----BEGIN PUBLIC KEY-----\\n...\\n-----END PUBLIC KEY-----\"\n    }\n  },\n  \"steps\": {\n    \"build\": {\n      \"name\": \"build\",\n      \"attestations\": [\n        {\n          \"type\": \"https://witness.dev/attestations/environment/v0.1\"\n        }\n      ],\n      \"functionaries\": [\n        {\n          \"type\": \"publickey\",\n          \"publickeyid\": \"build-key\"\n        }\n      ]\n    }\n  }\n}\n```\n\n**Witness Run Command:**\n```bash\nwitness run --step build \\\n  --attestations environment \\\n  --outfile build-attestation.json \\\n  --key signing-key.pem \\\n  -- <your-build-command>\n```\n\n**Rego Validation Rules:**\n```rego\npackage environment\n\nimport rego.v1\n\n# Ensure correct OS\ndeny contains msg if {\n    input.os != \"linux\"\n    msg := sprintf(\"Must run on linux, got: %s\", [input.os])\n}\n\n# Require CI environment\ndeny contains msg if {\n    not \"CI\" in input.variables\n    msg := \"Must run in CI environment (CI variable not set)\"\n}\n```\n\n**Verification:**\n```bash\nwitness verify \\\n  --policy policy-signed.json \\\n  --publickey policy-key.pub \\\n  -a build-attestation.json \\\n  --subject <artifact>\n```\n"}]}
{"messages": [{"role": "system", "content": "You are an expert in the Witness supply chain attestation framework. You help users instrument CI/CD pipelines with witness, create policy documents, and write Rego policies to validate attestations. You understand all attestors in go-witness and how to use them effectively."}, {"role": "user", "content": "How do I create a multi-step witness policy for a build \u2192 test \u2192 package pipeline?"}, {"role": "assistant", "content": "Here's a complete multi-step witness policy for your pipeline:\n\n**Policy Document:**\n```json\n{\n  \"expires\": \"2026-11-08T10:52:59Z\",\n  \"publickeys\": {\n    \"ci-key\": {\n      \"keyid\": \"sha256:80ad07c9acf21f068f1b2199126a591c08a11af86837b2bb5cd4f72a7cf3943f\",\n      \"key\": \"-----BEGIN PUBLIC KEY-----\\n...\\n-----END PUBLIC KEY-----\"\n    }\n  },\n  \"steps\": {\n    \"build\": {\n      \"name\": \"build\",\n      \"attestations\": [\n        {\n          \"type\": \"https://witness.dev/attestations/git/v0.1\"\n        },\n        {\n          \"type\": \"https://witness.dev/attestations/command-run/v0.1\"\n        },\n        {\n          \"type\": \"https://witness.dev/attestations/product/v0.1\"\n        }\n      ],\n      \"functionaries\": [\n        {\n          \"type\": \"publickey\",\n          \"publickeyid\": \"ci-key\"\n        }\n      ]\n    },\n    \"test\": {\n      \"name\": \"test\",\n      \"attestations\": [\n        {\n          \"type\": \"https://witness.dev/attestations/material/v0.1\"\n        },\n        {\n          \"type\": \"https://witness.dev/attestations/command-run/v0.1\"\n        }\n      ],\n      \"functionaries\": [\n        {\n          \"type\": \"publickey\",\n          \"publickeyid\": \"ci-key\"\n        }\n      ]\n    },\n    \"package\": {\n      \"name\": \"package\",\n      \"attestations\": [\n        {\n          \"type\": \"https://witness.dev/attestations/material/v0.1\"\n        },\n        {\n          \"type\": \"https://witness.dev/attestations/product/v0.1\"\n        }\n      ],\n      \"functionaries\": [\n        {\n          \"type\": \"publickey\",\n          \"publickeyid\": \"ci-key\"\n        }\n      ]\n    }\n  }\n}\n```\n\n**Pipeline Commands:**\n\n```bash\n# Step 1: Build\nwitness run --step build \\\n  --attestations git,commandrun,product \\\n  -o build.json --key ci-key.pem \\\n  -- go build -o myapp\n\n# Step 2: Test\nwitness run --step test \\\n  --attestations material,commandrun \\\n  -o test.json --key ci-key.pem \\\n  -- go test ./...\n\n# Step 3: Package\nwitness run --step package \\\n  --attestations material,product \\\n  -o package.json --key ci-key.pem \\\n  -- tar czf myapp.tar.gz myapp\n\n# Verify entire pipeline\nwitness verify \\\n  --policy policy-signed.json \\\n  --publickey policy-key.pub \\\n  -a build.json -a test.json -a package.json\n```\n"}]}
{"messages": [{"role": "system", "content": "You are an expert in the Witness supply chain attestation framework. You help users instrument CI/CD pipelines with witness, create policy documents, and write Rego policies to validate attestations. You understand all attestors in go-witness and how to use them effectively."}, {"role": "user", "content": "How do I create a witness policy for a build step that uses these attestors: product, material?"}, {"role": "assistant", "content": "Here's a complete witness policy for your build step with product, material attestors:\n\n**Policy Document:**\n```json\n{\n  \"expires\": \"2026-11-08T10:52:59Z\",\n  \"publickeys\": {\n    \"build-key\": {\n      \"keyid\": \"sha256:5293017f103a3e50a94341be71645f3e126049330d3b0d514d17aa8e728bdb39\",\n      \"key\": \"-----BEGIN PUBLIC KEY-----\\n...\\n-----END PUBLIC KEY-----\"\n    }\n  },\n  \"steps\": {\n    \"build\": {\n      \"name\": \"build\",\n      \"attestations\": [\n        {\n          \"type\": \"https://witness.dev/attestations/product/v0.1\"\n        },\n        {\n          \"type\": \"https://witness.dev/attestations/material/v0.1\"\n        }\n      ],\n      \"functionaries\": [\n        {\n          \"type\": \"publickey\",\n          \"publickeyid\": \"build-key\"\n        }\n      ]\n    }\n  }\n}\n```\n\n**Witness Run Command:**\n```bash\nwitness run --step build \\\n  --attestations product,material \\\n  --outfile build-attestation.json \\\n  --key signing-key.pem \\\n  -- <your-build-command>\n```\n\n**Rego Validation Rules:**\n```rego\n\n```\n\n**Verification:**\n```bash\nwitness verify \\\n  --policy policy-signed.json \\\n  --publickey policy-key.pub \\\n  -a build-attestation.json \\\n  --subject <artifact>\n```\n"}]}
{"messages": [{"role": "system", "content": "You are an expert in the Witness supply chain attestation framework. You help users instrument CI/CD pipelines with witness, create policy documents, and write Rego policies to validate attestations. You understand all attestors in go-witness and how to use them effectively."}, {"role": "user", "content": "How do I create a witness policy for a build step that uses these attestors: git, environment, github, commandrun, material?"}, {"role": "assistant", "content": "Here's a complete witness policy for your build step with git, environment, github, commandrun, material attestors:\n\n**Policy Document:**\n```json\n{\n  \"expires\": \"2026-11-08T10:52:59Z\",\n  \"publickeys\": {\n    \"build-key\": {\n      \"keyid\": \"sha256:dc95d7006007be4248b8e92b6564bcf275bfbaa5320a2bfeb5a91a42847f0947\",\n      \"key\": \"-----BEGIN PUBLIC KEY-----\\n...\\n-----END PUBLIC KEY-----\"\n    }\n  },\n  \"steps\": {\n    \"build\": {\n      \"name\": \"build\",\n      \"attestations\": [\n        {\n          \"type\": \"https://witness.dev/attestations/git/v0.1\"\n        },\n        {\n          \"type\": \"https://witness.dev/attestations/environment/v0.1\"\n        },\n        {\n          \"type\": \"https://witness.dev/attestations/github/v0.1\"\n        },\n        {\n          \"type\": \"https://witness.dev/attestations/command-run/v0.1\"\n        },\n        {\n          \"type\": \"https://witness.dev/attestations/material/v0.1\"\n        }\n      ],\n      \"functionaries\": [\n        {\n          \"type\": \"publickey\",\n          \"publickeyid\": \"build-key\"\n        }\n      ]\n    }\n  }\n}\n```\n\n**Witness Run Command:**\n```bash\nwitness run --step build \\\n  --attestations git,environment,github,commandrun,material \\\n  --outfile build-attestation.json \\\n  --key signing-key.pem \\\n  -- <your-build-command>\n```\n\n**Rego Validation Rules:**\n```rego\npackage git\n\nimport rego.v1\n\n# Enforce builds from specific branch\ndeny contains msg if {\n    input.branch != \"staging\"\n    msg := sprintf(\"Must build from staging branch, got: %s\", [input.branch])\n}\n\n# Require clean working directory\ndeny contains msg if {\n    count(input.status) > 0\n    msg := \"Working directory must be clean (no uncommitted changes)\"\n}\n\n# Validate commit author\napproved_authors := {\n    \"alice.smith@example.com\",\n    \"bob.jones@company.com\",\n    \"ci-bot@company.com\"\n}\n\ndeny contains msg if {\n    not input.authoremail in approved_authors\n    msg := sprintf(\"Unauthorized commit author: %s\", [input.authoremail])\n}\n```\n\n**Verification:**\n```bash\nwitness verify \\\n  --policy policy-signed.json \\\n  --publickey policy-key.pub \\\n  -a build-attestation.json \\\n  --subject <artifact>\n```\n"}]}
{"messages": [{"role": "system", "content": "You are an expert in the Witness supply chain attestation framework. You help users instrument CI/CD pipelines with witness, create policy documents, and write Rego policies to validate attestations. You understand all attestors in go-witness and how to use them effectively."}, {"role": "user", "content": "How do I create a witness policy for a build step that uses these attestors: material, git, commandrun, product?"}, {"role": "assistant", "content": "Here's a complete witness policy for your build step with material, git, commandrun, product attestors:\n\n**Policy Document:**\n```json\n{\n  \"expires\": \"2026-11-08T10:52:59Z\",\n  \"publickeys\": {\n    \"build-key\": {\n      \"keyid\": \"sha256:1df3b4594657a782b7de602538d596605405d3c53fab2effa8258f6134c8f565\",\n      \"key\": \"-----BEGIN PUBLIC KEY-----\\n...\\n-----END PUBLIC KEY-----\"\n    }\n  },\n  \"steps\": {\n    \"build\": {\n      \"name\": \"build\",\n      \"attestations\": [\n        {\n          \"type\": \"https://witness.dev/attestations/material/v0.1\"\n        },\n        {\n          \"type\": \"https://witness.dev/attestations/git/v0.1\"\n        },\n        {\n          \"type\": \"https://witness.dev/attestations/command-run/v0.1\"\n        },\n        {\n          \"type\": \"https://witness.dev/attestations/product/v0.1\"\n        }\n      ],\n      \"functionaries\": [\n        {\n          \"type\": \"publickey\",\n          \"publickeyid\": \"build-key\"\n        }\n      ]\n    }\n  }\n}\n```\n\n**Witness Run Command:**\n```bash\nwitness run --step build \\\n  --attestations material,git,commandrun,product \\\n  --outfile build-attestation.json \\\n  --key signing-key.pem \\\n  -- <your-build-command>\n```\n\n**Rego Validation Rules:**\n```rego\n\n```\n\n**Verification:**\n```bash\nwitness verify \\\n  --policy policy-signed.json \\\n  --publickey policy-key.pub \\\n  -a build-attestation.json \\\n  --subject <artifact>\n```\n"}]}
{"messages": [{"role": "system", "content": "You are an expert in the Witness supply chain attestation framework. You help users instrument CI/CD pipelines with witness, create policy documents, and write Rego policies to validate attestations. You understand all attestors in go-witness and how to use them effectively."}, {"role": "user", "content": "How do I create a witness policy for a build step that uses these attestors: environment, git, github, material, product?"}, {"role": "assistant", "content": "Here's a complete witness policy for your build step with environment, git, github, material, product attestors:\n\n**Policy Document:**\n```json\n{\n  \"expires\": \"2026-11-08T10:52:59Z\",\n  \"publickeys\": {\n    \"build-key\": {\n      \"keyid\": \"sha256:e5e250ce2ab6839fd34bccd1af7775e9eda981ad2a7780662337ba6edfb3155e\",\n      \"key\": \"-----BEGIN PUBLIC KEY-----\\n...\\n-----END PUBLIC KEY-----\"\n    }\n  },\n  \"steps\": {\n    \"build\": {\n      \"name\": \"build\",\n      \"attestations\": [\n        {\n          \"type\": \"https://witness.dev/attestations/environment/v0.1\"\n        },\n        {\n          \"type\": \"https://witness.dev/attestations/git/v0.1\"\n        },\n        {\n          \"type\": \"https://witness.dev/attestations/github/v0.1\"\n        },\n        {\n          \"type\": \"https://witness.dev/attestations/material/v0.1\"\n        },\n        {\n          \"type\": \"https://witness.dev/attestations/product/v0.1\"\n        }\n      ],\n      \"functionaries\": [\n        {\n          \"type\": \"publickey\",\n          \"publickeyid\": \"build-key\"\n        }\n      ]\n    }\n  }\n}\n```\n\n**Witness Run Command:**\n```bash\nwitness run --step build \\\n  --attestations environment,git,github,material,product \\\n  --outfile build-attestation.json \\\n  --key signing-key.pem \\\n  -- <your-build-command>\n```\n\n**Rego Validation Rules:**\n```rego\npackage environment\n\nimport rego.v1\n\n# Ensure correct OS\ndeny contains msg if {\n    input.os != \"windows\"\n    msg := sprintf(\"Must run on windows, got: %s\", [input.os])\n}\n\n# Require CI environment\ndeny contains msg if {\n    not \"CI\" in input.variables\n    msg := \"Must run in CI environment (CI variable not set)\"\n}\n```\n\n**Verification:**\n```bash\nwitness verify \\\n  --policy policy-signed.json \\\n  --publickey policy-key.pub \\\n  -a build-attestation.json \\\n  --subject <artifact>\n```\n"}]}
{"messages": [{"role": "system", "content": "You are an expert in the Witness supply chain attestation framework. You help users instrument CI/CD pipelines with witness, create policy documents, and write Rego policies to validate attestations. You understand all attestors in go-witness and how to use them effectively."}, {"role": "user", "content": "How do I create a witness policy for a build step that uses these attestors: git, github, environment, product, material?"}, {"role": "assistant", "content": "Here's a complete witness policy for your build step with git, github, environment, product, material attestors:\n\n**Policy Document:**\n```json\n{\n  \"expires\": \"2026-11-08T10:52:59Z\",\n  \"publickeys\": {\n    \"build-key\": {\n      \"keyid\": \"sha256:871ec53c9da57f8ef7e0221f8ec1173f78616bce70e5d83bc8bd75793c69b621\",\n      \"key\": \"-----BEGIN PUBLIC KEY-----\\n...\\n-----END PUBLIC KEY-----\"\n    }\n  },\n  \"steps\": {\n    \"build\": {\n      \"name\": \"build\",\n      \"attestations\": [\n        {\n          \"type\": \"https://witness.dev/attestations/git/v0.1\"\n        },\n        {\n          \"type\": \"https://witness.dev/attestations/github/v0.1\"\n        },\n        {\n          \"type\": \"https://witness.dev/attestations/environment/v0.1\"\n        },\n        {\n          \"type\": \"https://witness.dev/attestations/product/v0.1\"\n        },\n        {\n          \"type\": \"https://witness.dev/attestations/material/v0.1\"\n        }\n      ],\n      \"functionaries\": [\n        {\n          \"type\": \"publickey\",\n          \"publickeyid\": \"build-key\"\n        }\n      ]\n    }\n  }\n}\n```\n\n**Witness Run Command:**\n```bash\nwitness run --step build \\\n  --attestations git,github,environment,product,material \\\n  --outfile build-attestation.json \\\n  --key signing-key.pem \\\n  -- <your-build-command>\n```\n\n**Rego Validation Rules:**\n```rego\npackage git\n\nimport rego.v1\n\n# Enforce builds from specific branch\ndeny contains msg if {\n    input.branch != \"feature/auth\"\n    msg := sprintf(\"Must build from feature/auth branch, got: %s\", [input.branch])\n}\n\n# Require clean working directory\ndeny contains msg if {\n    count(input.status) > 0\n    msg := \"Working directory must be clean (no uncommitted changes)\"\n}\n\n# Validate commit author\napproved_authors := {\n    \"alice.smith@example.com\",\n    \"bob.jones@company.com\",\n    \"ci-bot@company.com\"\n}\n\ndeny contains msg if {\n    not input.authoremail in approved_authors\n    msg := sprintf(\"Unauthorized commit author: %s\", [input.authoremail])\n}\n```\n\n**Verification:**\n```bash\nwitness verify \\\n  --policy policy-signed.json \\\n  --publickey policy-key.pub \\\n  -a build-attestation.json \\\n  --subject <artifact>\n```\n"}]}
{"messages": [{"role": "system", "content": "You are an expert in the Witness supply chain attestation framework. You help users instrument CI/CD pipelines with witness, create policy documents, and write Rego policies to validate attestations. You understand all attestors in go-witness and how to use them effectively."}, {"role": "user", "content": "How do I create a witness policy for a build step that uses these attestors: product, github, environment, commandrun, git?"}, {"role": "assistant", "content": "Here's a complete witness policy for your build step with product, github, environment, commandrun, git attestors:\n\n**Policy Document:**\n```json\n{\n  \"expires\": \"2026-11-08T10:52:59Z\",\n  \"publickeys\": {\n    \"build-key\": {\n      \"keyid\": \"sha256:b241fe3b807394707c2977322481f00f9cb4bfdeeca5a1a6168853852882f547\",\n      \"key\": \"-----BEGIN PUBLIC KEY-----\\n...\\n-----END PUBLIC KEY-----\"\n    }\n  },\n  \"steps\": {\n    \"build\": {\n      \"name\": \"build\",\n      \"attestations\": [\n        {\n          \"type\": \"https://witness.dev/attestations/product/v0.1\"\n        },\n        {\n          \"type\": \"https://witness.dev/attestations/github/v0.1\"\n        },\n        {\n          \"type\": \"https://witness.dev/attestations/environment/v0.1\"\n        },\n        {\n          \"type\": \"https://witness.dev/attestations/command-run/v0.1\"\n        },\n        {\n          \"type\": \"https://witness.dev/attestations/git/v0.1\"\n        }\n      ],\n      \"functionaries\": [\n        {\n          \"type\": \"publickey\",\n          \"publickeyid\": \"build-key\"\n        }\n      ]\n    }\n  }\n}\n```\n\n**Witness Run Command:**\n```bash\nwitness run --step build \\\n  --attestations product,github,environment,commandrun,git \\\n  --outfile build-attestation.json \\\n  --key signing-key.pem \\\n  -- <your-build-command>\n```\n\n**Rego Validation Rules:**\n```rego\n\n```\n\n**Verification:**\n```bash\nwitness verify \\\n  --policy policy-signed.json \\\n  --publickey policy-key.pub \\\n  -a build-attestation.json \\\n  --subject <artifact>\n```\n"}]}
{"messages": [{"role": "system", "content": "You are an expert in the Witness supply chain attestation framework. You help users instrument CI/CD pipelines with witness, create policy documents, and write Rego policies to validate attestations. You understand all attestors in go-witness and how to use them effectively."}, {"role": "user", "content": "How do I create a witness policy for a build step that uses these attestors: product, github?"}, {"role": "assistant", "content": "Here's a complete witness policy for your build step with product, github attestors:\n\n**Policy Document:**\n```json\n{\n  \"expires\": \"2026-11-08T10:52:59Z\",\n  \"publickeys\": {\n    \"build-key\": {\n      \"keyid\": \"sha256:f7272e6e410d469378a2e851b2bb877f74a6256dda078c21a185746d31230c0c\",\n      \"key\": \"-----BEGIN PUBLIC KEY-----\\n...\\n-----END PUBLIC KEY-----\"\n    }\n  },\n  \"steps\": {\n    \"build\": {\n      \"name\": \"build\",\n      \"attestations\": [\n        {\n          \"type\": \"https://witness.dev/attestations/product/v0.1\"\n        },\n        {\n          \"type\": \"https://witness.dev/attestations/github/v0.1\"\n        }\n      ],\n      \"functionaries\": [\n        {\n          \"type\": \"publickey\",\n          \"publickeyid\": \"build-key\"\n        }\n      ]\n    }\n  }\n}\n```\n\n**Witness Run Command:**\n```bash\nwitness run --step build \\\n  --attestations product,github \\\n  --outfile build-attestation.json \\\n  --key signing-key.pem \\\n  -- <your-build-command>\n```\n\n**Rego Validation Rules:**\n```rego\n\n```\n\n**Verification:**\n```bash\nwitness verify \\\n  --policy policy-signed.json \\\n  --publickey policy-key.pub \\\n  -a build-attestation.json \\\n  --subject <artifact>\n```\n"}]}
{"messages": [{"role": "system", "content": "You are an expert in the Witness supply chain attestation framework. You help users instrument CI/CD pipelines with witness, create policy documents, and write Rego policies to validate attestations. You understand all attestors in go-witness and how to use them effectively."}, {"role": "user", "content": "How do I create a witness policy for a build step that uses these attestors: environment, product, git, github?"}, {"role": "assistant", "content": "Here's a complete witness policy for your build step with environment, product, git, github attestors:\n\n**Policy Document:**\n```json\n{\n  \"expires\": \"2026-11-08T10:52:59Z\",\n  \"publickeys\": {\n    \"build-key\": {\n      \"keyid\": \"sha256:f17c81b17b70c5b459c2520858e0916ab57ab38eb0e2bbcaffaae908ff9a27f3\",\n      \"key\": \"-----BEGIN PUBLIC KEY-----\\n...\\n-----END PUBLIC KEY-----\"\n    }\n  },\n  \"steps\": {\n    \"build\": {\n      \"name\": \"build\",\n      \"attestations\": [\n        {\n          \"type\": \"https://witness.dev/attestations/environment/v0.1\"\n        },\n        {\n          \"type\": \"https://witness.dev/attestations/product/v0.1\"\n        },\n        {\n          \"type\": \"https://witness.dev/attestations/git/v0.1\"\n        },\n        {\n          \"type\": \"https://witness.dev/attestations/github/v0.1\"\n        }\n      ],\n      \"functionaries\": [\n        {\n          \"type\": \"publickey\",\n          \"publickeyid\": \"build-key\"\n        }\n      ]\n    }\n  }\n}\n```\n\n**Witness Run Command:**\n```bash\nwitness run --step build \\\n  --attestations environment,product,git,github \\\n  --outfile build-attestation.json \\\n  --key signing-key.pem \\\n  -- <your-build-command>\n```\n\n**Rego Validation Rules:**\n```rego\npackage environment\n\nimport rego.v1\n\n# Ensure correct OS\ndeny contains msg if {\n    input.os != \"linux\"\n    msg := sprintf(\"Must run on linux, got: %s\", [input.os])\n}\n\n# Require CI environment\ndeny contains msg if {\n    not \"CI\" in input.variables\n    msg := \"Must run in CI environment (CI variable not set)\"\n}\n```\n\n**Verification:**\n```bash\nwitness verify \\\n  --policy policy-signed.json \\\n  --publickey policy-key.pub \\\n  -a build-attestation.json \\\n  --subject <artifact>\n```\n"}]}
{"messages": [{"role": "system", "content": "You are an expert in the Witness supply chain attestation framework. You help users instrument CI/CD pipelines with witness, create policy documents, and write Rego policies to validate attestations. You understand all attestors in go-witness and how to use them effectively."}, {"role": "user", "content": "How do I create a multi-step witness policy for a build \u2192 test \u2192 package pipeline?"}, {"role": "assistant", "content": "Here's a complete multi-step witness policy for your pipeline:\n\n**Policy Document:**\n```json\n{\n  \"expires\": \"2026-11-08T10:52:59Z\",\n  \"publickeys\": {\n    \"ci-key\": {\n      \"keyid\": \"sha256:cbcff3e6ad038e77574180d45dd7bb76b61b83f7fbdd57f80bef2845f5f88359\",\n      \"key\": \"-----BEGIN PUBLIC KEY-----\\n...\\n-----END PUBLIC KEY-----\"\n    }\n  },\n  \"steps\": {\n    \"build\": {\n      \"name\": \"build\",\n      \"attestations\": [\n        {\n          \"type\": \"https://witness.dev/attestations/git/v0.1\"\n        },\n        {\n          \"type\": \"https://witness.dev/attestations/command-run/v0.1\"\n        },\n        {\n          \"type\": \"https://witness.dev/attestations/product/v0.1\"\n        }\n      ],\n      \"functionaries\": [\n        {\n          \"type\": \"publickey\",\n          \"publickeyid\": \"ci-key\"\n        }\n      ]\n    },\n    \"test\": {\n      \"name\": \"test\",\n      \"attestations\": [\n        {\n          \"type\": \"https://witness.dev/attestations/material/v0.1\"\n        },\n        {\n          \"type\": \"https://witness.dev/attestations/command-run/v0.1\"\n        }\n      ],\n      \"functionaries\": [\n        {\n          \"type\": \"publickey\",\n          \"publickeyid\": \"ci-key\"\n        }\n      ]\n    },\n    \"package\": {\n      \"name\": \"package\",\n      \"attestations\": [\n        {\n          \"type\": \"https://witness.dev/attestations/material/v0.1\"\n        },\n        {\n          \"type\": \"https://witness.dev/attestations/product/v0.1\"\n        }\n      ],\n      \"functionaries\": [\n        {\n          \"type\": \"publickey\",\n          \"publickeyid\": \"ci-key\"\n        }\n      ]\n    }\n  }\n}\n```\n\n**Pipeline Commands:**\n\n```bash\n# Step 1: Build\nwitness run --step build \\\n  --attestations git,commandrun,product \\\n  -o build.json --key ci-key.pem \\\n  -- go build -o myapp\n\n# Step 2: Test\nwitness run --step test \\\n  --attestations material,commandrun \\\n  -o test.json --key ci-key.pem \\\n  -- go test ./...\n\n# Step 3: Package\nwitness run --step package \\\n  --attestations material,product \\\n  -o package.json --key ci-key.pem \\\n  -- tar czf myapp.tar.gz myapp\n\n# Verify entire pipeline\nwitness verify \\\n  --policy policy-signed.json \\\n  --publickey policy-key.pub \\\n  -a build.json -a test.json -a package.json\n```\n"}]}
{"messages": [{"role": "system", "content": "You are an expert in the Witness supply chain attestation framework. You help users instrument CI/CD pipelines with witness, create policy documents, and write Rego policies to validate attestations. You understand all attestors in go-witness and how to use them effectively."}, {"role": "user", "content": "How do I create a witness policy for a build step that uses these attestors: commandrun, github, environment?"}, {"role": "assistant", "content": "Here's a complete witness policy for your build step with commandrun, github, environment attestors:\n\n**Policy Document:**\n```json\n{\n  \"expires\": \"2026-11-08T10:52:59Z\",\n  \"publickeys\": {\n    \"build-key\": {\n      \"keyid\": \"sha256:79e564a0414c719844dd3e4abaad65ab96eb8e5d0927d2b2517473867794b9b8\",\n      \"key\": \"-----BEGIN PUBLIC KEY-----\\n...\\n-----END PUBLIC KEY-----\"\n    }\n  },\n  \"steps\": {\n    \"build\": {\n      \"name\": \"build\",\n      \"attestations\": [\n        {\n          \"type\": \"https://witness.dev/attestations/command-run/v0.1\"\n        },\n        {\n          \"type\": \"https://witness.dev/attestations/github/v0.1\"\n        },\n        {\n          \"type\": \"https://witness.dev/attestations/environment/v0.1\"\n        }\n      ],\n      \"functionaries\": [\n        {\n          \"type\": \"publickey\",\n          \"publickeyid\": \"build-key\"\n        }\n      ]\n    }\n  }\n}\n```\n\n**Witness Run Command:**\n```bash\nwitness run --step build \\\n  --attestations commandrun,github,environment \\\n  --outfile build-attestation.json \\\n  --key signing-key.pem \\\n  -- <your-build-command>\n```\n\n**Rego Validation Rules:**\n```rego\n\n```\n\n**Verification:**\n```bash\nwitness verify \\\n  --policy policy-signed.json \\\n  --publickey policy-key.pub \\\n  -a build-attestation.json \\\n  --subject <artifact>\n```\n"}]}
{"messages": [{"role": "system", "content": "You are an expert in the Witness supply chain attestation framework. You help users instrument CI/CD pipelines with witness, create policy documents, and write Rego policies to validate attestations. You understand all attestors in go-witness and how to use them effectively."}, {"role": "user", "content": "How do I create a witness policy for a build step that uses these attestors: github, git?"}, {"role": "assistant", "content": "Here's a complete witness policy for your build step with github, git attestors:\n\n**Policy Document:**\n```json\n{\n  \"expires\": \"2026-11-08T10:52:59Z\",\n  \"publickeys\": {\n    \"build-key\": {\n      \"keyid\": \"sha256:af43a649a7dd378c87f28d3ad60771f4d3c63f419636f54e255aed257d17a64b\",\n      \"key\": \"-----BEGIN PUBLIC KEY-----\\n...\\n-----END PUBLIC KEY-----\"\n    }\n  },\n  \"steps\": {\n    \"build\": {\n      \"name\": \"build\",\n      \"attestations\": [\n        {\n          \"type\": \"https://witness.dev/attestations/github/v0.1\"\n        },\n        {\n          \"type\": \"https://witness.dev/attestations/git/v0.1\"\n        }\n      ],\n      \"functionaries\": [\n        {\n          \"type\": \"publickey\",\n          \"publickeyid\": \"build-key\"\n        }\n      ]\n    }\n  }\n}\n```\n\n**Witness Run Command:**\n```bash\nwitness run --step build \\\n  --attestations github,git \\\n  --outfile build-attestation.json \\\n  --key signing-key.pem \\\n  -- <your-build-command>\n```\n\n**Rego Validation Rules:**\n```rego\n\n```\n\n**Verification:**\n```bash\nwitness verify \\\n  --policy policy-signed.json \\\n  --publickey policy-key.pub \\\n  -a build-attestation.json \\\n  --subject <artifact>\n```\n"}]}
{"messages": [{"role": "system", "content": "You are an expert in the Witness supply chain attestation framework. You help users instrument CI/CD pipelines with witness, create policy documents, and write Rego policies to validate attestations. You understand all attestors in go-witness and how to use them effectively."}, {"role": "user", "content": "How do I create a witness policy for a build step that uses these attestors: git, github, environment, product?"}, {"role": "assistant", "content": "Here's a complete witness policy for your build step with git, github, environment, product attestors:\n\n**Policy Document:**\n```json\n{\n  \"expires\": \"2026-11-08T10:52:59Z\",\n  \"publickeys\": {\n    \"build-key\": {\n      \"keyid\": \"sha256:96ad2d271fb91f8971483992bf5dca5d20a2dc86b70ce9b05eabe508344494f0\",\n      \"key\": \"-----BEGIN PUBLIC KEY-----\\n...\\n-----END PUBLIC KEY-----\"\n    }\n  },\n  \"steps\": {\n    \"build\": {\n      \"name\": \"build\",\n      \"attestations\": [\n        {\n          \"type\": \"https://witness.dev/attestations/git/v0.1\"\n        },\n        {\n          \"type\": \"https://witness.dev/attestations/github/v0.1\"\n        },\n        {\n          \"type\": \"https://witness.dev/attestations/environment/v0.1\"\n        },\n        {\n          \"type\": \"https://witness.dev/attestations/product/v0.1\"\n        }\n      ],\n      \"functionaries\": [\n        {\n          \"type\": \"publickey\",\n          \"publickeyid\": \"build-key\"\n        }\n      ]\n    }\n  }\n}\n```\n\n**Witness Run Command:**\n```bash\nwitness run --step build \\\n  --attestations git,github,environment,product \\\n  --outfile build-attestation.json \\\n  --key signing-key.pem \\\n  -- <your-build-command>\n```\n\n**Rego Validation Rules:**\n```rego\npackage git\n\nimport rego.v1\n\n# Enforce builds from specific branch\ndeny contains msg if {\n    input.branch != \"feature/auth\"\n    msg := sprintf(\"Must build from feature/auth branch, got: %s\", [input.branch])\n}\n\n# Validate commit author\napproved_authors := {\n    \"alice.smith@example.com\",\n    \"bob.jones@company.com\",\n    \"ci-bot@company.com\"\n}\n\ndeny contains msg if {\n    not input.authoremail in approved_authors\n    msg := sprintf(\"Unauthorized commit author: %s\", [input.authoremail])\n}\n```\n\n**Verification:**\n```bash\nwitness verify \\\n  --policy policy-signed.json \\\n  --publickey policy-key.pub \\\n  -a build-attestation.json \\\n  --subject <artifact>\n```\n"}]}
{"messages": [{"role": "system", "content": "You are an expert in the Witness supply chain attestation framework. You help users instrument CI/CD pipelines with witness, create policy documents, and write Rego policies to validate attestations. You understand all attestors in go-witness and how to use them effectively."}, {"role": "user", "content": "How do I create a witness policy for a build step that uses these attestors: material, product, github, environment, commandrun?"}, {"role": "assistant", "content": "Here's a complete witness policy for your build step with material, product, github, environment, commandrun attestors:\n\n**Policy Document:**\n```json\n{\n  \"expires\": \"2026-11-08T10:52:59Z\",\n  \"publickeys\": {\n    \"build-key\": {\n      \"keyid\": \"sha256:16b128043ee0fb707d222d0aa5e46e2f593782b749463c84b10818e4d0d25853\",\n      \"key\": \"-----BEGIN PUBLIC KEY-----\\n...\\n-----END PUBLIC KEY-----\"\n    }\n  },\n  \"steps\": {\n    \"build\": {\n      \"name\": \"build\",\n      \"attestations\": [\n        {\n          \"type\": \"https://witness.dev/attestations/material/v0.1\"\n        },\n        {\n          \"type\": \"https://witness.dev/attestations/product/v0.1\"\n        },\n        {\n          \"type\": \"https://witness.dev/attestations/github/v0.1\"\n        },\n        {\n          \"type\": \"https://witness.dev/attestations/environment/v0.1\"\n        },\n        {\n          \"type\": \"https://witness.dev/attestations/command-run/v0.1\"\n        }\n      ],\n      \"functionaries\": [\n        {\n          \"type\": \"publickey\",\n          \"publickeyid\": \"build-key\"\n        }\n      ]\n    }\n  }\n}\n```\n\n**Witness Run Command:**\n```bash\nwitness run --step build \\\n  --attestations material,product,github,environment,commandrun \\\n  --outfile build-attestation.json \\\n  --key signing-key.pem \\\n  -- <your-build-command>\n```\n\n**Rego Validation Rules:**\n```rego\n\n```\n\n**Verification:**\n```bash\nwitness verify \\\n  --policy policy-signed.json \\\n  --publickey policy-key.pub \\\n  -a build-attestation.json \\\n  --subject <artifact>\n```\n"}]}
{"messages": [{"role": "system", "content": "You are an expert in the Witness supply chain attestation framework. You help users instrument CI/CD pipelines with witness, create policy documents, and write Rego policies to validate attestations. You understand all attestors in go-witness and how to use them effectively."}, {"role": "user", "content": "How do I create a multi-step witness policy for a build \u2192 test \u2192 package pipeline?"}, {"role": "assistant", "content": "Here's a complete multi-step witness policy for your pipeline:\n\n**Policy Document:**\n```json\n{\n  \"expires\": \"2026-11-08T10:52:59Z\",\n  \"publickeys\": {\n    \"ci-key\": {\n      \"keyid\": \"sha256:66a1684b698a734ad2164c5035900bfce3cdf9ee45f17c944d41b604d2952005\",\n      \"key\": \"-----BEGIN PUBLIC KEY-----\\n...\\n-----END PUBLIC KEY-----\"\n    }\n  },\n  \"steps\": {\n    \"build\": {\n      \"name\": \"build\",\n      \"attestations\": [\n        {\n          \"type\": \"https://witness.dev/attestations/git/v0.1\"\n        },\n        {\n          \"type\": \"https://witness.dev/attestations/command-run/v0.1\"\n        },\n        {\n          \"type\": \"https://witness.dev/attestations/product/v0.1\"\n        }\n      ],\n      \"functionaries\": [\n        {\n          \"type\": \"publickey\",\n          \"publickeyid\": \"ci-key\"\n        }\n      ]\n    },\n    \"test\": {\n      \"name\": \"test\",\n      \"attestations\": [\n        {\n          \"type\": \"https://witness.dev/attestations/material/v0.1\"\n        },\n        {\n          \"type\": \"https://witness.dev/attestations/command-run/v0.1\"\n        }\n      ],\n      \"functionaries\": [\n        {\n          \"type\": \"publickey\",\n          \"publickeyid\": \"ci-key\"\n        }\n      ]\n    },\n    \"package\": {\n      \"name\": \"package\",\n      \"attestations\": [\n        {\n          \"type\": \"https://witness.dev/attestations/material/v0.1\"\n        },\n        {\n          \"type\": \"https://witness.dev/attestations/product/v0.1\"\n        }\n      ],\n      \"functionaries\": [\n        {\n          \"type\": \"publickey\",\n          \"publickeyid\": \"ci-key\"\n        }\n      ]\n    }\n  }\n}\n```\n\n**Pipeline Commands:**\n\n```bash\n# Step 1: Build\nwitness run --step build \\\n  --attestations git,commandrun,product \\\n  -o build.json --key ci-key.pem \\\n  -- go build -o myapp\n\n# Step 2: Test\nwitness run --step test \\\n  --attestations material,commandrun \\\n  -o test.json --key ci-key.pem \\\n  -- go test ./...\n\n# Step 3: Package\nwitness run --step package \\\n  --attestations material,product \\\n  -o package.json --key ci-key.pem \\\n  -- tar czf myapp.tar.gz myapp\n\n# Verify entire pipeline\nwitness verify \\\n  --policy policy-signed.json \\\n  --publickey policy-key.pub \\\n  -a build.json -a test.json -a package.json\n```\n"}]}
{"messages": [{"role": "system", "content": "You are an expert in the Witness supply chain attestation framework. You help users instrument CI/CD pipelines with witness, create policy documents, and write Rego policies to validate attestations. You understand all attestors in go-witness and how to use them effectively."}, {"role": "user", "content": "How do I create a witness policy for a build step that uses these attestors: environment, material?"}, {"role": "assistant", "content": "Here's a complete witness policy for your build step with environment, material attestors:\n\n**Policy Document:**\n```json\n{\n  \"expires\": \"2026-11-08T10:52:59Z\",\n  \"publickeys\": {\n    \"build-key\": {\n      \"keyid\": \"sha256:0767aaa45b6b246bb0c4d194d0117dffb03a14068284653dbf98e886c2336159\",\n      \"key\": \"-----BEGIN PUBLIC KEY-----\\n...\\n-----END PUBLIC KEY-----\"\n    }\n  },\n  \"steps\": {\n    \"build\": {\n      \"name\": \"build\",\n      \"attestations\": [\n        {\n          \"type\": \"https://witness.dev/attestations/environment/v0.1\"\n        },\n        {\n          \"type\": \"https://witness.dev/attestations/material/v0.1\"\n        }\n      ],\n      \"functionaries\": [\n        {\n          \"type\": \"publickey\",\n          \"publickeyid\": \"build-key\"\n        }\n      ]\n    }\n  }\n}\n```\n\n**Witness Run Command:**\n```bash\nwitness run --step build \\\n  --attestations environment,material \\\n  --outfile build-attestation.json \\\n  --key signing-key.pem \\\n  -- <your-build-command>\n```\n\n**Rego Validation Rules:**\n```rego\npackage environment\n\nimport rego.v1\n\n# Ensure correct OS\ndeny contains msg if {\n    input.os != \"linux\"\n    msg := sprintf(\"Must run on linux, got: %s\", [input.os])\n}\n\n# Require CI environment\ndeny contains msg if {\n    not \"CI\" in input.variables\n    msg := \"Must run in CI environment (CI variable not set)\"\n}\n```\n\n**Verification:**\n```bash\nwitness verify \\\n  --policy policy-signed.json \\\n  --publickey policy-key.pub \\\n  -a build-attestation.json \\\n  --subject <artifact>\n```\n"}]}
{"messages": [{"role": "system", "content": "You are an expert in the Witness supply chain attestation framework. You help users instrument CI/CD pipelines with witness, create policy documents, and write Rego policies to validate attestations. You understand all attestors in go-witness and how to use them effectively."}, {"role": "user", "content": "How do I create a witness policy for a build step that uses these attestors: material, git, product, commandrun, environment?"}, {"role": "assistant", "content": "Here's a complete witness policy for your build step with material, git, product, commandrun, environment attestors:\n\n**Policy Document:**\n```json\n{\n  \"expires\": \"2026-11-08T10:52:59Z\",\n  \"publickeys\": {\n    \"build-key\": {\n      \"keyid\": \"sha256:733b7c6b7fd811ba1c9f6ef2a5d93bf90a4ceea3eb9bd7cd82a662a2d62bfb86\",\n      \"key\": \"-----BEGIN PUBLIC KEY-----\\n...\\n-----END PUBLIC KEY-----\"\n    }\n  },\n  \"steps\": {\n    \"build\": {\n      \"name\": \"build\",\n      \"attestations\": [\n        {\n          \"type\": \"https://witness.dev/attestations/material/v0.1\"\n        },\n        {\n          \"type\": \"https://witness.dev/attestations/git/v0.1\"\n        },\n        {\n          \"type\": \"https://witness.dev/attestations/product/v0.1\"\n        },\n        {\n          \"type\": \"https://witness.dev/attestations/command-run/v0.1\"\n        },\n        {\n          \"type\": \"https://witness.dev/attestations/environment/v0.1\"\n        }\n      ],\n      \"functionaries\": [\n        {\n          \"type\": \"publickey\",\n          \"publickeyid\": \"build-key\"\n        }\n      ]\n    }\n  }\n}\n```\n\n**Witness Run Command:**\n```bash\nwitness run --step build \\\n  --attestations material,git,product,commandrun,environment \\\n  --outfile build-attestation.json \\\n  --key signing-key.pem \\\n  -- <your-build-command>\n```\n\n**Rego Validation Rules:**\n```rego\n\n```\n\n**Verification:**\n```bash\nwitness verify \\\n  --policy policy-signed.json \\\n  --publickey policy-key.pub \\\n  -a build-attestation.json \\\n  --subject <artifact>\n```\n"}]}
{"messages": [{"role": "system", "content": "You are an expert in the Witness supply chain attestation framework. You help users instrument CI/CD pipelines with witness, create policy documents, and write Rego policies to validate attestations. You understand all attestors in go-witness and how to use them effectively."}, {"role": "user", "content": "How do I create a witness policy for a build step that uses these attestors: commandrun, git, github, environment?"}, {"role": "assistant", "content": "Here's a complete witness policy for your build step with commandrun, git, github, environment attestors:\n\n**Policy Document:**\n```json\n{\n  \"expires\": \"2026-11-08T10:52:59Z\",\n  \"publickeys\": {\n    \"build-key\": {\n      \"keyid\": \"sha256:546999ae3b38278791d8cbdfe878e7253b6336920d92bd1cf59df60218018cc7\",\n      \"key\": \"-----BEGIN PUBLIC KEY-----\\n...\\n-----END PUBLIC KEY-----\"\n    }\n  },\n  \"steps\": {\n    \"build\": {\n      \"name\": \"build\",\n      \"attestations\": [\n        {\n          \"type\": \"https://witness.dev/attestations/command-run/v0.1\"\n        },\n        {\n          \"type\": \"https://witness.dev/attestations/git/v0.1\"\n        },\n        {\n          \"type\": \"https://witness.dev/attestations/github/v0.1\"\n        },\n        {\n          \"type\": \"https://witness.dev/attestations/environment/v0.1\"\n        }\n      ],\n      \"functionaries\": [\n        {\n          \"type\": \"publickey\",\n          \"publickeyid\": \"build-key\"\n        }\n      ]\n    }\n  }\n}\n```\n\n**Witness Run Command:**\n```bash\nwitness run --step build \\\n  --attestations commandrun,git,github,environment \\\n  --outfile build-attestation.json \\\n  --key signing-key.pem \\\n  -- <your-build-command>\n```\n\n**Rego Validation Rules:**\n```rego\n\n```\n\n**Verification:**\n```bash\nwitness verify \\\n  --policy policy-signed.json \\\n  --publickey policy-key.pub \\\n  -a build-attestation.json \\\n  --subject <artifact>\n```\n"}]}
{"messages": [{"role": "system", "content": "You are an expert in the Witness supply chain attestation framework. You help users instrument CI/CD pipelines with witness, create policy documents, and write Rego policies to validate attestations. You understand all attestors in go-witness and how to use them effectively."}, {"role": "user", "content": "How do I create a multi-step witness policy for a build \u2192 test \u2192 package pipeline?"}, {"role": "assistant", "content": "Here's a complete multi-step witness policy for your pipeline:\n\n**Policy Document:**\n```json\n{\n  \"expires\": \"2026-11-08T10:52:59Z\",\n  \"publickeys\": {\n    \"ci-key\": {\n      \"keyid\": \"sha256:36785f179a0e5cfe90360267a7f1e5da9411b145a7d4e157ced10fb635fb2bb1\",\n      \"key\": \"-----BEGIN PUBLIC KEY-----\\n...\\n-----END PUBLIC KEY-----\"\n    }\n  },\n  \"steps\": {\n    \"build\": {\n      \"name\": \"build\",\n      \"attestations\": [\n        {\n          \"type\": \"https://witness.dev/attestations/git/v0.1\"\n        },\n        {\n          \"type\": \"https://witness.dev/attestations/command-run/v0.1\"\n        },\n        {\n          \"type\": \"https://witness.dev/attestations/product/v0.1\"\n        }\n      ],\n      \"functionaries\": [\n        {\n          \"type\": \"publickey\",\n          \"publickeyid\": \"ci-key\"\n        }\n      ]\n    },\n    \"test\": {\n      \"name\": \"test\",\n      \"attestations\": [\n        {\n          \"type\": \"https://witness.dev/attestations/material/v0.1\"\n        },\n        {\n          \"type\": \"https://witness.dev/attestations/command-run/v0.1\"\n        }\n      ],\n      \"functionaries\": [\n        {\n          \"type\": \"publickey\",\n          \"publickeyid\": \"ci-key\"\n        }\n      ]\n    },\n    \"package\": {\n      \"name\": \"package\",\n      \"attestations\": [\n        {\n          \"type\": \"https://witness.dev/attestations/material/v0.1\"\n        },\n        {\n          \"type\": \"https://witness.dev/attestations/product/v0.1\"\n        }\n      ],\n      \"functionaries\": [\n        {\n          \"type\": \"publickey\",\n          \"publickeyid\": \"ci-key\"\n        }\n      ]\n    }\n  }\n}\n```\n\n**Pipeline Commands:**\n\n```bash\n# Step 1: Build\nwitness run --step build \\\n  --attestations git,commandrun,product \\\n  -o build.json --key ci-key.pem \\\n  -- go build -o myapp\n\n# Step 2: Test\nwitness run --step test \\\n  --attestations material,commandrun \\\n  -o test.json --key ci-key.pem \\\n  -- go test ./...\n\n# Step 3: Package\nwitness run --step package \\\n  --attestations material,product \\\n  -o package.json --key ci-key.pem \\\n  -- tar czf myapp.tar.gz myapp\n\n# Verify entire pipeline\nwitness verify \\\n  --policy policy-signed.json \\\n  --publickey policy-key.pub \\\n  -a build.json -a test.json -a package.json\n```\n"}]}
{"messages": [{"role": "system", "content": "You are an expert in the Witness supply chain attestation framework. You help users instrument CI/CD pipelines with witness, create policy documents, and write Rego policies to validate attestations. You understand all attestors in go-witness and how to use them effectively."}, {"role": "user", "content": "How do I create a multi-step witness policy for a build \u2192 test \u2192 package pipeline?"}, {"role": "assistant", "content": "Here's a complete multi-step witness policy for your pipeline:\n\n**Policy Document:**\n```json\n{\n  \"expires\": \"2026-11-08T10:52:59Z\",\n  \"publickeys\": {\n    \"ci-key\": {\n      \"keyid\": \"sha256:5d3a37daa0facd9f85457440dafeaeb6ee13cfd1e5de5d691bd7bcb712909482\",\n      \"key\": \"-----BEGIN PUBLIC KEY-----\\n...\\n-----END PUBLIC KEY-----\"\n    }\n  },\n  \"steps\": {\n    \"build\": {\n      \"name\": \"build\",\n      \"attestations\": [\n        {\n          \"type\": \"https://witness.dev/attestations/git/v0.1\"\n        },\n        {\n          \"type\": \"https://witness.dev/attestations/command-run/v0.1\"\n        },\n        {\n          \"type\": \"https://witness.dev/attestations/product/v0.1\"\n        }\n      ],\n      \"functionaries\": [\n        {\n          \"type\": \"publickey\",\n          \"publickeyid\": \"ci-key\"\n        }\n      ]\n    },\n    \"test\": {\n      \"name\": \"test\",\n      \"attestations\": [\n        {\n          \"type\": \"https://witness.dev/attestations/material/v0.1\"\n        },\n        {\n          \"type\": \"https://witness.dev/attestations/command-run/v0.1\"\n        }\n      ],\n      \"functionaries\": [\n        {\n          \"type\": \"publickey\",\n          \"publickeyid\": \"ci-key\"\n        }\n      ]\n    },\n    \"package\": {\n      \"name\": \"package\",\n      \"attestations\": [\n        {\n          \"type\": \"https://witness.dev/attestations/material/v0.1\"\n        },\n        {\n          \"type\": \"https://witness.dev/attestations/product/v0.1\"\n        }\n      ],\n      \"functionaries\": [\n        {\n          \"type\": \"publickey\",\n          \"publickeyid\": \"ci-key\"\n        }\n      ]\n    }\n  }\n}\n```\n\n**Pipeline Commands:**\n\n```bash\n# Step 1: Build\nwitness run --step build \\\n  --attestations git,commandrun,product \\\n  -o build.json --key ci-key.pem \\\n  -- go build -o myapp\n\n# Step 2: Test\nwitness run --step test \\\n  --attestations material,commandrun \\\n  -o test.json --key ci-key.pem \\\n  -- go test ./...\n\n# Step 3: Package\nwitness run --step package \\\n  --attestations material,product \\\n  -o package.json --key ci-key.pem \\\n  -- tar czf myapp.tar.gz myapp\n\n# Verify entire pipeline\nwitness verify \\\n  --policy policy-signed.json \\\n  --publickey policy-key.pub \\\n  -a build.json -a test.json -a package.json\n```\n"}]}
{"messages": [{"role": "system", "content": "You are an expert in the Witness supply chain attestation framework. You help users instrument CI/CD pipelines with witness, create policy documents, and write Rego policies to validate attestations. You understand all attestors in go-witness and how to use them effectively."}, {"role": "user", "content": "How do I create a multi-step witness policy for a build \u2192 test \u2192 package pipeline?"}, {"role": "assistant", "content": "Here's a complete multi-step witness policy for your pipeline:\n\n**Policy Document:**\n```json\n{\n  \"expires\": \"2026-11-08T10:52:59Z\",\n  \"publickeys\": {\n    \"ci-key\": {\n      \"keyid\": \"sha256:e3edfbfeb65698abb4132e58a45bce1d4ac7bec96220bf2f8babf5b54a8b75aa\",\n      \"key\": \"-----BEGIN PUBLIC KEY-----\\n...\\n-----END PUBLIC KEY-----\"\n    }\n  },\n  \"steps\": {\n    \"build\": {\n      \"name\": \"build\",\n      \"attestations\": [\n        {\n          \"type\": \"https://witness.dev/attestations/git/v0.1\"\n        },\n        {\n          \"type\": \"https://witness.dev/attestations/command-run/v0.1\"\n        },\n        {\n          \"type\": \"https://witness.dev/attestations/product/v0.1\"\n        }\n      ],\n      \"functionaries\": [\n        {\n          \"type\": \"publickey\",\n          \"publickeyid\": \"ci-key\"\n        }\n      ]\n    },\n    \"test\": {\n      \"name\": \"test\",\n      \"attestations\": [\n        {\n          \"type\": \"https://witness.dev/attestations/material/v0.1\"\n        },\n        {\n          \"type\": \"https://witness.dev/attestations/command-run/v0.1\"\n        }\n      ],\n      \"functionaries\": [\n        {\n          \"type\": \"publickey\",\n          \"publickeyid\": \"ci-key\"\n        }\n      ]\n    },\n    \"package\": {\n      \"name\": \"package\",\n      \"attestations\": [\n        {\n          \"type\": \"https://witness.dev/attestations/material/v0.1\"\n        },\n        {\n          \"type\": \"https://witness.dev/attestations/product/v0.1\"\n        }\n      ],\n      \"functionaries\": [\n        {\n          \"type\": \"publickey\",\n          \"publickeyid\": \"ci-key\"\n        }\n      ]\n    }\n  }\n}\n```\n\n**Pipeline Commands:**\n\n```bash\n# Step 1: Build\nwitness run --step build \\\n  --attestations git,commandrun,product \\\n  -o build.json --key ci-key.pem \\\n  -- go build -o myapp\n\n# Step 2: Test\nwitness run --step test \\\n  --attestations material,commandrun \\\n  -o test.json --key ci-key.pem \\\n  -- go test ./...\n\n# Step 3: Package\nwitness run --step package \\\n  --attestations material,product \\\n  -o package.json --key ci-key.pem \\\n  -- tar czf myapp.tar.gz myapp\n\n# Verify entire pipeline\nwitness verify \\\n  --policy policy-signed.json \\\n  --publickey policy-key.pub \\\n  -a build.json -a test.json -a package.json\n```\n"}]}
{"messages": [{"role": "system", "content": "You are an expert in the Witness supply chain attestation framework. You help users instrument CI/CD pipelines with witness, create policy documents, and write Rego policies to validate attestations. You understand all attestors in go-witness and how to use them effectively."}, {"role": "user", "content": "How do I create a witness policy for a build step that uses these attestors: git?"}, {"role": "assistant", "content": "Here's a complete witness policy for your build step with git attestors:\n\n**Policy Document:**\n```json\n{\n  \"expires\": \"2026-11-08T10:52:59Z\",\n  \"publickeys\": {\n    \"build-key\": {\n      \"keyid\": \"sha256:4c6a7a5f719e61f53897dba53246432e68bfacb4cfe9c7c27e6858baf002187d\",\n      \"key\": \"-----BEGIN PUBLIC KEY-----\\n...\\n-----END PUBLIC KEY-----\"\n    }\n  },\n  \"steps\": {\n    \"build\": {\n      \"name\": \"build\",\n      \"attestations\": [\n        {\n          \"type\": \"https://witness.dev/attestations/git/v0.1\"\n        }\n      ],\n      \"functionaries\": [\n        {\n          \"type\": \"publickey\",\n          \"publickeyid\": \"build-key\"\n        }\n      ]\n    }\n  }\n}\n```\n\n**Witness Run Command:**\n```bash\nwitness run --step build \\\n  --attestations git \\\n  --outfile build-attestation.json \\\n  --key signing-key.pem \\\n  -- <your-build-command>\n```\n\n**Rego Validation Rules:**\n```rego\npackage git\n\nimport rego.v1\n\n# Enforce builds from specific branch\ndeny contains msg if {\n    input.branch != \"hotfix/critical\"\n    msg := sprintf(\"Must build from hotfix/critical branch, got: %s\", [input.branch])\n}\n\n# Validate commit author\napproved_authors := {\n    \"alice.smith@example.com\",\n    \"bob.jones@company.com\",\n    \"ci-bot@company.com\"\n}\n\ndeny contains msg if {\n    not input.authoremail in approved_authors\n    msg := sprintf(\"Unauthorized commit author: %s\", [input.authoremail])\n}\n```\n\n**Verification:**\n```bash\nwitness verify \\\n  --policy policy-signed.json \\\n  --publickey policy-key.pub \\\n  -a build-attestation.json \\\n  --subject <artifact>\n```\n"}]}
{"messages": [{"role": "system", "content": "You are an expert in the Witness supply chain attestation framework. You help users instrument CI/CD pipelines with witness, create policy documents, and write Rego policies to validate attestations. You understand all attestors in go-witness and how to use them effectively."}, {"role": "user", "content": "How do I create a witness policy for a build step that uses these attestors: material, github, commandrun, git?"}, {"role": "assistant", "content": "Here's a complete witness policy for your build step with material, github, commandrun, git attestors:\n\n**Policy Document:**\n```json\n{\n  \"expires\": \"2026-11-08T10:52:59Z\",\n  \"publickeys\": {\n    \"build-key\": {\n      \"keyid\": \"sha256:4eff3c2d5ba8ba661dc28c1aa708154b3f43fc0ee50b000aaa5e2d1c036e157d\",\n      \"key\": \"-----BEGIN PUBLIC KEY-----\\n...\\n-----END PUBLIC KEY-----\"\n    }\n  },\n  \"steps\": {\n    \"build\": {\n      \"name\": \"build\",\n      \"attestations\": [\n        {\n          \"type\": \"https://witness.dev/attestations/material/v0.1\"\n        },\n        {\n          \"type\": \"https://witness.dev/attestations/github/v0.1\"\n        },\n        {\n          \"type\": \"https://witness.dev/attestations/command-run/v0.1\"\n        },\n        {\n          \"type\": \"https://witness.dev/attestations/git/v0.1\"\n        }\n      ],\n      \"functionaries\": [\n        {\n          \"type\": \"publickey\",\n          \"publickeyid\": \"build-key\"\n        }\n      ]\n    }\n  }\n}\n```\n\n**Witness Run Command:**\n```bash\nwitness run --step build \\\n  --attestations material,github,commandrun,git \\\n  --outfile build-attestation.json \\\n  --key signing-key.pem \\\n  -- <your-build-command>\n```\n\n**Rego Validation Rules:**\n```rego\n\n```\n\n**Verification:**\n```bash\nwitness verify \\\n  --policy policy-signed.json \\\n  --publickey policy-key.pub \\\n  -a build-attestation.json \\\n  --subject <artifact>\n```\n"}]}
{"messages": [{"role": "system", "content": "You are an expert in the Witness supply chain attestation framework. You help users instrument CI/CD pipelines with witness, create policy documents, and write Rego policies to validate attestations. You understand all attestors in go-witness and how to use them effectively."}, {"role": "user", "content": "How do I create a witness policy for a build step that uses these attestors: github, commandrun, git, product, material?"}, {"role": "assistant", "content": "Here's a complete witness policy for your build step with github, commandrun, git, product, material attestors:\n\n**Policy Document:**\n```json\n{\n  \"expires\": \"2026-11-08T10:52:59Z\",\n  \"publickeys\": {\n    \"build-key\": {\n      \"keyid\": \"sha256:6d1ac3165f4e71f935ff66da660574a10f90c582eaeb67b832997a93712b7591\",\n      \"key\": \"-----BEGIN PUBLIC KEY-----\\n...\\n-----END PUBLIC KEY-----\"\n    }\n  },\n  \"steps\": {\n    \"build\": {\n      \"name\": \"build\",\n      \"attestations\": [\n        {\n          \"type\": \"https://witness.dev/attestations/github/v0.1\"\n        },\n        {\n          \"type\": \"https://witness.dev/attestations/command-run/v0.1\"\n        },\n        {\n          \"type\": \"https://witness.dev/attestations/git/v0.1\"\n        },\n        {\n          \"type\": \"https://witness.dev/attestations/product/v0.1\"\n        },\n        {\n          \"type\": \"https://witness.dev/attestations/material/v0.1\"\n        }\n      ],\n      \"functionaries\": [\n        {\n          \"type\": \"publickey\",\n          \"publickeyid\": \"build-key\"\n        }\n      ]\n    }\n  }\n}\n```\n\n**Witness Run Command:**\n```bash\nwitness run --step build \\\n  --attestations github,commandrun,git,product,material \\\n  --outfile build-attestation.json \\\n  --key signing-key.pem \\\n  -- <your-build-command>\n```\n\n**Rego Validation Rules:**\n```rego\n\n```\n\n**Verification:**\n```bash\nwitness verify \\\n  --policy policy-signed.json \\\n  --publickey policy-key.pub \\\n  -a build-attestation.json \\\n  --subject <artifact>\n```\n"}]}
{"messages": [{"role": "system", "content": "You are an expert in the Witness supply chain attestation framework. You help users instrument CI/CD pipelines with witness, create policy documents, and write Rego policies to validate attestations. You understand all attestors in go-witness and how to use them effectively."}, {"role": "user", "content": "How do I create a multi-step witness policy for a build \u2192 test \u2192 package pipeline?"}, {"role": "assistant", "content": "Here's a complete multi-step witness policy for your pipeline:\n\n**Policy Document:**\n```json\n{\n  \"expires\": \"2026-11-08T10:52:59Z\",\n  \"publickeys\": {\n    \"ci-key\": {\n      \"keyid\": \"sha256:ced7ddb31b1bf6d9d05dbccd958a3db14881a6df592c6e1ddcb50dc314e52d68\",\n      \"key\": \"-----BEGIN PUBLIC KEY-----\\n...\\n-----END PUBLIC KEY-----\"\n    }\n  },\n  \"steps\": {\n    \"build\": {\n      \"name\": \"build\",\n      \"attestations\": [\n        {\n          \"type\": \"https://witness.dev/attestations/git/v0.1\"\n        },\n        {\n          \"type\": \"https://witness.dev/attestations/command-run/v0.1\"\n        },\n        {\n          \"type\": \"https://witness.dev/attestations/product/v0.1\"\n        }\n      ],\n      \"functionaries\": [\n        {\n          \"type\": \"publickey\",\n          \"publickeyid\": \"ci-key\"\n        }\n      ]\n    },\n    \"test\": {\n      \"name\": \"test\",\n      \"attestations\": [\n        {\n          \"type\": \"https://witness.dev/attestations/material/v0.1\"\n        },\n        {\n          \"type\": \"https://witness.dev/attestations/command-run/v0.1\"\n        }\n      ],\n      \"functionaries\": [\n        {\n          \"type\": \"publickey\",\n          \"publickeyid\": \"ci-key\"\n        }\n      ]\n    },\n    \"package\": {\n      \"name\": \"package\",\n      \"attestations\": [\n        {\n          \"type\": \"https://witness.dev/attestations/material/v0.1\"\n        },\n        {\n          \"type\": \"https://witness.dev/attestations/product/v0.1\"\n        }\n      ],\n      \"functionaries\": [\n        {\n          \"type\": \"publickey\",\n          \"publickeyid\": \"ci-key\"\n        }\n      ]\n    }\n  }\n}\n```\n\n**Pipeline Commands:**\n\n```bash\n# Step 1: Build\nwitness run --step build \\\n  --attestations git,commandrun,product \\\n  -o build.json --key ci-key.pem \\\n  -- go build -o myapp\n\n# Step 2: Test\nwitness run --step test \\\n  --attestations material,commandrun \\\n  -o test.json --key ci-key.pem \\\n  -- go test ./...\n\n# Step 3: Package\nwitness run --step package \\\n  --attestations material,product \\\n  -o package.json --key ci-key.pem \\\n  -- tar czf myapp.tar.gz myapp\n\n# Verify entire pipeline\nwitness verify \\\n  --policy policy-signed.json \\\n  --publickey policy-key.pub \\\n  -a build.json -a test.json -a package.json\n```\n"}]}
{"messages": [{"role": "system", "content": "You are an expert in the Witness supply chain attestation framework. You help users instrument CI/CD pipelines with witness, create policy documents, and write Rego policies to validate attestations. You understand all attestors in go-witness and how to use them effectively."}, {"role": "user", "content": "How do I create a witness policy for a build step that uses these attestors: github, git, commandrun?"}, {"role": "assistant", "content": "Here's a complete witness policy for your build step with github, git, commandrun attestors:\n\n**Policy Document:**\n```json\n{\n  \"expires\": \"2026-11-08T10:52:59Z\",\n  \"publickeys\": {\n    \"build-key\": {\n      \"keyid\": \"sha256:73edf42fad3f82dd5405cd5276096395f64eb6b1eb1957a3028c25e4b90d3396\",\n      \"key\": \"-----BEGIN PUBLIC KEY-----\\n...\\n-----END PUBLIC KEY-----\"\n    }\n  },\n  \"steps\": {\n    \"build\": {\n      \"name\": \"build\",\n      \"attestations\": [\n        {\n          \"type\": \"https://witness.dev/attestations/github/v0.1\"\n        },\n        {\n          \"type\": \"https://witness.dev/attestations/git/v0.1\"\n        },\n        {\n          \"type\": \"https://witness.dev/attestations/command-run/v0.1\"\n        }\n      ],\n      \"functionaries\": [\n        {\n          \"type\": \"publickey\",\n          \"publickeyid\": \"build-key\"\n        }\n      ]\n    }\n  }\n}\n```\n\n**Witness Run Command:**\n```bash\nwitness run --step build \\\n  --attestations github,git,commandrun \\\n  --outfile build-attestation.json \\\n  --key signing-key.pem \\\n  -- <your-build-command>\n```\n\n**Rego Validation Rules:**\n```rego\n\n```\n\n**Verification:**\n```bash\nwitness verify \\\n  --policy policy-signed.json \\\n  --publickey policy-key.pub \\\n  -a build-attestation.json \\\n  --subject <artifact>\n```\n"}]}
{"messages": [{"role": "system", "content": "You are an expert in the Witness supply chain attestation framework. You help users instrument CI/CD pipelines with witness, create policy documents, and write Rego policies to validate attestations. You understand all attestors in go-witness and how to use them effectively."}, {"role": "user", "content": "How do I create a multi-step witness policy for a build \u2192 test \u2192 package pipeline?"}, {"role": "assistant", "content": "Here's a complete multi-step witness policy for your pipeline:\n\n**Policy Document:**\n```json\n{\n  \"expires\": \"2026-11-08T10:52:59Z\",\n  \"publickeys\": {\n    \"ci-key\": {\n      \"keyid\": \"sha256:a693001874443791e0f2168d7a8d90a8376a8e069c4d815beb79b7d4b597a807\",\n      \"key\": \"-----BEGIN PUBLIC KEY-----\\n...\\n-----END PUBLIC KEY-----\"\n    }\n  },\n  \"steps\": {\n    \"build\": {\n      \"name\": \"build\",\n      \"attestations\": [\n        {\n          \"type\": \"https://witness.dev/attestations/git/v0.1\"\n        },\n        {\n          \"type\": \"https://witness.dev/attestations/command-run/v0.1\"\n        },\n        {\n          \"type\": \"https://witness.dev/attestations/product/v0.1\"\n        }\n      ],\n      \"functionaries\": [\n        {\n          \"type\": \"publickey\",\n          \"publickeyid\": \"ci-key\"\n        }\n      ]\n    },\n    \"test\": {\n      \"name\": \"test\",\n      \"attestations\": [\n        {\n          \"type\": \"https://witness.dev/attestations/material/v0.1\"\n        },\n        {\n          \"type\": \"https://witness.dev/attestations/command-run/v0.1\"\n        }\n      ],\n      \"functionaries\": [\n        {\n          \"type\": \"publickey\",\n          \"publickeyid\": \"ci-key\"\n        }\n      ]\n    },\n    \"package\": {\n      \"name\": \"package\",\n      \"attestations\": [\n        {\n          \"type\": \"https://witness.dev/attestations/material/v0.1\"\n        },\n        {\n          \"type\": \"https://witness.dev/attestations/product/v0.1\"\n        }\n      ],\n      \"functionaries\": [\n        {\n          \"type\": \"publickey\",\n          \"publickeyid\": \"ci-key\"\n        }\n      ]\n    }\n  }\n}\n```\n\n**Pipeline Commands:**\n\n```bash\n# Step 1: Build\nwitness run --step build \\\n  --attestations git,commandrun,product \\\n  -o build.json --key ci-key.pem \\\n  -- go build -o myapp\n\n# Step 2: Test\nwitness run --step test \\\n  --attestations material,commandrun \\\n  -o test.json --key ci-key.pem \\\n  -- go test ./...\n\n# Step 3: Package\nwitness run --step package \\\n  --attestations material,product \\\n  -o package.json --key ci-key.pem \\\n  -- tar czf myapp.tar.gz myapp\n\n# Verify entire pipeline\nwitness verify \\\n  --policy policy-signed.json \\\n  --publickey policy-key.pub \\\n  -a build.json -a test.json -a package.json\n```\n"}]}
{"messages": [{"role": "system", "content": "You are an expert in the Witness supply chain attestation framework. You help users instrument CI/CD pipelines with witness, create policy documents, and write Rego policies to validate attestations. You understand all attestors in go-witness and how to use them effectively."}, {"role": "user", "content": "How do I create a witness policy for a build step that uses these attestors: product?"}, {"role": "assistant", "content": "Here's a complete witness policy for your build step with product attestors:\n\n**Policy Document:**\n```json\n{\n  \"expires\": \"2026-11-08T10:52:59Z\",\n  \"publickeys\": {\n    \"build-key\": {\n      \"keyid\": \"sha256:7d84c24834f3c6fef5cf5e273ff93bb253a04dd2b237ab2e153a293a819cb904\",\n      \"key\": \"-----BEGIN PUBLIC KEY-----\\n...\\n-----END PUBLIC KEY-----\"\n    }\n  },\n  \"steps\": {\n    \"build\": {\n      \"name\": \"build\",\n      \"attestations\": [\n        {\n          \"type\": \"https://witness.dev/attestations/product/v0.1\"\n        }\n      ],\n      \"functionaries\": [\n        {\n          \"type\": \"publickey\",\n          \"publickeyid\": \"build-key\"\n        }\n      ]\n    }\n  }\n}\n```\n\n**Witness Run Command:**\n```bash\nwitness run --step build \\\n  --attestations product \\\n  --outfile build-attestation.json \\\n  --key signing-key.pem \\\n  -- <your-build-command>\n```\n\n**Rego Validation Rules:**\n```rego\n\n```\n\n**Verification:**\n```bash\nwitness verify \\\n  --policy policy-signed.json \\\n  --publickey policy-key.pub \\\n  -a build-attestation.json \\\n  --subject <artifact>\n```\n"}]}
{"messages": [{"role": "system", "content": "You are an expert in the Witness supply chain attestation framework. You help users instrument CI/CD pipelines with witness, create policy documents, and write Rego policies to validate attestations. You understand all attestors in go-witness and how to use them effectively."}, {"role": "user", "content": "How do I create a witness policy for a build step that uses these attestors: git, commandrun, product, github?"}, {"role": "assistant", "content": "Here's a complete witness policy for your build step with git, commandrun, product, github attestors:\n\n**Policy Document:**\n```json\n{\n  \"expires\": \"2026-11-08T10:52:59Z\",\n  \"publickeys\": {\n    \"build-key\": {\n      \"keyid\": \"sha256:a2468cecf5d54dd96a5d645f9fcfb89e1abc2b1c5ca43a69f1264041002b95d3\",\n      \"key\": \"-----BEGIN PUBLIC KEY-----\\n...\\n-----END PUBLIC KEY-----\"\n    }\n  },\n  \"steps\": {\n    \"build\": {\n      \"name\": \"build\",\n      \"attestations\": [\n        {\n          \"type\": \"https://witness.dev/attestations/git/v0.1\"\n        },\n        {\n          \"type\": \"https://witness.dev/attestations/command-run/v0.1\"\n        },\n        {\n          \"type\": \"https://witness.dev/attestations/product/v0.1\"\n        },\n        {\n          \"type\": \"https://witness.dev/attestations/github/v0.1\"\n        }\n      ],\n      \"functionaries\": [\n        {\n          \"type\": \"publickey\",\n          \"publickeyid\": \"build-key\"\n        }\n      ]\n    }\n  }\n}\n```\n\n**Witness Run Command:**\n```bash\nwitness run --step build \\\n  --attestations git,commandrun,product,github \\\n  --outfile build-attestation.json \\\n  --key signing-key.pem \\\n  -- <your-build-command>\n```\n\n**Rego Validation Rules:**\n```rego\npackage git\n\nimport rego.v1\n\n# Enforce builds from specific branch\ndeny contains msg if {\n    input.branch != \"main\"\n    msg := sprintf(\"Must build from main branch, got: %s\", [input.branch])\n}\n\n# Require clean working directory\ndeny contains msg if {\n    count(input.status) > 0\n    msg := \"Working directory must be clean (no uncommitted changes)\"\n}\n\n# Validate commit author\napproved_authors := {\n    \"alice.smith@example.com\",\n    \"bob.jones@company.com\",\n    \"ci-bot@company.com\"\n}\n\ndeny contains msg if {\n    not input.authoremail in approved_authors\n    msg := sprintf(\"Unauthorized commit author: %s\", [input.authoremail])\n}\n```\n\n**Verification:**\n```bash\nwitness verify \\\n  --policy policy-signed.json \\\n  --publickey policy-key.pub \\\n  -a build-attestation.json \\\n  --subject <artifact>\n```\n"}]}
{"messages": [{"role": "system", "content": "You are an expert in the Witness supply chain attestation framework. You help users instrument CI/CD pipelines with witness, create policy documents, and write Rego policies to validate attestations. You understand all attestors in go-witness and how to use them effectively."}, {"role": "user", "content": "How do I create a witness policy for a build step that uses these attestors: material, product, git?"}, {"role": "assistant", "content": "Here's a complete witness policy for your build step with material, product, git attestors:\n\n**Policy Document:**\n```json\n{\n  \"expires\": \"2026-11-08T10:52:59Z\",\n  \"publickeys\": {\n    \"build-key\": {\n      \"keyid\": \"sha256:39fb00d410f84549cbbda0826dacdb3eeb8a8e184a0b9fdcc5f51a540b94c4b9\",\n      \"key\": \"-----BEGIN PUBLIC KEY-----\\n...\\n-----END PUBLIC KEY-----\"\n    }\n  },\n  \"steps\": {\n    \"build\": {\n      \"name\": \"build\",\n      \"attestations\": [\n        {\n          \"type\": \"https://witness.dev/attestations/material/v0.1\"\n        },\n        {\n          \"type\": \"https://witness.dev/attestations/product/v0.1\"\n        },\n        {\n          \"type\": \"https://witness.dev/attestations/git/v0.1\"\n        }\n      ],\n      \"functionaries\": [\n        {\n          \"type\": \"publickey\",\n          \"publickeyid\": \"build-key\"\n        }\n      ]\n    }\n  }\n}\n```\n\n**Witness Run Command:**\n```bash\nwitness run --step build \\\n  --attestations material,product,git \\\n  --outfile build-attestation.json \\\n  --key signing-key.pem \\\n  -- <your-build-command>\n```\n\n**Rego Validation Rules:**\n```rego\n\n```\n\n**Verification:**\n```bash\nwitness verify \\\n  --policy policy-signed.json \\\n  --publickey policy-key.pub \\\n  -a build-attestation.json \\\n  --subject <artifact>\n```\n"}]}
{"messages": [{"role": "system", "content": "You are an expert in the Witness supply chain attestation framework. You help users instrument CI/CD pipelines with witness, create policy documents, and write Rego policies to validate attestations. You understand all attestors in go-witness and how to use them effectively."}, {"role": "user", "content": "How do I create a witness policy for a build step that uses these attestors: git, environment, commandrun, github, product?"}, {"role": "assistant", "content": "Here's a complete witness policy for your build step with git, environment, commandrun, github, product attestors:\n\n**Policy Document:**\n```json\n{\n  \"expires\": \"2026-11-08T10:52:59Z\",\n  \"publickeys\": {\n    \"build-key\": {\n      \"keyid\": \"sha256:59491698d49eca70d196aa8f7f975a5e51b012b4988b489db5d170dbbcea1075\",\n      \"key\": \"-----BEGIN PUBLIC KEY-----\\n...\\n-----END PUBLIC KEY-----\"\n    }\n  },\n  \"steps\": {\n    \"build\": {\n      \"name\": \"build\",\n      \"attestations\": [\n        {\n          \"type\": \"https://witness.dev/attestations/git/v0.1\"\n        },\n        {\n          \"type\": \"https://witness.dev/attestations/environment/v0.1\"\n        },\n        {\n          \"type\": \"https://witness.dev/attestations/command-run/v0.1\"\n        },\n        {\n          \"type\": \"https://witness.dev/attestations/github/v0.1\"\n        },\n        {\n          \"type\": \"https://witness.dev/attestations/product/v0.1\"\n        }\n      ],\n      \"functionaries\": [\n        {\n          \"type\": \"publickey\",\n          \"publickeyid\": \"build-key\"\n        }\n      ]\n    }\n  }\n}\n```\n\n**Witness Run Command:**\n```bash\nwitness run --step build \\\n  --attestations git,environment,commandrun,github,product \\\n  --outfile build-attestation.json \\\n  --key signing-key.pem \\\n  -- <your-build-command>\n```\n\n**Rego Validation Rules:**\n```rego\npackage git\n\nimport rego.v1\n\n# Enforce builds from specific branch\ndeny contains msg if {\n    input.branch != \"bugfix/security\"\n    msg := sprintf(\"Must build from bugfix/security branch, got: %s\", [input.branch])\n}\n\n# Require clean working directory\ndeny contains msg if {\n    count(input.status) > 0\n    msg := \"Working directory must be clean (no uncommitted changes)\"\n}\n\n# Validate commit author\napproved_authors := {\n    \"alice.smith@example.com\",\n    \"bob.jones@company.com\",\n    \"ci-bot@company.com\"\n}\n\ndeny contains msg if {\n    not input.authoremail in approved_authors\n    msg := sprintf(\"Unauthorized commit author: %s\", [input.authoremail])\n}\n```\n\n**Verification:**\n```bash\nwitness verify \\\n  --policy policy-signed.json \\\n  --publickey policy-key.pub \\\n  -a build-attestation.json \\\n  --subject <artifact>\n```\n"}]}
{"messages": [{"role": "system", "content": "You are an expert in the Witness supply chain attestation framework. You help users instrument CI/CD pipelines with witness, create policy documents, and write Rego policies to validate attestations. You understand all attestors in go-witness and how to use them effectively."}, {"role": "user", "content": "How do I create a multi-step witness policy for a build \u2192 test \u2192 package pipeline?"}, {"role": "assistant", "content": "Here's a complete multi-step witness policy for your pipeline:\n\n**Policy Document:**\n```json\n{\n  \"expires\": \"2026-11-08T10:52:59Z\",\n  \"publickeys\": {\n    \"ci-key\": {\n      \"keyid\": \"sha256:8030fad9d43607554815df32905498e8c0200e3f948278af1962072b6741f005\",\n      \"key\": \"-----BEGIN PUBLIC KEY-----\\n...\\n-----END PUBLIC KEY-----\"\n    }\n  },\n  \"steps\": {\n    \"build\": {\n      \"name\": \"build\",\n      \"attestations\": [\n        {\n          \"type\": \"https://witness.dev/attestations/git/v0.1\"\n        },\n        {\n          \"type\": \"https://witness.dev/attestations/command-run/v0.1\"\n        },\n        {\n          \"type\": \"https://witness.dev/attestations/product/v0.1\"\n        }\n      ],\n      \"functionaries\": [\n        {\n          \"type\": \"publickey\",\n          \"publickeyid\": \"ci-key\"\n        }\n      ]\n    },\n    \"test\": {\n      \"name\": \"test\",\n      \"attestations\": [\n        {\n          \"type\": \"https://witness.dev/attestations/material/v0.1\"\n        },\n        {\n          \"type\": \"https://witness.dev/attestations/command-run/v0.1\"\n        }\n      ],\n      \"functionaries\": [\n        {\n          \"type\": \"publickey\",\n          \"publickeyid\": \"ci-key\"\n        }\n      ]\n    },\n    \"package\": {\n      \"name\": \"package\",\n      \"attestations\": [\n        {\n          \"type\": \"https://witness.dev/attestations/material/v0.1\"\n        },\n        {\n          \"type\": \"https://witness.dev/attestations/product/v0.1\"\n        }\n      ],\n      \"functionaries\": [\n        {\n          \"type\": \"publickey\",\n          \"publickeyid\": \"ci-key\"\n        }\n      ]\n    }\n  }\n}\n```\n\n**Pipeline Commands:**\n\n```bash\n# Step 1: Build\nwitness run --step build \\\n  --attestations git,commandrun,product \\\n  -o build.json --key ci-key.pem \\\n  -- go build -o myapp\n\n# Step 2: Test\nwitness run --step test \\\n  --attestations material,commandrun \\\n  -o test.json --key ci-key.pem \\\n  -- go test ./...\n\n# Step 3: Package\nwitness run --step package \\\n  --attestations material,product \\\n  -o package.json --key ci-key.pem \\\n  -- tar czf myapp.tar.gz myapp\n\n# Verify entire pipeline\nwitness verify \\\n  --policy policy-signed.json \\\n  --publickey policy-key.pub \\\n  -a build.json -a test.json -a package.json\n```\n"}]}
{"messages": [{"role": "system", "content": "You are an expert in the Witness supply chain attestation framework. You help users instrument CI/CD pipelines with witness, create policy documents, and write Rego policies to validate attestations. You understand all attestors in go-witness and how to use them effectively."}, {"role": "user", "content": "How do I create a witness policy for a build step that uses these attestors: environment?"}, {"role": "assistant", "content": "Here's a complete witness policy for your build step with environment attestors:\n\n**Policy Document:**\n```json\n{\n  \"expires\": \"2026-11-08T10:52:59Z\",\n  \"publickeys\": {\n    \"build-key\": {\n      \"keyid\": \"sha256:866581678c97d51db9687c7ae1292014a3828de680100bae076724266943e465\",\n      \"key\": \"-----BEGIN PUBLIC KEY-----\\n...\\n-----END PUBLIC KEY-----\"\n    }\n  },\n  \"steps\": {\n    \"build\": {\n      \"name\": \"build\",\n      \"attestations\": [\n        {\n          \"type\": \"https://witness.dev/attestations/environment/v0.1\"\n        }\n      ],\n      \"functionaries\": [\n        {\n          \"type\": \"publickey\",\n          \"publickeyid\": \"build-key\"\n        }\n      ]\n    }\n  }\n}\n```\n\n**Witness Run Command:**\n```bash\nwitness run --step build \\\n  --attestations environment \\\n  --outfile build-attestation.json \\\n  --key signing-key.pem \\\n  -- <your-build-command>\n```\n\n**Rego Validation Rules:**\n```rego\npackage environment\n\nimport rego.v1\n\n# Ensure correct OS\ndeny contains msg if {\n    input.os != \"linux\"\n    msg := sprintf(\"Must run on linux, got: %s\", [input.os])\n}\n\n# Require CI environment\ndeny contains msg if {\n    not \"CI\" in input.variables\n    msg := \"Must run in CI environment (CI variable not set)\"\n}\n```\n\n**Verification:**\n```bash\nwitness verify \\\n  --policy policy-signed.json \\\n  --publickey policy-key.pub \\\n  -a build-attestation.json \\\n  --subject <artifact>\n```\n"}]}
{"messages": [{"role": "system", "content": "You are an expert in the Witness supply chain attestation framework. You help users instrument CI/CD pipelines with witness, create policy documents, and write Rego policies to validate attestations. You understand all attestors in go-witness and how to use them effectively."}, {"role": "user", "content": "How do I create a witness policy for a build step that uses these attestors: material?"}, {"role": "assistant", "content": "Here's a complete witness policy for your build step with material attestors:\n\n**Policy Document:**\n```json\n{\n  \"expires\": \"2026-11-08T10:52:59Z\",\n  \"publickeys\": {\n    \"build-key\": {\n      \"keyid\": \"sha256:33034a560c6d9f7a08283eac8cb4ce3db31d383791c5aa22b2dd063126946dfb\",\n      \"key\": \"-----BEGIN PUBLIC KEY-----\\n...\\n-----END PUBLIC KEY-----\"\n    }\n  },\n  \"steps\": {\n    \"build\": {\n      \"name\": \"build\",\n      \"attestations\": [\n        {\n          \"type\": \"https://witness.dev/attestations/material/v0.1\"\n        }\n      ],\n      \"functionaries\": [\n        {\n          \"type\": \"publickey\",\n          \"publickeyid\": \"build-key\"\n        }\n      ]\n    }\n  }\n}\n```\n\n**Witness Run Command:**\n```bash\nwitness run --step build \\\n  --attestations material \\\n  --outfile build-attestation.json \\\n  --key signing-key.pem \\\n  -- <your-build-command>\n```\n\n**Rego Validation Rules:**\n```rego\n\n```\n\n**Verification:**\n```bash\nwitness verify \\\n  --policy policy-signed.json \\\n  --publickey policy-key.pub \\\n  -a build-attestation.json \\\n  --subject <artifact>\n```\n"}]}
{"messages": [{"role": "system", "content": "You are an expert in the Witness supply chain attestation framework. You help users instrument CI/CD pipelines with witness, create policy documents, and write Rego policies to validate attestations. You understand all attestors in go-witness and how to use them effectively."}, {"role": "user", "content": "How do I create a witness policy for a build step that uses these attestors: github, product?"}, {"role": "assistant", "content": "Here's a complete witness policy for your build step with github, product attestors:\n\n**Policy Document:**\n```json\n{\n  \"expires\": \"2026-11-08T10:52:59Z\",\n  \"publickeys\": {\n    \"build-key\": {\n      \"keyid\": \"sha256:748951ab1379aa74aee2f37a22740bdc213256b1aae757ae37302a0903e7684f\",\n      \"key\": \"-----BEGIN PUBLIC KEY-----\\n...\\n-----END PUBLIC KEY-----\"\n    }\n  },\n  \"steps\": {\n    \"build\": {\n      \"name\": \"build\",\n      \"attestations\": [\n        {\n          \"type\": \"https://witness.dev/attestations/github/v0.1\"\n        },\n        {\n          \"type\": \"https://witness.dev/attestations/product/v0.1\"\n        }\n      ],\n      \"functionaries\": [\n        {\n          \"type\": \"publickey\",\n          \"publickeyid\": \"build-key\"\n        }\n      ]\n    }\n  }\n}\n```\n\n**Witness Run Command:**\n```bash\nwitness run --step build \\\n  --attestations github,product \\\n  --outfile build-attestation.json \\\n  --key signing-key.pem \\\n  -- <your-build-command>\n```\n\n**Rego Validation Rules:**\n```rego\n\n```\n\n**Verification:**\n```bash\nwitness verify \\\n  --policy policy-signed.json \\\n  --publickey policy-key.pub \\\n  -a build-attestation.json \\\n  --subject <artifact>\n```\n"}]}
{"messages": [{"role": "system", "content": "You are an expert in the Witness supply chain attestation framework. You help users instrument CI/CD pipelines with witness, create policy documents, and write Rego policies to validate attestations. You understand all attestors in go-witness and how to use them effectively."}, {"role": "user", "content": "How do I create a multi-step witness policy for a build \u2192 test \u2192 package pipeline?"}, {"role": "assistant", "content": "Here's a complete multi-step witness policy for your pipeline:\n\n**Policy Document:**\n```json\n{\n  \"expires\": \"2026-11-08T10:52:59Z\",\n  \"publickeys\": {\n    \"ci-key\": {\n      \"keyid\": \"sha256:f4beea7f4ba90a2b44c9a8c50a9a155759c5a834071ab4150136f4709466aec7\",\n      \"key\": \"-----BEGIN PUBLIC KEY-----\\n...\\n-----END PUBLIC KEY-----\"\n    }\n  },\n  \"steps\": {\n    \"build\": {\n      \"name\": \"build\",\n      \"attestations\": [\n        {\n          \"type\": \"https://witness.dev/attestations/git/v0.1\"\n        },\n        {\n          \"type\": \"https://witness.dev/attestations/command-run/v0.1\"\n        },\n        {\n          \"type\": \"https://witness.dev/attestations/product/v0.1\"\n        }\n      ],\n      \"functionaries\": [\n        {\n          \"type\": \"publickey\",\n          \"publickeyid\": \"ci-key\"\n        }\n      ]\n    },\n    \"test\": {\n      \"name\": \"test\",\n      \"attestations\": [\n        {\n          \"type\": \"https://witness.dev/attestations/material/v0.1\"\n        },\n        {\n          \"type\": \"https://witness.dev/attestations/command-run/v0.1\"\n        }\n      ],\n      \"functionaries\": [\n        {\n          \"type\": \"publickey\",\n          \"publickeyid\": \"ci-key\"\n        }\n      ]\n    },\n    \"package\": {\n      \"name\": \"package\",\n      \"attestations\": [\n        {\n          \"type\": \"https://witness.dev/attestations/material/v0.1\"\n        },\n        {\n          \"type\": \"https://witness.dev/attestations/product/v0.1\"\n        }\n      ],\n      \"functionaries\": [\n        {\n          \"type\": \"publickey\",\n          \"publickeyid\": \"ci-key\"\n        }\n      ]\n    }\n  }\n}\n```\n\n**Pipeline Commands:**\n\n```bash\n# Step 1: Build\nwitness run --step build \\\n  --attestations git,commandrun,product \\\n  -o build.json --key ci-key.pem \\\n  -- go build -o myapp\n\n# Step 2: Test\nwitness run --step test \\\n  --attestations material,commandrun \\\n  -o test.json --key ci-key.pem \\\n  -- go test ./...\n\n# Step 3: Package\nwitness run --step package \\\n  --attestations material,product \\\n  -o package.json --key ci-key.pem \\\n  -- tar czf myapp.tar.gz myapp\n\n# Verify entire pipeline\nwitness verify \\\n  --policy policy-signed.json \\\n  --publickey policy-key.pub \\\n  -a build.json -a test.json -a package.json\n```\n"}]}
{"messages": [{"role": "system", "content": "You are an expert in the Witness supply chain attestation framework. You help users instrument CI/CD pipelines with witness, create policy documents, and write Rego policies to validate attestations. You understand all attestors in go-witness and how to use them effectively."}, {"role": "user", "content": "How do I create a witness policy for a build step that uses these attestors: commandrun?"}, {"role": "assistant", "content": "Here's a complete witness policy for your build step with commandrun attestors:\n\n**Policy Document:**\n```json\n{\n  \"expires\": \"2026-11-08T10:52:59Z\",\n  \"publickeys\": {\n    \"build-key\": {\n      \"keyid\": \"sha256:85122625100af134ff4e78495067a28286d367f7a1e925f387c66e6f1cc0a433\",\n      \"key\": \"-----BEGIN PUBLIC KEY-----\\n...\\n-----END PUBLIC KEY-----\"\n    }\n  },\n  \"steps\": {\n    \"build\": {\n      \"name\": \"build\",\n      \"attestations\": [\n        {\n          \"type\": \"https://witness.dev/attestations/command-run/v0.1\"\n        }\n      ],\n      \"functionaries\": [\n        {\n          \"type\": \"publickey\",\n          \"publickeyid\": \"build-key\"\n        }\n      ]\n    }\n  }\n}\n```\n\n**Witness Run Command:**\n```bash\nwitness run --step build \\\n  --attestations commandrun \\\n  --outfile build-attestation.json \\\n  --key signing-key.pem \\\n  -- <your-build-command>\n```\n\n**Rego Validation Rules:**\n```rego\n\n```\n\n**Verification:**\n```bash\nwitness verify \\\n  --policy policy-signed.json \\\n  --publickey policy-key.pub \\\n  -a build-attestation.json \\\n  --subject <artifact>\n```\n"}]}
{"messages": [{"role": "system", "content": "You are an expert in the Witness supply chain attestation framework. You help users instrument CI/CD pipelines with witness, create policy documents, and write Rego policies to validate attestations. You understand all attestors in go-witness and how to use them effectively."}, {"role": "user", "content": "How do I create a witness policy for a build step that uses these attestors: product, material?"}, {"role": "assistant", "content": "Here's a complete witness policy for your build step with product, material attestors:\n\n**Policy Document:**\n```json\n{\n  \"expires\": \"2026-11-08T10:52:59Z\",\n  \"publickeys\": {\n    \"build-key\": {\n      \"keyid\": \"sha256:13278c47d80a712c0bc41a0128aa3be41d364ce0d65cf6a0ac75a62df17aa15e\",\n      \"key\": \"-----BEGIN PUBLIC KEY-----\\n...\\n-----END PUBLIC KEY-----\"\n    }\n  },\n  \"steps\": {\n    \"build\": {\n      \"name\": \"build\",\n      \"attestations\": [\n        {\n          \"type\": \"https://witness.dev/attestations/product/v0.1\"\n        },\n        {\n          \"type\": \"https://witness.dev/attestations/material/v0.1\"\n        }\n      ],\n      \"functionaries\": [\n        {\n          \"type\": \"publickey\",\n          \"publickeyid\": \"build-key\"\n        }\n      ]\n    }\n  }\n}\n```\n\n**Witness Run Command:**\n```bash\nwitness run --step build \\\n  --attestations product,material \\\n  --outfile build-attestation.json \\\n  --key signing-key.pem \\\n  -- <your-build-command>\n```\n\n**Rego Validation Rules:**\n```rego\n\n```\n\n**Verification:**\n```bash\nwitness verify \\\n  --policy policy-signed.json \\\n  --publickey policy-key.pub \\\n  -a build-attestation.json \\\n  --subject <artifact>\n```\n"}]}
{"messages": [{"role": "system", "content": "You are an expert in the Witness supply chain attestation framework. You help users instrument CI/CD pipelines with witness, create policy documents, and write Rego policies to validate attestations. You understand all attestors in go-witness and how to use them effectively."}, {"role": "user", "content": "How do I create a witness policy for a build step that uses these attestors: product?"}, {"role": "assistant", "content": "Here's a complete witness policy for your build step with product attestors:\n\n**Policy Document:**\n```json\n{\n  \"expires\": \"2026-11-08T10:52:59Z\",\n  \"publickeys\": {\n    \"build-key\": {\n      \"keyid\": \"sha256:cfaeb1397ec218d1c95d504dbb6eb0ecd7b2426dc2f0c41c9dd65e3583c5e0b8\",\n      \"key\": \"-----BEGIN PUBLIC KEY-----\\n...\\n-----END PUBLIC KEY-----\"\n    }\n  },\n  \"steps\": {\n    \"build\": {\n      \"name\": \"build\",\n      \"attestations\": [\n        {\n          \"type\": \"https://witness.dev/attestations/product/v0.1\"\n        }\n      ],\n      \"functionaries\": [\n        {\n          \"type\": \"publickey\",\n          \"publickeyid\": \"build-key\"\n        }\n      ]\n    }\n  }\n}\n```\n\n**Witness Run Command:**\n```bash\nwitness run --step build \\\n  --attestations product \\\n  --outfile build-attestation.json \\\n  --key signing-key.pem \\\n  -- <your-build-command>\n```\n\n**Rego Validation Rules:**\n```rego\n\n```\n\n**Verification:**\n```bash\nwitness verify \\\n  --policy policy-signed.json \\\n  --publickey policy-key.pub \\\n  -a build-attestation.json \\\n  --subject <artifact>\n```\n"}]}
{"messages": [{"role": "system", "content": "You are an expert in the Witness supply chain attestation framework. You help users instrument CI/CD pipelines with witness, create policy documents, and write Rego policies to validate attestations. You understand all attestors in go-witness and how to use them effectively."}, {"role": "user", "content": "How do I create a witness policy for a build step that uses these attestors: product?"}, {"role": "assistant", "content": "Here's a complete witness policy for your build step with product attestors:\n\n**Policy Document:**\n```json\n{\n  \"expires\": \"2026-11-08T10:52:59Z\",\n  \"publickeys\": {\n    \"build-key\": {\n      \"keyid\": \"sha256:d4b136c4765c91ef06c4ce17a021206a2144a5cef880c23a3b902b30ffb51541\",\n      \"key\": \"-----BEGIN PUBLIC KEY-----\\n...\\n-----END PUBLIC KEY-----\"\n    }\n  },\n  \"steps\": {\n    \"build\": {\n      \"name\": \"build\",\n      \"attestations\": [\n        {\n          \"type\": \"https://witness.dev/attestations/product/v0.1\"\n        }\n      ],\n      \"functionaries\": [\n        {\n          \"type\": \"publickey\",\n          \"publickeyid\": \"build-key\"\n        }\n      ]\n    }\n  }\n}\n```\n\n**Witness Run Command:**\n```bash\nwitness run --step build \\\n  --attestations product \\\n  --outfile build-attestation.json \\\n  --key signing-key.pem \\\n  -- <your-build-command>\n```\n\n**Rego Validation Rules:**\n```rego\n\n```\n\n**Verification:**\n```bash\nwitness verify \\\n  --policy policy-signed.json \\\n  --publickey policy-key.pub \\\n  -a build-attestation.json \\\n  --subject <artifact>\n```\n"}]}
{"messages": [{"role": "system", "content": "You are an expert in the Witness supply chain attestation framework. You help users instrument CI/CD pipelines with witness, create policy documents, and write Rego policies to validate attestations. You understand all attestors in go-witness and how to use them effectively."}, {"role": "user", "content": "How do I create a witness policy for a build step that uses these attestors: github, product?"}, {"role": "assistant", "content": "Here's a complete witness policy for your build step with github, product attestors:\n\n**Policy Document:**\n```json\n{\n  \"expires\": \"2026-11-08T10:52:59Z\",\n  \"publickeys\": {\n    \"build-key\": {\n      \"keyid\": \"sha256:a910cfeae42b6c28c1a0633c1abc777f85bc31febe324ca298ef96068dc7f8d4\",\n      \"key\": \"-----BEGIN PUBLIC KEY-----\\n...\\n-----END PUBLIC KEY-----\"\n    }\n  },\n  \"steps\": {\n    \"build\": {\n      \"name\": \"build\",\n      \"attestations\": [\n        {\n          \"type\": \"https://witness.dev/attestations/github/v0.1\"\n        },\n        {\n          \"type\": \"https://witness.dev/attestations/product/v0.1\"\n        }\n      ],\n      \"functionaries\": [\n        {\n          \"type\": \"publickey\",\n          \"publickeyid\": \"build-key\"\n        }\n      ]\n    }\n  }\n}\n```\n\n**Witness Run Command:**\n```bash\nwitness run --step build \\\n  --attestations github,product \\\n  --outfile build-attestation.json \\\n  --key signing-key.pem \\\n  -- <your-build-command>\n```\n\n**Rego Validation Rules:**\n```rego\n\n```\n\n**Verification:**\n```bash\nwitness verify \\\n  --policy policy-signed.json \\\n  --publickey policy-key.pub \\\n  -a build-attestation.json \\\n  --subject <artifact>\n```\n"}]}
{"messages": [{"role": "system", "content": "You are an expert in the Witness supply chain attestation framework. You help users instrument CI/CD pipelines with witness, create policy documents, and write Rego policies to validate attestations. You understand all attestors in go-witness and how to use them effectively."}, {"role": "user", "content": "How do I create a witness policy for a build step that uses these attestors: material, github, environment?"}, {"role": "assistant", "content": "Here's a complete witness policy for your build step with material, github, environment attestors:\n\n**Policy Document:**\n```json\n{\n  \"expires\": \"2026-11-08T10:52:59Z\",\n  \"publickeys\": {\n    \"build-key\": {\n      \"keyid\": \"sha256:ad178515e15f9a3adc9ece5c289eb244dbbda9b420f3f3651ca788258726f082\",\n      \"key\": \"-----BEGIN PUBLIC KEY-----\\n...\\n-----END PUBLIC KEY-----\"\n    }\n  },\n  \"steps\": {\n    \"build\": {\n      \"name\": \"build\",\n      \"attestations\": [\n        {\n          \"type\": \"https://witness.dev/attestations/material/v0.1\"\n        },\n        {\n          \"type\": \"https://witness.dev/attestations/github/v0.1\"\n        },\n        {\n          \"type\": \"https://witness.dev/attestations/environment/v0.1\"\n        }\n      ],\n      \"functionaries\": [\n        {\n          \"type\": \"publickey\",\n          \"publickeyid\": \"build-key\"\n        }\n      ]\n    }\n  }\n}\n```\n\n**Witness Run Command:**\n```bash\nwitness run --step build \\\n  --attestations material,github,environment \\\n  --outfile build-attestation.json \\\n  --key signing-key.pem \\\n  -- <your-build-command>\n```\n\n**Rego Validation Rules:**\n```rego\n\n```\n\n**Verification:**\n```bash\nwitness verify \\\n  --policy policy-signed.json \\\n  --publickey policy-key.pub \\\n  -a build-attestation.json \\\n  --subject <artifact>\n```\n"}]}
{"messages": [{"role": "system", "content": "You are an expert in the Witness supply chain attestation framework. You help users instrument CI/CD pipelines with witness, create policy documents, and write Rego policies to validate attestations. You understand all attestors in go-witness and how to use them effectively."}, {"role": "user", "content": "How do I create a witness policy for a build step that uses these attestors: git?"}, {"role": "assistant", "content": "Here's a complete witness policy for your build step with git attestors:\n\n**Policy Document:**\n```json\n{\n  \"expires\": \"2026-11-08T10:52:59Z\",\n  \"publickeys\": {\n    \"build-key\": {\n      \"keyid\": \"sha256:222b99b448d59a4f71899930a6e7499e32dc7f6495f54cdc027ebf45a40453f6\",\n      \"key\": \"-----BEGIN PUBLIC KEY-----\\n...\\n-----END PUBLIC KEY-----\"\n    }\n  },\n  \"steps\": {\n    \"build\": {\n      \"name\": \"build\",\n      \"attestations\": [\n        {\n          \"type\": \"https://witness.dev/attestations/git/v0.1\"\n        }\n      ],\n      \"functionaries\": [\n        {\n          \"type\": \"publickey\",\n          \"publickeyid\": \"build-key\"\n        }\n      ]\n    }\n  }\n}\n```\n\n**Witness Run Command:**\n```bash\nwitness run --step build \\\n  --attestations git \\\n  --outfile build-attestation.json \\\n  --key signing-key.pem \\\n  -- <your-build-command>\n```\n\n**Rego Validation Rules:**\n```rego\npackage git\n\nimport rego.v1\n\n# Enforce builds from specific branch\ndeny contains msg if {\n    input.branch != \"feature/auth\"\n    msg := sprintf(\"Must build from feature/auth branch, got: %s\", [input.branch])\n}\n\n# Validate commit author\napproved_authors := {\n    \"alice.smith@example.com\",\n    \"bob.jones@company.com\",\n    \"ci-bot@company.com\"\n}\n\ndeny contains msg if {\n    not input.authoremail in approved_authors\n    msg := sprintf(\"Unauthorized commit author: %s\", [input.authoremail])\n}\n```\n\n**Verification:**\n```bash\nwitness verify \\\n  --policy policy-signed.json \\\n  --publickey policy-key.pub \\\n  -a build-attestation.json \\\n  --subject <artifact>\n```\n"}]}
{"messages": [{"role": "system", "content": "You are an expert in the Witness supply chain attestation framework. You help users instrument CI/CD pipelines with witness, create policy documents, and write Rego policies to validate attestations. You understand all attestors in go-witness and how to use them effectively."}, {"role": "user", "content": "How do I create a witness policy for a build step that uses these attestors: environment, commandrun, github, git, product?"}, {"role": "assistant", "content": "Here's a complete witness policy for your build step with environment, commandrun, github, git, product attestors:\n\n**Policy Document:**\n```json\n{\n  \"expires\": \"2026-11-08T10:52:59Z\",\n  \"publickeys\": {\n    \"build-key\": {\n      \"keyid\": \"sha256:0660c36366bdc49a3707caf3e234aef0247284dfb208f98bf344122bf9a65dfb\",\n      \"key\": \"-----BEGIN PUBLIC KEY-----\\n...\\n-----END PUBLIC KEY-----\"\n    }\n  },\n  \"steps\": {\n    \"build\": {\n      \"name\": \"build\",\n      \"attestations\": [\n        {\n          \"type\": \"https://witness.dev/attestations/environment/v0.1\"\n        },\n        {\n          \"type\": \"https://witness.dev/attestations/command-run/v0.1\"\n        },\n        {\n          \"type\": \"https://witness.dev/attestations/github/v0.1\"\n        },\n        {\n          \"type\": \"https://witness.dev/attestations/git/v0.1\"\n        },\n        {\n          \"type\": \"https://witness.dev/attestations/product/v0.1\"\n        }\n      ],\n      \"functionaries\": [\n        {\n          \"type\": \"publickey\",\n          \"publickeyid\": \"build-key\"\n        }\n      ]\n    }\n  }\n}\n```\n\n**Witness Run Command:**\n```bash\nwitness run --step build \\\n  --attestations environment,commandrun,github,git,product \\\n  --outfile build-attestation.json \\\n  --key signing-key.pem \\\n  -- <your-build-command>\n```\n\n**Rego Validation Rules:**\n```rego\npackage environment\n\nimport rego.v1\n\n# Ensure correct OS\ndeny contains msg if {\n    input.os != \"linux\"\n    msg := sprintf(\"Must run on linux, got: %s\", [input.os])\n}\n\n# Require CI environment\ndeny contains msg if {\n    not \"CI\" in input.variables\n    msg := \"Must run in CI environment (CI variable not set)\"\n}\n```\n\n**Verification:**\n```bash\nwitness verify \\\n  --policy policy-signed.json \\\n  --publickey policy-key.pub \\\n  -a build-attestation.json \\\n  --subject <artifact>\n```\n"}]}
{"messages": [{"role": "system", "content": "You are an expert in the Witness supply chain attestation framework. You help users instrument CI/CD pipelines with witness, create policy documents, and write Rego policies to validate attestations. You understand all attestors in go-witness and how to use them effectively."}, {"role": "user", "content": "How do I create a multi-step witness policy for a build \u2192 test \u2192 package pipeline?"}, {"role": "assistant", "content": "Here's a complete multi-step witness policy for your pipeline:\n\n**Policy Document:**\n```json\n{\n  \"expires\": \"2026-11-08T10:52:59Z\",\n  \"publickeys\": {\n    \"ci-key\": {\n      \"keyid\": \"sha256:8c65903565319cdec1e406dd926458e4c38248a871b23086313ee08a42eeb311\",\n      \"key\": \"-----BEGIN PUBLIC KEY-----\\n...\\n-----END PUBLIC KEY-----\"\n    }\n  },\n  \"steps\": {\n    \"build\": {\n      \"name\": \"build\",\n      \"attestations\": [\n        {\n          \"type\": \"https://witness.dev/attestations/git/v0.1\"\n        },\n        {\n          \"type\": \"https://witness.dev/attestations/command-run/v0.1\"\n        },\n        {\n          \"type\": \"https://witness.dev/attestations/product/v0.1\"\n        }\n      ],\n      \"functionaries\": [\n        {\n          \"type\": \"publickey\",\n          \"publickeyid\": \"ci-key\"\n        }\n      ]\n    },\n    \"test\": {\n      \"name\": \"test\",\n      \"attestations\": [\n        {\n          \"type\": \"https://witness.dev/attestations/material/v0.1\"\n        },\n        {\n          \"type\": \"https://witness.dev/attestations/command-run/v0.1\"\n        }\n      ],\n      \"functionaries\": [\n        {\n          \"type\": \"publickey\",\n          \"publickeyid\": \"ci-key\"\n        }\n      ]\n    },\n    \"package\": {\n      \"name\": \"package\",\n      \"attestations\": [\n        {\n          \"type\": \"https://witness.dev/attestations/material/v0.1\"\n        },\n        {\n          \"type\": \"https://witness.dev/attestations/product/v0.1\"\n        }\n      ],\n      \"functionaries\": [\n        {\n          \"type\": \"publickey\",\n          \"publickeyid\": \"ci-key\"\n        }\n      ]\n    }\n  }\n}\n```\n\n**Pipeline Commands:**\n\n```bash\n# Step 1: Build\nwitness run --step build \\\n  --attestations git,commandrun,product \\\n  -o build.json --key ci-key.pem \\\n  -- go build -o myapp\n\n# Step 2: Test\nwitness run --step test \\\n  --attestations material,commandrun \\\n  -o test.json --key ci-key.pem \\\n  -- go test ./...\n\n# Step 3: Package\nwitness run --step package \\\n  --attestations material,product \\\n  -o package.json --key ci-key.pem \\\n  -- tar czf myapp.tar.gz myapp\n\n# Verify entire pipeline\nwitness verify \\\n  --policy policy-signed.json \\\n  --publickey policy-key.pub \\\n  -a build.json -a test.json -a package.json\n```\n"}]}
{"messages": [{"role": "system", "content": "You are an expert in the Witness supply chain attestation framework. You help users instrument CI/CD pipelines with witness, create policy documents, and write Rego policies to validate attestations. You understand all attestors in go-witness and how to use them effectively."}, {"role": "user", "content": "How do I create a witness policy for a build step that uses these attestors: product, commandrun, github?"}, {"role": "assistant", "content": "Here's a complete witness policy for your build step with product, commandrun, github attestors:\n\n**Policy Document:**\n```json\n{\n  \"expires\": \"2026-11-08T10:52:59Z\",\n  \"publickeys\": {\n    \"build-key\": {\n      \"keyid\": \"sha256:e2957844b2f256a1e4131069a5a804fd329a71bbd06e976e8f605c10bbb9a034\",\n      \"key\": \"-----BEGIN PUBLIC KEY-----\\n...\\n-----END PUBLIC KEY-----\"\n    }\n  },\n  \"steps\": {\n    \"build\": {\n      \"name\": \"build\",\n      \"attestations\": [\n        {\n          \"type\": \"https://witness.dev/attestations/product/v0.1\"\n        },\n        {\n          \"type\": \"https://witness.dev/attestations/command-run/v0.1\"\n        },\n        {\n          \"type\": \"https://witness.dev/attestations/github/v0.1\"\n        }\n      ],\n      \"functionaries\": [\n        {\n          \"type\": \"publickey\",\n          \"publickeyid\": \"build-key\"\n        }\n      ]\n    }\n  }\n}\n```\n\n**Witness Run Command:**\n```bash\nwitness run --step build \\\n  --attestations product,commandrun,github \\\n  --outfile build-attestation.json \\\n  --key signing-key.pem \\\n  -- <your-build-command>\n```\n\n**Rego Validation Rules:**\n```rego\n\n```\n\n**Verification:**\n```bash\nwitness verify \\\n  --policy policy-signed.json \\\n  --publickey policy-key.pub \\\n  -a build-attestation.json \\\n  --subject <artifact>\n```\n"}]}
{"messages": [{"role": "system", "content": "You are an expert in the Witness supply chain attestation framework. You help users instrument CI/CD pipelines with witness, create policy documents, and write Rego policies to validate attestations. You understand all attestors in go-witness and how to use them effectively."}, {"role": "user", "content": "How do I create a multi-step witness policy for a build \u2192 test \u2192 package pipeline?"}, {"role": "assistant", "content": "Here's a complete multi-step witness policy for your pipeline:\n\n**Policy Document:**\n```json\n{\n  \"expires\": \"2026-11-08T10:52:59Z\",\n  \"publickeys\": {\n    \"ci-key\": {\n      \"keyid\": \"sha256:93c5f21fb13e5a594ce65d23c75242c55fff6ea22a3db685a40f89e0f69a69aa\",\n      \"key\": \"-----BEGIN PUBLIC KEY-----\\n...\\n-----END PUBLIC KEY-----\"\n    }\n  },\n  \"steps\": {\n    \"build\": {\n      \"name\": \"build\",\n      \"attestations\": [\n        {\n          \"type\": \"https://witness.dev/attestations/git/v0.1\"\n        },\n        {\n          \"type\": \"https://witness.dev/attestations/command-run/v0.1\"\n        },\n        {\n          \"type\": \"https://witness.dev/attestations/product/v0.1\"\n        }\n      ],\n      \"functionaries\": [\n        {\n          \"type\": \"publickey\",\n          \"publickeyid\": \"ci-key\"\n        }\n      ]\n    },\n    \"test\": {\n      \"name\": \"test\",\n      \"attestations\": [\n        {\n          \"type\": \"https://witness.dev/attestations/material/v0.1\"\n        },\n        {\n          \"type\": \"https://witness.dev/attestations/command-run/v0.1\"\n        }\n      ],\n      \"functionaries\": [\n        {\n          \"type\": \"publickey\",\n          \"publickeyid\": \"ci-key\"\n        }\n      ]\n    },\n    \"package\": {\n      \"name\": \"package\",\n      \"attestations\": [\n        {\n          \"type\": \"https://witness.dev/attestations/material/v0.1\"\n        },\n        {\n          \"type\": \"https://witness.dev/attestations/product/v0.1\"\n        }\n      ],\n      \"functionaries\": [\n        {\n          \"type\": \"publickey\",\n          \"publickeyid\": \"ci-key\"\n        }\n      ]\n    }\n  }\n}\n```\n\n**Pipeline Commands:**\n\n```bash\n# Step 1: Build\nwitness run --step build \\\n  --attestations git,commandrun,product \\\n  -o build.json --key ci-key.pem \\\n  -- go build -o myapp\n\n# Step 2: Test\nwitness run --step test \\\n  --attestations material,commandrun \\\n  -o test.json --key ci-key.pem \\\n  -- go test ./...\n\n# Step 3: Package\nwitness run --step package \\\n  --attestations material,product \\\n  -o package.json --key ci-key.pem \\\n  -- tar czf myapp.tar.gz myapp\n\n# Verify entire pipeline\nwitness verify \\\n  --policy policy-signed.json \\\n  --publickey policy-key.pub \\\n  -a build.json -a test.json -a package.json\n```\n"}]}
{"messages": [{"role": "system", "content": "You are an expert in the Witness supply chain attestation framework. You help users instrument CI/CD pipelines with witness, create policy documents, and write Rego policies to validate attestations. You understand all attestors in go-witness and how to use them effectively."}, {"role": "user", "content": "How do I create a witness policy for a build step that uses these attestors: product, git?"}, {"role": "assistant", "content": "Here's a complete witness policy for your build step with product, git attestors:\n\n**Policy Document:**\n```json\n{\n  \"expires\": \"2026-11-08T10:52:59Z\",\n  \"publickeys\": {\n    \"build-key\": {\n      \"keyid\": \"sha256:f802d89620b96f627a588c19e009cf563ecc43ba80220ab7bfa46f3de7f10beb\",\n      \"key\": \"-----BEGIN PUBLIC KEY-----\\n...\\n-----END PUBLIC KEY-----\"\n    }\n  },\n  \"steps\": {\n    \"build\": {\n      \"name\": \"build\",\n      \"attestations\": [\n        {\n          \"type\": \"https://witness.dev/attestations/product/v0.1\"\n        },\n        {\n          \"type\": \"https://witness.dev/attestations/git/v0.1\"\n        }\n      ],\n      \"functionaries\": [\n        {\n          \"type\": \"publickey\",\n          \"publickeyid\": \"build-key\"\n        }\n      ]\n    }\n  }\n}\n```\n\n**Witness Run Command:**\n```bash\nwitness run --step build \\\n  --attestations product,git \\\n  --outfile build-attestation.json \\\n  --key signing-key.pem \\\n  -- <your-build-command>\n```\n\n**Rego Validation Rules:**\n```rego\n\n```\n\n**Verification:**\n```bash\nwitness verify \\\n  --policy policy-signed.json \\\n  --publickey policy-key.pub \\\n  -a build-attestation.json \\\n  --subject <artifact>\n```\n"}]}
{"messages": [{"role": "system", "content": "You are an expert in the Witness supply chain attestation framework. You help users instrument CI/CD pipelines with witness, create policy documents, and write Rego policies to validate attestations. You understand all attestors in go-witness and how to use them effectively."}, {"role": "user", "content": "How do I create a witness policy for a build step that uses these attestors: commandrun, environment, github?"}, {"role": "assistant", "content": "Here's a complete witness policy for your build step with commandrun, environment, github attestors:\n\n**Policy Document:**\n```json\n{\n  \"expires\": \"2026-11-08T10:52:59Z\",\n  \"publickeys\": {\n    \"build-key\": {\n      \"keyid\": \"sha256:3af9244a2a6e369670cb88418c2f7d42884267c0ee71ed3047ed9bb2beef22a9\",\n      \"key\": \"-----BEGIN PUBLIC KEY-----\\n...\\n-----END PUBLIC KEY-----\"\n    }\n  },\n  \"steps\": {\n    \"build\": {\n      \"name\": \"build\",\n      \"attestations\": [\n        {\n          \"type\": \"https://witness.dev/attestations/command-run/v0.1\"\n        },\n        {\n          \"type\": \"https://witness.dev/attestations/environment/v0.1\"\n        },\n        {\n          \"type\": \"https://witness.dev/attestations/github/v0.1\"\n        }\n      ],\n      \"functionaries\": [\n        {\n          \"type\": \"publickey\",\n          \"publickeyid\": \"build-key\"\n        }\n      ]\n    }\n  }\n}\n```\n\n**Witness Run Command:**\n```bash\nwitness run --step build \\\n  --attestations commandrun,environment,github \\\n  --outfile build-attestation.json \\\n  --key signing-key.pem \\\n  -- <your-build-command>\n```\n\n**Rego Validation Rules:**\n```rego\n\n```\n\n**Verification:**\n```bash\nwitness verify \\\n  --policy policy-signed.json \\\n  --publickey policy-key.pub \\\n  -a build-attestation.json \\\n  --subject <artifact>\n```\n"}]}
{"messages": [{"role": "system", "content": "You are an expert in the Witness supply chain attestation framework. You help users instrument CI/CD pipelines with witness, create policy documents, and write Rego policies to validate attestations. You understand all attestors in go-witness and how to use them effectively."}, {"role": "user", "content": "How do I create a witness policy for a build step that uses these attestors: material?"}, {"role": "assistant", "content": "Here's a complete witness policy for your build step with material attestors:\n\n**Policy Document:**\n```json\n{\n  \"expires\": \"2026-11-08T10:52:59Z\",\n  \"publickeys\": {\n    \"build-key\": {\n      \"keyid\": \"sha256:fcea2478d00c18b089db01c349510c1e382951ceb238f630879b13d1316d5d1b\",\n      \"key\": \"-----BEGIN PUBLIC KEY-----\\n...\\n-----END PUBLIC KEY-----\"\n    }\n  },\n  \"steps\": {\n    \"build\": {\n      \"name\": \"build\",\n      \"attestations\": [\n        {\n          \"type\": \"https://witness.dev/attestations/material/v0.1\"\n        }\n      ],\n      \"functionaries\": [\n        {\n          \"type\": \"publickey\",\n          \"publickeyid\": \"build-key\"\n        }\n      ]\n    }\n  }\n}\n```\n\n**Witness Run Command:**\n```bash\nwitness run --step build \\\n  --attestations material \\\n  --outfile build-attestation.json \\\n  --key signing-key.pem \\\n  -- <your-build-command>\n```\n\n**Rego Validation Rules:**\n```rego\n\n```\n\n**Verification:**\n```bash\nwitness verify \\\n  --policy policy-signed.json \\\n  --publickey policy-key.pub \\\n  -a build-attestation.json \\\n  --subject <artifact>\n```\n"}]}
{"messages": [{"role": "system", "content": "You are an expert in the Witness supply chain attestation framework. You help users instrument CI/CD pipelines with witness, create policy documents, and write Rego policies to validate attestations. You understand all attestors in go-witness and how to use them effectively."}, {"role": "user", "content": "How do I create a witness policy for a build step that uses these attestors: material, github, commandrun, environment?"}, {"role": "assistant", "content": "Here's a complete witness policy for your build step with material, github, commandrun, environment attestors:\n\n**Policy Document:**\n```json\n{\n  \"expires\": \"2026-11-08T10:52:59Z\",\n  \"publickeys\": {\n    \"build-key\": {\n      \"keyid\": \"sha256:f5de93b8e331f549e8a9f5bccf09aac97e81ef962b6d0daf99441105a7c40050\",\n      \"key\": \"-----BEGIN PUBLIC KEY-----\\n...\\n-----END PUBLIC KEY-----\"\n    }\n  },\n  \"steps\": {\n    \"build\": {\n      \"name\": \"build\",\n      \"attestations\": [\n        {\n          \"type\": \"https://witness.dev/attestations/material/v0.1\"\n        },\n        {\n          \"type\": \"https://witness.dev/attestations/github/v0.1\"\n        },\n        {\n          \"type\": \"https://witness.dev/attestations/command-run/v0.1\"\n        },\n        {\n          \"type\": \"https://witness.dev/attestations/environment/v0.1\"\n        }\n      ],\n      \"functionaries\": [\n        {\n          \"type\": \"publickey\",\n          \"publickeyid\": \"build-key\"\n        }\n      ]\n    }\n  }\n}\n```\n\n**Witness Run Command:**\n```bash\nwitness run --step build \\\n  --attestations material,github,commandrun,environment \\\n  --outfile build-attestation.json \\\n  --key signing-key.pem \\\n  -- <your-build-command>\n```\n\n**Rego Validation Rules:**\n```rego\n\n```\n\n**Verification:**\n```bash\nwitness verify \\\n  --policy policy-signed.json \\\n  --publickey policy-key.pub \\\n  -a build-attestation.json \\\n  --subject <artifact>\n```\n"}]}
{"messages": [{"role": "system", "content": "You are an expert in the Witness supply chain attestation framework. You help users instrument CI/CD pipelines with witness, create policy documents, and write Rego policies to validate attestations. You understand all attestors in go-witness and how to use them effectively."}, {"role": "user", "content": "How do I create a witness policy for a build step that uses these attestors: git, environment?"}, {"role": "assistant", "content": "Here's a complete witness policy for your build step with git, environment attestors:\n\n**Policy Document:**\n```json\n{\n  \"expires\": \"2026-11-08T10:52:59Z\",\n  \"publickeys\": {\n    \"build-key\": {\n      \"keyid\": \"sha256:b772dc74e8e4b9502a49347f5a69c361d06a36a3266369aa066470d9a10709c8\",\n      \"key\": \"-----BEGIN PUBLIC KEY-----\\n...\\n-----END PUBLIC KEY-----\"\n    }\n  },\n  \"steps\": {\n    \"build\": {\n      \"name\": \"build\",\n      \"attestations\": [\n        {\n          \"type\": \"https://witness.dev/attestations/git/v0.1\"\n        },\n        {\n          \"type\": \"https://witness.dev/attestations/environment/v0.1\"\n        }\n      ],\n      \"functionaries\": [\n        {\n          \"type\": \"publickey\",\n          \"publickeyid\": \"build-key\"\n        }\n      ]\n    }\n  }\n}\n```\n\n**Witness Run Command:**\n```bash\nwitness run --step build \\\n  --attestations git,environment \\\n  --outfile build-attestation.json \\\n  --key signing-key.pem \\\n  -- <your-build-command>\n```\n\n**Rego Validation Rules:**\n```rego\npackage git\n\nimport rego.v1\n\n# Enforce builds from specific branch\ndeny contains msg if {\n    input.branch != \"feature/auth\"\n    msg := sprintf(\"Must build from feature/auth branch, got: %s\", [input.branch])\n}\n\n# Require clean working directory\ndeny contains msg if {\n    count(input.status) > 0\n    msg := \"Working directory must be clean (no uncommitted changes)\"\n}\n\n# Validate commit author\napproved_authors := {\n    \"alice.smith@example.com\",\n    \"bob.jones@company.com\",\n    \"ci-bot@company.com\"\n}\n\ndeny contains msg if {\n    not input.authoremail in approved_authors\n    msg := sprintf(\"Unauthorized commit author: %s\", [input.authoremail])\n}\n```\n\n**Verification:**\n```bash\nwitness verify \\\n  --policy policy-signed.json \\\n  --publickey policy-key.pub \\\n  -a build-attestation.json \\\n  --subject <artifact>\n```\n"}]}
{"messages": [{"role": "system", "content": "You are an expert in the Witness supply chain attestation framework. You help users instrument CI/CD pipelines with witness, create policy documents, and write Rego policies to validate attestations. You understand all attestors in go-witness and how to use them effectively."}, {"role": "user", "content": "How do I create a witness policy for a build step that uses these attestors: git?"}, {"role": "assistant", "content": "Here's a complete witness policy for your build step with git attestors:\n\n**Policy Document:**\n```json\n{\n  \"expires\": \"2026-11-08T10:52:59Z\",\n  \"publickeys\": {\n    \"build-key\": {\n      \"keyid\": \"sha256:be163074bd67a36c9286952aba61afcd989e803fcfa3056824ef2d8615076950\",\n      \"key\": \"-----BEGIN PUBLIC KEY-----\\n...\\n-----END PUBLIC KEY-----\"\n    }\n  },\n  \"steps\": {\n    \"build\": {\n      \"name\": \"build\",\n      \"attestations\": [\n        {\n          \"type\": \"https://witness.dev/attestations/git/v0.1\"\n        }\n      ],\n      \"functionaries\": [\n        {\n          \"type\": \"publickey\",\n          \"publickeyid\": \"build-key\"\n        }\n      ]\n    }\n  }\n}\n```\n\n**Witness Run Command:**\n```bash\nwitness run --step build \\\n  --attestations git \\\n  --outfile build-attestation.json \\\n  --key signing-key.pem \\\n  -- <your-build-command>\n```\n\n**Rego Validation Rules:**\n```rego\npackage git\n\nimport rego.v1\n\n# Enforce builds from specific branch\ndeny contains msg if {\n    input.branch != \"feature/auth\"\n    msg := sprintf(\"Must build from feature/auth branch, got: %s\", [input.branch])\n}\n\n# Validate commit author\napproved_authors := {\n    \"alice.smith@example.com\",\n    \"bob.jones@company.com\",\n    \"ci-bot@company.com\"\n}\n\ndeny contains msg if {\n    not input.authoremail in approved_authors\n    msg := sprintf(\"Unauthorized commit author: %s\", [input.authoremail])\n}\n```\n\n**Verification:**\n```bash\nwitness verify \\\n  --policy policy-signed.json \\\n  --publickey policy-key.pub \\\n  -a build-attestation.json \\\n  --subject <artifact>\n```\n"}]}
{"messages": [{"role": "system", "content": "You are an expert in the Witness supply chain attestation framework. You help users instrument CI/CD pipelines with witness, create policy documents, and write Rego policies to validate attestations. You understand all attestors in go-witness and how to use them effectively."}, {"role": "user", "content": "How do I create a multi-step witness policy for a build \u2192 test \u2192 package pipeline?"}, {"role": "assistant", "content": "Here's a complete multi-step witness policy for your pipeline:\n\n**Policy Document:**\n```json\n{\n  \"expires\": \"2026-11-08T10:52:59Z\",\n  \"publickeys\": {\n    \"ci-key\": {\n      \"keyid\": \"sha256:f5957c2e298c7ff759868262095c001bf31aa5d91d0d659113e5c013914bbe5b\",\n      \"key\": \"-----BEGIN PUBLIC KEY-----\\n...\\n-----END PUBLIC KEY-----\"\n    }\n  },\n  \"steps\": {\n    \"build\": {\n      \"name\": \"build\",\n      \"attestations\": [\n        {\n          \"type\": \"https://witness.dev/attestations/git/v0.1\"\n        },\n        {\n          \"type\": \"https://witness.dev/attestations/command-run/v0.1\"\n        },\n        {\n          \"type\": \"https://witness.dev/attestations/product/v0.1\"\n        }\n      ],\n      \"functionaries\": [\n        {\n          \"type\": \"publickey\",\n          \"publickeyid\": \"ci-key\"\n        }\n      ]\n    },\n    \"test\": {\n      \"name\": \"test\",\n      \"attestations\": [\n        {\n          \"type\": \"https://witness.dev/attestations/material/v0.1\"\n        },\n        {\n          \"type\": \"https://witness.dev/attestations/command-run/v0.1\"\n        }\n      ],\n      \"functionaries\": [\n        {\n          \"type\": \"publickey\",\n          \"publickeyid\": \"ci-key\"\n        }\n      ]\n    },\n    \"package\": {\n      \"name\": \"package\",\n      \"attestations\": [\n        {\n          \"type\": \"https://witness.dev/attestations/material/v0.1\"\n        },\n        {\n          \"type\": \"https://witness.dev/attestations/product/v0.1\"\n        }\n      ],\n      \"functionaries\": [\n        {\n          \"type\": \"publickey\",\n          \"publickeyid\": \"ci-key\"\n        }\n      ]\n    }\n  }\n}\n```\n\n**Pipeline Commands:**\n\n```bash\n# Step 1: Build\nwitness run --step build \\\n  --attestations git,commandrun,product \\\n  -o build.json --key ci-key.pem \\\n  -- go build -o myapp\n\n# Step 2: Test\nwitness run --step test \\\n  --attestations material,commandrun \\\n  -o test.json --key ci-key.pem \\\n  -- go test ./...\n\n# Step 3: Package\nwitness run --step package \\\n  --attestations material,product \\\n  -o package.json --key ci-key.pem \\\n  -- tar czf myapp.tar.gz myapp\n\n# Verify entire pipeline\nwitness verify \\\n  --policy policy-signed.json \\\n  --publickey policy-key.pub \\\n  -a build.json -a test.json -a package.json\n```\n"}]}
{"messages": [{"role": "system", "content": "You are an expert in the Witness supply chain attestation framework. You help users instrument CI/CD pipelines with witness, create policy documents, and write Rego policies to validate attestations. You understand all attestors in go-witness and how to use them effectively."}, {"role": "user", "content": "How do I create a witness policy for a build step that uses these attestors: github, commandrun, product?"}, {"role": "assistant", "content": "Here's a complete witness policy for your build step with github, commandrun, product attestors:\n\n**Policy Document:**\n```json\n{\n  \"expires\": \"2026-11-08T10:52:59Z\",\n  \"publickeys\": {\n    \"build-key\": {\n      \"keyid\": \"sha256:8382275bd1ef623202b3f0ae9489e4c1051a83411c4f63d5aeb9cb6cf91ccace\",\n      \"key\": \"-----BEGIN PUBLIC KEY-----\\n...\\n-----END PUBLIC KEY-----\"\n    }\n  },\n  \"steps\": {\n    \"build\": {\n      \"name\": \"build\",\n      \"attestations\": [\n        {\n          \"type\": \"https://witness.dev/attestations/github/v0.1\"\n        },\n        {\n          \"type\": \"https://witness.dev/attestations/command-run/v0.1\"\n        },\n        {\n          \"type\": \"https://witness.dev/attestations/product/v0.1\"\n        }\n      ],\n      \"functionaries\": [\n        {\n          \"type\": \"publickey\",\n          \"publickeyid\": \"build-key\"\n        }\n      ]\n    }\n  }\n}\n```\n\n**Witness Run Command:**\n```bash\nwitness run --step build \\\n  --attestations github,commandrun,product \\\n  --outfile build-attestation.json \\\n  --key signing-key.pem \\\n  -- <your-build-command>\n```\n\n**Rego Validation Rules:**\n```rego\n\n```\n\n**Verification:**\n```bash\nwitness verify \\\n  --policy policy-signed.json \\\n  --publickey policy-key.pub \\\n  -a build-attestation.json \\\n  --subject <artifact>\n```\n"}]}
{"messages": [{"role": "system", "content": "You are an expert in the Witness supply chain attestation framework. You help users instrument CI/CD pipelines with witness, create policy documents, and write Rego policies to validate attestations. You understand all attestors in go-witness and how to use them effectively."}, {"role": "user", "content": "How do I create a witness policy for a build step that uses these attestors: environment, git?"}, {"role": "assistant", "content": "Here's a complete witness policy for your build step with environment, git attestors:\n\n**Policy Document:**\n```json\n{\n  \"expires\": \"2026-11-08T10:52:59Z\",\n  \"publickeys\": {\n    \"build-key\": {\n      \"keyid\": \"sha256:f57cd6d0a5cec74acc062cff93979b5a66bcbc30a07a8eec2b12e1106133c193\",\n      \"key\": \"-----BEGIN PUBLIC KEY-----\\n...\\n-----END PUBLIC KEY-----\"\n    }\n  },\n  \"steps\": {\n    \"build\": {\n      \"name\": \"build\",\n      \"attestations\": [\n        {\n          \"type\": \"https://witness.dev/attestations/environment/v0.1\"\n        },\n        {\n          \"type\": \"https://witness.dev/attestations/git/v0.1\"\n        }\n      ],\n      \"functionaries\": [\n        {\n          \"type\": \"publickey\",\n          \"publickeyid\": \"build-key\"\n        }\n      ]\n    }\n  }\n}\n```\n\n**Witness Run Command:**\n```bash\nwitness run --step build \\\n  --attestations environment,git \\\n  --outfile build-attestation.json \\\n  --key signing-key.pem \\\n  -- <your-build-command>\n```\n\n**Rego Validation Rules:**\n```rego\npackage environment\n\nimport rego.v1\n\n# Ensure correct OS\ndeny contains msg if {\n    input.os != \"linux\"\n    msg := sprintf(\"Must run on linux, got: %s\", [input.os])\n}\n\n# Require CI environment\ndeny contains msg if {\n    not \"CI\" in input.variables\n    msg := \"Must run in CI environment (CI variable not set)\"\n}\n```\n\n**Verification:**\n```bash\nwitness verify \\\n  --policy policy-signed.json \\\n  --publickey policy-key.pub \\\n  -a build-attestation.json \\\n  --subject <artifact>\n```\n"}]}
{"messages": [{"role": "system", "content": "You are an expert in the Witness supply chain attestation framework. You help users instrument CI/CD pipelines with witness, create policy documents, and write Rego policies to validate attestations. You understand all attestors in go-witness and how to use them effectively."}, {"role": "user", "content": "How do I create a multi-step witness policy for a build \u2192 test \u2192 package pipeline?"}, {"role": "assistant", "content": "Here's a complete multi-step witness policy for your pipeline:\n\n**Policy Document:**\n```json\n{\n  \"expires\": \"2026-11-08T10:52:59Z\",\n  \"publickeys\": {\n    \"ci-key\": {\n      \"keyid\": \"sha256:addea7afcd330618152d424d3a1425d4db9fa3c4113df27144ae53df6039f4da\",\n      \"key\": \"-----BEGIN PUBLIC KEY-----\\n...\\n-----END PUBLIC KEY-----\"\n    }\n  },\n  \"steps\": {\n    \"build\": {\n      \"name\": \"build\",\n      \"attestations\": [\n        {\n          \"type\": \"https://witness.dev/attestations/git/v0.1\"\n        },\n        {\n          \"type\": \"https://witness.dev/attestations/command-run/v0.1\"\n        },\n        {\n          \"type\": \"https://witness.dev/attestations/product/v0.1\"\n        }\n      ],\n      \"functionaries\": [\n        {\n          \"type\": \"publickey\",\n          \"publickeyid\": \"ci-key\"\n        }\n      ]\n    },\n    \"test\": {\n      \"name\": \"test\",\n      \"attestations\": [\n        {\n          \"type\": \"https://witness.dev/attestations/material/v0.1\"\n        },\n        {\n          \"type\": \"https://witness.dev/attestations/command-run/v0.1\"\n        }\n      ],\n      \"functionaries\": [\n        {\n          \"type\": \"publickey\",\n          \"publickeyid\": \"ci-key\"\n        }\n      ]\n    },\n    \"package\": {\n      \"name\": \"package\",\n      \"attestations\": [\n        {\n          \"type\": \"https://witness.dev/attestations/material/v0.1\"\n        },\n        {\n          \"type\": \"https://witness.dev/attestations/product/v0.1\"\n        }\n      ],\n      \"functionaries\": [\n        {\n          \"type\": \"publickey\",\n          \"publickeyid\": \"ci-key\"\n        }\n      ]\n    }\n  }\n}\n```\n\n**Pipeline Commands:**\n\n```bash\n# Step 1: Build\nwitness run --step build \\\n  --attestations git,commandrun,product \\\n  -o build.json --key ci-key.pem \\\n  -- go build -o myapp\n\n# Step 2: Test\nwitness run --step test \\\n  --attestations material,commandrun \\\n  -o test.json --key ci-key.pem \\\n  -- go test ./...\n\n# Step 3: Package\nwitness run --step package \\\n  --attestations material,product \\\n  -o package.json --key ci-key.pem \\\n  -- tar czf myapp.tar.gz myapp\n\n# Verify entire pipeline\nwitness verify \\\n  --policy policy-signed.json \\\n  --publickey policy-key.pub \\\n  -a build.json -a test.json -a package.json\n```\n"}]}
{"messages": [{"role": "system", "content": "You are an expert in the Witness supply chain attestation framework. You help users instrument CI/CD pipelines with witness, create policy documents, and write Rego policies to validate attestations. You understand all attestors in go-witness and how to use them effectively."}, {"role": "user", "content": "How do I create a witness policy for a build step that uses these attestors: commandrun?"}, {"role": "assistant", "content": "Here's a complete witness policy for your build step with commandrun attestors:\n\n**Policy Document:**\n```json\n{\n  \"expires\": \"2026-11-08T10:52:59Z\",\n  \"publickeys\": {\n    \"build-key\": {\n      \"keyid\": \"sha256:16356b9cc1a8000d62f23f02e3949cafbec690818ce6849e6c7c4a81fe55c6f3\",\n      \"key\": \"-----BEGIN PUBLIC KEY-----\\n...\\n-----END PUBLIC KEY-----\"\n    }\n  },\n  \"steps\": {\n    \"build\": {\n      \"name\": \"build\",\n      \"attestations\": [\n        {\n          \"type\": \"https://witness.dev/attestations/command-run/v0.1\"\n        }\n      ],\n      \"functionaries\": [\n        {\n          \"type\": \"publickey\",\n          \"publickeyid\": \"build-key\"\n        }\n      ]\n    }\n  }\n}\n```\n\n**Witness Run Command:**\n```bash\nwitness run --step build \\\n  --attestations commandrun \\\n  --outfile build-attestation.json \\\n  --key signing-key.pem \\\n  -- <your-build-command>\n```\n\n**Rego Validation Rules:**\n```rego\n\n```\n\n**Verification:**\n```bash\nwitness verify \\\n  --policy policy-signed.json \\\n  --publickey policy-key.pub \\\n  -a build-attestation.json \\\n  --subject <artifact>\n```\n"}]}
{"messages": [{"role": "system", "content": "You are an expert in the Witness supply chain attestation framework. You help users instrument CI/CD pipelines with witness, create policy documents, and write Rego policies to validate attestations. You understand all attestors in go-witness and how to use them effectively."}, {"role": "user", "content": "How do I create a witness policy for a build step that uses these attestors: commandrun, git?"}, {"role": "assistant", "content": "Here's a complete witness policy for your build step with commandrun, git attestors:\n\n**Policy Document:**\n```json\n{\n  \"expires\": \"2026-11-08T10:52:59Z\",\n  \"publickeys\": {\n    \"build-key\": {\n      \"keyid\": \"sha256:3b5ffb0728fa63aa3e39f36a5175c0f33556dfab9af72ecb3407aa8103b7a38a\",\n      \"key\": \"-----BEGIN PUBLIC KEY-----\\n...\\n-----END PUBLIC KEY-----\"\n    }\n  },\n  \"steps\": {\n    \"build\": {\n      \"name\": \"build\",\n      \"attestations\": [\n        {\n          \"type\": \"https://witness.dev/attestations/command-run/v0.1\"\n        },\n        {\n          \"type\": \"https://witness.dev/attestations/git/v0.1\"\n        }\n      ],\n      \"functionaries\": [\n        {\n          \"type\": \"publickey\",\n          \"publickeyid\": \"build-key\"\n        }\n      ]\n    }\n  }\n}\n```\n\n**Witness Run Command:**\n```bash\nwitness run --step build \\\n  --attestations commandrun,git \\\n  --outfile build-attestation.json \\\n  --key signing-key.pem \\\n  -- <your-build-command>\n```\n\n**Rego Validation Rules:**\n```rego\n\n```\n\n**Verification:**\n```bash\nwitness verify \\\n  --policy policy-signed.json \\\n  --publickey policy-key.pub \\\n  -a build-attestation.json \\\n  --subject <artifact>\n```\n"}]}
{"messages": [{"role": "system", "content": "You are an expert in the Witness supply chain attestation framework. You help users instrument CI/CD pipelines with witness, create policy documents, and write Rego policies to validate attestations. You understand all attestors in go-witness and how to use them effectively."}, {"role": "user", "content": "How do I create a multi-step witness policy for a build \u2192 test \u2192 package pipeline?"}, {"role": "assistant", "content": "Here's a complete multi-step witness policy for your pipeline:\n\n**Policy Document:**\n```json\n{\n  \"expires\": \"2026-11-08T10:52:59Z\",\n  \"publickeys\": {\n    \"ci-key\": {\n      \"keyid\": \"sha256:a5e528fcf20f6f952af91d44b7b1f6e6b5525b10163d5fced02787a31c7501bf\",\n      \"key\": \"-----BEGIN PUBLIC KEY-----\\n...\\n-----END PUBLIC KEY-----\"\n    }\n  },\n  \"steps\": {\n    \"build\": {\n      \"name\": \"build\",\n      \"attestations\": [\n        {\n          \"type\": \"https://witness.dev/attestations/git/v0.1\"\n        },\n        {\n          \"type\": \"https://witness.dev/attestations/command-run/v0.1\"\n        },\n        {\n          \"type\": \"https://witness.dev/attestations/product/v0.1\"\n        }\n      ],\n      \"functionaries\": [\n        {\n          \"type\": \"publickey\",\n          \"publickeyid\": \"ci-key\"\n        }\n      ]\n    },\n    \"test\": {\n      \"name\": \"test\",\n      \"attestations\": [\n        {\n          \"type\": \"https://witness.dev/attestations/material/v0.1\"\n        },\n        {\n          \"type\": \"https://witness.dev/attestations/command-run/v0.1\"\n        }\n      ],\n      \"functionaries\": [\n        {\n          \"type\": \"publickey\",\n          \"publickeyid\": \"ci-key\"\n        }\n      ]\n    },\n    \"package\": {\n      \"name\": \"package\",\n      \"attestations\": [\n        {\n          \"type\": \"https://witness.dev/attestations/material/v0.1\"\n        },\n        {\n          \"type\": \"https://witness.dev/attestations/product/v0.1\"\n        }\n      ],\n      \"functionaries\": [\n        {\n          \"type\": \"publickey\",\n          \"publickeyid\": \"ci-key\"\n        }\n      ]\n    }\n  }\n}\n```\n\n**Pipeline Commands:**\n\n```bash\n# Step 1: Build\nwitness run --step build \\\n  --attestations git,commandrun,product \\\n  -o build.json --key ci-key.pem \\\n  -- go build -o myapp\n\n# Step 2: Test\nwitness run --step test \\\n  --attestations material,commandrun \\\n  -o test.json --key ci-key.pem \\\n  -- go test ./...\n\n# Step 3: Package\nwitness run --step package \\\n  --attestations material,product \\\n  -o package.json --key ci-key.pem \\\n  -- tar czf myapp.tar.gz myapp\n\n# Verify entire pipeline\nwitness verify \\\n  --policy policy-signed.json \\\n  --publickey policy-key.pub \\\n  -a build.json -a test.json -a package.json\n```\n"}]}
{"messages": [{"role": "system", "content": "You are an expert in the Witness supply chain attestation framework. You help users instrument CI/CD pipelines with witness, create policy documents, and write Rego policies to validate attestations. You understand all attestors in go-witness and how to use them effectively."}, {"role": "user", "content": "How do I create a witness policy for a build step that uses these attestors: github?"}, {"role": "assistant", "content": "Here's a complete witness policy for your build step with github attestors:\n\n**Policy Document:**\n```json\n{\n  \"expires\": \"2026-11-08T10:52:59Z\",\n  \"publickeys\": {\n    \"build-key\": {\n      \"keyid\": \"sha256:6849f3ae62888f1330223206a4ae0e2fa122c2a50404e1050d8bcba2cf28d4aa\",\n      \"key\": \"-----BEGIN PUBLIC KEY-----\\n...\\n-----END PUBLIC KEY-----\"\n    }\n  },\n  \"steps\": {\n    \"build\": {\n      \"name\": \"build\",\n      \"attestations\": [\n        {\n          \"type\": \"https://witness.dev/attestations/github/v0.1\"\n        }\n      ],\n      \"functionaries\": [\n        {\n          \"type\": \"publickey\",\n          \"publickeyid\": \"build-key\"\n        }\n      ]\n    }\n  }\n}\n```\n\n**Witness Run Command:**\n```bash\nwitness run --step build \\\n  --attestations github \\\n  --outfile build-attestation.json \\\n  --key signing-key.pem \\\n  -- <your-build-command>\n```\n\n**Rego Validation Rules:**\n```rego\n\n```\n\n**Verification:**\n```bash\nwitness verify \\\n  --policy policy-signed.json \\\n  --publickey policy-key.pub \\\n  -a build-attestation.json \\\n  --subject <artifact>\n```\n"}]}
{"messages": [{"role": "system", "content": "You are an expert in the Witness supply chain attestation framework. You help users instrument CI/CD pipelines with witness, create policy documents, and write Rego policies to validate attestations. You understand all attestors in go-witness and how to use them effectively."}, {"role": "user", "content": "How do I create a witness policy for a build step that uses these attestors: environment, github?"}, {"role": "assistant", "content": "Here's a complete witness policy for your build step with environment, github attestors:\n\n**Policy Document:**\n```json\n{\n  \"expires\": \"2026-11-08T10:52:59Z\",\n  \"publickeys\": {\n    \"build-key\": {\n      \"keyid\": \"sha256:9825a23df760d48796be448f272d7e1af782b7d6179e2685c89dec4ee3c25fd1\",\n      \"key\": \"-----BEGIN PUBLIC KEY-----\\n...\\n-----END PUBLIC KEY-----\"\n    }\n  },\n  \"steps\": {\n    \"build\": {\n      \"name\": \"build\",\n      \"attestations\": [\n        {\n          \"type\": \"https://witness.dev/attestations/environment/v0.1\"\n        },\n        {\n          \"type\": \"https://witness.dev/attestations/github/v0.1\"\n        }\n      ],\n      \"functionaries\": [\n        {\n          \"type\": \"publickey\",\n          \"publickeyid\": \"build-key\"\n        }\n      ]\n    }\n  }\n}\n```\n\n**Witness Run Command:**\n```bash\nwitness run --step build \\\n  --attestations environment,github \\\n  --outfile build-attestation.json \\\n  --key signing-key.pem \\\n  -- <your-build-command>\n```\n\n**Rego Validation Rules:**\n```rego\npackage environment\n\nimport rego.v1\n\n# Ensure correct OS\ndeny contains msg if {\n    input.os != \"windows\"\n    msg := sprintf(\"Must run on windows, got: %s\", [input.os])\n}\n\n# Require CI environment\ndeny contains msg if {\n    not \"CI\" in input.variables\n    msg := \"Must run in CI environment (CI variable not set)\"\n}\n```\n\n**Verification:**\n```bash\nwitness verify \\\n  --policy policy-signed.json \\\n  --publickey policy-key.pub \\\n  -a build-attestation.json \\\n  --subject <artifact>\n```\n"}]}
{"messages": [{"role": "system", "content": "You are an expert in the Witness supply chain attestation framework. You help users instrument CI/CD pipelines with witness, create policy documents, and write Rego policies to validate attestations. You understand all attestors in go-witness and how to use them effectively."}, {"role": "user", "content": "How do I create a witness policy for a build step that uses these attestors: material, product, github?"}, {"role": "assistant", "content": "Here's a complete witness policy for your build step with material, product, github attestors:\n\n**Policy Document:**\n```json\n{\n  \"expires\": \"2026-11-08T10:52:59Z\",\n  \"publickeys\": {\n    \"build-key\": {\n      \"keyid\": \"sha256:ec8a592d3b6722053085fcc16d18f2d3316e9548d0a1054b07e8d93b61c8e9ab\",\n      \"key\": \"-----BEGIN PUBLIC KEY-----\\n...\\n-----END PUBLIC KEY-----\"\n    }\n  },\n  \"steps\": {\n    \"build\": {\n      \"name\": \"build\",\n      \"attestations\": [\n        {\n          \"type\": \"https://witness.dev/attestations/material/v0.1\"\n        },\n        {\n          \"type\": \"https://witness.dev/attestations/product/v0.1\"\n        },\n        {\n          \"type\": \"https://witness.dev/attestations/github/v0.1\"\n        }\n      ],\n      \"functionaries\": [\n        {\n          \"type\": \"publickey\",\n          \"publickeyid\": \"build-key\"\n        }\n      ]\n    }\n  }\n}\n```\n\n**Witness Run Command:**\n```bash\nwitness run --step build \\\n  --attestations material,product,github \\\n  --outfile build-attestation.json \\\n  --key signing-key.pem \\\n  -- <your-build-command>\n```\n\n**Rego Validation Rules:**\n```rego\n\n```\n\n**Verification:**\n```bash\nwitness verify \\\n  --policy policy-signed.json \\\n  --publickey policy-key.pub \\\n  -a build-attestation.json \\\n  --subject <artifact>\n```\n"}]}
{"messages": [{"role": "system", "content": "You are an expert in the Witness supply chain attestation framework. You help users instrument CI/CD pipelines with witness, create policy documents, and write Rego policies to validate attestations. You understand all attestors in go-witness and how to use them effectively."}, {"role": "user", "content": "How do I create a multi-step witness policy for a build \u2192 test \u2192 package pipeline?"}, {"role": "assistant", "content": "Here's a complete multi-step witness policy for your pipeline:\n\n**Policy Document:**\n```json\n{\n  \"expires\": \"2026-11-08T10:52:59Z\",\n  \"publickeys\": {\n    \"ci-key\": {\n      \"keyid\": \"sha256:9407beabc73f2abc24942cdb24e44a05a64da41be6f3911cf2e3ec60a22f7243\",\n      \"key\": \"-----BEGIN PUBLIC KEY-----\\n...\\n-----END PUBLIC KEY-----\"\n    }\n  },\n  \"steps\": {\n    \"build\": {\n      \"name\": \"build\",\n      \"attestations\": [\n        {\n          \"type\": \"https://witness.dev/attestations/git/v0.1\"\n        },\n        {\n          \"type\": \"https://witness.dev/attestations/command-run/v0.1\"\n        },\n        {\n          \"type\": \"https://witness.dev/attestations/product/v0.1\"\n        }\n      ],\n      \"functionaries\": [\n        {\n          \"type\": \"publickey\",\n          \"publickeyid\": \"ci-key\"\n        }\n      ]\n    },\n    \"test\": {\n      \"name\": \"test\",\n      \"attestations\": [\n        {\n          \"type\": \"https://witness.dev/attestations/material/v0.1\"\n        },\n        {\n          \"type\": \"https://witness.dev/attestations/command-run/v0.1\"\n        }\n      ],\n      \"functionaries\": [\n        {\n          \"type\": \"publickey\",\n          \"publickeyid\": \"ci-key\"\n        }\n      ]\n    },\n    \"package\": {\n      \"name\": \"package\",\n      \"attestations\": [\n        {\n          \"type\": \"https://witness.dev/attestations/material/v0.1\"\n        },\n        {\n          \"type\": \"https://witness.dev/attestations/product/v0.1\"\n        }\n      ],\n      \"functionaries\": [\n        {\n          \"type\": \"publickey\",\n          \"publickeyid\": \"ci-key\"\n        }\n      ]\n    }\n  }\n}\n```\n\n**Pipeline Commands:**\n\n```bash\n# Step 1: Build\nwitness run --step build \\\n  --attestations git,commandrun,product \\\n  -o build.json --key ci-key.pem \\\n  -- go build -o myapp\n\n# Step 2: Test\nwitness run --step test \\\n  --attestations material,commandrun \\\n  -o test.json --key ci-key.pem \\\n  -- go test ./...\n\n# Step 3: Package\nwitness run --step package \\\n  --attestations material,product \\\n  -o package.json --key ci-key.pem \\\n  -- tar czf myapp.tar.gz myapp\n\n# Verify entire pipeline\nwitness verify \\\n  --policy policy-signed.json \\\n  --publickey policy-key.pub \\\n  -a build.json -a test.json -a package.json\n```\n"}]}
{"messages": [{"role": "system", "content": "You are an expert in the Witness supply chain attestation framework. You help users instrument CI/CD pipelines with witness, create policy documents, and write Rego policies to validate attestations. You understand all attestors in go-witness and how to use them effectively."}, {"role": "user", "content": "How do I create a witness policy for a build step that uses these attestors: environment, product, github, git?"}, {"role": "assistant", "content": "Here's a complete witness policy for your build step with environment, product, github, git attestors:\n\n**Policy Document:**\n```json\n{\n  \"expires\": \"2026-11-08T10:52:59Z\",\n  \"publickeys\": {\n    \"build-key\": {\n      \"keyid\": \"sha256:978a468947fa2b0749d9c524315c059db2063e655354801cbec6bf9d1de37952\",\n      \"key\": \"-----BEGIN PUBLIC KEY-----\\n...\\n-----END PUBLIC KEY-----\"\n    }\n  },\n  \"steps\": {\n    \"build\": {\n      \"name\": \"build\",\n      \"attestations\": [\n        {\n          \"type\": \"https://witness.dev/attestations/environment/v0.1\"\n        },\n        {\n          \"type\": \"https://witness.dev/attestations/product/v0.1\"\n        },\n        {\n          \"type\": \"https://witness.dev/attestations/github/v0.1\"\n        },\n        {\n          \"type\": \"https://witness.dev/attestations/git/v0.1\"\n        }\n      ],\n      \"functionaries\": [\n        {\n          \"type\": \"publickey\",\n          \"publickeyid\": \"build-key\"\n        }\n      ]\n    }\n  }\n}\n```\n\n**Witness Run Command:**\n```bash\nwitness run --step build \\\n  --attestations environment,product,github,git \\\n  --outfile build-attestation.json \\\n  --key signing-key.pem \\\n  -- <your-build-command>\n```\n\n**Rego Validation Rules:**\n```rego\npackage environment\n\nimport rego.v1\n\n# Ensure correct OS\ndeny contains msg if {\n    input.os != \"windows\"\n    msg := sprintf(\"Must run on windows, got: %s\", [input.os])\n}\n\n# Require CI environment\ndeny contains msg if {\n    not \"CI\" in input.variables\n    msg := \"Must run in CI environment (CI variable not set)\"\n}\n```\n\n**Verification:**\n```bash\nwitness verify \\\n  --policy policy-signed.json \\\n  --publickey policy-key.pub \\\n  -a build-attestation.json \\\n  --subject <artifact>\n```\n"}]}
{"messages": [{"role": "system", "content": "You are an expert in the Witness supply chain attestation framework. You help users instrument CI/CD pipelines with witness, create policy documents, and write Rego policies to validate attestations. You understand all attestors in go-witness and how to use them effectively."}, {"role": "user", "content": "How do I create a witness policy for a build step that uses these attestors: environment, git, material, commandrun, github?"}, {"role": "assistant", "content": "Here's a complete witness policy for your build step with environment, git, material, commandrun, github attestors:\n\n**Policy Document:**\n```json\n{\n  \"expires\": \"2026-11-08T10:52:59Z\",\n  \"publickeys\": {\n    \"build-key\": {\n      \"keyid\": \"sha256:61c950227190691232a5d3f6124c5a8f7ee1adad2c3d0942d771541f4b168cd0\",\n      \"key\": \"-----BEGIN PUBLIC KEY-----\\n...\\n-----END PUBLIC KEY-----\"\n    }\n  },\n  \"steps\": {\n    \"build\": {\n      \"name\": \"build\",\n      \"attestations\": [\n        {\n          \"type\": \"https://witness.dev/attestations/environment/v0.1\"\n        },\n        {\n          \"type\": \"https://witness.dev/attestations/git/v0.1\"\n        },\n        {\n          \"type\": \"https://witness.dev/attestations/material/v0.1\"\n        },\n        {\n          \"type\": \"https://witness.dev/attestations/command-run/v0.1\"\n        },\n        {\n          \"type\": \"https://witness.dev/attestations/github/v0.1\"\n        }\n      ],\n      \"functionaries\": [\n        {\n          \"type\": \"publickey\",\n          \"publickeyid\": \"build-key\"\n        }\n      ]\n    }\n  }\n}\n```\n\n**Witness Run Command:**\n```bash\nwitness run --step build \\\n  --attestations environment,git,material,commandrun,github \\\n  --outfile build-attestation.json \\\n  --key signing-key.pem \\\n  -- <your-build-command>\n```\n\n**Rego Validation Rules:**\n```rego\npackage environment\n\nimport rego.v1\n\n# Ensure correct OS\ndeny contains msg if {\n    input.os != \"windows\"\n    msg := sprintf(\"Must run on windows, got: %s\", [input.os])\n}\n\n# Require CI environment\ndeny contains msg if {\n    not \"CI\" in input.variables\n    msg := \"Must run in CI environment (CI variable not set)\"\n}\n```\n\n**Verification:**\n```bash\nwitness verify \\\n  --policy policy-signed.json \\\n  --publickey policy-key.pub \\\n  -a build-attestation.json \\\n  --subject <artifact>\n```\n"}]}
{"messages": [{"role": "system", "content": "You are an expert in the Witness supply chain attestation framework. You help users instrument CI/CD pipelines with witness, create policy documents, and write Rego policies to validate attestations. You understand all attestors in go-witness and how to use them effectively."}, {"role": "user", "content": "How do I create a witness policy for a build step that uses these attestors: git, product, commandrun, material, github?"}, {"role": "assistant", "content": "Here's a complete witness policy for your build step with git, product, commandrun, material, github attestors:\n\n**Policy Document:**\n```json\n{\n  \"expires\": \"2026-11-08T10:52:59Z\",\n  \"publickeys\": {\n    \"build-key\": {\n      \"keyid\": \"sha256:720281286357591024d65d853be1d95c3a3091427f64900818f89df833ab7b92\",\n      \"key\": \"-----BEGIN PUBLIC KEY-----\\n...\\n-----END PUBLIC KEY-----\"\n    }\n  },\n  \"steps\": {\n    \"build\": {\n      \"name\": \"build\",\n      \"attestations\": [\n        {\n          \"type\": \"https://witness.dev/attestations/git/v0.1\"\n        },\n        {\n          \"type\": \"https://witness.dev/attestations/product/v0.1\"\n        },\n        {\n          \"type\": \"https://witness.dev/attestations/command-run/v0.1\"\n        },\n        {\n          \"type\": \"https://witness.dev/attestations/material/v0.1\"\n        },\n        {\n          \"type\": \"https://witness.dev/attestations/github/v0.1\"\n        }\n      ],\n      \"functionaries\": [\n        {\n          \"type\": \"publickey\",\n          \"publickeyid\": \"build-key\"\n        }\n      ]\n    }\n  }\n}\n```\n\n**Witness Run Command:**\n```bash\nwitness run --step build \\\n  --attestations git,product,commandrun,material,github \\\n  --outfile build-attestation.json \\\n  --key signing-key.pem \\\n  -- <your-build-command>\n```\n\n**Rego Validation Rules:**\n```rego\npackage git\n\nimport rego.v1\n\n# Enforce builds from specific branch\ndeny contains msg if {\n    input.branch != \"main\"\n    msg := sprintf(\"Must build from main branch, got: %s\", [input.branch])\n}\n\n# Require clean working directory\ndeny contains msg if {\n    count(input.status) > 0\n    msg := \"Working directory must be clean (no uncommitted changes)\"\n}\n\n# Validate commit author\napproved_authors := {\n    \"alice.smith@example.com\",\n    \"bob.jones@company.com\",\n    \"ci-bot@company.com\"\n}\n\ndeny contains msg if {\n    not input.authoremail in approved_authors\n    msg := sprintf(\"Unauthorized commit author: %s\", [input.authoremail])\n}\n```\n\n**Verification:**\n```bash\nwitness verify \\\n  --policy policy-signed.json \\\n  --publickey policy-key.pub \\\n  -a build-attestation.json \\\n  --subject <artifact>\n```\n"}]}
{"messages": [{"role": "system", "content": "You are an expert in the Witness supply chain attestation framework. You help users instrument CI/CD pipelines with witness, create policy documents, and write Rego policies to validate attestations. You understand all attestors in go-witness and how to use them effectively."}, {"role": "user", "content": "How do I create a multi-step witness policy for a build \u2192 test \u2192 package pipeline?"}, {"role": "assistant", "content": "Here's a complete multi-step witness policy for your pipeline:\n\n**Policy Document:**\n```json\n{\n  \"expires\": \"2026-11-08T10:52:59Z\",\n  \"publickeys\": {\n    \"ci-key\": {\n      \"keyid\": \"sha256:2722efc55cb21baed671f03bb996959c7d4f7021f4f2f2e8671fd0b94d8cac4f\",\n      \"key\": \"-----BEGIN PUBLIC KEY-----\\n...\\n-----END PUBLIC KEY-----\"\n    }\n  },\n  \"steps\": {\n    \"build\": {\n      \"name\": \"build\",\n      \"attestations\": [\n        {\n          \"type\": \"https://witness.dev/attestations/git/v0.1\"\n        },\n        {\n          \"type\": \"https://witness.dev/attestations/command-run/v0.1\"\n        },\n        {\n          \"type\": \"https://witness.dev/attestations/product/v0.1\"\n        }\n      ],\n      \"functionaries\": [\n        {\n          \"type\": \"publickey\",\n          \"publickeyid\": \"ci-key\"\n        }\n      ]\n    },\n    \"test\": {\n      \"name\": \"test\",\n      \"attestations\": [\n        {\n          \"type\": \"https://witness.dev/attestations/material/v0.1\"\n        },\n        {\n          \"type\": \"https://witness.dev/attestations/command-run/v0.1\"\n        }\n      ],\n      \"functionaries\": [\n        {\n          \"type\": \"publickey\",\n          \"publickeyid\": \"ci-key\"\n        }\n      ]\n    },\n    \"package\": {\n      \"name\": \"package\",\n      \"attestations\": [\n        {\n          \"type\": \"https://witness.dev/attestations/material/v0.1\"\n        },\n        {\n          \"type\": \"https://witness.dev/attestations/product/v0.1\"\n        }\n      ],\n      \"functionaries\": [\n        {\n          \"type\": \"publickey\",\n          \"publickeyid\": \"ci-key\"\n        }\n      ]\n    }\n  }\n}\n```\n\n**Pipeline Commands:**\n\n```bash\n# Step 1: Build\nwitness run --step build \\\n  --attestations git,commandrun,product \\\n  -o build.json --key ci-key.pem \\\n  -- go build -o myapp\n\n# Step 2: Test\nwitness run --step test \\\n  --attestations material,commandrun \\\n  -o test.json --key ci-key.pem \\\n  -- go test ./...\n\n# Step 3: Package\nwitness run --step package \\\n  --attestations material,product \\\n  -o package.json --key ci-key.pem \\\n  -- tar czf myapp.tar.gz myapp\n\n# Verify entire pipeline\nwitness verify \\\n  --policy policy-signed.json \\\n  --publickey policy-key.pub \\\n  -a build.json -a test.json -a package.json\n```\n"}]}
{"messages": [{"role": "system", "content": "You are an expert in the Witness supply chain attestation framework. You help users instrument CI/CD pipelines with witness, create policy documents, and write Rego policies to validate attestations. You understand all attestors in go-witness and how to use them effectively."}, {"role": "user", "content": "How do I create a witness policy for a build step that uses these attestors: github, git, product, environment, material?"}, {"role": "assistant", "content": "Here's a complete witness policy for your build step with github, git, product, environment, material attestors:\n\n**Policy Document:**\n```json\n{\n  \"expires\": \"2026-11-08T10:52:59Z\",\n  \"publickeys\": {\n    \"build-key\": {\n      \"keyid\": \"sha256:832366c8f0398dfc9d718fe1bcdc0c9ca01cdb129b4677817ad0669f9061b5bd\",\n      \"key\": \"-----BEGIN PUBLIC KEY-----\\n...\\n-----END PUBLIC KEY-----\"\n    }\n  },\n  \"steps\": {\n    \"build\": {\n      \"name\": \"build\",\n      \"attestations\": [\n        {\n          \"type\": \"https://witness.dev/attestations/github/v0.1\"\n        },\n        {\n          \"type\": \"https://witness.dev/attestations/git/v0.1\"\n        },\n        {\n          \"type\": \"https://witness.dev/attestations/product/v0.1\"\n        },\n        {\n          \"type\": \"https://witness.dev/attestations/environment/v0.1\"\n        },\n        {\n          \"type\": \"https://witness.dev/attestations/material/v0.1\"\n        }\n      ],\n      \"functionaries\": [\n        {\n          \"type\": \"publickey\",\n          \"publickeyid\": \"build-key\"\n        }\n      ]\n    }\n  }\n}\n```\n\n**Witness Run Command:**\n```bash\nwitness run --step build \\\n  --attestations github,git,product,environment,material \\\n  --outfile build-attestation.json \\\n  --key signing-key.pem \\\n  -- <your-build-command>\n```\n\n**Rego Validation Rules:**\n```rego\n\n```\n\n**Verification:**\n```bash\nwitness verify \\\n  --policy policy-signed.json \\\n  --publickey policy-key.pub \\\n  -a build-attestation.json \\\n  --subject <artifact>\n```\n"}]}
{"messages": [{"role": "system", "content": "You are an expert in the Witness supply chain attestation framework. You help users instrument CI/CD pipelines with witness, create policy documents, and write Rego policies to validate attestations. You understand all attestors in go-witness and how to use them effectively."}, {"role": "user", "content": "How do I create a multi-step witness policy for a build \u2192 test \u2192 package pipeline?"}, {"role": "assistant", "content": "Here's a complete multi-step witness policy for your pipeline:\n\n**Policy Document:**\n```json\n{\n  \"expires\": \"2026-11-08T10:52:59Z\",\n  \"publickeys\": {\n    \"ci-key\": {\n      \"keyid\": \"sha256:db294768028708ffc2dd132cebdc96addaebf4d1bddbbe7c5e48958cbd46676e\",\n      \"key\": \"-----BEGIN PUBLIC KEY-----\\n...\\n-----END PUBLIC KEY-----\"\n    }\n  },\n  \"steps\": {\n    \"build\": {\n      \"name\": \"build\",\n      \"attestations\": [\n        {\n          \"type\": \"https://witness.dev/attestations/git/v0.1\"\n        },\n        {\n          \"type\": \"https://witness.dev/attestations/command-run/v0.1\"\n        },\n        {\n          \"type\": \"https://witness.dev/attestations/product/v0.1\"\n        }\n      ],\n      \"functionaries\": [\n        {\n          \"type\": \"publickey\",\n          \"publickeyid\": \"ci-key\"\n        }\n      ]\n    },\n    \"test\": {\n      \"name\": \"test\",\n      \"attestations\": [\n        {\n          \"type\": \"https://witness.dev/attestations/material/v0.1\"\n        },\n        {\n          \"type\": \"https://witness.dev/attestations/command-run/v0.1\"\n        }\n      ],\n      \"functionaries\": [\n        {\n          \"type\": \"publickey\",\n          \"publickeyid\": \"ci-key\"\n        }\n      ]\n    },\n    \"package\": {\n      \"name\": \"package\",\n      \"attestations\": [\n        {\n          \"type\": \"https://witness.dev/attestations/material/v0.1\"\n        },\n        {\n          \"type\": \"https://witness.dev/attestations/product/v0.1\"\n        }\n      ],\n      \"functionaries\": [\n        {\n          \"type\": \"publickey\",\n          \"publickeyid\": \"ci-key\"\n        }\n      ]\n    }\n  }\n}\n```\n\n**Pipeline Commands:**\n\n```bash\n# Step 1: Build\nwitness run --step build \\\n  --attestations git,commandrun,product \\\n  -o build.json --key ci-key.pem \\\n  -- go build -o myapp\n\n# Step 2: Test\nwitness run --step test \\\n  --attestations material,commandrun \\\n  -o test.json --key ci-key.pem \\\n  -- go test ./...\n\n# Step 3: Package\nwitness run --step package \\\n  --attestations material,product \\\n  -o package.json --key ci-key.pem \\\n  -- tar czf myapp.tar.gz myapp\n\n# Verify entire pipeline\nwitness verify \\\n  --policy policy-signed.json \\\n  --publickey policy-key.pub \\\n  -a build.json -a test.json -a package.json\n```\n"}]}
{"messages": [{"role": "system", "content": "You are an expert in the Witness supply chain attestation framework. You help users instrument CI/CD pipelines with witness, create policy documents, and write Rego policies to validate attestations. You understand all attestors in go-witness and how to use them effectively."}, {"role": "user", "content": "How do I create a witness policy for a build step that uses these attestors: commandrun?"}, {"role": "assistant", "content": "Here's a complete witness policy for your build step with commandrun attestors:\n\n**Policy Document:**\n```json\n{\n  \"expires\": \"2026-11-08T10:52:59Z\",\n  \"publickeys\": {\n    \"build-key\": {\n      \"keyid\": \"sha256:7b29ba873689dd9d030a67f30395abcb91eebcecf5fa54f7f76b2a47f0a352d6\",\n      \"key\": \"-----BEGIN PUBLIC KEY-----\\n...\\n-----END PUBLIC KEY-----\"\n    }\n  },\n  \"steps\": {\n    \"build\": {\n      \"name\": \"build\",\n      \"attestations\": [\n        {\n          \"type\": \"https://witness.dev/attestations/command-run/v0.1\"\n        }\n      ],\n      \"functionaries\": [\n        {\n          \"type\": \"publickey\",\n          \"publickeyid\": \"build-key\"\n        }\n      ]\n    }\n  }\n}\n```\n\n**Witness Run Command:**\n```bash\nwitness run --step build \\\n  --attestations commandrun \\\n  --outfile build-attestation.json \\\n  --key signing-key.pem \\\n  -- <your-build-command>\n```\n\n**Rego Validation Rules:**\n```rego\n\n```\n\n**Verification:**\n```bash\nwitness verify \\\n  --policy policy-signed.json \\\n  --publickey policy-key.pub \\\n  -a build-attestation.json \\\n  --subject <artifact>\n```\n"}]}
{"messages": [{"role": "system", "content": "You are an expert in the Witness supply chain attestation framework. You help users instrument CI/CD pipelines with witness, create policy documents, and write Rego policies to validate attestations. You understand all attestors in go-witness and how to use them effectively."}, {"role": "user", "content": "How do I create a multi-step witness policy for a build \u2192 test \u2192 package pipeline?"}, {"role": "assistant", "content": "Here's a complete multi-step witness policy for your pipeline:\n\n**Policy Document:**\n```json\n{\n  \"expires\": \"2026-11-08T10:52:59Z\",\n  \"publickeys\": {\n    \"ci-key\": {\n      \"keyid\": \"sha256:1513899efd1d4596b304f88ce1d34af1002ff45dbdc3ea842eab101f8f886d44\",\n      \"key\": \"-----BEGIN PUBLIC KEY-----\\n...\\n-----END PUBLIC KEY-----\"\n    }\n  },\n  \"steps\": {\n    \"build\": {\n      \"name\": \"build\",\n      \"attestations\": [\n        {\n          \"type\": \"https://witness.dev/attestations/git/v0.1\"\n        },\n        {\n          \"type\": \"https://witness.dev/attestations/command-run/v0.1\"\n        },\n        {\n          \"type\": \"https://witness.dev/attestations/product/v0.1\"\n        }\n      ],\n      \"functionaries\": [\n        {\n          \"type\": \"publickey\",\n          \"publickeyid\": \"ci-key\"\n        }\n      ]\n    },\n    \"test\": {\n      \"name\": \"test\",\n      \"attestations\": [\n        {\n          \"type\": \"https://witness.dev/attestations/material/v0.1\"\n        },\n        {\n          \"type\": \"https://witness.dev/attestations/command-run/v0.1\"\n        }\n      ],\n      \"functionaries\": [\n        {\n          \"type\": \"publickey\",\n          \"publickeyid\": \"ci-key\"\n        }\n      ]\n    },\n    \"package\": {\n      \"name\": \"package\",\n      \"attestations\": [\n        {\n          \"type\": \"https://witness.dev/attestations/material/v0.1\"\n        },\n        {\n          \"type\": \"https://witness.dev/attestations/product/v0.1\"\n        }\n      ],\n      \"functionaries\": [\n        {\n          \"type\": \"publickey\",\n          \"publickeyid\": \"ci-key\"\n        }\n      ]\n    }\n  }\n}\n```\n\n**Pipeline Commands:**\n\n```bash\n# Step 1: Build\nwitness run --step build \\\n  --attestations git,commandrun,product \\\n  -o build.json --key ci-key.pem \\\n  -- go build -o myapp\n\n# Step 2: Test\nwitness run --step test \\\n  --attestations material,commandrun \\\n  -o test.json --key ci-key.pem \\\n  -- go test ./...\n\n# Step 3: Package\nwitness run --step package \\\n  --attestations material,product \\\n  -o package.json --key ci-key.pem \\\n  -- tar czf myapp.tar.gz myapp\n\n# Verify entire pipeline\nwitness verify \\\n  --policy policy-signed.json \\\n  --publickey policy-key.pub \\\n  -a build.json -a test.json -a package.json\n```\n"}]}
{"messages": [{"role": "system", "content": "You are an expert in the Witness supply chain attestation framework. You help users instrument CI/CD pipelines with witness, create policy documents, and write Rego policies to validate attestations. You understand all attestors in go-witness and how to use them effectively."}, {"role": "user", "content": "How do I create a witness policy for a build step that uses these attestors: github, material, environment?"}, {"role": "assistant", "content": "Here's a complete witness policy for your build step with github, material, environment attestors:\n\n**Policy Document:**\n```json\n{\n  \"expires\": \"2026-11-08T10:52:59Z\",\n  \"publickeys\": {\n    \"build-key\": {\n      \"keyid\": \"sha256:a291a1b4a2ce3523155230b799d93ad6a110dac8da5e687575ae722c41f14197\",\n      \"key\": \"-----BEGIN PUBLIC KEY-----\\n...\\n-----END PUBLIC KEY-----\"\n    }\n  },\n  \"steps\": {\n    \"build\": {\n      \"name\": \"build\",\n      \"attestations\": [\n        {\n          \"type\": \"https://witness.dev/attestations/github/v0.1\"\n        },\n        {\n          \"type\": \"https://witness.dev/attestations/material/v0.1\"\n        },\n        {\n          \"type\": \"https://witness.dev/attestations/environment/v0.1\"\n        }\n      ],\n      \"functionaries\": [\n        {\n          \"type\": \"publickey\",\n          \"publickeyid\": \"build-key\"\n        }\n      ]\n    }\n  }\n}\n```\n\n**Witness Run Command:**\n```bash\nwitness run --step build \\\n  --attestations github,material,environment \\\n  --outfile build-attestation.json \\\n  --key signing-key.pem \\\n  -- <your-build-command>\n```\n\n**Rego Validation Rules:**\n```rego\n\n```\n\n**Verification:**\n```bash\nwitness verify \\\n  --policy policy-signed.json \\\n  --publickey policy-key.pub \\\n  -a build-attestation.json \\\n  --subject <artifact>\n```\n"}]}
{"messages": [{"role": "system", "content": "You are an expert in the Witness supply chain attestation framework. You help users instrument CI/CD pipelines with witness, create policy documents, and write Rego policies to validate attestations. You understand all attestors in go-witness and how to use them effectively."}, {"role": "user", "content": "How do I create a witness policy for a build step that uses these attestors: environment, product?"}, {"role": "assistant", "content": "Here's a complete witness policy for your build step with environment, product attestors:\n\n**Policy Document:**\n```json\n{\n  \"expires\": \"2026-11-08T10:52:59Z\",\n  \"publickeys\": {\n    \"build-key\": {\n      \"keyid\": \"sha256:28a905ee8d504ec301f66037da90cd53c690632a96bc4169ead4ff9c7b83cbe6\",\n      \"key\": \"-----BEGIN PUBLIC KEY-----\\n...\\n-----END PUBLIC KEY-----\"\n    }\n  },\n  \"steps\": {\n    \"build\": {\n      \"name\": \"build\",\n      \"attestations\": [\n        {\n          \"type\": \"https://witness.dev/attestations/environment/v0.1\"\n        },\n        {\n          \"type\": \"https://witness.dev/attestations/product/v0.1\"\n        }\n      ],\n      \"functionaries\": [\n        {\n          \"type\": \"publickey\",\n          \"publickeyid\": \"build-key\"\n        }\n      ]\n    }\n  }\n}\n```\n\n**Witness Run Command:**\n```bash\nwitness run --step build \\\n  --attestations environment,product \\\n  --outfile build-attestation.json \\\n  --key signing-key.pem \\\n  -- <your-build-command>\n```\n\n**Rego Validation Rules:**\n```rego\npackage environment\n\nimport rego.v1\n\n# Ensure correct OS\ndeny contains msg if {\n    input.os != \"darwin\"\n    msg := sprintf(\"Must run on darwin, got: %s\", [input.os])\n}\n\n# Require CI environment\ndeny contains msg if {\n    not \"CI\" in input.variables\n    msg := \"Must run in CI environment (CI variable not set)\"\n}\n```\n\n**Verification:**\n```bash\nwitness verify \\\n  --policy policy-signed.json \\\n  --publickey policy-key.pub \\\n  -a build-attestation.json \\\n  --subject <artifact>\n```\n"}]}
{"messages": [{"role": "system", "content": "You are an expert in the Witness supply chain attestation framework. You help users instrument CI/CD pipelines with witness, create policy documents, and write Rego policies to validate attestations. You understand all attestors in go-witness and how to use them effectively."}, {"role": "user", "content": "How do I create a multi-step witness policy for a build \u2192 test \u2192 package pipeline?"}, {"role": "assistant", "content": "Here's a complete multi-step witness policy for your pipeline:\n\n**Policy Document:**\n```json\n{\n  \"expires\": \"2026-11-08T10:52:59Z\",\n  \"publickeys\": {\n    \"ci-key\": {\n      \"keyid\": \"sha256:981e3f7bdbc4639f5a97ad209f679e3368050b501cb737123d17401642255976\",\n      \"key\": \"-----BEGIN PUBLIC KEY-----\\n...\\n-----END PUBLIC KEY-----\"\n    }\n  },\n  \"steps\": {\n    \"build\": {\n      \"name\": \"build\",\n      \"attestations\": [\n        {\n          \"type\": \"https://witness.dev/attestations/git/v0.1\"\n        },\n        {\n          \"type\": \"https://witness.dev/attestations/command-run/v0.1\"\n        },\n        {\n          \"type\": \"https://witness.dev/attestations/product/v0.1\"\n        }\n      ],\n      \"functionaries\": [\n        {\n          \"type\": \"publickey\",\n          \"publickeyid\": \"ci-key\"\n        }\n      ]\n    },\n    \"test\": {\n      \"name\": \"test\",\n      \"attestations\": [\n        {\n          \"type\": \"https://witness.dev/attestations/material/v0.1\"\n        },\n        {\n          \"type\": \"https://witness.dev/attestations/command-run/v0.1\"\n        }\n      ],\n      \"functionaries\": [\n        {\n          \"type\": \"publickey\",\n          \"publickeyid\": \"ci-key\"\n        }\n      ]\n    },\n    \"package\": {\n      \"name\": \"package\",\n      \"attestations\": [\n        {\n          \"type\": \"https://witness.dev/attestations/material/v0.1\"\n        },\n        {\n          \"type\": \"https://witness.dev/attestations/product/v0.1\"\n        }\n      ],\n      \"functionaries\": [\n        {\n          \"type\": \"publickey\",\n          \"publickeyid\": \"ci-key\"\n        }\n      ]\n    }\n  }\n}\n```\n\n**Pipeline Commands:**\n\n```bash\n# Step 1: Build\nwitness run --step build \\\n  --attestations git,commandrun,product \\\n  -o build.json --key ci-key.pem \\\n  -- go build -o myapp\n\n# Step 2: Test\nwitness run --step test \\\n  --attestations material,commandrun \\\n  -o test.json --key ci-key.pem \\\n  -- go test ./...\n\n# Step 3: Package\nwitness run --step package \\\n  --attestations material,product \\\n  -o package.json --key ci-key.pem \\\n  -- tar czf myapp.tar.gz myapp\n\n# Verify entire pipeline\nwitness verify \\\n  --policy policy-signed.json \\\n  --publickey policy-key.pub \\\n  -a build.json -a test.json -a package.json\n```\n"}]}
{"messages": [{"role": "system", "content": "You are an expert in the Witness supply chain attestation framework. You help users instrument CI/CD pipelines with witness, create policy documents, and write Rego policies to validate attestations. You understand all attestors in go-witness and how to use them effectively."}, {"role": "user", "content": "How do I create a witness policy for a build step that uses these attestors: git, environment, material?"}, {"role": "assistant", "content": "Here's a complete witness policy for your build step with git, environment, material attestors:\n\n**Policy Document:**\n```json\n{\n  \"expires\": \"2026-11-08T10:52:59Z\",\n  \"publickeys\": {\n    \"build-key\": {\n      \"keyid\": \"sha256:457f8c687441cf8d7e759434a9c778af151b671908abfaea5bbd4b459c28a5db\",\n      \"key\": \"-----BEGIN PUBLIC KEY-----\\n...\\n-----END PUBLIC KEY-----\"\n    }\n  },\n  \"steps\": {\n    \"build\": {\n      \"name\": \"build\",\n      \"attestations\": [\n        {\n          \"type\": \"https://witness.dev/attestations/git/v0.1\"\n        },\n        {\n          \"type\": \"https://witness.dev/attestations/environment/v0.1\"\n        },\n        {\n          \"type\": \"https://witness.dev/attestations/material/v0.1\"\n        }\n      ],\n      \"functionaries\": [\n        {\n          \"type\": \"publickey\",\n          \"publickeyid\": \"build-key\"\n        }\n      ]\n    }\n  }\n}\n```\n\n**Witness Run Command:**\n```bash\nwitness run --step build \\\n  --attestations git,environment,material \\\n  --outfile build-attestation.json \\\n  --key signing-key.pem \\\n  -- <your-build-command>\n```\n\n**Rego Validation Rules:**\n```rego\npackage git\n\nimport rego.v1\n\n# Enforce builds from specific branch\ndeny contains msg if {\n    input.branch != \"feature/auth\"\n    msg := sprintf(\"Must build from feature/auth branch, got: %s\", [input.branch])\n}\n\n# Require clean working directory\ndeny contains msg if {\n    count(input.status) > 0\n    msg := \"Working directory must be clean (no uncommitted changes)\"\n}\n\n# Validate commit author\napproved_authors := {\n    \"alice.smith@example.com\",\n    \"bob.jones@company.com\",\n    \"ci-bot@company.com\"\n}\n\ndeny contains msg if {\n    not input.authoremail in approved_authors\n    msg := sprintf(\"Unauthorized commit author: %s\", [input.authoremail])\n}\n```\n\n**Verification:**\n```bash\nwitness verify \\\n  --policy policy-signed.json \\\n  --publickey policy-key.pub \\\n  -a build-attestation.json \\\n  --subject <artifact>\n```\n"}]}
{"messages": [{"role": "system", "content": "You are an expert in the Witness supply chain attestation framework. You help users instrument CI/CD pipelines with witness, create policy documents, and write Rego policies to validate attestations. You understand all attestors in go-witness and how to use them effectively."}, {"role": "user", "content": "How do I create a witness policy for a build step that uses these attestors: git, material, commandrun, product?"}, {"role": "assistant", "content": "Here's a complete witness policy for your build step with git, material, commandrun, product attestors:\n\n**Policy Document:**\n```json\n{\n  \"expires\": \"2026-11-08T10:52:59Z\",\n  \"publickeys\": {\n    \"build-key\": {\n      \"keyid\": \"sha256:3f7cd7026b9c37f4ad6ddc2a4475f17c6e7cb7518398fe0dc656bcf534e39ba6\",\n      \"key\": \"-----BEGIN PUBLIC KEY-----\\n...\\n-----END PUBLIC KEY-----\"\n    }\n  },\n  \"steps\": {\n    \"build\": {\n      \"name\": \"build\",\n      \"attestations\": [\n        {\n          \"type\": \"https://witness.dev/attestations/git/v0.1\"\n        },\n        {\n          \"type\": \"https://witness.dev/attestations/material/v0.1\"\n        },\n        {\n          \"type\": \"https://witness.dev/attestations/command-run/v0.1\"\n        },\n        {\n          \"type\": \"https://witness.dev/attestations/product/v0.1\"\n        }\n      ],\n      \"functionaries\": [\n        {\n          \"type\": \"publickey\",\n          \"publickeyid\": \"build-key\"\n        }\n      ]\n    }\n  }\n}\n```\n\n**Witness Run Command:**\n```bash\nwitness run --step build \\\n  --attestations git,material,commandrun,product \\\n  --outfile build-attestation.json \\\n  --key signing-key.pem \\\n  -- <your-build-command>\n```\n\n**Rego Validation Rules:**\n```rego\npackage git\n\nimport rego.v1\n\n# Enforce builds from specific branch\ndeny contains msg if {\n    input.branch != \"release/v1.0\"\n    msg := sprintf(\"Must build from release/v1.0 branch, got: %s\", [input.branch])\n}\n\n# Validate commit author\napproved_authors := {\n    \"alice.smith@example.com\",\n    \"bob.jones@company.com\",\n    \"ci-bot@company.com\"\n}\n\ndeny contains msg if {\n    not input.authoremail in approved_authors\n    msg := sprintf(\"Unauthorized commit author: %s\", [input.authoremail])\n}\n```\n\n**Verification:**\n```bash\nwitness verify \\\n  --policy policy-signed.json \\\n  --publickey policy-key.pub \\\n  -a build-attestation.json \\\n  --subject <artifact>\n```\n"}]}
{"messages": [{"role": "system", "content": "You are an expert in the Witness supply chain attestation framework. You help users instrument CI/CD pipelines with witness, create policy documents, and write Rego policies to validate attestations. You understand all attestors in go-witness and how to use them effectively."}, {"role": "user", "content": "How do I create a witness policy for a build step that uses these attestors: github, environment?"}, {"role": "assistant", "content": "Here's a complete witness policy for your build step with github, environment attestors:\n\n**Policy Document:**\n```json\n{\n  \"expires\": \"2026-11-08T10:52:59Z\",\n  \"publickeys\": {\n    \"build-key\": {\n      \"keyid\": \"sha256:a4487402d4ef6c8f8a4af417a664b2225e20ff0e7454796ff840d08af5a3e1bc\",\n      \"key\": \"-----BEGIN PUBLIC KEY-----\\n...\\n-----END PUBLIC KEY-----\"\n    }\n  },\n  \"steps\": {\n    \"build\": {\n      \"name\": \"build\",\n      \"attestations\": [\n        {\n          \"type\": \"https://witness.dev/attestations/github/v0.1\"\n        },\n        {\n          \"type\": \"https://witness.dev/attestations/environment/v0.1\"\n        }\n      ],\n      \"functionaries\": [\n        {\n          \"type\": \"publickey\",\n          \"publickeyid\": \"build-key\"\n        }\n      ]\n    }\n  }\n}\n```\n\n**Witness Run Command:**\n```bash\nwitness run --step build \\\n  --attestations github,environment \\\n  --outfile build-attestation.json \\\n  --key signing-key.pem \\\n  -- <your-build-command>\n```\n\n**Rego Validation Rules:**\n```rego\n\n```\n\n**Verification:**\n```bash\nwitness verify \\\n  --policy policy-signed.json \\\n  --publickey policy-key.pub \\\n  -a build-attestation.json \\\n  --subject <artifact>\n```\n"}]}
{"messages": [{"role": "system", "content": "You are an expert in the Witness supply chain attestation framework. You help users instrument CI/CD pipelines with witness, create policy documents, and write Rego policies to validate attestations. You understand all attestors in go-witness and how to use them effectively."}, {"role": "user", "content": "How do I create a witness policy for a build step that uses these attestors: environment?"}, {"role": "assistant", "content": "Here's a complete witness policy for your build step with environment attestors:\n\n**Policy Document:**\n```json\n{\n  \"expires\": \"2026-11-08T10:52:59Z\",\n  \"publickeys\": {\n    \"build-key\": {\n      \"keyid\": \"sha256:a5b76aad26fc563148eda3931f29eec039abfb5196f37a58a2b7cf690717ff55\",\n      \"key\": \"-----BEGIN PUBLIC KEY-----\\n...\\n-----END PUBLIC KEY-----\"\n    }\n  },\n  \"steps\": {\n    \"build\": {\n      \"name\": \"build\",\n      \"attestations\": [\n        {\n          \"type\": \"https://witness.dev/attestations/environment/v0.1\"\n        }\n      ],\n      \"functionaries\": [\n        {\n          \"type\": \"publickey\",\n          \"publickeyid\": \"build-key\"\n        }\n      ]\n    }\n  }\n}\n```\n\n**Witness Run Command:**\n```bash\nwitness run --step build \\\n  --attestations environment \\\n  --outfile build-attestation.json \\\n  --key signing-key.pem \\\n  -- <your-build-command>\n```\n\n**Rego Validation Rules:**\n```rego\npackage environment\n\nimport rego.v1\n\n# Ensure correct OS\ndeny contains msg if {\n    input.os != \"linux\"\n    msg := sprintf(\"Must run on linux, got: %s\", [input.os])\n}\n\n# Require CI environment\ndeny contains msg if {\n    not \"CI\" in input.variables\n    msg := \"Must run in CI environment (CI variable not set)\"\n}\n```\n\n**Verification:**\n```bash\nwitness verify \\\n  --policy policy-signed.json \\\n  --publickey policy-key.pub \\\n  -a build-attestation.json \\\n  --subject <artifact>\n```\n"}]}
{"messages": [{"role": "system", "content": "You are an expert in the Witness supply chain attestation framework. You help users instrument CI/CD pipelines with witness, create policy documents, and write Rego policies to validate attestations. You understand all attestors in go-witness and how to use them effectively."}, {"role": "user", "content": "How do I create a multi-step witness policy for a build \u2192 test \u2192 package pipeline?"}, {"role": "assistant", "content": "Here's a complete multi-step witness policy for your pipeline:\n\n**Policy Document:**\n```json\n{\n  \"expires\": \"2026-11-08T10:52:59Z\",\n  \"publickeys\": {\n    \"ci-key\": {\n      \"keyid\": \"sha256:efd6dc0d834151150ce3a8c2b45561c1f043dae31e8a08571739341a0f2fb7ca\",\n      \"key\": \"-----BEGIN PUBLIC KEY-----\\n...\\n-----END PUBLIC KEY-----\"\n    }\n  },\n  \"steps\": {\n    \"build\": {\n      \"name\": \"build\",\n      \"attestations\": [\n        {\n          \"type\": \"https://witness.dev/attestations/git/v0.1\"\n        },\n        {\n          \"type\": \"https://witness.dev/attestations/command-run/v0.1\"\n        },\n        {\n          \"type\": \"https://witness.dev/attestations/product/v0.1\"\n        }\n      ],\n      \"functionaries\": [\n        {\n          \"type\": \"publickey\",\n          \"publickeyid\": \"ci-key\"\n        }\n      ]\n    },\n    \"test\": {\n      \"name\": \"test\",\n      \"attestations\": [\n        {\n          \"type\": \"https://witness.dev/attestations/material/v0.1\"\n        },\n        {\n          \"type\": \"https://witness.dev/attestations/command-run/v0.1\"\n        }\n      ],\n      \"functionaries\": [\n        {\n          \"type\": \"publickey\",\n          \"publickeyid\": \"ci-key\"\n        }\n      ]\n    },\n    \"package\": {\n      \"name\": \"package\",\n      \"attestations\": [\n        {\n          \"type\": \"https://witness.dev/attestations/material/v0.1\"\n        },\n        {\n          \"type\": \"https://witness.dev/attestations/product/v0.1\"\n        }\n      ],\n      \"functionaries\": [\n        {\n          \"type\": \"publickey\",\n          \"publickeyid\": \"ci-key\"\n        }\n      ]\n    }\n  }\n}\n```\n\n**Pipeline Commands:**\n\n```bash\n# Step 1: Build\nwitness run --step build \\\n  --attestations git,commandrun,product \\\n  -o build.json --key ci-key.pem \\\n  -- go build -o myapp\n\n# Step 2: Test\nwitness run --step test \\\n  --attestations material,commandrun \\\n  -o test.json --key ci-key.pem \\\n  -- go test ./...\n\n# Step 3: Package\nwitness run --step package \\\n  --attestations material,product \\\n  -o package.json --key ci-key.pem \\\n  -- tar czf myapp.tar.gz myapp\n\n# Verify entire pipeline\nwitness verify \\\n  --policy policy-signed.json \\\n  --publickey policy-key.pub \\\n  -a build.json -a test.json -a package.json\n```\n"}]}
{"messages": [{"role": "system", "content": "You are an expert in the Witness supply chain attestation framework. You help users instrument CI/CD pipelines with witness, create policy documents, and write Rego policies to validate attestations. You understand all attestors in go-witness and how to use them effectively."}, {"role": "user", "content": "How do I create a witness policy for a build step that uses these attestors: product, github?"}, {"role": "assistant", "content": "Here's a complete witness policy for your build step with product, github attestors:\n\n**Policy Document:**\n```json\n{\n  \"expires\": \"2026-11-08T10:52:59Z\",\n  \"publickeys\": {\n    \"build-key\": {\n      \"keyid\": \"sha256:574246cb44f6f56e4d8c59646d5cdad758bf0e1828dfcbc660376b9736baa3f2\",\n      \"key\": \"-----BEGIN PUBLIC KEY-----\\n...\\n-----END PUBLIC KEY-----\"\n    }\n  },\n  \"steps\": {\n    \"build\": {\n      \"name\": \"build\",\n      \"attestations\": [\n        {\n          \"type\": \"https://witness.dev/attestations/product/v0.1\"\n        },\n        {\n          \"type\": \"https://witness.dev/attestations/github/v0.1\"\n        }\n      ],\n      \"functionaries\": [\n        {\n          \"type\": \"publickey\",\n          \"publickeyid\": \"build-key\"\n        }\n      ]\n    }\n  }\n}\n```\n\n**Witness Run Command:**\n```bash\nwitness run --step build \\\n  --attestations product,github \\\n  --outfile build-attestation.json \\\n  --key signing-key.pem \\\n  -- <your-build-command>\n```\n\n**Rego Validation Rules:**\n```rego\n\n```\n\n**Verification:**\n```bash\nwitness verify \\\n  --policy policy-signed.json \\\n  --publickey policy-key.pub \\\n  -a build-attestation.json \\\n  --subject <artifact>\n```\n"}]}
{"messages": [{"role": "system", "content": "You are an expert in the Witness supply chain attestation framework. You help users instrument CI/CD pipelines with witness, create policy documents, and write Rego policies to validate attestations. You understand all attestors in go-witness and how to use them effectively."}, {"role": "user", "content": "How do I create a witness policy for a build step that uses these attestors: commandrun, product?"}, {"role": "assistant", "content": "Here's a complete witness policy for your build step with commandrun, product attestors:\n\n**Policy Document:**\n```json\n{\n  \"expires\": \"2026-11-08T10:52:59Z\",\n  \"publickeys\": {\n    \"build-key\": {\n      \"keyid\": \"sha256:382edcc24f7ea9a5fb907128da6fd5c5ce12eec63b089fd768429a75e58c58de\",\n      \"key\": \"-----BEGIN PUBLIC KEY-----\\n...\\n-----END PUBLIC KEY-----\"\n    }\n  },\n  \"steps\": {\n    \"build\": {\n      \"name\": \"build\",\n      \"attestations\": [\n        {\n          \"type\": \"https://witness.dev/attestations/command-run/v0.1\"\n        },\n        {\n          \"type\": \"https://witness.dev/attestations/product/v0.1\"\n        }\n      ],\n      \"functionaries\": [\n        {\n          \"type\": \"publickey\",\n          \"publickeyid\": \"build-key\"\n        }\n      ]\n    }\n  }\n}\n```\n\n**Witness Run Command:**\n```bash\nwitness run --step build \\\n  --attestations commandrun,product \\\n  --outfile build-attestation.json \\\n  --key signing-key.pem \\\n  -- <your-build-command>\n```\n\n**Rego Validation Rules:**\n```rego\n\n```\n\n**Verification:**\n```bash\nwitness verify \\\n  --policy policy-signed.json \\\n  --publickey policy-key.pub \\\n  -a build-attestation.json \\\n  --subject <artifact>\n```\n"}]}
{"messages": [{"role": "system", "content": "You are an expert in the Witness supply chain attestation framework. You help users instrument CI/CD pipelines with witness, create policy documents, and write Rego policies to validate attestations. You understand all attestors in go-witness and how to use them effectively."}, {"role": "user", "content": "How do I create a witness policy for a build step that uses these attestors: product, commandrun, material?"}, {"role": "assistant", "content": "Here's a complete witness policy for your build step with product, commandrun, material attestors:\n\n**Policy Document:**\n```json\n{\n  \"expires\": \"2026-11-08T10:52:59Z\",\n  \"publickeys\": {\n    \"build-key\": {\n      \"keyid\": \"sha256:4349453cee96be2b9ca6040f2cf39b16af8919331442cb7906bd5184b5c9ca29\",\n      \"key\": \"-----BEGIN PUBLIC KEY-----\\n...\\n-----END PUBLIC KEY-----\"\n    }\n  },\n  \"steps\": {\n    \"build\": {\n      \"name\": \"build\",\n      \"attestations\": [\n        {\n          \"type\": \"https://witness.dev/attestations/product/v0.1\"\n        },\n        {\n          \"type\": \"https://witness.dev/attestations/command-run/v0.1\"\n        },\n        {\n          \"type\": \"https://witness.dev/attestations/material/v0.1\"\n        }\n      ],\n      \"functionaries\": [\n        {\n          \"type\": \"publickey\",\n          \"publickeyid\": \"build-key\"\n        }\n      ]\n    }\n  }\n}\n```\n\n**Witness Run Command:**\n```bash\nwitness run --step build \\\n  --attestations product,commandrun,material \\\n  --outfile build-attestation.json \\\n  --key signing-key.pem \\\n  -- <your-build-command>\n```\n\n**Rego Validation Rules:**\n```rego\n\n```\n\n**Verification:**\n```bash\nwitness verify \\\n  --policy policy-signed.json \\\n  --publickey policy-key.pub \\\n  -a build-attestation.json \\\n  --subject <artifact>\n```\n"}]}
{"messages": [{"role": "system", "content": "You are an expert in the Witness supply chain attestation framework. You help users instrument CI/CD pipelines with witness, create policy documents, and write Rego policies to validate attestations. You understand all attestors in go-witness and how to use them effectively."}, {"role": "user", "content": "How do I create a multi-step witness policy for a build \u2192 test \u2192 package pipeline?"}, {"role": "assistant", "content": "Here's a complete multi-step witness policy for your pipeline:\n\n**Policy Document:**\n```json\n{\n  \"expires\": \"2026-11-08T10:52:59Z\",\n  \"publickeys\": {\n    \"ci-key\": {\n      \"keyid\": \"sha256:fc10ffa6762c2f453374d1da8c7bf77bd7e1966bb8b9d87c6e2f4806b96e11d2\",\n      \"key\": \"-----BEGIN PUBLIC KEY-----\\n...\\n-----END PUBLIC KEY-----\"\n    }\n  },\n  \"steps\": {\n    \"build\": {\n      \"name\": \"build\",\n      \"attestations\": [\n        {\n          \"type\": \"https://witness.dev/attestations/git/v0.1\"\n        },\n        {\n          \"type\": \"https://witness.dev/attestations/command-run/v0.1\"\n        },\n        {\n          \"type\": \"https://witness.dev/attestations/product/v0.1\"\n        }\n      ],\n      \"functionaries\": [\n        {\n          \"type\": \"publickey\",\n          \"publickeyid\": \"ci-key\"\n        }\n      ]\n    },\n    \"test\": {\n      \"name\": \"test\",\n      \"attestations\": [\n        {\n          \"type\": \"https://witness.dev/attestations/material/v0.1\"\n        },\n        {\n          \"type\": \"https://witness.dev/attestations/command-run/v0.1\"\n        }\n      ],\n      \"functionaries\": [\n        {\n          \"type\": \"publickey\",\n          \"publickeyid\": \"ci-key\"\n        }\n      ]\n    },\n    \"package\": {\n      \"name\": \"package\",\n      \"attestations\": [\n        {\n          \"type\": \"https://witness.dev/attestations/material/v0.1\"\n        },\n        {\n          \"type\": \"https://witness.dev/attestations/product/v0.1\"\n        }\n      ],\n      \"functionaries\": [\n        {\n          \"type\": \"publickey\",\n          \"publickeyid\": \"ci-key\"\n        }\n      ]\n    }\n  }\n}\n```\n\n**Pipeline Commands:**\n\n```bash\n# Step 1: Build\nwitness run --step build \\\n  --attestations git,commandrun,product \\\n  -o build.json --key ci-key.pem \\\n  -- go build -o myapp\n\n# Step 2: Test\nwitness run --step test \\\n  --attestations material,commandrun \\\n  -o test.json --key ci-key.pem \\\n  -- go test ./...\n\n# Step 3: Package\nwitness run --step package \\\n  --attestations material,product \\\n  -o package.json --key ci-key.pem \\\n  -- tar czf myapp.tar.gz myapp\n\n# Verify entire pipeline\nwitness verify \\\n  --policy policy-signed.json \\\n  --publickey policy-key.pub \\\n  -a build.json -a test.json -a package.json\n```\n"}]}
{"messages": [{"role": "system", "content": "You are an expert in the Witness supply chain attestation framework. You help users instrument CI/CD pipelines with witness, create policy documents, and write Rego policies to validate attestations. You understand all attestors in go-witness and how to use them effectively."}, {"role": "user", "content": "How do I create a multi-step witness policy for a build \u2192 test \u2192 package pipeline?"}, {"role": "assistant", "content": "Here's a complete multi-step witness policy for your pipeline:\n\n**Policy Document:**\n```json\n{\n  \"expires\": \"2026-11-08T10:52:59Z\",\n  \"publickeys\": {\n    \"ci-key\": {\n      \"keyid\": \"sha256:24ff793d41846565c1226dbef13c6f98608381186c65976153e144dc66eeaa62\",\n      \"key\": \"-----BEGIN PUBLIC KEY-----\\n...\\n-----END PUBLIC KEY-----\"\n    }\n  },\n  \"steps\": {\n    \"build\": {\n      \"name\": \"build\",\n      \"attestations\": [\n        {\n          \"type\": \"https://witness.dev/attestations/git/v0.1\"\n        },\n        {\n          \"type\": \"https://witness.dev/attestations/command-run/v0.1\"\n        },\n        {\n          \"type\": \"https://witness.dev/attestations/product/v0.1\"\n        }\n      ],\n      \"functionaries\": [\n        {\n          \"type\": \"publickey\",\n          \"publickeyid\": \"ci-key\"\n        }\n      ]\n    },\n    \"test\": {\n      \"name\": \"test\",\n      \"attestations\": [\n        {\n          \"type\": \"https://witness.dev/attestations/material/v0.1\"\n        },\n        {\n          \"type\": \"https://witness.dev/attestations/command-run/v0.1\"\n        }\n      ],\n      \"functionaries\": [\n        {\n          \"type\": \"publickey\",\n          \"publickeyid\": \"ci-key\"\n        }\n      ]\n    },\n    \"package\": {\n      \"name\": \"package\",\n      \"attestations\": [\n        {\n          \"type\": \"https://witness.dev/attestations/material/v0.1\"\n        },\n        {\n          \"type\": \"https://witness.dev/attestations/product/v0.1\"\n        }\n      ],\n      \"functionaries\": [\n        {\n          \"type\": \"publickey\",\n          \"publickeyid\": \"ci-key\"\n        }\n      ]\n    }\n  }\n}\n```\n\n**Pipeline Commands:**\n\n```bash\n# Step 1: Build\nwitness run --step build \\\n  --attestations git,commandrun,product \\\n  -o build.json --key ci-key.pem \\\n  -- go build -o myapp\n\n# Step 2: Test\nwitness run --step test \\\n  --attestations material,commandrun \\\n  -o test.json --key ci-key.pem \\\n  -- go test ./...\n\n# Step 3: Package\nwitness run --step package \\\n  --attestations material,product \\\n  -o package.json --key ci-key.pem \\\n  -- tar czf myapp.tar.gz myapp\n\n# Verify entire pipeline\nwitness verify \\\n  --policy policy-signed.json \\\n  --publickey policy-key.pub \\\n  -a build.json -a test.json -a package.json\n```\n"}]}
{"messages": [{"role": "system", "content": "You are an expert in the Witness supply chain attestation framework. You help users instrument CI/CD pipelines with witness, create policy documents, and write Rego policies to validate attestations. You understand all attestors in go-witness and how to use them effectively."}, {"role": "user", "content": "How do I create a witness policy for a build step that uses these attestors: environment, github, material?"}, {"role": "assistant", "content": "Here's a complete witness policy for your build step with environment, github, material attestors:\n\n**Policy Document:**\n```json\n{\n  \"expires\": \"2026-11-08T10:52:59Z\",\n  \"publickeys\": {\n    \"build-key\": {\n      \"keyid\": \"sha256:9b9747502a3a2428fe609cd1d8bcb157fd0f3fb582810f954563e116039f82a4\",\n      \"key\": \"-----BEGIN PUBLIC KEY-----\\n...\\n-----END PUBLIC KEY-----\"\n    }\n  },\n  \"steps\": {\n    \"build\": {\n      \"name\": \"build\",\n      \"attestations\": [\n        {\n          \"type\": \"https://witness.dev/attestations/environment/v0.1\"\n        },\n        {\n          \"type\": \"https://witness.dev/attestations/github/v0.1\"\n        },\n        {\n          \"type\": \"https://witness.dev/attestations/material/v0.1\"\n        }\n      ],\n      \"functionaries\": [\n        {\n          \"type\": \"publickey\",\n          \"publickeyid\": \"build-key\"\n        }\n      ]\n    }\n  }\n}\n```\n\n**Witness Run Command:**\n```bash\nwitness run --step build \\\n  --attestations environment,github,material \\\n  --outfile build-attestation.json \\\n  --key signing-key.pem \\\n  -- <your-build-command>\n```\n\n**Rego Validation Rules:**\n```rego\npackage environment\n\nimport rego.v1\n\n# Ensure correct OS\ndeny contains msg if {\n    input.os != \"darwin\"\n    msg := sprintf(\"Must run on darwin, got: %s\", [input.os])\n}\n\n# Require CI environment\ndeny contains msg if {\n    not \"CI\" in input.variables\n    msg := \"Must run in CI environment (CI variable not set)\"\n}\n```\n\n**Verification:**\n```bash\nwitness verify \\\n  --policy policy-signed.json \\\n  --publickey policy-key.pub \\\n  -a build-attestation.json \\\n  --subject <artifact>\n```\n"}]}
{"messages": [{"role": "system", "content": "You are an expert in the Witness supply chain attestation framework. You help users instrument CI/CD pipelines with witness, create policy documents, and write Rego policies to validate attestations. You understand all attestors in go-witness and how to use them effectively."}, {"role": "user", "content": "How do I create a witness policy for a build step that uses these attestors: git?"}, {"role": "assistant", "content": "Here's a complete witness policy for your build step with git attestors:\n\n**Policy Document:**\n```json\n{\n  \"expires\": \"2026-11-08T10:52:59Z\",\n  \"publickeys\": {\n    \"build-key\": {\n      \"keyid\": \"sha256:c0a95d23367395fffdc8fe3c785f32c4ed24b0feac0db2a81539a26dd3f8363d\",\n      \"key\": \"-----BEGIN PUBLIC KEY-----\\n...\\n-----END PUBLIC KEY-----\"\n    }\n  },\n  \"steps\": {\n    \"build\": {\n      \"name\": \"build\",\n      \"attestations\": [\n        {\n          \"type\": \"https://witness.dev/attestations/git/v0.1\"\n        }\n      ],\n      \"functionaries\": [\n        {\n          \"type\": \"publickey\",\n          \"publickeyid\": \"build-key\"\n        }\n      ]\n    }\n  }\n}\n```\n\n**Witness Run Command:**\n```bash\nwitness run --step build \\\n  --attestations git \\\n  --outfile build-attestation.json \\\n  --key signing-key.pem \\\n  -- <your-build-command>\n```\n\n**Rego Validation Rules:**\n```rego\npackage git\n\nimport rego.v1\n\n# Enforce builds from specific branch\ndeny contains msg if {\n    input.branch != \"develop\"\n    msg := sprintf(\"Must build from develop branch, got: %s\", [input.branch])\n}\n\n# Require clean working directory\ndeny contains msg if {\n    count(input.status) > 0\n    msg := \"Working directory must be clean (no uncommitted changes)\"\n}\n\n# Validate commit author\napproved_authors := {\n    \"alice.smith@example.com\",\n    \"bob.jones@company.com\",\n    \"ci-bot@company.com\"\n}\n\ndeny contains msg if {\n    not input.authoremail in approved_authors\n    msg := sprintf(\"Unauthorized commit author: %s\", [input.authoremail])\n}\n```\n\n**Verification:**\n```bash\nwitness verify \\\n  --policy policy-signed.json \\\n  --publickey policy-key.pub \\\n  -a build-attestation.json \\\n  --subject <artifact>\n```\n"}]}
{"messages": [{"role": "system", "content": "You are an expert in the Witness supply chain attestation framework. You help users instrument CI/CD pipelines with witness, create policy documents, and write Rego policies to validate attestations. You understand all attestors in go-witness and how to use them effectively."}, {"role": "user", "content": "How do I create a witness policy for a build step that uses these attestors: commandrun, git, github, material?"}, {"role": "assistant", "content": "Here's a complete witness policy for your build step with commandrun, git, github, material attestors:\n\n**Policy Document:**\n```json\n{\n  \"expires\": \"2026-11-08T10:52:59Z\",\n  \"publickeys\": {\n    \"build-key\": {\n      \"keyid\": \"sha256:23c6bdd4da6ca468a2aa3092afcd35506b4ffd5ebf6e6f1254e38a6064331dff\",\n      \"key\": \"-----BEGIN PUBLIC KEY-----\\n...\\n-----END PUBLIC KEY-----\"\n    }\n  },\n  \"steps\": {\n    \"build\": {\n      \"name\": \"build\",\n      \"attestations\": [\n        {\n          \"type\": \"https://witness.dev/attestations/command-run/v0.1\"\n        },\n        {\n          \"type\": \"https://witness.dev/attestations/git/v0.1\"\n        },\n        {\n          \"type\": \"https://witness.dev/attestations/github/v0.1\"\n        },\n        {\n          \"type\": \"https://witness.dev/attestations/material/v0.1\"\n        }\n      ],\n      \"functionaries\": [\n        {\n          \"type\": \"publickey\",\n          \"publickeyid\": \"build-key\"\n        }\n      ]\n    }\n  }\n}\n```\n\n**Witness Run Command:**\n```bash\nwitness run --step build \\\n  --attestations commandrun,git,github,material \\\n  --outfile build-attestation.json \\\n  --key signing-key.pem \\\n  -- <your-build-command>\n```\n\n**Rego Validation Rules:**\n```rego\n\n```\n\n**Verification:**\n```bash\nwitness verify \\\n  --policy policy-signed.json \\\n  --publickey policy-key.pub \\\n  -a build-attestation.json \\\n  --subject <artifact>\n```\n"}]}
{"messages": [{"role": "system", "content": "You are an expert in the Witness supply chain attestation framework. You help users instrument CI/CD pipelines with witness, create policy documents, and write Rego policies to validate attestations. You understand all attestors in go-witness and how to use them effectively."}, {"role": "user", "content": "How do I create a witness policy for a build step that uses these attestors: git, material, github, commandrun?"}, {"role": "assistant", "content": "Here's a complete witness policy for your build step with git, material, github, commandrun attestors:\n\n**Policy Document:**\n```json\n{\n  \"expires\": \"2026-11-08T10:52:59Z\",\n  \"publickeys\": {\n    \"build-key\": {\n      \"keyid\": \"sha256:4bd5ef1acbb913067d66cf1a2b80914e548da694c44eb9600f4909208c9b4b8f\",\n      \"key\": \"-----BEGIN PUBLIC KEY-----\\n...\\n-----END PUBLIC KEY-----\"\n    }\n  },\n  \"steps\": {\n    \"build\": {\n      \"name\": \"build\",\n      \"attestations\": [\n        {\n          \"type\": \"https://witness.dev/attestations/git/v0.1\"\n        },\n        {\n          \"type\": \"https://witness.dev/attestations/material/v0.1\"\n        },\n        {\n          \"type\": \"https://witness.dev/attestations/github/v0.1\"\n        },\n        {\n          \"type\": \"https://witness.dev/attestations/command-run/v0.1\"\n        }\n      ],\n      \"functionaries\": [\n        {\n          \"type\": \"publickey\",\n          \"publickeyid\": \"build-key\"\n        }\n      ]\n    }\n  }\n}\n```\n\n**Witness Run Command:**\n```bash\nwitness run --step build \\\n  --attestations git,material,github,commandrun \\\n  --outfile build-attestation.json \\\n  --key signing-key.pem \\\n  -- <your-build-command>\n```\n\n**Rego Validation Rules:**\n```rego\npackage git\n\nimport rego.v1\n\n# Enforce builds from specific branch\ndeny contains msg if {\n    input.branch != \"develop\"\n    msg := sprintf(\"Must build from develop branch, got: %s\", [input.branch])\n}\n\n# Require clean working directory\ndeny contains msg if {\n    count(input.status) > 0\n    msg := \"Working directory must be clean (no uncommitted changes)\"\n}\n\n# Validate commit author\napproved_authors := {\n    \"alice.smith@example.com\",\n    \"bob.jones@company.com\",\n    \"ci-bot@company.com\"\n}\n\ndeny contains msg if {\n    not input.authoremail in approved_authors\n    msg := sprintf(\"Unauthorized commit author: %s\", [input.authoremail])\n}\n```\n\n**Verification:**\n```bash\nwitness verify \\\n  --policy policy-signed.json \\\n  --publickey policy-key.pub \\\n  -a build-attestation.json \\\n  --subject <artifact>\n```\n"}]}
{"messages": [{"role": "system", "content": "You are an expert in the Witness supply chain attestation framework. You help users instrument CI/CD pipelines with witness, create policy documents, and write Rego policies to validate attestations. You understand all attestors in go-witness and how to use them effectively."}, {"role": "user", "content": "How do I create a witness policy for a build step that uses these attestors: github, commandrun, material, product?"}, {"role": "assistant", "content": "Here's a complete witness policy for your build step with github, commandrun, material, product attestors:\n\n**Policy Document:**\n```json\n{\n  \"expires\": \"2026-11-08T10:52:59Z\",\n  \"publickeys\": {\n    \"build-key\": {\n      \"keyid\": \"sha256:5967b937b3809a7c55ff29009e18a42721fb20260527257f6d1464c8fad07e64\",\n      \"key\": \"-----BEGIN PUBLIC KEY-----\\n...\\n-----END PUBLIC KEY-----\"\n    }\n  },\n  \"steps\": {\n    \"build\": {\n      \"name\": \"build\",\n      \"attestations\": [\n        {\n          \"type\": \"https://witness.dev/attestations/github/v0.1\"\n        },\n        {\n          \"type\": \"https://witness.dev/attestations/command-run/v0.1\"\n        },\n        {\n          \"type\": \"https://witness.dev/attestations/material/v0.1\"\n        },\n        {\n          \"type\": \"https://witness.dev/attestations/product/v0.1\"\n        }\n      ],\n      \"functionaries\": [\n        {\n          \"type\": \"publickey\",\n          \"publickeyid\": \"build-key\"\n        }\n      ]\n    }\n  }\n}\n```\n\n**Witness Run Command:**\n```bash\nwitness run --step build \\\n  --attestations github,commandrun,material,product \\\n  --outfile build-attestation.json \\\n  --key signing-key.pem \\\n  -- <your-build-command>\n```\n\n**Rego Validation Rules:**\n```rego\n\n```\n\n**Verification:**\n```bash\nwitness verify \\\n  --policy policy-signed.json \\\n  --publickey policy-key.pub \\\n  -a build-attestation.json \\\n  --subject <artifact>\n```\n"}]}
{"messages": [{"role": "system", "content": "You are an expert in the Witness supply chain attestation framework. You help users instrument CI/CD pipelines with witness, create policy documents, and write Rego policies to validate attestations. You understand all attestors in go-witness and how to use them effectively."}, {"role": "user", "content": "How do I create a witness policy for a build step that uses these attestors: git, environment, commandrun, material?"}, {"role": "assistant", "content": "Here's a complete witness policy for your build step with git, environment, commandrun, material attestors:\n\n**Policy Document:**\n```json\n{\n  \"expires\": \"2026-11-08T10:52:59Z\",\n  \"publickeys\": {\n    \"build-key\": {\n      \"keyid\": \"sha256:cbb33ecdc324cee285c3572a6f4a6802bcd6b44f70745c6b948870ef569660cf\",\n      \"key\": \"-----BEGIN PUBLIC KEY-----\\n...\\n-----END PUBLIC KEY-----\"\n    }\n  },\n  \"steps\": {\n    \"build\": {\n      \"name\": \"build\",\n      \"attestations\": [\n        {\n          \"type\": \"https://witness.dev/attestations/git/v0.1\"\n        },\n        {\n          \"type\": \"https://witness.dev/attestations/environment/v0.1\"\n        },\n        {\n          \"type\": \"https://witness.dev/attestations/command-run/v0.1\"\n        },\n        {\n          \"type\": \"https://witness.dev/attestations/material/v0.1\"\n        }\n      ],\n      \"functionaries\": [\n        {\n          \"type\": \"publickey\",\n          \"publickeyid\": \"build-key\"\n        }\n      ]\n    }\n  }\n}\n```\n\n**Witness Run Command:**\n```bash\nwitness run --step build \\\n  --attestations git,environment,commandrun,material \\\n  --outfile build-attestation.json \\\n  --key signing-key.pem \\\n  -- <your-build-command>\n```\n\n**Rego Validation Rules:**\n```rego\npackage git\n\nimport rego.v1\n\n# Enforce builds from specific branch\ndeny contains msg if {\n    input.branch != \"bugfix/security\"\n    msg := sprintf(\"Must build from bugfix/security branch, got: %s\", [input.branch])\n}\n\n# Require clean working directory\ndeny contains msg if {\n    count(input.status) > 0\n    msg := \"Working directory must be clean (no uncommitted changes)\"\n}\n\n# Validate commit author\napproved_authors := {\n    \"alice.smith@example.com\",\n    \"bob.jones@company.com\",\n    \"ci-bot@company.com\"\n}\n\ndeny contains msg if {\n    not input.authoremail in approved_authors\n    msg := sprintf(\"Unauthorized commit author: %s\", [input.authoremail])\n}\n```\n\n**Verification:**\n```bash\nwitness verify \\\n  --policy policy-signed.json \\\n  --publickey policy-key.pub \\\n  -a build-attestation.json \\\n  --subject <artifact>\n```\n"}]}
{"messages": [{"role": "system", "content": "You are an expert in the Witness supply chain attestation framework. You help users instrument CI/CD pipelines with witness, create policy documents, and write Rego policies to validate attestations. You understand all attestors in go-witness and how to use them effectively."}, {"role": "user", "content": "How do I create a multi-step witness policy for a build \u2192 test \u2192 package pipeline?"}, {"role": "assistant", "content": "Here's a complete multi-step witness policy for your pipeline:\n\n**Policy Document:**\n```json\n{\n  \"expires\": \"2026-11-08T10:52:59Z\",\n  \"publickeys\": {\n    \"ci-key\": {\n      \"keyid\": \"sha256:51ae52eac4d2fd05dc990f986ee2bd7699d6013f041b023218d26f34c5ebac0b\",\n      \"key\": \"-----BEGIN PUBLIC KEY-----\\n...\\n-----END PUBLIC KEY-----\"\n    }\n  },\n  \"steps\": {\n    \"build\": {\n      \"name\": \"build\",\n      \"attestations\": [\n        {\n          \"type\": \"https://witness.dev/attestations/git/v0.1\"\n        },\n        {\n          \"type\": \"https://witness.dev/attestations/command-run/v0.1\"\n        },\n        {\n          \"type\": \"https://witness.dev/attestations/product/v0.1\"\n        }\n      ],\n      \"functionaries\": [\n        {\n          \"type\": \"publickey\",\n          \"publickeyid\": \"ci-key\"\n        }\n      ]\n    },\n    \"test\": {\n      \"name\": \"test\",\n      \"attestations\": [\n        {\n          \"type\": \"https://witness.dev/attestations/material/v0.1\"\n        },\n        {\n          \"type\": \"https://witness.dev/attestations/command-run/v0.1\"\n        }\n      ],\n      \"functionaries\": [\n        {\n          \"type\": \"publickey\",\n          \"publickeyid\": \"ci-key\"\n        }\n      ]\n    },\n    \"package\": {\n      \"name\": \"package\",\n      \"attestations\": [\n        {\n          \"type\": \"https://witness.dev/attestations/material/v0.1\"\n        },\n        {\n          \"type\": \"https://witness.dev/attestations/product/v0.1\"\n        }\n      ],\n      \"functionaries\": [\n        {\n          \"type\": \"publickey\",\n          \"publickeyid\": \"ci-key\"\n        }\n      ]\n    }\n  }\n}\n```\n\n**Pipeline Commands:**\n\n```bash\n# Step 1: Build\nwitness run --step build \\\n  --attestations git,commandrun,product \\\n  -o build.json --key ci-key.pem \\\n  -- go build -o myapp\n\n# Step 2: Test\nwitness run --step test \\\n  --attestations material,commandrun \\\n  -o test.json --key ci-key.pem \\\n  -- go test ./...\n\n# Step 3: Package\nwitness run --step package \\\n  --attestations material,product \\\n  -o package.json --key ci-key.pem \\\n  -- tar czf myapp.tar.gz myapp\n\n# Verify entire pipeline\nwitness verify \\\n  --policy policy-signed.json \\\n  --publickey policy-key.pub \\\n  -a build.json -a test.json -a package.json\n```\n"}]}
{"messages": [{"role": "system", "content": "You are an expert in the Witness supply chain attestation framework. You help users instrument CI/CD pipelines with witness, create policy documents, and write Rego policies to validate attestations. You understand all attestors in go-witness and how to use them effectively."}, {"role": "user", "content": "How do I create a witness policy for a build step that uses these attestors: github, product, material?"}, {"role": "assistant", "content": "Here's a complete witness policy for your build step with github, product, material attestors:\n\n**Policy Document:**\n```json\n{\n  \"expires\": \"2026-11-08T10:52:59Z\",\n  \"publickeys\": {\n    \"build-key\": {\n      \"keyid\": \"sha256:a4e230176db027592636c5718849b9767ae87a5a7bbea634b6face2102158fa0\",\n      \"key\": \"-----BEGIN PUBLIC KEY-----\\n...\\n-----END PUBLIC KEY-----\"\n    }\n  },\n  \"steps\": {\n    \"build\": {\n      \"name\": \"build\",\n      \"attestations\": [\n        {\n          \"type\": \"https://witness.dev/attestations/github/v0.1\"\n        },\n        {\n          \"type\": \"https://witness.dev/attestations/product/v0.1\"\n        },\n        {\n          \"type\": \"https://witness.dev/attestations/material/v0.1\"\n        }\n      ],\n      \"functionaries\": [\n        {\n          \"type\": \"publickey\",\n          \"publickeyid\": \"build-key\"\n        }\n      ]\n    }\n  }\n}\n```\n\n**Witness Run Command:**\n```bash\nwitness run --step build \\\n  --attestations github,product,material \\\n  --outfile build-attestation.json \\\n  --key signing-key.pem \\\n  -- <your-build-command>\n```\n\n**Rego Validation Rules:**\n```rego\n\n```\n\n**Verification:**\n```bash\nwitness verify \\\n  --policy policy-signed.json \\\n  --publickey policy-key.pub \\\n  -a build-attestation.json \\\n  --subject <artifact>\n```\n"}]}
{"messages": [{"role": "system", "content": "You are an expert in the Witness supply chain attestation framework. You help users instrument CI/CD pipelines with witness, create policy documents, and write Rego policies to validate attestations. You understand all attestors in go-witness and how to use them effectively."}, {"role": "user", "content": "How do I create a witness policy for a build step that uses these attestors: material, product, github, commandrun, git?"}, {"role": "assistant", "content": "Here's a complete witness policy for your build step with material, product, github, commandrun, git attestors:\n\n**Policy Document:**\n```json\n{\n  \"expires\": \"2026-11-08T10:52:59Z\",\n  \"publickeys\": {\n    \"build-key\": {\n      \"keyid\": \"sha256:6caca9743d8f19e1a447e082a9f6b672ed962a995c8ddf15c164a8a1123ca689\",\n      \"key\": \"-----BEGIN PUBLIC KEY-----\\n...\\n-----END PUBLIC KEY-----\"\n    }\n  },\n  \"steps\": {\n    \"build\": {\n      \"name\": \"build\",\n      \"attestations\": [\n        {\n          \"type\": \"https://witness.dev/attestations/material/v0.1\"\n        },\n        {\n          \"type\": \"https://witness.dev/attestations/product/v0.1\"\n        },\n        {\n          \"type\": \"https://witness.dev/attestations/github/v0.1\"\n        },\n        {\n          \"type\": \"https://witness.dev/attestations/command-run/v0.1\"\n        },\n        {\n          \"type\": \"https://witness.dev/attestations/git/v0.1\"\n        }\n      ],\n      \"functionaries\": [\n        {\n          \"type\": \"publickey\",\n          \"publickeyid\": \"build-key\"\n        }\n      ]\n    }\n  }\n}\n```\n\n**Witness Run Command:**\n```bash\nwitness run --step build \\\n  --attestations material,product,github,commandrun,git \\\n  --outfile build-attestation.json \\\n  --key signing-key.pem \\\n  -- <your-build-command>\n```\n\n**Rego Validation Rules:**\n```rego\n\n```\n\n**Verification:**\n```bash\nwitness verify \\\n  --policy policy-signed.json \\\n  --publickey policy-key.pub \\\n  -a build-attestation.json \\\n  --subject <artifact>\n```\n"}]}
{"messages": [{"role": "system", "content": "You are an expert in the Witness supply chain attestation framework. You help users instrument CI/CD pipelines with witness, create policy documents, and write Rego policies to validate attestations. You understand all attestors in go-witness and how to use them effectively."}, {"role": "user", "content": "How do I create a multi-step witness policy for a build \u2192 test \u2192 package pipeline?"}, {"role": "assistant", "content": "Here's a complete multi-step witness policy for your pipeline:\n\n**Policy Document:**\n```json\n{\n  \"expires\": \"2026-11-08T10:52:59Z\",\n  \"publickeys\": {\n    \"ci-key\": {\n      \"keyid\": \"sha256:3c87b19b3c7e489711ec75f598d8426fd0314990680c2e39bec7e3fe375805aa\",\n      \"key\": \"-----BEGIN PUBLIC KEY-----\\n...\\n-----END PUBLIC KEY-----\"\n    }\n  },\n  \"steps\": {\n    \"build\": {\n      \"name\": \"build\",\n      \"attestations\": [\n        {\n          \"type\": \"https://witness.dev/attestations/git/v0.1\"\n        },\n        {\n          \"type\": \"https://witness.dev/attestations/command-run/v0.1\"\n        },\n        {\n          \"type\": \"https://witness.dev/attestations/product/v0.1\"\n        }\n      ],\n      \"functionaries\": [\n        {\n          \"type\": \"publickey\",\n          \"publickeyid\": \"ci-key\"\n        }\n      ]\n    },\n    \"test\": {\n      \"name\": \"test\",\n      \"attestations\": [\n        {\n          \"type\": \"https://witness.dev/attestations/material/v0.1\"\n        },\n        {\n          \"type\": \"https://witness.dev/attestations/command-run/v0.1\"\n        }\n      ],\n      \"functionaries\": [\n        {\n          \"type\": \"publickey\",\n          \"publickeyid\": \"ci-key\"\n        }\n      ]\n    },\n    \"package\": {\n      \"name\": \"package\",\n      \"attestations\": [\n        {\n          \"type\": \"https://witness.dev/attestations/material/v0.1\"\n        },\n        {\n          \"type\": \"https://witness.dev/attestations/product/v0.1\"\n        }\n      ],\n      \"functionaries\": [\n        {\n          \"type\": \"publickey\",\n          \"publickeyid\": \"ci-key\"\n        }\n      ]\n    }\n  }\n}\n```\n\n**Pipeline Commands:**\n\n```bash\n# Step 1: Build\nwitness run --step build \\\n  --attestations git,commandrun,product \\\n  -o build.json --key ci-key.pem \\\n  -- go build -o myapp\n\n# Step 2: Test\nwitness run --step test \\\n  --attestations material,commandrun \\\n  -o test.json --key ci-key.pem \\\n  -- go test ./...\n\n# Step 3: Package\nwitness run --step package \\\n  --attestations material,product \\\n  -o package.json --key ci-key.pem \\\n  -- tar czf myapp.tar.gz myapp\n\n# Verify entire pipeline\nwitness verify \\\n  --policy policy-signed.json \\\n  --publickey policy-key.pub \\\n  -a build.json -a test.json -a package.json\n```\n"}]}
{"messages": [{"role": "system", "content": "You are an expert in the Witness supply chain attestation framework. You help users instrument CI/CD pipelines with witness, create policy documents, and write Rego policies to validate attestations. You understand all attestors in go-witness and how to use them effectively."}, {"role": "user", "content": "How do I create a multi-step witness policy for a build \u2192 test \u2192 package pipeline?"}, {"role": "assistant", "content": "Here's a complete multi-step witness policy for your pipeline:\n\n**Policy Document:**\n```json\n{\n  \"expires\": \"2026-11-08T10:52:59Z\",\n  \"publickeys\": {\n    \"ci-key\": {\n      \"keyid\": \"sha256:98c42cdaa81e997e44004c39c21ffb2286a60b0e67b00be2d8f94c693b1542a1\",\n      \"key\": \"-----BEGIN PUBLIC KEY-----\\n...\\n-----END PUBLIC KEY-----\"\n    }\n  },\n  \"steps\": {\n    \"build\": {\n      \"name\": \"build\",\n      \"attestations\": [\n        {\n          \"type\": \"https://witness.dev/attestations/git/v0.1\"\n        },\n        {\n          \"type\": \"https://witness.dev/attestations/command-run/v0.1\"\n        },\n        {\n          \"type\": \"https://witness.dev/attestations/product/v0.1\"\n        }\n      ],\n      \"functionaries\": [\n        {\n          \"type\": \"publickey\",\n          \"publickeyid\": \"ci-key\"\n        }\n      ]\n    },\n    \"test\": {\n      \"name\": \"test\",\n      \"attestations\": [\n        {\n          \"type\": \"https://witness.dev/attestations/material/v0.1\"\n        },\n        {\n          \"type\": \"https://witness.dev/attestations/command-run/v0.1\"\n        }\n      ],\n      \"functionaries\": [\n        {\n          \"type\": \"publickey\",\n          \"publickeyid\": \"ci-key\"\n        }\n      ]\n    },\n    \"package\": {\n      \"name\": \"package\",\n      \"attestations\": [\n        {\n          \"type\": \"https://witness.dev/attestations/material/v0.1\"\n        },\n        {\n          \"type\": \"https://witness.dev/attestations/product/v0.1\"\n        }\n      ],\n      \"functionaries\": [\n        {\n          \"type\": \"publickey\",\n          \"publickeyid\": \"ci-key\"\n        }\n      ]\n    }\n  }\n}\n```\n\n**Pipeline Commands:**\n\n```bash\n# Step 1: Build\nwitness run --step build \\\n  --attestations git,commandrun,product \\\n  -o build.json --key ci-key.pem \\\n  -- go build -o myapp\n\n# Step 2: Test\nwitness run --step test \\\n  --attestations material,commandrun \\\n  -o test.json --key ci-key.pem \\\n  -- go test ./...\n\n# Step 3: Package\nwitness run --step package \\\n  --attestations material,product \\\n  -o package.json --key ci-key.pem \\\n  -- tar czf myapp.tar.gz myapp\n\n# Verify entire pipeline\nwitness verify \\\n  --policy policy-signed.json \\\n  --publickey policy-key.pub \\\n  -a build.json -a test.json -a package.json\n```\n"}]}
{"messages": [{"role": "system", "content": "You are an expert in the Witness supply chain attestation framework. You help users instrument CI/CD pipelines with witness, create policy documents, and write Rego policies to validate attestations. You understand all attestors in go-witness and how to use them effectively."}, {"role": "user", "content": "How do I create a witness policy for a build step that uses these attestors: git, product, commandrun?"}, {"role": "assistant", "content": "Here's a complete witness policy for your build step with git, product, commandrun attestors:\n\n**Policy Document:**\n```json\n{\n  \"expires\": \"2026-11-08T10:52:59Z\",\n  \"publickeys\": {\n    \"build-key\": {\n      \"keyid\": \"sha256:cb2ebff10a43ffe70be14ed3a0463a7756ddf040cf64ce9b6ca01e8c5dd1f587\",\n      \"key\": \"-----BEGIN PUBLIC KEY-----\\n...\\n-----END PUBLIC KEY-----\"\n    }\n  },\n  \"steps\": {\n    \"build\": {\n      \"name\": \"build\",\n      \"attestations\": [\n        {\n          \"type\": \"https://witness.dev/attestations/git/v0.1\"\n        },\n        {\n          \"type\": \"https://witness.dev/attestations/product/v0.1\"\n        },\n        {\n          \"type\": \"https://witness.dev/attestations/command-run/v0.1\"\n        }\n      ],\n      \"functionaries\": [\n        {\n          \"type\": \"publickey\",\n          \"publickeyid\": \"build-key\"\n        }\n      ]\n    }\n  }\n}\n```\n\n**Witness Run Command:**\n```bash\nwitness run --step build \\\n  --attestations git,product,commandrun \\\n  --outfile build-attestation.json \\\n  --key signing-key.pem \\\n  -- <your-build-command>\n```\n\n**Rego Validation Rules:**\n```rego\npackage git\n\nimport rego.v1\n\n# Enforce builds from specific branch\ndeny contains msg if {\n    input.branch != \"feature/auth\"\n    msg := sprintf(\"Must build from feature/auth branch, got: %s\", [input.branch])\n}\n\n# Validate commit author\napproved_authors := {\n    \"alice.smith@example.com\",\n    \"bob.jones@company.com\",\n    \"ci-bot@company.com\"\n}\n\ndeny contains msg if {\n    not input.authoremail in approved_authors\n    msg := sprintf(\"Unauthorized commit author: %s\", [input.authoremail])\n}\n```\n\n**Verification:**\n```bash\nwitness verify \\\n  --policy policy-signed.json \\\n  --publickey policy-key.pub \\\n  -a build-attestation.json \\\n  --subject <artifact>\n```\n"}]}
{"messages": [{"role": "system", "content": "You are an expert in the Witness supply chain attestation framework. You help users instrument CI/CD pipelines with witness, create policy documents, and write Rego policies to validate attestations. You understand all attestors in go-witness and how to use them effectively."}, {"role": "user", "content": "How do I create a witness policy for a build step that uses these attestors: environment?"}, {"role": "assistant", "content": "Here's a complete witness policy for your build step with environment attestors:\n\n**Policy Document:**\n```json\n{\n  \"expires\": \"2026-11-08T10:52:59Z\",\n  \"publickeys\": {\n    \"build-key\": {\n      \"keyid\": \"sha256:3db94a7986012320edd6b45c361cd304c5c5415a7324ea571f75af822d9beda5\",\n      \"key\": \"-----BEGIN PUBLIC KEY-----\\n...\\n-----END PUBLIC KEY-----\"\n    }\n  },\n  \"steps\": {\n    \"build\": {\n      \"name\": \"build\",\n      \"attestations\": [\n        {\n          \"type\": \"https://witness.dev/attestations/environment/v0.1\"\n        }\n      ],\n      \"functionaries\": [\n        {\n          \"type\": \"publickey\",\n          \"publickeyid\": \"build-key\"\n        }\n      ]\n    }\n  }\n}\n```\n\n**Witness Run Command:**\n```bash\nwitness run --step build \\\n  --attestations environment \\\n  --outfile build-attestation.json \\\n  --key signing-key.pem \\\n  -- <your-build-command>\n```\n\n**Rego Validation Rules:**\n```rego\npackage environment\n\nimport rego.v1\n\n# Ensure correct OS\ndeny contains msg if {\n    input.os != \"windows\"\n    msg := sprintf(\"Must run on windows, got: %s\", [input.os])\n}\n\n# Require CI environment\ndeny contains msg if {\n    not \"CI\" in input.variables\n    msg := \"Must run in CI environment (CI variable not set)\"\n}\n```\n\n**Verification:**\n```bash\nwitness verify \\\n  --policy policy-signed.json \\\n  --publickey policy-key.pub \\\n  -a build-attestation.json \\\n  --subject <artifact>\n```\n"}]}
{"messages": [{"role": "system", "content": "You are an expert in the Witness supply chain attestation framework. You help users instrument CI/CD pipelines with witness, create policy documents, and write Rego policies to validate attestations. You understand all attestors in go-witness and how to use them effectively."}, {"role": "user", "content": "How do I create a witness policy for a build step that uses these attestors: git, github, commandrun?"}, {"role": "assistant", "content": "Here's a complete witness policy for your build step with git, github, commandrun attestors:\n\n**Policy Document:**\n```json\n{\n  \"expires\": \"2026-11-08T10:52:59Z\",\n  \"publickeys\": {\n    \"build-key\": {\n      \"keyid\": \"sha256:2f62bc3c617ae610ecc54852d6aaaba2a1d19d73122dccb04ba44944dd6fb0b2\",\n      \"key\": \"-----BEGIN PUBLIC KEY-----\\n...\\n-----END PUBLIC KEY-----\"\n    }\n  },\n  \"steps\": {\n    \"build\": {\n      \"name\": \"build\",\n      \"attestations\": [\n        {\n          \"type\": \"https://witness.dev/attestations/git/v0.1\"\n        },\n        {\n          \"type\": \"https://witness.dev/attestations/github/v0.1\"\n        },\n        {\n          \"type\": \"https://witness.dev/attestations/command-run/v0.1\"\n        }\n      ],\n      \"functionaries\": [\n        {\n          \"type\": \"publickey\",\n          \"publickeyid\": \"build-key\"\n        }\n      ]\n    }\n  }\n}\n```\n\n**Witness Run Command:**\n```bash\nwitness run --step build \\\n  --attestations git,github,commandrun \\\n  --outfile build-attestation.json \\\n  --key signing-key.pem \\\n  -- <your-build-command>\n```\n\n**Rego Validation Rules:**\n```rego\npackage git\n\nimport rego.v1\n\n# Enforce builds from specific branch\ndeny contains msg if {\n    input.branch != \"staging\"\n    msg := sprintf(\"Must build from staging branch, got: %s\", [input.branch])\n}\n\n# Validate commit author\napproved_authors := {\n    \"alice.smith@example.com\",\n    \"bob.jones@company.com\",\n    \"ci-bot@company.com\"\n}\n\ndeny contains msg if {\n    not input.authoremail in approved_authors\n    msg := sprintf(\"Unauthorized commit author: %s\", [input.authoremail])\n}\n```\n\n**Verification:**\n```bash\nwitness verify \\\n  --policy policy-signed.json \\\n  --publickey policy-key.pub \\\n  -a build-attestation.json \\\n  --subject <artifact>\n```\n"}]}
{"messages": [{"role": "system", "content": "You are an expert in the Witness supply chain attestation framework. You help users instrument CI/CD pipelines with witness, create policy documents, and write Rego policies to validate attestations. You understand all attestors in go-witness and how to use them effectively."}, {"role": "user", "content": "How do I create a witness policy for a build step that uses these attestors: commandrun, environment, github?"}, {"role": "assistant", "content": "Here's a complete witness policy for your build step with commandrun, environment, github attestors:\n\n**Policy Document:**\n```json\n{\n  \"expires\": \"2026-11-08T10:52:59Z\",\n  \"publickeys\": {\n    \"build-key\": {\n      \"keyid\": \"sha256:f7ddafb81c72721c481b8f93624dc4fff2ed5af223802062407942d0739e3420\",\n      \"key\": \"-----BEGIN PUBLIC KEY-----\\n...\\n-----END PUBLIC KEY-----\"\n    }\n  },\n  \"steps\": {\n    \"build\": {\n      \"name\": \"build\",\n      \"attestations\": [\n        {\n          \"type\": \"https://witness.dev/attestations/command-run/v0.1\"\n        },\n        {\n          \"type\": \"https://witness.dev/attestations/environment/v0.1\"\n        },\n        {\n          \"type\": \"https://witness.dev/attestations/github/v0.1\"\n        }\n      ],\n      \"functionaries\": [\n        {\n          \"type\": \"publickey\",\n          \"publickeyid\": \"build-key\"\n        }\n      ]\n    }\n  }\n}\n```\n\n**Witness Run Command:**\n```bash\nwitness run --step build \\\n  --attestations commandrun,environment,github \\\n  --outfile build-attestation.json \\\n  --key signing-key.pem \\\n  -- <your-build-command>\n```\n\n**Rego Validation Rules:**\n```rego\n\n```\n\n**Verification:**\n```bash\nwitness verify \\\n  --policy policy-signed.json \\\n  --publickey policy-key.pub \\\n  -a build-attestation.json \\\n  --subject <artifact>\n```\n"}]}
{"messages": [{"role": "system", "content": "You are an expert in the Witness supply chain attestation framework. You help users instrument CI/CD pipelines with witness, create policy documents, and write Rego policies to validate attestations. You understand all attestors in go-witness and how to use them effectively."}, {"role": "user", "content": "How do I create a multi-step witness policy for a build \u2192 test \u2192 package pipeline?"}, {"role": "assistant", "content": "Here's a complete multi-step witness policy for your pipeline:\n\n**Policy Document:**\n```json\n{\n  \"expires\": \"2026-11-08T10:52:59Z\",\n  \"publickeys\": {\n    \"ci-key\": {\n      \"keyid\": \"sha256:7792e01393b12d86dc5e67768e993eef8de68076c9cdaf1da4c34eea555c620b\",\n      \"key\": \"-----BEGIN PUBLIC KEY-----\\n...\\n-----END PUBLIC KEY-----\"\n    }\n  },\n  \"steps\": {\n    \"build\": {\n      \"name\": \"build\",\n      \"attestations\": [\n        {\n          \"type\": \"https://witness.dev/attestations/git/v0.1\"\n        },\n        {\n          \"type\": \"https://witness.dev/attestations/command-run/v0.1\"\n        },\n        {\n          \"type\": \"https://witness.dev/attestations/product/v0.1\"\n        }\n      ],\n      \"functionaries\": [\n        {\n          \"type\": \"publickey\",\n          \"publickeyid\": \"ci-key\"\n        }\n      ]\n    },\n    \"test\": {\n      \"name\": \"test\",\n      \"attestations\": [\n        {\n          \"type\": \"https://witness.dev/attestations/material/v0.1\"\n        },\n        {\n          \"type\": \"https://witness.dev/attestations/command-run/v0.1\"\n        }\n      ],\n      \"functionaries\": [\n        {\n          \"type\": \"publickey\",\n          \"publickeyid\": \"ci-key\"\n        }\n      ]\n    },\n    \"package\": {\n      \"name\": \"package\",\n      \"attestations\": [\n        {\n          \"type\": \"https://witness.dev/attestations/material/v0.1\"\n        },\n        {\n          \"type\": \"https://witness.dev/attestations/product/v0.1\"\n        }\n      ],\n      \"functionaries\": [\n        {\n          \"type\": \"publickey\",\n          \"publickeyid\": \"ci-key\"\n        }\n      ]\n    }\n  }\n}\n```\n\n**Pipeline Commands:**\n\n```bash\n# Step 1: Build\nwitness run --step build \\\n  --attestations git,commandrun,product \\\n  -o build.json --key ci-key.pem \\\n  -- go build -o myapp\n\n# Step 2: Test\nwitness run --step test \\\n  --attestations material,commandrun \\\n  -o test.json --key ci-key.pem \\\n  -- go test ./...\n\n# Step 3: Package\nwitness run --step package \\\n  --attestations material,product \\\n  -o package.json --key ci-key.pem \\\n  -- tar czf myapp.tar.gz myapp\n\n# Verify entire pipeline\nwitness verify \\\n  --policy policy-signed.json \\\n  --publickey policy-key.pub \\\n  -a build.json -a test.json -a package.json\n```\n"}]}
{"messages": [{"role": "system", "content": "You are an expert in the Witness supply chain attestation framework. You help users instrument CI/CD pipelines with witness, create policy documents, and write Rego policies to validate attestations. You understand all attestors in go-witness and how to use them effectively."}, {"role": "user", "content": "How do I create a witness policy for a build step that uses these attestors: commandrun, github, product, git, environment?"}, {"role": "assistant", "content": "Here's a complete witness policy for your build step with commandrun, github, product, git, environment attestors:\n\n**Policy Document:**\n```json\n{\n  \"expires\": \"2026-11-08T10:52:59Z\",\n  \"publickeys\": {\n    \"build-key\": {\n      \"keyid\": \"sha256:a1c34885812e233e06c401829071a04ee55ba987b83a348592cf1862c8a76051\",\n      \"key\": \"-----BEGIN PUBLIC KEY-----\\n...\\n-----END PUBLIC KEY-----\"\n    }\n  },\n  \"steps\": {\n    \"build\": {\n      \"name\": \"build\",\n      \"attestations\": [\n        {\n          \"type\": \"https://witness.dev/attestations/command-run/v0.1\"\n        },\n        {\n          \"type\": \"https://witness.dev/attestations/github/v0.1\"\n        },\n        {\n          \"type\": \"https://witness.dev/attestations/product/v0.1\"\n        },\n        {\n          \"type\": \"https://witness.dev/attestations/git/v0.1\"\n        },\n        {\n          \"type\": \"https://witness.dev/attestations/environment/v0.1\"\n        }\n      ],\n      \"functionaries\": [\n        {\n          \"type\": \"publickey\",\n          \"publickeyid\": \"build-key\"\n        }\n      ]\n    }\n  }\n}\n```\n\n**Witness Run Command:**\n```bash\nwitness run --step build \\\n  --attestations commandrun,github,product,git,environment \\\n  --outfile build-attestation.json \\\n  --key signing-key.pem \\\n  -- <your-build-command>\n```\n\n**Rego Validation Rules:**\n```rego\n\n```\n\n**Verification:**\n```bash\nwitness verify \\\n  --policy policy-signed.json \\\n  --publickey policy-key.pub \\\n  -a build-attestation.json \\\n  --subject <artifact>\n```\n"}]}
{"messages": [{"role": "system", "content": "You are an expert in the Witness supply chain attestation framework. You help users instrument CI/CD pipelines with witness, create policy documents, and write Rego policies to validate attestations. You understand all attestors in go-witness and how to use them effectively."}, {"role": "user", "content": "How do I create a witness policy for a build step that uses these attestors: environment, material, git, github?"}, {"role": "assistant", "content": "Here's a complete witness policy for your build step with environment, material, git, github attestors:\n\n**Policy Document:**\n```json\n{\n  \"expires\": \"2026-11-08T10:52:59Z\",\n  \"publickeys\": {\n    \"build-key\": {\n      \"keyid\": \"sha256:9a6127578935e4f0cf94fd0f4f21e73292ee8521ecbc109d5454fc0a085faf82\",\n      \"key\": \"-----BEGIN PUBLIC KEY-----\\n...\\n-----END PUBLIC KEY-----\"\n    }\n  },\n  \"steps\": {\n    \"build\": {\n      \"name\": \"build\",\n      \"attestations\": [\n        {\n          \"type\": \"https://witness.dev/attestations/environment/v0.1\"\n        },\n        {\n          \"type\": \"https://witness.dev/attestations/material/v0.1\"\n        },\n        {\n          \"type\": \"https://witness.dev/attestations/git/v0.1\"\n        },\n        {\n          \"type\": \"https://witness.dev/attestations/github/v0.1\"\n        }\n      ],\n      \"functionaries\": [\n        {\n          \"type\": \"publickey\",\n          \"publickeyid\": \"build-key\"\n        }\n      ]\n    }\n  }\n}\n```\n\n**Witness Run Command:**\n```bash\nwitness run --step build \\\n  --attestations environment,material,git,github \\\n  --outfile build-attestation.json \\\n  --key signing-key.pem \\\n  -- <your-build-command>\n```\n\n**Rego Validation Rules:**\n```rego\npackage environment\n\nimport rego.v1\n\n# Ensure correct OS\ndeny contains msg if {\n    input.os != \"darwin\"\n    msg := sprintf(\"Must run on darwin, got: %s\", [input.os])\n}\n\n# Require CI environment\ndeny contains msg if {\n    not \"CI\" in input.variables\n    msg := \"Must run in CI environment (CI variable not set)\"\n}\n```\n\n**Verification:**\n```bash\nwitness verify \\\n  --policy policy-signed.json \\\n  --publickey policy-key.pub \\\n  -a build-attestation.json \\\n  --subject <artifact>\n```\n"}]}
{"messages": [{"role": "system", "content": "You are an expert in the Witness supply chain attestation framework. You help users instrument CI/CD pipelines with witness, create policy documents, and write Rego policies to validate attestations. You understand all attestors in go-witness and how to use them effectively."}, {"role": "user", "content": "How do I create a witness policy for a build step that uses these attestors: commandrun, github, product?"}, {"role": "assistant", "content": "Here's a complete witness policy for your build step with commandrun, github, product attestors:\n\n**Policy Document:**\n```json\n{\n  \"expires\": \"2026-11-08T10:52:59Z\",\n  \"publickeys\": {\n    \"build-key\": {\n      \"keyid\": \"sha256:5b9a7c154993e688b544a8b7a0755dc5a8090ab608a6f74897e0dd0d8ece0b0e\",\n      \"key\": \"-----BEGIN PUBLIC KEY-----\\n...\\n-----END PUBLIC KEY-----\"\n    }\n  },\n  \"steps\": {\n    \"build\": {\n      \"name\": \"build\",\n      \"attestations\": [\n        {\n          \"type\": \"https://witness.dev/attestations/command-run/v0.1\"\n        },\n        {\n          \"type\": \"https://witness.dev/attestations/github/v0.1\"\n        },\n        {\n          \"type\": \"https://witness.dev/attestations/product/v0.1\"\n        }\n      ],\n      \"functionaries\": [\n        {\n          \"type\": \"publickey\",\n          \"publickeyid\": \"build-key\"\n        }\n      ]\n    }\n  }\n}\n```\n\n**Witness Run Command:**\n```bash\nwitness run --step build \\\n  --attestations commandrun,github,product \\\n  --outfile build-attestation.json \\\n  --key signing-key.pem \\\n  -- <your-build-command>\n```\n\n**Rego Validation Rules:**\n```rego\n\n```\n\n**Verification:**\n```bash\nwitness verify \\\n  --policy policy-signed.json \\\n  --publickey policy-key.pub \\\n  -a build-attestation.json \\\n  --subject <artifact>\n```\n"}]}
{"messages": [{"role": "system", "content": "You are an expert in the Witness supply chain attestation framework. You help users instrument CI/CD pipelines with witness, create policy documents, and write Rego policies to validate attestations. You understand all attestors in go-witness and how to use them effectively."}, {"role": "user", "content": "How do I create a witness policy for a build step that uses these attestors: material, commandrun?"}, {"role": "assistant", "content": "Here's a complete witness policy for your build step with material, commandrun attestors:\n\n**Policy Document:**\n```json\n{\n  \"expires\": \"2026-11-08T10:52:59Z\",\n  \"publickeys\": {\n    \"build-key\": {\n      \"keyid\": \"sha256:47b9746accb802d14620a3dbd3f9d682090077c3e2fb55831015cf59264948b1\",\n      \"key\": \"-----BEGIN PUBLIC KEY-----\\n...\\n-----END PUBLIC KEY-----\"\n    }\n  },\n  \"steps\": {\n    \"build\": {\n      \"name\": \"build\",\n      \"attestations\": [\n        {\n          \"type\": \"https://witness.dev/attestations/material/v0.1\"\n        },\n        {\n          \"type\": \"https://witness.dev/attestations/command-run/v0.1\"\n        }\n      ],\n      \"functionaries\": [\n        {\n          \"type\": \"publickey\",\n          \"publickeyid\": \"build-key\"\n        }\n      ]\n    }\n  }\n}\n```\n\n**Witness Run Command:**\n```bash\nwitness run --step build \\\n  --attestations material,commandrun \\\n  --outfile build-attestation.json \\\n  --key signing-key.pem \\\n  -- <your-build-command>\n```\n\n**Rego Validation Rules:**\n```rego\n\n```\n\n**Verification:**\n```bash\nwitness verify \\\n  --policy policy-signed.json \\\n  --publickey policy-key.pub \\\n  -a build-attestation.json \\\n  --subject <artifact>\n```\n"}]}
{"messages": [{"role": "system", "content": "You are an expert in the Witness supply chain attestation framework. You help users instrument CI/CD pipelines with witness, create policy documents, and write Rego policies to validate attestations. You understand all attestors in go-witness and how to use them effectively."}, {"role": "user", "content": "How do I create a witness policy for a build step that uses these attestors: environment, material, git?"}, {"role": "assistant", "content": "Here's a complete witness policy for your build step with environment, material, git attestors:\n\n**Policy Document:**\n```json\n{\n  \"expires\": \"2026-11-08T10:52:59Z\",\n  \"publickeys\": {\n    \"build-key\": {\n      \"keyid\": \"sha256:c3dae5dbcef48fb1bbeaf43b69a11dbb0e623c8d5bcee5cda361cb2d8ce315df\",\n      \"key\": \"-----BEGIN PUBLIC KEY-----\\n...\\n-----END PUBLIC KEY-----\"\n    }\n  },\n  \"steps\": {\n    \"build\": {\n      \"name\": \"build\",\n      \"attestations\": [\n        {\n          \"type\": \"https://witness.dev/attestations/environment/v0.1\"\n        },\n        {\n          \"type\": \"https://witness.dev/attestations/material/v0.1\"\n        },\n        {\n          \"type\": \"https://witness.dev/attestations/git/v0.1\"\n        }\n      ],\n      \"functionaries\": [\n        {\n          \"type\": \"publickey\",\n          \"publickeyid\": \"build-key\"\n        }\n      ]\n    }\n  }\n}\n```\n\n**Witness Run Command:**\n```bash\nwitness run --step build \\\n  --attestations environment,material,git \\\n  --outfile build-attestation.json \\\n  --key signing-key.pem \\\n  -- <your-build-command>\n```\n\n**Rego Validation Rules:**\n```rego\npackage environment\n\nimport rego.v1\n\n# Ensure correct OS\ndeny contains msg if {\n    input.os != \"linux\"\n    msg := sprintf(\"Must run on linux, got: %s\", [input.os])\n}\n\n# Require CI environment\ndeny contains msg if {\n    not \"CI\" in input.variables\n    msg := \"Must run in CI environment (CI variable not set)\"\n}\n```\n\n**Verification:**\n```bash\nwitness verify \\\n  --policy policy-signed.json \\\n  --publickey policy-key.pub \\\n  -a build-attestation.json \\\n  --subject <artifact>\n```\n"}]}
{"messages": [{"role": "system", "content": "You are an expert in the Witness supply chain attestation framework. You help users instrument CI/CD pipelines with witness, create policy documents, and write Rego policies to validate attestations. You understand all attestors in go-witness and how to use them effectively."}, {"role": "user", "content": "How do I create a witness policy for a build step that uses these attestors: commandrun, material, github?"}, {"role": "assistant", "content": "Here's a complete witness policy for your build step with commandrun, material, github attestors:\n\n**Policy Document:**\n```json\n{\n  \"expires\": \"2026-11-08T10:52:59Z\",\n  \"publickeys\": {\n    \"build-key\": {\n      \"keyid\": \"sha256:1c5951b0b15a0d06dfcf5622744dd7da28e1a76c15f42624f0fe78d5cd88a61f\",\n      \"key\": \"-----BEGIN PUBLIC KEY-----\\n...\\n-----END PUBLIC KEY-----\"\n    }\n  },\n  \"steps\": {\n    \"build\": {\n      \"name\": \"build\",\n      \"attestations\": [\n        {\n          \"type\": \"https://witness.dev/attestations/command-run/v0.1\"\n        },\n        {\n          \"type\": \"https://witness.dev/attestations/material/v0.1\"\n        },\n        {\n          \"type\": \"https://witness.dev/attestations/github/v0.1\"\n        }\n      ],\n      \"functionaries\": [\n        {\n          \"type\": \"publickey\",\n          \"publickeyid\": \"build-key\"\n        }\n      ]\n    }\n  }\n}\n```\n\n**Witness Run Command:**\n```bash\nwitness run --step build \\\n  --attestations commandrun,material,github \\\n  --outfile build-attestation.json \\\n  --key signing-key.pem \\\n  -- <your-build-command>\n```\n\n**Rego Validation Rules:**\n```rego\n\n```\n\n**Verification:**\n```bash\nwitness verify \\\n  --policy policy-signed.json \\\n  --publickey policy-key.pub \\\n  -a build-attestation.json \\\n  --subject <artifact>\n```\n"}]}
{"messages": [{"role": "system", "content": "You are an expert in the Witness supply chain attestation framework. You help users instrument CI/CD pipelines with witness, create policy documents, and write Rego policies to validate attestations. You understand all attestors in go-witness and how to use them effectively."}, {"role": "user", "content": "How do I create a witness policy for a build step that uses these attestors: product, commandrun?"}, {"role": "assistant", "content": "Here's a complete witness policy for your build step with product, commandrun attestors:\n\n**Policy Document:**\n```json\n{\n  \"expires\": \"2026-11-08T10:52:59Z\",\n  \"publickeys\": {\n    \"build-key\": {\n      \"keyid\": \"sha256:d425ae4b957c4e6a56f8ef6730ff7c05dfb02ac5c64a451acec3e8145ea5d50d\",\n      \"key\": \"-----BEGIN PUBLIC KEY-----\\n...\\n-----END PUBLIC KEY-----\"\n    }\n  },\n  \"steps\": {\n    \"build\": {\n      \"name\": \"build\",\n      \"attestations\": [\n        {\n          \"type\": \"https://witness.dev/attestations/product/v0.1\"\n        },\n        {\n          \"type\": \"https://witness.dev/attestations/command-run/v0.1\"\n        }\n      ],\n      \"functionaries\": [\n        {\n          \"type\": \"publickey\",\n          \"publickeyid\": \"build-key\"\n        }\n      ]\n    }\n  }\n}\n```\n\n**Witness Run Command:**\n```bash\nwitness run --step build \\\n  --attestations product,commandrun \\\n  --outfile build-attestation.json \\\n  --key signing-key.pem \\\n  -- <your-build-command>\n```\n\n**Rego Validation Rules:**\n```rego\n\n```\n\n**Verification:**\n```bash\nwitness verify \\\n  --policy policy-signed.json \\\n  --publickey policy-key.pub \\\n  -a build-attestation.json \\\n  --subject <artifact>\n```\n"}]}
{"messages": [{"role": "system", "content": "You are an expert in the Witness supply chain attestation framework. You help users instrument CI/CD pipelines with witness, create policy documents, and write Rego policies to validate attestations. You understand all attestors in go-witness and how to use them effectively."}, {"role": "user", "content": "How do I create a witness policy for a build step that uses these attestors: product, git, github, environment?"}, {"role": "assistant", "content": "Here's a complete witness policy for your build step with product, git, github, environment attestors:\n\n**Policy Document:**\n```json\n{\n  \"expires\": \"2026-11-08T10:52:59Z\",\n  \"publickeys\": {\n    \"build-key\": {\n      \"keyid\": \"sha256:ea4ebb74351ee9e9450549842f06f75f0c3d8ef72ae36be75672ae595a4466b6\",\n      \"key\": \"-----BEGIN PUBLIC KEY-----\\n...\\n-----END PUBLIC KEY-----\"\n    }\n  },\n  \"steps\": {\n    \"build\": {\n      \"name\": \"build\",\n      \"attestations\": [\n        {\n          \"type\": \"https://witness.dev/attestations/product/v0.1\"\n        },\n        {\n          \"type\": \"https://witness.dev/attestations/git/v0.1\"\n        },\n        {\n          \"type\": \"https://witness.dev/attestations/github/v0.1\"\n        },\n        {\n          \"type\": \"https://witness.dev/attestations/environment/v0.1\"\n        }\n      ],\n      \"functionaries\": [\n        {\n          \"type\": \"publickey\",\n          \"publickeyid\": \"build-key\"\n        }\n      ]\n    }\n  }\n}\n```\n\n**Witness Run Command:**\n```bash\nwitness run --step build \\\n  --attestations product,git,github,environment \\\n  --outfile build-attestation.json \\\n  --key signing-key.pem \\\n  -- <your-build-command>\n```\n\n**Rego Validation Rules:**\n```rego\n\n```\n\n**Verification:**\n```bash\nwitness verify \\\n  --policy policy-signed.json \\\n  --publickey policy-key.pub \\\n  -a build-attestation.json \\\n  --subject <artifact>\n```\n"}]}
{"messages": [{"role": "system", "content": "You are an expert in the Witness supply chain attestation framework. You help users instrument CI/CD pipelines with witness, create policy documents, and write Rego policies to validate attestations. You understand all attestors in go-witness and how to use them effectively."}, {"role": "user", "content": "How do I create a multi-step witness policy for a build \u2192 test \u2192 package pipeline?"}, {"role": "assistant", "content": "Here's a complete multi-step witness policy for your pipeline:\n\n**Policy Document:**\n```json\n{\n  \"expires\": \"2026-11-08T10:52:59Z\",\n  \"publickeys\": {\n    \"ci-key\": {\n      \"keyid\": \"sha256:082cf68712a40cc8d54410ba3b4d9cd320abf506bcbc3adc7ff3dc1127c8b11f\",\n      \"key\": \"-----BEGIN PUBLIC KEY-----\\n...\\n-----END PUBLIC KEY-----\"\n    }\n  },\n  \"steps\": {\n    \"build\": {\n      \"name\": \"build\",\n      \"attestations\": [\n        {\n          \"type\": \"https://witness.dev/attestations/git/v0.1\"\n        },\n        {\n          \"type\": \"https://witness.dev/attestations/command-run/v0.1\"\n        },\n        {\n          \"type\": \"https://witness.dev/attestations/product/v0.1\"\n        }\n      ],\n      \"functionaries\": [\n        {\n          \"type\": \"publickey\",\n          \"publickeyid\": \"ci-key\"\n        }\n      ]\n    },\n    \"test\": {\n      \"name\": \"test\",\n      \"attestations\": [\n        {\n          \"type\": \"https://witness.dev/attestations/material/v0.1\"\n        },\n        {\n          \"type\": \"https://witness.dev/attestations/command-run/v0.1\"\n        }\n      ],\n      \"functionaries\": [\n        {\n          \"type\": \"publickey\",\n          \"publickeyid\": \"ci-key\"\n        }\n      ]\n    },\n    \"package\": {\n      \"name\": \"package\",\n      \"attestations\": [\n        {\n          \"type\": \"https://witness.dev/attestations/material/v0.1\"\n        },\n        {\n          \"type\": \"https://witness.dev/attestations/product/v0.1\"\n        }\n      ],\n      \"functionaries\": [\n        {\n          \"type\": \"publickey\",\n          \"publickeyid\": \"ci-key\"\n        }\n      ]\n    }\n  }\n}\n```\n\n**Pipeline Commands:**\n\n```bash\n# Step 1: Build\nwitness run --step build \\\n  --attestations git,commandrun,product \\\n  -o build.json --key ci-key.pem \\\n  -- go build -o myapp\n\n# Step 2: Test\nwitness run --step test \\\n  --attestations material,commandrun \\\n  -o test.json --key ci-key.pem \\\n  -- go test ./...\n\n# Step 3: Package\nwitness run --step package \\\n  --attestations material,product \\\n  -o package.json --key ci-key.pem \\\n  -- tar czf myapp.tar.gz myapp\n\n# Verify entire pipeline\nwitness verify \\\n  --policy policy-signed.json \\\n  --publickey policy-key.pub \\\n  -a build.json -a test.json -a package.json\n```\n"}]}
{"messages": [{"role": "system", "content": "You are an expert in the Witness supply chain attestation framework. You help users instrument CI/CD pipelines with witness, create policy documents, and write Rego policies to validate attestations. You understand all attestors in go-witness and how to use them effectively."}, {"role": "user", "content": "How do I create a witness policy for a build step that uses these attestors: github, environment, commandrun?"}, {"role": "assistant", "content": "Here's a complete witness policy for your build step with github, environment, commandrun attestors:\n\n**Policy Document:**\n```json\n{\n  \"expires\": \"2026-11-08T10:52:59Z\",\n  \"publickeys\": {\n    \"build-key\": {\n      \"keyid\": \"sha256:ebe3af45f0e1e01716f5bb39f754f8235d73b922ca6b1cf06816a2630add30dc\",\n      \"key\": \"-----BEGIN PUBLIC KEY-----\\n...\\n-----END PUBLIC KEY-----\"\n    }\n  },\n  \"steps\": {\n    \"build\": {\n      \"name\": \"build\",\n      \"attestations\": [\n        {\n          \"type\": \"https://witness.dev/attestations/github/v0.1\"\n        },\n        {\n          \"type\": \"https://witness.dev/attestations/environment/v0.1\"\n        },\n        {\n          \"type\": \"https://witness.dev/attestations/command-run/v0.1\"\n        }\n      ],\n      \"functionaries\": [\n        {\n          \"type\": \"publickey\",\n          \"publickeyid\": \"build-key\"\n        }\n      ]\n    }\n  }\n}\n```\n\n**Witness Run Command:**\n```bash\nwitness run --step build \\\n  --attestations github,environment,commandrun \\\n  --outfile build-attestation.json \\\n  --key signing-key.pem \\\n  -- <your-build-command>\n```\n\n**Rego Validation Rules:**\n```rego\n\n```\n\n**Verification:**\n```bash\nwitness verify \\\n  --policy policy-signed.json \\\n  --publickey policy-key.pub \\\n  -a build-attestation.json \\\n  --subject <artifact>\n```\n"}]}
{"messages": [{"role": "system", "content": "You are an expert in the Witness supply chain attestation framework. You help users instrument CI/CD pipelines with witness, create policy documents, and write Rego policies to validate attestations. You understand all attestors in go-witness and how to use them effectively."}, {"role": "user", "content": "How do I create a witness policy for a build step that uses these attestors: git, material, environment?"}, {"role": "assistant", "content": "Here's a complete witness policy for your build step with git, material, environment attestors:\n\n**Policy Document:**\n```json\n{\n  \"expires\": \"2026-11-08T10:52:59Z\",\n  \"publickeys\": {\n    \"build-key\": {\n      \"keyid\": \"sha256:8781b3dd6d652fc22874992f523b7aecd5c2f256555838b5148cddbd23e980cd\",\n      \"key\": \"-----BEGIN PUBLIC KEY-----\\n...\\n-----END PUBLIC KEY-----\"\n    }\n  },\n  \"steps\": {\n    \"build\": {\n      \"name\": \"build\",\n      \"attestations\": [\n        {\n          \"type\": \"https://witness.dev/attestations/git/v0.1\"\n        },\n        {\n          \"type\": \"https://witness.dev/attestations/material/v0.1\"\n        },\n        {\n          \"type\": \"https://witness.dev/attestations/environment/v0.1\"\n        }\n      ],\n      \"functionaries\": [\n        {\n          \"type\": \"publickey\",\n          \"publickeyid\": \"build-key\"\n        }\n      ]\n    }\n  }\n}\n```\n\n**Witness Run Command:**\n```bash\nwitness run --step build \\\n  --attestations git,material,environment \\\n  --outfile build-attestation.json \\\n  --key signing-key.pem \\\n  -- <your-build-command>\n```\n\n**Rego Validation Rules:**\n```rego\npackage git\n\nimport rego.v1\n\n# Enforce builds from specific branch\ndeny contains msg if {\n    input.branch != \"master\"\n    msg := sprintf(\"Must build from master branch, got: %s\", [input.branch])\n}\n\n# Require clean working directory\ndeny contains msg if {\n    count(input.status) > 0\n    msg := \"Working directory must be clean (no uncommitted changes)\"\n}\n\n# Validate commit author\napproved_authors := {\n    \"alice.smith@example.com\",\n    \"bob.jones@company.com\",\n    \"ci-bot@company.com\"\n}\n\ndeny contains msg if {\n    not input.authoremail in approved_authors\n    msg := sprintf(\"Unauthorized commit author: %s\", [input.authoremail])\n}\n```\n\n**Verification:**\n```bash\nwitness verify \\\n  --policy policy-signed.json \\\n  --publickey policy-key.pub \\\n  -a build-attestation.json \\\n  --subject <artifact>\n```\n"}]}
{"messages": [{"role": "system", "content": "You are an expert in the Witness supply chain attestation framework. You help users instrument CI/CD pipelines with witness, create policy documents, and write Rego policies to validate attestations. You understand all attestors in go-witness and how to use them effectively."}, {"role": "user", "content": "How do I create a witness policy for a build step that uses these attestors: environment, github, git, material?"}, {"role": "assistant", "content": "Here's a complete witness policy for your build step with environment, github, git, material attestors:\n\n**Policy Document:**\n```json\n{\n  \"expires\": \"2026-11-08T10:52:59Z\",\n  \"publickeys\": {\n    \"build-key\": {\n      \"keyid\": \"sha256:64cef578341cbf36acd6167fe0f5fc37636bb6ff114174e70f6aa72506aeb6db\",\n      \"key\": \"-----BEGIN PUBLIC KEY-----\\n...\\n-----END PUBLIC KEY-----\"\n    }\n  },\n  \"steps\": {\n    \"build\": {\n      \"name\": \"build\",\n      \"attestations\": [\n        {\n          \"type\": \"https://witness.dev/attestations/environment/v0.1\"\n        },\n        {\n          \"type\": \"https://witness.dev/attestations/github/v0.1\"\n        },\n        {\n          \"type\": \"https://witness.dev/attestations/git/v0.1\"\n        },\n        {\n          \"type\": \"https://witness.dev/attestations/material/v0.1\"\n        }\n      ],\n      \"functionaries\": [\n        {\n          \"type\": \"publickey\",\n          \"publickeyid\": \"build-key\"\n        }\n      ]\n    }\n  }\n}\n```\n\n**Witness Run Command:**\n```bash\nwitness run --step build \\\n  --attestations environment,github,git,material \\\n  --outfile build-attestation.json \\\n  --key signing-key.pem \\\n  -- <your-build-command>\n```\n\n**Rego Validation Rules:**\n```rego\npackage environment\n\nimport rego.v1\n\n# Ensure correct OS\ndeny contains msg if {\n    input.os != \"windows\"\n    msg := sprintf(\"Must run on windows, got: %s\", [input.os])\n}\n\n# Require CI environment\ndeny contains msg if {\n    not \"CI\" in input.variables\n    msg := \"Must run in CI environment (CI variable not set)\"\n}\n```\n\n**Verification:**\n```bash\nwitness verify \\\n  --policy policy-signed.json \\\n  --publickey policy-key.pub \\\n  -a build-attestation.json \\\n  --subject <artifact>\n```\n"}]}
{"messages": [{"role": "system", "content": "You are an expert in the Witness supply chain attestation framework. You help users instrument CI/CD pipelines with witness, create policy documents, and write Rego policies to validate attestations. You understand all attestors in go-witness and how to use them effectively."}, {"role": "user", "content": "How do I create a multi-step witness policy for a build \u2192 test \u2192 package pipeline?"}, {"role": "assistant", "content": "Here's a complete multi-step witness policy for your pipeline:\n\n**Policy Document:**\n```json\n{\n  \"expires\": \"2026-11-08T10:52:59Z\",\n  \"publickeys\": {\n    \"ci-key\": {\n      \"keyid\": \"sha256:aaa2b45f1cda1d901f207d98213112fa875efb7e44c411777511c77c992c2dfe\",\n      \"key\": \"-----BEGIN PUBLIC KEY-----\\n...\\n-----END PUBLIC KEY-----\"\n    }\n  },\n  \"steps\": {\n    \"build\": {\n      \"name\": \"build\",\n      \"attestations\": [\n        {\n          \"type\": \"https://witness.dev/attestations/git/v0.1\"\n        },\n        {\n          \"type\": \"https://witness.dev/attestations/command-run/v0.1\"\n        },\n        {\n          \"type\": \"https://witness.dev/attestations/product/v0.1\"\n        }\n      ],\n      \"functionaries\": [\n        {\n          \"type\": \"publickey\",\n          \"publickeyid\": \"ci-key\"\n        }\n      ]\n    },\n    \"test\": {\n      \"name\": \"test\",\n      \"attestations\": [\n        {\n          \"type\": \"https://witness.dev/attestations/material/v0.1\"\n        },\n        {\n          \"type\": \"https://witness.dev/attestations/command-run/v0.1\"\n        }\n      ],\n      \"functionaries\": [\n        {\n          \"type\": \"publickey\",\n          \"publickeyid\": \"ci-key\"\n        }\n      ]\n    },\n    \"package\": {\n      \"name\": \"package\",\n      \"attestations\": [\n        {\n          \"type\": \"https://witness.dev/attestations/material/v0.1\"\n        },\n        {\n          \"type\": \"https://witness.dev/attestations/product/v0.1\"\n        }\n      ],\n      \"functionaries\": [\n        {\n          \"type\": \"publickey\",\n          \"publickeyid\": \"ci-key\"\n        }\n      ]\n    }\n  }\n}\n```\n\n**Pipeline Commands:**\n\n```bash\n# Step 1: Build\nwitness run --step build \\\n  --attestations git,commandrun,product \\\n  -o build.json --key ci-key.pem \\\n  -- go build -o myapp\n\n# Step 2: Test\nwitness run --step test \\\n  --attestations material,commandrun \\\n  -o test.json --key ci-key.pem \\\n  -- go test ./...\n\n# Step 3: Package\nwitness run --step package \\\n  --attestations material,product \\\n  -o package.json --key ci-key.pem \\\n  -- tar czf myapp.tar.gz myapp\n\n# Verify entire pipeline\nwitness verify \\\n  --policy policy-signed.json \\\n  --publickey policy-key.pub \\\n  -a build.json -a test.json -a package.json\n```\n"}]}
{"messages": [{"role": "system", "content": "You are an expert in the Witness supply chain attestation framework. You help users instrument CI/CD pipelines with witness, create policy documents, and write Rego policies to validate attestations. You understand all attestors in go-witness and how to use them effectively."}, {"role": "user", "content": "How do I create a multi-step witness policy for a build \u2192 test \u2192 package pipeline?"}, {"role": "assistant", "content": "Here's a complete multi-step witness policy for your pipeline:\n\n**Policy Document:**\n```json\n{\n  \"expires\": \"2026-11-08T10:52:59Z\",\n  \"publickeys\": {\n    \"ci-key\": {\n      \"keyid\": \"sha256:ff2e0d9ad00e2fecfeb703d0c6c880918f6d4a009aa6c5456336ffd604b61cde\",\n      \"key\": \"-----BEGIN PUBLIC KEY-----\\n...\\n-----END PUBLIC KEY-----\"\n    }\n  },\n  \"steps\": {\n    \"build\": {\n      \"name\": \"build\",\n      \"attestations\": [\n        {\n          \"type\": \"https://witness.dev/attestations/git/v0.1\"\n        },\n        {\n          \"type\": \"https://witness.dev/attestations/command-run/v0.1\"\n        },\n        {\n          \"type\": \"https://witness.dev/attestations/product/v0.1\"\n        }\n      ],\n      \"functionaries\": [\n        {\n          \"type\": \"publickey\",\n          \"publickeyid\": \"ci-key\"\n        }\n      ]\n    },\n    \"test\": {\n      \"name\": \"test\",\n      \"attestations\": [\n        {\n          \"type\": \"https://witness.dev/attestations/material/v0.1\"\n        },\n        {\n          \"type\": \"https://witness.dev/attestations/command-run/v0.1\"\n        }\n      ],\n      \"functionaries\": [\n        {\n          \"type\": \"publickey\",\n          \"publickeyid\": \"ci-key\"\n        }\n      ]\n    },\n    \"package\": {\n      \"name\": \"package\",\n      \"attestations\": [\n        {\n          \"type\": \"https://witness.dev/attestations/material/v0.1\"\n        },\n        {\n          \"type\": \"https://witness.dev/attestations/product/v0.1\"\n        }\n      ],\n      \"functionaries\": [\n        {\n          \"type\": \"publickey\",\n          \"publickeyid\": \"ci-key\"\n        }\n      ]\n    }\n  }\n}\n```\n\n**Pipeline Commands:**\n\n```bash\n# Step 1: Build\nwitness run --step build \\\n  --attestations git,commandrun,product \\\n  -o build.json --key ci-key.pem \\\n  -- go build -o myapp\n\n# Step 2: Test\nwitness run --step test \\\n  --attestations material,commandrun \\\n  -o test.json --key ci-key.pem \\\n  -- go test ./...\n\n# Step 3: Package\nwitness run --step package \\\n  --attestations material,product \\\n  -o package.json --key ci-key.pem \\\n  -- tar czf myapp.tar.gz myapp\n\n# Verify entire pipeline\nwitness verify \\\n  --policy policy-signed.json \\\n  --publickey policy-key.pub \\\n  -a build.json -a test.json -a package.json\n```\n"}]}
{"messages": [{"role": "system", "content": "You are an expert in the Witness supply chain attestation framework. You help users instrument CI/CD pipelines with witness, create policy documents, and write Rego policies to validate attestations. You understand all attestors in go-witness and how to use them effectively."}, {"role": "user", "content": "How do I create a witness policy for a build step that uses these attestors: github, commandrun, product, material?"}, {"role": "assistant", "content": "Here's a complete witness policy for your build step with github, commandrun, product, material attestors:\n\n**Policy Document:**\n```json\n{\n  \"expires\": \"2026-11-08T10:52:59Z\",\n  \"publickeys\": {\n    \"build-key\": {\n      \"keyid\": \"sha256:3fdeaac92d3b7911e94d94a62306759fede60f501db174027ae584de2e9fe457\",\n      \"key\": \"-----BEGIN PUBLIC KEY-----\\n...\\n-----END PUBLIC KEY-----\"\n    }\n  },\n  \"steps\": {\n    \"build\": {\n      \"name\": \"build\",\n      \"attestations\": [\n        {\n          \"type\": \"https://witness.dev/attestations/github/v0.1\"\n        },\n        {\n          \"type\": \"https://witness.dev/attestations/command-run/v0.1\"\n        },\n        {\n          \"type\": \"https://witness.dev/attestations/product/v0.1\"\n        },\n        {\n          \"type\": \"https://witness.dev/attestations/material/v0.1\"\n        }\n      ],\n      \"functionaries\": [\n        {\n          \"type\": \"publickey\",\n          \"publickeyid\": \"build-key\"\n        }\n      ]\n    }\n  }\n}\n```\n\n**Witness Run Command:**\n```bash\nwitness run --step build \\\n  --attestations github,commandrun,product,material \\\n  --outfile build-attestation.json \\\n  --key signing-key.pem \\\n  -- <your-build-command>\n```\n\n**Rego Validation Rules:**\n```rego\n\n```\n\n**Verification:**\n```bash\nwitness verify \\\n  --policy policy-signed.json \\\n  --publickey policy-key.pub \\\n  -a build-attestation.json \\\n  --subject <artifact>\n```\n"}]}
{"messages": [{"role": "system", "content": "You are an expert in the Witness supply chain attestation framework. You help users instrument CI/CD pipelines with witness, create policy documents, and write Rego policies to validate attestations. You understand all attestors in go-witness and how to use them effectively."}, {"role": "user", "content": "How do I create a witness policy for a build step that uses these attestors: material, product, github, commandrun, environment?"}, {"role": "assistant", "content": "Here's a complete witness policy for your build step with material, product, github, commandrun, environment attestors:\n\n**Policy Document:**\n```json\n{\n  \"expires\": \"2026-11-08T10:52:59Z\",\n  \"publickeys\": {\n    \"build-key\": {\n      \"keyid\": \"sha256:fe58fe5030aaf75af6d9172be83a2b26e90be87292e930b64e63be54148d201b\",\n      \"key\": \"-----BEGIN PUBLIC KEY-----\\n...\\n-----END PUBLIC KEY-----\"\n    }\n  },\n  \"steps\": {\n    \"build\": {\n      \"name\": \"build\",\n      \"attestations\": [\n        {\n          \"type\": \"https://witness.dev/attestations/material/v0.1\"\n        },\n        {\n          \"type\": \"https://witness.dev/attestations/product/v0.1\"\n        },\n        {\n          \"type\": \"https://witness.dev/attestations/github/v0.1\"\n        },\n        {\n          \"type\": \"https://witness.dev/attestations/command-run/v0.1\"\n        },\n        {\n          \"type\": \"https://witness.dev/attestations/environment/v0.1\"\n        }\n      ],\n      \"functionaries\": [\n        {\n          \"type\": \"publickey\",\n          \"publickeyid\": \"build-key\"\n        }\n      ]\n    }\n  }\n}\n```\n\n**Witness Run Command:**\n```bash\nwitness run --step build \\\n  --attestations material,product,github,commandrun,environment \\\n  --outfile build-attestation.json \\\n  --key signing-key.pem \\\n  -- <your-build-command>\n```\n\n**Rego Validation Rules:**\n```rego\n\n```\n\n**Verification:**\n```bash\nwitness verify \\\n  --policy policy-signed.json \\\n  --publickey policy-key.pub \\\n  -a build-attestation.json \\\n  --subject <artifact>\n```\n"}]}
{"messages": [{"role": "system", "content": "You are an expert in the Witness supply chain attestation framework. You help users instrument CI/CD pipelines with witness, create policy documents, and write Rego policies to validate attestations. You understand all attestors in go-witness and how to use them effectively."}, {"role": "user", "content": "How do I create a witness policy for a build step that uses these attestors: github, commandrun, git, product, environment?"}, {"role": "assistant", "content": "Here's a complete witness policy for your build step with github, commandrun, git, product, environment attestors:\n\n**Policy Document:**\n```json\n{\n  \"expires\": \"2026-11-08T10:52:59Z\",\n  \"publickeys\": {\n    \"build-key\": {\n      \"keyid\": \"sha256:ae05e67c830ba847c466ff22129d2c78c01c70d0f67f64e8891e0325c83e5c99\",\n      \"key\": \"-----BEGIN PUBLIC KEY-----\\n...\\n-----END PUBLIC KEY-----\"\n    }\n  },\n  \"steps\": {\n    \"build\": {\n      \"name\": \"build\",\n      \"attestations\": [\n        {\n          \"type\": \"https://witness.dev/attestations/github/v0.1\"\n        },\n        {\n          \"type\": \"https://witness.dev/attestations/command-run/v0.1\"\n        },\n        {\n          \"type\": \"https://witness.dev/attestations/git/v0.1\"\n        },\n        {\n          \"type\": \"https://witness.dev/attestations/product/v0.1\"\n        },\n        {\n          \"type\": \"https://witness.dev/attestations/environment/v0.1\"\n        }\n      ],\n      \"functionaries\": [\n        {\n          \"type\": \"publickey\",\n          \"publickeyid\": \"build-key\"\n        }\n      ]\n    }\n  }\n}\n```\n\n**Witness Run Command:**\n```bash\nwitness run --step build \\\n  --attestations github,commandrun,git,product,environment \\\n  --outfile build-attestation.json \\\n  --key signing-key.pem \\\n  -- <your-build-command>\n```\n\n**Rego Validation Rules:**\n```rego\n\n```\n\n**Verification:**\n```bash\nwitness verify \\\n  --policy policy-signed.json \\\n  --publickey policy-key.pub \\\n  -a build-attestation.json \\\n  --subject <artifact>\n```\n"}]}
{"messages": [{"role": "system", "content": "You are an expert in the Witness supply chain attestation framework. You help users instrument CI/CD pipelines with witness, create policy documents, and write Rego policies to validate attestations. You understand all attestors in go-witness and how to use them effectively."}, {"role": "user", "content": "How do I create a multi-step witness policy for a build \u2192 test \u2192 package pipeline?"}, {"role": "assistant", "content": "Here's a complete multi-step witness policy for your pipeline:\n\n**Policy Document:**\n```json\n{\n  \"expires\": \"2026-11-08T10:52:59Z\",\n  \"publickeys\": {\n    \"ci-key\": {\n      \"keyid\": \"sha256:91ffacc0f5e519d299d16cf0beefe3b5239737a454d533e4412d0a2f6c1fb139\",\n      \"key\": \"-----BEGIN PUBLIC KEY-----\\n...\\n-----END PUBLIC KEY-----\"\n    }\n  },\n  \"steps\": {\n    \"build\": {\n      \"name\": \"build\",\n      \"attestations\": [\n        {\n          \"type\": \"https://witness.dev/attestations/git/v0.1\"\n        },\n        {\n          \"type\": \"https://witness.dev/attestations/command-run/v0.1\"\n        },\n        {\n          \"type\": \"https://witness.dev/attestations/product/v0.1\"\n        }\n      ],\n      \"functionaries\": [\n        {\n          \"type\": \"publickey\",\n          \"publickeyid\": \"ci-key\"\n        }\n      ]\n    },\n    \"test\": {\n      \"name\": \"test\",\n      \"attestations\": [\n        {\n          \"type\": \"https://witness.dev/attestations/material/v0.1\"\n        },\n        {\n          \"type\": \"https://witness.dev/attestations/command-run/v0.1\"\n        }\n      ],\n      \"functionaries\": [\n        {\n          \"type\": \"publickey\",\n          \"publickeyid\": \"ci-key\"\n        }\n      ]\n    },\n    \"package\": {\n      \"name\": \"package\",\n      \"attestations\": [\n        {\n          \"type\": \"https://witness.dev/attestations/material/v0.1\"\n        },\n        {\n          \"type\": \"https://witness.dev/attestations/product/v0.1\"\n        }\n      ],\n      \"functionaries\": [\n        {\n          \"type\": \"publickey\",\n          \"publickeyid\": \"ci-key\"\n        }\n      ]\n    }\n  }\n}\n```\n\n**Pipeline Commands:**\n\n```bash\n# Step 1: Build\nwitness run --step build \\\n  --attestations git,commandrun,product \\\n  -o build.json --key ci-key.pem \\\n  -- go build -o myapp\n\n# Step 2: Test\nwitness run --step test \\\n  --attestations material,commandrun \\\n  -o test.json --key ci-key.pem \\\n  -- go test ./...\n\n# Step 3: Package\nwitness run --step package \\\n  --attestations material,product \\\n  -o package.json --key ci-key.pem \\\n  -- tar czf myapp.tar.gz myapp\n\n# Verify entire pipeline\nwitness verify \\\n  --policy policy-signed.json \\\n  --publickey policy-key.pub \\\n  -a build.json -a test.json -a package.json\n```\n"}]}
{"messages": [{"role": "system", "content": "You are an expert in the Witness supply chain attestation framework. You help users instrument CI/CD pipelines with witness, create policy documents, and write Rego policies to validate attestations. You understand all attestors in go-witness and how to use them effectively."}, {"role": "user", "content": "How do I create a witness policy for a build step that uses these attestors: commandrun, environment?"}, {"role": "assistant", "content": "Here's a complete witness policy for your build step with commandrun, environment attestors:\n\n**Policy Document:**\n```json\n{\n  \"expires\": \"2026-11-08T10:52:59Z\",\n  \"publickeys\": {\n    \"build-key\": {\n      \"keyid\": \"sha256:33e3f996588677ce376555d9705c6a4e0783924ef7b0f92b335fa735c429b4a7\",\n      \"key\": \"-----BEGIN PUBLIC KEY-----\\n...\\n-----END PUBLIC KEY-----\"\n    }\n  },\n  \"steps\": {\n    \"build\": {\n      \"name\": \"build\",\n      \"attestations\": [\n        {\n          \"type\": \"https://witness.dev/attestations/command-run/v0.1\"\n        },\n        {\n          \"type\": \"https://witness.dev/attestations/environment/v0.1\"\n        }\n      ],\n      \"functionaries\": [\n        {\n          \"type\": \"publickey\",\n          \"publickeyid\": \"build-key\"\n        }\n      ]\n    }\n  }\n}\n```\n\n**Witness Run Command:**\n```bash\nwitness run --step build \\\n  --attestations commandrun,environment \\\n  --outfile build-attestation.json \\\n  --key signing-key.pem \\\n  -- <your-build-command>\n```\n\n**Rego Validation Rules:**\n```rego\n\n```\n\n**Verification:**\n```bash\nwitness verify \\\n  --policy policy-signed.json \\\n  --publickey policy-key.pub \\\n  -a build-attestation.json \\\n  --subject <artifact>\n```\n"}]}
{"messages": [{"role": "system", "content": "You are an expert in the Witness supply chain attestation framework. You help users instrument CI/CD pipelines with witness, create policy documents, and write Rego policies to validate attestations. You understand all attestors in go-witness and how to use them effectively."}, {"role": "user", "content": "How do I create a witness policy for a build step that uses these attestors: environment, material, commandrun, git, product?"}, {"role": "assistant", "content": "Here's a complete witness policy for your build step with environment, material, commandrun, git, product attestors:\n\n**Policy Document:**\n```json\n{\n  \"expires\": \"2026-11-08T10:52:59Z\",\n  \"publickeys\": {\n    \"build-key\": {\n      \"keyid\": \"sha256:e38441f4d9d0c5cc391058fb5a38edabf72a4e3ee752e7e318b52b10625d5efd\",\n      \"key\": \"-----BEGIN PUBLIC KEY-----\\n...\\n-----END PUBLIC KEY-----\"\n    }\n  },\n  \"steps\": {\n    \"build\": {\n      \"name\": \"build\",\n      \"attestations\": [\n        {\n          \"type\": \"https://witness.dev/attestations/environment/v0.1\"\n        },\n        {\n          \"type\": \"https://witness.dev/attestations/material/v0.1\"\n        },\n        {\n          \"type\": \"https://witness.dev/attestations/command-run/v0.1\"\n        },\n        {\n          \"type\": \"https://witness.dev/attestations/git/v0.1\"\n        },\n        {\n          \"type\": \"https://witness.dev/attestations/product/v0.1\"\n        }\n      ],\n      \"functionaries\": [\n        {\n          \"type\": \"publickey\",\n          \"publickeyid\": \"build-key\"\n        }\n      ]\n    }\n  }\n}\n```\n\n**Witness Run Command:**\n```bash\nwitness run --step build \\\n  --attestations environment,material,commandrun,git,product \\\n  --outfile build-attestation.json \\\n  --key signing-key.pem \\\n  -- <your-build-command>\n```\n\n**Rego Validation Rules:**\n```rego\npackage environment\n\nimport rego.v1\n\n# Ensure correct OS\ndeny contains msg if {\n    input.os != \"darwin\"\n    msg := sprintf(\"Must run on darwin, got: %s\", [input.os])\n}\n\n# Require CI environment\ndeny contains msg if {\n    not \"CI\" in input.variables\n    msg := \"Must run in CI environment (CI variable not set)\"\n}\n```\n\n**Verification:**\n```bash\nwitness verify \\\n  --policy policy-signed.json \\\n  --publickey policy-key.pub \\\n  -a build-attestation.json \\\n  --subject <artifact>\n```\n"}]}
{"messages": [{"role": "system", "content": "You are an expert in the Witness supply chain attestation framework. You help users instrument CI/CD pipelines with witness, create policy documents, and write Rego policies to validate attestations. You understand all attestors in go-witness and how to use them effectively."}, {"role": "user", "content": "How do I create a witness policy for a build step that uses these attestors: commandrun, product, environment, github, material?"}, {"role": "assistant", "content": "Here's a complete witness policy for your build step with commandrun, product, environment, github, material attestors:\n\n**Policy Document:**\n```json\n{\n  \"expires\": \"2026-11-08T10:52:59Z\",\n  \"publickeys\": {\n    \"build-key\": {\n      \"keyid\": \"sha256:fbead1d23b6cd8fe01736716c651a9e70e82ad17699b5658a1dec0da51c1a84c\",\n      \"key\": \"-----BEGIN PUBLIC KEY-----\\n...\\n-----END PUBLIC KEY-----\"\n    }\n  },\n  \"steps\": {\n    \"build\": {\n      \"name\": \"build\",\n      \"attestations\": [\n        {\n          \"type\": \"https://witness.dev/attestations/command-run/v0.1\"\n        },\n        {\n          \"type\": \"https://witness.dev/attestations/product/v0.1\"\n        },\n        {\n          \"type\": \"https://witness.dev/attestations/environment/v0.1\"\n        },\n        {\n          \"type\": \"https://witness.dev/attestations/github/v0.1\"\n        },\n        {\n          \"type\": \"https://witness.dev/attestations/material/v0.1\"\n        }\n      ],\n      \"functionaries\": [\n        {\n          \"type\": \"publickey\",\n          \"publickeyid\": \"build-key\"\n        }\n      ]\n    }\n  }\n}\n```\n\n**Witness Run Command:**\n```bash\nwitness run --step build \\\n  --attestations commandrun,product,environment,github,material \\\n  --outfile build-attestation.json \\\n  --key signing-key.pem \\\n  -- <your-build-command>\n```\n\n**Rego Validation Rules:**\n```rego\n\n```\n\n**Verification:**\n```bash\nwitness verify \\\n  --policy policy-signed.json \\\n  --publickey policy-key.pub \\\n  -a build-attestation.json \\\n  --subject <artifact>\n```\n"}]}
{"messages": [{"role": "system", "content": "You are an expert in the Witness supply chain attestation framework. You help users instrument CI/CD pipelines with witness, create policy documents, and write Rego policies to validate attestations. You understand all attestors in go-witness and how to use them effectively."}, {"role": "user", "content": "How do I create a witness policy for a build step that uses these attestors: commandrun, github, git, material?"}, {"role": "assistant", "content": "Here's a complete witness policy for your build step with commandrun, github, git, material attestors:\n\n**Policy Document:**\n```json\n{\n  \"expires\": \"2026-11-08T10:52:59Z\",\n  \"publickeys\": {\n    \"build-key\": {\n      \"keyid\": \"sha256:d738cd6fc22ce77a8392c30291af991cfc1b4dfdade8108c59b7d976d1416862\",\n      \"key\": \"-----BEGIN PUBLIC KEY-----\\n...\\n-----END PUBLIC KEY-----\"\n    }\n  },\n  \"steps\": {\n    \"build\": {\n      \"name\": \"build\",\n      \"attestations\": [\n        {\n          \"type\": \"https://witness.dev/attestations/command-run/v0.1\"\n        },\n        {\n          \"type\": \"https://witness.dev/attestations/github/v0.1\"\n        },\n        {\n          \"type\": \"https://witness.dev/attestations/git/v0.1\"\n        },\n        {\n          \"type\": \"https://witness.dev/attestations/material/v0.1\"\n        }\n      ],\n      \"functionaries\": [\n        {\n          \"type\": \"publickey\",\n          \"publickeyid\": \"build-key\"\n        }\n      ]\n    }\n  }\n}\n```\n\n**Witness Run Command:**\n```bash\nwitness run --step build \\\n  --attestations commandrun,github,git,material \\\n  --outfile build-attestation.json \\\n  --key signing-key.pem \\\n  -- <your-build-command>\n```\n\n**Rego Validation Rules:**\n```rego\n\n```\n\n**Verification:**\n```bash\nwitness verify \\\n  --policy policy-signed.json \\\n  --publickey policy-key.pub \\\n  -a build-attestation.json \\\n  --subject <artifact>\n```\n"}]}
{"messages": [{"role": "system", "content": "You are an expert in the Witness supply chain attestation framework. You help users instrument CI/CD pipelines with witness, create policy documents, and write Rego policies to validate attestations. You understand all attestors in go-witness and how to use them effectively."}, {"role": "user", "content": "How do I create a multi-step witness policy for a build \u2192 test \u2192 package pipeline?"}, {"role": "assistant", "content": "Here's a complete multi-step witness policy for your pipeline:\n\n**Policy Document:**\n```json\n{\n  \"expires\": \"2026-11-08T10:52:59Z\",\n  \"publickeys\": {\n    \"ci-key\": {\n      \"keyid\": \"sha256:28ae464e81096463f613ac9832c4969744a05aecfc7fa288ef09957966818bee\",\n      \"key\": \"-----BEGIN PUBLIC KEY-----\\n...\\n-----END PUBLIC KEY-----\"\n    }\n  },\n  \"steps\": {\n    \"build\": {\n      \"name\": \"build\",\n      \"attestations\": [\n        {\n          \"type\": \"https://witness.dev/attestations/git/v0.1\"\n        },\n        {\n          \"type\": \"https://witness.dev/attestations/command-run/v0.1\"\n        },\n        {\n          \"type\": \"https://witness.dev/attestations/product/v0.1\"\n        }\n      ],\n      \"functionaries\": [\n        {\n          \"type\": \"publickey\",\n          \"publickeyid\": \"ci-key\"\n        }\n      ]\n    },\n    \"test\": {\n      \"name\": \"test\",\n      \"attestations\": [\n        {\n          \"type\": \"https://witness.dev/attestations/material/v0.1\"\n        },\n        {\n          \"type\": \"https://witness.dev/attestations/command-run/v0.1\"\n        }\n      ],\n      \"functionaries\": [\n        {\n          \"type\": \"publickey\",\n          \"publickeyid\": \"ci-key\"\n        }\n      ]\n    },\n    \"package\": {\n      \"name\": \"package\",\n      \"attestations\": [\n        {\n          \"type\": \"https://witness.dev/attestations/material/v0.1\"\n        },\n        {\n          \"type\": \"https://witness.dev/attestations/product/v0.1\"\n        }\n      ],\n      \"functionaries\": [\n        {\n          \"type\": \"publickey\",\n          \"publickeyid\": \"ci-key\"\n        }\n      ]\n    }\n  }\n}\n```\n\n**Pipeline Commands:**\n\n```bash\n# Step 1: Build\nwitness run --step build \\\n  --attestations git,commandrun,product \\\n  -o build.json --key ci-key.pem \\\n  -- go build -o myapp\n\n# Step 2: Test\nwitness run --step test \\\n  --attestations material,commandrun \\\n  -o test.json --key ci-key.pem \\\n  -- go test ./...\n\n# Step 3: Package\nwitness run --step package \\\n  --attestations material,product \\\n  -o package.json --key ci-key.pem \\\n  -- tar czf myapp.tar.gz myapp\n\n# Verify entire pipeline\nwitness verify \\\n  --policy policy-signed.json \\\n  --publickey policy-key.pub \\\n  -a build.json -a test.json -a package.json\n```\n"}]}
{"messages": [{"role": "system", "content": "You are an expert in the Witness supply chain attestation framework. You help users instrument CI/CD pipelines with witness, create policy documents, and write Rego policies to validate attestations. You understand all attestors in go-witness and how to use them effectively."}, {"role": "user", "content": "How do I create a witness policy for a build step that uses these attestors: product?"}, {"role": "assistant", "content": "Here's a complete witness policy for your build step with product attestors:\n\n**Policy Document:**\n```json\n{\n  \"expires\": \"2026-11-08T10:52:59Z\",\n  \"publickeys\": {\n    \"build-key\": {\n      \"keyid\": \"sha256:6a0dcf9b49d8dc79e088bc07ed13f0420c48c4a2844bac82cdba0c35fc940960\",\n      \"key\": \"-----BEGIN PUBLIC KEY-----\\n...\\n-----END PUBLIC KEY-----\"\n    }\n  },\n  \"steps\": {\n    \"build\": {\n      \"name\": \"build\",\n      \"attestations\": [\n        {\n          \"type\": \"https://witness.dev/attestations/product/v0.1\"\n        }\n      ],\n      \"functionaries\": [\n        {\n          \"type\": \"publickey\",\n          \"publickeyid\": \"build-key\"\n        }\n      ]\n    }\n  }\n}\n```\n\n**Witness Run Command:**\n```bash\nwitness run --step build \\\n  --attestations product \\\n  --outfile build-attestation.json \\\n  --key signing-key.pem \\\n  -- <your-build-command>\n```\n\n**Rego Validation Rules:**\n```rego\n\n```\n\n**Verification:**\n```bash\nwitness verify \\\n  --policy policy-signed.json \\\n  --publickey policy-key.pub \\\n  -a build-attestation.json \\\n  --subject <artifact>\n```\n"}]}
{"messages": [{"role": "system", "content": "You are an expert in the Witness supply chain attestation framework. You help users instrument CI/CD pipelines with witness, create policy documents, and write Rego policies to validate attestations. You understand all attestors in go-witness and how to use them effectively."}, {"role": "user", "content": "How do I create a witness policy for a build step that uses these attestors: commandrun, environment, product, git?"}, {"role": "assistant", "content": "Here's a complete witness policy for your build step with commandrun, environment, product, git attestors:\n\n**Policy Document:**\n```json\n{\n  \"expires\": \"2026-11-08T10:52:59Z\",\n  \"publickeys\": {\n    \"build-key\": {\n      \"keyid\": \"sha256:69febf35f219d47b904f5b766568392a62ee56ccda26f682d76a459f36e62bd4\",\n      \"key\": \"-----BEGIN PUBLIC KEY-----\\n...\\n-----END PUBLIC KEY-----\"\n    }\n  },\n  \"steps\": {\n    \"build\": {\n      \"name\": \"build\",\n      \"attestations\": [\n        {\n          \"type\": \"https://witness.dev/attestations/command-run/v0.1\"\n        },\n        {\n          \"type\": \"https://witness.dev/attestations/environment/v0.1\"\n        },\n        {\n          \"type\": \"https://witness.dev/attestations/product/v0.1\"\n        },\n        {\n          \"type\": \"https://witness.dev/attestations/git/v0.1\"\n        }\n      ],\n      \"functionaries\": [\n        {\n          \"type\": \"publickey\",\n          \"publickeyid\": \"build-key\"\n        }\n      ]\n    }\n  }\n}\n```\n\n**Witness Run Command:**\n```bash\nwitness run --step build \\\n  --attestations commandrun,environment,product,git \\\n  --outfile build-attestation.json \\\n  --key signing-key.pem \\\n  -- <your-build-command>\n```\n\n**Rego Validation Rules:**\n```rego\n\n```\n\n**Verification:**\n```bash\nwitness verify \\\n  --policy policy-signed.json \\\n  --publickey policy-key.pub \\\n  -a build-attestation.json \\\n  --subject <artifact>\n```\n"}]}
{"messages": [{"role": "system", "content": "You are an expert in the Witness supply chain attestation framework. You help users instrument CI/CD pipelines with witness, create policy documents, and write Rego policies to validate attestations. You understand all attestors in go-witness and how to use them effectively."}, {"role": "user", "content": "How do I create a multi-step witness policy for a build \u2192 test \u2192 package pipeline?"}, {"role": "assistant", "content": "Here's a complete multi-step witness policy for your pipeline:\n\n**Policy Document:**\n```json\n{\n  \"expires\": \"2026-11-08T10:52:59Z\",\n  \"publickeys\": {\n    \"ci-key\": {\n      \"keyid\": \"sha256:47ad6c86182fbe3087b2aca8e3f351b5149759ca2584e1642b65f6870d7c6955\",\n      \"key\": \"-----BEGIN PUBLIC KEY-----\\n...\\n-----END PUBLIC KEY-----\"\n    }\n  },\n  \"steps\": {\n    \"build\": {\n      \"name\": \"build\",\n      \"attestations\": [\n        {\n          \"type\": \"https://witness.dev/attestations/git/v0.1\"\n        },\n        {\n          \"type\": \"https://witness.dev/attestations/command-run/v0.1\"\n        },\n        {\n          \"type\": \"https://witness.dev/attestations/product/v0.1\"\n        }\n      ],\n      \"functionaries\": [\n        {\n          \"type\": \"publickey\",\n          \"publickeyid\": \"ci-key\"\n        }\n      ]\n    },\n    \"test\": {\n      \"name\": \"test\",\n      \"attestations\": [\n        {\n          \"type\": \"https://witness.dev/attestations/material/v0.1\"\n        },\n        {\n          \"type\": \"https://witness.dev/attestations/command-run/v0.1\"\n        }\n      ],\n      \"functionaries\": [\n        {\n          \"type\": \"publickey\",\n          \"publickeyid\": \"ci-key\"\n        }\n      ]\n    },\n    \"package\": {\n      \"name\": \"package\",\n      \"attestations\": [\n        {\n          \"type\": \"https://witness.dev/attestations/material/v0.1\"\n        },\n        {\n          \"type\": \"https://witness.dev/attestations/product/v0.1\"\n        }\n      ],\n      \"functionaries\": [\n        {\n          \"type\": \"publickey\",\n          \"publickeyid\": \"ci-key\"\n        }\n      ]\n    }\n  }\n}\n```\n\n**Pipeline Commands:**\n\n```bash\n# Step 1: Build\nwitness run --step build \\\n  --attestations git,commandrun,product \\\n  -o build.json --key ci-key.pem \\\n  -- go build -o myapp\n\n# Step 2: Test\nwitness run --step test \\\n  --attestations material,commandrun \\\n  -o test.json --key ci-key.pem \\\n  -- go test ./...\n\n# Step 3: Package\nwitness run --step package \\\n  --attestations material,product \\\n  -o package.json --key ci-key.pem \\\n  -- tar czf myapp.tar.gz myapp\n\n# Verify entire pipeline\nwitness verify \\\n  --policy policy-signed.json \\\n  --publickey policy-key.pub \\\n  -a build.json -a test.json -a package.json\n```\n"}]}
{"messages": [{"role": "system", "content": "You are an expert in the Witness supply chain attestation framework. You help users instrument CI/CD pipelines with witness, create policy documents, and write Rego policies to validate attestations. You understand all attestors in go-witness and how to use them effectively."}, {"role": "user", "content": "How do I create a witness policy for a build step that uses these attestors: environment, git, github, product, commandrun?"}, {"role": "assistant", "content": "Here's a complete witness policy for your build step with environment, git, github, product, commandrun attestors:\n\n**Policy Document:**\n```json\n{\n  \"expires\": \"2026-11-08T10:52:59Z\",\n  \"publickeys\": {\n    \"build-key\": {\n      \"keyid\": \"sha256:cc7af86bc2c2a0792d7a50989fed40ba2a8ef9783fa303fc73ffc370b34c2b34\",\n      \"key\": \"-----BEGIN PUBLIC KEY-----\\n...\\n-----END PUBLIC KEY-----\"\n    }\n  },\n  \"steps\": {\n    \"build\": {\n      \"name\": \"build\",\n      \"attestations\": [\n        {\n          \"type\": \"https://witness.dev/attestations/environment/v0.1\"\n        },\n        {\n          \"type\": \"https://witness.dev/attestations/git/v0.1\"\n        },\n        {\n          \"type\": \"https://witness.dev/attestations/github/v0.1\"\n        },\n        {\n          \"type\": \"https://witness.dev/attestations/product/v0.1\"\n        },\n        {\n          \"type\": \"https://witness.dev/attestations/command-run/v0.1\"\n        }\n      ],\n      \"functionaries\": [\n        {\n          \"type\": \"publickey\",\n          \"publickeyid\": \"build-key\"\n        }\n      ]\n    }\n  }\n}\n```\n\n**Witness Run Command:**\n```bash\nwitness run --step build \\\n  --attestations environment,git,github,product,commandrun \\\n  --outfile build-attestation.json \\\n  --key signing-key.pem \\\n  -- <your-build-command>\n```\n\n**Rego Validation Rules:**\n```rego\npackage environment\n\nimport rego.v1\n\n# Ensure correct OS\ndeny contains msg if {\n    input.os != \"darwin\"\n    msg := sprintf(\"Must run on darwin, got: %s\", [input.os])\n}\n\n# Require CI environment\ndeny contains msg if {\n    not \"CI\" in input.variables\n    msg := \"Must run in CI environment (CI variable not set)\"\n}\n```\n\n**Verification:**\n```bash\nwitness verify \\\n  --policy policy-signed.json \\\n  --publickey policy-key.pub \\\n  -a build-attestation.json \\\n  --subject <artifact>\n```\n"}]}
{"messages": [{"role": "system", "content": "You are an expert in the Witness supply chain attestation framework. You help users instrument CI/CD pipelines with witness, create policy documents, and write Rego policies to validate attestations. You understand all attestors in go-witness and how to use them effectively."}, {"role": "user", "content": "How do I create a multi-step witness policy for a build \u2192 test \u2192 package pipeline?"}, {"role": "assistant", "content": "Here's a complete multi-step witness policy for your pipeline:\n\n**Policy Document:**\n```json\n{\n  \"expires\": \"2026-11-08T10:52:59Z\",\n  \"publickeys\": {\n    \"ci-key\": {\n      \"keyid\": \"sha256:1d8dd6016d68603263cf838529519a52d187065086f27e3a3f9fd2bfee84bdfa\",\n      \"key\": \"-----BEGIN PUBLIC KEY-----\\n...\\n-----END PUBLIC KEY-----\"\n    }\n  },\n  \"steps\": {\n    \"build\": {\n      \"name\": \"build\",\n      \"attestations\": [\n        {\n          \"type\": \"https://witness.dev/attestations/git/v0.1\"\n        },\n        {\n          \"type\": \"https://witness.dev/attestations/command-run/v0.1\"\n        },\n        {\n          \"type\": \"https://witness.dev/attestations/product/v0.1\"\n        }\n      ],\n      \"functionaries\": [\n        {\n          \"type\": \"publickey\",\n          \"publickeyid\": \"ci-key\"\n        }\n      ]\n    },\n    \"test\": {\n      \"name\": \"test\",\n      \"attestations\": [\n        {\n          \"type\": \"https://witness.dev/attestations/material/v0.1\"\n        },\n        {\n          \"type\": \"https://witness.dev/attestations/command-run/v0.1\"\n        }\n      ],\n      \"functionaries\": [\n        {\n          \"type\": \"publickey\",\n          \"publickeyid\": \"ci-key\"\n        }\n      ]\n    },\n    \"package\": {\n      \"name\": \"package\",\n      \"attestations\": [\n        {\n          \"type\": \"https://witness.dev/attestations/material/v0.1\"\n        },\n        {\n          \"type\": \"https://witness.dev/attestations/product/v0.1\"\n        }\n      ],\n      \"functionaries\": [\n        {\n          \"type\": \"publickey\",\n          \"publickeyid\": \"ci-key\"\n        }\n      ]\n    }\n  }\n}\n```\n\n**Pipeline Commands:**\n\n```bash\n# Step 1: Build\nwitness run --step build \\\n  --attestations git,commandrun,product \\\n  -o build.json --key ci-key.pem \\\n  -- go build -o myapp\n\n# Step 2: Test\nwitness run --step test \\\n  --attestations material,commandrun \\\n  -o test.json --key ci-key.pem \\\n  -- go test ./...\n\n# Step 3: Package\nwitness run --step package \\\n  --attestations material,product \\\n  -o package.json --key ci-key.pem \\\n  -- tar czf myapp.tar.gz myapp\n\n# Verify entire pipeline\nwitness verify \\\n  --policy policy-signed.json \\\n  --publickey policy-key.pub \\\n  -a build.json -a test.json -a package.json\n```\n"}]}
{"messages": [{"role": "system", "content": "You are an expert in the Witness supply chain attestation framework. You help users instrument CI/CD pipelines with witness, create policy documents, and write Rego policies to validate attestations. You understand all attestors in go-witness and how to use them effectively."}, {"role": "user", "content": "How do I create a multi-step witness policy for a build \u2192 test \u2192 package pipeline?"}, {"role": "assistant", "content": "Here's a complete multi-step witness policy for your pipeline:\n\n**Policy Document:**\n```json\n{\n  \"expires\": \"2026-11-08T10:52:59Z\",\n  \"publickeys\": {\n    \"ci-key\": {\n      \"keyid\": \"sha256:f2158cf9db2d700b7b1fb5770f425e258c316d349049023a4c8b97b9a6917c21\",\n      \"key\": \"-----BEGIN PUBLIC KEY-----\\n...\\n-----END PUBLIC KEY-----\"\n    }\n  },\n  \"steps\": {\n    \"build\": {\n      \"name\": \"build\",\n      \"attestations\": [\n        {\n          \"type\": \"https://witness.dev/attestations/git/v0.1\"\n        },\n        {\n          \"type\": \"https://witness.dev/attestations/command-run/v0.1\"\n        },\n        {\n          \"type\": \"https://witness.dev/attestations/product/v0.1\"\n        }\n      ],\n      \"functionaries\": [\n        {\n          \"type\": \"publickey\",\n          \"publickeyid\": \"ci-key\"\n        }\n      ]\n    },\n    \"test\": {\n      \"name\": \"test\",\n      \"attestations\": [\n        {\n          \"type\": \"https://witness.dev/attestations/material/v0.1\"\n        },\n        {\n          \"type\": \"https://witness.dev/attestations/command-run/v0.1\"\n        }\n      ],\n      \"functionaries\": [\n        {\n          \"type\": \"publickey\",\n          \"publickeyid\": \"ci-key\"\n        }\n      ]\n    },\n    \"package\": {\n      \"name\": \"package\",\n      \"attestations\": [\n        {\n          \"type\": \"https://witness.dev/attestations/material/v0.1\"\n        },\n        {\n          \"type\": \"https://witness.dev/attestations/product/v0.1\"\n        }\n      ],\n      \"functionaries\": [\n        {\n          \"type\": \"publickey\",\n          \"publickeyid\": \"ci-key\"\n        }\n      ]\n    }\n  }\n}\n```\n\n**Pipeline Commands:**\n\n```bash\n# Step 1: Build\nwitness run --step build \\\n  --attestations git,commandrun,product \\\n  -o build.json --key ci-key.pem \\\n  -- go build -o myapp\n\n# Step 2: Test\nwitness run --step test \\\n  --attestations material,commandrun \\\n  -o test.json --key ci-key.pem \\\n  -- go test ./...\n\n# Step 3: Package\nwitness run --step package \\\n  --attestations material,product \\\n  -o package.json --key ci-key.pem \\\n  -- tar czf myapp.tar.gz myapp\n\n# Verify entire pipeline\nwitness verify \\\n  --policy policy-signed.json \\\n  --publickey policy-key.pub \\\n  -a build.json -a test.json -a package.json\n```\n"}]}
{"messages": [{"role": "system", "content": "You are an expert in the Witness supply chain attestation framework. You help users instrument CI/CD pipelines with witness, create policy documents, and write Rego policies to validate attestations. You understand all attestors in go-witness and how to use them effectively."}, {"role": "user", "content": "How do I create a witness policy for a build step that uses these attestors: environment, commandrun, product, material, github?"}, {"role": "assistant", "content": "Here's a complete witness policy for your build step with environment, commandrun, product, material, github attestors:\n\n**Policy Document:**\n```json\n{\n  \"expires\": \"2026-11-08T10:52:59Z\",\n  \"publickeys\": {\n    \"build-key\": {\n      \"keyid\": \"sha256:627e297173240d10bddd97c14d54872780826194fad70d8eecf0375ea238b699\",\n      \"key\": \"-----BEGIN PUBLIC KEY-----\\n...\\n-----END PUBLIC KEY-----\"\n    }\n  },\n  \"steps\": {\n    \"build\": {\n      \"name\": \"build\",\n      \"attestations\": [\n        {\n          \"type\": \"https://witness.dev/attestations/environment/v0.1\"\n        },\n        {\n          \"type\": \"https://witness.dev/attestations/command-run/v0.1\"\n        },\n        {\n          \"type\": \"https://witness.dev/attestations/product/v0.1\"\n        },\n        {\n          \"type\": \"https://witness.dev/attestations/material/v0.1\"\n        },\n        {\n          \"type\": \"https://witness.dev/attestations/github/v0.1\"\n        }\n      ],\n      \"functionaries\": [\n        {\n          \"type\": \"publickey\",\n          \"publickeyid\": \"build-key\"\n        }\n      ]\n    }\n  }\n}\n```\n\n**Witness Run Command:**\n```bash\nwitness run --step build \\\n  --attestations environment,commandrun,product,material,github \\\n  --outfile build-attestation.json \\\n  --key signing-key.pem \\\n  -- <your-build-command>\n```\n\n**Rego Validation Rules:**\n```rego\npackage environment\n\nimport rego.v1\n\n# Ensure correct OS\ndeny contains msg if {\n    input.os != \"linux\"\n    msg := sprintf(\"Must run on linux, got: %s\", [input.os])\n}\n\n# Require CI environment\ndeny contains msg if {\n    not \"CI\" in input.variables\n    msg := \"Must run in CI environment (CI variable not set)\"\n}\n```\n\n**Verification:**\n```bash\nwitness verify \\\n  --policy policy-signed.json \\\n  --publickey policy-key.pub \\\n  -a build-attestation.json \\\n  --subject <artifact>\n```\n"}]}
{"messages": [{"role": "system", "content": "You are an expert in the Witness supply chain attestation framework. You help users instrument CI/CD pipelines with witness, create policy documents, and write Rego policies to validate attestations. You understand all attestors in go-witness and how to use them effectively."}, {"role": "user", "content": "How do I create a multi-step witness policy for a build \u2192 test \u2192 package pipeline?"}, {"role": "assistant", "content": "Here's a complete multi-step witness policy for your pipeline:\n\n**Policy Document:**\n```json\n{\n  \"expires\": \"2026-11-08T10:52:59Z\",\n  \"publickeys\": {\n    \"ci-key\": {\n      \"keyid\": \"sha256:56db327010a2bf0addf1dff4381220ad7999ff8d3b04e2c2e521495a2d2f2c79\",\n      \"key\": \"-----BEGIN PUBLIC KEY-----\\n...\\n-----END PUBLIC KEY-----\"\n    }\n  },\n  \"steps\": {\n    \"build\": {\n      \"name\": \"build\",\n      \"attestations\": [\n        {\n          \"type\": \"https://witness.dev/attestations/git/v0.1\"\n        },\n        {\n          \"type\": \"https://witness.dev/attestations/command-run/v0.1\"\n        },\n        {\n          \"type\": \"https://witness.dev/attestations/product/v0.1\"\n        }\n      ],\n      \"functionaries\": [\n        {\n          \"type\": \"publickey\",\n          \"publickeyid\": \"ci-key\"\n        }\n      ]\n    },\n    \"test\": {\n      \"name\": \"test\",\n      \"attestations\": [\n        {\n          \"type\": \"https://witness.dev/attestations/material/v0.1\"\n        },\n        {\n          \"type\": \"https://witness.dev/attestations/command-run/v0.1\"\n        }\n      ],\n      \"functionaries\": [\n        {\n          \"type\": \"publickey\",\n          \"publickeyid\": \"ci-key\"\n        }\n      ]\n    },\n    \"package\": {\n      \"name\": \"package\",\n      \"attestations\": [\n        {\n          \"type\": \"https://witness.dev/attestations/material/v0.1\"\n        },\n        {\n          \"type\": \"https://witness.dev/attestations/product/v0.1\"\n        }\n      ],\n      \"functionaries\": [\n        {\n          \"type\": \"publickey\",\n          \"publickeyid\": \"ci-key\"\n        }\n      ]\n    }\n  }\n}\n```\n\n**Pipeline Commands:**\n\n```bash\n# Step 1: Build\nwitness run --step build \\\n  --attestations git,commandrun,product \\\n  -o build.json --key ci-key.pem \\\n  -- go build -o myapp\n\n# Step 2: Test\nwitness run --step test \\\n  --attestations material,commandrun \\\n  -o test.json --key ci-key.pem \\\n  -- go test ./...\n\n# Step 3: Package\nwitness run --step package \\\n  --attestations material,product \\\n  -o package.json --key ci-key.pem \\\n  -- tar czf myapp.tar.gz myapp\n\n# Verify entire pipeline\nwitness verify \\\n  --policy policy-signed.json \\\n  --publickey policy-key.pub \\\n  -a build.json -a test.json -a package.json\n```\n"}]}
{"messages": [{"role": "system", "content": "You are an expert in the Witness supply chain attestation framework. You help users instrument CI/CD pipelines with witness, create policy documents, and write Rego policies to validate attestations. You understand all attestors in go-witness and how to use them effectively."}, {"role": "user", "content": "How do I create a multi-step witness policy for a build \u2192 test \u2192 package pipeline?"}, {"role": "assistant", "content": "Here's a complete multi-step witness policy for your pipeline:\n\n**Policy Document:**\n```json\n{\n  \"expires\": \"2026-11-08T10:52:59Z\",\n  \"publickeys\": {\n    \"ci-key\": {\n      \"keyid\": \"sha256:1b0e2cf225f91613059afd1bcabde0b14764e14ce91e7969e7a7a486f04ea6f1\",\n      \"key\": \"-----BEGIN PUBLIC KEY-----\\n...\\n-----END PUBLIC KEY-----\"\n    }\n  },\n  \"steps\": {\n    \"build\": {\n      \"name\": \"build\",\n      \"attestations\": [\n        {\n          \"type\": \"https://witness.dev/attestations/git/v0.1\"\n        },\n        {\n          \"type\": \"https://witness.dev/attestations/command-run/v0.1\"\n        },\n        {\n          \"type\": \"https://witness.dev/attestations/product/v0.1\"\n        }\n      ],\n      \"functionaries\": [\n        {\n          \"type\": \"publickey\",\n          \"publickeyid\": \"ci-key\"\n        }\n      ]\n    },\n    \"test\": {\n      \"name\": \"test\",\n      \"attestations\": [\n        {\n          \"type\": \"https://witness.dev/attestations/material/v0.1\"\n        },\n        {\n          \"type\": \"https://witness.dev/attestations/command-run/v0.1\"\n        }\n      ],\n      \"functionaries\": [\n        {\n          \"type\": \"publickey\",\n          \"publickeyid\": \"ci-key\"\n        }\n      ]\n    },\n    \"package\": {\n      \"name\": \"package\",\n      \"attestations\": [\n        {\n          \"type\": \"https://witness.dev/attestations/material/v0.1\"\n        },\n        {\n          \"type\": \"https://witness.dev/attestations/product/v0.1\"\n        }\n      ],\n      \"functionaries\": [\n        {\n          \"type\": \"publickey\",\n          \"publickeyid\": \"ci-key\"\n        }\n      ]\n    }\n  }\n}\n```\n\n**Pipeline Commands:**\n\n```bash\n# Step 1: Build\nwitness run --step build \\\n  --attestations git,commandrun,product \\\n  -o build.json --key ci-key.pem \\\n  -- go build -o myapp\n\n# Step 2: Test\nwitness run --step test \\\n  --attestations material,commandrun \\\n  -o test.json --key ci-key.pem \\\n  -- go test ./...\n\n# Step 3: Package\nwitness run --step package \\\n  --attestations material,product \\\n  -o package.json --key ci-key.pem \\\n  -- tar czf myapp.tar.gz myapp\n\n# Verify entire pipeline\nwitness verify \\\n  --policy policy-signed.json \\\n  --publickey policy-key.pub \\\n  -a build.json -a test.json -a package.json\n```\n"}]}
{"messages": [{"role": "system", "content": "You are an expert in the Witness supply chain attestation framework. You help users instrument CI/CD pipelines with witness, create policy documents, and write Rego policies to validate attestations. You understand all attestors in go-witness and how to use them effectively."}, {"role": "user", "content": "How do I create a witness policy for a build step that uses these attestors: material, git?"}, {"role": "assistant", "content": "Here's a complete witness policy for your build step with material, git attestors:\n\n**Policy Document:**\n```json\n{\n  \"expires\": \"2026-11-08T10:52:59Z\",\n  \"publickeys\": {\n    \"build-key\": {\n      \"keyid\": \"sha256:990e03835e92286e52bb802e598712ac38823f3b365ab207fd6dadbf511b711a\",\n      \"key\": \"-----BEGIN PUBLIC KEY-----\\n...\\n-----END PUBLIC KEY-----\"\n    }\n  },\n  \"steps\": {\n    \"build\": {\n      \"name\": \"build\",\n      \"attestations\": [\n        {\n          \"type\": \"https://witness.dev/attestations/material/v0.1\"\n        },\n        {\n          \"type\": \"https://witness.dev/attestations/git/v0.1\"\n        }\n      ],\n      \"functionaries\": [\n        {\n          \"type\": \"publickey\",\n          \"publickeyid\": \"build-key\"\n        }\n      ]\n    }\n  }\n}\n```\n\n**Witness Run Command:**\n```bash\nwitness run --step build \\\n  --attestations material,git \\\n  --outfile build-attestation.json \\\n  --key signing-key.pem \\\n  -- <your-build-command>\n```\n\n**Rego Validation Rules:**\n```rego\n\n```\n\n**Verification:**\n```bash\nwitness verify \\\n  --policy policy-signed.json \\\n  --publickey policy-key.pub \\\n  -a build-attestation.json \\\n  --subject <artifact>\n```\n"}]}
{"messages": [{"role": "system", "content": "You are an expert in the Witness supply chain attestation framework. You help users instrument CI/CD pipelines with witness, create policy documents, and write Rego policies to validate attestations. You understand all attestors in go-witness and how to use them effectively."}, {"role": "user", "content": "How do I create a witness policy for a build step that uses these attestors: product?"}, {"role": "assistant", "content": "Here's a complete witness policy for your build step with product attestors:\n\n**Policy Document:**\n```json\n{\n  \"expires\": \"2026-11-08T10:52:59Z\",\n  \"publickeys\": {\n    \"build-key\": {\n      \"keyid\": \"sha256:3bec0445b19bd9bc5beda18cdb72aa2b402a0168616a1a450989e8d9a91a2786\",\n      \"key\": \"-----BEGIN PUBLIC KEY-----\\n...\\n-----END PUBLIC KEY-----\"\n    }\n  },\n  \"steps\": {\n    \"build\": {\n      \"name\": \"build\",\n      \"attestations\": [\n        {\n          \"type\": \"https://witness.dev/attestations/product/v0.1\"\n        }\n      ],\n      \"functionaries\": [\n        {\n          \"type\": \"publickey\",\n          \"publickeyid\": \"build-key\"\n        }\n      ]\n    }\n  }\n}\n```\n\n**Witness Run Command:**\n```bash\nwitness run --step build \\\n  --attestations product \\\n  --outfile build-attestation.json \\\n  --key signing-key.pem \\\n  -- <your-build-command>\n```\n\n**Rego Validation Rules:**\n```rego\n\n```\n\n**Verification:**\n```bash\nwitness verify \\\n  --policy policy-signed.json \\\n  --publickey policy-key.pub \\\n  -a build-attestation.json \\\n  --subject <artifact>\n```\n"}]}
{"messages": [{"role": "system", "content": "You are an expert in the Witness supply chain attestation framework. You help users instrument CI/CD pipelines with witness, create policy documents, and write Rego policies to validate attestations. You understand all attestors in go-witness and how to use them effectively."}, {"role": "user", "content": "How do I create a multi-step witness policy for a build \u2192 test \u2192 package pipeline?"}, {"role": "assistant", "content": "Here's a complete multi-step witness policy for your pipeline:\n\n**Policy Document:**\n```json\n{\n  \"expires\": \"2026-11-08T10:52:59Z\",\n  \"publickeys\": {\n    \"ci-key\": {\n      \"keyid\": \"sha256:d1b9345dd29a1e214092f3c69901584e1b2cbc0d6f929cd2aac44da0ae5b19ba\",\n      \"key\": \"-----BEGIN PUBLIC KEY-----\\n...\\n-----END PUBLIC KEY-----\"\n    }\n  },\n  \"steps\": {\n    \"build\": {\n      \"name\": \"build\",\n      \"attestations\": [\n        {\n          \"type\": \"https://witness.dev/attestations/git/v0.1\"\n        },\n        {\n          \"type\": \"https://witness.dev/attestations/command-run/v0.1\"\n        },\n        {\n          \"type\": \"https://witness.dev/attestations/product/v0.1\"\n        }\n      ],\n      \"functionaries\": [\n        {\n          \"type\": \"publickey\",\n          \"publickeyid\": \"ci-key\"\n        }\n      ]\n    },\n    \"test\": {\n      \"name\": \"test\",\n      \"attestations\": [\n        {\n          \"type\": \"https://witness.dev/attestations/material/v0.1\"\n        },\n        {\n          \"type\": \"https://witness.dev/attestations/command-run/v0.1\"\n        }\n      ],\n      \"functionaries\": [\n        {\n          \"type\": \"publickey\",\n          \"publickeyid\": \"ci-key\"\n        }\n      ]\n    },\n    \"package\": {\n      \"name\": \"package\",\n      \"attestations\": [\n        {\n          \"type\": \"https://witness.dev/attestations/material/v0.1\"\n        },\n        {\n          \"type\": \"https://witness.dev/attestations/product/v0.1\"\n        }\n      ],\n      \"functionaries\": [\n        {\n          \"type\": \"publickey\",\n          \"publickeyid\": \"ci-key\"\n        }\n      ]\n    }\n  }\n}\n```\n\n**Pipeline Commands:**\n\n```bash\n# Step 1: Build\nwitness run --step build \\\n  --attestations git,commandrun,product \\\n  -o build.json --key ci-key.pem \\\n  -- go build -o myapp\n\n# Step 2: Test\nwitness run --step test \\\n  --attestations material,commandrun \\\n  -o test.json --key ci-key.pem \\\n  -- go test ./...\n\n# Step 3: Package\nwitness run --step package \\\n  --attestations material,product \\\n  -o package.json --key ci-key.pem \\\n  -- tar czf myapp.tar.gz myapp\n\n# Verify entire pipeline\nwitness verify \\\n  --policy policy-signed.json \\\n  --publickey policy-key.pub \\\n  -a build.json -a test.json -a package.json\n```\n"}]}
{"messages": [{"role": "system", "content": "You are an expert in the Witness supply chain attestation framework. You help users instrument CI/CD pipelines with witness, create policy documents, and write Rego policies to validate attestations. You understand all attestors in go-witness and how to use them effectively."}, {"role": "user", "content": "How do I create a witness policy for a build step that uses these attestors: material, git, commandrun?"}, {"role": "assistant", "content": "Here's a complete witness policy for your build step with material, git, commandrun attestors:\n\n**Policy Document:**\n```json\n{\n  \"expires\": \"2026-11-08T10:52:59Z\",\n  \"publickeys\": {\n    \"build-key\": {\n      \"keyid\": \"sha256:0972d78d0c812ba0c143cc9f3721990032b7cf89413b543d0490751cde27d19d\",\n      \"key\": \"-----BEGIN PUBLIC KEY-----\\n...\\n-----END PUBLIC KEY-----\"\n    }\n  },\n  \"steps\": {\n    \"build\": {\n      \"name\": \"build\",\n      \"attestations\": [\n        {\n          \"type\": \"https://witness.dev/attestations/material/v0.1\"\n        },\n        {\n          \"type\": \"https://witness.dev/attestations/git/v0.1\"\n        },\n        {\n          \"type\": \"https://witness.dev/attestations/command-run/v0.1\"\n        }\n      ],\n      \"functionaries\": [\n        {\n          \"type\": \"publickey\",\n          \"publickeyid\": \"build-key\"\n        }\n      ]\n    }\n  }\n}\n```\n\n**Witness Run Command:**\n```bash\nwitness run --step build \\\n  --attestations material,git,commandrun \\\n  --outfile build-attestation.json \\\n  --key signing-key.pem \\\n  -- <your-build-command>\n```\n\n**Rego Validation Rules:**\n```rego\n\n```\n\n**Verification:**\n```bash\nwitness verify \\\n  --policy policy-signed.json \\\n  --publickey policy-key.pub \\\n  -a build-attestation.json \\\n  --subject <artifact>\n```\n"}]}
{"messages": [{"role": "system", "content": "You are an expert in the Witness supply chain attestation framework. You help users instrument CI/CD pipelines with witness, create policy documents, and write Rego policies to validate attestations. You understand all attestors in go-witness and how to use them effectively."}, {"role": "user", "content": "How do I create a witness policy for a build step that uses these attestors: git, product, environment?"}, {"role": "assistant", "content": "Here's a complete witness policy for your build step with git, product, environment attestors:\n\n**Policy Document:**\n```json\n{\n  \"expires\": \"2026-11-08T10:52:59Z\",\n  \"publickeys\": {\n    \"build-key\": {\n      \"keyid\": \"sha256:e39cfa43b9f12bf86be13893914199b5b75c133a46e230a21a27d2abf1bca875\",\n      \"key\": \"-----BEGIN PUBLIC KEY-----\\n...\\n-----END PUBLIC KEY-----\"\n    }\n  },\n  \"steps\": {\n    \"build\": {\n      \"name\": \"build\",\n      \"attestations\": [\n        {\n          \"type\": \"https://witness.dev/attestations/git/v0.1\"\n        },\n        {\n          \"type\": \"https://witness.dev/attestations/product/v0.1\"\n        },\n        {\n          \"type\": \"https://witness.dev/attestations/environment/v0.1\"\n        }\n      ],\n      \"functionaries\": [\n        {\n          \"type\": \"publickey\",\n          \"publickeyid\": \"build-key\"\n        }\n      ]\n    }\n  }\n}\n```\n\n**Witness Run Command:**\n```bash\nwitness run --step build \\\n  --attestations git,product,environment \\\n  --outfile build-attestation.json \\\n  --key signing-key.pem \\\n  -- <your-build-command>\n```\n\n**Rego Validation Rules:**\n```rego\npackage git\n\nimport rego.v1\n\n# Enforce builds from specific branch\ndeny contains msg if {\n    input.branch != \"bugfix/security\"\n    msg := sprintf(\"Must build from bugfix/security branch, got: %s\", [input.branch])\n}\n\n# Validate commit author\napproved_authors := {\n    \"alice.smith@example.com\",\n    \"bob.jones@company.com\",\n    \"ci-bot@company.com\"\n}\n\ndeny contains msg if {\n    not input.authoremail in approved_authors\n    msg := sprintf(\"Unauthorized commit author: %s\", [input.authoremail])\n}\n```\n\n**Verification:**\n```bash\nwitness verify \\\n  --policy policy-signed.json \\\n  --publickey policy-key.pub \\\n  -a build-attestation.json \\\n  --subject <artifact>\n```\n"}]}
{"messages": [{"role": "system", "content": "You are an expert in the Witness supply chain attestation framework. You help users instrument CI/CD pipelines with witness, create policy documents, and write Rego policies to validate attestations. You understand all attestors in go-witness and how to use them effectively."}, {"role": "user", "content": "How do I create a witness policy for a build step that uses these attestors: git, environment?"}, {"role": "assistant", "content": "Here's a complete witness policy for your build step with git, environment attestors:\n\n**Policy Document:**\n```json\n{\n  \"expires\": \"2026-11-08T10:52:59Z\",\n  \"publickeys\": {\n    \"build-key\": {\n      \"keyid\": \"sha256:cbd8b8b32a5d5b5f4dd93433ad39720299d5d19eb858814db6a3d2652b8def36\",\n      \"key\": \"-----BEGIN PUBLIC KEY-----\\n...\\n-----END PUBLIC KEY-----\"\n    }\n  },\n  \"steps\": {\n    \"build\": {\n      \"name\": \"build\",\n      \"attestations\": [\n        {\n          \"type\": \"https://witness.dev/attestations/git/v0.1\"\n        },\n        {\n          \"type\": \"https://witness.dev/attestations/environment/v0.1\"\n        }\n      ],\n      \"functionaries\": [\n        {\n          \"type\": \"publickey\",\n          \"publickeyid\": \"build-key\"\n        }\n      ]\n    }\n  }\n}\n```\n\n**Witness Run Command:**\n```bash\nwitness run --step build \\\n  --attestations git,environment \\\n  --outfile build-attestation.json \\\n  --key signing-key.pem \\\n  -- <your-build-command>\n```\n\n**Rego Validation Rules:**\n```rego\npackage git\n\nimport rego.v1\n\n# Enforce builds from specific branch\ndeny contains msg if {\n    input.branch != \"bugfix/security\"\n    msg := sprintf(\"Must build from bugfix/security branch, got: %s\", [input.branch])\n}\n\n# Require clean working directory\ndeny contains msg if {\n    count(input.status) > 0\n    msg := \"Working directory must be clean (no uncommitted changes)\"\n}\n\n# Validate commit author\napproved_authors := {\n    \"alice.smith@example.com\",\n    \"bob.jones@company.com\",\n    \"ci-bot@company.com\"\n}\n\ndeny contains msg if {\n    not input.authoremail in approved_authors\n    msg := sprintf(\"Unauthorized commit author: %s\", [input.authoremail])\n}\n```\n\n**Verification:**\n```bash\nwitness verify \\\n  --policy policy-signed.json \\\n  --publickey policy-key.pub \\\n  -a build-attestation.json \\\n  --subject <artifact>\n```\n"}]}
{"messages": [{"role": "system", "content": "You are an expert in the Witness supply chain attestation framework. You help users instrument CI/CD pipelines with witness, create policy documents, and write Rego policies to validate attestations. You understand all attestors in go-witness and how to use them effectively."}, {"role": "user", "content": "How do I create a witness policy for a build step that uses these attestors: git, product, environment, material?"}, {"role": "assistant", "content": "Here's a complete witness policy for your build step with git, product, environment, material attestors:\n\n**Policy Document:**\n```json\n{\n  \"expires\": \"2026-11-08T10:52:59Z\",\n  \"publickeys\": {\n    \"build-key\": {\n      \"keyid\": \"sha256:c1bd46e17fec772a2496e326ac81a7728979c60bf89d3d0cbc2da63033c7d4e5\",\n      \"key\": \"-----BEGIN PUBLIC KEY-----\\n...\\n-----END PUBLIC KEY-----\"\n    }\n  },\n  \"steps\": {\n    \"build\": {\n      \"name\": \"build\",\n      \"attestations\": [\n        {\n          \"type\": \"https://witness.dev/attestations/git/v0.1\"\n        },\n        {\n          \"type\": \"https://witness.dev/attestations/product/v0.1\"\n        },\n        {\n          \"type\": \"https://witness.dev/attestations/environment/v0.1\"\n        },\n        {\n          \"type\": \"https://witness.dev/attestations/material/v0.1\"\n        }\n      ],\n      \"functionaries\": [\n        {\n          \"type\": \"publickey\",\n          \"publickeyid\": \"build-key\"\n        }\n      ]\n    }\n  }\n}\n```\n\n**Witness Run Command:**\n```bash\nwitness run --step build \\\n  --attestations git,product,environment,material \\\n  --outfile build-attestation.json \\\n  --key signing-key.pem \\\n  -- <your-build-command>\n```\n\n**Rego Validation Rules:**\n```rego\npackage git\n\nimport rego.v1\n\n# Enforce builds from specific branch\ndeny contains msg if {\n    input.branch != \"develop\"\n    msg := sprintf(\"Must build from develop branch, got: %s\", [input.branch])\n}\n\n# Validate commit author\napproved_authors := {\n    \"alice.smith@example.com\",\n    \"bob.jones@company.com\",\n    \"ci-bot@company.com\"\n}\n\ndeny contains msg if {\n    not input.authoremail in approved_authors\n    msg := sprintf(\"Unauthorized commit author: %s\", [input.authoremail])\n}\n```\n\n**Verification:**\n```bash\nwitness verify \\\n  --policy policy-signed.json \\\n  --publickey policy-key.pub \\\n  -a build-attestation.json \\\n  --subject <artifact>\n```\n"}]}
{"messages": [{"role": "system", "content": "You are an expert in the Witness supply chain attestation framework. You help users instrument CI/CD pipelines with witness, create policy documents, and write Rego policies to validate attestations. You understand all attestors in go-witness and how to use them effectively."}, {"role": "user", "content": "How do I create a multi-step witness policy for a build \u2192 test \u2192 package pipeline?"}, {"role": "assistant", "content": "Here's a complete multi-step witness policy for your pipeline:\n\n**Policy Document:**\n```json\n{\n  \"expires\": \"2026-11-08T10:52:59Z\",\n  \"publickeys\": {\n    \"ci-key\": {\n      \"keyid\": \"sha256:d298750e417c2b646f4a17bebdf1065a6244ff5995b44473811fec2d3916a66e\",\n      \"key\": \"-----BEGIN PUBLIC KEY-----\\n...\\n-----END PUBLIC KEY-----\"\n    }\n  },\n  \"steps\": {\n    \"build\": {\n      \"name\": \"build\",\n      \"attestations\": [\n        {\n          \"type\": \"https://witness.dev/attestations/git/v0.1\"\n        },\n        {\n          \"type\": \"https://witness.dev/attestations/command-run/v0.1\"\n        },\n        {\n          \"type\": \"https://witness.dev/attestations/product/v0.1\"\n        }\n      ],\n      \"functionaries\": [\n        {\n          \"type\": \"publickey\",\n          \"publickeyid\": \"ci-key\"\n        }\n      ]\n    },\n    \"test\": {\n      \"name\": \"test\",\n      \"attestations\": [\n        {\n          \"type\": \"https://witness.dev/attestations/material/v0.1\"\n        },\n        {\n          \"type\": \"https://witness.dev/attestations/command-run/v0.1\"\n        }\n      ],\n      \"functionaries\": [\n        {\n          \"type\": \"publickey\",\n          \"publickeyid\": \"ci-key\"\n        }\n      ]\n    },\n    \"package\": {\n      \"name\": \"package\",\n      \"attestations\": [\n        {\n          \"type\": \"https://witness.dev/attestations/material/v0.1\"\n        },\n        {\n          \"type\": \"https://witness.dev/attestations/product/v0.1\"\n        }\n      ],\n      \"functionaries\": [\n        {\n          \"type\": \"publickey\",\n          \"publickeyid\": \"ci-key\"\n        }\n      ]\n    }\n  }\n}\n```\n\n**Pipeline Commands:**\n\n```bash\n# Step 1: Build\nwitness run --step build \\\n  --attestations git,commandrun,product \\\n  -o build.json --key ci-key.pem \\\n  -- go build -o myapp\n\n# Step 2: Test\nwitness run --step test \\\n  --attestations material,commandrun \\\n  -o test.json --key ci-key.pem \\\n  -- go test ./...\n\n# Step 3: Package\nwitness run --step package \\\n  --attestations material,product \\\n  -o package.json --key ci-key.pem \\\n  -- tar czf myapp.tar.gz myapp\n\n# Verify entire pipeline\nwitness verify \\\n  --policy policy-signed.json \\\n  --publickey policy-key.pub \\\n  -a build.json -a test.json -a package.json\n```\n"}]}
{"messages": [{"role": "system", "content": "You are an expert in the Witness supply chain attestation framework. You help users instrument CI/CD pipelines with witness, create policy documents, and write Rego policies to validate attestations. You understand all attestors in go-witness and how to use them effectively."}, {"role": "user", "content": "How do I create a multi-step witness policy for a build \u2192 test \u2192 package pipeline?"}, {"role": "assistant", "content": "Here's a complete multi-step witness policy for your pipeline:\n\n**Policy Document:**\n```json\n{\n  \"expires\": \"2026-11-08T10:52:59Z\",\n  \"publickeys\": {\n    \"ci-key\": {\n      \"keyid\": \"sha256:e613adb31ed6d5df03626c82ebaf78a810f549ec8b6f9e2520056e67c110b87a\",\n      \"key\": \"-----BEGIN PUBLIC KEY-----\\n...\\n-----END PUBLIC KEY-----\"\n    }\n  },\n  \"steps\": {\n    \"build\": {\n      \"name\": \"build\",\n      \"attestations\": [\n        {\n          \"type\": \"https://witness.dev/attestations/git/v0.1\"\n        },\n        {\n          \"type\": \"https://witness.dev/attestations/command-run/v0.1\"\n        },\n        {\n          \"type\": \"https://witness.dev/attestations/product/v0.1\"\n        }\n      ],\n      \"functionaries\": [\n        {\n          \"type\": \"publickey\",\n          \"publickeyid\": \"ci-key\"\n        }\n      ]\n    },\n    \"test\": {\n      \"name\": \"test\",\n      \"attestations\": [\n        {\n          \"type\": \"https://witness.dev/attestations/material/v0.1\"\n        },\n        {\n          \"type\": \"https://witness.dev/attestations/command-run/v0.1\"\n        }\n      ],\n      \"functionaries\": [\n        {\n          \"type\": \"publickey\",\n          \"publickeyid\": \"ci-key\"\n        }\n      ]\n    },\n    \"package\": {\n      \"name\": \"package\",\n      \"attestations\": [\n        {\n          \"type\": \"https://witness.dev/attestations/material/v0.1\"\n        },\n        {\n          \"type\": \"https://witness.dev/attestations/product/v0.1\"\n        }\n      ],\n      \"functionaries\": [\n        {\n          \"type\": \"publickey\",\n          \"publickeyid\": \"ci-key\"\n        }\n      ]\n    }\n  }\n}\n```\n\n**Pipeline Commands:**\n\n```bash\n# Step 1: Build\nwitness run --step build \\\n  --attestations git,commandrun,product \\\n  -o build.json --key ci-key.pem \\\n  -- go build -o myapp\n\n# Step 2: Test\nwitness run --step test \\\n  --attestations material,commandrun \\\n  -o test.json --key ci-key.pem \\\n  -- go test ./...\n\n# Step 3: Package\nwitness run --step package \\\n  --attestations material,product \\\n  -o package.json --key ci-key.pem \\\n  -- tar czf myapp.tar.gz myapp\n\n# Verify entire pipeline\nwitness verify \\\n  --policy policy-signed.json \\\n  --publickey policy-key.pub \\\n  -a build.json -a test.json -a package.json\n```\n"}]}
{"messages": [{"role": "system", "content": "You are an expert in the Witness supply chain attestation framework. You help users instrument CI/CD pipelines with witness, create policy documents, and write Rego policies to validate attestations. You understand all attestors in go-witness and how to use them effectively."}, {"role": "user", "content": "How do I create a witness policy for a build step that uses these attestors: product, material, environment, git, github?"}, {"role": "assistant", "content": "Here's a complete witness policy for your build step with product, material, environment, git, github attestors:\n\n**Policy Document:**\n```json\n{\n  \"expires\": \"2026-11-08T10:52:59Z\",\n  \"publickeys\": {\n    \"build-key\": {\n      \"keyid\": \"sha256:f58035f3eb427089d8ad138d249baadc764151164ea451bbb40dd894a7ef904c\",\n      \"key\": \"-----BEGIN PUBLIC KEY-----\\n...\\n-----END PUBLIC KEY-----\"\n    }\n  },\n  \"steps\": {\n    \"build\": {\n      \"name\": \"build\",\n      \"attestations\": [\n        {\n          \"type\": \"https://witness.dev/attestations/product/v0.1\"\n        },\n        {\n          \"type\": \"https://witness.dev/attestations/material/v0.1\"\n        },\n        {\n          \"type\": \"https://witness.dev/attestations/environment/v0.1\"\n        },\n        {\n          \"type\": \"https://witness.dev/attestations/git/v0.1\"\n        },\n        {\n          \"type\": \"https://witness.dev/attestations/github/v0.1\"\n        }\n      ],\n      \"functionaries\": [\n        {\n          \"type\": \"publickey\",\n          \"publickeyid\": \"build-key\"\n        }\n      ]\n    }\n  }\n}\n```\n\n**Witness Run Command:**\n```bash\nwitness run --step build \\\n  --attestations product,material,environment,git,github \\\n  --outfile build-attestation.json \\\n  --key signing-key.pem \\\n  -- <your-build-command>\n```\n\n**Rego Validation Rules:**\n```rego\n\n```\n\n**Verification:**\n```bash\nwitness verify \\\n  --policy policy-signed.json \\\n  --publickey policy-key.pub \\\n  -a build-attestation.json \\\n  --subject <artifact>\n```\n"}]}
{"messages": [{"role": "system", "content": "You are an expert in the Witness supply chain attestation framework. You help users instrument CI/CD pipelines with witness, create policy documents, and write Rego policies to validate attestations. You understand all attestors in go-witness and how to use them effectively."}, {"role": "user", "content": "How do I create a witness policy for a build step that uses these attestors: git?"}, {"role": "assistant", "content": "Here's a complete witness policy for your build step with git attestors:\n\n**Policy Document:**\n```json\n{\n  \"expires\": \"2026-11-08T10:52:59Z\",\n  \"publickeys\": {\n    \"build-key\": {\n      \"keyid\": \"sha256:63ffe746c0f6977a4c83d8468025342aa7980bb03ba82e6d6c7e10274463deda\",\n      \"key\": \"-----BEGIN PUBLIC KEY-----\\n...\\n-----END PUBLIC KEY-----\"\n    }\n  },\n  \"steps\": {\n    \"build\": {\n      \"name\": \"build\",\n      \"attestations\": [\n        {\n          \"type\": \"https://witness.dev/attestations/git/v0.1\"\n        }\n      ],\n      \"functionaries\": [\n        {\n          \"type\": \"publickey\",\n          \"publickeyid\": \"build-key\"\n        }\n      ]\n    }\n  }\n}\n```\n\n**Witness Run Command:**\n```bash\nwitness run --step build \\\n  --attestations git \\\n  --outfile build-attestation.json \\\n  --key signing-key.pem \\\n  -- <your-build-command>\n```\n\n**Rego Validation Rules:**\n```rego\npackage git\n\nimport rego.v1\n\n# Enforce builds from specific branch\ndeny contains msg if {\n    input.branch != \"staging\"\n    msg := sprintf(\"Must build from staging branch, got: %s\", [input.branch])\n}\n\n# Require clean working directory\ndeny contains msg if {\n    count(input.status) > 0\n    msg := \"Working directory must be clean (no uncommitted changes)\"\n}\n\n# Validate commit author\napproved_authors := {\n    \"alice.smith@example.com\",\n    \"bob.jones@company.com\",\n    \"ci-bot@company.com\"\n}\n\ndeny contains msg if {\n    not input.authoremail in approved_authors\n    msg := sprintf(\"Unauthorized commit author: %s\", [input.authoremail])\n}\n```\n\n**Verification:**\n```bash\nwitness verify \\\n  --policy policy-signed.json \\\n  --publickey policy-key.pub \\\n  -a build-attestation.json \\\n  --subject <artifact>\n```\n"}]}
{"messages": [{"role": "system", "content": "You are an expert in the Witness supply chain attestation framework. You help users instrument CI/CD pipelines with witness, create policy documents, and write Rego policies to validate attestations. You understand all attestors in go-witness and how to use them effectively."}, {"role": "user", "content": "How do I create a witness policy for a build step that uses these attestors: product, material, environment, github?"}, {"role": "assistant", "content": "Here's a complete witness policy for your build step with product, material, environment, github attestors:\n\n**Policy Document:**\n```json\n{\n  \"expires\": \"2026-11-08T10:52:59Z\",\n  \"publickeys\": {\n    \"build-key\": {\n      \"keyid\": \"sha256:8af145593768669b6cbcf94893808549c2680bfaf0d9703b5e4a7cb002f957cf\",\n      \"key\": \"-----BEGIN PUBLIC KEY-----\\n...\\n-----END PUBLIC KEY-----\"\n    }\n  },\n  \"steps\": {\n    \"build\": {\n      \"name\": \"build\",\n      \"attestations\": [\n        {\n          \"type\": \"https://witness.dev/attestations/product/v0.1\"\n        },\n        {\n          \"type\": \"https://witness.dev/attestations/material/v0.1\"\n        },\n        {\n          \"type\": \"https://witness.dev/attestations/environment/v0.1\"\n        },\n        {\n          \"type\": \"https://witness.dev/attestations/github/v0.1\"\n        }\n      ],\n      \"functionaries\": [\n        {\n          \"type\": \"publickey\",\n          \"publickeyid\": \"build-key\"\n        }\n      ]\n    }\n  }\n}\n```\n\n**Witness Run Command:**\n```bash\nwitness run --step build \\\n  --attestations product,material,environment,github \\\n  --outfile build-attestation.json \\\n  --key signing-key.pem \\\n  -- <your-build-command>\n```\n\n**Rego Validation Rules:**\n```rego\n\n```\n\n**Verification:**\n```bash\nwitness verify \\\n  --policy policy-signed.json \\\n  --publickey policy-key.pub \\\n  -a build-attestation.json \\\n  --subject <artifact>\n```\n"}]}
{"messages": [{"role": "system", "content": "You are an expert in the Witness supply chain attestation framework. You help users instrument CI/CD pipelines with witness, create policy documents, and write Rego policies to validate attestations. You understand all attestors in go-witness and how to use them effectively."}, {"role": "user", "content": "How do I create a witness policy for a build step that uses these attestors: git, material, github, product, commandrun?"}, {"role": "assistant", "content": "Here's a complete witness policy for your build step with git, material, github, product, commandrun attestors:\n\n**Policy Document:**\n```json\n{\n  \"expires\": \"2026-11-08T10:52:59Z\",\n  \"publickeys\": {\n    \"build-key\": {\n      \"keyid\": \"sha256:20daf4529d03f12da7a2fd53be91e7bd2ebf3151b17042452dc317884a89663e\",\n      \"key\": \"-----BEGIN PUBLIC KEY-----\\n...\\n-----END PUBLIC KEY-----\"\n    }\n  },\n  \"steps\": {\n    \"build\": {\n      \"name\": \"build\",\n      \"attestations\": [\n        {\n          \"type\": \"https://witness.dev/attestations/git/v0.1\"\n        },\n        {\n          \"type\": \"https://witness.dev/attestations/material/v0.1\"\n        },\n        {\n          \"type\": \"https://witness.dev/attestations/github/v0.1\"\n        },\n        {\n          \"type\": \"https://witness.dev/attestations/product/v0.1\"\n        },\n        {\n          \"type\": \"https://witness.dev/attestations/command-run/v0.1\"\n        }\n      ],\n      \"functionaries\": [\n        {\n          \"type\": \"publickey\",\n          \"publickeyid\": \"build-key\"\n        }\n      ]\n    }\n  }\n}\n```\n\n**Witness Run Command:**\n```bash\nwitness run --step build \\\n  --attestations git,material,github,product,commandrun \\\n  --outfile build-attestation.json \\\n  --key signing-key.pem \\\n  -- <your-build-command>\n```\n\n**Rego Validation Rules:**\n```rego\npackage git\n\nimport rego.v1\n\n# Enforce builds from specific branch\ndeny contains msg if {\n    input.branch != \"bugfix/security\"\n    msg := sprintf(\"Must build from bugfix/security branch, got: %s\", [input.branch])\n}\n\n# Require clean working directory\ndeny contains msg if {\n    count(input.status) > 0\n    msg := \"Working directory must be clean (no uncommitted changes)\"\n}\n\n# Validate commit author\napproved_authors := {\n    \"alice.smith@example.com\",\n    \"bob.jones@company.com\",\n    \"ci-bot@company.com\"\n}\n\ndeny contains msg if {\n    not input.authoremail in approved_authors\n    msg := sprintf(\"Unauthorized commit author: %s\", [input.authoremail])\n}\n```\n\n**Verification:**\n```bash\nwitness verify \\\n  --policy policy-signed.json \\\n  --publickey policy-key.pub \\\n  -a build-attestation.json \\\n  --subject <artifact>\n```\n"}]}
{"messages": [{"role": "system", "content": "You are an expert in the Witness supply chain attestation framework. You help users instrument CI/CD pipelines with witness, create policy documents, and write Rego policies to validate attestations. You understand all attestors in go-witness and how to use them effectively."}, {"role": "user", "content": "How do I create a multi-step witness policy for a build \u2192 test \u2192 package pipeline?"}, {"role": "assistant", "content": "Here's a complete multi-step witness policy for your pipeline:\n\n**Policy Document:**\n```json\n{\n  \"expires\": \"2026-11-08T10:52:59Z\",\n  \"publickeys\": {\n    \"ci-key\": {\n      \"keyid\": \"sha256:17edf74c38269fbb05086e9352767dcd9393f26f6ac20559e0b44710b2b5d723\",\n      \"key\": \"-----BEGIN PUBLIC KEY-----\\n...\\n-----END PUBLIC KEY-----\"\n    }\n  },\n  \"steps\": {\n    \"build\": {\n      \"name\": \"build\",\n      \"attestations\": [\n        {\n          \"type\": \"https://witness.dev/attestations/git/v0.1\"\n        },\n        {\n          \"type\": \"https://witness.dev/attestations/command-run/v0.1\"\n        },\n        {\n          \"type\": \"https://witness.dev/attestations/product/v0.1\"\n        }\n      ],\n      \"functionaries\": [\n        {\n          \"type\": \"publickey\",\n          \"publickeyid\": \"ci-key\"\n        }\n      ]\n    },\n    \"test\": {\n      \"name\": \"test\",\n      \"attestations\": [\n        {\n          \"type\": \"https://witness.dev/attestations/material/v0.1\"\n        },\n        {\n          \"type\": \"https://witness.dev/attestations/command-run/v0.1\"\n        }\n      ],\n      \"functionaries\": [\n        {\n          \"type\": \"publickey\",\n          \"publickeyid\": \"ci-key\"\n        }\n      ]\n    },\n    \"package\": {\n      \"name\": \"package\",\n      \"attestations\": [\n        {\n          \"type\": \"https://witness.dev/attestations/material/v0.1\"\n        },\n        {\n          \"type\": \"https://witness.dev/attestations/product/v0.1\"\n        }\n      ],\n      \"functionaries\": [\n        {\n          \"type\": \"publickey\",\n          \"publickeyid\": \"ci-key\"\n        }\n      ]\n    }\n  }\n}\n```\n\n**Pipeline Commands:**\n\n```bash\n# Step 1: Build\nwitness run --step build \\\n  --attestations git,commandrun,product \\\n  -o build.json --key ci-key.pem \\\n  -- go build -o myapp\n\n# Step 2: Test\nwitness run --step test \\\n  --attestations material,commandrun \\\n  -o test.json --key ci-key.pem \\\n  -- go test ./...\n\n# Step 3: Package\nwitness run --step package \\\n  --attestations material,product \\\n  -o package.json --key ci-key.pem \\\n  -- tar czf myapp.tar.gz myapp\n\n# Verify entire pipeline\nwitness verify \\\n  --policy policy-signed.json \\\n  --publickey policy-key.pub \\\n  -a build.json -a test.json -a package.json\n```\n"}]}
{"messages": [{"role": "system", "content": "You are an expert in the Witness supply chain attestation framework. You help users instrument CI/CD pipelines with witness, create policy documents, and write Rego policies to validate attestations. You understand all attestors in go-witness and how to use them effectively."}, {"role": "user", "content": "How do I create a multi-step witness policy for a build \u2192 test \u2192 package pipeline?"}, {"role": "assistant", "content": "Here's a complete multi-step witness policy for your pipeline:\n\n**Policy Document:**\n```json\n{\n  \"expires\": \"2026-11-08T10:52:59Z\",\n  \"publickeys\": {\n    \"ci-key\": {\n      \"keyid\": \"sha256:d17d5eb8f44a3022f95cb2fa5b6bce78b3c23b140181f9fcac9ecc7e71a978f7\",\n      \"key\": \"-----BEGIN PUBLIC KEY-----\\n...\\n-----END PUBLIC KEY-----\"\n    }\n  },\n  \"steps\": {\n    \"build\": {\n      \"name\": \"build\",\n      \"attestations\": [\n        {\n          \"type\": \"https://witness.dev/attestations/git/v0.1\"\n        },\n        {\n          \"type\": \"https://witness.dev/attestations/command-run/v0.1\"\n        },\n        {\n          \"type\": \"https://witness.dev/attestations/product/v0.1\"\n        }\n      ],\n      \"functionaries\": [\n        {\n          \"type\": \"publickey\",\n          \"publickeyid\": \"ci-key\"\n        }\n      ]\n    },\n    \"test\": {\n      \"name\": \"test\",\n      \"attestations\": [\n        {\n          \"type\": \"https://witness.dev/attestations/material/v0.1\"\n        },\n        {\n          \"type\": \"https://witness.dev/attestations/command-run/v0.1\"\n        }\n      ],\n      \"functionaries\": [\n        {\n          \"type\": \"publickey\",\n          \"publickeyid\": \"ci-key\"\n        }\n      ]\n    },\n    \"package\": {\n      \"name\": \"package\",\n      \"attestations\": [\n        {\n          \"type\": \"https://witness.dev/attestations/material/v0.1\"\n        },\n        {\n          \"type\": \"https://witness.dev/attestations/product/v0.1\"\n        }\n      ],\n      \"functionaries\": [\n        {\n          \"type\": \"publickey\",\n          \"publickeyid\": \"ci-key\"\n        }\n      ]\n    }\n  }\n}\n```\n\n**Pipeline Commands:**\n\n```bash\n# Step 1: Build\nwitness run --step build \\\n  --attestations git,commandrun,product \\\n  -o build.json --key ci-key.pem \\\n  -- go build -o myapp\n\n# Step 2: Test\nwitness run --step test \\\n  --attestations material,commandrun \\\n  -o test.json --key ci-key.pem \\\n  -- go test ./...\n\n# Step 3: Package\nwitness run --step package \\\n  --attestations material,product \\\n  -o package.json --key ci-key.pem \\\n  -- tar czf myapp.tar.gz myapp\n\n# Verify entire pipeline\nwitness verify \\\n  --policy policy-signed.json \\\n  --publickey policy-key.pub \\\n  -a build.json -a test.json -a package.json\n```\n"}]}
{"messages": [{"role": "system", "content": "You are an expert in the Witness supply chain attestation framework. You help users instrument CI/CD pipelines with witness, create policy documents, and write Rego policies to validate attestations. You understand all attestors in go-witness and how to use them effectively."}, {"role": "user", "content": "How do I create a witness policy for a build step that uses these attestors: material, git, github?"}, {"role": "assistant", "content": "Here's a complete witness policy for your build step with material, git, github attestors:\n\n**Policy Document:**\n```json\n{\n  \"expires\": \"2026-11-08T10:52:59Z\",\n  \"publickeys\": {\n    \"build-key\": {\n      \"keyid\": \"sha256:6336be935c0696389889f81ddbb7d0a9e774171813af09f0232cc8e828aef5f7\",\n      \"key\": \"-----BEGIN PUBLIC KEY-----\\n...\\n-----END PUBLIC KEY-----\"\n    }\n  },\n  \"steps\": {\n    \"build\": {\n      \"name\": \"build\",\n      \"attestations\": [\n        {\n          \"type\": \"https://witness.dev/attestations/material/v0.1\"\n        },\n        {\n          \"type\": \"https://witness.dev/attestations/git/v0.1\"\n        },\n        {\n          \"type\": \"https://witness.dev/attestations/github/v0.1\"\n        }\n      ],\n      \"functionaries\": [\n        {\n          \"type\": \"publickey\",\n          \"publickeyid\": \"build-key\"\n        }\n      ]\n    }\n  }\n}\n```\n\n**Witness Run Command:**\n```bash\nwitness run --step build \\\n  --attestations material,git,github \\\n  --outfile build-attestation.json \\\n  --key signing-key.pem \\\n  -- <your-build-command>\n```\n\n**Rego Validation Rules:**\n```rego\n\n```\n\n**Verification:**\n```bash\nwitness verify \\\n  --policy policy-signed.json \\\n  --publickey policy-key.pub \\\n  -a build-attestation.json \\\n  --subject <artifact>\n```\n"}]}
{"messages": [{"role": "system", "content": "You are an expert in the Witness supply chain attestation framework. You help users instrument CI/CD pipelines with witness, create policy documents, and write Rego policies to validate attestations. You understand all attestors in go-witness and how to use them effectively."}, {"role": "user", "content": "How do I create a witness policy for a build step that uses these attestors: environment, commandrun, github?"}, {"role": "assistant", "content": "Here's a complete witness policy for your build step with environment, commandrun, github attestors:\n\n**Policy Document:**\n```json\n{\n  \"expires\": \"2026-11-08T10:52:59Z\",\n  \"publickeys\": {\n    \"build-key\": {\n      \"keyid\": \"sha256:4067a868d904d4f6d29e4713bcc3517dab62dad03f9cabaaba2d9f468f6d5d4e\",\n      \"key\": \"-----BEGIN PUBLIC KEY-----\\n...\\n-----END PUBLIC KEY-----\"\n    }\n  },\n  \"steps\": {\n    \"build\": {\n      \"name\": \"build\",\n      \"attestations\": [\n        {\n          \"type\": \"https://witness.dev/attestations/environment/v0.1\"\n        },\n        {\n          \"type\": \"https://witness.dev/attestations/command-run/v0.1\"\n        },\n        {\n          \"type\": \"https://witness.dev/attestations/github/v0.1\"\n        }\n      ],\n      \"functionaries\": [\n        {\n          \"type\": \"publickey\",\n          \"publickeyid\": \"build-key\"\n        }\n      ]\n    }\n  }\n}\n```\n\n**Witness Run Command:**\n```bash\nwitness run --step build \\\n  --attestations environment,commandrun,github \\\n  --outfile build-attestation.json \\\n  --key signing-key.pem \\\n  -- <your-build-command>\n```\n\n**Rego Validation Rules:**\n```rego\npackage environment\n\nimport rego.v1\n\n# Ensure correct OS\ndeny contains msg if {\n    input.os != \"linux\"\n    msg := sprintf(\"Must run on linux, got: %s\", [input.os])\n}\n\n# Require CI environment\ndeny contains msg if {\n    not \"CI\" in input.variables\n    msg := \"Must run in CI environment (CI variable not set)\"\n}\n```\n\n**Verification:**\n```bash\nwitness verify \\\n  --policy policy-signed.json \\\n  --publickey policy-key.pub \\\n  -a build-attestation.json \\\n  --subject <artifact>\n```\n"}]}
{"messages": [{"role": "system", "content": "You are an expert in the Witness supply chain attestation framework. You help users instrument CI/CD pipelines with witness, create policy documents, and write Rego policies to validate attestations. You understand all attestors in go-witness and how to use them effectively."}, {"role": "user", "content": "How do I create a multi-step witness policy for a build \u2192 test \u2192 package pipeline?"}, {"role": "assistant", "content": "Here's a complete multi-step witness policy for your pipeline:\n\n**Policy Document:**\n```json\n{\n  \"expires\": \"2026-11-08T10:52:59Z\",\n  \"publickeys\": {\n    \"ci-key\": {\n      \"keyid\": \"sha256:48042f6f1f70a6d2b505b50819c2f5ad630055ebd2ae9af529eae9bc054b0d90\",\n      \"key\": \"-----BEGIN PUBLIC KEY-----\\n...\\n-----END PUBLIC KEY-----\"\n    }\n  },\n  \"steps\": {\n    \"build\": {\n      \"name\": \"build\",\n      \"attestations\": [\n        {\n          \"type\": \"https://witness.dev/attestations/git/v0.1\"\n        },\n        {\n          \"type\": \"https://witness.dev/attestations/command-run/v0.1\"\n        },\n        {\n          \"type\": \"https://witness.dev/attestations/product/v0.1\"\n        }\n      ],\n      \"functionaries\": [\n        {\n          \"type\": \"publickey\",\n          \"publickeyid\": \"ci-key\"\n        }\n      ]\n    },\n    \"test\": {\n      \"name\": \"test\",\n      \"attestations\": [\n        {\n          \"type\": \"https://witness.dev/attestations/material/v0.1\"\n        },\n        {\n          \"type\": \"https://witness.dev/attestations/command-run/v0.1\"\n        }\n      ],\n      \"functionaries\": [\n        {\n          \"type\": \"publickey\",\n          \"publickeyid\": \"ci-key\"\n        }\n      ]\n    },\n    \"package\": {\n      \"name\": \"package\",\n      \"attestations\": [\n        {\n          \"type\": \"https://witness.dev/attestations/material/v0.1\"\n        },\n        {\n          \"type\": \"https://witness.dev/attestations/product/v0.1\"\n        }\n      ],\n      \"functionaries\": [\n        {\n          \"type\": \"publickey\",\n          \"publickeyid\": \"ci-key\"\n        }\n      ]\n    }\n  }\n}\n```\n\n**Pipeline Commands:**\n\n```bash\n# Step 1: Build\nwitness run --step build \\\n  --attestations git,commandrun,product \\\n  -o build.json --key ci-key.pem \\\n  -- go build -o myapp\n\n# Step 2: Test\nwitness run --step test \\\n  --attestations material,commandrun \\\n  -o test.json --key ci-key.pem \\\n  -- go test ./...\n\n# Step 3: Package\nwitness run --step package \\\n  --attestations material,product \\\n  -o package.json --key ci-key.pem \\\n  -- tar czf myapp.tar.gz myapp\n\n# Verify entire pipeline\nwitness verify \\\n  --policy policy-signed.json \\\n  --publickey policy-key.pub \\\n  -a build.json -a test.json -a package.json\n```\n"}]}
{"messages": [{"role": "system", "content": "You are an expert in the Witness supply chain attestation framework. You help users instrument CI/CD pipelines with witness, create policy documents, and write Rego policies to validate attestations. You understand all attestors in go-witness and how to use them effectively."}, {"role": "user", "content": "How do I create a witness policy for a build step that uses these attestors: material?"}, {"role": "assistant", "content": "Here's a complete witness policy for your build step with material attestors:\n\n**Policy Document:**\n```json\n{\n  \"expires\": \"2026-11-08T10:52:59Z\",\n  \"publickeys\": {\n    \"build-key\": {\n      \"keyid\": \"sha256:8041edc5bdf55c8fa0aa1b4301d87c8b6edcf1db95d2cd260f0808854314648c\",\n      \"key\": \"-----BEGIN PUBLIC KEY-----\\n...\\n-----END PUBLIC KEY-----\"\n    }\n  },\n  \"steps\": {\n    \"build\": {\n      \"name\": \"build\",\n      \"attestations\": [\n        {\n          \"type\": \"https://witness.dev/attestations/material/v0.1\"\n        }\n      ],\n      \"functionaries\": [\n        {\n          \"type\": \"publickey\",\n          \"publickeyid\": \"build-key\"\n        }\n      ]\n    }\n  }\n}\n```\n\n**Witness Run Command:**\n```bash\nwitness run --step build \\\n  --attestations material \\\n  --outfile build-attestation.json \\\n  --key signing-key.pem \\\n  -- <your-build-command>\n```\n\n**Rego Validation Rules:**\n```rego\n\n```\n\n**Verification:**\n```bash\nwitness verify \\\n  --policy policy-signed.json \\\n  --publickey policy-key.pub \\\n  -a build-attestation.json \\\n  --subject <artifact>\n```\n"}]}
{"messages": [{"role": "system", "content": "You are an expert in the Witness supply chain attestation framework. You help users instrument CI/CD pipelines with witness, create policy documents, and write Rego policies to validate attestations. You understand all attestors in go-witness and how to use them effectively."}, {"role": "user", "content": "How do I create a witness policy for a build step that uses these attestors: github, product, git, material, commandrun?"}, {"role": "assistant", "content": "Here's a complete witness policy for your build step with github, product, git, material, commandrun attestors:\n\n**Policy Document:**\n```json\n{\n  \"expires\": \"2026-11-08T10:52:59Z\",\n  \"publickeys\": {\n    \"build-key\": {\n      \"keyid\": \"sha256:909c6cb11c5bebedca452e1e5f680097c85b2d30d3ef0cee03990513edd2d20d\",\n      \"key\": \"-----BEGIN PUBLIC KEY-----\\n...\\n-----END PUBLIC KEY-----\"\n    }\n  },\n  \"steps\": {\n    \"build\": {\n      \"name\": \"build\",\n      \"attestations\": [\n        {\n          \"type\": \"https://witness.dev/attestations/github/v0.1\"\n        },\n        {\n          \"type\": \"https://witness.dev/attestations/product/v0.1\"\n        },\n        {\n          \"type\": \"https://witness.dev/attestations/git/v0.1\"\n        },\n        {\n          \"type\": \"https://witness.dev/attestations/material/v0.1\"\n        },\n        {\n          \"type\": \"https://witness.dev/attestations/command-run/v0.1\"\n        }\n      ],\n      \"functionaries\": [\n        {\n          \"type\": \"publickey\",\n          \"publickeyid\": \"build-key\"\n        }\n      ]\n    }\n  }\n}\n```\n\n**Witness Run Command:**\n```bash\nwitness run --step build \\\n  --attestations github,product,git,material,commandrun \\\n  --outfile build-attestation.json \\\n  --key signing-key.pem \\\n  -- <your-build-command>\n```\n\n**Rego Validation Rules:**\n```rego\n\n```\n\n**Verification:**\n```bash\nwitness verify \\\n  --policy policy-signed.json \\\n  --publickey policy-key.pub \\\n  -a build-attestation.json \\\n  --subject <artifact>\n```\n"}]}
{"messages": [{"role": "system", "content": "You are an expert in the Witness supply chain attestation framework. You help users instrument CI/CD pipelines with witness, create policy documents, and write Rego policies to validate attestations. You understand all attestors in go-witness and how to use them effectively."}, {"role": "user", "content": "How do I create a witness policy for a build step that uses these attestors: git, material, commandrun, github?"}, {"role": "assistant", "content": "Here's a complete witness policy for your build step with git, material, commandrun, github attestors:\n\n**Policy Document:**\n```json\n{\n  \"expires\": \"2026-11-08T10:52:59Z\",\n  \"publickeys\": {\n    \"build-key\": {\n      \"keyid\": \"sha256:1c01895f6f4f545857e54839be6a21f25d1089d48bed05d696f90bd6370c020a\",\n      \"key\": \"-----BEGIN PUBLIC KEY-----\\n...\\n-----END PUBLIC KEY-----\"\n    }\n  },\n  \"steps\": {\n    \"build\": {\n      \"name\": \"build\",\n      \"attestations\": [\n        {\n          \"type\": \"https://witness.dev/attestations/git/v0.1\"\n        },\n        {\n          \"type\": \"https://witness.dev/attestations/material/v0.1\"\n        },\n        {\n          \"type\": \"https://witness.dev/attestations/command-run/v0.1\"\n        },\n        {\n          \"type\": \"https://witness.dev/attestations/github/v0.1\"\n        }\n      ],\n      \"functionaries\": [\n        {\n          \"type\": \"publickey\",\n          \"publickeyid\": \"build-key\"\n        }\n      ]\n    }\n  }\n}\n```\n\n**Witness Run Command:**\n```bash\nwitness run --step build \\\n  --attestations git,material,commandrun,github \\\n  --outfile build-attestation.json \\\n  --key signing-key.pem \\\n  -- <your-build-command>\n```\n\n**Rego Validation Rules:**\n```rego\npackage git\n\nimport rego.v1\n\n# Enforce builds from specific branch\ndeny contains msg if {\n    input.branch != \"feature/auth\"\n    msg := sprintf(\"Must build from feature/auth branch, got: %s\", [input.branch])\n}\n\n# Validate commit author\napproved_authors := {\n    \"alice.smith@example.com\",\n    \"bob.jones@company.com\",\n    \"ci-bot@company.com\"\n}\n\ndeny contains msg if {\n    not input.authoremail in approved_authors\n    msg := sprintf(\"Unauthorized commit author: %s\", [input.authoremail])\n}\n```\n\n**Verification:**\n```bash\nwitness verify \\\n  --policy policy-signed.json \\\n  --publickey policy-key.pub \\\n  -a build-attestation.json \\\n  --subject <artifact>\n```\n"}]}
{"messages": [{"role": "system", "content": "You are an expert in the Witness supply chain attestation framework. You help users instrument CI/CD pipelines with witness, create policy documents, and write Rego policies to validate attestations. You understand all attestors in go-witness and how to use them effectively."}, {"role": "user", "content": "How do I create a witness policy for a build step that uses these attestors: github, product, git?"}, {"role": "assistant", "content": "Here's a complete witness policy for your build step with github, product, git attestors:\n\n**Policy Document:**\n```json\n{\n  \"expires\": \"2026-11-08T10:52:59Z\",\n  \"publickeys\": {\n    \"build-key\": {\n      \"keyid\": \"sha256:bbd1a7d7c87970a8c3f4c5a6f542cb1e1c2298d0144b949ef801b04b4ae016c3\",\n      \"key\": \"-----BEGIN PUBLIC KEY-----\\n...\\n-----END PUBLIC KEY-----\"\n    }\n  },\n  \"steps\": {\n    \"build\": {\n      \"name\": \"build\",\n      \"attestations\": [\n        {\n          \"type\": \"https://witness.dev/attestations/github/v0.1\"\n        },\n        {\n          \"type\": \"https://witness.dev/attestations/product/v0.1\"\n        },\n        {\n          \"type\": \"https://witness.dev/attestations/git/v0.1\"\n        }\n      ],\n      \"functionaries\": [\n        {\n          \"type\": \"publickey\",\n          \"publickeyid\": \"build-key\"\n        }\n      ]\n    }\n  }\n}\n```\n\n**Witness Run Command:**\n```bash\nwitness run --step build \\\n  --attestations github,product,git \\\n  --outfile build-attestation.json \\\n  --key signing-key.pem \\\n  -- <your-build-command>\n```\n\n**Rego Validation Rules:**\n```rego\n\n```\n\n**Verification:**\n```bash\nwitness verify \\\n  --policy policy-signed.json \\\n  --publickey policy-key.pub \\\n  -a build-attestation.json \\\n  --subject <artifact>\n```\n"}]}
{"messages": [{"role": "system", "content": "You are an expert in the Witness supply chain attestation framework. You help users instrument CI/CD pipelines with witness, create policy documents, and write Rego policies to validate attestations. You understand all attestors in go-witness and how to use them effectively."}, {"role": "user", "content": "How do I create a witness policy for a build step that uses these attestors: product?"}, {"role": "assistant", "content": "Here's a complete witness policy for your build step with product attestors:\n\n**Policy Document:**\n```json\n{\n  \"expires\": \"2026-11-08T10:52:59Z\",\n  \"publickeys\": {\n    \"build-key\": {\n      \"keyid\": \"sha256:9bb4256ac65458bea63e26bb1eb37df46547af77615ad65b463b43ae2a77d36d\",\n      \"key\": \"-----BEGIN PUBLIC KEY-----\\n...\\n-----END PUBLIC KEY-----\"\n    }\n  },\n  \"steps\": {\n    \"build\": {\n      \"name\": \"build\",\n      \"attestations\": [\n        {\n          \"type\": \"https://witness.dev/attestations/product/v0.1\"\n        }\n      ],\n      \"functionaries\": [\n        {\n          \"type\": \"publickey\",\n          \"publickeyid\": \"build-key\"\n        }\n      ]\n    }\n  }\n}\n```\n\n**Witness Run Command:**\n```bash\nwitness run --step build \\\n  --attestations product \\\n  --outfile build-attestation.json \\\n  --key signing-key.pem \\\n  -- <your-build-command>\n```\n\n**Rego Validation Rules:**\n```rego\n\n```\n\n**Verification:**\n```bash\nwitness verify \\\n  --policy policy-signed.json \\\n  --publickey policy-key.pub \\\n  -a build-attestation.json \\\n  --subject <artifact>\n```\n"}]}
{"messages": [{"role": "system", "content": "You are an expert in the Witness supply chain attestation framework. You help users instrument CI/CD pipelines with witness, create policy documents, and write Rego policies to validate attestations. You understand all attestors in go-witness and how to use them effectively."}, {"role": "user", "content": "How do I create a witness policy for a build step that uses these attestors: material, product?"}, {"role": "assistant", "content": "Here's a complete witness policy for your build step with material, product attestors:\n\n**Policy Document:**\n```json\n{\n  \"expires\": \"2026-11-08T10:52:59Z\",\n  \"publickeys\": {\n    \"build-key\": {\n      \"keyid\": \"sha256:81b5c2ed298399008afb69dd62a4c794490828e9d54d4eaac08632f8fa3df0f3\",\n      \"key\": \"-----BEGIN PUBLIC KEY-----\\n...\\n-----END PUBLIC KEY-----\"\n    }\n  },\n  \"steps\": {\n    \"build\": {\n      \"name\": \"build\",\n      \"attestations\": [\n        {\n          \"type\": \"https://witness.dev/attestations/material/v0.1\"\n        },\n        {\n          \"type\": \"https://witness.dev/attestations/product/v0.1\"\n        }\n      ],\n      \"functionaries\": [\n        {\n          \"type\": \"publickey\",\n          \"publickeyid\": \"build-key\"\n        }\n      ]\n    }\n  }\n}\n```\n\n**Witness Run Command:**\n```bash\nwitness run --step build \\\n  --attestations material,product \\\n  --outfile build-attestation.json \\\n  --key signing-key.pem \\\n  -- <your-build-command>\n```\n\n**Rego Validation Rules:**\n```rego\n\n```\n\n**Verification:**\n```bash\nwitness verify \\\n  --policy policy-signed.json \\\n  --publickey policy-key.pub \\\n  -a build-attestation.json \\\n  --subject <artifact>\n```\n"}]}
{"messages": [{"role": "system", "content": "You are an expert in the Witness supply chain attestation framework. You help users instrument CI/CD pipelines with witness, create policy documents, and write Rego policies to validate attestations. You understand all attestors in go-witness and how to use them effectively."}, {"role": "user", "content": "How do I create a multi-step witness policy for a build \u2192 test \u2192 package pipeline?"}, {"role": "assistant", "content": "Here's a complete multi-step witness policy for your pipeline:\n\n**Policy Document:**\n```json\n{\n  \"expires\": \"2026-11-08T10:52:59Z\",\n  \"publickeys\": {\n    \"ci-key\": {\n      \"keyid\": \"sha256:56f7d13fb8059c038ec3c1d2009cf5758ac5f4cd5e57db5c993a93a008bb4f20\",\n      \"key\": \"-----BEGIN PUBLIC KEY-----\\n...\\n-----END PUBLIC KEY-----\"\n    }\n  },\n  \"steps\": {\n    \"build\": {\n      \"name\": \"build\",\n      \"attestations\": [\n        {\n          \"type\": \"https://witness.dev/attestations/git/v0.1\"\n        },\n        {\n          \"type\": \"https://witness.dev/attestations/command-run/v0.1\"\n        },\n        {\n          \"type\": \"https://witness.dev/attestations/product/v0.1\"\n        }\n      ],\n      \"functionaries\": [\n        {\n          \"type\": \"publickey\",\n          \"publickeyid\": \"ci-key\"\n        }\n      ]\n    },\n    \"test\": {\n      \"name\": \"test\",\n      \"attestations\": [\n        {\n          \"type\": \"https://witness.dev/attestations/material/v0.1\"\n        },\n        {\n          \"type\": \"https://witness.dev/attestations/command-run/v0.1\"\n        }\n      ],\n      \"functionaries\": [\n        {\n          \"type\": \"publickey\",\n          \"publickeyid\": \"ci-key\"\n        }\n      ]\n    },\n    \"package\": {\n      \"name\": \"package\",\n      \"attestations\": [\n        {\n          \"type\": \"https://witness.dev/attestations/material/v0.1\"\n        },\n        {\n          \"type\": \"https://witness.dev/attestations/product/v0.1\"\n        }\n      ],\n      \"functionaries\": [\n        {\n          \"type\": \"publickey\",\n          \"publickeyid\": \"ci-key\"\n        }\n      ]\n    }\n  }\n}\n```\n\n**Pipeline Commands:**\n\n```bash\n# Step 1: Build\nwitness run --step build \\\n  --attestations git,commandrun,product \\\n  -o build.json --key ci-key.pem \\\n  -- go build -o myapp\n\n# Step 2: Test\nwitness run --step test \\\n  --attestations material,commandrun \\\n  -o test.json --key ci-key.pem \\\n  -- go test ./...\n\n# Step 3: Package\nwitness run --step package \\\n  --attestations material,product \\\n  -o package.json --key ci-key.pem \\\n  -- tar czf myapp.tar.gz myapp\n\n# Verify entire pipeline\nwitness verify \\\n  --policy policy-signed.json \\\n  --publickey policy-key.pub \\\n  -a build.json -a test.json -a package.json\n```\n"}]}
{"messages": [{"role": "system", "content": "You are an expert in the Witness supply chain attestation framework. You help users instrument CI/CD pipelines with witness, create policy documents, and write Rego policies to validate attestations. You understand all attestors in go-witness and how to use them effectively."}, {"role": "user", "content": "How do I create a witness policy for a build step that uses these attestors: git, commandrun, github?"}, {"role": "assistant", "content": "Here's a complete witness policy for your build step with git, commandrun, github attestors:\n\n**Policy Document:**\n```json\n{\n  \"expires\": \"2026-11-08T10:52:59Z\",\n  \"publickeys\": {\n    \"build-key\": {\n      \"keyid\": \"sha256:12f75e9d95f78f0fb6cf990c4e31140a007dae22b5a3001961538db87ba5d006\",\n      \"key\": \"-----BEGIN PUBLIC KEY-----\\n...\\n-----END PUBLIC KEY-----\"\n    }\n  },\n  \"steps\": {\n    \"build\": {\n      \"name\": \"build\",\n      \"attestations\": [\n        {\n          \"type\": \"https://witness.dev/attestations/git/v0.1\"\n        },\n        {\n          \"type\": \"https://witness.dev/attestations/command-run/v0.1\"\n        },\n        {\n          \"type\": \"https://witness.dev/attestations/github/v0.1\"\n        }\n      ],\n      \"functionaries\": [\n        {\n          \"type\": \"publickey\",\n          \"publickeyid\": \"build-key\"\n        }\n      ]\n    }\n  }\n}\n```\n\n**Witness Run Command:**\n```bash\nwitness run --step build \\\n  --attestations git,commandrun,github \\\n  --outfile build-attestation.json \\\n  --key signing-key.pem \\\n  -- <your-build-command>\n```\n\n**Rego Validation Rules:**\n```rego\npackage git\n\nimport rego.v1\n\n# Enforce builds from specific branch\ndeny contains msg if {\n    input.branch != \"staging\"\n    msg := sprintf(\"Must build from staging branch, got: %s\", [input.branch])\n}\n\n# Require clean working directory\ndeny contains msg if {\n    count(input.status) > 0\n    msg := \"Working directory must be clean (no uncommitted changes)\"\n}\n\n# Validate commit author\napproved_authors := {\n    \"alice.smith@example.com\",\n    \"bob.jones@company.com\",\n    \"ci-bot@company.com\"\n}\n\ndeny contains msg if {\n    not input.authoremail in approved_authors\n    msg := sprintf(\"Unauthorized commit author: %s\", [input.authoremail])\n}\n```\n\n**Verification:**\n```bash\nwitness verify \\\n  --policy policy-signed.json \\\n  --publickey policy-key.pub \\\n  -a build-attestation.json \\\n  --subject <artifact>\n```\n"}]}
{"messages": [{"role": "system", "content": "You are an expert in the Witness supply chain attestation framework. You help users instrument CI/CD pipelines with witness, create policy documents, and write Rego policies to validate attestations. You understand all attestors in go-witness and how to use them effectively."}, {"role": "user", "content": "How do I create a witness policy for a build step that uses these attestors: commandrun?"}, {"role": "assistant", "content": "Here's a complete witness policy for your build step with commandrun attestors:\n\n**Policy Document:**\n```json\n{\n  \"expires\": \"2026-11-08T10:52:59Z\",\n  \"publickeys\": {\n    \"build-key\": {\n      \"keyid\": \"sha256:9807d869ab34525f901b1acbc6932782f427b2b1955472529223b7aaef8a3d1b\",\n      \"key\": \"-----BEGIN PUBLIC KEY-----\\n...\\n-----END PUBLIC KEY-----\"\n    }\n  },\n  \"steps\": {\n    \"build\": {\n      \"name\": \"build\",\n      \"attestations\": [\n        {\n          \"type\": \"https://witness.dev/attestations/command-run/v0.1\"\n        }\n      ],\n      \"functionaries\": [\n        {\n          \"type\": \"publickey\",\n          \"publickeyid\": \"build-key\"\n        }\n      ]\n    }\n  }\n}\n```\n\n**Witness Run Command:**\n```bash\nwitness run --step build \\\n  --attestations commandrun \\\n  --outfile build-attestation.json \\\n  --key signing-key.pem \\\n  -- <your-build-command>\n```\n\n**Rego Validation Rules:**\n```rego\n\n```\n\n**Verification:**\n```bash\nwitness verify \\\n  --policy policy-signed.json \\\n  --publickey policy-key.pub \\\n  -a build-attestation.json \\\n  --subject <artifact>\n```\n"}]}
{"messages": [{"role": "system", "content": "You are an expert in the Witness supply chain attestation framework. You help users instrument CI/CD pipelines with witness, create policy documents, and write Rego policies to validate attestations. You understand all attestors in go-witness and how to use them effectively."}, {"role": "user", "content": "How do I create a witness policy for a build step that uses these attestors: product, git, environment, material, github?"}, {"role": "assistant", "content": "Here's a complete witness policy for your build step with product, git, environment, material, github attestors:\n\n**Policy Document:**\n```json\n{\n  \"expires\": \"2026-11-08T10:52:59Z\",\n  \"publickeys\": {\n    \"build-key\": {\n      \"keyid\": \"sha256:3bb41c0aa39a101f3abb2dfe90d05a171e7cc626f501b50fc0e00687a415ecf3\",\n      \"key\": \"-----BEGIN PUBLIC KEY-----\\n...\\n-----END PUBLIC KEY-----\"\n    }\n  },\n  \"steps\": {\n    \"build\": {\n      \"name\": \"build\",\n      \"attestations\": [\n        {\n          \"type\": \"https://witness.dev/attestations/product/v0.1\"\n        },\n        {\n          \"type\": \"https://witness.dev/attestations/git/v0.1\"\n        },\n        {\n          \"type\": \"https://witness.dev/attestations/environment/v0.1\"\n        },\n        {\n          \"type\": \"https://witness.dev/attestations/material/v0.1\"\n        },\n        {\n          \"type\": \"https://witness.dev/attestations/github/v0.1\"\n        }\n      ],\n      \"functionaries\": [\n        {\n          \"type\": \"publickey\",\n          \"publickeyid\": \"build-key\"\n        }\n      ]\n    }\n  }\n}\n```\n\n**Witness Run Command:**\n```bash\nwitness run --step build \\\n  --attestations product,git,environment,material,github \\\n  --outfile build-attestation.json \\\n  --key signing-key.pem \\\n  -- <your-build-command>\n```\n\n**Rego Validation Rules:**\n```rego\n\n```\n\n**Verification:**\n```bash\nwitness verify \\\n  --policy policy-signed.json \\\n  --publickey policy-key.pub \\\n  -a build-attestation.json \\\n  --subject <artifact>\n```\n"}]}
{"messages": [{"role": "system", "content": "You are an expert in the Witness supply chain attestation framework. You help users instrument CI/CD pipelines with witness, create policy documents, and write Rego policies to validate attestations. You understand all attestors in go-witness and how to use them effectively."}, {"role": "user", "content": "How do I create a witness policy for a build step that uses these attestors: environment, product, material, git?"}, {"role": "assistant", "content": "Here's a complete witness policy for your build step with environment, product, material, git attestors:\n\n**Policy Document:**\n```json\n{\n  \"expires\": \"2026-11-08T10:52:59Z\",\n  \"publickeys\": {\n    \"build-key\": {\n      \"keyid\": \"sha256:1690f3e474dfa182a640f130600b2dc6c948e4daf88f8b8030839cf8d26902ff\",\n      \"key\": \"-----BEGIN PUBLIC KEY-----\\n...\\n-----END PUBLIC KEY-----\"\n    }\n  },\n  \"steps\": {\n    \"build\": {\n      \"name\": \"build\",\n      \"attestations\": [\n        {\n          \"type\": \"https://witness.dev/attestations/environment/v0.1\"\n        },\n        {\n          \"type\": \"https://witness.dev/attestations/product/v0.1\"\n        },\n        {\n          \"type\": \"https://witness.dev/attestations/material/v0.1\"\n        },\n        {\n          \"type\": \"https://witness.dev/attestations/git/v0.1\"\n        }\n      ],\n      \"functionaries\": [\n        {\n          \"type\": \"publickey\",\n          \"publickeyid\": \"build-key\"\n        }\n      ]\n    }\n  }\n}\n```\n\n**Witness Run Command:**\n```bash\nwitness run --step build \\\n  --attestations environment,product,material,git \\\n  --outfile build-attestation.json \\\n  --key signing-key.pem \\\n  -- <your-build-command>\n```\n\n**Rego Validation Rules:**\n```rego\npackage environment\n\nimport rego.v1\n\n# Ensure correct OS\ndeny contains msg if {\n    input.os != \"darwin\"\n    msg := sprintf(\"Must run on darwin, got: %s\", [input.os])\n}\n\n# Require CI environment\ndeny contains msg if {\n    not \"CI\" in input.variables\n    msg := \"Must run in CI environment (CI variable not set)\"\n}\n```\n\n**Verification:**\n```bash\nwitness verify \\\n  --policy policy-signed.json \\\n  --publickey policy-key.pub \\\n  -a build-attestation.json \\\n  --subject <artifact>\n```\n"}]}
{"messages": [{"role": "system", "content": "You are an expert in the Witness supply chain attestation framework. You help users instrument CI/CD pipelines with witness, create policy documents, and write Rego policies to validate attestations. You understand all attestors in go-witness and how to use them effectively."}, {"role": "user", "content": "How do I create a multi-step witness policy for a build \u2192 test \u2192 package pipeline?"}, {"role": "assistant", "content": "Here's a complete multi-step witness policy for your pipeline:\n\n**Policy Document:**\n```json\n{\n  \"expires\": \"2026-11-08T10:52:59Z\",\n  \"publickeys\": {\n    \"ci-key\": {\n      \"keyid\": \"sha256:c6515fd5610099c5217b723152a1c844c68a1e79af602d52ae540fb259843623\",\n      \"key\": \"-----BEGIN PUBLIC KEY-----\\n...\\n-----END PUBLIC KEY-----\"\n    }\n  },\n  \"steps\": {\n    \"build\": {\n      \"name\": \"build\",\n      \"attestations\": [\n        {\n          \"type\": \"https://witness.dev/attestations/git/v0.1\"\n        },\n        {\n          \"type\": \"https://witness.dev/attestations/command-run/v0.1\"\n        },\n        {\n          \"type\": \"https://witness.dev/attestations/product/v0.1\"\n        }\n      ],\n      \"functionaries\": [\n        {\n          \"type\": \"publickey\",\n          \"publickeyid\": \"ci-key\"\n        }\n      ]\n    },\n    \"test\": {\n      \"name\": \"test\",\n      \"attestations\": [\n        {\n          \"type\": \"https://witness.dev/attestations/material/v0.1\"\n        },\n        {\n          \"type\": \"https://witness.dev/attestations/command-run/v0.1\"\n        }\n      ],\n      \"functionaries\": [\n        {\n          \"type\": \"publickey\",\n          \"publickeyid\": \"ci-key\"\n        }\n      ]\n    },\n    \"package\": {\n      \"name\": \"package\",\n      \"attestations\": [\n        {\n          \"type\": \"https://witness.dev/attestations/material/v0.1\"\n        },\n        {\n          \"type\": \"https://witness.dev/attestations/product/v0.1\"\n        }\n      ],\n      \"functionaries\": [\n        {\n          \"type\": \"publickey\",\n          \"publickeyid\": \"ci-key\"\n        }\n      ]\n    }\n  }\n}\n```\n\n**Pipeline Commands:**\n\n```bash\n# Step 1: Build\nwitness run --step build \\\n  --attestations git,commandrun,product \\\n  -o build.json --key ci-key.pem \\\n  -- go build -o myapp\n\n# Step 2: Test\nwitness run --step test \\\n  --attestations material,commandrun \\\n  -o test.json --key ci-key.pem \\\n  -- go test ./...\n\n# Step 3: Package\nwitness run --step package \\\n  --attestations material,product \\\n  -o package.json --key ci-key.pem \\\n  -- tar czf myapp.tar.gz myapp\n\n# Verify entire pipeline\nwitness verify \\\n  --policy policy-signed.json \\\n  --publickey policy-key.pub \\\n  -a build.json -a test.json -a package.json\n```\n"}]}
{"messages": [{"role": "system", "content": "You are an expert in the Witness supply chain attestation framework. You help users instrument CI/CD pipelines with witness, create policy documents, and write Rego policies to validate attestations. You understand all attestors in go-witness and how to use them effectively."}, {"role": "user", "content": "How do I create a witness policy for a build step that uses these attestors: product, environment, commandrun, git?"}, {"role": "assistant", "content": "Here's a complete witness policy for your build step with product, environment, commandrun, git attestors:\n\n**Policy Document:**\n```json\n{\n  \"expires\": \"2026-11-08T10:52:59Z\",\n  \"publickeys\": {\n    \"build-key\": {\n      \"keyid\": \"sha256:253c579a0cd1e5bd655f4b8cf08e8e1578365d0686fd07ac86a8ffb9e9305814\",\n      \"key\": \"-----BEGIN PUBLIC KEY-----\\n...\\n-----END PUBLIC KEY-----\"\n    }\n  },\n  \"steps\": {\n    \"build\": {\n      \"name\": \"build\",\n      \"attestations\": [\n        {\n          \"type\": \"https://witness.dev/attestations/product/v0.1\"\n        },\n        {\n          \"type\": \"https://witness.dev/attestations/environment/v0.1\"\n        },\n        {\n          \"type\": \"https://witness.dev/attestations/command-run/v0.1\"\n        },\n        {\n          \"type\": \"https://witness.dev/attestations/git/v0.1\"\n        }\n      ],\n      \"functionaries\": [\n        {\n          \"type\": \"publickey\",\n          \"publickeyid\": \"build-key\"\n        }\n      ]\n    }\n  }\n}\n```\n\n**Witness Run Command:**\n```bash\nwitness run --step build \\\n  --attestations product,environment,commandrun,git \\\n  --outfile build-attestation.json \\\n  --key signing-key.pem \\\n  -- <your-build-command>\n```\n\n**Rego Validation Rules:**\n```rego\n\n```\n\n**Verification:**\n```bash\nwitness verify \\\n  --policy policy-signed.json \\\n  --publickey policy-key.pub \\\n  -a build-attestation.json \\\n  --subject <artifact>\n```\n"}]}
{"messages": [{"role": "system", "content": "You are an expert in the Witness supply chain attestation framework. You help users instrument CI/CD pipelines with witness, create policy documents, and write Rego policies to validate attestations. You understand all attestors in go-witness and how to use them effectively."}, {"role": "user", "content": "How do I create a multi-step witness policy for a build \u2192 test \u2192 package pipeline?"}, {"role": "assistant", "content": "Here's a complete multi-step witness policy for your pipeline:\n\n**Policy Document:**\n```json\n{\n  \"expires\": \"2026-11-08T10:52:59Z\",\n  \"publickeys\": {\n    \"ci-key\": {\n      \"keyid\": \"sha256:6514f02beea427aa3aaa030471d0147bbe60d6f81f44d60c5165080091b73ed4\",\n      \"key\": \"-----BEGIN PUBLIC KEY-----\\n...\\n-----END PUBLIC KEY-----\"\n    }\n  },\n  \"steps\": {\n    \"build\": {\n      \"name\": \"build\",\n      \"attestations\": [\n        {\n          \"type\": \"https://witness.dev/attestations/git/v0.1\"\n        },\n        {\n          \"type\": \"https://witness.dev/attestations/command-run/v0.1\"\n        },\n        {\n          \"type\": \"https://witness.dev/attestations/product/v0.1\"\n        }\n      ],\n      \"functionaries\": [\n        {\n          \"type\": \"publickey\",\n          \"publickeyid\": \"ci-key\"\n        }\n      ]\n    },\n    \"test\": {\n      \"name\": \"test\",\n      \"attestations\": [\n        {\n          \"type\": \"https://witness.dev/attestations/material/v0.1\"\n        },\n        {\n          \"type\": \"https://witness.dev/attestations/command-run/v0.1\"\n        }\n      ],\n      \"functionaries\": [\n        {\n          \"type\": \"publickey\",\n          \"publickeyid\": \"ci-key\"\n        }\n      ]\n    },\n    \"package\": {\n      \"name\": \"package\",\n      \"attestations\": [\n        {\n          \"type\": \"https://witness.dev/attestations/material/v0.1\"\n        },\n        {\n          \"type\": \"https://witness.dev/attestations/product/v0.1\"\n        }\n      ],\n      \"functionaries\": [\n        {\n          \"type\": \"publickey\",\n          \"publickeyid\": \"ci-key\"\n        }\n      ]\n    }\n  }\n}\n```\n\n**Pipeline Commands:**\n\n```bash\n# Step 1: Build\nwitness run --step build \\\n  --attestations git,commandrun,product \\\n  -o build.json --key ci-key.pem \\\n  -- go build -o myapp\n\n# Step 2: Test\nwitness run --step test \\\n  --attestations material,commandrun \\\n  -o test.json --key ci-key.pem \\\n  -- go test ./...\n\n# Step 3: Package\nwitness run --step package \\\n  --attestations material,product \\\n  -o package.json --key ci-key.pem \\\n  -- tar czf myapp.tar.gz myapp\n\n# Verify entire pipeline\nwitness verify \\\n  --policy policy-signed.json \\\n  --publickey policy-key.pub \\\n  -a build.json -a test.json -a package.json\n```\n"}]}
{"messages": [{"role": "system", "content": "You are an expert in the Witness supply chain attestation framework. You help users instrument CI/CD pipelines with witness, create policy documents, and write Rego policies to validate attestations. You understand all attestors in go-witness and how to use them effectively."}, {"role": "user", "content": "How do I create a witness policy for a build step that uses these attestors: github?"}, {"role": "assistant", "content": "Here's a complete witness policy for your build step with github attestors:\n\n**Policy Document:**\n```json\n{\n  \"expires\": \"2026-11-08T10:52:59Z\",\n  \"publickeys\": {\n    \"build-key\": {\n      \"keyid\": \"sha256:7eeda873795098d83faa263004a1cfa86cc15b935df59a1a6fad710fa350990f\",\n      \"key\": \"-----BEGIN PUBLIC KEY-----\\n...\\n-----END PUBLIC KEY-----\"\n    }\n  },\n  \"steps\": {\n    \"build\": {\n      \"name\": \"build\",\n      \"attestations\": [\n        {\n          \"type\": \"https://witness.dev/attestations/github/v0.1\"\n        }\n      ],\n      \"functionaries\": [\n        {\n          \"type\": \"publickey\",\n          \"publickeyid\": \"build-key\"\n        }\n      ]\n    }\n  }\n}\n```\n\n**Witness Run Command:**\n```bash\nwitness run --step build \\\n  --attestations github \\\n  --outfile build-attestation.json \\\n  --key signing-key.pem \\\n  -- <your-build-command>\n```\n\n**Rego Validation Rules:**\n```rego\n\n```\n\n**Verification:**\n```bash\nwitness verify \\\n  --policy policy-signed.json \\\n  --publickey policy-key.pub \\\n  -a build-attestation.json \\\n  --subject <artifact>\n```\n"}]}
{"messages": [{"role": "system", "content": "You are an expert in the Witness supply chain attestation framework. You help users instrument CI/CD pipelines with witness, create policy documents, and write Rego policies to validate attestations. You understand all attestors in go-witness and how to use them effectively."}, {"role": "user", "content": "How do I create a witness policy for a build step that uses these attestors: github, git, commandrun?"}, {"role": "assistant", "content": "Here's a complete witness policy for your build step with github, git, commandrun attestors:\n\n**Policy Document:**\n```json\n{\n  \"expires\": \"2026-11-08T10:52:59Z\",\n  \"publickeys\": {\n    \"build-key\": {\n      \"keyid\": \"sha256:2db39ee9d6b7044463a28f23d0385a64b7556de8ef3eb05c8a37adcdaf039105\",\n      \"key\": \"-----BEGIN PUBLIC KEY-----\\n...\\n-----END PUBLIC KEY-----\"\n    }\n  },\n  \"steps\": {\n    \"build\": {\n      \"name\": \"build\",\n      \"attestations\": [\n        {\n          \"type\": \"https://witness.dev/attestations/github/v0.1\"\n        },\n        {\n          \"type\": \"https://witness.dev/attestations/git/v0.1\"\n        },\n        {\n          \"type\": \"https://witness.dev/attestations/command-run/v0.1\"\n        }\n      ],\n      \"functionaries\": [\n        {\n          \"type\": \"publickey\",\n          \"publickeyid\": \"build-key\"\n        }\n      ]\n    }\n  }\n}\n```\n\n**Witness Run Command:**\n```bash\nwitness run --step build \\\n  --attestations github,git,commandrun \\\n  --outfile build-attestation.json \\\n  --key signing-key.pem \\\n  -- <your-build-command>\n```\n\n**Rego Validation Rules:**\n```rego\n\n```\n\n**Verification:**\n```bash\nwitness verify \\\n  --policy policy-signed.json \\\n  --publickey policy-key.pub \\\n  -a build-attestation.json \\\n  --subject <artifact>\n```\n"}]}
{"messages": [{"role": "system", "content": "You are an expert in the Witness supply chain attestation framework. You help users instrument CI/CD pipelines with witness, create policy documents, and write Rego policies to validate attestations. You understand all attestors in go-witness and how to use them effectively."}, {"role": "user", "content": "How do I create a multi-step witness policy for a build \u2192 test \u2192 package pipeline?"}, {"role": "assistant", "content": "Here's a complete multi-step witness policy for your pipeline:\n\n**Policy Document:**\n```json\n{\n  \"expires\": \"2026-11-08T10:52:59Z\",\n  \"publickeys\": {\n    \"ci-key\": {\n      \"keyid\": \"sha256:60d3838611f615384a78a6c3079e8225948cba7792bf16795dbe5499374937cf\",\n      \"key\": \"-----BEGIN PUBLIC KEY-----\\n...\\n-----END PUBLIC KEY-----\"\n    }\n  },\n  \"steps\": {\n    \"build\": {\n      \"name\": \"build\",\n      \"attestations\": [\n        {\n          \"type\": \"https://witness.dev/attestations/git/v0.1\"\n        },\n        {\n          \"type\": \"https://witness.dev/attestations/command-run/v0.1\"\n        },\n        {\n          \"type\": \"https://witness.dev/attestations/product/v0.1\"\n        }\n      ],\n      \"functionaries\": [\n        {\n          \"type\": \"publickey\",\n          \"publickeyid\": \"ci-key\"\n        }\n      ]\n    },\n    \"test\": {\n      \"name\": \"test\",\n      \"attestations\": [\n        {\n          \"type\": \"https://witness.dev/attestations/material/v0.1\"\n        },\n        {\n          \"type\": \"https://witness.dev/attestations/command-run/v0.1\"\n        }\n      ],\n      \"functionaries\": [\n        {\n          \"type\": \"publickey\",\n          \"publickeyid\": \"ci-key\"\n        }\n      ]\n    },\n    \"package\": {\n      \"name\": \"package\",\n      \"attestations\": [\n        {\n          \"type\": \"https://witness.dev/attestations/material/v0.1\"\n        },\n        {\n          \"type\": \"https://witness.dev/attestations/product/v0.1\"\n        }\n      ],\n      \"functionaries\": [\n        {\n          \"type\": \"publickey\",\n          \"publickeyid\": \"ci-key\"\n        }\n      ]\n    }\n  }\n}\n```\n\n**Pipeline Commands:**\n\n```bash\n# Step 1: Build\nwitness run --step build \\\n  --attestations git,commandrun,product \\\n  -o build.json --key ci-key.pem \\\n  -- go build -o myapp\n\n# Step 2: Test\nwitness run --step test \\\n  --attestations material,commandrun \\\n  -o test.json --key ci-key.pem \\\n  -- go test ./...\n\n# Step 3: Package\nwitness run --step package \\\n  --attestations material,product \\\n  -o package.json --key ci-key.pem \\\n  -- tar czf myapp.tar.gz myapp\n\n# Verify entire pipeline\nwitness verify \\\n  --policy policy-signed.json \\\n  --publickey policy-key.pub \\\n  -a build.json -a test.json -a package.json\n```\n"}]}
{"messages": [{"role": "system", "content": "You are an expert in the Witness supply chain attestation framework. You help users instrument CI/CD pipelines with witness, create policy documents, and write Rego policies to validate attestations. You understand all attestors in go-witness and how to use them effectively."}, {"role": "user", "content": "How do I create a multi-step witness policy for a build \u2192 test \u2192 package pipeline?"}, {"role": "assistant", "content": "Here's a complete multi-step witness policy for your pipeline:\n\n**Policy Document:**\n```json\n{\n  \"expires\": \"2026-11-08T10:52:59Z\",\n  \"publickeys\": {\n    \"ci-key\": {\n      \"keyid\": \"sha256:7c94a32468b52089cb443e1679f95c247c5b7a028498c58c68ed9f28aff9ddc6\",\n      \"key\": \"-----BEGIN PUBLIC KEY-----\\n...\\n-----END PUBLIC KEY-----\"\n    }\n  },\n  \"steps\": {\n    \"build\": {\n      \"name\": \"build\",\n      \"attestations\": [\n        {\n          \"type\": \"https://witness.dev/attestations/git/v0.1\"\n        },\n        {\n          \"type\": \"https://witness.dev/attestations/command-run/v0.1\"\n        },\n        {\n          \"type\": \"https://witness.dev/attestations/product/v0.1\"\n        }\n      ],\n      \"functionaries\": [\n        {\n          \"type\": \"publickey\",\n          \"publickeyid\": \"ci-key\"\n        }\n      ]\n    },\n    \"test\": {\n      \"name\": \"test\",\n      \"attestations\": [\n        {\n          \"type\": \"https://witness.dev/attestations/material/v0.1\"\n        },\n        {\n          \"type\": \"https://witness.dev/attestations/command-run/v0.1\"\n        }\n      ],\n      \"functionaries\": [\n        {\n          \"type\": \"publickey\",\n          \"publickeyid\": \"ci-key\"\n        }\n      ]\n    },\n    \"package\": {\n      \"name\": \"package\",\n      \"attestations\": [\n        {\n          \"type\": \"https://witness.dev/attestations/material/v0.1\"\n        },\n        {\n          \"type\": \"https://witness.dev/attestations/product/v0.1\"\n        }\n      ],\n      \"functionaries\": [\n        {\n          \"type\": \"publickey\",\n          \"publickeyid\": \"ci-key\"\n        }\n      ]\n    }\n  }\n}\n```\n\n**Pipeline Commands:**\n\n```bash\n# Step 1: Build\nwitness run --step build \\\n  --attestations git,commandrun,product \\\n  -o build.json --key ci-key.pem \\\n  -- go build -o myapp\n\n# Step 2: Test\nwitness run --step test \\\n  --attestations material,commandrun \\\n  -o test.json --key ci-key.pem \\\n  -- go test ./...\n\n# Step 3: Package\nwitness run --step package \\\n  --attestations material,product \\\n  -o package.json --key ci-key.pem \\\n  -- tar czf myapp.tar.gz myapp\n\n# Verify entire pipeline\nwitness verify \\\n  --policy policy-signed.json \\\n  --publickey policy-key.pub \\\n  -a build.json -a test.json -a package.json\n```\n"}]}
{"messages": [{"role": "system", "content": "You are an expert in the Witness supply chain attestation framework. You help users instrument CI/CD pipelines with witness, create policy documents, and write Rego policies to validate attestations. You understand all attestors in go-witness and how to use them effectively."}, {"role": "user", "content": "How do I create a multi-step witness policy for a build \u2192 test \u2192 package pipeline?"}, {"role": "assistant", "content": "Here's a complete multi-step witness policy for your pipeline:\n\n**Policy Document:**\n```json\n{\n  \"expires\": \"2026-11-08T10:52:59Z\",\n  \"publickeys\": {\n    \"ci-key\": {\n      \"keyid\": \"sha256:8ce2f21734e0c01372c72a2410c5d23a041c5f0fa43d4ae699b5fc45d1652844\",\n      \"key\": \"-----BEGIN PUBLIC KEY-----\\n...\\n-----END PUBLIC KEY-----\"\n    }\n  },\n  \"steps\": {\n    \"build\": {\n      \"name\": \"build\",\n      \"attestations\": [\n        {\n          \"type\": \"https://witness.dev/attestations/git/v0.1\"\n        },\n        {\n          \"type\": \"https://witness.dev/attestations/command-run/v0.1\"\n        },\n        {\n          \"type\": \"https://witness.dev/attestations/product/v0.1\"\n        }\n      ],\n      \"functionaries\": [\n        {\n          \"type\": \"publickey\",\n          \"publickeyid\": \"ci-key\"\n        }\n      ]\n    },\n    \"test\": {\n      \"name\": \"test\",\n      \"attestations\": [\n        {\n          \"type\": \"https://witness.dev/attestations/material/v0.1\"\n        },\n        {\n          \"type\": \"https://witness.dev/attestations/command-run/v0.1\"\n        }\n      ],\n      \"functionaries\": [\n        {\n          \"type\": \"publickey\",\n          \"publickeyid\": \"ci-key\"\n        }\n      ]\n    },\n    \"package\": {\n      \"name\": \"package\",\n      \"attestations\": [\n        {\n          \"type\": \"https://witness.dev/attestations/material/v0.1\"\n        },\n        {\n          \"type\": \"https://witness.dev/attestations/product/v0.1\"\n        }\n      ],\n      \"functionaries\": [\n        {\n          \"type\": \"publickey\",\n          \"publickeyid\": \"ci-key\"\n        }\n      ]\n    }\n  }\n}\n```\n\n**Pipeline Commands:**\n\n```bash\n# Step 1: Build\nwitness run --step build \\\n  --attestations git,commandrun,product \\\n  -o build.json --key ci-key.pem \\\n  -- go build -o myapp\n\n# Step 2: Test\nwitness run --step test \\\n  --attestations material,commandrun \\\n  -o test.json --key ci-key.pem \\\n  -- go test ./...\n\n# Step 3: Package\nwitness run --step package \\\n  --attestations material,product \\\n  -o package.json --key ci-key.pem \\\n  -- tar czf myapp.tar.gz myapp\n\n# Verify entire pipeline\nwitness verify \\\n  --policy policy-signed.json \\\n  --publickey policy-key.pub \\\n  -a build.json -a test.json -a package.json\n```\n"}]}
{"messages": [{"role": "system", "content": "You are an expert in the Witness supply chain attestation framework. You help users instrument CI/CD pipelines with witness, create policy documents, and write Rego policies to validate attestations. You understand all attestors in go-witness and how to use them effectively."}, {"role": "user", "content": "How do I create a witness policy for a build step that uses these attestors: commandrun, github, product?"}, {"role": "assistant", "content": "Here's a complete witness policy for your build step with commandrun, github, product attestors:\n\n**Policy Document:**\n```json\n{\n  \"expires\": \"2026-11-08T10:52:59Z\",\n  \"publickeys\": {\n    \"build-key\": {\n      \"keyid\": \"sha256:4b2a4056fd180f8639946152756f1cb83859c2484fcb8491b8ed199558eaf2cd\",\n      \"key\": \"-----BEGIN PUBLIC KEY-----\\n...\\n-----END PUBLIC KEY-----\"\n    }\n  },\n  \"steps\": {\n    \"build\": {\n      \"name\": \"build\",\n      \"attestations\": [\n        {\n          \"type\": \"https://witness.dev/attestations/command-run/v0.1\"\n        },\n        {\n          \"type\": \"https://witness.dev/attestations/github/v0.1\"\n        },\n        {\n          \"type\": \"https://witness.dev/attestations/product/v0.1\"\n        }\n      ],\n      \"functionaries\": [\n        {\n          \"type\": \"publickey\",\n          \"publickeyid\": \"build-key\"\n        }\n      ]\n    }\n  }\n}\n```\n\n**Witness Run Command:**\n```bash\nwitness run --step build \\\n  --attestations commandrun,github,product \\\n  --outfile build-attestation.json \\\n  --key signing-key.pem \\\n  -- <your-build-command>\n```\n\n**Rego Validation Rules:**\n```rego\n\n```\n\n**Verification:**\n```bash\nwitness verify \\\n  --policy policy-signed.json \\\n  --publickey policy-key.pub \\\n  -a build-attestation.json \\\n  --subject <artifact>\n```\n"}]}
{"messages": [{"role": "system", "content": "You are an expert in the Witness supply chain attestation framework. You help users instrument CI/CD pipelines with witness, create policy documents, and write Rego policies to validate attestations. You understand all attestors in go-witness and how to use them effectively."}, {"role": "user", "content": "How do I create a witness policy for a build step that uses these attestors: product, git?"}, {"role": "assistant", "content": "Here's a complete witness policy for your build step with product, git attestors:\n\n**Policy Document:**\n```json\n{\n  \"expires\": \"2026-11-08T10:52:59Z\",\n  \"publickeys\": {\n    \"build-key\": {\n      \"keyid\": \"sha256:3c9ab55c3eed1f70f6c58a266457474109113f5f132b6f90a37667fcbfe02b77\",\n      \"key\": \"-----BEGIN PUBLIC KEY-----\\n...\\n-----END PUBLIC KEY-----\"\n    }\n  },\n  \"steps\": {\n    \"build\": {\n      \"name\": \"build\",\n      \"attestations\": [\n        {\n          \"type\": \"https://witness.dev/attestations/product/v0.1\"\n        },\n        {\n          \"type\": \"https://witness.dev/attestations/git/v0.1\"\n        }\n      ],\n      \"functionaries\": [\n        {\n          \"type\": \"publickey\",\n          \"publickeyid\": \"build-key\"\n        }\n      ]\n    }\n  }\n}\n```\n\n**Witness Run Command:**\n```bash\nwitness run --step build \\\n  --attestations product,git \\\n  --outfile build-attestation.json \\\n  --key signing-key.pem \\\n  -- <your-build-command>\n```\n\n**Rego Validation Rules:**\n```rego\n\n```\n\n**Verification:**\n```bash\nwitness verify \\\n  --policy policy-signed.json \\\n  --publickey policy-key.pub \\\n  -a build-attestation.json \\\n  --subject <artifact>\n```\n"}]}
{"messages": [{"role": "system", "content": "You are an expert in the Witness supply chain attestation framework. You help users instrument CI/CD pipelines with witness, create policy documents, and write Rego policies to validate attestations. You understand all attestors in go-witness and how to use them effectively."}, {"role": "user", "content": "How do I create a witness policy for a build step that uses these attestors: product?"}, {"role": "assistant", "content": "Here's a complete witness policy for your build step with product attestors:\n\n**Policy Document:**\n```json\n{\n  \"expires\": \"2026-11-08T10:52:59Z\",\n  \"publickeys\": {\n    \"build-key\": {\n      \"keyid\": \"sha256:8bee9bfce4d843d4e979643a4fbf81c6aeee4e181ded1de946a6753f41e2f423\",\n      \"key\": \"-----BEGIN PUBLIC KEY-----\\n...\\n-----END PUBLIC KEY-----\"\n    }\n  },\n  \"steps\": {\n    \"build\": {\n      \"name\": \"build\",\n      \"attestations\": [\n        {\n          \"type\": \"https://witness.dev/attestations/product/v0.1\"\n        }\n      ],\n      \"functionaries\": [\n        {\n          \"type\": \"publickey\",\n          \"publickeyid\": \"build-key\"\n        }\n      ]\n    }\n  }\n}\n```\n\n**Witness Run Command:**\n```bash\nwitness run --step build \\\n  --attestations product \\\n  --outfile build-attestation.json \\\n  --key signing-key.pem \\\n  -- <your-build-command>\n```\n\n**Rego Validation Rules:**\n```rego\n\n```\n\n**Verification:**\n```bash\nwitness verify \\\n  --policy policy-signed.json \\\n  --publickey policy-key.pub \\\n  -a build-attestation.json \\\n  --subject <artifact>\n```\n"}]}
{"messages": [{"role": "system", "content": "You are an expert in the Witness supply chain attestation framework. You help users instrument CI/CD pipelines with witness, create policy documents, and write Rego policies to validate attestations. You understand all attestors in go-witness and how to use them effectively."}, {"role": "user", "content": "How do I create a witness policy for a build step that uses these attestors: product, commandrun?"}, {"role": "assistant", "content": "Here's a complete witness policy for your build step with product, commandrun attestors:\n\n**Policy Document:**\n```json\n{\n  \"expires\": \"2026-11-08T10:52:59Z\",\n  \"publickeys\": {\n    \"build-key\": {\n      \"keyid\": \"sha256:16f8556e54e33b4df90facef826fc0a3e98ea2292538fc42d01837f5319b91ef\",\n      \"key\": \"-----BEGIN PUBLIC KEY-----\\n...\\n-----END PUBLIC KEY-----\"\n    }\n  },\n  \"steps\": {\n    \"build\": {\n      \"name\": \"build\",\n      \"attestations\": [\n        {\n          \"type\": \"https://witness.dev/attestations/product/v0.1\"\n        },\n        {\n          \"type\": \"https://witness.dev/attestations/command-run/v0.1\"\n        }\n      ],\n      \"functionaries\": [\n        {\n          \"type\": \"publickey\",\n          \"publickeyid\": \"build-key\"\n        }\n      ]\n    }\n  }\n}\n```\n\n**Witness Run Command:**\n```bash\nwitness run --step build \\\n  --attestations product,commandrun \\\n  --outfile build-attestation.json \\\n  --key signing-key.pem \\\n  -- <your-build-command>\n```\n\n**Rego Validation Rules:**\n```rego\n\n```\n\n**Verification:**\n```bash\nwitness verify \\\n  --policy policy-signed.json \\\n  --publickey policy-key.pub \\\n  -a build-attestation.json \\\n  --subject <artifact>\n```\n"}]}
{"messages": [{"role": "system", "content": "You are an expert in the Witness supply chain attestation framework. You help users instrument CI/CD pipelines with witness, create policy documents, and write Rego policies to validate attestations. You understand all attestors in go-witness and how to use them effectively."}, {"role": "user", "content": "How do I create a witness policy for a build step that uses these attestors: environment?"}, {"role": "assistant", "content": "Here's a complete witness policy for your build step with environment attestors:\n\n**Policy Document:**\n```json\n{\n  \"expires\": \"2026-11-08T10:52:59Z\",\n  \"publickeys\": {\n    \"build-key\": {\n      \"keyid\": \"sha256:628f7b9fdf6cb7c1c2c2ad4ce09b59cd05a6457c9c4b3eebcf61c88fc8639986\",\n      \"key\": \"-----BEGIN PUBLIC KEY-----\\n...\\n-----END PUBLIC KEY-----\"\n    }\n  },\n  \"steps\": {\n    \"build\": {\n      \"name\": \"build\",\n      \"attestations\": [\n        {\n          \"type\": \"https://witness.dev/attestations/environment/v0.1\"\n        }\n      ],\n      \"functionaries\": [\n        {\n          \"type\": \"publickey\",\n          \"publickeyid\": \"build-key\"\n        }\n      ]\n    }\n  }\n}\n```\n\n**Witness Run Command:**\n```bash\nwitness run --step build \\\n  --attestations environment \\\n  --outfile build-attestation.json \\\n  --key signing-key.pem \\\n  -- <your-build-command>\n```\n\n**Rego Validation Rules:**\n```rego\npackage environment\n\nimport rego.v1\n\n# Ensure correct OS\ndeny contains msg if {\n    input.os != \"linux\"\n    msg := sprintf(\"Must run on linux, got: %s\", [input.os])\n}\n\n# Require CI environment\ndeny contains msg if {\n    not \"CI\" in input.variables\n    msg := \"Must run in CI environment (CI variable not set)\"\n}\n```\n\n**Verification:**\n```bash\nwitness verify \\\n  --policy policy-signed.json \\\n  --publickey policy-key.pub \\\n  -a build-attestation.json \\\n  --subject <artifact>\n```\n"}]}
{"messages": [{"role": "system", "content": "You are an expert in the Witness supply chain attestation framework. You help users instrument CI/CD pipelines with witness, create policy documents, and write Rego policies to validate attestations. You understand all attestors in go-witness and how to use them effectively."}, {"role": "user", "content": "How do I create a witness policy for a build step that uses these attestors: github?"}, {"role": "assistant", "content": "Here's a complete witness policy for your build step with github attestors:\n\n**Policy Document:**\n```json\n{\n  \"expires\": \"2026-11-08T10:52:59Z\",\n  \"publickeys\": {\n    \"build-key\": {\n      \"keyid\": \"sha256:45e9a5a570d7561a24661492a62a659dc09bb5b49dbd8289353d33316e8fe661\",\n      \"key\": \"-----BEGIN PUBLIC KEY-----\\n...\\n-----END PUBLIC KEY-----\"\n    }\n  },\n  \"steps\": {\n    \"build\": {\n      \"name\": \"build\",\n      \"attestations\": [\n        {\n          \"type\": \"https://witness.dev/attestations/github/v0.1\"\n        }\n      ],\n      \"functionaries\": [\n        {\n          \"type\": \"publickey\",\n          \"publickeyid\": \"build-key\"\n        }\n      ]\n    }\n  }\n}\n```\n\n**Witness Run Command:**\n```bash\nwitness run --step build \\\n  --attestations github \\\n  --outfile build-attestation.json \\\n  --key signing-key.pem \\\n  -- <your-build-command>\n```\n\n**Rego Validation Rules:**\n```rego\n\n```\n\n**Verification:**\n```bash\nwitness verify \\\n  --policy policy-signed.json \\\n  --publickey policy-key.pub \\\n  -a build-attestation.json \\\n  --subject <artifact>\n```\n"}]}
{"messages": [{"role": "system", "content": "You are an expert in the Witness supply chain attestation framework. You help users instrument CI/CD pipelines with witness, create policy documents, and write Rego policies to validate attestations. You understand all attestors in go-witness and how to use them effectively."}, {"role": "user", "content": "How do I create a witness policy for a build step that uses these attestors: commandrun?"}, {"role": "assistant", "content": "Here's a complete witness policy for your build step with commandrun attestors:\n\n**Policy Document:**\n```json\n{\n  \"expires\": \"2026-11-08T10:52:59Z\",\n  \"publickeys\": {\n    \"build-key\": {\n      \"keyid\": \"sha256:03e05d1bc6781b05c63f6ca5adea23aabc5ac550d5108c8eb442d093f5138d8e\",\n      \"key\": \"-----BEGIN PUBLIC KEY-----\\n...\\n-----END PUBLIC KEY-----\"\n    }\n  },\n  \"steps\": {\n    \"build\": {\n      \"name\": \"build\",\n      \"attestations\": [\n        {\n          \"type\": \"https://witness.dev/attestations/command-run/v0.1\"\n        }\n      ],\n      \"functionaries\": [\n        {\n          \"type\": \"publickey\",\n          \"publickeyid\": \"build-key\"\n        }\n      ]\n    }\n  }\n}\n```\n\n**Witness Run Command:**\n```bash\nwitness run --step build \\\n  --attestations commandrun \\\n  --outfile build-attestation.json \\\n  --key signing-key.pem \\\n  -- <your-build-command>\n```\n\n**Rego Validation Rules:**\n```rego\n\n```\n\n**Verification:**\n```bash\nwitness verify \\\n  --policy policy-signed.json \\\n  --publickey policy-key.pub \\\n  -a build-attestation.json \\\n  --subject <artifact>\n```\n"}]}
{"messages": [{"role": "system", "content": "You are an expert in the Witness supply chain attestation framework. You help users instrument CI/CD pipelines with witness, create policy documents, and write Rego policies to validate attestations. You understand all attestors in go-witness and how to use them effectively."}, {"role": "user", "content": "How do I create a witness policy for a build step that uses these attestors: git?"}, {"role": "assistant", "content": "Here's a complete witness policy for your build step with git attestors:\n\n**Policy Document:**\n```json\n{\n  \"expires\": \"2026-11-08T10:52:59Z\",\n  \"publickeys\": {\n    \"build-key\": {\n      \"keyid\": \"sha256:5f41e92970eb51f91b6832ac6c7fb1f887cbe93888dda65811efe92061b9814b\",\n      \"key\": \"-----BEGIN PUBLIC KEY-----\\n...\\n-----END PUBLIC KEY-----\"\n    }\n  },\n  \"steps\": {\n    \"build\": {\n      \"name\": \"build\",\n      \"attestations\": [\n        {\n          \"type\": \"https://witness.dev/attestations/git/v0.1\"\n        }\n      ],\n      \"functionaries\": [\n        {\n          \"type\": \"publickey\",\n          \"publickeyid\": \"build-key\"\n        }\n      ]\n    }\n  }\n}\n```\n\n**Witness Run Command:**\n```bash\nwitness run --step build \\\n  --attestations git \\\n  --outfile build-attestation.json \\\n  --key signing-key.pem \\\n  -- <your-build-command>\n```\n\n**Rego Validation Rules:**\n```rego\npackage git\n\nimport rego.v1\n\n# Enforce builds from specific branch\ndeny contains msg if {\n    input.branch != \"feature/auth\"\n    msg := sprintf(\"Must build from feature/auth branch, got: %s\", [input.branch])\n}\n\n# Validate commit author\napproved_authors := {\n    \"alice.smith@example.com\",\n    \"bob.jones@company.com\",\n    \"ci-bot@company.com\"\n}\n\ndeny contains msg if {\n    not input.authoremail in approved_authors\n    msg := sprintf(\"Unauthorized commit author: %s\", [input.authoremail])\n}\n```\n\n**Verification:**\n```bash\nwitness verify \\\n  --policy policy-signed.json \\\n  --publickey policy-key.pub \\\n  -a build-attestation.json \\\n  --subject <artifact>\n```\n"}]}
{"messages": [{"role": "system", "content": "You are an expert in the Witness supply chain attestation framework. You help users instrument CI/CD pipelines with witness, create policy documents, and write Rego policies to validate attestations. You understand all attestors in go-witness and how to use them effectively."}, {"role": "user", "content": "How do I create a multi-step witness policy for a build \u2192 test \u2192 package pipeline?"}, {"role": "assistant", "content": "Here's a complete multi-step witness policy for your pipeline:\n\n**Policy Document:**\n```json\n{\n  \"expires\": \"2026-11-08T10:52:59Z\",\n  \"publickeys\": {\n    \"ci-key\": {\n      \"keyid\": \"sha256:36dc15ebe1bfd23ffe5fe0c0555bd886f55463b40028b346b7c897fff0bfc9d8\",\n      \"key\": \"-----BEGIN PUBLIC KEY-----\\n...\\n-----END PUBLIC KEY-----\"\n    }\n  },\n  \"steps\": {\n    \"build\": {\n      \"name\": \"build\",\n      \"attestations\": [\n        {\n          \"type\": \"https://witness.dev/attestations/git/v0.1\"\n        },\n        {\n          \"type\": \"https://witness.dev/attestations/command-run/v0.1\"\n        },\n        {\n          \"type\": \"https://witness.dev/attestations/product/v0.1\"\n        }\n      ],\n      \"functionaries\": [\n        {\n          \"type\": \"publickey\",\n          \"publickeyid\": \"ci-key\"\n        }\n      ]\n    },\n    \"test\": {\n      \"name\": \"test\",\n      \"attestations\": [\n        {\n          \"type\": \"https://witness.dev/attestations/material/v0.1\"\n        },\n        {\n          \"type\": \"https://witness.dev/attestations/command-run/v0.1\"\n        }\n      ],\n      \"functionaries\": [\n        {\n          \"type\": \"publickey\",\n          \"publickeyid\": \"ci-key\"\n        }\n      ]\n    },\n    \"package\": {\n      \"name\": \"package\",\n      \"attestations\": [\n        {\n          \"type\": \"https://witness.dev/attestations/material/v0.1\"\n        },\n        {\n          \"type\": \"https://witness.dev/attestations/product/v0.1\"\n        }\n      ],\n      \"functionaries\": [\n        {\n          \"type\": \"publickey\",\n          \"publickeyid\": \"ci-key\"\n        }\n      ]\n    }\n  }\n}\n```\n\n**Pipeline Commands:**\n\n```bash\n# Step 1: Build\nwitness run --step build \\\n  --attestations git,commandrun,product \\\n  -o build.json --key ci-key.pem \\\n  -- go build -o myapp\n\n# Step 2: Test\nwitness run --step test \\\n  --attestations material,commandrun \\\n  -o test.json --key ci-key.pem \\\n  -- go test ./...\n\n# Step 3: Package\nwitness run --step package \\\n  --attestations material,product \\\n  -o package.json --key ci-key.pem \\\n  -- tar czf myapp.tar.gz myapp\n\n# Verify entire pipeline\nwitness verify \\\n  --policy policy-signed.json \\\n  --publickey policy-key.pub \\\n  -a build.json -a test.json -a package.json\n```\n"}]}
{"messages": [{"role": "system", "content": "You are an expert in the Witness supply chain attestation framework. You help users instrument CI/CD pipelines with witness, create policy documents, and write Rego policies to validate attestations. You understand all attestors in go-witness and how to use them effectively."}, {"role": "user", "content": "How do I create a witness policy for a build step that uses these attestors: git, commandrun, github?"}, {"role": "assistant", "content": "Here's a complete witness policy for your build step with git, commandrun, github attestors:\n\n**Policy Document:**\n```json\n{\n  \"expires\": \"2026-11-08T10:52:59Z\",\n  \"publickeys\": {\n    \"build-key\": {\n      \"keyid\": \"sha256:4cd9d4ec199e25c93caa01a924cebb6facc31d3a76f72f57ffcc1d51b03f3fde\",\n      \"key\": \"-----BEGIN PUBLIC KEY-----\\n...\\n-----END PUBLIC KEY-----\"\n    }\n  },\n  \"steps\": {\n    \"build\": {\n      \"name\": \"build\",\n      \"attestations\": [\n        {\n          \"type\": \"https://witness.dev/attestations/git/v0.1\"\n        },\n        {\n          \"type\": \"https://witness.dev/attestations/command-run/v0.1\"\n        },\n        {\n          \"type\": \"https://witness.dev/attestations/github/v0.1\"\n        }\n      ],\n      \"functionaries\": [\n        {\n          \"type\": \"publickey\",\n          \"publickeyid\": \"build-key\"\n        }\n      ]\n    }\n  }\n}\n```\n\n**Witness Run Command:**\n```bash\nwitness run --step build \\\n  --attestations git,commandrun,github \\\n  --outfile build-attestation.json \\\n  --key signing-key.pem \\\n  -- <your-build-command>\n```\n\n**Rego Validation Rules:**\n```rego\npackage git\n\nimport rego.v1\n\n# Enforce builds from specific branch\ndeny contains msg if {\n    input.branch != \"staging\"\n    msg := sprintf(\"Must build from staging branch, got: %s\", [input.branch])\n}\n\n# Require clean working directory\ndeny contains msg if {\n    count(input.status) > 0\n    msg := \"Working directory must be clean (no uncommitted changes)\"\n}\n\n# Validate commit author\napproved_authors := {\n    \"alice.smith@example.com\",\n    \"bob.jones@company.com\",\n    \"ci-bot@company.com\"\n}\n\ndeny contains msg if {\n    not input.authoremail in approved_authors\n    msg := sprintf(\"Unauthorized commit author: %s\", [input.authoremail])\n}\n```\n\n**Verification:**\n```bash\nwitness verify \\\n  --policy policy-signed.json \\\n  --publickey policy-key.pub \\\n  -a build-attestation.json \\\n  --subject <artifact>\n```\n"}]}
{"messages": [{"role": "system", "content": "You are an expert in the Witness supply chain attestation framework. You help users instrument CI/CD pipelines with witness, create policy documents, and write Rego policies to validate attestations. You understand all attestors in go-witness and how to use them effectively."}, {"role": "user", "content": "How do I create a witness policy for a build step that uses these attestors: commandrun, github, material, environment?"}, {"role": "assistant", "content": "Here's a complete witness policy for your build step with commandrun, github, material, environment attestors:\n\n**Policy Document:**\n```json\n{\n  \"expires\": \"2026-11-08T10:52:59Z\",\n  \"publickeys\": {\n    \"build-key\": {\n      \"keyid\": \"sha256:fc090f652dfd071d7cc05b3207d1a49b09c897fd8639d83cee49923521228582\",\n      \"key\": \"-----BEGIN PUBLIC KEY-----\\n...\\n-----END PUBLIC KEY-----\"\n    }\n  },\n  \"steps\": {\n    \"build\": {\n      \"name\": \"build\",\n      \"attestations\": [\n        {\n          \"type\": \"https://witness.dev/attestations/command-run/v0.1\"\n        },\n        {\n          \"type\": \"https://witness.dev/attestations/github/v0.1\"\n        },\n        {\n          \"type\": \"https://witness.dev/attestations/material/v0.1\"\n        },\n        {\n          \"type\": \"https://witness.dev/attestations/environment/v0.1\"\n        }\n      ],\n      \"functionaries\": [\n        {\n          \"type\": \"publickey\",\n          \"publickeyid\": \"build-key\"\n        }\n      ]\n    }\n  }\n}\n```\n\n**Witness Run Command:**\n```bash\nwitness run --step build \\\n  --attestations commandrun,github,material,environment \\\n  --outfile build-attestation.json \\\n  --key signing-key.pem \\\n  -- <your-build-command>\n```\n\n**Rego Validation Rules:**\n```rego\n\n```\n\n**Verification:**\n```bash\nwitness verify \\\n  --policy policy-signed.json \\\n  --publickey policy-key.pub \\\n  -a build-attestation.json \\\n  --subject <artifact>\n```\n"}]}
{"messages": [{"role": "system", "content": "You are an expert in the Witness supply chain attestation framework. You help users instrument CI/CD pipelines with witness, create policy documents, and write Rego policies to validate attestations. You understand all attestors in go-witness and how to use them effectively."}, {"role": "user", "content": "How do I create a witness policy for a build step that uses these attestors: material, commandrun, product, environment, github?"}, {"role": "assistant", "content": "Here's a complete witness policy for your build step with material, commandrun, product, environment, github attestors:\n\n**Policy Document:**\n```json\n{\n  \"expires\": \"2026-11-08T10:52:59Z\",\n  \"publickeys\": {\n    \"build-key\": {\n      \"keyid\": \"sha256:289dd23adac3b52404e98785d7b98f04921c073c940c70791219fa1d03c23463\",\n      \"key\": \"-----BEGIN PUBLIC KEY-----\\n...\\n-----END PUBLIC KEY-----\"\n    }\n  },\n  \"steps\": {\n    \"build\": {\n      \"name\": \"build\",\n      \"attestations\": [\n        {\n          \"type\": \"https://witness.dev/attestations/material/v0.1\"\n        },\n        {\n          \"type\": \"https://witness.dev/attestations/command-run/v0.1\"\n        },\n        {\n          \"type\": \"https://witness.dev/attestations/product/v0.1\"\n        },\n        {\n          \"type\": \"https://witness.dev/attestations/environment/v0.1\"\n        },\n        {\n          \"type\": \"https://witness.dev/attestations/github/v0.1\"\n        }\n      ],\n      \"functionaries\": [\n        {\n          \"type\": \"publickey\",\n          \"publickeyid\": \"build-key\"\n        }\n      ]\n    }\n  }\n}\n```\n\n**Witness Run Command:**\n```bash\nwitness run --step build \\\n  --attestations material,commandrun,product,environment,github \\\n  --outfile build-attestation.json \\\n  --key signing-key.pem \\\n  -- <your-build-command>\n```\n\n**Rego Validation Rules:**\n```rego\n\n```\n\n**Verification:**\n```bash\nwitness verify \\\n  --policy policy-signed.json \\\n  --publickey policy-key.pub \\\n  -a build-attestation.json \\\n  --subject <artifact>\n```\n"}]}
{"messages": [{"role": "system", "content": "You are an expert in the Witness supply chain attestation framework. You help users instrument CI/CD pipelines with witness, create policy documents, and write Rego policies to validate attestations. You understand all attestors in go-witness and how to use them effectively."}, {"role": "user", "content": "How do I create a witness policy for a build step that uses these attestors: commandrun?"}, {"role": "assistant", "content": "Here's a complete witness policy for your build step with commandrun attestors:\n\n**Policy Document:**\n```json\n{\n  \"expires\": \"2026-11-08T10:52:59Z\",\n  \"publickeys\": {\n    \"build-key\": {\n      \"keyid\": \"sha256:e2600ca59cae77fdc00ede6a8d07ba0044d5e71a0499b1addcc05432c7beedc6\",\n      \"key\": \"-----BEGIN PUBLIC KEY-----\\n...\\n-----END PUBLIC KEY-----\"\n    }\n  },\n  \"steps\": {\n    \"build\": {\n      \"name\": \"build\",\n      \"attestations\": [\n        {\n          \"type\": \"https://witness.dev/attestations/command-run/v0.1\"\n        }\n      ],\n      \"functionaries\": [\n        {\n          \"type\": \"publickey\",\n          \"publickeyid\": \"build-key\"\n        }\n      ]\n    }\n  }\n}\n```\n\n**Witness Run Command:**\n```bash\nwitness run --step build \\\n  --attestations commandrun \\\n  --outfile build-attestation.json \\\n  --key signing-key.pem \\\n  -- <your-build-command>\n```\n\n**Rego Validation Rules:**\n```rego\n\n```\n\n**Verification:**\n```bash\nwitness verify \\\n  --policy policy-signed.json \\\n  --publickey policy-key.pub \\\n  -a build-attestation.json \\\n  --subject <artifact>\n```\n"}]}
{"messages": [{"role": "system", "content": "You are an expert in the Witness supply chain attestation framework. You help users instrument CI/CD pipelines with witness, create policy documents, and write Rego policies to validate attestations. You understand all attestors in go-witness and how to use them effectively."}, {"role": "user", "content": "How do I create a witness policy for a build step that uses these attestors: commandrun, material, product, git?"}, {"role": "assistant", "content": "Here's a complete witness policy for your build step with commandrun, material, product, git attestors:\n\n**Policy Document:**\n```json\n{\n  \"expires\": \"2026-11-08T10:52:59Z\",\n  \"publickeys\": {\n    \"build-key\": {\n      \"keyid\": \"sha256:691a8168d34761961eeb282842acc9e2f34485cfa8472862548df3157a407f30\",\n      \"key\": \"-----BEGIN PUBLIC KEY-----\\n...\\n-----END PUBLIC KEY-----\"\n    }\n  },\n  \"steps\": {\n    \"build\": {\n      \"name\": \"build\",\n      \"attestations\": [\n        {\n          \"type\": \"https://witness.dev/attestations/command-run/v0.1\"\n        },\n        {\n          \"type\": \"https://witness.dev/attestations/material/v0.1\"\n        },\n        {\n          \"type\": \"https://witness.dev/attestations/product/v0.1\"\n        },\n        {\n          \"type\": \"https://witness.dev/attestations/git/v0.1\"\n        }\n      ],\n      \"functionaries\": [\n        {\n          \"type\": \"publickey\",\n          \"publickeyid\": \"build-key\"\n        }\n      ]\n    }\n  }\n}\n```\n\n**Witness Run Command:**\n```bash\nwitness run --step build \\\n  --attestations commandrun,material,product,git \\\n  --outfile build-attestation.json \\\n  --key signing-key.pem \\\n  -- <your-build-command>\n```\n\n**Rego Validation Rules:**\n```rego\n\n```\n\n**Verification:**\n```bash\nwitness verify \\\n  --policy policy-signed.json \\\n  --publickey policy-key.pub \\\n  -a build-attestation.json \\\n  --subject <artifact>\n```\n"}]}
{"messages": [{"role": "system", "content": "You are an expert in the Witness supply chain attestation framework. You help users instrument CI/CD pipelines with witness, create policy documents, and write Rego policies to validate attestations. You understand all attestors in go-witness and how to use them effectively."}, {"role": "user", "content": "How do I create a multi-step witness policy for a build \u2192 test \u2192 package pipeline?"}, {"role": "assistant", "content": "Here's a complete multi-step witness policy for your pipeline:\n\n**Policy Document:**\n```json\n{\n  \"expires\": \"2026-11-08T10:52:59Z\",\n  \"publickeys\": {\n    \"ci-key\": {\n      \"keyid\": \"sha256:687e52601907171cf505a5f10e9161730caa6fe3c1fa4f6eb36bb05bec9401de\",\n      \"key\": \"-----BEGIN PUBLIC KEY-----\\n...\\n-----END PUBLIC KEY-----\"\n    }\n  },\n  \"steps\": {\n    \"build\": {\n      \"name\": \"build\",\n      \"attestations\": [\n        {\n          \"type\": \"https://witness.dev/attestations/git/v0.1\"\n        },\n        {\n          \"type\": \"https://witness.dev/attestations/command-run/v0.1\"\n        },\n        {\n          \"type\": \"https://witness.dev/attestations/product/v0.1\"\n        }\n      ],\n      \"functionaries\": [\n        {\n          \"type\": \"publickey\",\n          \"publickeyid\": \"ci-key\"\n        }\n      ]\n    },\n    \"test\": {\n      \"name\": \"test\",\n      \"attestations\": [\n        {\n          \"type\": \"https://witness.dev/attestations/material/v0.1\"\n        },\n        {\n          \"type\": \"https://witness.dev/attestations/command-run/v0.1\"\n        }\n      ],\n      \"functionaries\": [\n        {\n          \"type\": \"publickey\",\n          \"publickeyid\": \"ci-key\"\n        }\n      ]\n    },\n    \"package\": {\n      \"name\": \"package\",\n      \"attestations\": [\n        {\n          \"type\": \"https://witness.dev/attestations/material/v0.1\"\n        },\n        {\n          \"type\": \"https://witness.dev/attestations/product/v0.1\"\n        }\n      ],\n      \"functionaries\": [\n        {\n          \"type\": \"publickey\",\n          \"publickeyid\": \"ci-key\"\n        }\n      ]\n    }\n  }\n}\n```\n\n**Pipeline Commands:**\n\n```bash\n# Step 1: Build\nwitness run --step build \\\n  --attestations git,commandrun,product \\\n  -o build.json --key ci-key.pem \\\n  -- go build -o myapp\n\n# Step 2: Test\nwitness run --step test \\\n  --attestations material,commandrun \\\n  -o test.json --key ci-key.pem \\\n  -- go test ./...\n\n# Step 3: Package\nwitness run --step package \\\n  --attestations material,product \\\n  -o package.json --key ci-key.pem \\\n  -- tar czf myapp.tar.gz myapp\n\n# Verify entire pipeline\nwitness verify \\\n  --policy policy-signed.json \\\n  --publickey policy-key.pub \\\n  -a build.json -a test.json -a package.json\n```\n"}]}
{"messages": [{"role": "system", "content": "You are an expert in the Witness supply chain attestation framework. You help users instrument CI/CD pipelines with witness, create policy documents, and write Rego policies to validate attestations. You understand all attestors in go-witness and how to use them effectively."}, {"role": "user", "content": "How do I create a witness policy for a build step that uses these attestors: git, github, commandrun, material?"}, {"role": "assistant", "content": "Here's a complete witness policy for your build step with git, github, commandrun, material attestors:\n\n**Policy Document:**\n```json\n{\n  \"expires\": \"2026-11-08T10:52:59Z\",\n  \"publickeys\": {\n    \"build-key\": {\n      \"keyid\": \"sha256:1c114d5e47144a5e3e2aff20f8b4c1b2c94206daf2262e67962f8e8b9fa6c769\",\n      \"key\": \"-----BEGIN PUBLIC KEY-----\\n...\\n-----END PUBLIC KEY-----\"\n    }\n  },\n  \"steps\": {\n    \"build\": {\n      \"name\": \"build\",\n      \"attestations\": [\n        {\n          \"type\": \"https://witness.dev/attestations/git/v0.1\"\n        },\n        {\n          \"type\": \"https://witness.dev/attestations/github/v0.1\"\n        },\n        {\n          \"type\": \"https://witness.dev/attestations/command-run/v0.1\"\n        },\n        {\n          \"type\": \"https://witness.dev/attestations/material/v0.1\"\n        }\n      ],\n      \"functionaries\": [\n        {\n          \"type\": \"publickey\",\n          \"publickeyid\": \"build-key\"\n        }\n      ]\n    }\n  }\n}\n```\n\n**Witness Run Command:**\n```bash\nwitness run --step build \\\n  --attestations git,github,commandrun,material \\\n  --outfile build-attestation.json \\\n  --key signing-key.pem \\\n  -- <your-build-command>\n```\n\n**Rego Validation Rules:**\n```rego\npackage git\n\nimport rego.v1\n\n# Enforce builds from specific branch\ndeny contains msg if {\n    input.branch != \"release/v1.0\"\n    msg := sprintf(\"Must build from release/v1.0 branch, got: %s\", [input.branch])\n}\n\n# Require clean working directory\ndeny contains msg if {\n    count(input.status) > 0\n    msg := \"Working directory must be clean (no uncommitted changes)\"\n}\n\n# Validate commit author\napproved_authors := {\n    \"alice.smith@example.com\",\n    \"bob.jones@company.com\",\n    \"ci-bot@company.com\"\n}\n\ndeny contains msg if {\n    not input.authoremail in approved_authors\n    msg := sprintf(\"Unauthorized commit author: %s\", [input.authoremail])\n}\n```\n\n**Verification:**\n```bash\nwitness verify \\\n  --policy policy-signed.json \\\n  --publickey policy-key.pub \\\n  -a build-attestation.json \\\n  --subject <artifact>\n```\n"}]}
{"messages": [{"role": "system", "content": "You are an expert in the Witness supply chain attestation framework. You help users instrument CI/CD pipelines with witness, create policy documents, and write Rego policies to validate attestations. You understand all attestors in go-witness and how to use them effectively."}, {"role": "user", "content": "How do I create a witness policy for a build step that uses these attestors: product, environment, git?"}, {"role": "assistant", "content": "Here's a complete witness policy for your build step with product, environment, git attestors:\n\n**Policy Document:**\n```json\n{\n  \"expires\": \"2026-11-08T10:52:59Z\",\n  \"publickeys\": {\n    \"build-key\": {\n      \"keyid\": \"sha256:7c4524c462f1700434224b4a767db4506bdadb9fbca64e379be8e52d807de2e5\",\n      \"key\": \"-----BEGIN PUBLIC KEY-----\\n...\\n-----END PUBLIC KEY-----\"\n    }\n  },\n  \"steps\": {\n    \"build\": {\n      \"name\": \"build\",\n      \"attestations\": [\n        {\n          \"type\": \"https://witness.dev/attestations/product/v0.1\"\n        },\n        {\n          \"type\": \"https://witness.dev/attestations/environment/v0.1\"\n        },\n        {\n          \"type\": \"https://witness.dev/attestations/git/v0.1\"\n        }\n      ],\n      \"functionaries\": [\n        {\n          \"type\": \"publickey\",\n          \"publickeyid\": \"build-key\"\n        }\n      ]\n    }\n  }\n}\n```\n\n**Witness Run Command:**\n```bash\nwitness run --step build \\\n  --attestations product,environment,git \\\n  --outfile build-attestation.json \\\n  --key signing-key.pem \\\n  -- <your-build-command>\n```\n\n**Rego Validation Rules:**\n```rego\n\n```\n\n**Verification:**\n```bash\nwitness verify \\\n  --policy policy-signed.json \\\n  --publickey policy-key.pub \\\n  -a build-attestation.json \\\n  --subject <artifact>\n```\n"}]}
{"messages": [{"role": "system", "content": "You are an expert in the Witness supply chain attestation framework. You help users instrument CI/CD pipelines with witness, create policy documents, and write Rego policies to validate attestations. You understand all attestors in go-witness and how to use them effectively."}, {"role": "user", "content": "How do I create a multi-step witness policy for a build \u2192 test \u2192 package pipeline?"}, {"role": "assistant", "content": "Here's a complete multi-step witness policy for your pipeline:\n\n**Policy Document:**\n```json\n{\n  \"expires\": \"2026-11-08T10:52:59Z\",\n  \"publickeys\": {\n    \"ci-key\": {\n      \"keyid\": \"sha256:6d81e42e9c2641718ba179c7e2bd59b04386300419070cb0e045fc4b984b3b68\",\n      \"key\": \"-----BEGIN PUBLIC KEY-----\\n...\\n-----END PUBLIC KEY-----\"\n    }\n  },\n  \"steps\": {\n    \"build\": {\n      \"name\": \"build\",\n      \"attestations\": [\n        {\n          \"type\": \"https://witness.dev/attestations/git/v0.1\"\n        },\n        {\n          \"type\": \"https://witness.dev/attestations/command-run/v0.1\"\n        },\n        {\n          \"type\": \"https://witness.dev/attestations/product/v0.1\"\n        }\n      ],\n      \"functionaries\": [\n        {\n          \"type\": \"publickey\",\n          \"publickeyid\": \"ci-key\"\n        }\n      ]\n    },\n    \"test\": {\n      \"name\": \"test\",\n      \"attestations\": [\n        {\n          \"type\": \"https://witness.dev/attestations/material/v0.1\"\n        },\n        {\n          \"type\": \"https://witness.dev/attestations/command-run/v0.1\"\n        }\n      ],\n      \"functionaries\": [\n        {\n          \"type\": \"publickey\",\n          \"publickeyid\": \"ci-key\"\n        }\n      ]\n    },\n    \"package\": {\n      \"name\": \"package\",\n      \"attestations\": [\n        {\n          \"type\": \"https://witness.dev/attestations/material/v0.1\"\n        },\n        {\n          \"type\": \"https://witness.dev/attestations/product/v0.1\"\n        }\n      ],\n      \"functionaries\": [\n        {\n          \"type\": \"publickey\",\n          \"publickeyid\": \"ci-key\"\n        }\n      ]\n    }\n  }\n}\n```\n\n**Pipeline Commands:**\n\n```bash\n# Step 1: Build\nwitness run --step build \\\n  --attestations git,commandrun,product \\\n  -o build.json --key ci-key.pem \\\n  -- go build -o myapp\n\n# Step 2: Test\nwitness run --step test \\\n  --attestations material,commandrun \\\n  -o test.json --key ci-key.pem \\\n  -- go test ./...\n\n# Step 3: Package\nwitness run --step package \\\n  --attestations material,product \\\n  -o package.json --key ci-key.pem \\\n  -- tar czf myapp.tar.gz myapp\n\n# Verify entire pipeline\nwitness verify \\\n  --policy policy-signed.json \\\n  --publickey policy-key.pub \\\n  -a build.json -a test.json -a package.json\n```\n"}]}
{"messages": [{"role": "system", "content": "You are an expert in the Witness supply chain attestation framework. You help users instrument CI/CD pipelines with witness, create policy documents, and write Rego policies to validate attestations. You understand all attestors in go-witness and how to use them effectively."}, {"role": "user", "content": "How do I create a witness policy for a build step that uses these attestors: github, product?"}, {"role": "assistant", "content": "Here's a complete witness policy for your build step with github, product attestors:\n\n**Policy Document:**\n```json\n{\n  \"expires\": \"2026-11-08T10:52:59Z\",\n  \"publickeys\": {\n    \"build-key\": {\n      \"keyid\": \"sha256:9e0dfcaaba54c7f3494c39748e78ef31ed89448b858cfd4cf7dfd9700ea06e0d\",\n      \"key\": \"-----BEGIN PUBLIC KEY-----\\n...\\n-----END PUBLIC KEY-----\"\n    }\n  },\n  \"steps\": {\n    \"build\": {\n      \"name\": \"build\",\n      \"attestations\": [\n        {\n          \"type\": \"https://witness.dev/attestations/github/v0.1\"\n        },\n        {\n          \"type\": \"https://witness.dev/attestations/product/v0.1\"\n        }\n      ],\n      \"functionaries\": [\n        {\n          \"type\": \"publickey\",\n          \"publickeyid\": \"build-key\"\n        }\n      ]\n    }\n  }\n}\n```\n\n**Witness Run Command:**\n```bash\nwitness run --step build \\\n  --attestations github,product \\\n  --outfile build-attestation.json \\\n  --key signing-key.pem \\\n  -- <your-build-command>\n```\n\n**Rego Validation Rules:**\n```rego\n\n```\n\n**Verification:**\n```bash\nwitness verify \\\n  --policy policy-signed.json \\\n  --publickey policy-key.pub \\\n  -a build-attestation.json \\\n  --subject <artifact>\n```\n"}]}
{"messages": [{"role": "system", "content": "You are an expert in the Witness supply chain attestation framework. You help users instrument CI/CD pipelines with witness, create policy documents, and write Rego policies to validate attestations. You understand all attestors in go-witness and how to use them effectively."}, {"role": "user", "content": "How do I create a multi-step witness policy for a build \u2192 test \u2192 package pipeline?"}, {"role": "assistant", "content": "Here's a complete multi-step witness policy for your pipeline:\n\n**Policy Document:**\n```json\n{\n  \"expires\": \"2026-11-08T10:52:59Z\",\n  \"publickeys\": {\n    \"ci-key\": {\n      \"keyid\": \"sha256:a48066aa3225c81b42a3346d17acedc5d905d362352c2c32cb1a0b73c4566836\",\n      \"key\": \"-----BEGIN PUBLIC KEY-----\\n...\\n-----END PUBLIC KEY-----\"\n    }\n  },\n  \"steps\": {\n    \"build\": {\n      \"name\": \"build\",\n      \"attestations\": [\n        {\n          \"type\": \"https://witness.dev/attestations/git/v0.1\"\n        },\n        {\n          \"type\": \"https://witness.dev/attestations/command-run/v0.1\"\n        },\n        {\n          \"type\": \"https://witness.dev/attestations/product/v0.1\"\n        }\n      ],\n      \"functionaries\": [\n        {\n          \"type\": \"publickey\",\n          \"publickeyid\": \"ci-key\"\n        }\n      ]\n    },\n    \"test\": {\n      \"name\": \"test\",\n      \"attestations\": [\n        {\n          \"type\": \"https://witness.dev/attestations/material/v0.1\"\n        },\n        {\n          \"type\": \"https://witness.dev/attestations/command-run/v0.1\"\n        }\n      ],\n      \"functionaries\": [\n        {\n          \"type\": \"publickey\",\n          \"publickeyid\": \"ci-key\"\n        }\n      ]\n    },\n    \"package\": {\n      \"name\": \"package\",\n      \"attestations\": [\n        {\n          \"type\": \"https://witness.dev/attestations/material/v0.1\"\n        },\n        {\n          \"type\": \"https://witness.dev/attestations/product/v0.1\"\n        }\n      ],\n      \"functionaries\": [\n        {\n          \"type\": \"publickey\",\n          \"publickeyid\": \"ci-key\"\n        }\n      ]\n    }\n  }\n}\n```\n\n**Pipeline Commands:**\n\n```bash\n# Step 1: Build\nwitness run --step build \\\n  --attestations git,commandrun,product \\\n  -o build.json --key ci-key.pem \\\n  -- go build -o myapp\n\n# Step 2: Test\nwitness run --step test \\\n  --attestations material,commandrun \\\n  -o test.json --key ci-key.pem \\\n  -- go test ./...\n\n# Step 3: Package\nwitness run --step package \\\n  --attestations material,product \\\n  -o package.json --key ci-key.pem \\\n  -- tar czf myapp.tar.gz myapp\n\n# Verify entire pipeline\nwitness verify \\\n  --policy policy-signed.json \\\n  --publickey policy-key.pub \\\n  -a build.json -a test.json -a package.json\n```\n"}]}
{"messages": [{"role": "system", "content": "You are an expert in the Witness supply chain attestation framework. You help users instrument CI/CD pipelines with witness, create policy documents, and write Rego policies to validate attestations. You understand all attestors in go-witness and how to use them effectively."}, {"role": "user", "content": "How do I create a multi-step witness policy for a build \u2192 test \u2192 package pipeline?"}, {"role": "assistant", "content": "Here's a complete multi-step witness policy for your pipeline:\n\n**Policy Document:**\n```json\n{\n  \"expires\": \"2026-11-08T10:52:59Z\",\n  \"publickeys\": {\n    \"ci-key\": {\n      \"keyid\": \"sha256:4974a0a967ddb0f6419b50a908d2c55e348ed1fd337adf0490621b7df4072e31\",\n      \"key\": \"-----BEGIN PUBLIC KEY-----\\n...\\n-----END PUBLIC KEY-----\"\n    }\n  },\n  \"steps\": {\n    \"build\": {\n      \"name\": \"build\",\n      \"attestations\": [\n        {\n          \"type\": \"https://witness.dev/attestations/git/v0.1\"\n        },\n        {\n          \"type\": \"https://witness.dev/attestations/command-run/v0.1\"\n        },\n        {\n          \"type\": \"https://witness.dev/attestations/product/v0.1\"\n        }\n      ],\n      \"functionaries\": [\n        {\n          \"type\": \"publickey\",\n          \"publickeyid\": \"ci-key\"\n        }\n      ]\n    },\n    \"test\": {\n      \"name\": \"test\",\n      \"attestations\": [\n        {\n          \"type\": \"https://witness.dev/attestations/material/v0.1\"\n        },\n        {\n          \"type\": \"https://witness.dev/attestations/command-run/v0.1\"\n        }\n      ],\n      \"functionaries\": [\n        {\n          \"type\": \"publickey\",\n          \"publickeyid\": \"ci-key\"\n        }\n      ]\n    },\n    \"package\": {\n      \"name\": \"package\",\n      \"attestations\": [\n        {\n          \"type\": \"https://witness.dev/attestations/material/v0.1\"\n        },\n        {\n          \"type\": \"https://witness.dev/attestations/product/v0.1\"\n        }\n      ],\n      \"functionaries\": [\n        {\n          \"type\": \"publickey\",\n          \"publickeyid\": \"ci-key\"\n        }\n      ]\n    }\n  }\n}\n```\n\n**Pipeline Commands:**\n\n```bash\n# Step 1: Build\nwitness run --step build \\\n  --attestations git,commandrun,product \\\n  -o build.json --key ci-key.pem \\\n  -- go build -o myapp\n\n# Step 2: Test\nwitness run --step test \\\n  --attestations material,commandrun \\\n  -o test.json --key ci-key.pem \\\n  -- go test ./...\n\n# Step 3: Package\nwitness run --step package \\\n  --attestations material,product \\\n  -o package.json --key ci-key.pem \\\n  -- tar czf myapp.tar.gz myapp\n\n# Verify entire pipeline\nwitness verify \\\n  --policy policy-signed.json \\\n  --publickey policy-key.pub \\\n  -a build.json -a test.json -a package.json\n```\n"}]}
{"messages": [{"role": "system", "content": "You are an expert in the Witness supply chain attestation framework. You help users instrument CI/CD pipelines with witness, create policy documents, and write Rego policies to validate attestations. You understand all attestors in go-witness and how to use them effectively."}, {"role": "user", "content": "How do I create a witness policy for a build step that uses these attestors: git, material, github, environment, commandrun?"}, {"role": "assistant", "content": "Here's a complete witness policy for your build step with git, material, github, environment, commandrun attestors:\n\n**Policy Document:**\n```json\n{\n  \"expires\": \"2026-11-08T10:52:59Z\",\n  \"publickeys\": {\n    \"build-key\": {\n      \"keyid\": \"sha256:7e58152b49428f64499665c719644e53785f520ab275f33e74bacb3fe6919d96\",\n      \"key\": \"-----BEGIN PUBLIC KEY-----\\n...\\n-----END PUBLIC KEY-----\"\n    }\n  },\n  \"steps\": {\n    \"build\": {\n      \"name\": \"build\",\n      \"attestations\": [\n        {\n          \"type\": \"https://witness.dev/attestations/git/v0.1\"\n        },\n        {\n          \"type\": \"https://witness.dev/attestations/material/v0.1\"\n        },\n        {\n          \"type\": \"https://witness.dev/attestations/github/v0.1\"\n        },\n        {\n          \"type\": \"https://witness.dev/attestations/environment/v0.1\"\n        },\n        {\n          \"type\": \"https://witness.dev/attestations/command-run/v0.1\"\n        }\n      ],\n      \"functionaries\": [\n        {\n          \"type\": \"publickey\",\n          \"publickeyid\": \"build-key\"\n        }\n      ]\n    }\n  }\n}\n```\n\n**Witness Run Command:**\n```bash\nwitness run --step build \\\n  --attestations git,material,github,environment,commandrun \\\n  --outfile build-attestation.json \\\n  --key signing-key.pem \\\n  -- <your-build-command>\n```\n\n**Rego Validation Rules:**\n```rego\npackage git\n\nimport rego.v1\n\n# Enforce builds from specific branch\ndeny contains msg if {\n    input.branch != \"master\"\n    msg := sprintf(\"Must build from master branch, got: %s\", [input.branch])\n}\n\n# Require clean working directory\ndeny contains msg if {\n    count(input.status) > 0\n    msg := \"Working directory must be clean (no uncommitted changes)\"\n}\n\n# Validate commit author\napproved_authors := {\n    \"alice.smith@example.com\",\n    \"bob.jones@company.com\",\n    \"ci-bot@company.com\"\n}\n\ndeny contains msg if {\n    not input.authoremail in approved_authors\n    msg := sprintf(\"Unauthorized commit author: %s\", [input.authoremail])\n}\n```\n\n**Verification:**\n```bash\nwitness verify \\\n  --policy policy-signed.json \\\n  --publickey policy-key.pub \\\n  -a build-attestation.json \\\n  --subject <artifact>\n```\n"}]}
{"messages": [{"role": "system", "content": "You are an expert in the Witness supply chain attestation framework. You help users instrument CI/CD pipelines with witness, create policy documents, and write Rego policies to validate attestations. You understand all attestors in go-witness and how to use them effectively."}, {"role": "user", "content": "How do I create a witness policy for a build step that uses these attestors: product, commandrun?"}, {"role": "assistant", "content": "Here's a complete witness policy for your build step with product, commandrun attestors:\n\n**Policy Document:**\n```json\n{\n  \"expires\": \"2026-11-08T10:52:59Z\",\n  \"publickeys\": {\n    \"build-key\": {\n      \"keyid\": \"sha256:f20ac58676a0785a4459d44184b25b0a080b9090324768804869339a8afa3dfb\",\n      \"key\": \"-----BEGIN PUBLIC KEY-----\\n...\\n-----END PUBLIC KEY-----\"\n    }\n  },\n  \"steps\": {\n    \"build\": {\n      \"name\": \"build\",\n      \"attestations\": [\n        {\n          \"type\": \"https://witness.dev/attestations/product/v0.1\"\n        },\n        {\n          \"type\": \"https://witness.dev/attestations/command-run/v0.1\"\n        }\n      ],\n      \"functionaries\": [\n        {\n          \"type\": \"publickey\",\n          \"publickeyid\": \"build-key\"\n        }\n      ]\n    }\n  }\n}\n```\n\n**Witness Run Command:**\n```bash\nwitness run --step build \\\n  --attestations product,commandrun \\\n  --outfile build-attestation.json \\\n  --key signing-key.pem \\\n  -- <your-build-command>\n```\n\n**Rego Validation Rules:**\n```rego\n\n```\n\n**Verification:**\n```bash\nwitness verify \\\n  --policy policy-signed.json \\\n  --publickey policy-key.pub \\\n  -a build-attestation.json \\\n  --subject <artifact>\n```\n"}]}
{"messages": [{"role": "system", "content": "You are an expert in the Witness supply chain attestation framework. You help users instrument CI/CD pipelines with witness, create policy documents, and write Rego policies to validate attestations. You understand all attestors in go-witness and how to use them effectively."}, {"role": "user", "content": "How do I create a witness policy for a build step that uses these attestors: product, git, commandrun, environment?"}, {"role": "assistant", "content": "Here's a complete witness policy for your build step with product, git, commandrun, environment attestors:\n\n**Policy Document:**\n```json\n{\n  \"expires\": \"2026-11-08T10:52:59Z\",\n  \"publickeys\": {\n    \"build-key\": {\n      \"keyid\": \"sha256:2c396c45fbdccf110c0bc274466c0371103af6955fb8380134e6bccfe9445461\",\n      \"key\": \"-----BEGIN PUBLIC KEY-----\\n...\\n-----END PUBLIC KEY-----\"\n    }\n  },\n  \"steps\": {\n    \"build\": {\n      \"name\": \"build\",\n      \"attestations\": [\n        {\n          \"type\": \"https://witness.dev/attestations/product/v0.1\"\n        },\n        {\n          \"type\": \"https://witness.dev/attestations/git/v0.1\"\n        },\n        {\n          \"type\": \"https://witness.dev/attestations/command-run/v0.1\"\n        },\n        {\n          \"type\": \"https://witness.dev/attestations/environment/v0.1\"\n        }\n      ],\n      \"functionaries\": [\n        {\n          \"type\": \"publickey\",\n          \"publickeyid\": \"build-key\"\n        }\n      ]\n    }\n  }\n}\n```\n\n**Witness Run Command:**\n```bash\nwitness run --step build \\\n  --attestations product,git,commandrun,environment \\\n  --outfile build-attestation.json \\\n  --key signing-key.pem \\\n  -- <your-build-command>\n```\n\n**Rego Validation Rules:**\n```rego\n\n```\n\n**Verification:**\n```bash\nwitness verify \\\n  --policy policy-signed.json \\\n  --publickey policy-key.pub \\\n  -a build-attestation.json \\\n  --subject <artifact>\n```\n"}]}
{"messages": [{"role": "system", "content": "You are an expert in the Witness supply chain attestation framework. You help users instrument CI/CD pipelines with witness, create policy documents, and write Rego policies to validate attestations. You understand all attestors in go-witness and how to use them effectively."}, {"role": "user", "content": "How do I create a multi-step witness policy for a build \u2192 test \u2192 package pipeline?"}, {"role": "assistant", "content": "Here's a complete multi-step witness policy for your pipeline:\n\n**Policy Document:**\n```json\n{\n  \"expires\": \"2026-11-08T10:52:59Z\",\n  \"publickeys\": {\n    \"ci-key\": {\n      \"keyid\": \"sha256:6201b11ef083f76c5baad81bb58672aa71c5f82c8b93b83871b3c01bba1e0dfe\",\n      \"key\": \"-----BEGIN PUBLIC KEY-----\\n...\\n-----END PUBLIC KEY-----\"\n    }\n  },\n  \"steps\": {\n    \"build\": {\n      \"name\": \"build\",\n      \"attestations\": [\n        {\n          \"type\": \"https://witness.dev/attestations/git/v0.1\"\n        },\n        {\n          \"type\": \"https://witness.dev/attestations/command-run/v0.1\"\n        },\n        {\n          \"type\": \"https://witness.dev/attestations/product/v0.1\"\n        }\n      ],\n      \"functionaries\": [\n        {\n          \"type\": \"publickey\",\n          \"publickeyid\": \"ci-key\"\n        }\n      ]\n    },\n    \"test\": {\n      \"name\": \"test\",\n      \"attestations\": [\n        {\n          \"type\": \"https://witness.dev/attestations/material/v0.1\"\n        },\n        {\n          \"type\": \"https://witness.dev/attestations/command-run/v0.1\"\n        }\n      ],\n      \"functionaries\": [\n        {\n          \"type\": \"publickey\",\n          \"publickeyid\": \"ci-key\"\n        }\n      ]\n    },\n    \"package\": {\n      \"name\": \"package\",\n      \"attestations\": [\n        {\n          \"type\": \"https://witness.dev/attestations/material/v0.1\"\n        },\n        {\n          \"type\": \"https://witness.dev/attestations/product/v0.1\"\n        }\n      ],\n      \"functionaries\": [\n        {\n          \"type\": \"publickey\",\n          \"publickeyid\": \"ci-key\"\n        }\n      ]\n    }\n  }\n}\n```\n\n**Pipeline Commands:**\n\n```bash\n# Step 1: Build\nwitness run --step build \\\n  --attestations git,commandrun,product \\\n  -o build.json --key ci-key.pem \\\n  -- go build -o myapp\n\n# Step 2: Test\nwitness run --step test \\\n  --attestations material,commandrun \\\n  -o test.json --key ci-key.pem \\\n  -- go test ./...\n\n# Step 3: Package\nwitness run --step package \\\n  --attestations material,product \\\n  -o package.json --key ci-key.pem \\\n  -- tar czf myapp.tar.gz myapp\n\n# Verify entire pipeline\nwitness verify \\\n  --policy policy-signed.json \\\n  --publickey policy-key.pub \\\n  -a build.json -a test.json -a package.json\n```\n"}]}
{"messages": [{"role": "system", "content": "You are an expert in the Witness supply chain attestation framework. You help users instrument CI/CD pipelines with witness, create policy documents, and write Rego policies to validate attestations. You understand all attestors in go-witness and how to use them effectively."}, {"role": "user", "content": "How do I create a witness policy for a build step that uses these attestors: git?"}, {"role": "assistant", "content": "Here's a complete witness policy for your build step with git attestors:\n\n**Policy Document:**\n```json\n{\n  \"expires\": \"2026-11-08T10:52:59Z\",\n  \"publickeys\": {\n    \"build-key\": {\n      \"keyid\": \"sha256:9d997dcdf6ff7868c65231ea2af574f7e2dff442e48f1c2758ecbb2fd702518f\",\n      \"key\": \"-----BEGIN PUBLIC KEY-----\\n...\\n-----END PUBLIC KEY-----\"\n    }\n  },\n  \"steps\": {\n    \"build\": {\n      \"name\": \"build\",\n      \"attestations\": [\n        {\n          \"type\": \"https://witness.dev/attestations/git/v0.1\"\n        }\n      ],\n      \"functionaries\": [\n        {\n          \"type\": \"publickey\",\n          \"publickeyid\": \"build-key\"\n        }\n      ]\n    }\n  }\n}\n```\n\n**Witness Run Command:**\n```bash\nwitness run --step build \\\n  --attestations git \\\n  --outfile build-attestation.json \\\n  --key signing-key.pem \\\n  -- <your-build-command>\n```\n\n**Rego Validation Rules:**\n```rego\npackage git\n\nimport rego.v1\n\n# Enforce builds from specific branch\ndeny contains msg if {\n    input.branch != \"master\"\n    msg := sprintf(\"Must build from master branch, got: %s\", [input.branch])\n}\n\n# Validate commit author\napproved_authors := {\n    \"alice.smith@example.com\",\n    \"bob.jones@company.com\",\n    \"ci-bot@company.com\"\n}\n\ndeny contains msg if {\n    not input.authoremail in approved_authors\n    msg := sprintf(\"Unauthorized commit author: %s\", [input.authoremail])\n}\n```\n\n**Verification:**\n```bash\nwitness verify \\\n  --policy policy-signed.json \\\n  --publickey policy-key.pub \\\n  -a build-attestation.json \\\n  --subject <artifact>\n```\n"}]}
{"messages": [{"role": "system", "content": "You are an expert in the Witness supply chain attestation framework. You help users instrument CI/CD pipelines with witness, create policy documents, and write Rego policies to validate attestations. You understand all attestors in go-witness and how to use them effectively."}, {"role": "user", "content": "How do I create a witness policy for a build step that uses these attestors: material, git, product, commandrun, github?"}, {"role": "assistant", "content": "Here's a complete witness policy for your build step with material, git, product, commandrun, github attestors:\n\n**Policy Document:**\n```json\n{\n  \"expires\": \"2026-11-08T10:52:59Z\",\n  \"publickeys\": {\n    \"build-key\": {\n      \"keyid\": \"sha256:b333dd071e0d1bb33cbb3dd1604df820b8b72c30dad29db28cf6bef71671d836\",\n      \"key\": \"-----BEGIN PUBLIC KEY-----\\n...\\n-----END PUBLIC KEY-----\"\n    }\n  },\n  \"steps\": {\n    \"build\": {\n      \"name\": \"build\",\n      \"attestations\": [\n        {\n          \"type\": \"https://witness.dev/attestations/material/v0.1\"\n        },\n        {\n          \"type\": \"https://witness.dev/attestations/git/v0.1\"\n        },\n        {\n          \"type\": \"https://witness.dev/attestations/product/v0.1\"\n        },\n        {\n          \"type\": \"https://witness.dev/attestations/command-run/v0.1\"\n        },\n        {\n          \"type\": \"https://witness.dev/attestations/github/v0.1\"\n        }\n      ],\n      \"functionaries\": [\n        {\n          \"type\": \"publickey\",\n          \"publickeyid\": \"build-key\"\n        }\n      ]\n    }\n  }\n}\n```\n\n**Witness Run Command:**\n```bash\nwitness run --step build \\\n  --attestations material,git,product,commandrun,github \\\n  --outfile build-attestation.json \\\n  --key signing-key.pem \\\n  -- <your-build-command>\n```\n\n**Rego Validation Rules:**\n```rego\n\n```\n\n**Verification:**\n```bash\nwitness verify \\\n  --policy policy-signed.json \\\n  --publickey policy-key.pub \\\n  -a build-attestation.json \\\n  --subject <artifact>\n```\n"}]}
{"messages": [{"role": "system", "content": "You are an expert in the Witness supply chain attestation framework. You help users instrument CI/CD pipelines with witness, create policy documents, and write Rego policies to validate attestations. You understand all attestors in go-witness and how to use them effectively."}, {"role": "user", "content": "How do I create a multi-step witness policy for a build \u2192 test \u2192 package pipeline?"}, {"role": "assistant", "content": "Here's a complete multi-step witness policy for your pipeline:\n\n**Policy Document:**\n```json\n{\n  \"expires\": \"2026-11-08T10:52:59Z\",\n  \"publickeys\": {\n    \"ci-key\": {\n      \"keyid\": \"sha256:7ccd3f7002f1aafa03e7f30b13921b819d87a8f7a68915e0a03225a1b1defcca\",\n      \"key\": \"-----BEGIN PUBLIC KEY-----\\n...\\n-----END PUBLIC KEY-----\"\n    }\n  },\n  \"steps\": {\n    \"build\": {\n      \"name\": \"build\",\n      \"attestations\": [\n        {\n          \"type\": \"https://witness.dev/attestations/git/v0.1\"\n        },\n        {\n          \"type\": \"https://witness.dev/attestations/command-run/v0.1\"\n        },\n        {\n          \"type\": \"https://witness.dev/attestations/product/v0.1\"\n        }\n      ],\n      \"functionaries\": [\n        {\n          \"type\": \"publickey\",\n          \"publickeyid\": \"ci-key\"\n        }\n      ]\n    },\n    \"test\": {\n      \"name\": \"test\",\n      \"attestations\": [\n        {\n          \"type\": \"https://witness.dev/attestations/material/v0.1\"\n        },\n        {\n          \"type\": \"https://witness.dev/attestations/command-run/v0.1\"\n        }\n      ],\n      \"functionaries\": [\n        {\n          \"type\": \"publickey\",\n          \"publickeyid\": \"ci-key\"\n        }\n      ]\n    },\n    \"package\": {\n      \"name\": \"package\",\n      \"attestations\": [\n        {\n          \"type\": \"https://witness.dev/attestations/material/v0.1\"\n        },\n        {\n          \"type\": \"https://witness.dev/attestations/product/v0.1\"\n        }\n      ],\n      \"functionaries\": [\n        {\n          \"type\": \"publickey\",\n          \"publickeyid\": \"ci-key\"\n        }\n      ]\n    }\n  }\n}\n```\n\n**Pipeline Commands:**\n\n```bash\n# Step 1: Build\nwitness run --step build \\\n  --attestations git,commandrun,product \\\n  -o build.json --key ci-key.pem \\\n  -- go build -o myapp\n\n# Step 2: Test\nwitness run --step test \\\n  --attestations material,commandrun \\\n  -o test.json --key ci-key.pem \\\n  -- go test ./...\n\n# Step 3: Package\nwitness run --step package \\\n  --attestations material,product \\\n  -o package.json --key ci-key.pem \\\n  -- tar czf myapp.tar.gz myapp\n\n# Verify entire pipeline\nwitness verify \\\n  --policy policy-signed.json \\\n  --publickey policy-key.pub \\\n  -a build.json -a test.json -a package.json\n```\n"}]}
{"messages": [{"role": "system", "content": "You are an expert in the Witness supply chain attestation framework. You help users instrument CI/CD pipelines with witness, create policy documents, and write Rego policies to validate attestations. You understand all attestors in go-witness and how to use them effectively."}, {"role": "user", "content": "How do I create a multi-step witness policy for a build \u2192 test \u2192 package pipeline?"}, {"role": "assistant", "content": "Here's a complete multi-step witness policy for your pipeline:\n\n**Policy Document:**\n```json\n{\n  \"expires\": \"2026-11-08T10:52:59Z\",\n  \"publickeys\": {\n    \"ci-key\": {\n      \"keyid\": \"sha256:d90f91ae8e7c3eb3a5b8da177c07cc28e6feb4a2ef8eaf7a7b8303c6dac36284\",\n      \"key\": \"-----BEGIN PUBLIC KEY-----\\n...\\n-----END PUBLIC KEY-----\"\n    }\n  },\n  \"steps\": {\n    \"build\": {\n      \"name\": \"build\",\n      \"attestations\": [\n        {\n          \"type\": \"https://witness.dev/attestations/git/v0.1\"\n        },\n        {\n          \"type\": \"https://witness.dev/attestations/command-run/v0.1\"\n        },\n        {\n          \"type\": \"https://witness.dev/attestations/product/v0.1\"\n        }\n      ],\n      \"functionaries\": [\n        {\n          \"type\": \"publickey\",\n          \"publickeyid\": \"ci-key\"\n        }\n      ]\n    },\n    \"test\": {\n      \"name\": \"test\",\n      \"attestations\": [\n        {\n          \"type\": \"https://witness.dev/attestations/material/v0.1\"\n        },\n        {\n          \"type\": \"https://witness.dev/attestations/command-run/v0.1\"\n        }\n      ],\n      \"functionaries\": [\n        {\n          \"type\": \"publickey\",\n          \"publickeyid\": \"ci-key\"\n        }\n      ]\n    },\n    \"package\": {\n      \"name\": \"package\",\n      \"attestations\": [\n        {\n          \"type\": \"https://witness.dev/attestations/material/v0.1\"\n        },\n        {\n          \"type\": \"https://witness.dev/attestations/product/v0.1\"\n        }\n      ],\n      \"functionaries\": [\n        {\n          \"type\": \"publickey\",\n          \"publickeyid\": \"ci-key\"\n        }\n      ]\n    }\n  }\n}\n```\n\n**Pipeline Commands:**\n\n```bash\n# Step 1: Build\nwitness run --step build \\\n  --attestations git,commandrun,product \\\n  -o build.json --key ci-key.pem \\\n  -- go build -o myapp\n\n# Step 2: Test\nwitness run --step test \\\n  --attestations material,commandrun \\\n  -o test.json --key ci-key.pem \\\n  -- go test ./...\n\n# Step 3: Package\nwitness run --step package \\\n  --attestations material,product \\\n  -o package.json --key ci-key.pem \\\n  -- tar czf myapp.tar.gz myapp\n\n# Verify entire pipeline\nwitness verify \\\n  --policy policy-signed.json \\\n  --publickey policy-key.pub \\\n  -a build.json -a test.json -a package.json\n```\n"}]}
{"messages": [{"role": "system", "content": "You are an expert in the Witness supply chain attestation framework. You help users instrument CI/CD pipelines with witness, create policy documents, and write Rego policies to validate attestations. You understand all attestors in go-witness and how to use them effectively."}, {"role": "user", "content": "How do I create a witness policy for a build step that uses these attestors: github, environment, product, material?"}, {"role": "assistant", "content": "Here's a complete witness policy for your build step with github, environment, product, material attestors:\n\n**Policy Document:**\n```json\n{\n  \"expires\": \"2026-11-08T10:52:59Z\",\n  \"publickeys\": {\n    \"build-key\": {\n      \"keyid\": \"sha256:ae9b71fa979091fd26a15f956f94ece1d1d6e083c7b5e9f93d4e4f24f8a25f65\",\n      \"key\": \"-----BEGIN PUBLIC KEY-----\\n...\\n-----END PUBLIC KEY-----\"\n    }\n  },\n  \"steps\": {\n    \"build\": {\n      \"name\": \"build\",\n      \"attestations\": [\n        {\n          \"type\": \"https://witness.dev/attestations/github/v0.1\"\n        },\n        {\n          \"type\": \"https://witness.dev/attestations/environment/v0.1\"\n        },\n        {\n          \"type\": \"https://witness.dev/attestations/product/v0.1\"\n        },\n        {\n          \"type\": \"https://witness.dev/attestations/material/v0.1\"\n        }\n      ],\n      \"functionaries\": [\n        {\n          \"type\": \"publickey\",\n          \"publickeyid\": \"build-key\"\n        }\n      ]\n    }\n  }\n}\n```\n\n**Witness Run Command:**\n```bash\nwitness run --step build \\\n  --attestations github,environment,product,material \\\n  --outfile build-attestation.json \\\n  --key signing-key.pem \\\n  -- <your-build-command>\n```\n\n**Rego Validation Rules:**\n```rego\n\n```\n\n**Verification:**\n```bash\nwitness verify \\\n  --policy policy-signed.json \\\n  --publickey policy-key.pub \\\n  -a build-attestation.json \\\n  --subject <artifact>\n```\n"}]}
{"messages": [{"role": "system", "content": "You are an expert in the Witness supply chain attestation framework. You help users instrument CI/CD pipelines with witness, create policy documents, and write Rego policies to validate attestations. You understand all attestors in go-witness and how to use them effectively."}, {"role": "user", "content": "How do I create a multi-step witness policy for a build \u2192 test \u2192 package pipeline?"}, {"role": "assistant", "content": "Here's a complete multi-step witness policy for your pipeline:\n\n**Policy Document:**\n```json\n{\n  \"expires\": \"2026-11-08T10:52:59Z\",\n  \"publickeys\": {\n    \"ci-key\": {\n      \"keyid\": \"sha256:32b2cc7ae579e71e45163e98c444bc6a900b5e9fecda4fa17d2ff7c9a1d4b33e\",\n      \"key\": \"-----BEGIN PUBLIC KEY-----\\n...\\n-----END PUBLIC KEY-----\"\n    }\n  },\n  \"steps\": {\n    \"build\": {\n      \"name\": \"build\",\n      \"attestations\": [\n        {\n          \"type\": \"https://witness.dev/attestations/git/v0.1\"\n        },\n        {\n          \"type\": \"https://witness.dev/attestations/command-run/v0.1\"\n        },\n        {\n          \"type\": \"https://witness.dev/attestations/product/v0.1\"\n        }\n      ],\n      \"functionaries\": [\n        {\n          \"type\": \"publickey\",\n          \"publickeyid\": \"ci-key\"\n        }\n      ]\n    },\n    \"test\": {\n      \"name\": \"test\",\n      \"attestations\": [\n        {\n          \"type\": \"https://witness.dev/attestations/material/v0.1\"\n        },\n        {\n          \"type\": \"https://witness.dev/attestations/command-run/v0.1\"\n        }\n      ],\n      \"functionaries\": [\n        {\n          \"type\": \"publickey\",\n          \"publickeyid\": \"ci-key\"\n        }\n      ]\n    },\n    \"package\": {\n      \"name\": \"package\",\n      \"attestations\": [\n        {\n          \"type\": \"https://witness.dev/attestations/material/v0.1\"\n        },\n        {\n          \"type\": \"https://witness.dev/attestations/product/v0.1\"\n        }\n      ],\n      \"functionaries\": [\n        {\n          \"type\": \"publickey\",\n          \"publickeyid\": \"ci-key\"\n        }\n      ]\n    }\n  }\n}\n```\n\n**Pipeline Commands:**\n\n```bash\n# Step 1: Build\nwitness run --step build \\\n  --attestations git,commandrun,product \\\n  -o build.json --key ci-key.pem \\\n  -- go build -o myapp\n\n# Step 2: Test\nwitness run --step test \\\n  --attestations material,commandrun \\\n  -o test.json --key ci-key.pem \\\n  -- go test ./...\n\n# Step 3: Package\nwitness run --step package \\\n  --attestations material,product \\\n  -o package.json --key ci-key.pem \\\n  -- tar czf myapp.tar.gz myapp\n\n# Verify entire pipeline\nwitness verify \\\n  --policy policy-signed.json \\\n  --publickey policy-key.pub \\\n  -a build.json -a test.json -a package.json\n```\n"}]}
{"messages": [{"role": "system", "content": "You are an expert in the Witness supply chain attestation framework. You help users instrument CI/CD pipelines with witness, create policy documents, and write Rego policies to validate attestations. You understand all attestors in go-witness and how to use them effectively."}, {"role": "user", "content": "How do I create a multi-step witness policy for a build \u2192 test \u2192 package pipeline?"}, {"role": "assistant", "content": "Here's a complete multi-step witness policy for your pipeline:\n\n**Policy Document:**\n```json\n{\n  \"expires\": \"2026-11-08T10:52:59Z\",\n  \"publickeys\": {\n    \"ci-key\": {\n      \"keyid\": \"sha256:74ff38b5690a557cbd4f9565aa5223fb2ec93a9135aeeb01aaeb23d40711d421\",\n      \"key\": \"-----BEGIN PUBLIC KEY-----\\n...\\n-----END PUBLIC KEY-----\"\n    }\n  },\n  \"steps\": {\n    \"build\": {\n      \"name\": \"build\",\n      \"attestations\": [\n        {\n          \"type\": \"https://witness.dev/attestations/git/v0.1\"\n        },\n        {\n          \"type\": \"https://witness.dev/attestations/command-run/v0.1\"\n        },\n        {\n          \"type\": \"https://witness.dev/attestations/product/v0.1\"\n        }\n      ],\n      \"functionaries\": [\n        {\n          \"type\": \"publickey\",\n          \"publickeyid\": \"ci-key\"\n        }\n      ]\n    },\n    \"test\": {\n      \"name\": \"test\",\n      \"attestations\": [\n        {\n          \"type\": \"https://witness.dev/attestations/material/v0.1\"\n        },\n        {\n          \"type\": \"https://witness.dev/attestations/command-run/v0.1\"\n        }\n      ],\n      \"functionaries\": [\n        {\n          \"type\": \"publickey\",\n          \"publickeyid\": \"ci-key\"\n        }\n      ]\n    },\n    \"package\": {\n      \"name\": \"package\",\n      \"attestations\": [\n        {\n          \"type\": \"https://witness.dev/attestations/material/v0.1\"\n        },\n        {\n          \"type\": \"https://witness.dev/attestations/product/v0.1\"\n        }\n      ],\n      \"functionaries\": [\n        {\n          \"type\": \"publickey\",\n          \"publickeyid\": \"ci-key\"\n        }\n      ]\n    }\n  }\n}\n```\n\n**Pipeline Commands:**\n\n```bash\n# Step 1: Build\nwitness run --step build \\\n  --attestations git,commandrun,product \\\n  -o build.json --key ci-key.pem \\\n  -- go build -o myapp\n\n# Step 2: Test\nwitness run --step test \\\n  --attestations material,commandrun \\\n  -o test.json --key ci-key.pem \\\n  -- go test ./...\n\n# Step 3: Package\nwitness run --step package \\\n  --attestations material,product \\\n  -o package.json --key ci-key.pem \\\n  -- tar czf myapp.tar.gz myapp\n\n# Verify entire pipeline\nwitness verify \\\n  --policy policy-signed.json \\\n  --publickey policy-key.pub \\\n  -a build.json -a test.json -a package.json\n```\n"}]}
{"messages": [{"role": "system", "content": "You are an expert in the Witness supply chain attestation framework. You help users instrument CI/CD pipelines with witness, create policy documents, and write Rego policies to validate attestations. You understand all attestors in go-witness and how to use them effectively."}, {"role": "user", "content": "How do I create a witness policy for a build step that uses these attestors: environment, product, github, material, git?"}, {"role": "assistant", "content": "Here's a complete witness policy for your build step with environment, product, github, material, git attestors:\n\n**Policy Document:**\n```json\n{\n  \"expires\": \"2026-11-08T10:52:59Z\",\n  \"publickeys\": {\n    \"build-key\": {\n      \"keyid\": \"sha256:ded4032991b97fa374f82a82c87c9c8864b1ee515c7c6921e729240e50bf25dc\",\n      \"key\": \"-----BEGIN PUBLIC KEY-----\\n...\\n-----END PUBLIC KEY-----\"\n    }\n  },\n  \"steps\": {\n    \"build\": {\n      \"name\": \"build\",\n      \"attestations\": [\n        {\n          \"type\": \"https://witness.dev/attestations/environment/v0.1\"\n        },\n        {\n          \"type\": \"https://witness.dev/attestations/product/v0.1\"\n        },\n        {\n          \"type\": \"https://witness.dev/attestations/github/v0.1\"\n        },\n        {\n          \"type\": \"https://witness.dev/attestations/material/v0.1\"\n        },\n        {\n          \"type\": \"https://witness.dev/attestations/git/v0.1\"\n        }\n      ],\n      \"functionaries\": [\n        {\n          \"type\": \"publickey\",\n          \"publickeyid\": \"build-key\"\n        }\n      ]\n    }\n  }\n}\n```\n\n**Witness Run Command:**\n```bash\nwitness run --step build \\\n  --attestations environment,product,github,material,git \\\n  --outfile build-attestation.json \\\n  --key signing-key.pem \\\n  -- <your-build-command>\n```\n\n**Rego Validation Rules:**\n```rego\npackage environment\n\nimport rego.v1\n\n# Ensure correct OS\ndeny contains msg if {\n    input.os != \"darwin\"\n    msg := sprintf(\"Must run on darwin, got: %s\", [input.os])\n}\n\n# Require CI environment\ndeny contains msg if {\n    not \"CI\" in input.variables\n    msg := \"Must run in CI environment (CI variable not set)\"\n}\n```\n\n**Verification:**\n```bash\nwitness verify \\\n  --policy policy-signed.json \\\n  --publickey policy-key.pub \\\n  -a build-attestation.json \\\n  --subject <artifact>\n```\n"}]}
{"messages": [{"role": "system", "content": "You are an expert in the Witness supply chain attestation framework. You help users instrument CI/CD pipelines with witness, create policy documents, and write Rego policies to validate attestations. You understand all attestors in go-witness and how to use them effectively."}, {"role": "user", "content": "How do I create a multi-step witness policy for a build \u2192 test \u2192 package pipeline?"}, {"role": "assistant", "content": "Here's a complete multi-step witness policy for your pipeline:\n\n**Policy Document:**\n```json\n{\n  \"expires\": \"2026-11-08T10:52:59Z\",\n  \"publickeys\": {\n    \"ci-key\": {\n      \"keyid\": \"sha256:60ef4d293a8dc6eab2e8ab496acc098d6a6df51f311548ce71000d421bbc6878\",\n      \"key\": \"-----BEGIN PUBLIC KEY-----\\n...\\n-----END PUBLIC KEY-----\"\n    }\n  },\n  \"steps\": {\n    \"build\": {\n      \"name\": \"build\",\n      \"attestations\": [\n        {\n          \"type\": \"https://witness.dev/attestations/git/v0.1\"\n        },\n        {\n          \"type\": \"https://witness.dev/attestations/command-run/v0.1\"\n        },\n        {\n          \"type\": \"https://witness.dev/attestations/product/v0.1\"\n        }\n      ],\n      \"functionaries\": [\n        {\n          \"type\": \"publickey\",\n          \"publickeyid\": \"ci-key\"\n        }\n      ]\n    },\n    \"test\": {\n      \"name\": \"test\",\n      \"attestations\": [\n        {\n          \"type\": \"https://witness.dev/attestations/material/v0.1\"\n        },\n        {\n          \"type\": \"https://witness.dev/attestations/command-run/v0.1\"\n        }\n      ],\n      \"functionaries\": [\n        {\n          \"type\": \"publickey\",\n          \"publickeyid\": \"ci-key\"\n        }\n      ]\n    },\n    \"package\": {\n      \"name\": \"package\",\n      \"attestations\": [\n        {\n          \"type\": \"https://witness.dev/attestations/material/v0.1\"\n        },\n        {\n          \"type\": \"https://witness.dev/attestations/product/v0.1\"\n        }\n      ],\n      \"functionaries\": [\n        {\n          \"type\": \"publickey\",\n          \"publickeyid\": \"ci-key\"\n        }\n      ]\n    }\n  }\n}\n```\n\n**Pipeline Commands:**\n\n```bash\n# Step 1: Build\nwitness run --step build \\\n  --attestations git,commandrun,product \\\n  -o build.json --key ci-key.pem \\\n  -- go build -o myapp\n\n# Step 2: Test\nwitness run --step test \\\n  --attestations material,commandrun \\\n  -o test.json --key ci-key.pem \\\n  -- go test ./...\n\n# Step 3: Package\nwitness run --step package \\\n  --attestations material,product \\\n  -o package.json --key ci-key.pem \\\n  -- tar czf myapp.tar.gz myapp\n\n# Verify entire pipeline\nwitness verify \\\n  --policy policy-signed.json \\\n  --publickey policy-key.pub \\\n  -a build.json -a test.json -a package.json\n```\n"}]}
{"messages": [{"role": "system", "content": "You are an expert in the Witness supply chain attestation framework. You help users instrument CI/CD pipelines with witness, create policy documents, and write Rego policies to validate attestations. You understand all attestors in go-witness and how to use them effectively."}, {"role": "user", "content": "How do I create a witness policy for a build step that uses these attestors: product?"}, {"role": "assistant", "content": "Here's a complete witness policy for your build step with product attestors:\n\n**Policy Document:**\n```json\n{\n  \"expires\": \"2026-11-08T10:52:59Z\",\n  \"publickeys\": {\n    \"build-key\": {\n      \"keyid\": \"sha256:3a13c54fcb1db89d0e0b54a7cf313e48c4a53246235558d8fc891cbf3be13176\",\n      \"key\": \"-----BEGIN PUBLIC KEY-----\\n...\\n-----END PUBLIC KEY-----\"\n    }\n  },\n  \"steps\": {\n    \"build\": {\n      \"name\": \"build\",\n      \"attestations\": [\n        {\n          \"type\": \"https://witness.dev/attestations/product/v0.1\"\n        }\n      ],\n      \"functionaries\": [\n        {\n          \"type\": \"publickey\",\n          \"publickeyid\": \"build-key\"\n        }\n      ]\n    }\n  }\n}\n```\n\n**Witness Run Command:**\n```bash\nwitness run --step build \\\n  --attestations product \\\n  --outfile build-attestation.json \\\n  --key signing-key.pem \\\n  -- <your-build-command>\n```\n\n**Rego Validation Rules:**\n```rego\n\n```\n\n**Verification:**\n```bash\nwitness verify \\\n  --policy policy-signed.json \\\n  --publickey policy-key.pub \\\n  -a build-attestation.json \\\n  --subject <artifact>\n```\n"}]}
{"messages": [{"role": "system", "content": "You are an expert in the Witness supply chain attestation framework. You help users instrument CI/CD pipelines with witness, create policy documents, and write Rego policies to validate attestations. You understand all attestors in go-witness and how to use them effectively."}, {"role": "user", "content": "How do I create a multi-step witness policy for a build \u2192 test \u2192 package pipeline?"}, {"role": "assistant", "content": "Here's a complete multi-step witness policy for your pipeline:\n\n**Policy Document:**\n```json\n{\n  \"expires\": \"2026-11-08T10:52:59Z\",\n  \"publickeys\": {\n    \"ci-key\": {\n      \"keyid\": \"sha256:30113306095765cd18034446d6d4e9d71cd31bee2e0a0acc7391b0dca0453543\",\n      \"key\": \"-----BEGIN PUBLIC KEY-----\\n...\\n-----END PUBLIC KEY-----\"\n    }\n  },\n  \"steps\": {\n    \"build\": {\n      \"name\": \"build\",\n      \"attestations\": [\n        {\n          \"type\": \"https://witness.dev/attestations/git/v0.1\"\n        },\n        {\n          \"type\": \"https://witness.dev/attestations/command-run/v0.1\"\n        },\n        {\n          \"type\": \"https://witness.dev/attestations/product/v0.1\"\n        }\n      ],\n      \"functionaries\": [\n        {\n          \"type\": \"publickey\",\n          \"publickeyid\": \"ci-key\"\n        }\n      ]\n    },\n    \"test\": {\n      \"name\": \"test\",\n      \"attestations\": [\n        {\n          \"type\": \"https://witness.dev/attestations/material/v0.1\"\n        },\n        {\n          \"type\": \"https://witness.dev/attestations/command-run/v0.1\"\n        }\n      ],\n      \"functionaries\": [\n        {\n          \"type\": \"publickey\",\n          \"publickeyid\": \"ci-key\"\n        }\n      ]\n    },\n    \"package\": {\n      \"name\": \"package\",\n      \"attestations\": [\n        {\n          \"type\": \"https://witness.dev/attestations/material/v0.1\"\n        },\n        {\n          \"type\": \"https://witness.dev/attestations/product/v0.1\"\n        }\n      ],\n      \"functionaries\": [\n        {\n          \"type\": \"publickey\",\n          \"publickeyid\": \"ci-key\"\n        }\n      ]\n    }\n  }\n}\n```\n\n**Pipeline Commands:**\n\n```bash\n# Step 1: Build\nwitness run --step build \\\n  --attestations git,commandrun,product \\\n  -o build.json --key ci-key.pem \\\n  -- go build -o myapp\n\n# Step 2: Test\nwitness run --step test \\\n  --attestations material,commandrun \\\n  -o test.json --key ci-key.pem \\\n  -- go test ./...\n\n# Step 3: Package\nwitness run --step package \\\n  --attestations material,product \\\n  -o package.json --key ci-key.pem \\\n  -- tar czf myapp.tar.gz myapp\n\n# Verify entire pipeline\nwitness verify \\\n  --policy policy-signed.json \\\n  --publickey policy-key.pub \\\n  -a build.json -a test.json -a package.json\n```\n"}]}
{"messages": [{"role": "system", "content": "You are an expert in the Witness supply chain attestation framework. You help users instrument CI/CD pipelines with witness, create policy documents, and write Rego policies to validate attestations. You understand all attestors in go-witness and how to use them effectively."}, {"role": "user", "content": "How do I create a witness policy for a build step that uses these attestors: environment, commandrun, git?"}, {"role": "assistant", "content": "Here's a complete witness policy for your build step with environment, commandrun, git attestors:\n\n**Policy Document:**\n```json\n{\n  \"expires\": \"2026-11-08T10:52:59Z\",\n  \"publickeys\": {\n    \"build-key\": {\n      \"keyid\": \"sha256:d670756a12767f9740b1a8fc5901ed825149a6f448b68e31dda91d041c38efab\",\n      \"key\": \"-----BEGIN PUBLIC KEY-----\\n...\\n-----END PUBLIC KEY-----\"\n    }\n  },\n  \"steps\": {\n    \"build\": {\n      \"name\": \"build\",\n      \"attestations\": [\n        {\n          \"type\": \"https://witness.dev/attestations/environment/v0.1\"\n        },\n        {\n          \"type\": \"https://witness.dev/attestations/command-run/v0.1\"\n        },\n        {\n          \"type\": \"https://witness.dev/attestations/git/v0.1\"\n        }\n      ],\n      \"functionaries\": [\n        {\n          \"type\": \"publickey\",\n          \"publickeyid\": \"build-key\"\n        }\n      ]\n    }\n  }\n}\n```\n\n**Witness Run Command:**\n```bash\nwitness run --step build \\\n  --attestations environment,commandrun,git \\\n  --outfile build-attestation.json \\\n  --key signing-key.pem \\\n  -- <your-build-command>\n```\n\n**Rego Validation Rules:**\n```rego\npackage environment\n\nimport rego.v1\n\n# Ensure correct OS\ndeny contains msg if {\n    input.os != \"darwin\"\n    msg := sprintf(\"Must run on darwin, got: %s\", [input.os])\n}\n\n# Require CI environment\ndeny contains msg if {\n    not \"CI\" in input.variables\n    msg := \"Must run in CI environment (CI variable not set)\"\n}\n```\n\n**Verification:**\n```bash\nwitness verify \\\n  --policy policy-signed.json \\\n  --publickey policy-key.pub \\\n  -a build-attestation.json \\\n  --subject <artifact>\n```\n"}]}
{"messages": [{"role": "system", "content": "You are an expert in the Witness supply chain attestation framework. You help users instrument CI/CD pipelines with witness, create policy documents, and write Rego policies to validate attestations. You understand all attestors in go-witness and how to use them effectively."}, {"role": "user", "content": "How do I create a multi-step witness policy for a build \u2192 test \u2192 package pipeline?"}, {"role": "assistant", "content": "Here's a complete multi-step witness policy for your pipeline:\n\n**Policy Document:**\n```json\n{\n  \"expires\": \"2026-11-08T10:52:59Z\",\n  \"publickeys\": {\n    \"ci-key\": {\n      \"keyid\": \"sha256:7874afc138948096445fecf3ba0f32182792d0c3201793e64739b5f1177a49fb\",\n      \"key\": \"-----BEGIN PUBLIC KEY-----\\n...\\n-----END PUBLIC KEY-----\"\n    }\n  },\n  \"steps\": {\n    \"build\": {\n      \"name\": \"build\",\n      \"attestations\": [\n        {\n          \"type\": \"https://witness.dev/attestations/git/v0.1\"\n        },\n        {\n          \"type\": \"https://witness.dev/attestations/command-run/v0.1\"\n        },\n        {\n          \"type\": \"https://witness.dev/attestations/product/v0.1\"\n        }\n      ],\n      \"functionaries\": [\n        {\n          \"type\": \"publickey\",\n          \"publickeyid\": \"ci-key\"\n        }\n      ]\n    },\n    \"test\": {\n      \"name\": \"test\",\n      \"attestations\": [\n        {\n          \"type\": \"https://witness.dev/attestations/material/v0.1\"\n        },\n        {\n          \"type\": \"https://witness.dev/attestations/command-run/v0.1\"\n        }\n      ],\n      \"functionaries\": [\n        {\n          \"type\": \"publickey\",\n          \"publickeyid\": \"ci-key\"\n        }\n      ]\n    },\n    \"package\": {\n      \"name\": \"package\",\n      \"attestations\": [\n        {\n          \"type\": \"https://witness.dev/attestations/material/v0.1\"\n        },\n        {\n          \"type\": \"https://witness.dev/attestations/product/v0.1\"\n        }\n      ],\n      \"functionaries\": [\n        {\n          \"type\": \"publickey\",\n          \"publickeyid\": \"ci-key\"\n        }\n      ]\n    }\n  }\n}\n```\n\n**Pipeline Commands:**\n\n```bash\n# Step 1: Build\nwitness run --step build \\\n  --attestations git,commandrun,product \\\n  -o build.json --key ci-key.pem \\\n  -- go build -o myapp\n\n# Step 2: Test\nwitness run --step test \\\n  --attestations material,commandrun \\\n  -o test.json --key ci-key.pem \\\n  -- go test ./...\n\n# Step 3: Package\nwitness run --step package \\\n  --attestations material,product \\\n  -o package.json --key ci-key.pem \\\n  -- tar czf myapp.tar.gz myapp\n\n# Verify entire pipeline\nwitness verify \\\n  --policy policy-signed.json \\\n  --publickey policy-key.pub \\\n  -a build.json -a test.json -a package.json\n```\n"}]}
{"messages": [{"role": "system", "content": "You are an expert in the Witness supply chain attestation framework. You help users instrument CI/CD pipelines with witness, create policy documents, and write Rego policies to validate attestations. You understand all attestors in go-witness and how to use them effectively."}, {"role": "user", "content": "How do I create a witness policy for a build step that uses these attestors: material?"}, {"role": "assistant", "content": "Here's a complete witness policy for your build step with material attestors:\n\n**Policy Document:**\n```json\n{\n  \"expires\": \"2026-11-08T10:52:59Z\",\n  \"publickeys\": {\n    \"build-key\": {\n      \"keyid\": \"sha256:89d4d73ef82d93688d5ddd2cf313d67ca361f9f801eda193b94ad101dffdd376\",\n      \"key\": \"-----BEGIN PUBLIC KEY-----\\n...\\n-----END PUBLIC KEY-----\"\n    }\n  },\n  \"steps\": {\n    \"build\": {\n      \"name\": \"build\",\n      \"attestations\": [\n        {\n          \"type\": \"https://witness.dev/attestations/material/v0.1\"\n        }\n      ],\n      \"functionaries\": [\n        {\n          \"type\": \"publickey\",\n          \"publickeyid\": \"build-key\"\n        }\n      ]\n    }\n  }\n}\n```\n\n**Witness Run Command:**\n```bash\nwitness run --step build \\\n  --attestations material \\\n  --outfile build-attestation.json \\\n  --key signing-key.pem \\\n  -- <your-build-command>\n```\n\n**Rego Validation Rules:**\n```rego\n\n```\n\n**Verification:**\n```bash\nwitness verify \\\n  --policy policy-signed.json \\\n  --publickey policy-key.pub \\\n  -a build-attestation.json \\\n  --subject <artifact>\n```\n"}]}
{"messages": [{"role": "system", "content": "You are an expert in the Witness supply chain attestation framework. You help users instrument CI/CD pipelines with witness, create policy documents, and write Rego policies to validate attestations. You understand all attestors in go-witness and how to use them effectively."}, {"role": "user", "content": "How do I create a multi-step witness policy for a build \u2192 test \u2192 package pipeline?"}, {"role": "assistant", "content": "Here's a complete multi-step witness policy for your pipeline:\n\n**Policy Document:**\n```json\n{\n  \"expires\": \"2026-11-08T10:52:59Z\",\n  \"publickeys\": {\n    \"ci-key\": {\n      \"keyid\": \"sha256:cc490617ac54e23bd2e0b3b7950dc5b806820999c7afaa69a379ed1100dbd27d\",\n      \"key\": \"-----BEGIN PUBLIC KEY-----\\n...\\n-----END PUBLIC KEY-----\"\n    }\n  },\n  \"steps\": {\n    \"build\": {\n      \"name\": \"build\",\n      \"attestations\": [\n        {\n          \"type\": \"https://witness.dev/attestations/git/v0.1\"\n        },\n        {\n          \"type\": \"https://witness.dev/attestations/command-run/v0.1\"\n        },\n        {\n          \"type\": \"https://witness.dev/attestations/product/v0.1\"\n        }\n      ],\n      \"functionaries\": [\n        {\n          \"type\": \"publickey\",\n          \"publickeyid\": \"ci-key\"\n        }\n      ]\n    },\n    \"test\": {\n      \"name\": \"test\",\n      \"attestations\": [\n        {\n          \"type\": \"https://witness.dev/attestations/material/v0.1\"\n        },\n        {\n          \"type\": \"https://witness.dev/attestations/command-run/v0.1\"\n        }\n      ],\n      \"functionaries\": [\n        {\n          \"type\": \"publickey\",\n          \"publickeyid\": \"ci-key\"\n        }\n      ]\n    },\n    \"package\": {\n      \"name\": \"package\",\n      \"attestations\": [\n        {\n          \"type\": \"https://witness.dev/attestations/material/v0.1\"\n        },\n        {\n          \"type\": \"https://witness.dev/attestations/product/v0.1\"\n        }\n      ],\n      \"functionaries\": [\n        {\n          \"type\": \"publickey\",\n          \"publickeyid\": \"ci-key\"\n        }\n      ]\n    }\n  }\n}\n```\n\n**Pipeline Commands:**\n\n```bash\n# Step 1: Build\nwitness run --step build \\\n  --attestations git,commandrun,product \\\n  -o build.json --key ci-key.pem \\\n  -- go build -o myapp\n\n# Step 2: Test\nwitness run --step test \\\n  --attestations material,commandrun \\\n  -o test.json --key ci-key.pem \\\n  -- go test ./...\n\n# Step 3: Package\nwitness run --step package \\\n  --attestations material,product \\\n  -o package.json --key ci-key.pem \\\n  -- tar czf myapp.tar.gz myapp\n\n# Verify entire pipeline\nwitness verify \\\n  --policy policy-signed.json \\\n  --publickey policy-key.pub \\\n  -a build.json -a test.json -a package.json\n```\n"}]}
{"messages": [{"role": "system", "content": "You are an expert in the Witness supply chain attestation framework. You help users instrument CI/CD pipelines with witness, create policy documents, and write Rego policies to validate attestations. You understand all attestors in go-witness and how to use them effectively."}, {"role": "user", "content": "How do I create a witness policy for a build step that uses these attestors: product, material?"}, {"role": "assistant", "content": "Here's a complete witness policy for your build step with product, material attestors:\n\n**Policy Document:**\n```json\n{\n  \"expires\": \"2026-11-08T10:52:59Z\",\n  \"publickeys\": {\n    \"build-key\": {\n      \"keyid\": \"sha256:4abe0b7b34b027f7e948f62daef122fbc95860b7b094f1c22fdc7f1df95bdf99\",\n      \"key\": \"-----BEGIN PUBLIC KEY-----\\n...\\n-----END PUBLIC KEY-----\"\n    }\n  },\n  \"steps\": {\n    \"build\": {\n      \"name\": \"build\",\n      \"attestations\": [\n        {\n          \"type\": \"https://witness.dev/attestations/product/v0.1\"\n        },\n        {\n          \"type\": \"https://witness.dev/attestations/material/v0.1\"\n        }\n      ],\n      \"functionaries\": [\n        {\n          \"type\": \"publickey\",\n          \"publickeyid\": \"build-key\"\n        }\n      ]\n    }\n  }\n}\n```\n\n**Witness Run Command:**\n```bash\nwitness run --step build \\\n  --attestations product,material \\\n  --outfile build-attestation.json \\\n  --key signing-key.pem \\\n  -- <your-build-command>\n```\n\n**Rego Validation Rules:**\n```rego\n\n```\n\n**Verification:**\n```bash\nwitness verify \\\n  --policy policy-signed.json \\\n  --publickey policy-key.pub \\\n  -a build-attestation.json \\\n  --subject <artifact>\n```\n"}]}
{"messages": [{"role": "system", "content": "You are an expert in the Witness supply chain attestation framework. You help users instrument CI/CD pipelines with witness, create policy documents, and write Rego policies to validate attestations. You understand all attestors in go-witness and how to use them effectively."}, {"role": "user", "content": "How do I create a witness policy for a build step that uses these attestors: environment?"}, {"role": "assistant", "content": "Here's a complete witness policy for your build step with environment attestors:\n\n**Policy Document:**\n```json\n{\n  \"expires\": \"2026-11-08T10:52:59Z\",\n  \"publickeys\": {\n    \"build-key\": {\n      \"keyid\": \"sha256:527f0d84f905a4622973332b47b247effb8c87782d674a88b2c917ca7348b704\",\n      \"key\": \"-----BEGIN PUBLIC KEY-----\\n...\\n-----END PUBLIC KEY-----\"\n    }\n  },\n  \"steps\": {\n    \"build\": {\n      \"name\": \"build\",\n      \"attestations\": [\n        {\n          \"type\": \"https://witness.dev/attestations/environment/v0.1\"\n        }\n      ],\n      \"functionaries\": [\n        {\n          \"type\": \"publickey\",\n          \"publickeyid\": \"build-key\"\n        }\n      ]\n    }\n  }\n}\n```\n\n**Witness Run Command:**\n```bash\nwitness run --step build \\\n  --attestations environment \\\n  --outfile build-attestation.json \\\n  --key signing-key.pem \\\n  -- <your-build-command>\n```\n\n**Rego Validation Rules:**\n```rego\npackage environment\n\nimport rego.v1\n\n# Ensure correct OS\ndeny contains msg if {\n    input.os != \"windows\"\n    msg := sprintf(\"Must run on windows, got: %s\", [input.os])\n}\n\n# Require CI environment\ndeny contains msg if {\n    not \"CI\" in input.variables\n    msg := \"Must run in CI environment (CI variable not set)\"\n}\n```\n\n**Verification:**\n```bash\nwitness verify \\\n  --policy policy-signed.json \\\n  --publickey policy-key.pub \\\n  -a build-attestation.json \\\n  --subject <artifact>\n```\n"}]}
{"messages": [{"role": "system", "content": "You are an expert in the Witness supply chain attestation framework. You help users instrument CI/CD pipelines with witness, create policy documents, and write Rego policies to validate attestations. You understand all attestors in go-witness and how to use them effectively."}, {"role": "user", "content": "How do I create a witness policy for a build step that uses these attestors: github, product?"}, {"role": "assistant", "content": "Here's a complete witness policy for your build step with github, product attestors:\n\n**Policy Document:**\n```json\n{\n  \"expires\": \"2026-11-08T10:52:59Z\",\n  \"publickeys\": {\n    \"build-key\": {\n      \"keyid\": \"sha256:5d888a03599be3f52399336dcf7e73a6b36bf7f10f830fb45d03f9f0c3fae8b5\",\n      \"key\": \"-----BEGIN PUBLIC KEY-----\\n...\\n-----END PUBLIC KEY-----\"\n    }\n  },\n  \"steps\": {\n    \"build\": {\n      \"name\": \"build\",\n      \"attestations\": [\n        {\n          \"type\": \"https://witness.dev/attestations/github/v0.1\"\n        },\n        {\n          \"type\": \"https://witness.dev/attestations/product/v0.1\"\n        }\n      ],\n      \"functionaries\": [\n        {\n          \"type\": \"publickey\",\n          \"publickeyid\": \"build-key\"\n        }\n      ]\n    }\n  }\n}\n```\n\n**Witness Run Command:**\n```bash\nwitness run --step build \\\n  --attestations github,product \\\n  --outfile build-attestation.json \\\n  --key signing-key.pem \\\n  -- <your-build-command>\n```\n\n**Rego Validation Rules:**\n```rego\n\n```\n\n**Verification:**\n```bash\nwitness verify \\\n  --policy policy-signed.json \\\n  --publickey policy-key.pub \\\n  -a build-attestation.json \\\n  --subject <artifact>\n```\n"}]}
{"messages": [{"role": "system", "content": "You are an expert in the Witness supply chain attestation framework. You help users instrument CI/CD pipelines with witness, create policy documents, and write Rego policies to validate attestations. You understand all attestors in go-witness and how to use them effectively."}, {"role": "user", "content": "How do I create a witness policy for a build step that uses these attestors: product, commandrun?"}, {"role": "assistant", "content": "Here's a complete witness policy for your build step with product, commandrun attestors:\n\n**Policy Document:**\n```json\n{\n  \"expires\": \"2026-11-08T10:52:59Z\",\n  \"publickeys\": {\n    \"build-key\": {\n      \"keyid\": \"sha256:c53fda065275f3d92a3c40a7794cd11f284bdb8113d9b10536ddace219cf5387\",\n      \"key\": \"-----BEGIN PUBLIC KEY-----\\n...\\n-----END PUBLIC KEY-----\"\n    }\n  },\n  \"steps\": {\n    \"build\": {\n      \"name\": \"build\",\n      \"attestations\": [\n        {\n          \"type\": \"https://witness.dev/attestations/product/v0.1\"\n        },\n        {\n          \"type\": \"https://witness.dev/attestations/command-run/v0.1\"\n        }\n      ],\n      \"functionaries\": [\n        {\n          \"type\": \"publickey\",\n          \"publickeyid\": \"build-key\"\n        }\n      ]\n    }\n  }\n}\n```\n\n**Witness Run Command:**\n```bash\nwitness run --step build \\\n  --attestations product,commandrun \\\n  --outfile build-attestation.json \\\n  --key signing-key.pem \\\n  -- <your-build-command>\n```\n\n**Rego Validation Rules:**\n```rego\n\n```\n\n**Verification:**\n```bash\nwitness verify \\\n  --policy policy-signed.json \\\n  --publickey policy-key.pub \\\n  -a build-attestation.json \\\n  --subject <artifact>\n```\n"}]}
{"messages": [{"role": "system", "content": "You are an expert in the Witness supply chain attestation framework. You help users instrument CI/CD pipelines with witness, create policy documents, and write Rego policies to validate attestations. You understand all attestors in go-witness and how to use them effectively."}, {"role": "user", "content": "How do I create a multi-step witness policy for a build \u2192 test \u2192 package pipeline?"}, {"role": "assistant", "content": "Here's a complete multi-step witness policy for your pipeline:\n\n**Policy Document:**\n```json\n{\n  \"expires\": \"2026-11-08T10:52:59Z\",\n  \"publickeys\": {\n    \"ci-key\": {\n      \"keyid\": \"sha256:c037f320cb47f6528e67171bf77e93f4e42907caacc43862ed539eb08cfdf66d\",\n      \"key\": \"-----BEGIN PUBLIC KEY-----\\n...\\n-----END PUBLIC KEY-----\"\n    }\n  },\n  \"steps\": {\n    \"build\": {\n      \"name\": \"build\",\n      \"attestations\": [\n        {\n          \"type\": \"https://witness.dev/attestations/git/v0.1\"\n        },\n        {\n          \"type\": \"https://witness.dev/attestations/command-run/v0.1\"\n        },\n        {\n          \"type\": \"https://witness.dev/attestations/product/v0.1\"\n        }\n      ],\n      \"functionaries\": [\n        {\n          \"type\": \"publickey\",\n          \"publickeyid\": \"ci-key\"\n        }\n      ]\n    },\n    \"test\": {\n      \"name\": \"test\",\n      \"attestations\": [\n        {\n          \"type\": \"https://witness.dev/attestations/material/v0.1\"\n        },\n        {\n          \"type\": \"https://witness.dev/attestations/command-run/v0.1\"\n        }\n      ],\n      \"functionaries\": [\n        {\n          \"type\": \"publickey\",\n          \"publickeyid\": \"ci-key\"\n        }\n      ]\n    },\n    \"package\": {\n      \"name\": \"package\",\n      \"attestations\": [\n        {\n          \"type\": \"https://witness.dev/attestations/material/v0.1\"\n        },\n        {\n          \"type\": \"https://witness.dev/attestations/product/v0.1\"\n        }\n      ],\n      \"functionaries\": [\n        {\n          \"type\": \"publickey\",\n          \"publickeyid\": \"ci-key\"\n        }\n      ]\n    }\n  }\n}\n```\n\n**Pipeline Commands:**\n\n```bash\n# Step 1: Build\nwitness run --step build \\\n  --attestations git,commandrun,product \\\n  -o build.json --key ci-key.pem \\\n  -- go build -o myapp\n\n# Step 2: Test\nwitness run --step test \\\n  --attestations material,commandrun \\\n  -o test.json --key ci-key.pem \\\n  -- go test ./...\n\n# Step 3: Package\nwitness run --step package \\\n  --attestations material,product \\\n  -o package.json --key ci-key.pem \\\n  -- tar czf myapp.tar.gz myapp\n\n# Verify entire pipeline\nwitness verify \\\n  --policy policy-signed.json \\\n  --publickey policy-key.pub \\\n  -a build.json -a test.json -a package.json\n```\n"}]}
{"messages": [{"role": "system", "content": "You are an expert in the Witness supply chain attestation framework. You help users instrument CI/CD pipelines with witness, create policy documents, and write Rego policies to validate attestations. You understand all attestors in go-witness and how to use them effectively."}, {"role": "user", "content": "How do I create a witness policy for a build step that uses these attestors: product, material?"}, {"role": "assistant", "content": "Here's a complete witness policy for your build step with product, material attestors:\n\n**Policy Document:**\n```json\n{\n  \"expires\": \"2026-11-08T10:52:59Z\",\n  \"publickeys\": {\n    \"build-key\": {\n      \"keyid\": \"sha256:d8f7096a923ce553b35237e607f65b2c676f2224d8555b18d30530e2ec88c56d\",\n      \"key\": \"-----BEGIN PUBLIC KEY-----\\n...\\n-----END PUBLIC KEY-----\"\n    }\n  },\n  \"steps\": {\n    \"build\": {\n      \"name\": \"build\",\n      \"attestations\": [\n        {\n          \"type\": \"https://witness.dev/attestations/product/v0.1\"\n        },\n        {\n          \"type\": \"https://witness.dev/attestations/material/v0.1\"\n        }\n      ],\n      \"functionaries\": [\n        {\n          \"type\": \"publickey\",\n          \"publickeyid\": \"build-key\"\n        }\n      ]\n    }\n  }\n}\n```\n\n**Witness Run Command:**\n```bash\nwitness run --step build \\\n  --attestations product,material \\\n  --outfile build-attestation.json \\\n  --key signing-key.pem \\\n  -- <your-build-command>\n```\n\n**Rego Validation Rules:**\n```rego\n\n```\n\n**Verification:**\n```bash\nwitness verify \\\n  --policy policy-signed.json \\\n  --publickey policy-key.pub \\\n  -a build-attestation.json \\\n  --subject <artifact>\n```\n"}]}
{"messages": [{"role": "system", "content": "You are an expert in the Witness supply chain attestation framework. You help users instrument CI/CD pipelines with witness, create policy documents, and write Rego policies to validate attestations. You understand all attestors in go-witness and how to use them effectively."}, {"role": "user", "content": "How do I create a multi-step witness policy for a build \u2192 test \u2192 package pipeline?"}, {"role": "assistant", "content": "Here's a complete multi-step witness policy for your pipeline:\n\n**Policy Document:**\n```json\n{\n  \"expires\": \"2026-11-08T10:52:59Z\",\n  \"publickeys\": {\n    \"ci-key\": {\n      \"keyid\": \"sha256:c0549fb1b94d343d1c76a210bcbf93af2dd2908baa10052ea8fc33bcf9cd1726\",\n      \"key\": \"-----BEGIN PUBLIC KEY-----\\n...\\n-----END PUBLIC KEY-----\"\n    }\n  },\n  \"steps\": {\n    \"build\": {\n      \"name\": \"build\",\n      \"attestations\": [\n        {\n          \"type\": \"https://witness.dev/attestations/git/v0.1\"\n        },\n        {\n          \"type\": \"https://witness.dev/attestations/command-run/v0.1\"\n        },\n        {\n          \"type\": \"https://witness.dev/attestations/product/v0.1\"\n        }\n      ],\n      \"functionaries\": [\n        {\n          \"type\": \"publickey\",\n          \"publickeyid\": \"ci-key\"\n        }\n      ]\n    },\n    \"test\": {\n      \"name\": \"test\",\n      \"attestations\": [\n        {\n          \"type\": \"https://witness.dev/attestations/material/v0.1\"\n        },\n        {\n          \"type\": \"https://witness.dev/attestations/command-run/v0.1\"\n        }\n      ],\n      \"functionaries\": [\n        {\n          \"type\": \"publickey\",\n          \"publickeyid\": \"ci-key\"\n        }\n      ]\n    },\n    \"package\": {\n      \"name\": \"package\",\n      \"attestations\": [\n        {\n          \"type\": \"https://witness.dev/attestations/material/v0.1\"\n        },\n        {\n          \"type\": \"https://witness.dev/attestations/product/v0.1\"\n        }\n      ],\n      \"functionaries\": [\n        {\n          \"type\": \"publickey\",\n          \"publickeyid\": \"ci-key\"\n        }\n      ]\n    }\n  }\n}\n```\n\n**Pipeline Commands:**\n\n```bash\n# Step 1: Build\nwitness run --step build \\\n  --attestations git,commandrun,product \\\n  -o build.json --key ci-key.pem \\\n  -- go build -o myapp\n\n# Step 2: Test\nwitness run --step test \\\n  --attestations material,commandrun \\\n  -o test.json --key ci-key.pem \\\n  -- go test ./...\n\n# Step 3: Package\nwitness run --step package \\\n  --attestations material,product \\\n  -o package.json --key ci-key.pem \\\n  -- tar czf myapp.tar.gz myapp\n\n# Verify entire pipeline\nwitness verify \\\n  --policy policy-signed.json \\\n  --publickey policy-key.pub \\\n  -a build.json -a test.json -a package.json\n```\n"}]}
{"messages": [{"role": "system", "content": "You are an expert in the Witness supply chain attestation framework. You help users instrument CI/CD pipelines with witness, create policy documents, and write Rego policies to validate attestations. You understand all attestors in go-witness and how to use them effectively."}, {"role": "user", "content": "How do I create a multi-step witness policy for a build \u2192 test \u2192 package pipeline?"}, {"role": "assistant", "content": "Here's a complete multi-step witness policy for your pipeline:\n\n**Policy Document:**\n```json\n{\n  \"expires\": \"2026-11-08T10:52:59Z\",\n  \"publickeys\": {\n    \"ci-key\": {\n      \"keyid\": \"sha256:17d5fc70a35f8fc9394e8e26315ca5e59d06f13eab55f47d041b06154287587a\",\n      \"key\": \"-----BEGIN PUBLIC KEY-----\\n...\\n-----END PUBLIC KEY-----\"\n    }\n  },\n  \"steps\": {\n    \"build\": {\n      \"name\": \"build\",\n      \"attestations\": [\n        {\n          \"type\": \"https://witness.dev/attestations/git/v0.1\"\n        },\n        {\n          \"type\": \"https://witness.dev/attestations/command-run/v0.1\"\n        },\n        {\n          \"type\": \"https://witness.dev/attestations/product/v0.1\"\n        }\n      ],\n      \"functionaries\": [\n        {\n          \"type\": \"publickey\",\n          \"publickeyid\": \"ci-key\"\n        }\n      ]\n    },\n    \"test\": {\n      \"name\": \"test\",\n      \"attestations\": [\n        {\n          \"type\": \"https://witness.dev/attestations/material/v0.1\"\n        },\n        {\n          \"type\": \"https://witness.dev/attestations/command-run/v0.1\"\n        }\n      ],\n      \"functionaries\": [\n        {\n          \"type\": \"publickey\",\n          \"publickeyid\": \"ci-key\"\n        }\n      ]\n    },\n    \"package\": {\n      \"name\": \"package\",\n      \"attestations\": [\n        {\n          \"type\": \"https://witness.dev/attestations/material/v0.1\"\n        },\n        {\n          \"type\": \"https://witness.dev/attestations/product/v0.1\"\n        }\n      ],\n      \"functionaries\": [\n        {\n          \"type\": \"publickey\",\n          \"publickeyid\": \"ci-key\"\n        }\n      ]\n    }\n  }\n}\n```\n\n**Pipeline Commands:**\n\n```bash\n# Step 1: Build\nwitness run --step build \\\n  --attestations git,commandrun,product \\\n  -o build.json --key ci-key.pem \\\n  -- go build -o myapp\n\n# Step 2: Test\nwitness run --step test \\\n  --attestations material,commandrun \\\n  -o test.json --key ci-key.pem \\\n  -- go test ./...\n\n# Step 3: Package\nwitness run --step package \\\n  --attestations material,product \\\n  -o package.json --key ci-key.pem \\\n  -- tar czf myapp.tar.gz myapp\n\n# Verify entire pipeline\nwitness verify \\\n  --policy policy-signed.json \\\n  --publickey policy-key.pub \\\n  -a build.json -a test.json -a package.json\n```\n"}]}
{"messages": [{"role": "system", "content": "You are an expert in the Witness supply chain attestation framework. You help users instrument CI/CD pipelines with witness, create policy documents, and write Rego policies to validate attestations. You understand all attestors in go-witness and how to use them effectively."}, {"role": "user", "content": "How do I create a witness policy for a build step that uses these attestors: material, git, environment?"}, {"role": "assistant", "content": "Here's a complete witness policy for your build step with material, git, environment attestors:\n\n**Policy Document:**\n```json\n{\n  \"expires\": \"2026-11-08T10:52:59Z\",\n  \"publickeys\": {\n    \"build-key\": {\n      \"keyid\": \"sha256:c1d7ecef3676f88324a491c8529a59fcdc9df309fa7f71f290672943a3fa5a7a\",\n      \"key\": \"-----BEGIN PUBLIC KEY-----\\n...\\n-----END PUBLIC KEY-----\"\n    }\n  },\n  \"steps\": {\n    \"build\": {\n      \"name\": \"build\",\n      \"attestations\": [\n        {\n          \"type\": \"https://witness.dev/attestations/material/v0.1\"\n        },\n        {\n          \"type\": \"https://witness.dev/attestations/git/v0.1\"\n        },\n        {\n          \"type\": \"https://witness.dev/attestations/environment/v0.1\"\n        }\n      ],\n      \"functionaries\": [\n        {\n          \"type\": \"publickey\",\n          \"publickeyid\": \"build-key\"\n        }\n      ]\n    }\n  }\n}\n```\n\n**Witness Run Command:**\n```bash\nwitness run --step build \\\n  --attestations material,git,environment \\\n  --outfile build-attestation.json \\\n  --key signing-key.pem \\\n  -- <your-build-command>\n```\n\n**Rego Validation Rules:**\n```rego\n\n```\n\n**Verification:**\n```bash\nwitness verify \\\n  --policy policy-signed.json \\\n  --publickey policy-key.pub \\\n  -a build-attestation.json \\\n  --subject <artifact>\n```\n"}]}
{"messages": [{"role": "system", "content": "You are an expert in the Witness supply chain attestation framework. You help users instrument CI/CD pipelines with witness, create policy documents, and write Rego policies to validate attestations. You understand all attestors in go-witness and how to use them effectively."}, {"role": "user", "content": "How do I create a witness policy for a build step that uses these attestors: git, github, material, product?"}, {"role": "assistant", "content": "Here's a complete witness policy for your build step with git, github, material, product attestors:\n\n**Policy Document:**\n```json\n{\n  \"expires\": \"2026-11-08T10:52:59Z\",\n  \"publickeys\": {\n    \"build-key\": {\n      \"keyid\": \"sha256:4df1cbcb37f396cf2b6070482f40aa8f017e34b27e0df17747483f025fc78bdf\",\n      \"key\": \"-----BEGIN PUBLIC KEY-----\\n...\\n-----END PUBLIC KEY-----\"\n    }\n  },\n  \"steps\": {\n    \"build\": {\n      \"name\": \"build\",\n      \"attestations\": [\n        {\n          \"type\": \"https://witness.dev/attestations/git/v0.1\"\n        },\n        {\n          \"type\": \"https://witness.dev/attestations/github/v0.1\"\n        },\n        {\n          \"type\": \"https://witness.dev/attestations/material/v0.1\"\n        },\n        {\n          \"type\": \"https://witness.dev/attestations/product/v0.1\"\n        }\n      ],\n      \"functionaries\": [\n        {\n          \"type\": \"publickey\",\n          \"publickeyid\": \"build-key\"\n        }\n      ]\n    }\n  }\n}\n```\n\n**Witness Run Command:**\n```bash\nwitness run --step build \\\n  --attestations git,github,material,product \\\n  --outfile build-attestation.json \\\n  --key signing-key.pem \\\n  -- <your-build-command>\n```\n\n**Rego Validation Rules:**\n```rego\npackage git\n\nimport rego.v1\n\n# Enforce builds from specific branch\ndeny contains msg if {\n    input.branch != \"staging\"\n    msg := sprintf(\"Must build from staging branch, got: %s\", [input.branch])\n}\n\n# Require clean working directory\ndeny contains msg if {\n    count(input.status) > 0\n    msg := \"Working directory must be clean (no uncommitted changes)\"\n}\n\n# Validate commit author\napproved_authors := {\n    \"alice.smith@example.com\",\n    \"bob.jones@company.com\",\n    \"ci-bot@company.com\"\n}\n\ndeny contains msg if {\n    not input.authoremail in approved_authors\n    msg := sprintf(\"Unauthorized commit author: %s\", [input.authoremail])\n}\n```\n\n**Verification:**\n```bash\nwitness verify \\\n  --policy policy-signed.json \\\n  --publickey policy-key.pub \\\n  -a build-attestation.json \\\n  --subject <artifact>\n```\n"}]}
{"messages": [{"role": "system", "content": "You are an expert in the Witness supply chain attestation framework. You help users instrument CI/CD pipelines with witness, create policy documents, and write Rego policies to validate attestations. You understand all attestors in go-witness and how to use them effectively."}, {"role": "user", "content": "How do I create a witness policy for a build step that uses these attestors: github?"}, {"role": "assistant", "content": "Here's a complete witness policy for your build step with github attestors:\n\n**Policy Document:**\n```json\n{\n  \"expires\": \"2026-11-08T10:52:59Z\",\n  \"publickeys\": {\n    \"build-key\": {\n      \"keyid\": \"sha256:90e569f6fdf2f66863ef5a1a1305e462d5e3912f382ddc8bb61d6046d59f138f\",\n      \"key\": \"-----BEGIN PUBLIC KEY-----\\n...\\n-----END PUBLIC KEY-----\"\n    }\n  },\n  \"steps\": {\n    \"build\": {\n      \"name\": \"build\",\n      \"attestations\": [\n        {\n          \"type\": \"https://witness.dev/attestations/github/v0.1\"\n        }\n      ],\n      \"functionaries\": [\n        {\n          \"type\": \"publickey\",\n          \"publickeyid\": \"build-key\"\n        }\n      ]\n    }\n  }\n}\n```\n\n**Witness Run Command:**\n```bash\nwitness run --step build \\\n  --attestations github \\\n  --outfile build-attestation.json \\\n  --key signing-key.pem \\\n  -- <your-build-command>\n```\n\n**Rego Validation Rules:**\n```rego\n\n```\n\n**Verification:**\n```bash\nwitness verify \\\n  --policy policy-signed.json \\\n  --publickey policy-key.pub \\\n  -a build-attestation.json \\\n  --subject <artifact>\n```\n"}]}
{"messages": [{"role": "system", "content": "You are an expert in the Witness supply chain attestation framework. You help users instrument CI/CD pipelines with witness, create policy documents, and write Rego policies to validate attestations. You understand all attestors in go-witness and how to use them effectively."}, {"role": "user", "content": "How do I create a multi-step witness policy for a build \u2192 test \u2192 package pipeline?"}, {"role": "assistant", "content": "Here's a complete multi-step witness policy for your pipeline:\n\n**Policy Document:**\n```json\n{\n  \"expires\": \"2026-11-08T10:52:59Z\",\n  \"publickeys\": {\n    \"ci-key\": {\n      \"keyid\": \"sha256:5825e64d32d6f69f795409a347728220ae1b7c0f2aaf9f9aaa1a7e6031a759d3\",\n      \"key\": \"-----BEGIN PUBLIC KEY-----\\n...\\n-----END PUBLIC KEY-----\"\n    }\n  },\n  \"steps\": {\n    \"build\": {\n      \"name\": \"build\",\n      \"attestations\": [\n        {\n          \"type\": \"https://witness.dev/attestations/git/v0.1\"\n        },\n        {\n          \"type\": \"https://witness.dev/attestations/command-run/v0.1\"\n        },\n        {\n          \"type\": \"https://witness.dev/attestations/product/v0.1\"\n        }\n      ],\n      \"functionaries\": [\n        {\n          \"type\": \"publickey\",\n          \"publickeyid\": \"ci-key\"\n        }\n      ]\n    },\n    \"test\": {\n      \"name\": \"test\",\n      \"attestations\": [\n        {\n          \"type\": \"https://witness.dev/attestations/material/v0.1\"\n        },\n        {\n          \"type\": \"https://witness.dev/attestations/command-run/v0.1\"\n        }\n      ],\n      \"functionaries\": [\n        {\n          \"type\": \"publickey\",\n          \"publickeyid\": \"ci-key\"\n        }\n      ]\n    },\n    \"package\": {\n      \"name\": \"package\",\n      \"attestations\": [\n        {\n          \"type\": \"https://witness.dev/attestations/material/v0.1\"\n        },\n        {\n          \"type\": \"https://witness.dev/attestations/product/v0.1\"\n        }\n      ],\n      \"functionaries\": [\n        {\n          \"type\": \"publickey\",\n          \"publickeyid\": \"ci-key\"\n        }\n      ]\n    }\n  }\n}\n```\n\n**Pipeline Commands:**\n\n```bash\n# Step 1: Build\nwitness run --step build \\\n  --attestations git,commandrun,product \\\n  -o build.json --key ci-key.pem \\\n  -- go build -o myapp\n\n# Step 2: Test\nwitness run --step test \\\n  --attestations material,commandrun \\\n  -o test.json --key ci-key.pem \\\n  -- go test ./...\n\n# Step 3: Package\nwitness run --step package \\\n  --attestations material,product \\\n  -o package.json --key ci-key.pem \\\n  -- tar czf myapp.tar.gz myapp\n\n# Verify entire pipeline\nwitness verify \\\n  --policy policy-signed.json \\\n  --publickey policy-key.pub \\\n  -a build.json -a test.json -a package.json\n```\n"}]}
{"messages": [{"role": "system", "content": "You are an expert in the Witness supply chain attestation framework. You help users instrument CI/CD pipelines with witness, create policy documents, and write Rego policies to validate attestations. You understand all attestors in go-witness and how to use them effectively."}, {"role": "user", "content": "How do I create a multi-step witness policy for a build \u2192 test \u2192 package pipeline?"}, {"role": "assistant", "content": "Here's a complete multi-step witness policy for your pipeline:\n\n**Policy Document:**\n```json\n{\n  \"expires\": \"2026-11-08T10:52:59Z\",\n  \"publickeys\": {\n    \"ci-key\": {\n      \"keyid\": \"sha256:87bdff51d06318623dbea87ffd082b8815c01aa578496c4a9959fa70e5d8319f\",\n      \"key\": \"-----BEGIN PUBLIC KEY-----\\n...\\n-----END PUBLIC KEY-----\"\n    }\n  },\n  \"steps\": {\n    \"build\": {\n      \"name\": \"build\",\n      \"attestations\": [\n        {\n          \"type\": \"https://witness.dev/attestations/git/v0.1\"\n        },\n        {\n          \"type\": \"https://witness.dev/attestations/command-run/v0.1\"\n        },\n        {\n          \"type\": \"https://witness.dev/attestations/product/v0.1\"\n        }\n      ],\n      \"functionaries\": [\n        {\n          \"type\": \"publickey\",\n          \"publickeyid\": \"ci-key\"\n        }\n      ]\n    },\n    \"test\": {\n      \"name\": \"test\",\n      \"attestations\": [\n        {\n          \"type\": \"https://witness.dev/attestations/material/v0.1\"\n        },\n        {\n          \"type\": \"https://witness.dev/attestations/command-run/v0.1\"\n        }\n      ],\n      \"functionaries\": [\n        {\n          \"type\": \"publickey\",\n          \"publickeyid\": \"ci-key\"\n        }\n      ]\n    },\n    \"package\": {\n      \"name\": \"package\",\n      \"attestations\": [\n        {\n          \"type\": \"https://witness.dev/attestations/material/v0.1\"\n        },\n        {\n          \"type\": \"https://witness.dev/attestations/product/v0.1\"\n        }\n      ],\n      \"functionaries\": [\n        {\n          \"type\": \"publickey\",\n          \"publickeyid\": \"ci-key\"\n        }\n      ]\n    }\n  }\n}\n```\n\n**Pipeline Commands:**\n\n```bash\n# Step 1: Build\nwitness run --step build \\\n  --attestations git,commandrun,product \\\n  -o build.json --key ci-key.pem \\\n  -- go build -o myapp\n\n# Step 2: Test\nwitness run --step test \\\n  --attestations material,commandrun \\\n  -o test.json --key ci-key.pem \\\n  -- go test ./...\n\n# Step 3: Package\nwitness run --step package \\\n  --attestations material,product \\\n  -o package.json --key ci-key.pem \\\n  -- tar czf myapp.tar.gz myapp\n\n# Verify entire pipeline\nwitness verify \\\n  --policy policy-signed.json \\\n  --publickey policy-key.pub \\\n  -a build.json -a test.json -a package.json\n```\n"}]}
{"messages": [{"role": "system", "content": "You are an expert in the Witness supply chain attestation framework. You help users instrument CI/CD pipelines with witness, create policy documents, and write Rego policies to validate attestations. You understand all attestors in go-witness and how to use them effectively."}, {"role": "user", "content": "How do I create a witness policy for a build step that uses these attestors: product, environment, github, git?"}, {"role": "assistant", "content": "Here's a complete witness policy for your build step with product, environment, github, git attestors:\n\n**Policy Document:**\n```json\n{\n  \"expires\": \"2026-11-08T10:52:59Z\",\n  \"publickeys\": {\n    \"build-key\": {\n      \"keyid\": \"sha256:0eb7dfc550a0163e6f02e53dd7c8b63d8583fcf028a75fb6f3da0f400204de07\",\n      \"key\": \"-----BEGIN PUBLIC KEY-----\\n...\\n-----END PUBLIC KEY-----\"\n    }\n  },\n  \"steps\": {\n    \"build\": {\n      \"name\": \"build\",\n      \"attestations\": [\n        {\n          \"type\": \"https://witness.dev/attestations/product/v0.1\"\n        },\n        {\n          \"type\": \"https://witness.dev/attestations/environment/v0.1\"\n        },\n        {\n          \"type\": \"https://witness.dev/attestations/github/v0.1\"\n        },\n        {\n          \"type\": \"https://witness.dev/attestations/git/v0.1\"\n        }\n      ],\n      \"functionaries\": [\n        {\n          \"type\": \"publickey\",\n          \"publickeyid\": \"build-key\"\n        }\n      ]\n    }\n  }\n}\n```\n\n**Witness Run Command:**\n```bash\nwitness run --step build \\\n  --attestations product,environment,github,git \\\n  --outfile build-attestation.json \\\n  --key signing-key.pem \\\n  -- <your-build-command>\n```\n\n**Rego Validation Rules:**\n```rego\n\n```\n\n**Verification:**\n```bash\nwitness verify \\\n  --policy policy-signed.json \\\n  --publickey policy-key.pub \\\n  -a build-attestation.json \\\n  --subject <artifact>\n```\n"}]}
{"messages": [{"role": "system", "content": "You are an expert in the Witness supply chain attestation framework. You help users instrument CI/CD pipelines with witness, create policy documents, and write Rego policies to validate attestations. You understand all attestors in go-witness and how to use them effectively."}, {"role": "user", "content": "How do I create a witness policy for a build step that uses these attestors: product?"}, {"role": "assistant", "content": "Here's a complete witness policy for your build step with product attestors:\n\n**Policy Document:**\n```json\n{\n  \"expires\": \"2026-11-08T10:52:59Z\",\n  \"publickeys\": {\n    \"build-key\": {\n      \"keyid\": \"sha256:aa03162d792428ae28e6f4d70e197a63711d889a07171763aa1de36b04c27f9e\",\n      \"key\": \"-----BEGIN PUBLIC KEY-----\\n...\\n-----END PUBLIC KEY-----\"\n    }\n  },\n  \"steps\": {\n    \"build\": {\n      \"name\": \"build\",\n      \"attestations\": [\n        {\n          \"type\": \"https://witness.dev/attestations/product/v0.1\"\n        }\n      ],\n      \"functionaries\": [\n        {\n          \"type\": \"publickey\",\n          \"publickeyid\": \"build-key\"\n        }\n      ]\n    }\n  }\n}\n```\n\n**Witness Run Command:**\n```bash\nwitness run --step build \\\n  --attestations product \\\n  --outfile build-attestation.json \\\n  --key signing-key.pem \\\n  -- <your-build-command>\n```\n\n**Rego Validation Rules:**\n```rego\n\n```\n\n**Verification:**\n```bash\nwitness verify \\\n  --policy policy-signed.json \\\n  --publickey policy-key.pub \\\n  -a build-attestation.json \\\n  --subject <artifact>\n```\n"}]}
{"messages": [{"role": "system", "content": "You are an expert in the Witness supply chain attestation framework. You help users instrument CI/CD pipelines with witness, create policy documents, and write Rego policies to validate attestations. You understand all attestors in go-witness and how to use them effectively."}, {"role": "user", "content": "How do I create a multi-step witness policy for a build \u2192 test \u2192 package pipeline?"}, {"role": "assistant", "content": "Here's a complete multi-step witness policy for your pipeline:\n\n**Policy Document:**\n```json\n{\n  \"expires\": \"2026-11-08T10:52:59Z\",\n  \"publickeys\": {\n    \"ci-key\": {\n      \"keyid\": \"sha256:0f0750fadc3b7bbe3a30f4431d869884ce592d9164353e93e9e5cd4b7c2520f1\",\n      \"key\": \"-----BEGIN PUBLIC KEY-----\\n...\\n-----END PUBLIC KEY-----\"\n    }\n  },\n  \"steps\": {\n    \"build\": {\n      \"name\": \"build\",\n      \"attestations\": [\n        {\n          \"type\": \"https://witness.dev/attestations/git/v0.1\"\n        },\n        {\n          \"type\": \"https://witness.dev/attestations/command-run/v0.1\"\n        },\n        {\n          \"type\": \"https://witness.dev/attestations/product/v0.1\"\n        }\n      ],\n      \"functionaries\": [\n        {\n          \"type\": \"publickey\",\n          \"publickeyid\": \"ci-key\"\n        }\n      ]\n    },\n    \"test\": {\n      \"name\": \"test\",\n      \"attestations\": [\n        {\n          \"type\": \"https://witness.dev/attestations/material/v0.1\"\n        },\n        {\n          \"type\": \"https://witness.dev/attestations/command-run/v0.1\"\n        }\n      ],\n      \"functionaries\": [\n        {\n          \"type\": \"publickey\",\n          \"publickeyid\": \"ci-key\"\n        }\n      ]\n    },\n    \"package\": {\n      \"name\": \"package\",\n      \"attestations\": [\n        {\n          \"type\": \"https://witness.dev/attestations/material/v0.1\"\n        },\n        {\n          \"type\": \"https://witness.dev/attestations/product/v0.1\"\n        }\n      ],\n      \"functionaries\": [\n        {\n          \"type\": \"publickey\",\n          \"publickeyid\": \"ci-key\"\n        }\n      ]\n    }\n  }\n}\n```\n\n**Pipeline Commands:**\n\n```bash\n# Step 1: Build\nwitness run --step build \\\n  --attestations git,commandrun,product \\\n  -o build.json --key ci-key.pem \\\n  -- go build -o myapp\n\n# Step 2: Test\nwitness run --step test \\\n  --attestations material,commandrun \\\n  -o test.json --key ci-key.pem \\\n  -- go test ./...\n\n# Step 3: Package\nwitness run --step package \\\n  --attestations material,product \\\n  -o package.json --key ci-key.pem \\\n  -- tar czf myapp.tar.gz myapp\n\n# Verify entire pipeline\nwitness verify \\\n  --policy policy-signed.json \\\n  --publickey policy-key.pub \\\n  -a build.json -a test.json -a package.json\n```\n"}]}
{"messages": [{"role": "system", "content": "You are an expert in the Witness supply chain attestation framework. You help users instrument CI/CD pipelines with witness, create policy documents, and write Rego policies to validate attestations. You understand all attestors in go-witness and how to use them effectively."}, {"role": "user", "content": "How do I create a witness policy for a build step that uses these attestors: commandrun, material, product?"}, {"role": "assistant", "content": "Here's a complete witness policy for your build step with commandrun, material, product attestors:\n\n**Policy Document:**\n```json\n{\n  \"expires\": \"2026-11-08T10:52:59Z\",\n  \"publickeys\": {\n    \"build-key\": {\n      \"keyid\": \"sha256:82ff3d42cd265caa480f6123ce8f2c85ab6af08f82c57799d4e86f94f0b9fa03\",\n      \"key\": \"-----BEGIN PUBLIC KEY-----\\n...\\n-----END PUBLIC KEY-----\"\n    }\n  },\n  \"steps\": {\n    \"build\": {\n      \"name\": \"build\",\n      \"attestations\": [\n        {\n          \"type\": \"https://witness.dev/attestations/command-run/v0.1\"\n        },\n        {\n          \"type\": \"https://witness.dev/attestations/material/v0.1\"\n        },\n        {\n          \"type\": \"https://witness.dev/attestations/product/v0.1\"\n        }\n      ],\n      \"functionaries\": [\n        {\n          \"type\": \"publickey\",\n          \"publickeyid\": \"build-key\"\n        }\n      ]\n    }\n  }\n}\n```\n\n**Witness Run Command:**\n```bash\nwitness run --step build \\\n  --attestations commandrun,material,product \\\n  --outfile build-attestation.json \\\n  --key signing-key.pem \\\n  -- <your-build-command>\n```\n\n**Rego Validation Rules:**\n```rego\n\n```\n\n**Verification:**\n```bash\nwitness verify \\\n  --policy policy-signed.json \\\n  --publickey policy-key.pub \\\n  -a build-attestation.json \\\n  --subject <artifact>\n```\n"}]}
{"messages": [{"role": "system", "content": "You are an expert in the Witness supply chain attestation framework. You help users instrument CI/CD pipelines with witness, create policy documents, and write Rego policies to validate attestations. You understand all attestors in go-witness and how to use them effectively."}, {"role": "user", "content": "How do I create a witness policy for a build step that uses these attestors: environment, material, github, commandrun, git?"}, {"role": "assistant", "content": "Here's a complete witness policy for your build step with environment, material, github, commandrun, git attestors:\n\n**Policy Document:**\n```json\n{\n  \"expires\": \"2026-11-08T10:52:59Z\",\n  \"publickeys\": {\n    \"build-key\": {\n      \"keyid\": \"sha256:5ec908153e5557dbfa227f4a7a9a4d0994508077580180b35f0527d57827e678\",\n      \"key\": \"-----BEGIN PUBLIC KEY-----\\n...\\n-----END PUBLIC KEY-----\"\n    }\n  },\n  \"steps\": {\n    \"build\": {\n      \"name\": \"build\",\n      \"attestations\": [\n        {\n          \"type\": \"https://witness.dev/attestations/environment/v0.1\"\n        },\n        {\n          \"type\": \"https://witness.dev/attestations/material/v0.1\"\n        },\n        {\n          \"type\": \"https://witness.dev/attestations/github/v0.1\"\n        },\n        {\n          \"type\": \"https://witness.dev/attestations/command-run/v0.1\"\n        },\n        {\n          \"type\": \"https://witness.dev/attestations/git/v0.1\"\n        }\n      ],\n      \"functionaries\": [\n        {\n          \"type\": \"publickey\",\n          \"publickeyid\": \"build-key\"\n        }\n      ]\n    }\n  }\n}\n```\n\n**Witness Run Command:**\n```bash\nwitness run --step build \\\n  --attestations environment,material,github,commandrun,git \\\n  --outfile build-attestation.json \\\n  --key signing-key.pem \\\n  -- <your-build-command>\n```\n\n**Rego Validation Rules:**\n```rego\npackage environment\n\nimport rego.v1\n\n# Ensure correct OS\ndeny contains msg if {\n    input.os != \"linux\"\n    msg := sprintf(\"Must run on linux, got: %s\", [input.os])\n}\n\n# Require CI environment\ndeny contains msg if {\n    not \"CI\" in input.variables\n    msg := \"Must run in CI environment (CI variable not set)\"\n}\n```\n\n**Verification:**\n```bash\nwitness verify \\\n  --policy policy-signed.json \\\n  --publickey policy-key.pub \\\n  -a build-attestation.json \\\n  --subject <artifact>\n```\n"}]}
{"messages": [{"role": "system", "content": "You are an expert in the Witness supply chain attestation framework. You help users instrument CI/CD pipelines with witness, create policy documents, and write Rego policies to validate attestations. You understand all attestors in go-witness and how to use them effectively."}, {"role": "user", "content": "How do I create a witness policy for a build step that uses these attestors: environment?"}, {"role": "assistant", "content": "Here's a complete witness policy for your build step with environment attestors:\n\n**Policy Document:**\n```json\n{\n  \"expires\": \"2026-11-08T10:52:59Z\",\n  \"publickeys\": {\n    \"build-key\": {\n      \"keyid\": \"sha256:2fec057a90c6566ddf6d0b7b0ae81c403b307e8db4ef79ce2808b65482206cdb\",\n      \"key\": \"-----BEGIN PUBLIC KEY-----\\n...\\n-----END PUBLIC KEY-----\"\n    }\n  },\n  \"steps\": {\n    \"build\": {\n      \"name\": \"build\",\n      \"attestations\": [\n        {\n          \"type\": \"https://witness.dev/attestations/environment/v0.1\"\n        }\n      ],\n      \"functionaries\": [\n        {\n          \"type\": \"publickey\",\n          \"publickeyid\": \"build-key\"\n        }\n      ]\n    }\n  }\n}\n```\n\n**Witness Run Command:**\n```bash\nwitness run --step build \\\n  --attestations environment \\\n  --outfile build-attestation.json \\\n  --key signing-key.pem \\\n  -- <your-build-command>\n```\n\n**Rego Validation Rules:**\n```rego\npackage environment\n\nimport rego.v1\n\n# Ensure correct OS\ndeny contains msg if {\n    input.os != \"windows\"\n    msg := sprintf(\"Must run on windows, got: %s\", [input.os])\n}\n\n# Require CI environment\ndeny contains msg if {\n    not \"CI\" in input.variables\n    msg := \"Must run in CI environment (CI variable not set)\"\n}\n```\n\n**Verification:**\n```bash\nwitness verify \\\n  --policy policy-signed.json \\\n  --publickey policy-key.pub \\\n  -a build-attestation.json \\\n  --subject <artifact>\n```\n"}]}
{"messages": [{"role": "system", "content": "You are an expert in the Witness supply chain attestation framework. You help users instrument CI/CD pipelines with witness, create policy documents, and write Rego policies to validate attestations. You understand all attestors in go-witness and how to use them effectively."}, {"role": "user", "content": "How do I create a multi-step witness policy for a build \u2192 test \u2192 package pipeline?"}, {"role": "assistant", "content": "Here's a complete multi-step witness policy for your pipeline:\n\n**Policy Document:**\n```json\n{\n  \"expires\": \"2026-11-08T10:52:59Z\",\n  \"publickeys\": {\n    \"ci-key\": {\n      \"keyid\": \"sha256:808ab68c14ffc0a66fd65c175b558baa267fbb237957896327f3c018b9ef2b67\",\n      \"key\": \"-----BEGIN PUBLIC KEY-----\\n...\\n-----END PUBLIC KEY-----\"\n    }\n  },\n  \"steps\": {\n    \"build\": {\n      \"name\": \"build\",\n      \"attestations\": [\n        {\n          \"type\": \"https://witness.dev/attestations/git/v0.1\"\n        },\n        {\n          \"type\": \"https://witness.dev/attestations/command-run/v0.1\"\n        },\n        {\n          \"type\": \"https://witness.dev/attestations/product/v0.1\"\n        }\n      ],\n      \"functionaries\": [\n        {\n          \"type\": \"publickey\",\n          \"publickeyid\": \"ci-key\"\n        }\n      ]\n    },\n    \"test\": {\n      \"name\": \"test\",\n      \"attestations\": [\n        {\n          \"type\": \"https://witness.dev/attestations/material/v0.1\"\n        },\n        {\n          \"type\": \"https://witness.dev/attestations/command-run/v0.1\"\n        }\n      ],\n      \"functionaries\": [\n        {\n          \"type\": \"publickey\",\n          \"publickeyid\": \"ci-key\"\n        }\n      ]\n    },\n    \"package\": {\n      \"name\": \"package\",\n      \"attestations\": [\n        {\n          \"type\": \"https://witness.dev/attestations/material/v0.1\"\n        },\n        {\n          \"type\": \"https://witness.dev/attestations/product/v0.1\"\n        }\n      ],\n      \"functionaries\": [\n        {\n          \"type\": \"publickey\",\n          \"publickeyid\": \"ci-key\"\n        }\n      ]\n    }\n  }\n}\n```\n\n**Pipeline Commands:**\n\n```bash\n# Step 1: Build\nwitness run --step build \\\n  --attestations git,commandrun,product \\\n  -o build.json --key ci-key.pem \\\n  -- go build -o myapp\n\n# Step 2: Test\nwitness run --step test \\\n  --attestations material,commandrun \\\n  -o test.json --key ci-key.pem \\\n  -- go test ./...\n\n# Step 3: Package\nwitness run --step package \\\n  --attestations material,product \\\n  -o package.json --key ci-key.pem \\\n  -- tar czf myapp.tar.gz myapp\n\n# Verify entire pipeline\nwitness verify \\\n  --policy policy-signed.json \\\n  --publickey policy-key.pub \\\n  -a build.json -a test.json -a package.json\n```\n"}]}
{"messages": [{"role": "system", "content": "You are an expert in the Witness supply chain attestation framework. You help users instrument CI/CD pipelines with witness, create policy documents, and write Rego policies to validate attestations. You understand all attestors in go-witness and how to use them effectively."}, {"role": "user", "content": "How do I create a witness policy for a build step that uses these attestors: product?"}, {"role": "assistant", "content": "Here's a complete witness policy for your build step with product attestors:\n\n**Policy Document:**\n```json\n{\n  \"expires\": \"2026-11-08T10:52:59Z\",\n  \"publickeys\": {\n    \"build-key\": {\n      \"keyid\": \"sha256:389de4884233cdfa91f1c123967ba88f9913a368b975912e72e8e6be26cbf90b\",\n      \"key\": \"-----BEGIN PUBLIC KEY-----\\n...\\n-----END PUBLIC KEY-----\"\n    }\n  },\n  \"steps\": {\n    \"build\": {\n      \"name\": \"build\",\n      \"attestations\": [\n        {\n          \"type\": \"https://witness.dev/attestations/product/v0.1\"\n        }\n      ],\n      \"functionaries\": [\n        {\n          \"type\": \"publickey\",\n          \"publickeyid\": \"build-key\"\n        }\n      ]\n    }\n  }\n}\n```\n\n**Witness Run Command:**\n```bash\nwitness run --step build \\\n  --attestations product \\\n  --outfile build-attestation.json \\\n  --key signing-key.pem \\\n  -- <your-build-command>\n```\n\n**Rego Validation Rules:**\n```rego\n\n```\n\n**Verification:**\n```bash\nwitness verify \\\n  --policy policy-signed.json \\\n  --publickey policy-key.pub \\\n  -a build-attestation.json \\\n  --subject <artifact>\n```\n"}]}
{"messages": [{"role": "system", "content": "You are an expert in the Witness supply chain attestation framework. You help users instrument CI/CD pipelines with witness, create policy documents, and write Rego policies to validate attestations. You understand all attestors in go-witness and how to use them effectively."}, {"role": "user", "content": "How do I create a witness policy for a build step that uses these attestors: product, commandrun, git, github?"}, {"role": "assistant", "content": "Here's a complete witness policy for your build step with product, commandrun, git, github attestors:\n\n**Policy Document:**\n```json\n{\n  \"expires\": \"2026-11-08T10:52:59Z\",\n  \"publickeys\": {\n    \"build-key\": {\n      \"keyid\": \"sha256:66b5fa41411295b079fa1a559ff3fd51f254968a0862402fb61752afabe86657\",\n      \"key\": \"-----BEGIN PUBLIC KEY-----\\n...\\n-----END PUBLIC KEY-----\"\n    }\n  },\n  \"steps\": {\n    \"build\": {\n      \"name\": \"build\",\n      \"attestations\": [\n        {\n          \"type\": \"https://witness.dev/attestations/product/v0.1\"\n        },\n        {\n          \"type\": \"https://witness.dev/attestations/command-run/v0.1\"\n        },\n        {\n          \"type\": \"https://witness.dev/attestations/git/v0.1\"\n        },\n        {\n          \"type\": \"https://witness.dev/attestations/github/v0.1\"\n        }\n      ],\n      \"functionaries\": [\n        {\n          \"type\": \"publickey\",\n          \"publickeyid\": \"build-key\"\n        }\n      ]\n    }\n  }\n}\n```\n\n**Witness Run Command:**\n```bash\nwitness run --step build \\\n  --attestations product,commandrun,git,github \\\n  --outfile build-attestation.json \\\n  --key signing-key.pem \\\n  -- <your-build-command>\n```\n\n**Rego Validation Rules:**\n```rego\n\n```\n\n**Verification:**\n```bash\nwitness verify \\\n  --policy policy-signed.json \\\n  --publickey policy-key.pub \\\n  -a build-attestation.json \\\n  --subject <artifact>\n```\n"}]}
{"messages": [{"role": "system", "content": "You are an expert in the Witness supply chain attestation framework. You help users instrument CI/CD pipelines with witness, create policy documents, and write Rego policies to validate attestations. You understand all attestors in go-witness and how to use them effectively."}, {"role": "user", "content": "How do I create a witness policy for a build step that uses these attestors: git, environment, material, product, commandrun?"}, {"role": "assistant", "content": "Here's a complete witness policy for your build step with git, environment, material, product, commandrun attestors:\n\n**Policy Document:**\n```json\n{\n  \"expires\": \"2026-11-08T10:52:59Z\",\n  \"publickeys\": {\n    \"build-key\": {\n      \"keyid\": \"sha256:3554fa561262fbd432ed15676f82482bc238b00011cc1c4a335fa68d29237450\",\n      \"key\": \"-----BEGIN PUBLIC KEY-----\\n...\\n-----END PUBLIC KEY-----\"\n    }\n  },\n  \"steps\": {\n    \"build\": {\n      \"name\": \"build\",\n      \"attestations\": [\n        {\n          \"type\": \"https://witness.dev/attestations/git/v0.1\"\n        },\n        {\n          \"type\": \"https://witness.dev/attestations/environment/v0.1\"\n        },\n        {\n          \"type\": \"https://witness.dev/attestations/material/v0.1\"\n        },\n        {\n          \"type\": \"https://witness.dev/attestations/product/v0.1\"\n        },\n        {\n          \"type\": \"https://witness.dev/attestations/command-run/v0.1\"\n        }\n      ],\n      \"functionaries\": [\n        {\n          \"type\": \"publickey\",\n          \"publickeyid\": \"build-key\"\n        }\n      ]\n    }\n  }\n}\n```\n\n**Witness Run Command:**\n```bash\nwitness run --step build \\\n  --attestations git,environment,material,product,commandrun \\\n  --outfile build-attestation.json \\\n  --key signing-key.pem \\\n  -- <your-build-command>\n```\n\n**Rego Validation Rules:**\n```rego\npackage git\n\nimport rego.v1\n\n# Enforce builds from specific branch\ndeny contains msg if {\n    input.branch != \"staging\"\n    msg := sprintf(\"Must build from staging branch, got: %s\", [input.branch])\n}\n\n# Validate commit author\napproved_authors := {\n    \"alice.smith@example.com\",\n    \"bob.jones@company.com\",\n    \"ci-bot@company.com\"\n}\n\ndeny contains msg if {\n    not input.authoremail in approved_authors\n    msg := sprintf(\"Unauthorized commit author: %s\", [input.authoremail])\n}\n```\n\n**Verification:**\n```bash\nwitness verify \\\n  --policy policy-signed.json \\\n  --publickey policy-key.pub \\\n  -a build-attestation.json \\\n  --subject <artifact>\n```\n"}]}
{"messages": [{"role": "system", "content": "You are an expert in the Witness supply chain attestation framework. You help users instrument CI/CD pipelines with witness, create policy documents, and write Rego policies to validate attestations. You understand all attestors in go-witness and how to use them effectively."}, {"role": "user", "content": "How do I create a witness policy for a build step that uses these attestors: commandrun, github?"}, {"role": "assistant", "content": "Here's a complete witness policy for your build step with commandrun, github attestors:\n\n**Policy Document:**\n```json\n{\n  \"expires\": \"2026-11-08T10:52:59Z\",\n  \"publickeys\": {\n    \"build-key\": {\n      \"keyid\": \"sha256:4bd4179ee14036545d01709a60a71a4a594508c3cb023596201aeeffd55fd124\",\n      \"key\": \"-----BEGIN PUBLIC KEY-----\\n...\\n-----END PUBLIC KEY-----\"\n    }\n  },\n  \"steps\": {\n    \"build\": {\n      \"name\": \"build\",\n      \"attestations\": [\n        {\n          \"type\": \"https://witness.dev/attestations/command-run/v0.1\"\n        },\n        {\n          \"type\": \"https://witness.dev/attestations/github/v0.1\"\n        }\n      ],\n      \"functionaries\": [\n        {\n          \"type\": \"publickey\",\n          \"publickeyid\": \"build-key\"\n        }\n      ]\n    }\n  }\n}\n```\n\n**Witness Run Command:**\n```bash\nwitness run --step build \\\n  --attestations commandrun,github \\\n  --outfile build-attestation.json \\\n  --key signing-key.pem \\\n  -- <your-build-command>\n```\n\n**Rego Validation Rules:**\n```rego\n\n```\n\n**Verification:**\n```bash\nwitness verify \\\n  --policy policy-signed.json \\\n  --publickey policy-key.pub \\\n  -a build-attestation.json \\\n  --subject <artifact>\n```\n"}]}
{"messages": [{"role": "system", "content": "You are an expert in the Witness supply chain attestation framework. You help users instrument CI/CD pipelines with witness, create policy documents, and write Rego policies to validate attestations. You understand all attestors in go-witness and how to use them effectively."}, {"role": "user", "content": "How do I create a witness policy for a build step that uses these attestors: environment, product, github?"}, {"role": "assistant", "content": "Here's a complete witness policy for your build step with environment, product, github attestors:\n\n**Policy Document:**\n```json\n{\n  \"expires\": \"2026-11-08T10:52:59Z\",\n  \"publickeys\": {\n    \"build-key\": {\n      \"keyid\": \"sha256:6f8e8b897566d5e40c71a759cded836b06ab2c790603bfa3da0d961bc60af807\",\n      \"key\": \"-----BEGIN PUBLIC KEY-----\\n...\\n-----END PUBLIC KEY-----\"\n    }\n  },\n  \"steps\": {\n    \"build\": {\n      \"name\": \"build\",\n      \"attestations\": [\n        {\n          \"type\": \"https://witness.dev/attestations/environment/v0.1\"\n        },\n        {\n          \"type\": \"https://witness.dev/attestations/product/v0.1\"\n        },\n        {\n          \"type\": \"https://witness.dev/attestations/github/v0.1\"\n        }\n      ],\n      \"functionaries\": [\n        {\n          \"type\": \"publickey\",\n          \"publickeyid\": \"build-key\"\n        }\n      ]\n    }\n  }\n}\n```\n\n**Witness Run Command:**\n```bash\nwitness run --step build \\\n  --attestations environment,product,github \\\n  --outfile build-attestation.json \\\n  --key signing-key.pem \\\n  -- <your-build-command>\n```\n\n**Rego Validation Rules:**\n```rego\npackage environment\n\nimport rego.v1\n\n# Ensure correct OS\ndeny contains msg if {\n    input.os != \"linux\"\n    msg := sprintf(\"Must run on linux, got: %s\", [input.os])\n}\n\n# Require CI environment\ndeny contains msg if {\n    not \"CI\" in input.variables\n    msg := \"Must run in CI environment (CI variable not set)\"\n}\n```\n\n**Verification:**\n```bash\nwitness verify \\\n  --policy policy-signed.json \\\n  --publickey policy-key.pub \\\n  -a build-attestation.json \\\n  --subject <artifact>\n```\n"}]}
{"messages": [{"role": "system", "content": "You are an expert in the Witness supply chain attestation framework. You help users instrument CI/CD pipelines with witness, create policy documents, and write Rego policies to validate attestations. You understand all attestors in go-witness and how to use them effectively."}, {"role": "user", "content": "How do I create a witness policy for a build step that uses these attestors: product?"}, {"role": "assistant", "content": "Here's a complete witness policy for your build step with product attestors:\n\n**Policy Document:**\n```json\n{\n  \"expires\": \"2026-11-08T10:52:59Z\",\n  \"publickeys\": {\n    \"build-key\": {\n      \"keyid\": \"sha256:8333857b7c696a49b5f3031baa55098dd528fd8f607032cddfb30ec363479a87\",\n      \"key\": \"-----BEGIN PUBLIC KEY-----\\n...\\n-----END PUBLIC KEY-----\"\n    }\n  },\n  \"steps\": {\n    \"build\": {\n      \"name\": \"build\",\n      \"attestations\": [\n        {\n          \"type\": \"https://witness.dev/attestations/product/v0.1\"\n        }\n      ],\n      \"functionaries\": [\n        {\n          \"type\": \"publickey\",\n          \"publickeyid\": \"build-key\"\n        }\n      ]\n    }\n  }\n}\n```\n\n**Witness Run Command:**\n```bash\nwitness run --step build \\\n  --attestations product \\\n  --outfile build-attestation.json \\\n  --key signing-key.pem \\\n  -- <your-build-command>\n```\n\n**Rego Validation Rules:**\n```rego\n\n```\n\n**Verification:**\n```bash\nwitness verify \\\n  --policy policy-signed.json \\\n  --publickey policy-key.pub \\\n  -a build-attestation.json \\\n  --subject <artifact>\n```\n"}]}
{"messages": [{"role": "system", "content": "You are an expert in the Witness supply chain attestation framework. You help users instrument CI/CD pipelines with witness, create policy documents, and write Rego policies to validate attestations. You understand all attestors in go-witness and how to use them effectively."}, {"role": "user", "content": "How do I create a witness policy for a build step that uses these attestors: product, commandrun, environment?"}, {"role": "assistant", "content": "Here's a complete witness policy for your build step with product, commandrun, environment attestors:\n\n**Policy Document:**\n```json\n{\n  \"expires\": \"2026-11-08T10:52:59Z\",\n  \"publickeys\": {\n    \"build-key\": {\n      \"keyid\": \"sha256:c0780ec7f73f2972add7a157722017e1f96e6b752671843d5c0ce92d53221fd6\",\n      \"key\": \"-----BEGIN PUBLIC KEY-----\\n...\\n-----END PUBLIC KEY-----\"\n    }\n  },\n  \"steps\": {\n    \"build\": {\n      \"name\": \"build\",\n      \"attestations\": [\n        {\n          \"type\": \"https://witness.dev/attestations/product/v0.1\"\n        },\n        {\n          \"type\": \"https://witness.dev/attestations/command-run/v0.1\"\n        },\n        {\n          \"type\": \"https://witness.dev/attestations/environment/v0.1\"\n        }\n      ],\n      \"functionaries\": [\n        {\n          \"type\": \"publickey\",\n          \"publickeyid\": \"build-key\"\n        }\n      ]\n    }\n  }\n}\n```\n\n**Witness Run Command:**\n```bash\nwitness run --step build \\\n  --attestations product,commandrun,environment \\\n  --outfile build-attestation.json \\\n  --key signing-key.pem \\\n  -- <your-build-command>\n```\n\n**Rego Validation Rules:**\n```rego\n\n```\n\n**Verification:**\n```bash\nwitness verify \\\n  --policy policy-signed.json \\\n  --publickey policy-key.pub \\\n  -a build-attestation.json \\\n  --subject <artifact>\n```\n"}]}
{"messages": [{"role": "system", "content": "You are an expert in the Witness supply chain attestation framework. You help users instrument CI/CD pipelines with witness, create policy documents, and write Rego policies to validate attestations. You understand all attestors in go-witness and how to use them effectively."}, {"role": "user", "content": "How do I create a multi-step witness policy for a build \u2192 test \u2192 package pipeline?"}, {"role": "assistant", "content": "Here's a complete multi-step witness policy for your pipeline:\n\n**Policy Document:**\n```json\n{\n  \"expires\": \"2026-11-08T10:52:59Z\",\n  \"publickeys\": {\n    \"ci-key\": {\n      \"keyid\": \"sha256:dc759f3631c9f98e4ded3ed11d71314ff2b3491780832c22e37143f6ad61f9af\",\n      \"key\": \"-----BEGIN PUBLIC KEY-----\\n...\\n-----END PUBLIC KEY-----\"\n    }\n  },\n  \"steps\": {\n    \"build\": {\n      \"name\": \"build\",\n      \"attestations\": [\n        {\n          \"type\": \"https://witness.dev/attestations/git/v0.1\"\n        },\n        {\n          \"type\": \"https://witness.dev/attestations/command-run/v0.1\"\n        },\n        {\n          \"type\": \"https://witness.dev/attestations/product/v0.1\"\n        }\n      ],\n      \"functionaries\": [\n        {\n          \"type\": \"publickey\",\n          \"publickeyid\": \"ci-key\"\n        }\n      ]\n    },\n    \"test\": {\n      \"name\": \"test\",\n      \"attestations\": [\n        {\n          \"type\": \"https://witness.dev/attestations/material/v0.1\"\n        },\n        {\n          \"type\": \"https://witness.dev/attestations/command-run/v0.1\"\n        }\n      ],\n      \"functionaries\": [\n        {\n          \"type\": \"publickey\",\n          \"publickeyid\": \"ci-key\"\n        }\n      ]\n    },\n    \"package\": {\n      \"name\": \"package\",\n      \"attestations\": [\n        {\n          \"type\": \"https://witness.dev/attestations/material/v0.1\"\n        },\n        {\n          \"type\": \"https://witness.dev/attestations/product/v0.1\"\n        }\n      ],\n      \"functionaries\": [\n        {\n          \"type\": \"publickey\",\n          \"publickeyid\": \"ci-key\"\n        }\n      ]\n    }\n  }\n}\n```\n\n**Pipeline Commands:**\n\n```bash\n# Step 1: Build\nwitness run --step build \\\n  --attestations git,commandrun,product \\\n  -o build.json --key ci-key.pem \\\n  -- go build -o myapp\n\n# Step 2: Test\nwitness run --step test \\\n  --attestations material,commandrun \\\n  -o test.json --key ci-key.pem \\\n  -- go test ./...\n\n# Step 3: Package\nwitness run --step package \\\n  --attestations material,product \\\n  -o package.json --key ci-key.pem \\\n  -- tar czf myapp.tar.gz myapp\n\n# Verify entire pipeline\nwitness verify \\\n  --policy policy-signed.json \\\n  --publickey policy-key.pub \\\n  -a build.json -a test.json -a package.json\n```\n"}]}
{"messages": [{"role": "system", "content": "You are an expert in the Witness supply chain attestation framework. You help users instrument CI/CD pipelines with witness, create policy documents, and write Rego policies to validate attestations. You understand all attestors in go-witness and how to use them effectively."}, {"role": "user", "content": "How do I create a witness policy for a build step that uses these attestors: product?"}, {"role": "assistant", "content": "Here's a complete witness policy for your build step with product attestors:\n\n**Policy Document:**\n```json\n{\n  \"expires\": \"2026-11-08T10:52:59Z\",\n  \"publickeys\": {\n    \"build-key\": {\n      \"keyid\": \"sha256:dda9e86e3db20a92b798f577ebb2e09d7e49d47a2dfbf4a7e994698935bcb85f\",\n      \"key\": \"-----BEGIN PUBLIC KEY-----\\n...\\n-----END PUBLIC KEY-----\"\n    }\n  },\n  \"steps\": {\n    \"build\": {\n      \"name\": \"build\",\n      \"attestations\": [\n        {\n          \"type\": \"https://witness.dev/attestations/product/v0.1\"\n        }\n      ],\n      \"functionaries\": [\n        {\n          \"type\": \"publickey\",\n          \"publickeyid\": \"build-key\"\n        }\n      ]\n    }\n  }\n}\n```\n\n**Witness Run Command:**\n```bash\nwitness run --step build \\\n  --attestations product \\\n  --outfile build-attestation.json \\\n  --key signing-key.pem \\\n  -- <your-build-command>\n```\n\n**Rego Validation Rules:**\n```rego\n\n```\n\n**Verification:**\n```bash\nwitness verify \\\n  --policy policy-signed.json \\\n  --publickey policy-key.pub \\\n  -a build-attestation.json \\\n  --subject <artifact>\n```\n"}]}
{"messages": [{"role": "system", "content": "You are an expert in the Witness supply chain attestation framework. You help users instrument CI/CD pipelines with witness, create policy documents, and write Rego policies to validate attestations. You understand all attestors in go-witness and how to use them effectively."}, {"role": "user", "content": "How do I create a witness policy for a build step that uses these attestors: commandrun, git?"}, {"role": "assistant", "content": "Here's a complete witness policy for your build step with commandrun, git attestors:\n\n**Policy Document:**\n```json\n{\n  \"expires\": \"2026-11-08T10:52:59Z\",\n  \"publickeys\": {\n    \"build-key\": {\n      \"keyid\": \"sha256:b78d106de23aa4137a380d95e069b96d0370921de517c1c6662387f44158787d\",\n      \"key\": \"-----BEGIN PUBLIC KEY-----\\n...\\n-----END PUBLIC KEY-----\"\n    }\n  },\n  \"steps\": {\n    \"build\": {\n      \"name\": \"build\",\n      \"attestations\": [\n        {\n          \"type\": \"https://witness.dev/attestations/command-run/v0.1\"\n        },\n        {\n          \"type\": \"https://witness.dev/attestations/git/v0.1\"\n        }\n      ],\n      \"functionaries\": [\n        {\n          \"type\": \"publickey\",\n          \"publickeyid\": \"build-key\"\n        }\n      ]\n    }\n  }\n}\n```\n\n**Witness Run Command:**\n```bash\nwitness run --step build \\\n  --attestations commandrun,git \\\n  --outfile build-attestation.json \\\n  --key signing-key.pem \\\n  -- <your-build-command>\n```\n\n**Rego Validation Rules:**\n```rego\n\n```\n\n**Verification:**\n```bash\nwitness verify \\\n  --policy policy-signed.json \\\n  --publickey policy-key.pub \\\n  -a build-attestation.json \\\n  --subject <artifact>\n```\n"}]}
{"messages": [{"role": "system", "content": "You are an expert in the Witness supply chain attestation framework. You help users instrument CI/CD pipelines with witness, create policy documents, and write Rego policies to validate attestations. You understand all attestors in go-witness and how to use them effectively."}, {"role": "user", "content": "How do I create a multi-step witness policy for a build \u2192 test \u2192 package pipeline?"}, {"role": "assistant", "content": "Here's a complete multi-step witness policy for your pipeline:\n\n**Policy Document:**\n```json\n{\n  \"expires\": \"2026-11-08T10:52:59Z\",\n  \"publickeys\": {\n    \"ci-key\": {\n      \"keyid\": \"sha256:61ddc2040ca23c2a61fe91e1973964bd1205c346121d1bcf863e5ce2e6e513bf\",\n      \"key\": \"-----BEGIN PUBLIC KEY-----\\n...\\n-----END PUBLIC KEY-----\"\n    }\n  },\n  \"steps\": {\n    \"build\": {\n      \"name\": \"build\",\n      \"attestations\": [\n        {\n          \"type\": \"https://witness.dev/attestations/git/v0.1\"\n        },\n        {\n          \"type\": \"https://witness.dev/attestations/command-run/v0.1\"\n        },\n        {\n          \"type\": \"https://witness.dev/attestations/product/v0.1\"\n        }\n      ],\n      \"functionaries\": [\n        {\n          \"type\": \"publickey\",\n          \"publickeyid\": \"ci-key\"\n        }\n      ]\n    },\n    \"test\": {\n      \"name\": \"test\",\n      \"attestations\": [\n        {\n          \"type\": \"https://witness.dev/attestations/material/v0.1\"\n        },\n        {\n          \"type\": \"https://witness.dev/attestations/command-run/v0.1\"\n        }\n      ],\n      \"functionaries\": [\n        {\n          \"type\": \"publickey\",\n          \"publickeyid\": \"ci-key\"\n        }\n      ]\n    },\n    \"package\": {\n      \"name\": \"package\",\n      \"attestations\": [\n        {\n          \"type\": \"https://witness.dev/attestations/material/v0.1\"\n        },\n        {\n          \"type\": \"https://witness.dev/attestations/product/v0.1\"\n        }\n      ],\n      \"functionaries\": [\n        {\n          \"type\": \"publickey\",\n          \"publickeyid\": \"ci-key\"\n        }\n      ]\n    }\n  }\n}\n```\n\n**Pipeline Commands:**\n\n```bash\n# Step 1: Build\nwitness run --step build \\\n  --attestations git,commandrun,product \\\n  -o build.json --key ci-key.pem \\\n  -- go build -o myapp\n\n# Step 2: Test\nwitness run --step test \\\n  --attestations material,commandrun \\\n  -o test.json --key ci-key.pem \\\n  -- go test ./...\n\n# Step 3: Package\nwitness run --step package \\\n  --attestations material,product \\\n  -o package.json --key ci-key.pem \\\n  -- tar czf myapp.tar.gz myapp\n\n# Verify entire pipeline\nwitness verify \\\n  --policy policy-signed.json \\\n  --publickey policy-key.pub \\\n  -a build.json -a test.json -a package.json\n```\n"}]}
{"messages": [{"role": "system", "content": "You are an expert in the Witness supply chain attestation framework. You help users instrument CI/CD pipelines with witness, create policy documents, and write Rego policies to validate attestations. You understand all attestors in go-witness and how to use them effectively."}, {"role": "user", "content": "How do I create a multi-step witness policy for a build \u2192 test \u2192 package pipeline?"}, {"role": "assistant", "content": "Here's a complete multi-step witness policy for your pipeline:\n\n**Policy Document:**\n```json\n{\n  \"expires\": \"2026-11-08T10:52:59Z\",\n  \"publickeys\": {\n    \"ci-key\": {\n      \"keyid\": \"sha256:39997b3a6cab7e5c398d0b413c7a52d9b80092b5b71123aaa3845f82b4f112b0\",\n      \"key\": \"-----BEGIN PUBLIC KEY-----\\n...\\n-----END PUBLIC KEY-----\"\n    }\n  },\n  \"steps\": {\n    \"build\": {\n      \"name\": \"build\",\n      \"attestations\": [\n        {\n          \"type\": \"https://witness.dev/attestations/git/v0.1\"\n        },\n        {\n          \"type\": \"https://witness.dev/attestations/command-run/v0.1\"\n        },\n        {\n          \"type\": \"https://witness.dev/attestations/product/v0.1\"\n        }\n      ],\n      \"functionaries\": [\n        {\n          \"type\": \"publickey\",\n          \"publickeyid\": \"ci-key\"\n        }\n      ]\n    },\n    \"test\": {\n      \"name\": \"test\",\n      \"attestations\": [\n        {\n          \"type\": \"https://witness.dev/attestations/material/v0.1\"\n        },\n        {\n          \"type\": \"https://witness.dev/attestations/command-run/v0.1\"\n        }\n      ],\n      \"functionaries\": [\n        {\n          \"type\": \"publickey\",\n          \"publickeyid\": \"ci-key\"\n        }\n      ]\n    },\n    \"package\": {\n      \"name\": \"package\",\n      \"attestations\": [\n        {\n          \"type\": \"https://witness.dev/attestations/material/v0.1\"\n        },\n        {\n          \"type\": \"https://witness.dev/attestations/product/v0.1\"\n        }\n      ],\n      \"functionaries\": [\n        {\n          \"type\": \"publickey\",\n          \"publickeyid\": \"ci-key\"\n        }\n      ]\n    }\n  }\n}\n```\n\n**Pipeline Commands:**\n\n```bash\n# Step 1: Build\nwitness run --step build \\\n  --attestations git,commandrun,product \\\n  -o build.json --key ci-key.pem \\\n  -- go build -o myapp\n\n# Step 2: Test\nwitness run --step test \\\n  --attestations material,commandrun \\\n  -o test.json --key ci-key.pem \\\n  -- go test ./...\n\n# Step 3: Package\nwitness run --step package \\\n  --attestations material,product \\\n  -o package.json --key ci-key.pem \\\n  -- tar czf myapp.tar.gz myapp\n\n# Verify entire pipeline\nwitness verify \\\n  --policy policy-signed.json \\\n  --publickey policy-key.pub \\\n  -a build.json -a test.json -a package.json\n```\n"}]}
{"messages": [{"role": "system", "content": "You are an expert in the Witness supply chain attestation framework. You help users instrument CI/CD pipelines with witness, create policy documents, and write Rego policies to validate attestations. You understand all attestors in go-witness and how to use them effectively."}, {"role": "user", "content": "How do I create a witness policy for a build step that uses these attestors: product, commandrun?"}, {"role": "assistant", "content": "Here's a complete witness policy for your build step with product, commandrun attestors:\n\n**Policy Document:**\n```json\n{\n  \"expires\": \"2026-11-08T10:52:59Z\",\n  \"publickeys\": {\n    \"build-key\": {\n      \"keyid\": \"sha256:f4e91c004869ed250a74f038fb55f1363d888bb999122ce3bc5e3b135c4ec5bf\",\n      \"key\": \"-----BEGIN PUBLIC KEY-----\\n...\\n-----END PUBLIC KEY-----\"\n    }\n  },\n  \"steps\": {\n    \"build\": {\n      \"name\": \"build\",\n      \"attestations\": [\n        {\n          \"type\": \"https://witness.dev/attestations/product/v0.1\"\n        },\n        {\n          \"type\": \"https://witness.dev/attestations/command-run/v0.1\"\n        }\n      ],\n      \"functionaries\": [\n        {\n          \"type\": \"publickey\",\n          \"publickeyid\": \"build-key\"\n        }\n      ]\n    }\n  }\n}\n```\n\n**Witness Run Command:**\n```bash\nwitness run --step build \\\n  --attestations product,commandrun \\\n  --outfile build-attestation.json \\\n  --key signing-key.pem \\\n  -- <your-build-command>\n```\n\n**Rego Validation Rules:**\n```rego\n\n```\n\n**Verification:**\n```bash\nwitness verify \\\n  --policy policy-signed.json \\\n  --publickey policy-key.pub \\\n  -a build-attestation.json \\\n  --subject <artifact>\n```\n"}]}
{"messages": [{"role": "system", "content": "You are an expert in the Witness supply chain attestation framework. You help users instrument CI/CD pipelines with witness, create policy documents, and write Rego policies to validate attestations. You understand all attestors in go-witness and how to use them effectively."}, {"role": "user", "content": "How do I create a witness policy for a build step that uses these attestors: github, environment, material, product, commandrun?"}, {"role": "assistant", "content": "Here's a complete witness policy for your build step with github, environment, material, product, commandrun attestors:\n\n**Policy Document:**\n```json\n{\n  \"expires\": \"2026-11-08T10:52:59Z\",\n  \"publickeys\": {\n    \"build-key\": {\n      \"keyid\": \"sha256:0be563afd606a18be824fc75b7d7bb0c7215b60189f9593a4d70257d3668fdbb\",\n      \"key\": \"-----BEGIN PUBLIC KEY-----\\n...\\n-----END PUBLIC KEY-----\"\n    }\n  },\n  \"steps\": {\n    \"build\": {\n      \"name\": \"build\",\n      \"attestations\": [\n        {\n          \"type\": \"https://witness.dev/attestations/github/v0.1\"\n        },\n        {\n          \"type\": \"https://witness.dev/attestations/environment/v0.1\"\n        },\n        {\n          \"type\": \"https://witness.dev/attestations/material/v0.1\"\n        },\n        {\n          \"type\": \"https://witness.dev/attestations/product/v0.1\"\n        },\n        {\n          \"type\": \"https://witness.dev/attestations/command-run/v0.1\"\n        }\n      ],\n      \"functionaries\": [\n        {\n          \"type\": \"publickey\",\n          \"publickeyid\": \"build-key\"\n        }\n      ]\n    }\n  }\n}\n```\n\n**Witness Run Command:**\n```bash\nwitness run --step build \\\n  --attestations github,environment,material,product,commandrun \\\n  --outfile build-attestation.json \\\n  --key signing-key.pem \\\n  -- <your-build-command>\n```\n\n**Rego Validation Rules:**\n```rego\n\n```\n\n**Verification:**\n```bash\nwitness verify \\\n  --policy policy-signed.json \\\n  --publickey policy-key.pub \\\n  -a build-attestation.json \\\n  --subject <artifact>\n```\n"}]}
{"messages": [{"role": "system", "content": "You are an expert in the Witness supply chain attestation framework. You help users instrument CI/CD pipelines with witness, create policy documents, and write Rego policies to validate attestations. You understand all attestors in go-witness and how to use them effectively."}, {"role": "user", "content": "How do I create a multi-step witness policy for a build \u2192 test \u2192 package pipeline?"}, {"role": "assistant", "content": "Here's a complete multi-step witness policy for your pipeline:\n\n**Policy Document:**\n```json\n{\n  \"expires\": \"2026-11-08T10:52:59Z\",\n  \"publickeys\": {\n    \"ci-key\": {\n      \"keyid\": \"sha256:29bc7f5a881d442b190b2eb10da33313a27c8c04b95e0706713d99d6d10035f8\",\n      \"key\": \"-----BEGIN PUBLIC KEY-----\\n...\\n-----END PUBLIC KEY-----\"\n    }\n  },\n  \"steps\": {\n    \"build\": {\n      \"name\": \"build\",\n      \"attestations\": [\n        {\n          \"type\": \"https://witness.dev/attestations/git/v0.1\"\n        },\n        {\n          \"type\": \"https://witness.dev/attestations/command-run/v0.1\"\n        },\n        {\n          \"type\": \"https://witness.dev/attestations/product/v0.1\"\n        }\n      ],\n      \"functionaries\": [\n        {\n          \"type\": \"publickey\",\n          \"publickeyid\": \"ci-key\"\n        }\n      ]\n    },\n    \"test\": {\n      \"name\": \"test\",\n      \"attestations\": [\n        {\n          \"type\": \"https://witness.dev/attestations/material/v0.1\"\n        },\n        {\n          \"type\": \"https://witness.dev/attestations/command-run/v0.1\"\n        }\n      ],\n      \"functionaries\": [\n        {\n          \"type\": \"publickey\",\n          \"publickeyid\": \"ci-key\"\n        }\n      ]\n    },\n    \"package\": {\n      \"name\": \"package\",\n      \"attestations\": [\n        {\n          \"type\": \"https://witness.dev/attestations/material/v0.1\"\n        },\n        {\n          \"type\": \"https://witness.dev/attestations/product/v0.1\"\n        }\n      ],\n      \"functionaries\": [\n        {\n          \"type\": \"publickey\",\n          \"publickeyid\": \"ci-key\"\n        }\n      ]\n    }\n  }\n}\n```\n\n**Pipeline Commands:**\n\n```bash\n# Step 1: Build\nwitness run --step build \\\n  --attestations git,commandrun,product \\\n  -o build.json --key ci-key.pem \\\n  -- go build -o myapp\n\n# Step 2: Test\nwitness run --step test \\\n  --attestations material,commandrun \\\n  -o test.json --key ci-key.pem \\\n  -- go test ./...\n\n# Step 3: Package\nwitness run --step package \\\n  --attestations material,product \\\n  -o package.json --key ci-key.pem \\\n  -- tar czf myapp.tar.gz myapp\n\n# Verify entire pipeline\nwitness verify \\\n  --policy policy-signed.json \\\n  --publickey policy-key.pub \\\n  -a build.json -a test.json -a package.json\n```\n"}]}
{"messages": [{"role": "system", "content": "You are an expert in the Witness supply chain attestation framework. You help users instrument CI/CD pipelines with witness, create policy documents, and write Rego policies to validate attestations. You understand all attestors in go-witness and how to use them effectively."}, {"role": "user", "content": "How do I create a multi-step witness policy for a build \u2192 test \u2192 package pipeline?"}, {"role": "assistant", "content": "Here's a complete multi-step witness policy for your pipeline:\n\n**Policy Document:**\n```json\n{\n  \"expires\": \"2026-11-08T10:52:59Z\",\n  \"publickeys\": {\n    \"ci-key\": {\n      \"keyid\": \"sha256:44c29f39f508cd20f8223e17dd51aa7fc92ae6853795af23c42de7a30349a540\",\n      \"key\": \"-----BEGIN PUBLIC KEY-----\\n...\\n-----END PUBLIC KEY-----\"\n    }\n  },\n  \"steps\": {\n    \"build\": {\n      \"name\": \"build\",\n      \"attestations\": [\n        {\n          \"type\": \"https://witness.dev/attestations/git/v0.1\"\n        },\n        {\n          \"type\": \"https://witness.dev/attestations/command-run/v0.1\"\n        },\n        {\n          \"type\": \"https://witness.dev/attestations/product/v0.1\"\n        }\n      ],\n      \"functionaries\": [\n        {\n          \"type\": \"publickey\",\n          \"publickeyid\": \"ci-key\"\n        }\n      ]\n    },\n    \"test\": {\n      \"name\": \"test\",\n      \"attestations\": [\n        {\n          \"type\": \"https://witness.dev/attestations/material/v0.1\"\n        },\n        {\n          \"type\": \"https://witness.dev/attestations/command-run/v0.1\"\n        }\n      ],\n      \"functionaries\": [\n        {\n          \"type\": \"publickey\",\n          \"publickeyid\": \"ci-key\"\n        }\n      ]\n    },\n    \"package\": {\n      \"name\": \"package\",\n      \"attestations\": [\n        {\n          \"type\": \"https://witness.dev/attestations/material/v0.1\"\n        },\n        {\n          \"type\": \"https://witness.dev/attestations/product/v0.1\"\n        }\n      ],\n      \"functionaries\": [\n        {\n          \"type\": \"publickey\",\n          \"publickeyid\": \"ci-key\"\n        }\n      ]\n    }\n  }\n}\n```\n\n**Pipeline Commands:**\n\n```bash\n# Step 1: Build\nwitness run --step build \\\n  --attestations git,commandrun,product \\\n  -o build.json --key ci-key.pem \\\n  -- go build -o myapp\n\n# Step 2: Test\nwitness run --step test \\\n  --attestations material,commandrun \\\n  -o test.json --key ci-key.pem \\\n  -- go test ./...\n\n# Step 3: Package\nwitness run --step package \\\n  --attestations material,product \\\n  -o package.json --key ci-key.pem \\\n  -- tar czf myapp.tar.gz myapp\n\n# Verify entire pipeline\nwitness verify \\\n  --policy policy-signed.json \\\n  --publickey policy-key.pub \\\n  -a build.json -a test.json -a package.json\n```\n"}]}
{"messages": [{"role": "system", "content": "You are an expert in the Witness supply chain attestation framework. You help users instrument CI/CD pipelines with witness, create policy documents, and write Rego policies to validate attestations. You understand all attestors in go-witness and how to use them effectively."}, {"role": "user", "content": "How do I create a witness policy for a build step that uses these attestors: product, commandrun, material, git, github?"}, {"role": "assistant", "content": "Here's a complete witness policy for your build step with product, commandrun, material, git, github attestors:\n\n**Policy Document:**\n```json\n{\n  \"expires\": \"2026-11-08T10:52:59Z\",\n  \"publickeys\": {\n    \"build-key\": {\n      \"keyid\": \"sha256:a9b39b0bd774b5db6232fc9177e297a8b03de8c9baba1d5041b5066273423496\",\n      \"key\": \"-----BEGIN PUBLIC KEY-----\\n...\\n-----END PUBLIC KEY-----\"\n    }\n  },\n  \"steps\": {\n    \"build\": {\n      \"name\": \"build\",\n      \"attestations\": [\n        {\n          \"type\": \"https://witness.dev/attestations/product/v0.1\"\n        },\n        {\n          \"type\": \"https://witness.dev/attestations/command-run/v0.1\"\n        },\n        {\n          \"type\": \"https://witness.dev/attestations/material/v0.1\"\n        },\n        {\n          \"type\": \"https://witness.dev/attestations/git/v0.1\"\n        },\n        {\n          \"type\": \"https://witness.dev/attestations/github/v0.1\"\n        }\n      ],\n      \"functionaries\": [\n        {\n          \"type\": \"publickey\",\n          \"publickeyid\": \"build-key\"\n        }\n      ]\n    }\n  }\n}\n```\n\n**Witness Run Command:**\n```bash\nwitness run --step build \\\n  --attestations product,commandrun,material,git,github \\\n  --outfile build-attestation.json \\\n  --key signing-key.pem \\\n  -- <your-build-command>\n```\n\n**Rego Validation Rules:**\n```rego\n\n```\n\n**Verification:**\n```bash\nwitness verify \\\n  --policy policy-signed.json \\\n  --publickey policy-key.pub \\\n  -a build-attestation.json \\\n  --subject <artifact>\n```\n"}]}
{"messages": [{"role": "system", "content": "You are an expert in the Witness supply chain attestation framework. You help users instrument CI/CD pipelines with witness, create policy documents, and write Rego policies to validate attestations. You understand all attestors in go-witness and how to use them effectively."}, {"role": "user", "content": "How do I create a multi-step witness policy for a build \u2192 test \u2192 package pipeline?"}, {"role": "assistant", "content": "Here's a complete multi-step witness policy for your pipeline:\n\n**Policy Document:**\n```json\n{\n  \"expires\": \"2026-11-08T10:52:59Z\",\n  \"publickeys\": {\n    \"ci-key\": {\n      \"keyid\": \"sha256:b72b5c6c7bb5db8576244d7e32c5e9c8cb13582ce19b1bdb00e3175a2d0fdf66\",\n      \"key\": \"-----BEGIN PUBLIC KEY-----\\n...\\n-----END PUBLIC KEY-----\"\n    }\n  },\n  \"steps\": {\n    \"build\": {\n      \"name\": \"build\",\n      \"attestations\": [\n        {\n          \"type\": \"https://witness.dev/attestations/git/v0.1\"\n        },\n        {\n          \"type\": \"https://witness.dev/attestations/command-run/v0.1\"\n        },\n        {\n          \"type\": \"https://witness.dev/attestations/product/v0.1\"\n        }\n      ],\n      \"functionaries\": [\n        {\n          \"type\": \"publickey\",\n          \"publickeyid\": \"ci-key\"\n        }\n      ]\n    },\n    \"test\": {\n      \"name\": \"test\",\n      \"attestations\": [\n        {\n          \"type\": \"https://witness.dev/attestations/material/v0.1\"\n        },\n        {\n          \"type\": \"https://witness.dev/attestations/command-run/v0.1\"\n        }\n      ],\n      \"functionaries\": [\n        {\n          \"type\": \"publickey\",\n          \"publickeyid\": \"ci-key\"\n        }\n      ]\n    },\n    \"package\": {\n      \"name\": \"package\",\n      \"attestations\": [\n        {\n          \"type\": \"https://witness.dev/attestations/material/v0.1\"\n        },\n        {\n          \"type\": \"https://witness.dev/attestations/product/v0.1\"\n        }\n      ],\n      \"functionaries\": [\n        {\n          \"type\": \"publickey\",\n          \"publickeyid\": \"ci-key\"\n        }\n      ]\n    }\n  }\n}\n```\n\n**Pipeline Commands:**\n\n```bash\n# Step 1: Build\nwitness run --step build \\\n  --attestations git,commandrun,product \\\n  -o build.json --key ci-key.pem \\\n  -- go build -o myapp\n\n# Step 2: Test\nwitness run --step test \\\n  --attestations material,commandrun \\\n  -o test.json --key ci-key.pem \\\n  -- go test ./...\n\n# Step 3: Package\nwitness run --step package \\\n  --attestations material,product \\\n  -o package.json --key ci-key.pem \\\n  -- tar czf myapp.tar.gz myapp\n\n# Verify entire pipeline\nwitness verify \\\n  --policy policy-signed.json \\\n  --publickey policy-key.pub \\\n  -a build.json -a test.json -a package.json\n```\n"}]}
{"messages": [{"role": "system", "content": "You are an expert in the Witness supply chain attestation framework. You help users instrument CI/CD pipelines with witness, create policy documents, and write Rego policies to validate attestations. You understand all attestors in go-witness and how to use them effectively."}, {"role": "user", "content": "How do I create a witness policy for a build step that uses these attestors: environment, git, material?"}, {"role": "assistant", "content": "Here's a complete witness policy for your build step with environment, git, material attestors:\n\n**Policy Document:**\n```json\n{\n  \"expires\": \"2026-11-08T10:52:59Z\",\n  \"publickeys\": {\n    \"build-key\": {\n      \"keyid\": \"sha256:89a72a8dfa19ae3e47738af7d4a5651d0a1eab055cc2ce2c03b4f3bfd1dec3fb\",\n      \"key\": \"-----BEGIN PUBLIC KEY-----\\n...\\n-----END PUBLIC KEY-----\"\n    }\n  },\n  \"steps\": {\n    \"build\": {\n      \"name\": \"build\",\n      \"attestations\": [\n        {\n          \"type\": \"https://witness.dev/attestations/environment/v0.1\"\n        },\n        {\n          \"type\": \"https://witness.dev/attestations/git/v0.1\"\n        },\n        {\n          \"type\": \"https://witness.dev/attestations/material/v0.1\"\n        }\n      ],\n      \"functionaries\": [\n        {\n          \"type\": \"publickey\",\n          \"publickeyid\": \"build-key\"\n        }\n      ]\n    }\n  }\n}\n```\n\n**Witness Run Command:**\n```bash\nwitness run --step build \\\n  --attestations environment,git,material \\\n  --outfile build-attestation.json \\\n  --key signing-key.pem \\\n  -- <your-build-command>\n```\n\n**Rego Validation Rules:**\n```rego\npackage environment\n\nimport rego.v1\n\n# Ensure correct OS\ndeny contains msg if {\n    input.os != \"linux\"\n    msg := sprintf(\"Must run on linux, got: %s\", [input.os])\n}\n\n# Require CI environment\ndeny contains msg if {\n    not \"CI\" in input.variables\n    msg := \"Must run in CI environment (CI variable not set)\"\n}\n```\n\n**Verification:**\n```bash\nwitness verify \\\n  --policy policy-signed.json \\\n  --publickey policy-key.pub \\\n  -a build-attestation.json \\\n  --subject <artifact>\n```\n"}]}
{"messages": [{"role": "system", "content": "You are an expert in the Witness supply chain attestation framework. You help users instrument CI/CD pipelines with witness, create policy documents, and write Rego policies to validate attestations. You understand all attestors in go-witness and how to use them effectively."}, {"role": "user", "content": "How do I create a multi-step witness policy for a build \u2192 test \u2192 package pipeline?"}, {"role": "assistant", "content": "Here's a complete multi-step witness policy for your pipeline:\n\n**Policy Document:**\n```json\n{\n  \"expires\": \"2026-11-08T10:52:59Z\",\n  \"publickeys\": {\n    \"ci-key\": {\n      \"keyid\": \"sha256:e6a8f0fa7de84edec46366a199efb49e174e867ed94809a2582a44371924e1f7\",\n      \"key\": \"-----BEGIN PUBLIC KEY-----\\n...\\n-----END PUBLIC KEY-----\"\n    }\n  },\n  \"steps\": {\n    \"build\": {\n      \"name\": \"build\",\n      \"attestations\": [\n        {\n          \"type\": \"https://witness.dev/attestations/git/v0.1\"\n        },\n        {\n          \"type\": \"https://witness.dev/attestations/command-run/v0.1\"\n        },\n        {\n          \"type\": \"https://witness.dev/attestations/product/v0.1\"\n        }\n      ],\n      \"functionaries\": [\n        {\n          \"type\": \"publickey\",\n          \"publickeyid\": \"ci-key\"\n        }\n      ]\n    },\n    \"test\": {\n      \"name\": \"test\",\n      \"attestations\": [\n        {\n          \"type\": \"https://witness.dev/attestations/material/v0.1\"\n        },\n        {\n          \"type\": \"https://witness.dev/attestations/command-run/v0.1\"\n        }\n      ],\n      \"functionaries\": [\n        {\n          \"type\": \"publickey\",\n          \"publickeyid\": \"ci-key\"\n        }\n      ]\n    },\n    \"package\": {\n      \"name\": \"package\",\n      \"attestations\": [\n        {\n          \"type\": \"https://witness.dev/attestations/material/v0.1\"\n        },\n        {\n          \"type\": \"https://witness.dev/attestations/product/v0.1\"\n        }\n      ],\n      \"functionaries\": [\n        {\n          \"type\": \"publickey\",\n          \"publickeyid\": \"ci-key\"\n        }\n      ]\n    }\n  }\n}\n```\n\n**Pipeline Commands:**\n\n```bash\n# Step 1: Build\nwitness run --step build \\\n  --attestations git,commandrun,product \\\n  -o build.json --key ci-key.pem \\\n  -- go build -o myapp\n\n# Step 2: Test\nwitness run --step test \\\n  --attestations material,commandrun \\\n  -o test.json --key ci-key.pem \\\n  -- go test ./...\n\n# Step 3: Package\nwitness run --step package \\\n  --attestations material,product \\\n  -o package.json --key ci-key.pem \\\n  -- tar czf myapp.tar.gz myapp\n\n# Verify entire pipeline\nwitness verify \\\n  --policy policy-signed.json \\\n  --publickey policy-key.pub \\\n  -a build.json -a test.json -a package.json\n```\n"}]}
{"messages": [{"role": "system", "content": "You are an expert in the Witness supply chain attestation framework. You help users instrument CI/CD pipelines with witness, create policy documents, and write Rego policies to validate attestations. You understand all attestors in go-witness and how to use them effectively."}, {"role": "user", "content": "How do I create a witness policy for a build step that uses these attestors: github, material?"}, {"role": "assistant", "content": "Here's a complete witness policy for your build step with github, material attestors:\n\n**Policy Document:**\n```json\n{\n  \"expires\": \"2026-11-08T10:52:59Z\",\n  \"publickeys\": {\n    \"build-key\": {\n      \"keyid\": \"sha256:3a09a3a500b70d31a24526a983a20085dff6341be92cac0658bbe0e0a9d8899b\",\n      \"key\": \"-----BEGIN PUBLIC KEY-----\\n...\\n-----END PUBLIC KEY-----\"\n    }\n  },\n  \"steps\": {\n    \"build\": {\n      \"name\": \"build\",\n      \"attestations\": [\n        {\n          \"type\": \"https://witness.dev/attestations/github/v0.1\"\n        },\n        {\n          \"type\": \"https://witness.dev/attestations/material/v0.1\"\n        }\n      ],\n      \"functionaries\": [\n        {\n          \"type\": \"publickey\",\n          \"publickeyid\": \"build-key\"\n        }\n      ]\n    }\n  }\n}\n```\n\n**Witness Run Command:**\n```bash\nwitness run --step build \\\n  --attestations github,material \\\n  --outfile build-attestation.json \\\n  --key signing-key.pem \\\n  -- <your-build-command>\n```\n\n**Rego Validation Rules:**\n```rego\n\n```\n\n**Verification:**\n```bash\nwitness verify \\\n  --policy policy-signed.json \\\n  --publickey policy-key.pub \\\n  -a build-attestation.json \\\n  --subject <artifact>\n```\n"}]}
{"messages": [{"role": "system", "content": "You are an expert in the Witness supply chain attestation framework. You help users instrument CI/CD pipelines with witness, create policy documents, and write Rego policies to validate attestations. You understand all attestors in go-witness and how to use them effectively."}, {"role": "user", "content": "How do I create a witness policy for a build step that uses these attestors: git, github, product, environment?"}, {"role": "assistant", "content": "Here's a complete witness policy for your build step with git, github, product, environment attestors:\n\n**Policy Document:**\n```json\n{\n  \"expires\": \"2026-11-08T10:52:59Z\",\n  \"publickeys\": {\n    \"build-key\": {\n      \"keyid\": \"sha256:c260084fbbee611b25b7a781880473435ff729e9194626fdaecabeaad33ac496\",\n      \"key\": \"-----BEGIN PUBLIC KEY-----\\n...\\n-----END PUBLIC KEY-----\"\n    }\n  },\n  \"steps\": {\n    \"build\": {\n      \"name\": \"build\",\n      \"attestations\": [\n        {\n          \"type\": \"https://witness.dev/attestations/git/v0.1\"\n        },\n        {\n          \"type\": \"https://witness.dev/attestations/github/v0.1\"\n        },\n        {\n          \"type\": \"https://witness.dev/attestations/product/v0.1\"\n        },\n        {\n          \"type\": \"https://witness.dev/attestations/environment/v0.1\"\n        }\n      ],\n      \"functionaries\": [\n        {\n          \"type\": \"publickey\",\n          \"publickeyid\": \"build-key\"\n        }\n      ]\n    }\n  }\n}\n```\n\n**Witness Run Command:**\n```bash\nwitness run --step build \\\n  --attestations git,github,product,environment \\\n  --outfile build-attestation.json \\\n  --key signing-key.pem \\\n  -- <your-build-command>\n```\n\n**Rego Validation Rules:**\n```rego\npackage git\n\nimport rego.v1\n\n# Enforce builds from specific branch\ndeny contains msg if {\n    input.branch != \"bugfix/security\"\n    msg := sprintf(\"Must build from bugfix/security branch, got: %s\", [input.branch])\n}\n\n# Require clean working directory\ndeny contains msg if {\n    count(input.status) > 0\n    msg := \"Working directory must be clean (no uncommitted changes)\"\n}\n\n# Validate commit author\napproved_authors := {\n    \"alice.smith@example.com\",\n    \"bob.jones@company.com\",\n    \"ci-bot@company.com\"\n}\n\ndeny contains msg if {\n    not input.authoremail in approved_authors\n    msg := sprintf(\"Unauthorized commit author: %s\", [input.authoremail])\n}\n```\n\n**Verification:**\n```bash\nwitness verify \\\n  --policy policy-signed.json \\\n  --publickey policy-key.pub \\\n  -a build-attestation.json \\\n  --subject <artifact>\n```\n"}]}
{"messages": [{"role": "system", "content": "You are an expert in the Witness supply chain attestation framework. You help users instrument CI/CD pipelines with witness, create policy documents, and write Rego policies to validate attestations. You understand all attestors in go-witness and how to use them effectively."}, {"role": "user", "content": "How do I create a multi-step witness policy for a build \u2192 test \u2192 package pipeline?"}, {"role": "assistant", "content": "Here's a complete multi-step witness policy for your pipeline:\n\n**Policy Document:**\n```json\n{\n  \"expires\": \"2026-11-08T10:52:59Z\",\n  \"publickeys\": {\n    \"ci-key\": {\n      \"keyid\": \"sha256:181868883bc627ab410c69bc14d47a665be25391a46f4d32fc818db460dff390\",\n      \"key\": \"-----BEGIN PUBLIC KEY-----\\n...\\n-----END PUBLIC KEY-----\"\n    }\n  },\n  \"steps\": {\n    \"build\": {\n      \"name\": \"build\",\n      \"attestations\": [\n        {\n          \"type\": \"https://witness.dev/attestations/git/v0.1\"\n        },\n        {\n          \"type\": \"https://witness.dev/attestations/command-run/v0.1\"\n        },\n        {\n          \"type\": \"https://witness.dev/attestations/product/v0.1\"\n        }\n      ],\n      \"functionaries\": [\n        {\n          \"type\": \"publickey\",\n          \"publickeyid\": \"ci-key\"\n        }\n      ]\n    },\n    \"test\": {\n      \"name\": \"test\",\n      \"attestations\": [\n        {\n          \"type\": \"https://witness.dev/attestations/material/v0.1\"\n        },\n        {\n          \"type\": \"https://witness.dev/attestations/command-run/v0.1\"\n        }\n      ],\n      \"functionaries\": [\n        {\n          \"type\": \"publickey\",\n          \"publickeyid\": \"ci-key\"\n        }\n      ]\n    },\n    \"package\": {\n      \"name\": \"package\",\n      \"attestations\": [\n        {\n          \"type\": \"https://witness.dev/attestations/material/v0.1\"\n        },\n        {\n          \"type\": \"https://witness.dev/attestations/product/v0.1\"\n        }\n      ],\n      \"functionaries\": [\n        {\n          \"type\": \"publickey\",\n          \"publickeyid\": \"ci-key\"\n        }\n      ]\n    }\n  }\n}\n```\n\n**Pipeline Commands:**\n\n```bash\n# Step 1: Build\nwitness run --step build \\\n  --attestations git,commandrun,product \\\n  -o build.json --key ci-key.pem \\\n  -- go build -o myapp\n\n# Step 2: Test\nwitness run --step test \\\n  --attestations material,commandrun \\\n  -o test.json --key ci-key.pem \\\n  -- go test ./...\n\n# Step 3: Package\nwitness run --step package \\\n  --attestations material,product \\\n  -o package.json --key ci-key.pem \\\n  -- tar czf myapp.tar.gz myapp\n\n# Verify entire pipeline\nwitness verify \\\n  --policy policy-signed.json \\\n  --publickey policy-key.pub \\\n  -a build.json -a test.json -a package.json\n```\n"}]}
{"messages": [{"role": "system", "content": "You are an expert in the Witness supply chain attestation framework. You help users instrument CI/CD pipelines with witness, create policy documents, and write Rego policies to validate attestations. You understand all attestors in go-witness and how to use them effectively."}, {"role": "user", "content": "How do I create a multi-step witness policy for a build \u2192 test \u2192 package pipeline?"}, {"role": "assistant", "content": "Here's a complete multi-step witness policy for your pipeline:\n\n**Policy Document:**\n```json\n{\n  \"expires\": \"2026-11-08T10:52:59Z\",\n  \"publickeys\": {\n    \"ci-key\": {\n      \"keyid\": \"sha256:4c4144783a6dfec79bdd825cf79e31c3bdfd477beeb40d61d44453880fdc3696\",\n      \"key\": \"-----BEGIN PUBLIC KEY-----\\n...\\n-----END PUBLIC KEY-----\"\n    }\n  },\n  \"steps\": {\n    \"build\": {\n      \"name\": \"build\",\n      \"attestations\": [\n        {\n          \"type\": \"https://witness.dev/attestations/git/v0.1\"\n        },\n        {\n          \"type\": \"https://witness.dev/attestations/command-run/v0.1\"\n        },\n        {\n          \"type\": \"https://witness.dev/attestations/product/v0.1\"\n        }\n      ],\n      \"functionaries\": [\n        {\n          \"type\": \"publickey\",\n          \"publickeyid\": \"ci-key\"\n        }\n      ]\n    },\n    \"test\": {\n      \"name\": \"test\",\n      \"attestations\": [\n        {\n          \"type\": \"https://witness.dev/attestations/material/v0.1\"\n        },\n        {\n          \"type\": \"https://witness.dev/attestations/command-run/v0.1\"\n        }\n      ],\n      \"functionaries\": [\n        {\n          \"type\": \"publickey\",\n          \"publickeyid\": \"ci-key\"\n        }\n      ]\n    },\n    \"package\": {\n      \"name\": \"package\",\n      \"attestations\": [\n        {\n          \"type\": \"https://witness.dev/attestations/material/v0.1\"\n        },\n        {\n          \"type\": \"https://witness.dev/attestations/product/v0.1\"\n        }\n      ],\n      \"functionaries\": [\n        {\n          \"type\": \"publickey\",\n          \"publickeyid\": \"ci-key\"\n        }\n      ]\n    }\n  }\n}\n```\n\n**Pipeline Commands:**\n\n```bash\n# Step 1: Build\nwitness run --step build \\\n  --attestations git,commandrun,product \\\n  -o build.json --key ci-key.pem \\\n  -- go build -o myapp\n\n# Step 2: Test\nwitness run --step test \\\n  --attestations material,commandrun \\\n  -o test.json --key ci-key.pem \\\n  -- go test ./...\n\n# Step 3: Package\nwitness run --step package \\\n  --attestations material,product \\\n  -o package.json --key ci-key.pem \\\n  -- tar czf myapp.tar.gz myapp\n\n# Verify entire pipeline\nwitness verify \\\n  --policy policy-signed.json \\\n  --publickey policy-key.pub \\\n  -a build.json -a test.json -a package.json\n```\n"}]}
{"messages": [{"role": "system", "content": "You are an expert in the Witness supply chain attestation framework. You help users instrument CI/CD pipelines with witness, create policy documents, and write Rego policies to validate attestations. You understand all attestors in go-witness and how to use them effectively."}, {"role": "user", "content": "How do I create a multi-step witness policy for a build \u2192 test \u2192 package pipeline?"}, {"role": "assistant", "content": "Here's a complete multi-step witness policy for your pipeline:\n\n**Policy Document:**\n```json\n{\n  \"expires\": \"2026-11-08T10:52:59Z\",\n  \"publickeys\": {\n    \"ci-key\": {\n      \"keyid\": \"sha256:aeb9f688caabfd9740cfcb465b6dd09aecfd15638c9c1bbb0fabd01a295d5502\",\n      \"key\": \"-----BEGIN PUBLIC KEY-----\\n...\\n-----END PUBLIC KEY-----\"\n    }\n  },\n  \"steps\": {\n    \"build\": {\n      \"name\": \"build\",\n      \"attestations\": [\n        {\n          \"type\": \"https://witness.dev/attestations/git/v0.1\"\n        },\n        {\n          \"type\": \"https://witness.dev/attestations/command-run/v0.1\"\n        },\n        {\n          \"type\": \"https://witness.dev/attestations/product/v0.1\"\n        }\n      ],\n      \"functionaries\": [\n        {\n          \"type\": \"publickey\",\n          \"publickeyid\": \"ci-key\"\n        }\n      ]\n    },\n    \"test\": {\n      \"name\": \"test\",\n      \"attestations\": [\n        {\n          \"type\": \"https://witness.dev/attestations/material/v0.1\"\n        },\n        {\n          \"type\": \"https://witness.dev/attestations/command-run/v0.1\"\n        }\n      ],\n      \"functionaries\": [\n        {\n          \"type\": \"publickey\",\n          \"publickeyid\": \"ci-key\"\n        }\n      ]\n    },\n    \"package\": {\n      \"name\": \"package\",\n      \"attestations\": [\n        {\n          \"type\": \"https://witness.dev/attestations/material/v0.1\"\n        },\n        {\n          \"type\": \"https://witness.dev/attestations/product/v0.1\"\n        }\n      ],\n      \"functionaries\": [\n        {\n          \"type\": \"publickey\",\n          \"publickeyid\": \"ci-key\"\n        }\n      ]\n    }\n  }\n}\n```\n\n**Pipeline Commands:**\n\n```bash\n# Step 1: Build\nwitness run --step build \\\n  --attestations git,commandrun,product \\\n  -o build.json --key ci-key.pem \\\n  -- go build -o myapp\n\n# Step 2: Test\nwitness run --step test \\\n  --attestations material,commandrun \\\n  -o test.json --key ci-key.pem \\\n  -- go test ./...\n\n# Step 3: Package\nwitness run --step package \\\n  --attestations material,product \\\n  -o package.json --key ci-key.pem \\\n  -- tar czf myapp.tar.gz myapp\n\n# Verify entire pipeline\nwitness verify \\\n  --policy policy-signed.json \\\n  --publickey policy-key.pub \\\n  -a build.json -a test.json -a package.json\n```\n"}]}
{"messages": [{"role": "system", "content": "You are an expert in the Witness supply chain attestation framework. You help users instrument CI/CD pipelines with witness, create policy documents, and write Rego policies to validate attestations. You understand all attestors in go-witness and how to use them effectively."}, {"role": "user", "content": "How do I create a witness policy for a build step that uses these attestors: commandrun, github, git, environment, product?"}, {"role": "assistant", "content": "Here's a complete witness policy for your build step with commandrun, github, git, environment, product attestors:\n\n**Policy Document:**\n```json\n{\n  \"expires\": \"2026-11-08T10:52:59Z\",\n  \"publickeys\": {\n    \"build-key\": {\n      \"keyid\": \"sha256:0bb5fc2b9c978c0c867260f68df8686efc46b206efa58ac75197f4f2a42cd47d\",\n      \"key\": \"-----BEGIN PUBLIC KEY-----\\n...\\n-----END PUBLIC KEY-----\"\n    }\n  },\n  \"steps\": {\n    \"build\": {\n      \"name\": \"build\",\n      \"attestations\": [\n        {\n          \"type\": \"https://witness.dev/attestations/command-run/v0.1\"\n        },\n        {\n          \"type\": \"https://witness.dev/attestations/github/v0.1\"\n        },\n        {\n          \"type\": \"https://witness.dev/attestations/git/v0.1\"\n        },\n        {\n          \"type\": \"https://witness.dev/attestations/environment/v0.1\"\n        },\n        {\n          \"type\": \"https://witness.dev/attestations/product/v0.1\"\n        }\n      ],\n      \"functionaries\": [\n        {\n          \"type\": \"publickey\",\n          \"publickeyid\": \"build-key\"\n        }\n      ]\n    }\n  }\n}\n```\n\n**Witness Run Command:**\n```bash\nwitness run --step build \\\n  --attestations commandrun,github,git,environment,product \\\n  --outfile build-attestation.json \\\n  --key signing-key.pem \\\n  -- <your-build-command>\n```\n\n**Rego Validation Rules:**\n```rego\n\n```\n\n**Verification:**\n```bash\nwitness verify \\\n  --policy policy-signed.json \\\n  --publickey policy-key.pub \\\n  -a build-attestation.json \\\n  --subject <artifact>\n```\n"}]}
{"messages": [{"role": "system", "content": "You are an expert in the Witness supply chain attestation framework. You help users instrument CI/CD pipelines with witness, create policy documents, and write Rego policies to validate attestations. You understand all attestors in go-witness and how to use them effectively."}, {"role": "user", "content": "How do I create a witness policy for a build step that uses these attestors: material, commandrun?"}, {"role": "assistant", "content": "Here's a complete witness policy for your build step with material, commandrun attestors:\n\n**Policy Document:**\n```json\n{\n  \"expires\": \"2026-11-08T10:52:59Z\",\n  \"publickeys\": {\n    \"build-key\": {\n      \"keyid\": \"sha256:1665237d25ef1403d1b8197f1ea5b25b8f2cd206e1777310de7b23f4f878908a\",\n      \"key\": \"-----BEGIN PUBLIC KEY-----\\n...\\n-----END PUBLIC KEY-----\"\n    }\n  },\n  \"steps\": {\n    \"build\": {\n      \"name\": \"build\",\n      \"attestations\": [\n        {\n          \"type\": \"https://witness.dev/attestations/material/v0.1\"\n        },\n        {\n          \"type\": \"https://witness.dev/attestations/command-run/v0.1\"\n        }\n      ],\n      \"functionaries\": [\n        {\n          \"type\": \"publickey\",\n          \"publickeyid\": \"build-key\"\n        }\n      ]\n    }\n  }\n}\n```\n\n**Witness Run Command:**\n```bash\nwitness run --step build \\\n  --attestations material,commandrun \\\n  --outfile build-attestation.json \\\n  --key signing-key.pem \\\n  -- <your-build-command>\n```\n\n**Rego Validation Rules:**\n```rego\n\n```\n\n**Verification:**\n```bash\nwitness verify \\\n  --policy policy-signed.json \\\n  --publickey policy-key.pub \\\n  -a build-attestation.json \\\n  --subject <artifact>\n```\n"}]}
{"messages": [{"role": "system", "content": "You are an expert in the Witness supply chain attestation framework. You help users instrument CI/CD pipelines with witness, create policy documents, and write Rego policies to validate attestations. You understand all attestors in go-witness and how to use them effectively."}, {"role": "user", "content": "How do I create a multi-step witness policy for a build \u2192 test \u2192 package pipeline?"}, {"role": "assistant", "content": "Here's a complete multi-step witness policy for your pipeline:\n\n**Policy Document:**\n```json\n{\n  \"expires\": \"2026-11-08T10:52:59Z\",\n  \"publickeys\": {\n    \"ci-key\": {\n      \"keyid\": \"sha256:95574695aa4fd5f5ffdb732333b60c8dc69d5a575b62ed109529e44ca0b638eb\",\n      \"key\": \"-----BEGIN PUBLIC KEY-----\\n...\\n-----END PUBLIC KEY-----\"\n    }\n  },\n  \"steps\": {\n    \"build\": {\n      \"name\": \"build\",\n      \"attestations\": [\n        {\n          \"type\": \"https://witness.dev/attestations/git/v0.1\"\n        },\n        {\n          \"type\": \"https://witness.dev/attestations/command-run/v0.1\"\n        },\n        {\n          \"type\": \"https://witness.dev/attestations/product/v0.1\"\n        }\n      ],\n      \"functionaries\": [\n        {\n          \"type\": \"publickey\",\n          \"publickeyid\": \"ci-key\"\n        }\n      ]\n    },\n    \"test\": {\n      \"name\": \"test\",\n      \"attestations\": [\n        {\n          \"type\": \"https://witness.dev/attestations/material/v0.1\"\n        },\n        {\n          \"type\": \"https://witness.dev/attestations/command-run/v0.1\"\n        }\n      ],\n      \"functionaries\": [\n        {\n          \"type\": \"publickey\",\n          \"publickeyid\": \"ci-key\"\n        }\n      ]\n    },\n    \"package\": {\n      \"name\": \"package\",\n      \"attestations\": [\n        {\n          \"type\": \"https://witness.dev/attestations/material/v0.1\"\n        },\n        {\n          \"type\": \"https://witness.dev/attestations/product/v0.1\"\n        }\n      ],\n      \"functionaries\": [\n        {\n          \"type\": \"publickey\",\n          \"publickeyid\": \"ci-key\"\n        }\n      ]\n    }\n  }\n}\n```\n\n**Pipeline Commands:**\n\n```bash\n# Step 1: Build\nwitness run --step build \\\n  --attestations git,commandrun,product \\\n  -o build.json --key ci-key.pem \\\n  -- go build -o myapp\n\n# Step 2: Test\nwitness run --step test \\\n  --attestations material,commandrun \\\n  -o test.json --key ci-key.pem \\\n  -- go test ./...\n\n# Step 3: Package\nwitness run --step package \\\n  --attestations material,product \\\n  -o package.json --key ci-key.pem \\\n  -- tar czf myapp.tar.gz myapp\n\n# Verify entire pipeline\nwitness verify \\\n  --policy policy-signed.json \\\n  --publickey policy-key.pub \\\n  -a build.json -a test.json -a package.json\n```\n"}]}
{"messages": [{"role": "system", "content": "You are an expert in the Witness supply chain attestation framework. You help users instrument CI/CD pipelines with witness, create policy documents, and write Rego policies to validate attestations. You understand all attestors in go-witness and how to use them effectively."}, {"role": "user", "content": "How do I create a witness policy for a build step that uses these attestors: product, github, commandrun, git, environment?"}, {"role": "assistant", "content": "Here's a complete witness policy for your build step with product, github, commandrun, git, environment attestors:\n\n**Policy Document:**\n```json\n{\n  \"expires\": \"2026-11-08T10:52:59Z\",\n  \"publickeys\": {\n    \"build-key\": {\n      \"keyid\": \"sha256:49b327b355a3d96cb6c07a6a6448b91471c2e59369309addb67e2813eb088a9e\",\n      \"key\": \"-----BEGIN PUBLIC KEY-----\\n...\\n-----END PUBLIC KEY-----\"\n    }\n  },\n  \"steps\": {\n    \"build\": {\n      \"name\": \"build\",\n      \"attestations\": [\n        {\n          \"type\": \"https://witness.dev/attestations/product/v0.1\"\n        },\n        {\n          \"type\": \"https://witness.dev/attestations/github/v0.1\"\n        },\n        {\n          \"type\": \"https://witness.dev/attestations/command-run/v0.1\"\n        },\n        {\n          \"type\": \"https://witness.dev/attestations/git/v0.1\"\n        },\n        {\n          \"type\": \"https://witness.dev/attestations/environment/v0.1\"\n        }\n      ],\n      \"functionaries\": [\n        {\n          \"type\": \"publickey\",\n          \"publickeyid\": \"build-key\"\n        }\n      ]\n    }\n  }\n}\n```\n\n**Witness Run Command:**\n```bash\nwitness run --step build \\\n  --attestations product,github,commandrun,git,environment \\\n  --outfile build-attestation.json \\\n  --key signing-key.pem \\\n  -- <your-build-command>\n```\n\n**Rego Validation Rules:**\n```rego\n\n```\n\n**Verification:**\n```bash\nwitness verify \\\n  --policy policy-signed.json \\\n  --publickey policy-key.pub \\\n  -a build-attestation.json \\\n  --subject <artifact>\n```\n"}]}
{"messages": [{"role": "system", "content": "You are an expert in the Witness supply chain attestation framework. You help users instrument CI/CD pipelines with witness, create policy documents, and write Rego policies to validate attestations. You understand all attestors in go-witness and how to use them effectively."}, {"role": "user", "content": "How do I create a witness policy for a build step that uses these attestors: material?"}, {"role": "assistant", "content": "Here's a complete witness policy for your build step with material attestors:\n\n**Policy Document:**\n```json\n{\n  \"expires\": \"2026-11-08T10:52:59Z\",\n  \"publickeys\": {\n    \"build-key\": {\n      \"keyid\": \"sha256:bbbf791dfc8ba61d34568f165783e048dca4bf2e8242578a6b1c6f62b50e7d21\",\n      \"key\": \"-----BEGIN PUBLIC KEY-----\\n...\\n-----END PUBLIC KEY-----\"\n    }\n  },\n  \"steps\": {\n    \"build\": {\n      \"name\": \"build\",\n      \"attestations\": [\n        {\n          \"type\": \"https://witness.dev/attestations/material/v0.1\"\n        }\n      ],\n      \"functionaries\": [\n        {\n          \"type\": \"publickey\",\n          \"publickeyid\": \"build-key\"\n        }\n      ]\n    }\n  }\n}\n```\n\n**Witness Run Command:**\n```bash\nwitness run --step build \\\n  --attestations material \\\n  --outfile build-attestation.json \\\n  --key signing-key.pem \\\n  -- <your-build-command>\n```\n\n**Rego Validation Rules:**\n```rego\n\n```\n\n**Verification:**\n```bash\nwitness verify \\\n  --policy policy-signed.json \\\n  --publickey policy-key.pub \\\n  -a build-attestation.json \\\n  --subject <artifact>\n```\n"}]}
{"messages": [{"role": "system", "content": "You are an expert in the Witness supply chain attestation framework. You help users instrument CI/CD pipelines with witness, create policy documents, and write Rego policies to validate attestations. You understand all attestors in go-witness and how to use them effectively."}, {"role": "user", "content": "How do I create a witness policy for a build step that uses these attestors: material, git, product?"}, {"role": "assistant", "content": "Here's a complete witness policy for your build step with material, git, product attestors:\n\n**Policy Document:**\n```json\n{\n  \"expires\": \"2026-11-08T10:52:59Z\",\n  \"publickeys\": {\n    \"build-key\": {\n      \"keyid\": \"sha256:b3fbe86f49766a7c67136c485fcba0e23ea72a12ca968ca11fd5941292a905aa\",\n      \"key\": \"-----BEGIN PUBLIC KEY-----\\n...\\n-----END PUBLIC KEY-----\"\n    }\n  },\n  \"steps\": {\n    \"build\": {\n      \"name\": \"build\",\n      \"attestations\": [\n        {\n          \"type\": \"https://witness.dev/attestations/material/v0.1\"\n        },\n        {\n          \"type\": \"https://witness.dev/attestations/git/v0.1\"\n        },\n        {\n          \"type\": \"https://witness.dev/attestations/product/v0.1\"\n        }\n      ],\n      \"functionaries\": [\n        {\n          \"type\": \"publickey\",\n          \"publickeyid\": \"build-key\"\n        }\n      ]\n    }\n  }\n}\n```\n\n**Witness Run Command:**\n```bash\nwitness run --step build \\\n  --attestations material,git,product \\\n  --outfile build-attestation.json \\\n  --key signing-key.pem \\\n  -- <your-build-command>\n```\n\n**Rego Validation Rules:**\n```rego\n\n```\n\n**Verification:**\n```bash\nwitness verify \\\n  --policy policy-signed.json \\\n  --publickey policy-key.pub \\\n  -a build-attestation.json \\\n  --subject <artifact>\n```\n"}]}
{"messages": [{"role": "system", "content": "You are an expert in the Witness supply chain attestation framework. You help users instrument CI/CD pipelines with witness, create policy documents, and write Rego policies to validate attestations. You understand all attestors in go-witness and how to use them effectively."}, {"role": "user", "content": "How do I create a witness policy for a build step that uses these attestors: git, github?"}, {"role": "assistant", "content": "Here's a complete witness policy for your build step with git, github attestors:\n\n**Policy Document:**\n```json\n{\n  \"expires\": \"2026-11-08T10:52:59Z\",\n  \"publickeys\": {\n    \"build-key\": {\n      \"keyid\": \"sha256:ff68f6755f1eaf3e2d7cbce8bcbb2838c752ca42f67fdd87d07b62219909f993\",\n      \"key\": \"-----BEGIN PUBLIC KEY-----\\n...\\n-----END PUBLIC KEY-----\"\n    }\n  },\n  \"steps\": {\n    \"build\": {\n      \"name\": \"build\",\n      \"attestations\": [\n        {\n          \"type\": \"https://witness.dev/attestations/git/v0.1\"\n        },\n        {\n          \"type\": \"https://witness.dev/attestations/github/v0.1\"\n        }\n      ],\n      \"functionaries\": [\n        {\n          \"type\": \"publickey\",\n          \"publickeyid\": \"build-key\"\n        }\n      ]\n    }\n  }\n}\n```\n\n**Witness Run Command:**\n```bash\nwitness run --step build \\\n  --attestations git,github \\\n  --outfile build-attestation.json \\\n  --key signing-key.pem \\\n  -- <your-build-command>\n```\n\n**Rego Validation Rules:**\n```rego\npackage git\n\nimport rego.v1\n\n# Enforce builds from specific branch\ndeny contains msg if {\n    input.branch != \"feature/auth\"\n    msg := sprintf(\"Must build from feature/auth branch, got: %s\", [input.branch])\n}\n\n# Validate commit author\napproved_authors := {\n    \"alice.smith@example.com\",\n    \"bob.jones@company.com\",\n    \"ci-bot@company.com\"\n}\n\ndeny contains msg if {\n    not input.authoremail in approved_authors\n    msg := sprintf(\"Unauthorized commit author: %s\", [input.authoremail])\n}\n```\n\n**Verification:**\n```bash\nwitness verify \\\n  --policy policy-signed.json \\\n  --publickey policy-key.pub \\\n  -a build-attestation.json \\\n  --subject <artifact>\n```\n"}]}
{"messages": [{"role": "system", "content": "You are an expert in the Witness supply chain attestation framework. You help users instrument CI/CD pipelines with witness, create policy documents, and write Rego policies to validate attestations. You understand all attestors in go-witness and how to use them effectively."}, {"role": "user", "content": "How do I create a multi-step witness policy for a build \u2192 test \u2192 package pipeline?"}, {"role": "assistant", "content": "Here's a complete multi-step witness policy for your pipeline:\n\n**Policy Document:**\n```json\n{\n  \"expires\": \"2026-11-08T10:52:59Z\",\n  \"publickeys\": {\n    \"ci-key\": {\n      \"keyid\": \"sha256:7521a26a6a8593b9fcdba47435e1abe55cf173457f50d4e4a798321b64667c9b\",\n      \"key\": \"-----BEGIN PUBLIC KEY-----\\n...\\n-----END PUBLIC KEY-----\"\n    }\n  },\n  \"steps\": {\n    \"build\": {\n      \"name\": \"build\",\n      \"attestations\": [\n        {\n          \"type\": \"https://witness.dev/attestations/git/v0.1\"\n        },\n        {\n          \"type\": \"https://witness.dev/attestations/command-run/v0.1\"\n        },\n        {\n          \"type\": \"https://witness.dev/attestations/product/v0.1\"\n        }\n      ],\n      \"functionaries\": [\n        {\n          \"type\": \"publickey\",\n          \"publickeyid\": \"ci-key\"\n        }\n      ]\n    },\n    \"test\": {\n      \"name\": \"test\",\n      \"attestations\": [\n        {\n          \"type\": \"https://witness.dev/attestations/material/v0.1\"\n        },\n        {\n          \"type\": \"https://witness.dev/attestations/command-run/v0.1\"\n        }\n      ],\n      \"functionaries\": [\n        {\n          \"type\": \"publickey\",\n          \"publickeyid\": \"ci-key\"\n        }\n      ]\n    },\n    \"package\": {\n      \"name\": \"package\",\n      \"attestations\": [\n        {\n          \"type\": \"https://witness.dev/attestations/material/v0.1\"\n        },\n        {\n          \"type\": \"https://witness.dev/attestations/product/v0.1\"\n        }\n      ],\n      \"functionaries\": [\n        {\n          \"type\": \"publickey\",\n          \"publickeyid\": \"ci-key\"\n        }\n      ]\n    }\n  }\n}\n```\n\n**Pipeline Commands:**\n\n```bash\n# Step 1: Build\nwitness run --step build \\\n  --attestations git,commandrun,product \\\n  -o build.json --key ci-key.pem \\\n  -- go build -o myapp\n\n# Step 2: Test\nwitness run --step test \\\n  --attestations material,commandrun \\\n  -o test.json --key ci-key.pem \\\n  -- go test ./...\n\n# Step 3: Package\nwitness run --step package \\\n  --attestations material,product \\\n  -o package.json --key ci-key.pem \\\n  -- tar czf myapp.tar.gz myapp\n\n# Verify entire pipeline\nwitness verify \\\n  --policy policy-signed.json \\\n  --publickey policy-key.pub \\\n  -a build.json -a test.json -a package.json\n```\n"}]}
{"messages": [{"role": "system", "content": "You are an expert in the Witness supply chain attestation framework. You help users instrument CI/CD pipelines with witness, create policy documents, and write Rego policies to validate attestations. You understand all attestors in go-witness and how to use them effectively."}, {"role": "user", "content": "How do I create a witness policy for a build step that uses these attestors: commandrun, material, product, github?"}, {"role": "assistant", "content": "Here's a complete witness policy for your build step with commandrun, material, product, github attestors:\n\n**Policy Document:**\n```json\n{\n  \"expires\": \"2026-11-08T10:52:59Z\",\n  \"publickeys\": {\n    \"build-key\": {\n      \"keyid\": \"sha256:02c6b5bd357535edf3c43ff28a9ee2e5a96da80ea7b0bc3cffe26901bc62617f\",\n      \"key\": \"-----BEGIN PUBLIC KEY-----\\n...\\n-----END PUBLIC KEY-----\"\n    }\n  },\n  \"steps\": {\n    \"build\": {\n      \"name\": \"build\",\n      \"attestations\": [\n        {\n          \"type\": \"https://witness.dev/attestations/command-run/v0.1\"\n        },\n        {\n          \"type\": \"https://witness.dev/attestations/material/v0.1\"\n        },\n        {\n          \"type\": \"https://witness.dev/attestations/product/v0.1\"\n        },\n        {\n          \"type\": \"https://witness.dev/attestations/github/v0.1\"\n        }\n      ],\n      \"functionaries\": [\n        {\n          \"type\": \"publickey\",\n          \"publickeyid\": \"build-key\"\n        }\n      ]\n    }\n  }\n}\n```\n\n**Witness Run Command:**\n```bash\nwitness run --step build \\\n  --attestations commandrun,material,product,github \\\n  --outfile build-attestation.json \\\n  --key signing-key.pem \\\n  -- <your-build-command>\n```\n\n**Rego Validation Rules:**\n```rego\n\n```\n\n**Verification:**\n```bash\nwitness verify \\\n  --policy policy-signed.json \\\n  --publickey policy-key.pub \\\n  -a build-attestation.json \\\n  --subject <artifact>\n```\n"}]}
{"messages": [{"role": "system", "content": "You are an expert in the Witness supply chain attestation framework. You help users instrument CI/CD pipelines with witness, create policy documents, and write Rego policies to validate attestations. You understand all attestors in go-witness and how to use them effectively."}, {"role": "user", "content": "How do I create a witness policy for a build step that uses these attestors: commandrun?"}, {"role": "assistant", "content": "Here's a complete witness policy for your build step with commandrun attestors:\n\n**Policy Document:**\n```json\n{\n  \"expires\": \"2026-11-08T10:52:59Z\",\n  \"publickeys\": {\n    \"build-key\": {\n      \"keyid\": \"sha256:a7a6c4f7c201794d8868d3691b86e175d3e76e7b82106094843a56ab1a296213\",\n      \"key\": \"-----BEGIN PUBLIC KEY-----\\n...\\n-----END PUBLIC KEY-----\"\n    }\n  },\n  \"steps\": {\n    \"build\": {\n      \"name\": \"build\",\n      \"attestations\": [\n        {\n          \"type\": \"https://witness.dev/attestations/command-run/v0.1\"\n        }\n      ],\n      \"functionaries\": [\n        {\n          \"type\": \"publickey\",\n          \"publickeyid\": \"build-key\"\n        }\n      ]\n    }\n  }\n}\n```\n\n**Witness Run Command:**\n```bash\nwitness run --step build \\\n  --attestations commandrun \\\n  --outfile build-attestation.json \\\n  --key signing-key.pem \\\n  -- <your-build-command>\n```\n\n**Rego Validation Rules:**\n```rego\n\n```\n\n**Verification:**\n```bash\nwitness verify \\\n  --policy policy-signed.json \\\n  --publickey policy-key.pub \\\n  -a build-attestation.json \\\n  --subject <artifact>\n```\n"}]}
{"messages": [{"role": "system", "content": "You are an expert in the Witness supply chain attestation framework. You help users instrument CI/CD pipelines with witness, create policy documents, and write Rego policies to validate attestations. You understand all attestors in go-witness and how to use them effectively."}, {"role": "user", "content": "How do I create a multi-step witness policy for a build \u2192 test \u2192 package pipeline?"}, {"role": "assistant", "content": "Here's a complete multi-step witness policy for your pipeline:\n\n**Policy Document:**\n```json\n{\n  \"expires\": \"2026-11-08T10:52:59Z\",\n  \"publickeys\": {\n    \"ci-key\": {\n      \"keyid\": \"sha256:5543f953365e4e6d9cc1638d04d82859e22fe729114e012d2dbf10ad9c0d4994\",\n      \"key\": \"-----BEGIN PUBLIC KEY-----\\n...\\n-----END PUBLIC KEY-----\"\n    }\n  },\n  \"steps\": {\n    \"build\": {\n      \"name\": \"build\",\n      \"attestations\": [\n        {\n          \"type\": \"https://witness.dev/attestations/git/v0.1\"\n        },\n        {\n          \"type\": \"https://witness.dev/attestations/command-run/v0.1\"\n        },\n        {\n          \"type\": \"https://witness.dev/attestations/product/v0.1\"\n        }\n      ],\n      \"functionaries\": [\n        {\n          \"type\": \"publickey\",\n          \"publickeyid\": \"ci-key\"\n        }\n      ]\n    },\n    \"test\": {\n      \"name\": \"test\",\n      \"attestations\": [\n        {\n          \"type\": \"https://witness.dev/attestations/material/v0.1\"\n        },\n        {\n          \"type\": \"https://witness.dev/attestations/command-run/v0.1\"\n        }\n      ],\n      \"functionaries\": [\n        {\n          \"type\": \"publickey\",\n          \"publickeyid\": \"ci-key\"\n        }\n      ]\n    },\n    \"package\": {\n      \"name\": \"package\",\n      \"attestations\": [\n        {\n          \"type\": \"https://witness.dev/attestations/material/v0.1\"\n        },\n        {\n          \"type\": \"https://witness.dev/attestations/product/v0.1\"\n        }\n      ],\n      \"functionaries\": [\n        {\n          \"type\": \"publickey\",\n          \"publickeyid\": \"ci-key\"\n        }\n      ]\n    }\n  }\n}\n```\n\n**Pipeline Commands:**\n\n```bash\n# Step 1: Build\nwitness run --step build \\\n  --attestations git,commandrun,product \\\n  -o build.json --key ci-key.pem \\\n  -- go build -o myapp\n\n# Step 2: Test\nwitness run --step test \\\n  --attestations material,commandrun \\\n  -o test.json --key ci-key.pem \\\n  -- go test ./...\n\n# Step 3: Package\nwitness run --step package \\\n  --attestations material,product \\\n  -o package.json --key ci-key.pem \\\n  -- tar czf myapp.tar.gz myapp\n\n# Verify entire pipeline\nwitness verify \\\n  --policy policy-signed.json \\\n  --publickey policy-key.pub \\\n  -a build.json -a test.json -a package.json\n```\n"}]}
{"messages": [{"role": "system", "content": "You are an expert in the Witness supply chain attestation framework. You help users instrument CI/CD pipelines with witness, create policy documents, and write Rego policies to validate attestations. You understand all attestors in go-witness and how to use them effectively."}, {"role": "user", "content": "How do I create a witness policy for a build step that uses these attestors: github, product?"}, {"role": "assistant", "content": "Here's a complete witness policy for your build step with github, product attestors:\n\n**Policy Document:**\n```json\n{\n  \"expires\": \"2026-11-08T10:52:59Z\",\n  \"publickeys\": {\n    \"build-key\": {\n      \"keyid\": \"sha256:fce18f3d17469e689196d138a441c255430b95a840d96741a2f3a9a37a88ade8\",\n      \"key\": \"-----BEGIN PUBLIC KEY-----\\n...\\n-----END PUBLIC KEY-----\"\n    }\n  },\n  \"steps\": {\n    \"build\": {\n      \"name\": \"build\",\n      \"attestations\": [\n        {\n          \"type\": \"https://witness.dev/attestations/github/v0.1\"\n        },\n        {\n          \"type\": \"https://witness.dev/attestations/product/v0.1\"\n        }\n      ],\n      \"functionaries\": [\n        {\n          \"type\": \"publickey\",\n          \"publickeyid\": \"build-key\"\n        }\n      ]\n    }\n  }\n}\n```\n\n**Witness Run Command:**\n```bash\nwitness run --step build \\\n  --attestations github,product \\\n  --outfile build-attestation.json \\\n  --key signing-key.pem \\\n  -- <your-build-command>\n```\n\n**Rego Validation Rules:**\n```rego\n\n```\n\n**Verification:**\n```bash\nwitness verify \\\n  --policy policy-signed.json \\\n  --publickey policy-key.pub \\\n  -a build-attestation.json \\\n  --subject <artifact>\n```\n"}]}
{"messages": [{"role": "system", "content": "You are an expert in the Witness supply chain attestation framework. You help users instrument CI/CD pipelines with witness, create policy documents, and write Rego policies to validate attestations. You understand all attestors in go-witness and how to use them effectively."}, {"role": "user", "content": "How do I create a multi-step witness policy for a build \u2192 test \u2192 package pipeline?"}, {"role": "assistant", "content": "Here's a complete multi-step witness policy for your pipeline:\n\n**Policy Document:**\n```json\n{\n  \"expires\": \"2026-11-08T10:52:59Z\",\n  \"publickeys\": {\n    \"ci-key\": {\n      \"keyid\": \"sha256:a97d22f3822714f28a8e2105fc710e7c5fc39494c2ecf826ed253ec2adc8658e\",\n      \"key\": \"-----BEGIN PUBLIC KEY-----\\n...\\n-----END PUBLIC KEY-----\"\n    }\n  },\n  \"steps\": {\n    \"build\": {\n      \"name\": \"build\",\n      \"attestations\": [\n        {\n          \"type\": \"https://witness.dev/attestations/git/v0.1\"\n        },\n        {\n          \"type\": \"https://witness.dev/attestations/command-run/v0.1\"\n        },\n        {\n          \"type\": \"https://witness.dev/attestations/product/v0.1\"\n        }\n      ],\n      \"functionaries\": [\n        {\n          \"type\": \"publickey\",\n          \"publickeyid\": \"ci-key\"\n        }\n      ]\n    },\n    \"test\": {\n      \"name\": \"test\",\n      \"attestations\": [\n        {\n          \"type\": \"https://witness.dev/attestations/material/v0.1\"\n        },\n        {\n          \"type\": \"https://witness.dev/attestations/command-run/v0.1\"\n        }\n      ],\n      \"functionaries\": [\n        {\n          \"type\": \"publickey\",\n          \"publickeyid\": \"ci-key\"\n        }\n      ]\n    },\n    \"package\": {\n      \"name\": \"package\",\n      \"attestations\": [\n        {\n          \"type\": \"https://witness.dev/attestations/material/v0.1\"\n        },\n        {\n          \"type\": \"https://witness.dev/attestations/product/v0.1\"\n        }\n      ],\n      \"functionaries\": [\n        {\n          \"type\": \"publickey\",\n          \"publickeyid\": \"ci-key\"\n        }\n      ]\n    }\n  }\n}\n```\n\n**Pipeline Commands:**\n\n```bash\n# Step 1: Build\nwitness run --step build \\\n  --attestations git,commandrun,product \\\n  -o build.json --key ci-key.pem \\\n  -- go build -o myapp\n\n# Step 2: Test\nwitness run --step test \\\n  --attestations material,commandrun \\\n  -o test.json --key ci-key.pem \\\n  -- go test ./...\n\n# Step 3: Package\nwitness run --step package \\\n  --attestations material,product \\\n  -o package.json --key ci-key.pem \\\n  -- tar czf myapp.tar.gz myapp\n\n# Verify entire pipeline\nwitness verify \\\n  --policy policy-signed.json \\\n  --publickey policy-key.pub \\\n  -a build.json -a test.json -a package.json\n```\n"}]}
{"messages": [{"role": "system", "content": "You are an expert in the Witness supply chain attestation framework. You help users instrument CI/CD pipelines with witness, create policy documents, and write Rego policies to validate attestations. You understand all attestors in go-witness and how to use them effectively."}, {"role": "user", "content": "How do I create a witness policy for a build step that uses these attestors: material, commandrun, git, github?"}, {"role": "assistant", "content": "Here's a complete witness policy for your build step with material, commandrun, git, github attestors:\n\n**Policy Document:**\n```json\n{\n  \"expires\": \"2026-11-08T10:52:59Z\",\n  \"publickeys\": {\n    \"build-key\": {\n      \"keyid\": \"sha256:cfd39f4de5af5896a05a84c87bd7f320dac8960da12bf2376c65575884a2277a\",\n      \"key\": \"-----BEGIN PUBLIC KEY-----\\n...\\n-----END PUBLIC KEY-----\"\n    }\n  },\n  \"steps\": {\n    \"build\": {\n      \"name\": \"build\",\n      \"attestations\": [\n        {\n          \"type\": \"https://witness.dev/attestations/material/v0.1\"\n        },\n        {\n          \"type\": \"https://witness.dev/attestations/command-run/v0.1\"\n        },\n        {\n          \"type\": \"https://witness.dev/attestations/git/v0.1\"\n        },\n        {\n          \"type\": \"https://witness.dev/attestations/github/v0.1\"\n        }\n      ],\n      \"functionaries\": [\n        {\n          \"type\": \"publickey\",\n          \"publickeyid\": \"build-key\"\n        }\n      ]\n    }\n  }\n}\n```\n\n**Witness Run Command:**\n```bash\nwitness run --step build \\\n  --attestations material,commandrun,git,github \\\n  --outfile build-attestation.json \\\n  --key signing-key.pem \\\n  -- <your-build-command>\n```\n\n**Rego Validation Rules:**\n```rego\n\n```\n\n**Verification:**\n```bash\nwitness verify \\\n  --policy policy-signed.json \\\n  --publickey policy-key.pub \\\n  -a build-attestation.json \\\n  --subject <artifact>\n```\n"}]}
{"messages": [{"role": "system", "content": "You are an expert in the Witness supply chain attestation framework. You help users instrument CI/CD pipelines with witness, create policy documents, and write Rego policies to validate attestations. You understand all attestors in go-witness and how to use them effectively."}, {"role": "user", "content": "How do I create a multi-step witness policy for a build \u2192 test \u2192 package pipeline?"}, {"role": "assistant", "content": "Here's a complete multi-step witness policy for your pipeline:\n\n**Policy Document:**\n```json\n{\n  \"expires\": \"2026-11-08T10:52:59Z\",\n  \"publickeys\": {\n    \"ci-key\": {\n      \"keyid\": \"sha256:dadbb6f7310a6a38939cba7db5106f02139db313af0634291e96cfddcd3bc076\",\n      \"key\": \"-----BEGIN PUBLIC KEY-----\\n...\\n-----END PUBLIC KEY-----\"\n    }\n  },\n  \"steps\": {\n    \"build\": {\n      \"name\": \"build\",\n      \"attestations\": [\n        {\n          \"type\": \"https://witness.dev/attestations/git/v0.1\"\n        },\n        {\n          \"type\": \"https://witness.dev/attestations/command-run/v0.1\"\n        },\n        {\n          \"type\": \"https://witness.dev/attestations/product/v0.1\"\n        }\n      ],\n      \"functionaries\": [\n        {\n          \"type\": \"publickey\",\n          \"publickeyid\": \"ci-key\"\n        }\n      ]\n    },\n    \"test\": {\n      \"name\": \"test\",\n      \"attestations\": [\n        {\n          \"type\": \"https://witness.dev/attestations/material/v0.1\"\n        },\n        {\n          \"type\": \"https://witness.dev/attestations/command-run/v0.1\"\n        }\n      ],\n      \"functionaries\": [\n        {\n          \"type\": \"publickey\",\n          \"publickeyid\": \"ci-key\"\n        }\n      ]\n    },\n    \"package\": {\n      \"name\": \"package\",\n      \"attestations\": [\n        {\n          \"type\": \"https://witness.dev/attestations/material/v0.1\"\n        },\n        {\n          \"type\": \"https://witness.dev/attestations/product/v0.1\"\n        }\n      ],\n      \"functionaries\": [\n        {\n          \"type\": \"publickey\",\n          \"publickeyid\": \"ci-key\"\n        }\n      ]\n    }\n  }\n}\n```\n\n**Pipeline Commands:**\n\n```bash\n# Step 1: Build\nwitness run --step build \\\n  --attestations git,commandrun,product \\\n  -o build.json --key ci-key.pem \\\n  -- go build -o myapp\n\n# Step 2: Test\nwitness run --step test \\\n  --attestations material,commandrun \\\n  -o test.json --key ci-key.pem \\\n  -- go test ./...\n\n# Step 3: Package\nwitness run --step package \\\n  --attestations material,product \\\n  -o package.json --key ci-key.pem \\\n  -- tar czf myapp.tar.gz myapp\n\n# Verify entire pipeline\nwitness verify \\\n  --policy policy-signed.json \\\n  --publickey policy-key.pub \\\n  -a build.json -a test.json -a package.json\n```\n"}]}
{"messages": [{"role": "system", "content": "You are an expert in the Witness supply chain attestation framework. You help users instrument CI/CD pipelines with witness, create policy documents, and write Rego policies to validate attestations. You understand all attestors in go-witness and how to use them effectively."}, {"role": "user", "content": "How do I create a witness policy for a build step that uses these attestors: product, environment, material?"}, {"role": "assistant", "content": "Here's a complete witness policy for your build step with product, environment, material attestors:\n\n**Policy Document:**\n```json\n{\n  \"expires\": \"2026-11-08T10:52:59Z\",\n  \"publickeys\": {\n    \"build-key\": {\n      \"keyid\": \"sha256:6f741918960a1cf369bcfcd04737382b12729fa53c36dfcd2c56098ffdee89ad\",\n      \"key\": \"-----BEGIN PUBLIC KEY-----\\n...\\n-----END PUBLIC KEY-----\"\n    }\n  },\n  \"steps\": {\n    \"build\": {\n      \"name\": \"build\",\n      \"attestations\": [\n        {\n          \"type\": \"https://witness.dev/attestations/product/v0.1\"\n        },\n        {\n          \"type\": \"https://witness.dev/attestations/environment/v0.1\"\n        },\n        {\n          \"type\": \"https://witness.dev/attestations/material/v0.1\"\n        }\n      ],\n      \"functionaries\": [\n        {\n          \"type\": \"publickey\",\n          \"publickeyid\": \"build-key\"\n        }\n      ]\n    }\n  }\n}\n```\n\n**Witness Run Command:**\n```bash\nwitness run --step build \\\n  --attestations product,environment,material \\\n  --outfile build-attestation.json \\\n  --key signing-key.pem \\\n  -- <your-build-command>\n```\n\n**Rego Validation Rules:**\n```rego\n\n```\n\n**Verification:**\n```bash\nwitness verify \\\n  --policy policy-signed.json \\\n  --publickey policy-key.pub \\\n  -a build-attestation.json \\\n  --subject <artifact>\n```\n"}]}
{"messages": [{"role": "system", "content": "You are an expert in the Witness supply chain attestation framework. You help users instrument CI/CD pipelines with witness, create policy documents, and write Rego policies to validate attestations. You understand all attestors in go-witness and how to use them effectively."}, {"role": "user", "content": "How do I create a witness policy for a build step that uses these attestors: git?"}, {"role": "assistant", "content": "Here's a complete witness policy for your build step with git attestors:\n\n**Policy Document:**\n```json\n{\n  \"expires\": \"2026-11-08T10:52:59Z\",\n  \"publickeys\": {\n    \"build-key\": {\n      \"keyid\": \"sha256:0adf8101351a07252b8e07590517ec6b687399b187a41aa7aec5723e7d0963fe\",\n      \"key\": \"-----BEGIN PUBLIC KEY-----\\n...\\n-----END PUBLIC KEY-----\"\n    }\n  },\n  \"steps\": {\n    \"build\": {\n      \"name\": \"build\",\n      \"attestations\": [\n        {\n          \"type\": \"https://witness.dev/attestations/git/v0.1\"\n        }\n      ],\n      \"functionaries\": [\n        {\n          \"type\": \"publickey\",\n          \"publickeyid\": \"build-key\"\n        }\n      ]\n    }\n  }\n}\n```\n\n**Witness Run Command:**\n```bash\nwitness run --step build \\\n  --attestations git \\\n  --outfile build-attestation.json \\\n  --key signing-key.pem \\\n  -- <your-build-command>\n```\n\n**Rego Validation Rules:**\n```rego\npackage git\n\nimport rego.v1\n\n# Enforce builds from specific branch\ndeny contains msg if {\n    input.branch != \"feature/auth\"\n    msg := sprintf(\"Must build from feature/auth branch, got: %s\", [input.branch])\n}\n\n# Require clean working directory\ndeny contains msg if {\n    count(input.status) > 0\n    msg := \"Working directory must be clean (no uncommitted changes)\"\n}\n\n# Validate commit author\napproved_authors := {\n    \"alice.smith@example.com\",\n    \"bob.jones@company.com\",\n    \"ci-bot@company.com\"\n}\n\ndeny contains msg if {\n    not input.authoremail in approved_authors\n    msg := sprintf(\"Unauthorized commit author: %s\", [input.authoremail])\n}\n```\n\n**Verification:**\n```bash\nwitness verify \\\n  --policy policy-signed.json \\\n  --publickey policy-key.pub \\\n  -a build-attestation.json \\\n  --subject <artifact>\n```\n"}]}
{"messages": [{"role": "system", "content": "You are an expert in the Witness supply chain attestation framework. You help users instrument CI/CD pipelines with witness, create policy documents, and write Rego policies to validate attestations. You understand all attestors in go-witness and how to use them effectively."}, {"role": "user", "content": "How do I create a witness policy for a build step that uses these attestors: commandrun, github?"}, {"role": "assistant", "content": "Here's a complete witness policy for your build step with commandrun, github attestors:\n\n**Policy Document:**\n```json\n{\n  \"expires\": \"2026-11-08T10:52:59Z\",\n  \"publickeys\": {\n    \"build-key\": {\n      \"keyid\": \"sha256:b933dce54ccbe076c3e578b007dd56cd4534a89ad5f65861caeb45952f743228\",\n      \"key\": \"-----BEGIN PUBLIC KEY-----\\n...\\n-----END PUBLIC KEY-----\"\n    }\n  },\n  \"steps\": {\n    \"build\": {\n      \"name\": \"build\",\n      \"attestations\": [\n        {\n          \"type\": \"https://witness.dev/attestations/command-run/v0.1\"\n        },\n        {\n          \"type\": \"https://witness.dev/attestations/github/v0.1\"\n        }\n      ],\n      \"functionaries\": [\n        {\n          \"type\": \"publickey\",\n          \"publickeyid\": \"build-key\"\n        }\n      ]\n    }\n  }\n}\n```\n\n**Witness Run Command:**\n```bash\nwitness run --step build \\\n  --attestations commandrun,github \\\n  --outfile build-attestation.json \\\n  --key signing-key.pem \\\n  -- <your-build-command>\n```\n\n**Rego Validation Rules:**\n```rego\n\n```\n\n**Verification:**\n```bash\nwitness verify \\\n  --policy policy-signed.json \\\n  --publickey policy-key.pub \\\n  -a build-attestation.json \\\n  --subject <artifact>\n```\n"}]}
{"messages": [{"role": "system", "content": "You are an expert in the Witness supply chain attestation framework. You help users instrument CI/CD pipelines with witness, create policy documents, and write Rego policies to validate attestations. You understand all attestors in go-witness and how to use them effectively."}, {"role": "user", "content": "How do I create a multi-step witness policy for a build \u2192 test \u2192 package pipeline?"}, {"role": "assistant", "content": "Here's a complete multi-step witness policy for your pipeline:\n\n**Policy Document:**\n```json\n{\n  \"expires\": \"2026-11-08T10:52:59Z\",\n  \"publickeys\": {\n    \"ci-key\": {\n      \"keyid\": \"sha256:2807c20f552d931d7d395a8313b6f2006d6185af0b0f728cc1351f491f5b9f41\",\n      \"key\": \"-----BEGIN PUBLIC KEY-----\\n...\\n-----END PUBLIC KEY-----\"\n    }\n  },\n  \"steps\": {\n    \"build\": {\n      \"name\": \"build\",\n      \"attestations\": [\n        {\n          \"type\": \"https://witness.dev/attestations/git/v0.1\"\n        },\n        {\n          \"type\": \"https://witness.dev/attestations/command-run/v0.1\"\n        },\n        {\n          \"type\": \"https://witness.dev/attestations/product/v0.1\"\n        }\n      ],\n      \"functionaries\": [\n        {\n          \"type\": \"publickey\",\n          \"publickeyid\": \"ci-key\"\n        }\n      ]\n    },\n    \"test\": {\n      \"name\": \"test\",\n      \"attestations\": [\n        {\n          \"type\": \"https://witness.dev/attestations/material/v0.1\"\n        },\n        {\n          \"type\": \"https://witness.dev/attestations/command-run/v0.1\"\n        }\n      ],\n      \"functionaries\": [\n        {\n          \"type\": \"publickey\",\n          \"publickeyid\": \"ci-key\"\n        }\n      ]\n    },\n    \"package\": {\n      \"name\": \"package\",\n      \"attestations\": [\n        {\n          \"type\": \"https://witness.dev/attestations/material/v0.1\"\n        },\n        {\n          \"type\": \"https://witness.dev/attestations/product/v0.1\"\n        }\n      ],\n      \"functionaries\": [\n        {\n          \"type\": \"publickey\",\n          \"publickeyid\": \"ci-key\"\n        }\n      ]\n    }\n  }\n}\n```\n\n**Pipeline Commands:**\n\n```bash\n# Step 1: Build\nwitness run --step build \\\n  --attestations git,commandrun,product \\\n  -o build.json --key ci-key.pem \\\n  -- go build -o myapp\n\n# Step 2: Test\nwitness run --step test \\\n  --attestations material,commandrun \\\n  -o test.json --key ci-key.pem \\\n  -- go test ./...\n\n# Step 3: Package\nwitness run --step package \\\n  --attestations material,product \\\n  -o package.json --key ci-key.pem \\\n  -- tar czf myapp.tar.gz myapp\n\n# Verify entire pipeline\nwitness verify \\\n  --policy policy-signed.json \\\n  --publickey policy-key.pub \\\n  -a build.json -a test.json -a package.json\n```\n"}]}
{"messages": [{"role": "system", "content": "You are an expert in the Witness supply chain attestation framework. You help users instrument CI/CD pipelines with witness, create policy documents, and write Rego policies to validate attestations. You understand all attestors in go-witness and how to use them effectively."}, {"role": "user", "content": "How do I create a witness policy for a build step that uses these attestors: github, commandrun?"}, {"role": "assistant", "content": "Here's a complete witness policy for your build step with github, commandrun attestors:\n\n**Policy Document:**\n```json\n{\n  \"expires\": \"2026-11-08T10:52:59Z\",\n  \"publickeys\": {\n    \"build-key\": {\n      \"keyid\": \"sha256:4a76878b3cadfd8dfd2d3f0784337b2a806e2bbc83477581eb1f73576dfefa21\",\n      \"key\": \"-----BEGIN PUBLIC KEY-----\\n...\\n-----END PUBLIC KEY-----\"\n    }\n  },\n  \"steps\": {\n    \"build\": {\n      \"name\": \"build\",\n      \"attestations\": [\n        {\n          \"type\": \"https://witness.dev/attestations/github/v0.1\"\n        },\n        {\n          \"type\": \"https://witness.dev/attestations/command-run/v0.1\"\n        }\n      ],\n      \"functionaries\": [\n        {\n          \"type\": \"publickey\",\n          \"publickeyid\": \"build-key\"\n        }\n      ]\n    }\n  }\n}\n```\n\n**Witness Run Command:**\n```bash\nwitness run --step build \\\n  --attestations github,commandrun \\\n  --outfile build-attestation.json \\\n  --key signing-key.pem \\\n  -- <your-build-command>\n```\n\n**Rego Validation Rules:**\n```rego\n\n```\n\n**Verification:**\n```bash\nwitness verify \\\n  --policy policy-signed.json \\\n  --publickey policy-key.pub \\\n  -a build-attestation.json \\\n  --subject <artifact>\n```\n"}]}
{"messages": [{"role": "system", "content": "You are an expert in the Witness supply chain attestation framework. You help users instrument CI/CD pipelines with witness, create policy documents, and write Rego policies to validate attestations. You understand all attestors in go-witness and how to use them effectively."}, {"role": "user", "content": "How do I create a witness policy for a build step that uses these attestors: environment, material?"}, {"role": "assistant", "content": "Here's a complete witness policy for your build step with environment, material attestors:\n\n**Policy Document:**\n```json\n{\n  \"expires\": \"2026-11-08T10:52:59Z\",\n  \"publickeys\": {\n    \"build-key\": {\n      \"keyid\": \"sha256:53c94b4bab33ffcc6b20f74fd46992e56cd8b881174a7c0de6ca8515eee56f5e\",\n      \"key\": \"-----BEGIN PUBLIC KEY-----\\n...\\n-----END PUBLIC KEY-----\"\n    }\n  },\n  \"steps\": {\n    \"build\": {\n      \"name\": \"build\",\n      \"attestations\": [\n        {\n          \"type\": \"https://witness.dev/attestations/environment/v0.1\"\n        },\n        {\n          \"type\": \"https://witness.dev/attestations/material/v0.1\"\n        }\n      ],\n      \"functionaries\": [\n        {\n          \"type\": \"publickey\",\n          \"publickeyid\": \"build-key\"\n        }\n      ]\n    }\n  }\n}\n```\n\n**Witness Run Command:**\n```bash\nwitness run --step build \\\n  --attestations environment,material \\\n  --outfile build-attestation.json \\\n  --key signing-key.pem \\\n  -- <your-build-command>\n```\n\n**Rego Validation Rules:**\n```rego\npackage environment\n\nimport rego.v1\n\n# Ensure correct OS\ndeny contains msg if {\n    input.os != \"linux\"\n    msg := sprintf(\"Must run on linux, got: %s\", [input.os])\n}\n\n# Require CI environment\ndeny contains msg if {\n    not \"CI\" in input.variables\n    msg := \"Must run in CI environment (CI variable not set)\"\n}\n```\n\n**Verification:**\n```bash\nwitness verify \\\n  --policy policy-signed.json \\\n  --publickey policy-key.pub \\\n  -a build-attestation.json \\\n  --subject <artifact>\n```\n"}]}
{"messages": [{"role": "system", "content": "You are an expert in the Witness supply chain attestation framework. You help users instrument CI/CD pipelines with witness, create policy documents, and write Rego policies to validate attestations. You understand all attestors in go-witness and how to use them effectively."}, {"role": "user", "content": "How do I create a multi-step witness policy for a build \u2192 test \u2192 package pipeline?"}, {"role": "assistant", "content": "Here's a complete multi-step witness policy for your pipeline:\n\n**Policy Document:**\n```json\n{\n  \"expires\": \"2026-11-08T10:52:59Z\",\n  \"publickeys\": {\n    \"ci-key\": {\n      \"keyid\": \"sha256:633ddecde881dd85935734a830bab6691cdb971dd7da2600a50e9d1a33ea6ff5\",\n      \"key\": \"-----BEGIN PUBLIC KEY-----\\n...\\n-----END PUBLIC KEY-----\"\n    }\n  },\n  \"steps\": {\n    \"build\": {\n      \"name\": \"build\",\n      \"attestations\": [\n        {\n          \"type\": \"https://witness.dev/attestations/git/v0.1\"\n        },\n        {\n          \"type\": \"https://witness.dev/attestations/command-run/v0.1\"\n        },\n        {\n          \"type\": \"https://witness.dev/attestations/product/v0.1\"\n        }\n      ],\n      \"functionaries\": [\n        {\n          \"type\": \"publickey\",\n          \"publickeyid\": \"ci-key\"\n        }\n      ]\n    },\n    \"test\": {\n      \"name\": \"test\",\n      \"attestations\": [\n        {\n          \"type\": \"https://witness.dev/attestations/material/v0.1\"\n        },\n        {\n          \"type\": \"https://witness.dev/attestations/command-run/v0.1\"\n        }\n      ],\n      \"functionaries\": [\n        {\n          \"type\": \"publickey\",\n          \"publickeyid\": \"ci-key\"\n        }\n      ]\n    },\n    \"package\": {\n      \"name\": \"package\",\n      \"attestations\": [\n        {\n          \"type\": \"https://witness.dev/attestations/material/v0.1\"\n        },\n        {\n          \"type\": \"https://witness.dev/attestations/product/v0.1\"\n        }\n      ],\n      \"functionaries\": [\n        {\n          \"type\": \"publickey\",\n          \"publickeyid\": \"ci-key\"\n        }\n      ]\n    }\n  }\n}\n```\n\n**Pipeline Commands:**\n\n```bash\n# Step 1: Build\nwitness run --step build \\\n  --attestations git,commandrun,product \\\n  -o build.json --key ci-key.pem \\\n  -- go build -o myapp\n\n# Step 2: Test\nwitness run --step test \\\n  --attestations material,commandrun \\\n  -o test.json --key ci-key.pem \\\n  -- go test ./...\n\n# Step 3: Package\nwitness run --step package \\\n  --attestations material,product \\\n  -o package.json --key ci-key.pem \\\n  -- tar czf myapp.tar.gz myapp\n\n# Verify entire pipeline\nwitness verify \\\n  --policy policy-signed.json \\\n  --publickey policy-key.pub \\\n  -a build.json -a test.json -a package.json\n```\n"}]}
{"messages": [{"role": "system", "content": "You are an expert in the Witness supply chain attestation framework. You help users instrument CI/CD pipelines with witness, create policy documents, and write Rego policies to validate attestations. You understand all attestors in go-witness and how to use them effectively."}, {"role": "user", "content": "How do I create a multi-step witness policy for a build \u2192 test \u2192 package pipeline?"}, {"role": "assistant", "content": "Here's a complete multi-step witness policy for your pipeline:\n\n**Policy Document:**\n```json\n{\n  \"expires\": \"2026-11-08T10:52:59Z\",\n  \"publickeys\": {\n    \"ci-key\": {\n      \"keyid\": \"sha256:a6b95f563cee7be3936604e4655af00049668e6493130e7c26286890dced2d1d\",\n      \"key\": \"-----BEGIN PUBLIC KEY-----\\n...\\n-----END PUBLIC KEY-----\"\n    }\n  },\n  \"steps\": {\n    \"build\": {\n      \"name\": \"build\",\n      \"attestations\": [\n        {\n          \"type\": \"https://witness.dev/attestations/git/v0.1\"\n        },\n        {\n          \"type\": \"https://witness.dev/attestations/command-run/v0.1\"\n        },\n        {\n          \"type\": \"https://witness.dev/attestations/product/v0.1\"\n        }\n      ],\n      \"functionaries\": [\n        {\n          \"type\": \"publickey\",\n          \"publickeyid\": \"ci-key\"\n        }\n      ]\n    },\n    \"test\": {\n      \"name\": \"test\",\n      \"attestations\": [\n        {\n          \"type\": \"https://witness.dev/attestations/material/v0.1\"\n        },\n        {\n          \"type\": \"https://witness.dev/attestations/command-run/v0.1\"\n        }\n      ],\n      \"functionaries\": [\n        {\n          \"type\": \"publickey\",\n          \"publickeyid\": \"ci-key\"\n        }\n      ]\n    },\n    \"package\": {\n      \"name\": \"package\",\n      \"attestations\": [\n        {\n          \"type\": \"https://witness.dev/attestations/material/v0.1\"\n        },\n        {\n          \"type\": \"https://witness.dev/attestations/product/v0.1\"\n        }\n      ],\n      \"functionaries\": [\n        {\n          \"type\": \"publickey\",\n          \"publickeyid\": \"ci-key\"\n        }\n      ]\n    }\n  }\n}\n```\n\n**Pipeline Commands:**\n\n```bash\n# Step 1: Build\nwitness run --step build \\\n  --attestations git,commandrun,product \\\n  -o build.json --key ci-key.pem \\\n  -- go build -o myapp\n\n# Step 2: Test\nwitness run --step test \\\n  --attestations material,commandrun \\\n  -o test.json --key ci-key.pem \\\n  -- go test ./...\n\n# Step 3: Package\nwitness run --step package \\\n  --attestations material,product \\\n  -o package.json --key ci-key.pem \\\n  -- tar czf myapp.tar.gz myapp\n\n# Verify entire pipeline\nwitness verify \\\n  --policy policy-signed.json \\\n  --publickey policy-key.pub \\\n  -a build.json -a test.json -a package.json\n```\n"}]}
{"messages": [{"role": "system", "content": "You are an expert in the Witness supply chain attestation framework. You help users instrument CI/CD pipelines with witness, create policy documents, and write Rego policies to validate attestations. You understand all attestors in go-witness and how to use them effectively."}, {"role": "user", "content": "How do I create a witness policy for a build step that uses these attestors: github, material, environment?"}, {"role": "assistant", "content": "Here's a complete witness policy for your build step with github, material, environment attestors:\n\n**Policy Document:**\n```json\n{\n  \"expires\": \"2026-11-08T10:52:59Z\",\n  \"publickeys\": {\n    \"build-key\": {\n      \"keyid\": \"sha256:89db968a97ceb644a5ec40a5ae30b490205befa53535befc9afb95aaba947c50\",\n      \"key\": \"-----BEGIN PUBLIC KEY-----\\n...\\n-----END PUBLIC KEY-----\"\n    }\n  },\n  \"steps\": {\n    \"build\": {\n      \"name\": \"build\",\n      \"attestations\": [\n        {\n          \"type\": \"https://witness.dev/attestations/github/v0.1\"\n        },\n        {\n          \"type\": \"https://witness.dev/attestations/material/v0.1\"\n        },\n        {\n          \"type\": \"https://witness.dev/attestations/environment/v0.1\"\n        }\n      ],\n      \"functionaries\": [\n        {\n          \"type\": \"publickey\",\n          \"publickeyid\": \"build-key\"\n        }\n      ]\n    }\n  }\n}\n```\n\n**Witness Run Command:**\n```bash\nwitness run --step build \\\n  --attestations github,material,environment \\\n  --outfile build-attestation.json \\\n  --key signing-key.pem \\\n  -- <your-build-command>\n```\n\n**Rego Validation Rules:**\n```rego\n\n```\n\n**Verification:**\n```bash\nwitness verify \\\n  --policy policy-signed.json \\\n  --publickey policy-key.pub \\\n  -a build-attestation.json \\\n  --subject <artifact>\n```\n"}]}
{"messages": [{"role": "system", "content": "You are an expert in the Witness supply chain attestation framework. You help users instrument CI/CD pipelines with witness, create policy documents, and write Rego policies to validate attestations. You understand all attestors in go-witness and how to use them effectively."}, {"role": "user", "content": "How do I create a multi-step witness policy for a build \u2192 test \u2192 package pipeline?"}, {"role": "assistant", "content": "Here's a complete multi-step witness policy for your pipeline:\n\n**Policy Document:**\n```json\n{\n  \"expires\": \"2026-11-08T10:52:59Z\",\n  \"publickeys\": {\n    \"ci-key\": {\n      \"keyid\": \"sha256:ef4c98583b6494db71522c353aff488c8a3d966358cf918a0c674339fa1182ee\",\n      \"key\": \"-----BEGIN PUBLIC KEY-----\\n...\\n-----END PUBLIC KEY-----\"\n    }\n  },\n  \"steps\": {\n    \"build\": {\n      \"name\": \"build\",\n      \"attestations\": [\n        {\n          \"type\": \"https://witness.dev/attestations/git/v0.1\"\n        },\n        {\n          \"type\": \"https://witness.dev/attestations/command-run/v0.1\"\n        },\n        {\n          \"type\": \"https://witness.dev/attestations/product/v0.1\"\n        }\n      ],\n      \"functionaries\": [\n        {\n          \"type\": \"publickey\",\n          \"publickeyid\": \"ci-key\"\n        }\n      ]\n    },\n    \"test\": {\n      \"name\": \"test\",\n      \"attestations\": [\n        {\n          \"type\": \"https://witness.dev/attestations/material/v0.1\"\n        },\n        {\n          \"type\": \"https://witness.dev/attestations/command-run/v0.1\"\n        }\n      ],\n      \"functionaries\": [\n        {\n          \"type\": \"publickey\",\n          \"publickeyid\": \"ci-key\"\n        }\n      ]\n    },\n    \"package\": {\n      \"name\": \"package\",\n      \"attestations\": [\n        {\n          \"type\": \"https://witness.dev/attestations/material/v0.1\"\n        },\n        {\n          \"type\": \"https://witness.dev/attestations/product/v0.1\"\n        }\n      ],\n      \"functionaries\": [\n        {\n          \"type\": \"publickey\",\n          \"publickeyid\": \"ci-key\"\n        }\n      ]\n    }\n  }\n}\n```\n\n**Pipeline Commands:**\n\n```bash\n# Step 1: Build\nwitness run --step build \\\n  --attestations git,commandrun,product \\\n  -o build.json --key ci-key.pem \\\n  -- go build -o myapp\n\n# Step 2: Test\nwitness run --step test \\\n  --attestations material,commandrun \\\n  -o test.json --key ci-key.pem \\\n  -- go test ./...\n\n# Step 3: Package\nwitness run --step package \\\n  --attestations material,product \\\n  -o package.json --key ci-key.pem \\\n  -- tar czf myapp.tar.gz myapp\n\n# Verify entire pipeline\nwitness verify \\\n  --policy policy-signed.json \\\n  --publickey policy-key.pub \\\n  -a build.json -a test.json -a package.json\n```\n"}]}
{"messages": [{"role": "system", "content": "You are an expert in the Witness supply chain attestation framework. You help users instrument CI/CD pipelines with witness, create policy documents, and write Rego policies to validate attestations. You understand all attestors in go-witness and how to use them effectively."}, {"role": "user", "content": "How do I create a witness policy for a build step that uses these attestors: commandrun?"}, {"role": "assistant", "content": "Here's a complete witness policy for your build step with commandrun attestors:\n\n**Policy Document:**\n```json\n{\n  \"expires\": \"2026-11-08T10:52:59Z\",\n  \"publickeys\": {\n    \"build-key\": {\n      \"keyid\": \"sha256:b118f4c603dc1f2f1d8c2c4bdad48d951679a83d5dd9c5e7c2148ee92f85c30c\",\n      \"key\": \"-----BEGIN PUBLIC KEY-----\\n...\\n-----END PUBLIC KEY-----\"\n    }\n  },\n  \"steps\": {\n    \"build\": {\n      \"name\": \"build\",\n      \"attestations\": [\n        {\n          \"type\": \"https://witness.dev/attestations/command-run/v0.1\"\n        }\n      ],\n      \"functionaries\": [\n        {\n          \"type\": \"publickey\",\n          \"publickeyid\": \"build-key\"\n        }\n      ]\n    }\n  }\n}\n```\n\n**Witness Run Command:**\n```bash\nwitness run --step build \\\n  --attestations commandrun \\\n  --outfile build-attestation.json \\\n  --key signing-key.pem \\\n  -- <your-build-command>\n```\n\n**Rego Validation Rules:**\n```rego\n\n```\n\n**Verification:**\n```bash\nwitness verify \\\n  --policy policy-signed.json \\\n  --publickey policy-key.pub \\\n  -a build-attestation.json \\\n  --subject <artifact>\n```\n"}]}
{"messages": [{"role": "system", "content": "You are an expert in the Witness supply chain attestation framework. You help users instrument CI/CD pipelines with witness, create policy documents, and write Rego policies to validate attestations. You understand all attestors in go-witness and how to use them effectively."}, {"role": "user", "content": "How do I create a multi-step witness policy for a build \u2192 test \u2192 package pipeline?"}, {"role": "assistant", "content": "Here's a complete multi-step witness policy for your pipeline:\n\n**Policy Document:**\n```json\n{\n  \"expires\": \"2026-11-08T10:52:59Z\",\n  \"publickeys\": {\n    \"ci-key\": {\n      \"keyid\": \"sha256:be2bac1f342ee0cdc7a09a6481692084806b2bf2d7f745eecc926de9c90f6367\",\n      \"key\": \"-----BEGIN PUBLIC KEY-----\\n...\\n-----END PUBLIC KEY-----\"\n    }\n  },\n  \"steps\": {\n    \"build\": {\n      \"name\": \"build\",\n      \"attestations\": [\n        {\n          \"type\": \"https://witness.dev/attestations/git/v0.1\"\n        },\n        {\n          \"type\": \"https://witness.dev/attestations/command-run/v0.1\"\n        },\n        {\n          \"type\": \"https://witness.dev/attestations/product/v0.1\"\n        }\n      ],\n      \"functionaries\": [\n        {\n          \"type\": \"publickey\",\n          \"publickeyid\": \"ci-key\"\n        }\n      ]\n    },\n    \"test\": {\n      \"name\": \"test\",\n      \"attestations\": [\n        {\n          \"type\": \"https://witness.dev/attestations/material/v0.1\"\n        },\n        {\n          \"type\": \"https://witness.dev/attestations/command-run/v0.1\"\n        }\n      ],\n      \"functionaries\": [\n        {\n          \"type\": \"publickey\",\n          \"publickeyid\": \"ci-key\"\n        }\n      ]\n    },\n    \"package\": {\n      \"name\": \"package\",\n      \"attestations\": [\n        {\n          \"type\": \"https://witness.dev/attestations/material/v0.1\"\n        },\n        {\n          \"type\": \"https://witness.dev/attestations/product/v0.1\"\n        }\n      ],\n      \"functionaries\": [\n        {\n          \"type\": \"publickey\",\n          \"publickeyid\": \"ci-key\"\n        }\n      ]\n    }\n  }\n}\n```\n\n**Pipeline Commands:**\n\n```bash\n# Step 1: Build\nwitness run --step build \\\n  --attestations git,commandrun,product \\\n  -o build.json --key ci-key.pem \\\n  -- go build -o myapp\n\n# Step 2: Test\nwitness run --step test \\\n  --attestations material,commandrun \\\n  -o test.json --key ci-key.pem \\\n  -- go test ./...\n\n# Step 3: Package\nwitness run --step package \\\n  --attestations material,product \\\n  -o package.json --key ci-key.pem \\\n  -- tar czf myapp.tar.gz myapp\n\n# Verify entire pipeline\nwitness verify \\\n  --policy policy-signed.json \\\n  --publickey policy-key.pub \\\n  -a build.json -a test.json -a package.json\n```\n"}]}
{"messages": [{"role": "system", "content": "You are an expert in the Witness supply chain attestation framework. You help users instrument CI/CD pipelines with witness, create policy documents, and write Rego policies to validate attestations. You understand all attestors in go-witness and how to use them effectively."}, {"role": "user", "content": "How do I create a witness policy for a build step that uses these attestors: git, github, product, material, commandrun?"}, {"role": "assistant", "content": "Here's a complete witness policy for your build step with git, github, product, material, commandrun attestors:\n\n**Policy Document:**\n```json\n{\n  \"expires\": \"2026-11-08T10:52:59Z\",\n  \"publickeys\": {\n    \"build-key\": {\n      \"keyid\": \"sha256:da5abe22637004d6bb5f2b6535b033b1fc2729bddf6fd4dc8d18029ac7db9b2b\",\n      \"key\": \"-----BEGIN PUBLIC KEY-----\\n...\\n-----END PUBLIC KEY-----\"\n    }\n  },\n  \"steps\": {\n    \"build\": {\n      \"name\": \"build\",\n      \"attestations\": [\n        {\n          \"type\": \"https://witness.dev/attestations/git/v0.1\"\n        },\n        {\n          \"type\": \"https://witness.dev/attestations/github/v0.1\"\n        },\n        {\n          \"type\": \"https://witness.dev/attestations/product/v0.1\"\n        },\n        {\n          \"type\": \"https://witness.dev/attestations/material/v0.1\"\n        },\n        {\n          \"type\": \"https://witness.dev/attestations/command-run/v0.1\"\n        }\n      ],\n      \"functionaries\": [\n        {\n          \"type\": \"publickey\",\n          \"publickeyid\": \"build-key\"\n        }\n      ]\n    }\n  }\n}\n```\n\n**Witness Run Command:**\n```bash\nwitness run --step build \\\n  --attestations git,github,product,material,commandrun \\\n  --outfile build-attestation.json \\\n  --key signing-key.pem \\\n  -- <your-build-command>\n```\n\n**Rego Validation Rules:**\n```rego\npackage git\n\nimport rego.v1\n\n# Enforce builds from specific branch\ndeny contains msg if {\n    input.branch != \"develop\"\n    msg := sprintf(\"Must build from develop branch, got: %s\", [input.branch])\n}\n\n# Validate commit author\napproved_authors := {\n    \"alice.smith@example.com\",\n    \"bob.jones@company.com\",\n    \"ci-bot@company.com\"\n}\n\ndeny contains msg if {\n    not input.authoremail in approved_authors\n    msg := sprintf(\"Unauthorized commit author: %s\", [input.authoremail])\n}\n```\n\n**Verification:**\n```bash\nwitness verify \\\n  --policy policy-signed.json \\\n  --publickey policy-key.pub \\\n  -a build-attestation.json \\\n  --subject <artifact>\n```\n"}]}
{"messages": [{"role": "system", "content": "You are an expert in the Witness supply chain attestation framework. You help users instrument CI/CD pipelines with witness, create policy documents, and write Rego policies to validate attestations. You understand all attestors in go-witness and how to use them effectively."}, {"role": "user", "content": "How do I create a multi-step witness policy for a build \u2192 test \u2192 package pipeline?"}, {"role": "assistant", "content": "Here's a complete multi-step witness policy for your pipeline:\n\n**Policy Document:**\n```json\n{\n  \"expires\": \"2026-11-08T10:52:59Z\",\n  \"publickeys\": {\n    \"ci-key\": {\n      \"keyid\": \"sha256:e167db82cb8a7844f2462a6d25754a0ca85afb72572f00c098162a7af8eded69\",\n      \"key\": \"-----BEGIN PUBLIC KEY-----\\n...\\n-----END PUBLIC KEY-----\"\n    }\n  },\n  \"steps\": {\n    \"build\": {\n      \"name\": \"build\",\n      \"attestations\": [\n        {\n          \"type\": \"https://witness.dev/attestations/git/v0.1\"\n        },\n        {\n          \"type\": \"https://witness.dev/attestations/command-run/v0.1\"\n        },\n        {\n          \"type\": \"https://witness.dev/attestations/product/v0.1\"\n        }\n      ],\n      \"functionaries\": [\n        {\n          \"type\": \"publickey\",\n          \"publickeyid\": \"ci-key\"\n        }\n      ]\n    },\n    \"test\": {\n      \"name\": \"test\",\n      \"attestations\": [\n        {\n          \"type\": \"https://witness.dev/attestations/material/v0.1\"\n        },\n        {\n          \"type\": \"https://witness.dev/attestations/command-run/v0.1\"\n        }\n      ],\n      \"functionaries\": [\n        {\n          \"type\": \"publickey\",\n          \"publickeyid\": \"ci-key\"\n        }\n      ]\n    },\n    \"package\": {\n      \"name\": \"package\",\n      \"attestations\": [\n        {\n          \"type\": \"https://witness.dev/attestations/material/v0.1\"\n        },\n        {\n          \"type\": \"https://witness.dev/attestations/product/v0.1\"\n        }\n      ],\n      \"functionaries\": [\n        {\n          \"type\": \"publickey\",\n          \"publickeyid\": \"ci-key\"\n        }\n      ]\n    }\n  }\n}\n```\n\n**Pipeline Commands:**\n\n```bash\n# Step 1: Build\nwitness run --step build \\\n  --attestations git,commandrun,product \\\n  -o build.json --key ci-key.pem \\\n  -- go build -o myapp\n\n# Step 2: Test\nwitness run --step test \\\n  --attestations material,commandrun \\\n  -o test.json --key ci-key.pem \\\n  -- go test ./...\n\n# Step 3: Package\nwitness run --step package \\\n  --attestations material,product \\\n  -o package.json --key ci-key.pem \\\n  -- tar czf myapp.tar.gz myapp\n\n# Verify entire pipeline\nwitness verify \\\n  --policy policy-signed.json \\\n  --publickey policy-key.pub \\\n  -a build.json -a test.json -a package.json\n```\n"}]}
{"messages": [{"role": "system", "content": "You are an expert in the Witness supply chain attestation framework. You help users instrument CI/CD pipelines with witness, create policy documents, and write Rego policies to validate attestations. You understand all attestors in go-witness and how to use them effectively."}, {"role": "user", "content": "How do I create a multi-step witness policy for a build \u2192 test \u2192 package pipeline?"}, {"role": "assistant", "content": "Here's a complete multi-step witness policy for your pipeline:\n\n**Policy Document:**\n```json\n{\n  \"expires\": \"2026-11-08T10:52:59Z\",\n  \"publickeys\": {\n    \"ci-key\": {\n      \"keyid\": \"sha256:45000dc47793982b71e9bd83573f4fd1306a6d38c6fbc1d7d2ebd59f95e1c276\",\n      \"key\": \"-----BEGIN PUBLIC KEY-----\\n...\\n-----END PUBLIC KEY-----\"\n    }\n  },\n  \"steps\": {\n    \"build\": {\n      \"name\": \"build\",\n      \"attestations\": [\n        {\n          \"type\": \"https://witness.dev/attestations/git/v0.1\"\n        },\n        {\n          \"type\": \"https://witness.dev/attestations/command-run/v0.1\"\n        },\n        {\n          \"type\": \"https://witness.dev/attestations/product/v0.1\"\n        }\n      ],\n      \"functionaries\": [\n        {\n          \"type\": \"publickey\",\n          \"publickeyid\": \"ci-key\"\n        }\n      ]\n    },\n    \"test\": {\n      \"name\": \"test\",\n      \"attestations\": [\n        {\n          \"type\": \"https://witness.dev/attestations/material/v0.1\"\n        },\n        {\n          \"type\": \"https://witness.dev/attestations/command-run/v0.1\"\n        }\n      ],\n      \"functionaries\": [\n        {\n          \"type\": \"publickey\",\n          \"publickeyid\": \"ci-key\"\n        }\n      ]\n    },\n    \"package\": {\n      \"name\": \"package\",\n      \"attestations\": [\n        {\n          \"type\": \"https://witness.dev/attestations/material/v0.1\"\n        },\n        {\n          \"type\": \"https://witness.dev/attestations/product/v0.1\"\n        }\n      ],\n      \"functionaries\": [\n        {\n          \"type\": \"publickey\",\n          \"publickeyid\": \"ci-key\"\n        }\n      ]\n    }\n  }\n}\n```\n\n**Pipeline Commands:**\n\n```bash\n# Step 1: Build\nwitness run --step build \\\n  --attestations git,commandrun,product \\\n  -o build.json --key ci-key.pem \\\n  -- go build -o myapp\n\n# Step 2: Test\nwitness run --step test \\\n  --attestations material,commandrun \\\n  -o test.json --key ci-key.pem \\\n  -- go test ./...\n\n# Step 3: Package\nwitness run --step package \\\n  --attestations material,product \\\n  -o package.json --key ci-key.pem \\\n  -- tar czf myapp.tar.gz myapp\n\n# Verify entire pipeline\nwitness verify \\\n  --policy policy-signed.json \\\n  --publickey policy-key.pub \\\n  -a build.json -a test.json -a package.json\n```\n"}]}
{"messages": [{"role": "system", "content": "You are an expert in the Witness supply chain attestation framework. You help users instrument CI/CD pipelines with witness, create policy documents, and write Rego policies to validate attestations. You understand all attestors in go-witness and how to use them effectively."}, {"role": "user", "content": "How do I create a witness policy for a build step that uses these attestors: environment, commandrun, github, product?"}, {"role": "assistant", "content": "Here's a complete witness policy for your build step with environment, commandrun, github, product attestors:\n\n**Policy Document:**\n```json\n{\n  \"expires\": \"2026-11-08T10:52:59Z\",\n  \"publickeys\": {\n    \"build-key\": {\n      \"keyid\": \"sha256:ac673deeb3170c0cfa4a1c31579153c6b55a6e7ef754934b73cc9d9ca89e1bd7\",\n      \"key\": \"-----BEGIN PUBLIC KEY-----\\n...\\n-----END PUBLIC KEY-----\"\n    }\n  },\n  \"steps\": {\n    \"build\": {\n      \"name\": \"build\",\n      \"attestations\": [\n        {\n          \"type\": \"https://witness.dev/attestations/environment/v0.1\"\n        },\n        {\n          \"type\": \"https://witness.dev/attestations/command-run/v0.1\"\n        },\n        {\n          \"type\": \"https://witness.dev/attestations/github/v0.1\"\n        },\n        {\n          \"type\": \"https://witness.dev/attestations/product/v0.1\"\n        }\n      ],\n      \"functionaries\": [\n        {\n          \"type\": \"publickey\",\n          \"publickeyid\": \"build-key\"\n        }\n      ]\n    }\n  }\n}\n```\n\n**Witness Run Command:**\n```bash\nwitness run --step build \\\n  --attestations environment,commandrun,github,product \\\n  --outfile build-attestation.json \\\n  --key signing-key.pem \\\n  -- <your-build-command>\n```\n\n**Rego Validation Rules:**\n```rego\npackage environment\n\nimport rego.v1\n\n# Ensure correct OS\ndeny contains msg if {\n    input.os != \"linux\"\n    msg := sprintf(\"Must run on linux, got: %s\", [input.os])\n}\n\n# Require CI environment\ndeny contains msg if {\n    not \"CI\" in input.variables\n    msg := \"Must run in CI environment (CI variable not set)\"\n}\n```\n\n**Verification:**\n```bash\nwitness verify \\\n  --policy policy-signed.json \\\n  --publickey policy-key.pub \\\n  -a build-attestation.json \\\n  --subject <artifact>\n```\n"}]}
{"messages": [{"role": "system", "content": "You are an expert in the Witness supply chain attestation framework. You help users instrument CI/CD pipelines with witness, create policy documents, and write Rego policies to validate attestations. You understand all attestors in go-witness and how to use them effectively."}, {"role": "user", "content": "How do I create a witness policy for a build step that uses these attestors: commandrun?"}, {"role": "assistant", "content": "Here's a complete witness policy for your build step with commandrun attestors:\n\n**Policy Document:**\n```json\n{\n  \"expires\": \"2026-11-08T10:52:59Z\",\n  \"publickeys\": {\n    \"build-key\": {\n      \"keyid\": \"sha256:797b5e426792f0998741d7ad394a8ca73f6012b5a9f9efa8c32d76476b47da4a\",\n      \"key\": \"-----BEGIN PUBLIC KEY-----\\n...\\n-----END PUBLIC KEY-----\"\n    }\n  },\n  \"steps\": {\n    \"build\": {\n      \"name\": \"build\",\n      \"attestations\": [\n        {\n          \"type\": \"https://witness.dev/attestations/command-run/v0.1\"\n        }\n      ],\n      \"functionaries\": [\n        {\n          \"type\": \"publickey\",\n          \"publickeyid\": \"build-key\"\n        }\n      ]\n    }\n  }\n}\n```\n\n**Witness Run Command:**\n```bash\nwitness run --step build \\\n  --attestations commandrun \\\n  --outfile build-attestation.json \\\n  --key signing-key.pem \\\n  -- <your-build-command>\n```\n\n**Rego Validation Rules:**\n```rego\n\n```\n\n**Verification:**\n```bash\nwitness verify \\\n  --policy policy-signed.json \\\n  --publickey policy-key.pub \\\n  -a build-attestation.json \\\n  --subject <artifact>\n```\n"}]}
{"messages": [{"role": "system", "content": "You are an expert in the Witness supply chain attestation framework. You help users instrument CI/CD pipelines with witness, create policy documents, and write Rego policies to validate attestations. You understand all attestors in go-witness and how to use them effectively."}, {"role": "user", "content": "How do I create a witness policy for a build step that uses these attestors: environment, github, git, commandrun, material?"}, {"role": "assistant", "content": "Here's a complete witness policy for your build step with environment, github, git, commandrun, material attestors:\n\n**Policy Document:**\n```json\n{\n  \"expires\": \"2026-11-08T10:52:59Z\",\n  \"publickeys\": {\n    \"build-key\": {\n      \"keyid\": \"sha256:b3cbeae10278e75292d3a3cbe2fc20aa5d25c5a4b701f06f5db749a56a5207e9\",\n      \"key\": \"-----BEGIN PUBLIC KEY-----\\n...\\n-----END PUBLIC KEY-----\"\n    }\n  },\n  \"steps\": {\n    \"build\": {\n      \"name\": \"build\",\n      \"attestations\": [\n        {\n          \"type\": \"https://witness.dev/attestations/environment/v0.1\"\n        },\n        {\n          \"type\": \"https://witness.dev/attestations/github/v0.1\"\n        },\n        {\n          \"type\": \"https://witness.dev/attestations/git/v0.1\"\n        },\n        {\n          \"type\": \"https://witness.dev/attestations/command-run/v0.1\"\n        },\n        {\n          \"type\": \"https://witness.dev/attestations/material/v0.1\"\n        }\n      ],\n      \"functionaries\": [\n        {\n          \"type\": \"publickey\",\n          \"publickeyid\": \"build-key\"\n        }\n      ]\n    }\n  }\n}\n```\n\n**Witness Run Command:**\n```bash\nwitness run --step build \\\n  --attestations environment,github,git,commandrun,material \\\n  --outfile build-attestation.json \\\n  --key signing-key.pem \\\n  -- <your-build-command>\n```\n\n**Rego Validation Rules:**\n```rego\npackage environment\n\nimport rego.v1\n\n# Ensure correct OS\ndeny contains msg if {\n    input.os != \"windows\"\n    msg := sprintf(\"Must run on windows, got: %s\", [input.os])\n}\n\n# Require CI environment\ndeny contains msg if {\n    not \"CI\" in input.variables\n    msg := \"Must run in CI environment (CI variable not set)\"\n}\n```\n\n**Verification:**\n```bash\nwitness verify \\\n  --policy policy-signed.json \\\n  --publickey policy-key.pub \\\n  -a build-attestation.json \\\n  --subject <artifact>\n```\n"}]}
{"messages": [{"role": "system", "content": "You are an expert in the Witness supply chain attestation framework. You help users instrument CI/CD pipelines with witness, create policy documents, and write Rego policies to validate attestations. You understand all attestors in go-witness and how to use them effectively."}, {"role": "user", "content": "How do I create a multi-step witness policy for a build \u2192 test \u2192 package pipeline?"}, {"role": "assistant", "content": "Here's a complete multi-step witness policy for your pipeline:\n\n**Policy Document:**\n```json\n{\n  \"expires\": \"2026-11-08T10:52:59Z\",\n  \"publickeys\": {\n    \"ci-key\": {\n      \"keyid\": \"sha256:03fa069aa1b02a69da666948ca179e3f7c3493ec44436b9f932f4ac9df352ba1\",\n      \"key\": \"-----BEGIN PUBLIC KEY-----\\n...\\n-----END PUBLIC KEY-----\"\n    }\n  },\n  \"steps\": {\n    \"build\": {\n      \"name\": \"build\",\n      \"attestations\": [\n        {\n          \"type\": \"https://witness.dev/attestations/git/v0.1\"\n        },\n        {\n          \"type\": \"https://witness.dev/attestations/command-run/v0.1\"\n        },\n        {\n          \"type\": \"https://witness.dev/attestations/product/v0.1\"\n        }\n      ],\n      \"functionaries\": [\n        {\n          \"type\": \"publickey\",\n          \"publickeyid\": \"ci-key\"\n        }\n      ]\n    },\n    \"test\": {\n      \"name\": \"test\",\n      \"attestations\": [\n        {\n          \"type\": \"https://witness.dev/attestations/material/v0.1\"\n        },\n        {\n          \"type\": \"https://witness.dev/attestations/command-run/v0.1\"\n        }\n      ],\n      \"functionaries\": [\n        {\n          \"type\": \"publickey\",\n          \"publickeyid\": \"ci-key\"\n        }\n      ]\n    },\n    \"package\": {\n      \"name\": \"package\",\n      \"attestations\": [\n        {\n          \"type\": \"https://witness.dev/attestations/material/v0.1\"\n        },\n        {\n          \"type\": \"https://witness.dev/attestations/product/v0.1\"\n        }\n      ],\n      \"functionaries\": [\n        {\n          \"type\": \"publickey\",\n          \"publickeyid\": \"ci-key\"\n        }\n      ]\n    }\n  }\n}\n```\n\n**Pipeline Commands:**\n\n```bash\n# Step 1: Build\nwitness run --step build \\\n  --attestations git,commandrun,product \\\n  -o build.json --key ci-key.pem \\\n  -- go build -o myapp\n\n# Step 2: Test\nwitness run --step test \\\n  --attestations material,commandrun \\\n  -o test.json --key ci-key.pem \\\n  -- go test ./...\n\n# Step 3: Package\nwitness run --step package \\\n  --attestations material,product \\\n  -o package.json --key ci-key.pem \\\n  -- tar czf myapp.tar.gz myapp\n\n# Verify entire pipeline\nwitness verify \\\n  --policy policy-signed.json \\\n  --publickey policy-key.pub \\\n  -a build.json -a test.json -a package.json\n```\n"}]}
{"messages": [{"role": "system", "content": "You are an expert in the Witness supply chain attestation framework. You help users instrument CI/CD pipelines with witness, create policy documents, and write Rego policies to validate attestations. You understand all attestors in go-witness and how to use them effectively."}, {"role": "user", "content": "How do I create a witness policy for a build step that uses these attestors: product, environment, material, github?"}, {"role": "assistant", "content": "Here's a complete witness policy for your build step with product, environment, material, github attestors:\n\n**Policy Document:**\n```json\n{\n  \"expires\": \"2026-11-08T10:52:59Z\",\n  \"publickeys\": {\n    \"build-key\": {\n      \"keyid\": \"sha256:9958865b431c6405ff3053f7f7ea4e55b72084ad2524fdd5d4dd4a2574f67ddb\",\n      \"key\": \"-----BEGIN PUBLIC KEY-----\\n...\\n-----END PUBLIC KEY-----\"\n    }\n  },\n  \"steps\": {\n    \"build\": {\n      \"name\": \"build\",\n      \"attestations\": [\n        {\n          \"type\": \"https://witness.dev/attestations/product/v0.1\"\n        },\n        {\n          \"type\": \"https://witness.dev/attestations/environment/v0.1\"\n        },\n        {\n          \"type\": \"https://witness.dev/attestations/material/v0.1\"\n        },\n        {\n          \"type\": \"https://witness.dev/attestations/github/v0.1\"\n        }\n      ],\n      \"functionaries\": [\n        {\n          \"type\": \"publickey\",\n          \"publickeyid\": \"build-key\"\n        }\n      ]\n    }\n  }\n}\n```\n\n**Witness Run Command:**\n```bash\nwitness run --step build \\\n  --attestations product,environment,material,github \\\n  --outfile build-attestation.json \\\n  --key signing-key.pem \\\n  -- <your-build-command>\n```\n\n**Rego Validation Rules:**\n```rego\n\n```\n\n**Verification:**\n```bash\nwitness verify \\\n  --policy policy-signed.json \\\n  --publickey policy-key.pub \\\n  -a build-attestation.json \\\n  --subject <artifact>\n```\n"}]}
{"messages": [{"role": "system", "content": "You are an expert in the Witness supply chain attestation framework. You help users instrument CI/CD pipelines with witness, create policy documents, and write Rego policies to validate attestations. You understand all attestors in go-witness and how to use them effectively."}, {"role": "user", "content": "How do I create a witness policy for a build step that uses these attestors: commandrun, environment, git, github, product?"}, {"role": "assistant", "content": "Here's a complete witness policy for your build step with commandrun, environment, git, github, product attestors:\n\n**Policy Document:**\n```json\n{\n  \"expires\": \"2026-11-08T10:52:59Z\",\n  \"publickeys\": {\n    \"build-key\": {\n      \"keyid\": \"sha256:077142cca40a7bcf8c14367bd48de16e81a23b598950c19d851c0ab438e35bd7\",\n      \"key\": \"-----BEGIN PUBLIC KEY-----\\n...\\n-----END PUBLIC KEY-----\"\n    }\n  },\n  \"steps\": {\n    \"build\": {\n      \"name\": \"build\",\n      \"attestations\": [\n        {\n          \"type\": \"https://witness.dev/attestations/command-run/v0.1\"\n        },\n        {\n          \"type\": \"https://witness.dev/attestations/environment/v0.1\"\n        },\n        {\n          \"type\": \"https://witness.dev/attestations/git/v0.1\"\n        },\n        {\n          \"type\": \"https://witness.dev/attestations/github/v0.1\"\n        },\n        {\n          \"type\": \"https://witness.dev/attestations/product/v0.1\"\n        }\n      ],\n      \"functionaries\": [\n        {\n          \"type\": \"publickey\",\n          \"publickeyid\": \"build-key\"\n        }\n      ]\n    }\n  }\n}\n```\n\n**Witness Run Command:**\n```bash\nwitness run --step build \\\n  --attestations commandrun,environment,git,github,product \\\n  --outfile build-attestation.json \\\n  --key signing-key.pem \\\n  -- <your-build-command>\n```\n\n**Rego Validation Rules:**\n```rego\n\n```\n\n**Verification:**\n```bash\nwitness verify \\\n  --policy policy-signed.json \\\n  --publickey policy-key.pub \\\n  -a build-attestation.json \\\n  --subject <artifact>\n```\n"}]}
{"messages": [{"role": "system", "content": "You are an expert in the Witness supply chain attestation framework. You help users instrument CI/CD pipelines with witness, create policy documents, and write Rego policies to validate attestations. You understand all attestors in go-witness and how to use them effectively."}, {"role": "user", "content": "How do I create a witness policy for a build step that uses these attestors: github, commandrun, material, environment?"}, {"role": "assistant", "content": "Here's a complete witness policy for your build step with github, commandrun, material, environment attestors:\n\n**Policy Document:**\n```json\n{\n  \"expires\": \"2026-11-08T10:52:59Z\",\n  \"publickeys\": {\n    \"build-key\": {\n      \"keyid\": \"sha256:bc6b456ab4583897b4a019513db0684f1b87b69e74597edfcbb23ea244587044\",\n      \"key\": \"-----BEGIN PUBLIC KEY-----\\n...\\n-----END PUBLIC KEY-----\"\n    }\n  },\n  \"steps\": {\n    \"build\": {\n      \"name\": \"build\",\n      \"attestations\": [\n        {\n          \"type\": \"https://witness.dev/attestations/github/v0.1\"\n        },\n        {\n          \"type\": \"https://witness.dev/attestations/command-run/v0.1\"\n        },\n        {\n          \"type\": \"https://witness.dev/attestations/material/v0.1\"\n        },\n        {\n          \"type\": \"https://witness.dev/attestations/environment/v0.1\"\n        }\n      ],\n      \"functionaries\": [\n        {\n          \"type\": \"publickey\",\n          \"publickeyid\": \"build-key\"\n        }\n      ]\n    }\n  }\n}\n```\n\n**Witness Run Command:**\n```bash\nwitness run --step build \\\n  --attestations github,commandrun,material,environment \\\n  --outfile build-attestation.json \\\n  --key signing-key.pem \\\n  -- <your-build-command>\n```\n\n**Rego Validation Rules:**\n```rego\n\n```\n\n**Verification:**\n```bash\nwitness verify \\\n  --policy policy-signed.json \\\n  --publickey policy-key.pub \\\n  -a build-attestation.json \\\n  --subject <artifact>\n```\n"}]}
{"messages": [{"role": "system", "content": "You are an expert in the Witness supply chain attestation framework. You help users instrument CI/CD pipelines with witness, create policy documents, and write Rego policies to validate attestations. You understand all attestors in go-witness and how to use them effectively."}, {"role": "user", "content": "How do I create a multi-step witness policy for a build \u2192 test \u2192 package pipeline?"}, {"role": "assistant", "content": "Here's a complete multi-step witness policy for your pipeline:\n\n**Policy Document:**\n```json\n{\n  \"expires\": \"2026-11-08T10:52:59Z\",\n  \"publickeys\": {\n    \"ci-key\": {\n      \"keyid\": \"sha256:bcfcfa77e9918f01a760efcd30ca0e5fcc1ce0aa1ef5baf84a6b169f34c46415\",\n      \"key\": \"-----BEGIN PUBLIC KEY-----\\n...\\n-----END PUBLIC KEY-----\"\n    }\n  },\n  \"steps\": {\n    \"build\": {\n      \"name\": \"build\",\n      \"attestations\": [\n        {\n          \"type\": \"https://witness.dev/attestations/git/v0.1\"\n        },\n        {\n          \"type\": \"https://witness.dev/attestations/command-run/v0.1\"\n        },\n        {\n          \"type\": \"https://witness.dev/attestations/product/v0.1\"\n        }\n      ],\n      \"functionaries\": [\n        {\n          \"type\": \"publickey\",\n          \"publickeyid\": \"ci-key\"\n        }\n      ]\n    },\n    \"test\": {\n      \"name\": \"test\",\n      \"attestations\": [\n        {\n          \"type\": \"https://witness.dev/attestations/material/v0.1\"\n        },\n        {\n          \"type\": \"https://witness.dev/attestations/command-run/v0.1\"\n        }\n      ],\n      \"functionaries\": [\n        {\n          \"type\": \"publickey\",\n          \"publickeyid\": \"ci-key\"\n        }\n      ]\n    },\n    \"package\": {\n      \"name\": \"package\",\n      \"attestations\": [\n        {\n          \"type\": \"https://witness.dev/attestations/material/v0.1\"\n        },\n        {\n          \"type\": \"https://witness.dev/attestations/product/v0.1\"\n        }\n      ],\n      \"functionaries\": [\n        {\n          \"type\": \"publickey\",\n          \"publickeyid\": \"ci-key\"\n        }\n      ]\n    }\n  }\n}\n```\n\n**Pipeline Commands:**\n\n```bash\n# Step 1: Build\nwitness run --step build \\\n  --attestations git,commandrun,product \\\n  -o build.json --key ci-key.pem \\\n  -- go build -o myapp\n\n# Step 2: Test\nwitness run --step test \\\n  --attestations material,commandrun \\\n  -o test.json --key ci-key.pem \\\n  -- go test ./...\n\n# Step 3: Package\nwitness run --step package \\\n  --attestations material,product \\\n  -o package.json --key ci-key.pem \\\n  -- tar czf myapp.tar.gz myapp\n\n# Verify entire pipeline\nwitness verify \\\n  --policy policy-signed.json \\\n  --publickey policy-key.pub \\\n  -a build.json -a test.json -a package.json\n```\n"}]}
{"messages": [{"role": "system", "content": "You are an expert in the Witness supply chain attestation framework. You help users instrument CI/CD pipelines with witness, create policy documents, and write Rego policies to validate attestations. You understand all attestors in go-witness and how to use them effectively."}, {"role": "user", "content": "How do I create a witness policy for a build step that uses these attestors: commandrun, environment, github?"}, {"role": "assistant", "content": "Here's a complete witness policy for your build step with commandrun, environment, github attestors:\n\n**Policy Document:**\n```json\n{\n  \"expires\": \"2026-11-08T10:52:59Z\",\n  \"publickeys\": {\n    \"build-key\": {\n      \"keyid\": \"sha256:4e06318aa51740bfb0cb883ed02f31fcd16f2052a15a46695950e9d23ac5b273\",\n      \"key\": \"-----BEGIN PUBLIC KEY-----\\n...\\n-----END PUBLIC KEY-----\"\n    }\n  },\n  \"steps\": {\n    \"build\": {\n      \"name\": \"build\",\n      \"attestations\": [\n        {\n          \"type\": \"https://witness.dev/attestations/command-run/v0.1\"\n        },\n        {\n          \"type\": \"https://witness.dev/attestations/environment/v0.1\"\n        },\n        {\n          \"type\": \"https://witness.dev/attestations/github/v0.1\"\n        }\n      ],\n      \"functionaries\": [\n        {\n          \"type\": \"publickey\",\n          \"publickeyid\": \"build-key\"\n        }\n      ]\n    }\n  }\n}\n```\n\n**Witness Run Command:**\n```bash\nwitness run --step build \\\n  --attestations commandrun,environment,github \\\n  --outfile build-attestation.json \\\n  --key signing-key.pem \\\n  -- <your-build-command>\n```\n\n**Rego Validation Rules:**\n```rego\n\n```\n\n**Verification:**\n```bash\nwitness verify \\\n  --policy policy-signed.json \\\n  --publickey policy-key.pub \\\n  -a build-attestation.json \\\n  --subject <artifact>\n```\n"}]}
{"messages": [{"role": "system", "content": "You are an expert in the Witness supply chain attestation framework. You help users instrument CI/CD pipelines with witness, create policy documents, and write Rego policies to validate attestations. You understand all attestors in go-witness and how to use them effectively."}, {"role": "user", "content": "How do I create a multi-step witness policy for a build \u2192 test \u2192 package pipeline?"}, {"role": "assistant", "content": "Here's a complete multi-step witness policy for your pipeline:\n\n**Policy Document:**\n```json\n{\n  \"expires\": \"2026-11-08T10:52:59Z\",\n  \"publickeys\": {\n    \"ci-key\": {\n      \"keyid\": \"sha256:1459f74bc01242015a9d26bd27b352e671352ebf1a4eedc1a7c7a599335ec40f\",\n      \"key\": \"-----BEGIN PUBLIC KEY-----\\n...\\n-----END PUBLIC KEY-----\"\n    }\n  },\n  \"steps\": {\n    \"build\": {\n      \"name\": \"build\",\n      \"attestations\": [\n        {\n          \"type\": \"https://witness.dev/attestations/git/v0.1\"\n        },\n        {\n          \"type\": \"https://witness.dev/attestations/command-run/v0.1\"\n        },\n        {\n          \"type\": \"https://witness.dev/attestations/product/v0.1\"\n        }\n      ],\n      \"functionaries\": [\n        {\n          \"type\": \"publickey\",\n          \"publickeyid\": \"ci-key\"\n        }\n      ]\n    },\n    \"test\": {\n      \"name\": \"test\",\n      \"attestations\": [\n        {\n          \"type\": \"https://witness.dev/attestations/material/v0.1\"\n        },\n        {\n          \"type\": \"https://witness.dev/attestations/command-run/v0.1\"\n        }\n      ],\n      \"functionaries\": [\n        {\n          \"type\": \"publickey\",\n          \"publickeyid\": \"ci-key\"\n        }\n      ]\n    },\n    \"package\": {\n      \"name\": \"package\",\n      \"attestations\": [\n        {\n          \"type\": \"https://witness.dev/attestations/material/v0.1\"\n        },\n        {\n          \"type\": \"https://witness.dev/attestations/product/v0.1\"\n        }\n      ],\n      \"functionaries\": [\n        {\n          \"type\": \"publickey\",\n          \"publickeyid\": \"ci-key\"\n        }\n      ]\n    }\n  }\n}\n```\n\n**Pipeline Commands:**\n\n```bash\n# Step 1: Build\nwitness run --step build \\\n  --attestations git,commandrun,product \\\n  -o build.json --key ci-key.pem \\\n  -- go build -o myapp\n\n# Step 2: Test\nwitness run --step test \\\n  --attestations material,commandrun \\\n  -o test.json --key ci-key.pem \\\n  -- go test ./...\n\n# Step 3: Package\nwitness run --step package \\\n  --attestations material,product \\\n  -o package.json --key ci-key.pem \\\n  -- tar czf myapp.tar.gz myapp\n\n# Verify entire pipeline\nwitness verify \\\n  --policy policy-signed.json \\\n  --publickey policy-key.pub \\\n  -a build.json -a test.json -a package.json\n```\n"}]}
{"messages": [{"role": "system", "content": "You are an expert in the Witness supply chain attestation framework. You help users instrument CI/CD pipelines with witness, create policy documents, and write Rego policies to validate attestations. You understand all attestors in go-witness and how to use them effectively."}, {"role": "user", "content": "How do I create a witness policy for a build step that uses these attestors: environment, git, product, github?"}, {"role": "assistant", "content": "Here's a complete witness policy for your build step with environment, git, product, github attestors:\n\n**Policy Document:**\n```json\n{\n  \"expires\": \"2026-11-08T10:52:59Z\",\n  \"publickeys\": {\n    \"build-key\": {\n      \"keyid\": \"sha256:a3c05bede0e356e742b7de39caf89ba523c8d49492c56af123708d02f649a3bf\",\n      \"key\": \"-----BEGIN PUBLIC KEY-----\\n...\\n-----END PUBLIC KEY-----\"\n    }\n  },\n  \"steps\": {\n    \"build\": {\n      \"name\": \"build\",\n      \"attestations\": [\n        {\n          \"type\": \"https://witness.dev/attestations/environment/v0.1\"\n        },\n        {\n          \"type\": \"https://witness.dev/attestations/git/v0.1\"\n        },\n        {\n          \"type\": \"https://witness.dev/attestations/product/v0.1\"\n        },\n        {\n          \"type\": \"https://witness.dev/attestations/github/v0.1\"\n        }\n      ],\n      \"functionaries\": [\n        {\n          \"type\": \"publickey\",\n          \"publickeyid\": \"build-key\"\n        }\n      ]\n    }\n  }\n}\n```\n\n**Witness Run Command:**\n```bash\nwitness run --step build \\\n  --attestations environment,git,product,github \\\n  --outfile build-attestation.json \\\n  --key signing-key.pem \\\n  -- <your-build-command>\n```\n\n**Rego Validation Rules:**\n```rego\npackage environment\n\nimport rego.v1\n\n# Ensure correct OS\ndeny contains msg if {\n    input.os != \"linux\"\n    msg := sprintf(\"Must run on linux, got: %s\", [input.os])\n}\n\n# Require CI environment\ndeny contains msg if {\n    not \"CI\" in input.variables\n    msg := \"Must run in CI environment (CI variable not set)\"\n}\n```\n\n**Verification:**\n```bash\nwitness verify \\\n  --policy policy-signed.json \\\n  --publickey policy-key.pub \\\n  -a build-attestation.json \\\n  --subject <artifact>\n```\n"}]}
{"messages": [{"role": "system", "content": "You are an expert in the Witness supply chain attestation framework. You help users instrument CI/CD pipelines with witness, create policy documents, and write Rego policies to validate attestations. You understand all attestors in go-witness and how to use them effectively."}, {"role": "user", "content": "How do I create a multi-step witness policy for a build \u2192 test \u2192 package pipeline?"}, {"role": "assistant", "content": "Here's a complete multi-step witness policy for your pipeline:\n\n**Policy Document:**\n```json\n{\n  \"expires\": \"2026-11-08T10:52:59Z\",\n  \"publickeys\": {\n    \"ci-key\": {\n      \"keyid\": \"sha256:5a944aaf8f0c97a33828a073387f928df21f80b558f0aeb3e52047bcc49300d5\",\n      \"key\": \"-----BEGIN PUBLIC KEY-----\\n...\\n-----END PUBLIC KEY-----\"\n    }\n  },\n  \"steps\": {\n    \"build\": {\n      \"name\": \"build\",\n      \"attestations\": [\n        {\n          \"type\": \"https://witness.dev/attestations/git/v0.1\"\n        },\n        {\n          \"type\": \"https://witness.dev/attestations/command-run/v0.1\"\n        },\n        {\n          \"type\": \"https://witness.dev/attestations/product/v0.1\"\n        }\n      ],\n      \"functionaries\": [\n        {\n          \"type\": \"publickey\",\n          \"publickeyid\": \"ci-key\"\n        }\n      ]\n    },\n    \"test\": {\n      \"name\": \"test\",\n      \"attestations\": [\n        {\n          \"type\": \"https://witness.dev/attestations/material/v0.1\"\n        },\n        {\n          \"type\": \"https://witness.dev/attestations/command-run/v0.1\"\n        }\n      ],\n      \"functionaries\": [\n        {\n          \"type\": \"publickey\",\n          \"publickeyid\": \"ci-key\"\n        }\n      ]\n    },\n    \"package\": {\n      \"name\": \"package\",\n      \"attestations\": [\n        {\n          \"type\": \"https://witness.dev/attestations/material/v0.1\"\n        },\n        {\n          \"type\": \"https://witness.dev/attestations/product/v0.1\"\n        }\n      ],\n      \"functionaries\": [\n        {\n          \"type\": \"publickey\",\n          \"publickeyid\": \"ci-key\"\n        }\n      ]\n    }\n  }\n}\n```\n\n**Pipeline Commands:**\n\n```bash\n# Step 1: Build\nwitness run --step build \\\n  --attestations git,commandrun,product \\\n  -o build.json --key ci-key.pem \\\n  -- go build -o myapp\n\n# Step 2: Test\nwitness run --step test \\\n  --attestations material,commandrun \\\n  -o test.json --key ci-key.pem \\\n  -- go test ./...\n\n# Step 3: Package\nwitness run --step package \\\n  --attestations material,product \\\n  -o package.json --key ci-key.pem \\\n  -- tar czf myapp.tar.gz myapp\n\n# Verify entire pipeline\nwitness verify \\\n  --policy policy-signed.json \\\n  --publickey policy-key.pub \\\n  -a build.json -a test.json -a package.json\n```\n"}]}
{"messages": [{"role": "system", "content": "You are an expert in the Witness supply chain attestation framework. You help users instrument CI/CD pipelines with witness, create policy documents, and write Rego policies to validate attestations. You understand all attestors in go-witness and how to use them effectively."}, {"role": "user", "content": "How do I create a witness policy for a build step that uses these attestors: git, environment, product, material?"}, {"role": "assistant", "content": "Here's a complete witness policy for your build step with git, environment, product, material attestors:\n\n**Policy Document:**\n```json\n{\n  \"expires\": \"2026-11-08T10:52:59Z\",\n  \"publickeys\": {\n    \"build-key\": {\n      \"keyid\": \"sha256:7ec4204caf82a27447be596cb727115e7e164efcf0e4ba793ead99f9776bcdbe\",\n      \"key\": \"-----BEGIN PUBLIC KEY-----\\n...\\n-----END PUBLIC KEY-----\"\n    }\n  },\n  \"steps\": {\n    \"build\": {\n      \"name\": \"build\",\n      \"attestations\": [\n        {\n          \"type\": \"https://witness.dev/attestations/git/v0.1\"\n        },\n        {\n          \"type\": \"https://witness.dev/attestations/environment/v0.1\"\n        },\n        {\n          \"type\": \"https://witness.dev/attestations/product/v0.1\"\n        },\n        {\n          \"type\": \"https://witness.dev/attestations/material/v0.1\"\n        }\n      ],\n      \"functionaries\": [\n        {\n          \"type\": \"publickey\",\n          \"publickeyid\": \"build-key\"\n        }\n      ]\n    }\n  }\n}\n```\n\n**Witness Run Command:**\n```bash\nwitness run --step build \\\n  --attestations git,environment,product,material \\\n  --outfile build-attestation.json \\\n  --key signing-key.pem \\\n  -- <your-build-command>\n```\n\n**Rego Validation Rules:**\n```rego\npackage git\n\nimport rego.v1\n\n# Enforce builds from specific branch\ndeny contains msg if {\n    input.branch != \"hotfix/critical\"\n    msg := sprintf(\"Must build from hotfix/critical branch, got: %s\", [input.branch])\n}\n\n# Require clean working directory\ndeny contains msg if {\n    count(input.status) > 0\n    msg := \"Working directory must be clean (no uncommitted changes)\"\n}\n\n# Validate commit author\napproved_authors := {\n    \"alice.smith@example.com\",\n    \"bob.jones@company.com\",\n    \"ci-bot@company.com\"\n}\n\ndeny contains msg if {\n    not input.authoremail in approved_authors\n    msg := sprintf(\"Unauthorized commit author: %s\", [input.authoremail])\n}\n```\n\n**Verification:**\n```bash\nwitness verify \\\n  --policy policy-signed.json \\\n  --publickey policy-key.pub \\\n  -a build-attestation.json \\\n  --subject <artifact>\n```\n"}]}
{"messages": [{"role": "system", "content": "You are an expert in the Witness supply chain attestation framework. You help users instrument CI/CD pipelines with witness, create policy documents, and write Rego policies to validate attestations. You understand all attestors in go-witness and how to use them effectively."}, {"role": "user", "content": "How do I create a witness policy for a build step that uses these attestors: environment, github, product?"}, {"role": "assistant", "content": "Here's a complete witness policy for your build step with environment, github, product attestors:\n\n**Policy Document:**\n```json\n{\n  \"expires\": \"2026-11-08T10:52:59Z\",\n  \"publickeys\": {\n    \"build-key\": {\n      \"keyid\": \"sha256:6aeaf37faddd382d7b806b4ee930f1393a6d35a717781bdbfc14152484476cfe\",\n      \"key\": \"-----BEGIN PUBLIC KEY-----\\n...\\n-----END PUBLIC KEY-----\"\n    }\n  },\n  \"steps\": {\n    \"build\": {\n      \"name\": \"build\",\n      \"attestations\": [\n        {\n          \"type\": \"https://witness.dev/attestations/environment/v0.1\"\n        },\n        {\n          \"type\": \"https://witness.dev/attestations/github/v0.1\"\n        },\n        {\n          \"type\": \"https://witness.dev/attestations/product/v0.1\"\n        }\n      ],\n      \"functionaries\": [\n        {\n          \"type\": \"publickey\",\n          \"publickeyid\": \"build-key\"\n        }\n      ]\n    }\n  }\n}\n```\n\n**Witness Run Command:**\n```bash\nwitness run --step build \\\n  --attestations environment,github,product \\\n  --outfile build-attestation.json \\\n  --key signing-key.pem \\\n  -- <your-build-command>\n```\n\n**Rego Validation Rules:**\n```rego\npackage environment\n\nimport rego.v1\n\n# Ensure correct OS\ndeny contains msg if {\n    input.os != \"darwin\"\n    msg := sprintf(\"Must run on darwin, got: %s\", [input.os])\n}\n\n# Require CI environment\ndeny contains msg if {\n    not \"CI\" in input.variables\n    msg := \"Must run in CI environment (CI variable not set)\"\n}\n```\n\n**Verification:**\n```bash\nwitness verify \\\n  --policy policy-signed.json \\\n  --publickey policy-key.pub \\\n  -a build-attestation.json \\\n  --subject <artifact>\n```\n"}]}
{"messages": [{"role": "system", "content": "You are an expert in the Witness supply chain attestation framework. You help users instrument CI/CD pipelines with witness, create policy documents, and write Rego policies to validate attestations. You understand all attestors in go-witness and how to use them effectively."}, {"role": "user", "content": "How do I create a multi-step witness policy for a build \u2192 test \u2192 package pipeline?"}, {"role": "assistant", "content": "Here's a complete multi-step witness policy for your pipeline:\n\n**Policy Document:**\n```json\n{\n  \"expires\": \"2026-11-08T10:52:59Z\",\n  \"publickeys\": {\n    \"ci-key\": {\n      \"keyid\": \"sha256:8ffe260c764a7027783b7a2c5e9ffeffc7c7633fa1201a5c516bc34f73dcf2c1\",\n      \"key\": \"-----BEGIN PUBLIC KEY-----\\n...\\n-----END PUBLIC KEY-----\"\n    }\n  },\n  \"steps\": {\n    \"build\": {\n      \"name\": \"build\",\n      \"attestations\": [\n        {\n          \"type\": \"https://witness.dev/attestations/git/v0.1\"\n        },\n        {\n          \"type\": \"https://witness.dev/attestations/command-run/v0.1\"\n        },\n        {\n          \"type\": \"https://witness.dev/attestations/product/v0.1\"\n        }\n      ],\n      \"functionaries\": [\n        {\n          \"type\": \"publickey\",\n          \"publickeyid\": \"ci-key\"\n        }\n      ]\n    },\n    \"test\": {\n      \"name\": \"test\",\n      \"attestations\": [\n        {\n          \"type\": \"https://witness.dev/attestations/material/v0.1\"\n        },\n        {\n          \"type\": \"https://witness.dev/attestations/command-run/v0.1\"\n        }\n      ],\n      \"functionaries\": [\n        {\n          \"type\": \"publickey\",\n          \"publickeyid\": \"ci-key\"\n        }\n      ]\n    },\n    \"package\": {\n      \"name\": \"package\",\n      \"attestations\": [\n        {\n          \"type\": \"https://witness.dev/attestations/material/v0.1\"\n        },\n        {\n          \"type\": \"https://witness.dev/attestations/product/v0.1\"\n        }\n      ],\n      \"functionaries\": [\n        {\n          \"type\": \"publickey\",\n          \"publickeyid\": \"ci-key\"\n        }\n      ]\n    }\n  }\n}\n```\n\n**Pipeline Commands:**\n\n```bash\n# Step 1: Build\nwitness run --step build \\\n  --attestations git,commandrun,product \\\n  -o build.json --key ci-key.pem \\\n  -- go build -o myapp\n\n# Step 2: Test\nwitness run --step test \\\n  --attestations material,commandrun \\\n  -o test.json --key ci-key.pem \\\n  -- go test ./...\n\n# Step 3: Package\nwitness run --step package \\\n  --attestations material,product \\\n  -o package.json --key ci-key.pem \\\n  -- tar czf myapp.tar.gz myapp\n\n# Verify entire pipeline\nwitness verify \\\n  --policy policy-signed.json \\\n  --publickey policy-key.pub \\\n  -a build.json -a test.json -a package.json\n```\n"}]}
{"messages": [{"role": "system", "content": "You are an expert in the Witness supply chain attestation framework. You help users instrument CI/CD pipelines with witness, create policy documents, and write Rego policies to validate attestations. You understand all attestors in go-witness and how to use them effectively."}, {"role": "user", "content": "How do I create a witness policy for a build step that uses these attestors: material?"}, {"role": "assistant", "content": "Here's a complete witness policy for your build step with material attestors:\n\n**Policy Document:**\n```json\n{\n  \"expires\": \"2026-11-08T10:52:59Z\",\n  \"publickeys\": {\n    \"build-key\": {\n      \"keyid\": \"sha256:59f77701516e29532292de687f9623201da9c06e19cbedf5ee42bbb15f67e45a\",\n      \"key\": \"-----BEGIN PUBLIC KEY-----\\n...\\n-----END PUBLIC KEY-----\"\n    }\n  },\n  \"steps\": {\n    \"build\": {\n      \"name\": \"build\",\n      \"attestations\": [\n        {\n          \"type\": \"https://witness.dev/attestations/material/v0.1\"\n        }\n      ],\n      \"functionaries\": [\n        {\n          \"type\": \"publickey\",\n          \"publickeyid\": \"build-key\"\n        }\n      ]\n    }\n  }\n}\n```\n\n**Witness Run Command:**\n```bash\nwitness run --step build \\\n  --attestations material \\\n  --outfile build-attestation.json \\\n  --key signing-key.pem \\\n  -- <your-build-command>\n```\n\n**Rego Validation Rules:**\n```rego\n\n```\n\n**Verification:**\n```bash\nwitness verify \\\n  --policy policy-signed.json \\\n  --publickey policy-key.pub \\\n  -a build-attestation.json \\\n  --subject <artifact>\n```\n"}]}
{"messages": [{"role": "system", "content": "You are an expert in the Witness supply chain attestation framework. You help users instrument CI/CD pipelines with witness, create policy documents, and write Rego policies to validate attestations. You understand all attestors in go-witness and how to use them effectively."}, {"role": "user", "content": "How do I create a witness policy for a build step that uses these attestors: github, material?"}, {"role": "assistant", "content": "Here's a complete witness policy for your build step with github, material attestors:\n\n**Policy Document:**\n```json\n{\n  \"expires\": \"2026-11-08T10:52:59Z\",\n  \"publickeys\": {\n    \"build-key\": {\n      \"keyid\": \"sha256:57bc5122cbf27d27025e37aeb5c7c829be73e58f1060618e700049f3c9cdce6a\",\n      \"key\": \"-----BEGIN PUBLIC KEY-----\\n...\\n-----END PUBLIC KEY-----\"\n    }\n  },\n  \"steps\": {\n    \"build\": {\n      \"name\": \"build\",\n      \"attestations\": [\n        {\n          \"type\": \"https://witness.dev/attestations/github/v0.1\"\n        },\n        {\n          \"type\": \"https://witness.dev/attestations/material/v0.1\"\n        }\n      ],\n      \"functionaries\": [\n        {\n          \"type\": \"publickey\",\n          \"publickeyid\": \"build-key\"\n        }\n      ]\n    }\n  }\n}\n```\n\n**Witness Run Command:**\n```bash\nwitness run --step build \\\n  --attestations github,material \\\n  --outfile build-attestation.json \\\n  --key signing-key.pem \\\n  -- <your-build-command>\n```\n\n**Rego Validation Rules:**\n```rego\n\n```\n\n**Verification:**\n```bash\nwitness verify \\\n  --policy policy-signed.json \\\n  --publickey policy-key.pub \\\n  -a build-attestation.json \\\n  --subject <artifact>\n```\n"}]}
{"messages": [{"role": "system", "content": "You are an expert in the Witness supply chain attestation framework. You help users instrument CI/CD pipelines with witness, create policy documents, and write Rego policies to validate attestations. You understand all attestors in go-witness and how to use them effectively."}, {"role": "user", "content": "How do I create a witness policy for a build step that uses these attestors: environment, commandrun, git?"}, {"role": "assistant", "content": "Here's a complete witness policy for your build step with environment, commandrun, git attestors:\n\n**Policy Document:**\n```json\n{\n  \"expires\": \"2026-11-08T10:52:59Z\",\n  \"publickeys\": {\n    \"build-key\": {\n      \"keyid\": \"sha256:01fe80b97d5dc968d14f22e4a16edd7262ecbc242e53a4d5a9e49030d64f5d2d\",\n      \"key\": \"-----BEGIN PUBLIC KEY-----\\n...\\n-----END PUBLIC KEY-----\"\n    }\n  },\n  \"steps\": {\n    \"build\": {\n      \"name\": \"build\",\n      \"attestations\": [\n        {\n          \"type\": \"https://witness.dev/attestations/environment/v0.1\"\n        },\n        {\n          \"type\": \"https://witness.dev/attestations/command-run/v0.1\"\n        },\n        {\n          \"type\": \"https://witness.dev/attestations/git/v0.1\"\n        }\n      ],\n      \"functionaries\": [\n        {\n          \"type\": \"publickey\",\n          \"publickeyid\": \"build-key\"\n        }\n      ]\n    }\n  }\n}\n```\n\n**Witness Run Command:**\n```bash\nwitness run --step build \\\n  --attestations environment,commandrun,git \\\n  --outfile build-attestation.json \\\n  --key signing-key.pem \\\n  -- <your-build-command>\n```\n\n**Rego Validation Rules:**\n```rego\npackage environment\n\nimport rego.v1\n\n# Ensure correct OS\ndeny contains msg if {\n    input.os != \"darwin\"\n    msg := sprintf(\"Must run on darwin, got: %s\", [input.os])\n}\n\n# Require CI environment\ndeny contains msg if {\n    not \"CI\" in input.variables\n    msg := \"Must run in CI environment (CI variable not set)\"\n}\n```\n\n**Verification:**\n```bash\nwitness verify \\\n  --policy policy-signed.json \\\n  --publickey policy-key.pub \\\n  -a build-attestation.json \\\n  --subject <artifact>\n```\n"}]}
{"messages": [{"role": "system", "content": "You are an expert in the Witness supply chain attestation framework. You help users instrument CI/CD pipelines with witness, create policy documents, and write Rego policies to validate attestations. You understand all attestors in go-witness and how to use them effectively."}, {"role": "user", "content": "How do I create a witness policy for a build step that uses these attestors: environment, github?"}, {"role": "assistant", "content": "Here's a complete witness policy for your build step with environment, github attestors:\n\n**Policy Document:**\n```json\n{\n  \"expires\": \"2026-11-08T10:52:59Z\",\n  \"publickeys\": {\n    \"build-key\": {\n      \"keyid\": \"sha256:1b4f3ae7967b64d354ed1066f9c7cbbe3e46d68e4df372126c0e3b5d9b13272e\",\n      \"key\": \"-----BEGIN PUBLIC KEY-----\\n...\\n-----END PUBLIC KEY-----\"\n    }\n  },\n  \"steps\": {\n    \"build\": {\n      \"name\": \"build\",\n      \"attestations\": [\n        {\n          \"type\": \"https://witness.dev/attestations/environment/v0.1\"\n        },\n        {\n          \"type\": \"https://witness.dev/attestations/github/v0.1\"\n        }\n      ],\n      \"functionaries\": [\n        {\n          \"type\": \"publickey\",\n          \"publickeyid\": \"build-key\"\n        }\n      ]\n    }\n  }\n}\n```\n\n**Witness Run Command:**\n```bash\nwitness run --step build \\\n  --attestations environment,github \\\n  --outfile build-attestation.json \\\n  --key signing-key.pem \\\n  -- <your-build-command>\n```\n\n**Rego Validation Rules:**\n```rego\npackage environment\n\nimport rego.v1\n\n# Ensure correct OS\ndeny contains msg if {\n    input.os != \"linux\"\n    msg := sprintf(\"Must run on linux, got: %s\", [input.os])\n}\n\n# Require CI environment\ndeny contains msg if {\n    not \"CI\" in input.variables\n    msg := \"Must run in CI environment (CI variable not set)\"\n}\n```\n\n**Verification:**\n```bash\nwitness verify \\\n  --policy policy-signed.json \\\n  --publickey policy-key.pub \\\n  -a build-attestation.json \\\n  --subject <artifact>\n```\n"}]}
{"messages": [{"role": "system", "content": "You are an expert in the Witness supply chain attestation framework. You help users instrument CI/CD pipelines with witness, create policy documents, and write Rego policies to validate attestations. You understand all attestors in go-witness and how to use them effectively."}, {"role": "user", "content": "How do I create a multi-step witness policy for a build \u2192 test \u2192 package pipeline?"}, {"role": "assistant", "content": "Here's a complete multi-step witness policy for your pipeline:\n\n**Policy Document:**\n```json\n{\n  \"expires\": \"2026-11-08T10:52:59Z\",\n  \"publickeys\": {\n    \"ci-key\": {\n      \"keyid\": \"sha256:34fadb60a77c3ebde40e5162fa896966218aca997d09ad64b919106dc410ad99\",\n      \"key\": \"-----BEGIN PUBLIC KEY-----\\n...\\n-----END PUBLIC KEY-----\"\n    }\n  },\n  \"steps\": {\n    \"build\": {\n      \"name\": \"build\",\n      \"attestations\": [\n        {\n          \"type\": \"https://witness.dev/attestations/git/v0.1\"\n        },\n        {\n          \"type\": \"https://witness.dev/attestations/command-run/v0.1\"\n        },\n        {\n          \"type\": \"https://witness.dev/attestations/product/v0.1\"\n        }\n      ],\n      \"functionaries\": [\n        {\n          \"type\": \"publickey\",\n          \"publickeyid\": \"ci-key\"\n        }\n      ]\n    },\n    \"test\": {\n      \"name\": \"test\",\n      \"attestations\": [\n        {\n          \"type\": \"https://witness.dev/attestations/material/v0.1\"\n        },\n        {\n          \"type\": \"https://witness.dev/attestations/command-run/v0.1\"\n        }\n      ],\n      \"functionaries\": [\n        {\n          \"type\": \"publickey\",\n          \"publickeyid\": \"ci-key\"\n        }\n      ]\n    },\n    \"package\": {\n      \"name\": \"package\",\n      \"attestations\": [\n        {\n          \"type\": \"https://witness.dev/attestations/material/v0.1\"\n        },\n        {\n          \"type\": \"https://witness.dev/attestations/product/v0.1\"\n        }\n      ],\n      \"functionaries\": [\n        {\n          \"type\": \"publickey\",\n          \"publickeyid\": \"ci-key\"\n        }\n      ]\n    }\n  }\n}\n```\n\n**Pipeline Commands:**\n\n```bash\n# Step 1: Build\nwitness run --step build \\\n  --attestations git,commandrun,product \\\n  -o build.json --key ci-key.pem \\\n  -- go build -o myapp\n\n# Step 2: Test\nwitness run --step test \\\n  --attestations material,commandrun \\\n  -o test.json --key ci-key.pem \\\n  -- go test ./...\n\n# Step 3: Package\nwitness run --step package \\\n  --attestations material,product \\\n  -o package.json --key ci-key.pem \\\n  -- tar czf myapp.tar.gz myapp\n\n# Verify entire pipeline\nwitness verify \\\n  --policy policy-signed.json \\\n  --publickey policy-key.pub \\\n  -a build.json -a test.json -a package.json\n```\n"}]}
{"messages": [{"role": "system", "content": "You are an expert in the Witness supply chain attestation framework. You help users instrument CI/CD pipelines with witness, create policy documents, and write Rego policies to validate attestations. You understand all attestors in go-witness and how to use them effectively."}, {"role": "user", "content": "How do I create a witness policy for a build step that uses these attestors: commandrun, git, product, environment?"}, {"role": "assistant", "content": "Here's a complete witness policy for your build step with commandrun, git, product, environment attestors:\n\n**Policy Document:**\n```json\n{\n  \"expires\": \"2026-11-08T10:52:59Z\",\n  \"publickeys\": {\n    \"build-key\": {\n      \"keyid\": \"sha256:09ac6f5baa2f6aa707bef8f900a9e675df65ebda72dc00d1f5f704aac483e57e\",\n      \"key\": \"-----BEGIN PUBLIC KEY-----\\n...\\n-----END PUBLIC KEY-----\"\n    }\n  },\n  \"steps\": {\n    \"build\": {\n      \"name\": \"build\",\n      \"attestations\": [\n        {\n          \"type\": \"https://witness.dev/attestations/command-run/v0.1\"\n        },\n        {\n          \"type\": \"https://witness.dev/attestations/git/v0.1\"\n        },\n        {\n          \"type\": \"https://witness.dev/attestations/product/v0.1\"\n        },\n        {\n          \"type\": \"https://witness.dev/attestations/environment/v0.1\"\n        }\n      ],\n      \"functionaries\": [\n        {\n          \"type\": \"publickey\",\n          \"publickeyid\": \"build-key\"\n        }\n      ]\n    }\n  }\n}\n```\n\n**Witness Run Command:**\n```bash\nwitness run --step build \\\n  --attestations commandrun,git,product,environment \\\n  --outfile build-attestation.json \\\n  --key signing-key.pem \\\n  -- <your-build-command>\n```\n\n**Rego Validation Rules:**\n```rego\n\n```\n\n**Verification:**\n```bash\nwitness verify \\\n  --policy policy-signed.json \\\n  --publickey policy-key.pub \\\n  -a build-attestation.json \\\n  --subject <artifact>\n```\n"}]}
{"messages": [{"role": "system", "content": "You are an expert in the Witness supply chain attestation framework. You help users instrument CI/CD pipelines with witness, create policy documents, and write Rego policies to validate attestations. You understand all attestors in go-witness and how to use them effectively."}, {"role": "user", "content": "How do I create a witness policy for a build step that uses these attestors: product, material?"}, {"role": "assistant", "content": "Here's a complete witness policy for your build step with product, material attestors:\n\n**Policy Document:**\n```json\n{\n  \"expires\": \"2026-11-08T10:52:59Z\",\n  \"publickeys\": {\n    \"build-key\": {\n      \"keyid\": \"sha256:7c1aeda7ce08c66d4108e5c39aacb2d0d465162804837e0b90d19bccd40592f3\",\n      \"key\": \"-----BEGIN PUBLIC KEY-----\\n...\\n-----END PUBLIC KEY-----\"\n    }\n  },\n  \"steps\": {\n    \"build\": {\n      \"name\": \"build\",\n      \"attestations\": [\n        {\n          \"type\": \"https://witness.dev/attestations/product/v0.1\"\n        },\n        {\n          \"type\": \"https://witness.dev/attestations/material/v0.1\"\n        }\n      ],\n      \"functionaries\": [\n        {\n          \"type\": \"publickey\",\n          \"publickeyid\": \"build-key\"\n        }\n      ]\n    }\n  }\n}\n```\n\n**Witness Run Command:**\n```bash\nwitness run --step build \\\n  --attestations product,material \\\n  --outfile build-attestation.json \\\n  --key signing-key.pem \\\n  -- <your-build-command>\n```\n\n**Rego Validation Rules:**\n```rego\n\n```\n\n**Verification:**\n```bash\nwitness verify \\\n  --policy policy-signed.json \\\n  --publickey policy-key.pub \\\n  -a build-attestation.json \\\n  --subject <artifact>\n```\n"}]}
{"messages": [{"role": "system", "content": "You are an expert in the Witness supply chain attestation framework. You help users instrument CI/CD pipelines with witness, create policy documents, and write Rego policies to validate attestations. You understand all attestors in go-witness and how to use them effectively."}, {"role": "user", "content": "How do I create a witness policy for a build step that uses these attestors: github, material?"}, {"role": "assistant", "content": "Here's a complete witness policy for your build step with github, material attestors:\n\n**Policy Document:**\n```json\n{\n  \"expires\": \"2026-11-08T10:52:59Z\",\n  \"publickeys\": {\n    \"build-key\": {\n      \"keyid\": \"sha256:9ce2c39f5f65fccceab98b5216cf0956209723746b51f08b64466fb3a4a1ff0f\",\n      \"key\": \"-----BEGIN PUBLIC KEY-----\\n...\\n-----END PUBLIC KEY-----\"\n    }\n  },\n  \"steps\": {\n    \"build\": {\n      \"name\": \"build\",\n      \"attestations\": [\n        {\n          \"type\": \"https://witness.dev/attestations/github/v0.1\"\n        },\n        {\n          \"type\": \"https://witness.dev/attestations/material/v0.1\"\n        }\n      ],\n      \"functionaries\": [\n        {\n          \"type\": \"publickey\",\n          \"publickeyid\": \"build-key\"\n        }\n      ]\n    }\n  }\n}\n```\n\n**Witness Run Command:**\n```bash\nwitness run --step build \\\n  --attestations github,material \\\n  --outfile build-attestation.json \\\n  --key signing-key.pem \\\n  -- <your-build-command>\n```\n\n**Rego Validation Rules:**\n```rego\n\n```\n\n**Verification:**\n```bash\nwitness verify \\\n  --policy policy-signed.json \\\n  --publickey policy-key.pub \\\n  -a build-attestation.json \\\n  --subject <artifact>\n```\n"}]}
{"messages": [{"role": "system", "content": "You are an expert in the Witness supply chain attestation framework. You help users instrument CI/CD pipelines with witness, create policy documents, and write Rego policies to validate attestations. You understand all attestors in go-witness and how to use them effectively."}, {"role": "user", "content": "How do I create a multi-step witness policy for a build \u2192 test \u2192 package pipeline?"}, {"role": "assistant", "content": "Here's a complete multi-step witness policy for your pipeline:\n\n**Policy Document:**\n```json\n{\n  \"expires\": \"2026-11-08T10:52:59Z\",\n  \"publickeys\": {\n    \"ci-key\": {\n      \"keyid\": \"sha256:dc176ad26786abfc3b21ec8b6c7ba7e8187e745cdec9ff029db1ca12411795dc\",\n      \"key\": \"-----BEGIN PUBLIC KEY-----\\n...\\n-----END PUBLIC KEY-----\"\n    }\n  },\n  \"steps\": {\n    \"build\": {\n      \"name\": \"build\",\n      \"attestations\": [\n        {\n          \"type\": \"https://witness.dev/attestations/git/v0.1\"\n        },\n        {\n          \"type\": \"https://witness.dev/attestations/command-run/v0.1\"\n        },\n        {\n          \"type\": \"https://witness.dev/attestations/product/v0.1\"\n        }\n      ],\n      \"functionaries\": [\n        {\n          \"type\": \"publickey\",\n          \"publickeyid\": \"ci-key\"\n        }\n      ]\n    },\n    \"test\": {\n      \"name\": \"test\",\n      \"attestations\": [\n        {\n          \"type\": \"https://witness.dev/attestations/material/v0.1\"\n        },\n        {\n          \"type\": \"https://witness.dev/attestations/command-run/v0.1\"\n        }\n      ],\n      \"functionaries\": [\n        {\n          \"type\": \"publickey\",\n          \"publickeyid\": \"ci-key\"\n        }\n      ]\n    },\n    \"package\": {\n      \"name\": \"package\",\n      \"attestations\": [\n        {\n          \"type\": \"https://witness.dev/attestations/material/v0.1\"\n        },\n        {\n          \"type\": \"https://witness.dev/attestations/product/v0.1\"\n        }\n      ],\n      \"functionaries\": [\n        {\n          \"type\": \"publickey\",\n          \"publickeyid\": \"ci-key\"\n        }\n      ]\n    }\n  }\n}\n```\n\n**Pipeline Commands:**\n\n```bash\n# Step 1: Build\nwitness run --step build \\\n  --attestations git,commandrun,product \\\n  -o build.json --key ci-key.pem \\\n  -- go build -o myapp\n\n# Step 2: Test\nwitness run --step test \\\n  --attestations material,commandrun \\\n  -o test.json --key ci-key.pem \\\n  -- go test ./...\n\n# Step 3: Package\nwitness run --step package \\\n  --attestations material,product \\\n  -o package.json --key ci-key.pem \\\n  -- tar czf myapp.tar.gz myapp\n\n# Verify entire pipeline\nwitness verify \\\n  --policy policy-signed.json \\\n  --publickey policy-key.pub \\\n  -a build.json -a test.json -a package.json\n```\n"}]}
{"messages": [{"role": "system", "content": "You are an expert in the Witness supply chain attestation framework. You help users instrument CI/CD pipelines with witness, create policy documents, and write Rego policies to validate attestations. You understand all attestors in go-witness and how to use them effectively."}, {"role": "user", "content": "How do I create a witness policy for a build step that uses these attestors: commandrun, environment, product, git, github?"}, {"role": "assistant", "content": "Here's a complete witness policy for your build step with commandrun, environment, product, git, github attestors:\n\n**Policy Document:**\n```json\n{\n  \"expires\": \"2026-11-08T10:52:59Z\",\n  \"publickeys\": {\n    \"build-key\": {\n      \"keyid\": \"sha256:d4f1e63c34e4891e2dfc9ec4044a308979792fbc937e5a1d81ce33e42c5e70b1\",\n      \"key\": \"-----BEGIN PUBLIC KEY-----\\n...\\n-----END PUBLIC KEY-----\"\n    }\n  },\n  \"steps\": {\n    \"build\": {\n      \"name\": \"build\",\n      \"attestations\": [\n        {\n          \"type\": \"https://witness.dev/attestations/command-run/v0.1\"\n        },\n        {\n          \"type\": \"https://witness.dev/attestations/environment/v0.1\"\n        },\n        {\n          \"type\": \"https://witness.dev/attestations/product/v0.1\"\n        },\n        {\n          \"type\": \"https://witness.dev/attestations/git/v0.1\"\n        },\n        {\n          \"type\": \"https://witness.dev/attestations/github/v0.1\"\n        }\n      ],\n      \"functionaries\": [\n        {\n          \"type\": \"publickey\",\n          \"publickeyid\": \"build-key\"\n        }\n      ]\n    }\n  }\n}\n```\n\n**Witness Run Command:**\n```bash\nwitness run --step build \\\n  --attestations commandrun,environment,product,git,github \\\n  --outfile build-attestation.json \\\n  --key signing-key.pem \\\n  -- <your-build-command>\n```\n\n**Rego Validation Rules:**\n```rego\n\n```\n\n**Verification:**\n```bash\nwitness verify \\\n  --policy policy-signed.json \\\n  --publickey policy-key.pub \\\n  -a build-attestation.json \\\n  --subject <artifact>\n```\n"}]}
{"messages": [{"role": "system", "content": "You are an expert in the Witness supply chain attestation framework. You help users instrument CI/CD pipelines with witness, create policy documents, and write Rego policies to validate attestations. You understand all attestors in go-witness and how to use them effectively."}, {"role": "user", "content": "How do I create a witness policy for a build step that uses these attestors: material, github, environment, commandrun?"}, {"role": "assistant", "content": "Here's a complete witness policy for your build step with material, github, environment, commandrun attestors:\n\n**Policy Document:**\n```json\n{\n  \"expires\": \"2026-11-08T10:52:59Z\",\n  \"publickeys\": {\n    \"build-key\": {\n      \"keyid\": \"sha256:bbddcecb1e494dd6b66c60fa096e774b91c269753290ac610af33a5225607a84\",\n      \"key\": \"-----BEGIN PUBLIC KEY-----\\n...\\n-----END PUBLIC KEY-----\"\n    }\n  },\n  \"steps\": {\n    \"build\": {\n      \"name\": \"build\",\n      \"attestations\": [\n        {\n          \"type\": \"https://witness.dev/attestations/material/v0.1\"\n        },\n        {\n          \"type\": \"https://witness.dev/attestations/github/v0.1\"\n        },\n        {\n          \"type\": \"https://witness.dev/attestations/environment/v0.1\"\n        },\n        {\n          \"type\": \"https://witness.dev/attestations/command-run/v0.1\"\n        }\n      ],\n      \"functionaries\": [\n        {\n          \"type\": \"publickey\",\n          \"publickeyid\": \"build-key\"\n        }\n      ]\n    }\n  }\n}\n```\n\n**Witness Run Command:**\n```bash\nwitness run --step build \\\n  --attestations material,github,environment,commandrun \\\n  --outfile build-attestation.json \\\n  --key signing-key.pem \\\n  -- <your-build-command>\n```\n\n**Rego Validation Rules:**\n```rego\n\n```\n\n**Verification:**\n```bash\nwitness verify \\\n  --policy policy-signed.json \\\n  --publickey policy-key.pub \\\n  -a build-attestation.json \\\n  --subject <artifact>\n```\n"}]}
{"messages": [{"role": "system", "content": "You are an expert in the Witness supply chain attestation framework. You help users instrument CI/CD pipelines with witness, create policy documents, and write Rego policies to validate attestations. You understand all attestors in go-witness and how to use them effectively."}, {"role": "user", "content": "How do I create a multi-step witness policy for a build \u2192 test \u2192 package pipeline?"}, {"role": "assistant", "content": "Here's a complete multi-step witness policy for your pipeline:\n\n**Policy Document:**\n```json\n{\n  \"expires\": \"2026-11-08T10:52:59Z\",\n  \"publickeys\": {\n    \"ci-key\": {\n      \"keyid\": \"sha256:2a1d19b3ddff26b1bb66cc55842e596b81018f9e31555b2ac7ef0d8e837e7edd\",\n      \"key\": \"-----BEGIN PUBLIC KEY-----\\n...\\n-----END PUBLIC KEY-----\"\n    }\n  },\n  \"steps\": {\n    \"build\": {\n      \"name\": \"build\",\n      \"attestations\": [\n        {\n          \"type\": \"https://witness.dev/attestations/git/v0.1\"\n        },\n        {\n          \"type\": \"https://witness.dev/attestations/command-run/v0.1\"\n        },\n        {\n          \"type\": \"https://witness.dev/attestations/product/v0.1\"\n        }\n      ],\n      \"functionaries\": [\n        {\n          \"type\": \"publickey\",\n          \"publickeyid\": \"ci-key\"\n        }\n      ]\n    },\n    \"test\": {\n      \"name\": \"test\",\n      \"attestations\": [\n        {\n          \"type\": \"https://witness.dev/attestations/material/v0.1\"\n        },\n        {\n          \"type\": \"https://witness.dev/attestations/command-run/v0.1\"\n        }\n      ],\n      \"functionaries\": [\n        {\n          \"type\": \"publickey\",\n          \"publickeyid\": \"ci-key\"\n        }\n      ]\n    },\n    \"package\": {\n      \"name\": \"package\",\n      \"attestations\": [\n        {\n          \"type\": \"https://witness.dev/attestations/material/v0.1\"\n        },\n        {\n          \"type\": \"https://witness.dev/attestations/product/v0.1\"\n        }\n      ],\n      \"functionaries\": [\n        {\n          \"type\": \"publickey\",\n          \"publickeyid\": \"ci-key\"\n        }\n      ]\n    }\n  }\n}\n```\n\n**Pipeline Commands:**\n\n```bash\n# Step 1: Build\nwitness run --step build \\\n  --attestations git,commandrun,product \\\n  -o build.json --key ci-key.pem \\\n  -- go build -o myapp\n\n# Step 2: Test\nwitness run --step test \\\n  --attestations material,commandrun \\\n  -o test.json --key ci-key.pem \\\n  -- go test ./...\n\n# Step 3: Package\nwitness run --step package \\\n  --attestations material,product \\\n  -o package.json --key ci-key.pem \\\n  -- tar czf myapp.tar.gz myapp\n\n# Verify entire pipeline\nwitness verify \\\n  --policy policy-signed.json \\\n  --publickey policy-key.pub \\\n  -a build.json -a test.json -a package.json\n```\n"}]}
{"messages": [{"role": "system", "content": "You are an expert in the Witness supply chain attestation framework. You help users instrument CI/CD pipelines with witness, create policy documents, and write Rego policies to validate attestations. You understand all attestors in go-witness and how to use them effectively."}, {"role": "user", "content": "How do I create a multi-step witness policy for a build \u2192 test \u2192 package pipeline?"}, {"role": "assistant", "content": "Here's a complete multi-step witness policy for your pipeline:\n\n**Policy Document:**\n```json\n{\n  \"expires\": \"2026-11-08T10:52:59Z\",\n  \"publickeys\": {\n    \"ci-key\": {\n      \"keyid\": \"sha256:e724f84248a73be6b077d28b8f2369ca888340e77bf02ed2af5df0acca18533d\",\n      \"key\": \"-----BEGIN PUBLIC KEY-----\\n...\\n-----END PUBLIC KEY-----\"\n    }\n  },\n  \"steps\": {\n    \"build\": {\n      \"name\": \"build\",\n      \"attestations\": [\n        {\n          \"type\": \"https://witness.dev/attestations/git/v0.1\"\n        },\n        {\n          \"type\": \"https://witness.dev/attestations/command-run/v0.1\"\n        },\n        {\n          \"type\": \"https://witness.dev/attestations/product/v0.1\"\n        }\n      ],\n      \"functionaries\": [\n        {\n          \"type\": \"publickey\",\n          \"publickeyid\": \"ci-key\"\n        }\n      ]\n    },\n    \"test\": {\n      \"name\": \"test\",\n      \"attestations\": [\n        {\n          \"type\": \"https://witness.dev/attestations/material/v0.1\"\n        },\n        {\n          \"type\": \"https://witness.dev/attestations/command-run/v0.1\"\n        }\n      ],\n      \"functionaries\": [\n        {\n          \"type\": \"publickey\",\n          \"publickeyid\": \"ci-key\"\n        }\n      ]\n    },\n    \"package\": {\n      \"name\": \"package\",\n      \"attestations\": [\n        {\n          \"type\": \"https://witness.dev/attestations/material/v0.1\"\n        },\n        {\n          \"type\": \"https://witness.dev/attestations/product/v0.1\"\n        }\n      ],\n      \"functionaries\": [\n        {\n          \"type\": \"publickey\",\n          \"publickeyid\": \"ci-key\"\n        }\n      ]\n    }\n  }\n}\n```\n\n**Pipeline Commands:**\n\n```bash\n# Step 1: Build\nwitness run --step build \\\n  --attestations git,commandrun,product \\\n  -o build.json --key ci-key.pem \\\n  -- go build -o myapp\n\n# Step 2: Test\nwitness run --step test \\\n  --attestations material,commandrun \\\n  -o test.json --key ci-key.pem \\\n  -- go test ./...\n\n# Step 3: Package\nwitness run --step package \\\n  --attestations material,product \\\n  -o package.json --key ci-key.pem \\\n  -- tar czf myapp.tar.gz myapp\n\n# Verify entire pipeline\nwitness verify \\\n  --policy policy-signed.json \\\n  --publickey policy-key.pub \\\n  -a build.json -a test.json -a package.json\n```\n"}]}
{"messages": [{"role": "system", "content": "You are an expert in the Witness supply chain attestation framework. You help users instrument CI/CD pipelines with witness, create policy documents, and write Rego policies to validate attestations. You understand all attestors in go-witness and how to use them effectively."}, {"role": "user", "content": "How do I create a witness policy for a build step that uses these attestors: environment, product, commandrun?"}, {"role": "assistant", "content": "Here's a complete witness policy for your build step with environment, product, commandrun attestors:\n\n**Policy Document:**\n```json\n{\n  \"expires\": \"2026-11-08T10:52:59Z\",\n  \"publickeys\": {\n    \"build-key\": {\n      \"keyid\": \"sha256:099b32b6b6b80effba8472c643f692c4ee6874d92aaaf8d03e12733dc416b6c8\",\n      \"key\": \"-----BEGIN PUBLIC KEY-----\\n...\\n-----END PUBLIC KEY-----\"\n    }\n  },\n  \"steps\": {\n    \"build\": {\n      \"name\": \"build\",\n      \"attestations\": [\n        {\n          \"type\": \"https://witness.dev/attestations/environment/v0.1\"\n        },\n        {\n          \"type\": \"https://witness.dev/attestations/product/v0.1\"\n        },\n        {\n          \"type\": \"https://witness.dev/attestations/command-run/v0.1\"\n        }\n      ],\n      \"functionaries\": [\n        {\n          \"type\": \"publickey\",\n          \"publickeyid\": \"build-key\"\n        }\n      ]\n    }\n  }\n}\n```\n\n**Witness Run Command:**\n```bash\nwitness run --step build \\\n  --attestations environment,product,commandrun \\\n  --outfile build-attestation.json \\\n  --key signing-key.pem \\\n  -- <your-build-command>\n```\n\n**Rego Validation Rules:**\n```rego\npackage environment\n\nimport rego.v1\n\n# Ensure correct OS\ndeny contains msg if {\n    input.os != \"windows\"\n    msg := sprintf(\"Must run on windows, got: %s\", [input.os])\n}\n\n# Require CI environment\ndeny contains msg if {\n    not \"CI\" in input.variables\n    msg := \"Must run in CI environment (CI variable not set)\"\n}\n```\n\n**Verification:**\n```bash\nwitness verify \\\n  --policy policy-signed.json \\\n  --publickey policy-key.pub \\\n  -a build-attestation.json \\\n  --subject <artifact>\n```\n"}]}
{"messages": [{"role": "system", "content": "You are an expert in the Witness supply chain attestation framework. You help users instrument CI/CD pipelines with witness, create policy documents, and write Rego policies to validate attestations. You understand all attestors in go-witness and how to use them effectively."}, {"role": "user", "content": "How do I create a multi-step witness policy for a build \u2192 test \u2192 package pipeline?"}, {"role": "assistant", "content": "Here's a complete multi-step witness policy for your pipeline:\n\n**Policy Document:**\n```json\n{\n  \"expires\": \"2026-11-08T10:52:59Z\",\n  \"publickeys\": {\n    \"ci-key\": {\n      \"keyid\": \"sha256:9cd4d996fd270f417078efc1f0f6dafad407a54e43c4fe01b2cd446a32868752\",\n      \"key\": \"-----BEGIN PUBLIC KEY-----\\n...\\n-----END PUBLIC KEY-----\"\n    }\n  },\n  \"steps\": {\n    \"build\": {\n      \"name\": \"build\",\n      \"attestations\": [\n        {\n          \"type\": \"https://witness.dev/attestations/git/v0.1\"\n        },\n        {\n          \"type\": \"https://witness.dev/attestations/command-run/v0.1\"\n        },\n        {\n          \"type\": \"https://witness.dev/attestations/product/v0.1\"\n        }\n      ],\n      \"functionaries\": [\n        {\n          \"type\": \"publickey\",\n          \"publickeyid\": \"ci-key\"\n        }\n      ]\n    },\n    \"test\": {\n      \"name\": \"test\",\n      \"attestations\": [\n        {\n          \"type\": \"https://witness.dev/attestations/material/v0.1\"\n        },\n        {\n          \"type\": \"https://witness.dev/attestations/command-run/v0.1\"\n        }\n      ],\n      \"functionaries\": [\n        {\n          \"type\": \"publickey\",\n          \"publickeyid\": \"ci-key\"\n        }\n      ]\n    },\n    \"package\": {\n      \"name\": \"package\",\n      \"attestations\": [\n        {\n          \"type\": \"https://witness.dev/attestations/material/v0.1\"\n        },\n        {\n          \"type\": \"https://witness.dev/attestations/product/v0.1\"\n        }\n      ],\n      \"functionaries\": [\n        {\n          \"type\": \"publickey\",\n          \"publickeyid\": \"ci-key\"\n        }\n      ]\n    }\n  }\n}\n```\n\n**Pipeline Commands:**\n\n```bash\n# Step 1: Build\nwitness run --step build \\\n  --attestations git,commandrun,product \\\n  -o build.json --key ci-key.pem \\\n  -- go build -o myapp\n\n# Step 2: Test\nwitness run --step test \\\n  --attestations material,commandrun \\\n  -o test.json --key ci-key.pem \\\n  -- go test ./...\n\n# Step 3: Package\nwitness run --step package \\\n  --attestations material,product \\\n  -o package.json --key ci-key.pem \\\n  -- tar czf myapp.tar.gz myapp\n\n# Verify entire pipeline\nwitness verify \\\n  --policy policy-signed.json \\\n  --publickey policy-key.pub \\\n  -a build.json -a test.json -a package.json\n```\n"}]}
{"messages": [{"role": "system", "content": "You are an expert in the Witness supply chain attestation framework. You help users instrument CI/CD pipelines with witness, create policy documents, and write Rego policies to validate attestations. You understand all attestors in go-witness and how to use them effectively."}, {"role": "user", "content": "How do I create a witness policy for a build step that uses these attestors: environment?"}, {"role": "assistant", "content": "Here's a complete witness policy for your build step with environment attestors:\n\n**Policy Document:**\n```json\n{\n  \"expires\": \"2026-11-08T10:52:59Z\",\n  \"publickeys\": {\n    \"build-key\": {\n      \"keyid\": \"sha256:efeb6ebb17d0347f0293e2702e275d2dd79d038383da3467dbd565ca6f887995\",\n      \"key\": \"-----BEGIN PUBLIC KEY-----\\n...\\n-----END PUBLIC KEY-----\"\n    }\n  },\n  \"steps\": {\n    \"build\": {\n      \"name\": \"build\",\n      \"attestations\": [\n        {\n          \"type\": \"https://witness.dev/attestations/environment/v0.1\"\n        }\n      ],\n      \"functionaries\": [\n        {\n          \"type\": \"publickey\",\n          \"publickeyid\": \"build-key\"\n        }\n      ]\n    }\n  }\n}\n```\n\n**Witness Run Command:**\n```bash\nwitness run --step build \\\n  --attestations environment \\\n  --outfile build-attestation.json \\\n  --key signing-key.pem \\\n  -- <your-build-command>\n```\n\n**Rego Validation Rules:**\n```rego\npackage environment\n\nimport rego.v1\n\n# Ensure correct OS\ndeny contains msg if {\n    input.os != \"darwin\"\n    msg := sprintf(\"Must run on darwin, got: %s\", [input.os])\n}\n\n# Require CI environment\ndeny contains msg if {\n    not \"CI\" in input.variables\n    msg := \"Must run in CI environment (CI variable not set)\"\n}\n```\n\n**Verification:**\n```bash\nwitness verify \\\n  --policy policy-signed.json \\\n  --publickey policy-key.pub \\\n  -a build-attestation.json \\\n  --subject <artifact>\n```\n"}]}
{"messages": [{"role": "system", "content": "You are an expert in the Witness supply chain attestation framework. You help users instrument CI/CD pipelines with witness, create policy documents, and write Rego policies to validate attestations. You understand all attestors in go-witness and how to use them effectively."}, {"role": "user", "content": "How do I create a witness policy for a build step that uses these attestors: environment, product, git, material, github?"}, {"role": "assistant", "content": "Here's a complete witness policy for your build step with environment, product, git, material, github attestors:\n\n**Policy Document:**\n```json\n{\n  \"expires\": \"2026-11-08T10:52:59Z\",\n  \"publickeys\": {\n    \"build-key\": {\n      \"keyid\": \"sha256:cb3a09a1ae642d09405c3d3f267491118e16ea01be85181bfe821599dbe64091\",\n      \"key\": \"-----BEGIN PUBLIC KEY-----\\n...\\n-----END PUBLIC KEY-----\"\n    }\n  },\n  \"steps\": {\n    \"build\": {\n      \"name\": \"build\",\n      \"attestations\": [\n        {\n          \"type\": \"https://witness.dev/attestations/environment/v0.1\"\n        },\n        {\n          \"type\": \"https://witness.dev/attestations/product/v0.1\"\n        },\n        {\n          \"type\": \"https://witness.dev/attestations/git/v0.1\"\n        },\n        {\n          \"type\": \"https://witness.dev/attestations/material/v0.1\"\n        },\n        {\n          \"type\": \"https://witness.dev/attestations/github/v0.1\"\n        }\n      ],\n      \"functionaries\": [\n        {\n          \"type\": \"publickey\",\n          \"publickeyid\": \"build-key\"\n        }\n      ]\n    }\n  }\n}\n```\n\n**Witness Run Command:**\n```bash\nwitness run --step build \\\n  --attestations environment,product,git,material,github \\\n  --outfile build-attestation.json \\\n  --key signing-key.pem \\\n  -- <your-build-command>\n```\n\n**Rego Validation Rules:**\n```rego\npackage environment\n\nimport rego.v1\n\n# Ensure correct OS\ndeny contains msg if {\n    input.os != \"windows\"\n    msg := sprintf(\"Must run on windows, got: %s\", [input.os])\n}\n\n# Require CI environment\ndeny contains msg if {\n    not \"CI\" in input.variables\n    msg := \"Must run in CI environment (CI variable not set)\"\n}\n```\n\n**Verification:**\n```bash\nwitness verify \\\n  --policy policy-signed.json \\\n  --publickey policy-key.pub \\\n  -a build-attestation.json \\\n  --subject <artifact>\n```\n"}]}
{"messages": [{"role": "system", "content": "You are an expert in the Witness supply chain attestation framework. You help users instrument CI/CD pipelines with witness, create policy documents, and write Rego policies to validate attestations. You understand all attestors in go-witness and how to use them effectively."}, {"role": "user", "content": "How do I create a multi-step witness policy for a build \u2192 test \u2192 package pipeline?"}, {"role": "assistant", "content": "Here's a complete multi-step witness policy for your pipeline:\n\n**Policy Document:**\n```json\n{\n  \"expires\": \"2026-11-08T10:52:59Z\",\n  \"publickeys\": {\n    \"ci-key\": {\n      \"keyid\": \"sha256:ca79a049fc14af800b0e78c4b3e775c4410c3ff87ef1ff92f3967c84dec552e9\",\n      \"key\": \"-----BEGIN PUBLIC KEY-----\\n...\\n-----END PUBLIC KEY-----\"\n    }\n  },\n  \"steps\": {\n    \"build\": {\n      \"name\": \"build\",\n      \"attestations\": [\n        {\n          \"type\": \"https://witness.dev/attestations/git/v0.1\"\n        },\n        {\n          \"type\": \"https://witness.dev/attestations/command-run/v0.1\"\n        },\n        {\n          \"type\": \"https://witness.dev/attestations/product/v0.1\"\n        }\n      ],\n      \"functionaries\": [\n        {\n          \"type\": \"publickey\",\n          \"publickeyid\": \"ci-key\"\n        }\n      ]\n    },\n    \"test\": {\n      \"name\": \"test\",\n      \"attestations\": [\n        {\n          \"type\": \"https://witness.dev/attestations/material/v0.1\"\n        },\n        {\n          \"type\": \"https://witness.dev/attestations/command-run/v0.1\"\n        }\n      ],\n      \"functionaries\": [\n        {\n          \"type\": \"publickey\",\n          \"publickeyid\": \"ci-key\"\n        }\n      ]\n    },\n    \"package\": {\n      \"name\": \"package\",\n      \"attestations\": [\n        {\n          \"type\": \"https://witness.dev/attestations/material/v0.1\"\n        },\n        {\n          \"type\": \"https://witness.dev/attestations/product/v0.1\"\n        }\n      ],\n      \"functionaries\": [\n        {\n          \"type\": \"publickey\",\n          \"publickeyid\": \"ci-key\"\n        }\n      ]\n    }\n  }\n}\n```\n\n**Pipeline Commands:**\n\n```bash\n# Step 1: Build\nwitness run --step build \\\n  --attestations git,commandrun,product \\\n  -o build.json --key ci-key.pem \\\n  -- go build -o myapp\n\n# Step 2: Test\nwitness run --step test \\\n  --attestations material,commandrun \\\n  -o test.json --key ci-key.pem \\\n  -- go test ./...\n\n# Step 3: Package\nwitness run --step package \\\n  --attestations material,product \\\n  -o package.json --key ci-key.pem \\\n  -- tar czf myapp.tar.gz myapp\n\n# Verify entire pipeline\nwitness verify \\\n  --policy policy-signed.json \\\n  --publickey policy-key.pub \\\n  -a build.json -a test.json -a package.json\n```\n"}]}
{"messages": [{"role": "system", "content": "You are an expert in the Witness supply chain attestation framework. You help users instrument CI/CD pipelines with witness, create policy documents, and write Rego policies to validate attestations. You understand all attestors in go-witness and how to use them effectively."}, {"role": "user", "content": "How do I create a multi-step witness policy for a build \u2192 test \u2192 package pipeline?"}, {"role": "assistant", "content": "Here's a complete multi-step witness policy for your pipeline:\n\n**Policy Document:**\n```json\n{\n  \"expires\": \"2026-11-08T10:52:59Z\",\n  \"publickeys\": {\n    \"ci-key\": {\n      \"keyid\": \"sha256:88faf77acf1391e9c3bc0d2b3e1a3846bd96a9fcc198d717f0a734889c89b127\",\n      \"key\": \"-----BEGIN PUBLIC KEY-----\\n...\\n-----END PUBLIC KEY-----\"\n    }\n  },\n  \"steps\": {\n    \"build\": {\n      \"name\": \"build\",\n      \"attestations\": [\n        {\n          \"type\": \"https://witness.dev/attestations/git/v0.1\"\n        },\n        {\n          \"type\": \"https://witness.dev/attestations/command-run/v0.1\"\n        },\n        {\n          \"type\": \"https://witness.dev/attestations/product/v0.1\"\n        }\n      ],\n      \"functionaries\": [\n        {\n          \"type\": \"publickey\",\n          \"publickeyid\": \"ci-key\"\n        }\n      ]\n    },\n    \"test\": {\n      \"name\": \"test\",\n      \"attestations\": [\n        {\n          \"type\": \"https://witness.dev/attestations/material/v0.1\"\n        },\n        {\n          \"type\": \"https://witness.dev/attestations/command-run/v0.1\"\n        }\n      ],\n      \"functionaries\": [\n        {\n          \"type\": \"publickey\",\n          \"publickeyid\": \"ci-key\"\n        }\n      ]\n    },\n    \"package\": {\n      \"name\": \"package\",\n      \"attestations\": [\n        {\n          \"type\": \"https://witness.dev/attestations/material/v0.1\"\n        },\n        {\n          \"type\": \"https://witness.dev/attestations/product/v0.1\"\n        }\n      ],\n      \"functionaries\": [\n        {\n          \"type\": \"publickey\",\n          \"publickeyid\": \"ci-key\"\n        }\n      ]\n    }\n  }\n}\n```\n\n**Pipeline Commands:**\n\n```bash\n# Step 1: Build\nwitness run --step build \\\n  --attestations git,commandrun,product \\\n  -o build.json --key ci-key.pem \\\n  -- go build -o myapp\n\n# Step 2: Test\nwitness run --step test \\\n  --attestations material,commandrun \\\n  -o test.json --key ci-key.pem \\\n  -- go test ./...\n\n# Step 3: Package\nwitness run --step package \\\n  --attestations material,product \\\n  -o package.json --key ci-key.pem \\\n  -- tar czf myapp.tar.gz myapp\n\n# Verify entire pipeline\nwitness verify \\\n  --policy policy-signed.json \\\n  --publickey policy-key.pub \\\n  -a build.json -a test.json -a package.json\n```\n"}]}
{"messages": [{"role": "system", "content": "You are an expert in the Witness supply chain attestation framework. You help users instrument CI/CD pipelines with witness, create policy documents, and write Rego policies to validate attestations. You understand all attestors in go-witness and how to use them effectively."}, {"role": "user", "content": "How do I create a witness policy for a build step that uses these attestors: github, git, material?"}, {"role": "assistant", "content": "Here's a complete witness policy for your build step with github, git, material attestors:\n\n**Policy Document:**\n```json\n{\n  \"expires\": \"2026-11-08T10:52:59Z\",\n  \"publickeys\": {\n    \"build-key\": {\n      \"keyid\": \"sha256:96f005c087563fd4a42bf98507d217a6f94d5462b40e33604d24383f757b9de6\",\n      \"key\": \"-----BEGIN PUBLIC KEY-----\\n...\\n-----END PUBLIC KEY-----\"\n    }\n  },\n  \"steps\": {\n    \"build\": {\n      \"name\": \"build\",\n      \"attestations\": [\n        {\n          \"type\": \"https://witness.dev/attestations/github/v0.1\"\n        },\n        {\n          \"type\": \"https://witness.dev/attestations/git/v0.1\"\n        },\n        {\n          \"type\": \"https://witness.dev/attestations/material/v0.1\"\n        }\n      ],\n      \"functionaries\": [\n        {\n          \"type\": \"publickey\",\n          \"publickeyid\": \"build-key\"\n        }\n      ]\n    }\n  }\n}\n```\n\n**Witness Run Command:**\n```bash\nwitness run --step build \\\n  --attestations github,git,material \\\n  --outfile build-attestation.json \\\n  --key signing-key.pem \\\n  -- <your-build-command>\n```\n\n**Rego Validation Rules:**\n```rego\n\n```\n\n**Verification:**\n```bash\nwitness verify \\\n  --policy policy-signed.json \\\n  --publickey policy-key.pub \\\n  -a build-attestation.json \\\n  --subject <artifact>\n```\n"}]}
{"messages": [{"role": "system", "content": "You are an expert in the Witness supply chain attestation framework. You help users instrument CI/CD pipelines with witness, create policy documents, and write Rego policies to validate attestations. You understand all attestors in go-witness and how to use them effectively."}, {"role": "user", "content": "How do I create a witness policy for a build step that uses these attestors: git, commandrun?"}, {"role": "assistant", "content": "Here's a complete witness policy for your build step with git, commandrun attestors:\n\n**Policy Document:**\n```json\n{\n  \"expires\": \"2026-11-08T10:52:59Z\",\n  \"publickeys\": {\n    \"build-key\": {\n      \"keyid\": \"sha256:b7e7e1c9f958aeb33f3ccf24485760941e6916b625c4a24e33433421634a6da6\",\n      \"key\": \"-----BEGIN PUBLIC KEY-----\\n...\\n-----END PUBLIC KEY-----\"\n    }\n  },\n  \"steps\": {\n    \"build\": {\n      \"name\": \"build\",\n      \"attestations\": [\n        {\n          \"type\": \"https://witness.dev/attestations/git/v0.1\"\n        },\n        {\n          \"type\": \"https://witness.dev/attestations/command-run/v0.1\"\n        }\n      ],\n      \"functionaries\": [\n        {\n          \"type\": \"publickey\",\n          \"publickeyid\": \"build-key\"\n        }\n      ]\n    }\n  }\n}\n```\n\n**Witness Run Command:**\n```bash\nwitness run --step build \\\n  --attestations git,commandrun \\\n  --outfile build-attestation.json \\\n  --key signing-key.pem \\\n  -- <your-build-command>\n```\n\n**Rego Validation Rules:**\n```rego\npackage git\n\nimport rego.v1\n\n# Enforce builds from specific branch\ndeny contains msg if {\n    input.branch != \"bugfix/security\"\n    msg := sprintf(\"Must build from bugfix/security branch, got: %s\", [input.branch])\n}\n\n# Require clean working directory\ndeny contains msg if {\n    count(input.status) > 0\n    msg := \"Working directory must be clean (no uncommitted changes)\"\n}\n\n# Validate commit author\napproved_authors := {\n    \"alice.smith@example.com\",\n    \"bob.jones@company.com\",\n    \"ci-bot@company.com\"\n}\n\ndeny contains msg if {\n    not input.authoremail in approved_authors\n    msg := sprintf(\"Unauthorized commit author: %s\", [input.authoremail])\n}\n```\n\n**Verification:**\n```bash\nwitness verify \\\n  --policy policy-signed.json \\\n  --publickey policy-key.pub \\\n  -a build-attestation.json \\\n  --subject <artifact>\n```\n"}]}
{"messages": [{"role": "system", "content": "You are an expert in the Witness supply chain attestation framework. You help users instrument CI/CD pipelines with witness, create policy documents, and write Rego policies to validate attestations. You understand all attestors in go-witness and how to use them effectively."}, {"role": "user", "content": "How do I create a witness policy for a build step that uses these attestors: material, product, environment?"}, {"role": "assistant", "content": "Here's a complete witness policy for your build step with material, product, environment attestors:\n\n**Policy Document:**\n```json\n{\n  \"expires\": \"2026-11-08T10:52:59Z\",\n  \"publickeys\": {\n    \"build-key\": {\n      \"keyid\": \"sha256:b779cdecc3b525fd430a6883886fbf9b1a22878351548b3f2ce8e6427bf31005\",\n      \"key\": \"-----BEGIN PUBLIC KEY-----\\n...\\n-----END PUBLIC KEY-----\"\n    }\n  },\n  \"steps\": {\n    \"build\": {\n      \"name\": \"build\",\n      \"attestations\": [\n        {\n          \"type\": \"https://witness.dev/attestations/material/v0.1\"\n        },\n        {\n          \"type\": \"https://witness.dev/attestations/product/v0.1\"\n        },\n        {\n          \"type\": \"https://witness.dev/attestations/environment/v0.1\"\n        }\n      ],\n      \"functionaries\": [\n        {\n          \"type\": \"publickey\",\n          \"publickeyid\": \"build-key\"\n        }\n      ]\n    }\n  }\n}\n```\n\n**Witness Run Command:**\n```bash\nwitness run --step build \\\n  --attestations material,product,environment \\\n  --outfile build-attestation.json \\\n  --key signing-key.pem \\\n  -- <your-build-command>\n```\n\n**Rego Validation Rules:**\n```rego\n\n```\n\n**Verification:**\n```bash\nwitness verify \\\n  --policy policy-signed.json \\\n  --publickey policy-key.pub \\\n  -a build-attestation.json \\\n  --subject <artifact>\n```\n"}]}
{"messages": [{"role": "system", "content": "You are an expert in the Witness supply chain attestation framework. You help users instrument CI/CD pipelines with witness, create policy documents, and write Rego policies to validate attestations. You understand all attestors in go-witness and how to use them effectively."}, {"role": "user", "content": "How do I create a multi-step witness policy for a build \u2192 test \u2192 package pipeline?"}, {"role": "assistant", "content": "Here's a complete multi-step witness policy for your pipeline:\n\n**Policy Document:**\n```json\n{\n  \"expires\": \"2026-11-08T10:52:59Z\",\n  \"publickeys\": {\n    \"ci-key\": {\n      \"keyid\": \"sha256:f8bbe687ce16ee30140c2b3ea9eecbf15a47ccfee869482c5489a484abbef100\",\n      \"key\": \"-----BEGIN PUBLIC KEY-----\\n...\\n-----END PUBLIC KEY-----\"\n    }\n  },\n  \"steps\": {\n    \"build\": {\n      \"name\": \"build\",\n      \"attestations\": [\n        {\n          \"type\": \"https://witness.dev/attestations/git/v0.1\"\n        },\n        {\n          \"type\": \"https://witness.dev/attestations/command-run/v0.1\"\n        },\n        {\n          \"type\": \"https://witness.dev/attestations/product/v0.1\"\n        }\n      ],\n      \"functionaries\": [\n        {\n          \"type\": \"publickey\",\n          \"publickeyid\": \"ci-key\"\n        }\n      ]\n    },\n    \"test\": {\n      \"name\": \"test\",\n      \"attestations\": [\n        {\n          \"type\": \"https://witness.dev/attestations/material/v0.1\"\n        },\n        {\n          \"type\": \"https://witness.dev/attestations/command-run/v0.1\"\n        }\n      ],\n      \"functionaries\": [\n        {\n          \"type\": \"publickey\",\n          \"publickeyid\": \"ci-key\"\n        }\n      ]\n    },\n    \"package\": {\n      \"name\": \"package\",\n      \"attestations\": [\n        {\n          \"type\": \"https://witness.dev/attestations/material/v0.1\"\n        },\n        {\n          \"type\": \"https://witness.dev/attestations/product/v0.1\"\n        }\n      ],\n      \"functionaries\": [\n        {\n          \"type\": \"publickey\",\n          \"publickeyid\": \"ci-key\"\n        }\n      ]\n    }\n  }\n}\n```\n\n**Pipeline Commands:**\n\n```bash\n# Step 1: Build\nwitness run --step build \\\n  --attestations git,commandrun,product \\\n  -o build.json --key ci-key.pem \\\n  -- go build -o myapp\n\n# Step 2: Test\nwitness run --step test \\\n  --attestations material,commandrun \\\n  -o test.json --key ci-key.pem \\\n  -- go test ./...\n\n# Step 3: Package\nwitness run --step package \\\n  --attestations material,product \\\n  -o package.json --key ci-key.pem \\\n  -- tar czf myapp.tar.gz myapp\n\n# Verify entire pipeline\nwitness verify \\\n  --policy policy-signed.json \\\n  --publickey policy-key.pub \\\n  -a build.json -a test.json -a package.json\n```\n"}]}
{"messages": [{"role": "system", "content": "You are an expert in the Witness supply chain attestation framework. You help users instrument CI/CD pipelines with witness, create policy documents, and write Rego policies to validate attestations. You understand all attestors in go-witness and how to use them effectively."}, {"role": "user", "content": "How do I create a witness policy for a build step that uses these attestors: product, environment, github, commandrun, git?"}, {"role": "assistant", "content": "Here's a complete witness policy for your build step with product, environment, github, commandrun, git attestors:\n\n**Policy Document:**\n```json\n{\n  \"expires\": \"2026-11-08T10:52:59Z\",\n  \"publickeys\": {\n    \"build-key\": {\n      \"keyid\": \"sha256:95e95affc1d1a7507954da3ad29ae18c246553ea0d28e2d19124ef6325f86a65\",\n      \"key\": \"-----BEGIN PUBLIC KEY-----\\n...\\n-----END PUBLIC KEY-----\"\n    }\n  },\n  \"steps\": {\n    \"build\": {\n      \"name\": \"build\",\n      \"attestations\": [\n        {\n          \"type\": \"https://witness.dev/attestations/product/v0.1\"\n        },\n        {\n          \"type\": \"https://witness.dev/attestations/environment/v0.1\"\n        },\n        {\n          \"type\": \"https://witness.dev/attestations/github/v0.1\"\n        },\n        {\n          \"type\": \"https://witness.dev/attestations/command-run/v0.1\"\n        },\n        {\n          \"type\": \"https://witness.dev/attestations/git/v0.1\"\n        }\n      ],\n      \"functionaries\": [\n        {\n          \"type\": \"publickey\",\n          \"publickeyid\": \"build-key\"\n        }\n      ]\n    }\n  }\n}\n```\n\n**Witness Run Command:**\n```bash\nwitness run --step build \\\n  --attestations product,environment,github,commandrun,git \\\n  --outfile build-attestation.json \\\n  --key signing-key.pem \\\n  -- <your-build-command>\n```\n\n**Rego Validation Rules:**\n```rego\n\n```\n\n**Verification:**\n```bash\nwitness verify \\\n  --policy policy-signed.json \\\n  --publickey policy-key.pub \\\n  -a build-attestation.json \\\n  --subject <artifact>\n```\n"}]}
{"messages": [{"role": "system", "content": "You are an expert in the Witness supply chain attestation framework. You help users instrument CI/CD pipelines with witness, create policy documents, and write Rego policies to validate attestations. You understand all attestors in go-witness and how to use them effectively."}, {"role": "user", "content": "How do I create a witness policy for a build step that uses these attestors: github, material, git, environment, product?"}, {"role": "assistant", "content": "Here's a complete witness policy for your build step with github, material, git, environment, product attestors:\n\n**Policy Document:**\n```json\n{\n  \"expires\": \"2026-11-08T10:52:59Z\",\n  \"publickeys\": {\n    \"build-key\": {\n      \"keyid\": \"sha256:04ac6181221d70b97bbcbd71d5da195f968c118faff86b81e7da9493067267be\",\n      \"key\": \"-----BEGIN PUBLIC KEY-----\\n...\\n-----END PUBLIC KEY-----\"\n    }\n  },\n  \"steps\": {\n    \"build\": {\n      \"name\": \"build\",\n      \"attestations\": [\n        {\n          \"type\": \"https://witness.dev/attestations/github/v0.1\"\n        },\n        {\n          \"type\": \"https://witness.dev/attestations/material/v0.1\"\n        },\n        {\n          \"type\": \"https://witness.dev/attestations/git/v0.1\"\n        },\n        {\n          \"type\": \"https://witness.dev/attestations/environment/v0.1\"\n        },\n        {\n          \"type\": \"https://witness.dev/attestations/product/v0.1\"\n        }\n      ],\n      \"functionaries\": [\n        {\n          \"type\": \"publickey\",\n          \"publickeyid\": \"build-key\"\n        }\n      ]\n    }\n  }\n}\n```\n\n**Witness Run Command:**\n```bash\nwitness run --step build \\\n  --attestations github,material,git,environment,product \\\n  --outfile build-attestation.json \\\n  --key signing-key.pem \\\n  -- <your-build-command>\n```\n\n**Rego Validation Rules:**\n```rego\n\n```\n\n**Verification:**\n```bash\nwitness verify \\\n  --policy policy-signed.json \\\n  --publickey policy-key.pub \\\n  -a build-attestation.json \\\n  --subject <artifact>\n```\n"}]}
{"messages": [{"role": "system", "content": "You are an expert in the Witness supply chain attestation framework. You help users instrument CI/CD pipelines with witness, create policy documents, and write Rego policies to validate attestations. You understand all attestors in go-witness and how to use them effectively."}, {"role": "user", "content": "How do I create a witness policy for a build step that uses these attestors: environment, git, commandrun, material?"}, {"role": "assistant", "content": "Here's a complete witness policy for your build step with environment, git, commandrun, material attestors:\n\n**Policy Document:**\n```json\n{\n  \"expires\": \"2026-11-08T10:52:59Z\",\n  \"publickeys\": {\n    \"build-key\": {\n      \"keyid\": \"sha256:d3b3b6b759b70b4e97989f7eb86bbc5c7a4fcdda2b7aa74c0a93424376d9f8f7\",\n      \"key\": \"-----BEGIN PUBLIC KEY-----\\n...\\n-----END PUBLIC KEY-----\"\n    }\n  },\n  \"steps\": {\n    \"build\": {\n      \"name\": \"build\",\n      \"attestations\": [\n        {\n          \"type\": \"https://witness.dev/attestations/environment/v0.1\"\n        },\n        {\n          \"type\": \"https://witness.dev/attestations/git/v0.1\"\n        },\n        {\n          \"type\": \"https://witness.dev/attestations/command-run/v0.1\"\n        },\n        {\n          \"type\": \"https://witness.dev/attestations/material/v0.1\"\n        }\n      ],\n      \"functionaries\": [\n        {\n          \"type\": \"publickey\",\n          \"publickeyid\": \"build-key\"\n        }\n      ]\n    }\n  }\n}\n```\n\n**Witness Run Command:**\n```bash\nwitness run --step build \\\n  --attestations environment,git,commandrun,material \\\n  --outfile build-attestation.json \\\n  --key signing-key.pem \\\n  -- <your-build-command>\n```\n\n**Rego Validation Rules:**\n```rego\npackage environment\n\nimport rego.v1\n\n# Ensure correct OS\ndeny contains msg if {\n    input.os != \"windows\"\n    msg := sprintf(\"Must run on windows, got: %s\", [input.os])\n}\n\n# Require CI environment\ndeny contains msg if {\n    not \"CI\" in input.variables\n    msg := \"Must run in CI environment (CI variable not set)\"\n}\n```\n\n**Verification:**\n```bash\nwitness verify \\\n  --policy policy-signed.json \\\n  --publickey policy-key.pub \\\n  -a build-attestation.json \\\n  --subject <artifact>\n```\n"}]}
{"messages": [{"role": "system", "content": "You are an expert in the Witness supply chain attestation framework. You help users instrument CI/CD pipelines with witness, create policy documents, and write Rego policies to validate attestations. You understand all attestors in go-witness and how to use them effectively."}, {"role": "user", "content": "How do I create a witness policy for a build step that uses these attestors: git, github, product?"}, {"role": "assistant", "content": "Here's a complete witness policy for your build step with git, github, product attestors:\n\n**Policy Document:**\n```json\n{\n  \"expires\": \"2026-11-08T10:52:59Z\",\n  \"publickeys\": {\n    \"build-key\": {\n      \"keyid\": \"sha256:67b151acf35501733192f4f5c580a65640bec23ecbce4b16345716f9ef00808a\",\n      \"key\": \"-----BEGIN PUBLIC KEY-----\\n...\\n-----END PUBLIC KEY-----\"\n    }\n  },\n  \"steps\": {\n    \"build\": {\n      \"name\": \"build\",\n      \"attestations\": [\n        {\n          \"type\": \"https://witness.dev/attestations/git/v0.1\"\n        },\n        {\n          \"type\": \"https://witness.dev/attestations/github/v0.1\"\n        },\n        {\n          \"type\": \"https://witness.dev/attestations/product/v0.1\"\n        }\n      ],\n      \"functionaries\": [\n        {\n          \"type\": \"publickey\",\n          \"publickeyid\": \"build-key\"\n        }\n      ]\n    }\n  }\n}\n```\n\n**Witness Run Command:**\n```bash\nwitness run --step build \\\n  --attestations git,github,product \\\n  --outfile build-attestation.json \\\n  --key signing-key.pem \\\n  -- <your-build-command>\n```\n\n**Rego Validation Rules:**\n```rego\npackage git\n\nimport rego.v1\n\n# Enforce builds from specific branch\ndeny contains msg if {\n    input.branch != \"hotfix/critical\"\n    msg := sprintf(\"Must build from hotfix/critical branch, got: %s\", [input.branch])\n}\n\n# Validate commit author\napproved_authors := {\n    \"alice.smith@example.com\",\n    \"bob.jones@company.com\",\n    \"ci-bot@company.com\"\n}\n\ndeny contains msg if {\n    not input.authoremail in approved_authors\n    msg := sprintf(\"Unauthorized commit author: %s\", [input.authoremail])\n}\n```\n\n**Verification:**\n```bash\nwitness verify \\\n  --policy policy-signed.json \\\n  --publickey policy-key.pub \\\n  -a build-attestation.json \\\n  --subject <artifact>\n```\n"}]}
{"messages": [{"role": "system", "content": "You are an expert in the Witness supply chain attestation framework. You help users instrument CI/CD pipelines with witness, create policy documents, and write Rego policies to validate attestations. You understand all attestors in go-witness and how to use them effectively."}, {"role": "user", "content": "How do I create a witness policy for a build step that uses these attestors: git, commandrun, material?"}, {"role": "assistant", "content": "Here's a complete witness policy for your build step with git, commandrun, material attestors:\n\n**Policy Document:**\n```json\n{\n  \"expires\": \"2026-11-08T10:52:59Z\",\n  \"publickeys\": {\n    \"build-key\": {\n      \"keyid\": \"sha256:a0bec3b130fbd3d99a2eb6171d86fe2be49a8b83ecc747aa5c6b7b00694182e9\",\n      \"key\": \"-----BEGIN PUBLIC KEY-----\\n...\\n-----END PUBLIC KEY-----\"\n    }\n  },\n  \"steps\": {\n    \"build\": {\n      \"name\": \"build\",\n      \"attestations\": [\n        {\n          \"type\": \"https://witness.dev/attestations/git/v0.1\"\n        },\n        {\n          \"type\": \"https://witness.dev/attestations/command-run/v0.1\"\n        },\n        {\n          \"type\": \"https://witness.dev/attestations/material/v0.1\"\n        }\n      ],\n      \"functionaries\": [\n        {\n          \"type\": \"publickey\",\n          \"publickeyid\": \"build-key\"\n        }\n      ]\n    }\n  }\n}\n```\n\n**Witness Run Command:**\n```bash\nwitness run --step build \\\n  --attestations git,commandrun,material \\\n  --outfile build-attestation.json \\\n  --key signing-key.pem \\\n  -- <your-build-command>\n```\n\n**Rego Validation Rules:**\n```rego\npackage git\n\nimport rego.v1\n\n# Enforce builds from specific branch\ndeny contains msg if {\n    input.branch != \"staging\"\n    msg := sprintf(\"Must build from staging branch, got: %s\", [input.branch])\n}\n\n# Require clean working directory\ndeny contains msg if {\n    count(input.status) > 0\n    msg := \"Working directory must be clean (no uncommitted changes)\"\n}\n\n# Validate commit author\napproved_authors := {\n    \"alice.smith@example.com\",\n    \"bob.jones@company.com\",\n    \"ci-bot@company.com\"\n}\n\ndeny contains msg if {\n    not input.authoremail in approved_authors\n    msg := sprintf(\"Unauthorized commit author: %s\", [input.authoremail])\n}\n```\n\n**Verification:**\n```bash\nwitness verify \\\n  --policy policy-signed.json \\\n  --publickey policy-key.pub \\\n  -a build-attestation.json \\\n  --subject <artifact>\n```\n"}]}
{"messages": [{"role": "system", "content": "You are an expert in the Witness supply chain attestation framework. You help users instrument CI/CD pipelines with witness, create policy documents, and write Rego policies to validate attestations. You understand all attestors in go-witness and how to use them effectively."}, {"role": "user", "content": "How do I create a witness policy for a build step that uses these attestors: git?"}, {"role": "assistant", "content": "Here's a complete witness policy for your build step with git attestors:\n\n**Policy Document:**\n```json\n{\n  \"expires\": \"2026-11-08T10:52:59Z\",\n  \"publickeys\": {\n    \"build-key\": {\n      \"keyid\": \"sha256:415ad044f02b416af46d3f566e845568a96a9b37a5563a8c5b7610651ef916bd\",\n      \"key\": \"-----BEGIN PUBLIC KEY-----\\n...\\n-----END PUBLIC KEY-----\"\n    }\n  },\n  \"steps\": {\n    \"build\": {\n      \"name\": \"build\",\n      \"attestations\": [\n        {\n          \"type\": \"https://witness.dev/attestations/git/v0.1\"\n        }\n      ],\n      \"functionaries\": [\n        {\n          \"type\": \"publickey\",\n          \"publickeyid\": \"build-key\"\n        }\n      ]\n    }\n  }\n}\n```\n\n**Witness Run Command:**\n```bash\nwitness run --step build \\\n  --attestations git \\\n  --outfile build-attestation.json \\\n  --key signing-key.pem \\\n  -- <your-build-command>\n```\n\n**Rego Validation Rules:**\n```rego\npackage git\n\nimport rego.v1\n\n# Enforce builds from specific branch\ndeny contains msg if {\n    input.branch != \"feature/auth\"\n    msg := sprintf(\"Must build from feature/auth branch, got: %s\", [input.branch])\n}\n\n# Require clean working directory\ndeny contains msg if {\n    count(input.status) > 0\n    msg := \"Working directory must be clean (no uncommitted changes)\"\n}\n\n# Validate commit author\napproved_authors := {\n    \"alice.smith@example.com\",\n    \"bob.jones@company.com\",\n    \"ci-bot@company.com\"\n}\n\ndeny contains msg if {\n    not input.authoremail in approved_authors\n    msg := sprintf(\"Unauthorized commit author: %s\", [input.authoremail])\n}\n```\n\n**Verification:**\n```bash\nwitness verify \\\n  --policy policy-signed.json \\\n  --publickey policy-key.pub \\\n  -a build-attestation.json \\\n  --subject <artifact>\n```\n"}]}
{"messages": [{"role": "system", "content": "You are an expert in the Witness supply chain attestation framework. You help users instrument CI/CD pipelines with witness, create policy documents, and write Rego policies to validate attestations. You understand all attestors in go-witness and how to use them effectively."}, {"role": "user", "content": "How do I create a witness policy for a build step that uses these attestors: git, product, material, environment?"}, {"role": "assistant", "content": "Here's a complete witness policy for your build step with git, product, material, environment attestors:\n\n**Policy Document:**\n```json\n{\n  \"expires\": \"2026-11-08T10:52:59Z\",\n  \"publickeys\": {\n    \"build-key\": {\n      \"keyid\": \"sha256:247c66398344862e8f4a94f449e766e90a72c8669f75f66aca1c7dbf79c5369f\",\n      \"key\": \"-----BEGIN PUBLIC KEY-----\\n...\\n-----END PUBLIC KEY-----\"\n    }\n  },\n  \"steps\": {\n    \"build\": {\n      \"name\": \"build\",\n      \"attestations\": [\n        {\n          \"type\": \"https://witness.dev/attestations/git/v0.1\"\n        },\n        {\n          \"type\": \"https://witness.dev/attestations/product/v0.1\"\n        },\n        {\n          \"type\": \"https://witness.dev/attestations/material/v0.1\"\n        },\n        {\n          \"type\": \"https://witness.dev/attestations/environment/v0.1\"\n        }\n      ],\n      \"functionaries\": [\n        {\n          \"type\": \"publickey\",\n          \"publickeyid\": \"build-key\"\n        }\n      ]\n    }\n  }\n}\n```\n\n**Witness Run Command:**\n```bash\nwitness run --step build \\\n  --attestations git,product,material,environment \\\n  --outfile build-attestation.json \\\n  --key signing-key.pem \\\n  -- <your-build-command>\n```\n\n**Rego Validation Rules:**\n```rego\npackage git\n\nimport rego.v1\n\n# Enforce builds from specific branch\ndeny contains msg if {\n    input.branch != \"main\"\n    msg := sprintf(\"Must build from main branch, got: %s\", [input.branch])\n}\n\n# Validate commit author\napproved_authors := {\n    \"alice.smith@example.com\",\n    \"bob.jones@company.com\",\n    \"ci-bot@company.com\"\n}\n\ndeny contains msg if {\n    not input.authoremail in approved_authors\n    msg := sprintf(\"Unauthorized commit author: %s\", [input.authoremail])\n}\n```\n\n**Verification:**\n```bash\nwitness verify \\\n  --policy policy-signed.json \\\n  --publickey policy-key.pub \\\n  -a build-attestation.json \\\n  --subject <artifact>\n```\n"}]}
{"messages": [{"role": "system", "content": "You are an expert in the Witness supply chain attestation framework. You help users instrument CI/CD pipelines with witness, create policy documents, and write Rego policies to validate attestations. You understand all attestors in go-witness and how to use them effectively."}, {"role": "user", "content": "How do I create a multi-step witness policy for a build \u2192 test \u2192 package pipeline?"}, {"role": "assistant", "content": "Here's a complete multi-step witness policy for your pipeline:\n\n**Policy Document:**\n```json\n{\n  \"expires\": \"2026-11-08T10:52:59Z\",\n  \"publickeys\": {\n    \"ci-key\": {\n      \"keyid\": \"sha256:3631c5f3b25ffb06153e63b20046b3c95f3c20a96da3a198c3fbef8079c324c5\",\n      \"key\": \"-----BEGIN PUBLIC KEY-----\\n...\\n-----END PUBLIC KEY-----\"\n    }\n  },\n  \"steps\": {\n    \"build\": {\n      \"name\": \"build\",\n      \"attestations\": [\n        {\n          \"type\": \"https://witness.dev/attestations/git/v0.1\"\n        },\n        {\n          \"type\": \"https://witness.dev/attestations/command-run/v0.1\"\n        },\n        {\n          \"type\": \"https://witness.dev/attestations/product/v0.1\"\n        }\n      ],\n      \"functionaries\": [\n        {\n          \"type\": \"publickey\",\n          \"publickeyid\": \"ci-key\"\n        }\n      ]\n    },\n    \"test\": {\n      \"name\": \"test\",\n      \"attestations\": [\n        {\n          \"type\": \"https://witness.dev/attestations/material/v0.1\"\n        },\n        {\n          \"type\": \"https://witness.dev/attestations/command-run/v0.1\"\n        }\n      ],\n      \"functionaries\": [\n        {\n          \"type\": \"publickey\",\n          \"publickeyid\": \"ci-key\"\n        }\n      ]\n    },\n    \"package\": {\n      \"name\": \"package\",\n      \"attestations\": [\n        {\n          \"type\": \"https://witness.dev/attestations/material/v0.1\"\n        },\n        {\n          \"type\": \"https://witness.dev/attestations/product/v0.1\"\n        }\n      ],\n      \"functionaries\": [\n        {\n          \"type\": \"publickey\",\n          \"publickeyid\": \"ci-key\"\n        }\n      ]\n    }\n  }\n}\n```\n\n**Pipeline Commands:**\n\n```bash\n# Step 1: Build\nwitness run --step build \\\n  --attestations git,commandrun,product \\\n  -o build.json --key ci-key.pem \\\n  -- go build -o myapp\n\n# Step 2: Test\nwitness run --step test \\\n  --attestations material,commandrun \\\n  -o test.json --key ci-key.pem \\\n  -- go test ./...\n\n# Step 3: Package\nwitness run --step package \\\n  --attestations material,product \\\n  -o package.json --key ci-key.pem \\\n  -- tar czf myapp.tar.gz myapp\n\n# Verify entire pipeline\nwitness verify \\\n  --policy policy-signed.json \\\n  --publickey policy-key.pub \\\n  -a build.json -a test.json -a package.json\n```\n"}]}
{"messages": [{"role": "system", "content": "You are an expert in the Witness supply chain attestation framework. You help users instrument CI/CD pipelines with witness, create policy documents, and write Rego policies to validate attestations. You understand all attestors in go-witness and how to use them effectively."}, {"role": "user", "content": "How do I create a witness policy for a build step that uses these attestors: git?"}, {"role": "assistant", "content": "Here's a complete witness policy for your build step with git attestors:\n\n**Policy Document:**\n```json\n{\n  \"expires\": \"2026-11-08T10:52:59Z\",\n  \"publickeys\": {\n    \"build-key\": {\n      \"keyid\": \"sha256:c298dcdb71be501391b78997080d707bc465216395ebc51775403ae165e0e75c\",\n      \"key\": \"-----BEGIN PUBLIC KEY-----\\n...\\n-----END PUBLIC KEY-----\"\n    }\n  },\n  \"steps\": {\n    \"build\": {\n      \"name\": \"build\",\n      \"attestations\": [\n        {\n          \"type\": \"https://witness.dev/attestations/git/v0.1\"\n        }\n      ],\n      \"functionaries\": [\n        {\n          \"type\": \"publickey\",\n          \"publickeyid\": \"build-key\"\n        }\n      ]\n    }\n  }\n}\n```\n\n**Witness Run Command:**\n```bash\nwitness run --step build \\\n  --attestations git \\\n  --outfile build-attestation.json \\\n  --key signing-key.pem \\\n  -- <your-build-command>\n```\n\n**Rego Validation Rules:**\n```rego\npackage git\n\nimport rego.v1\n\n# Enforce builds from specific branch\ndeny contains msg if {\n    input.branch != \"bugfix/security\"\n    msg := sprintf(\"Must build from bugfix/security branch, got: %s\", [input.branch])\n}\n\n# Require clean working directory\ndeny contains msg if {\n    count(input.status) > 0\n    msg := \"Working directory must be clean (no uncommitted changes)\"\n}\n\n# Validate commit author\napproved_authors := {\n    \"alice.smith@example.com\",\n    \"bob.jones@company.com\",\n    \"ci-bot@company.com\"\n}\n\ndeny contains msg if {\n    not input.authoremail in approved_authors\n    msg := sprintf(\"Unauthorized commit author: %s\", [input.authoremail])\n}\n```\n\n**Verification:**\n```bash\nwitness verify \\\n  --policy policy-signed.json \\\n  --publickey policy-key.pub \\\n  -a build-attestation.json \\\n  --subject <artifact>\n```\n"}]}
{"messages": [{"role": "system", "content": "You are an expert in the Witness supply chain attestation framework. You help users instrument CI/CD pipelines with witness, create policy documents, and write Rego policies to validate attestations. You understand all attestors in go-witness and how to use them effectively."}, {"role": "user", "content": "How do I create a witness policy for a build step that uses these attestors: github, git, material, environment?"}, {"role": "assistant", "content": "Here's a complete witness policy for your build step with github, git, material, environment attestors:\n\n**Policy Document:**\n```json\n{\n  \"expires\": \"2026-11-08T10:52:59Z\",\n  \"publickeys\": {\n    \"build-key\": {\n      \"keyid\": \"sha256:e920c4231e09c3216c26d9bae45326824e22c22c0930974cb672d0aa091880ff\",\n      \"key\": \"-----BEGIN PUBLIC KEY-----\\n...\\n-----END PUBLIC KEY-----\"\n    }\n  },\n  \"steps\": {\n    \"build\": {\n      \"name\": \"build\",\n      \"attestations\": [\n        {\n          \"type\": \"https://witness.dev/attestations/github/v0.1\"\n        },\n        {\n          \"type\": \"https://witness.dev/attestations/git/v0.1\"\n        },\n        {\n          \"type\": \"https://witness.dev/attestations/material/v0.1\"\n        },\n        {\n          \"type\": \"https://witness.dev/attestations/environment/v0.1\"\n        }\n      ],\n      \"functionaries\": [\n        {\n          \"type\": \"publickey\",\n          \"publickeyid\": \"build-key\"\n        }\n      ]\n    }\n  }\n}\n```\n\n**Witness Run Command:**\n```bash\nwitness run --step build \\\n  --attestations github,git,material,environment \\\n  --outfile build-attestation.json \\\n  --key signing-key.pem \\\n  -- <your-build-command>\n```\n\n**Rego Validation Rules:**\n```rego\n\n```\n\n**Verification:**\n```bash\nwitness verify \\\n  --policy policy-signed.json \\\n  --publickey policy-key.pub \\\n  -a build-attestation.json \\\n  --subject <artifact>\n```\n"}]}
{"messages": [{"role": "system", "content": "You are an expert in the Witness supply chain attestation framework. You help users instrument CI/CD pipelines with witness, create policy documents, and write Rego policies to validate attestations. You understand all attestors in go-witness and how to use them effectively."}, {"role": "user", "content": "How do I create a witness policy for a build step that uses these attestors: environment, material, github, product?"}, {"role": "assistant", "content": "Here's a complete witness policy for your build step with environment, material, github, product attestors:\n\n**Policy Document:**\n```json\n{\n  \"expires\": \"2026-11-08T10:52:59Z\",\n  \"publickeys\": {\n    \"build-key\": {\n      \"keyid\": \"sha256:afad06bf3494e1d399bbab59311f6e337777e96ac379bc42fb3bcbaf2a94d9a2\",\n      \"key\": \"-----BEGIN PUBLIC KEY-----\\n...\\n-----END PUBLIC KEY-----\"\n    }\n  },\n  \"steps\": {\n    \"build\": {\n      \"name\": \"build\",\n      \"attestations\": [\n        {\n          \"type\": \"https://witness.dev/attestations/environment/v0.1\"\n        },\n        {\n          \"type\": \"https://witness.dev/attestations/material/v0.1\"\n        },\n        {\n          \"type\": \"https://witness.dev/attestations/github/v0.1\"\n        },\n        {\n          \"type\": \"https://witness.dev/attestations/product/v0.1\"\n        }\n      ],\n      \"functionaries\": [\n        {\n          \"type\": \"publickey\",\n          \"publickeyid\": \"build-key\"\n        }\n      ]\n    }\n  }\n}\n```\n\n**Witness Run Command:**\n```bash\nwitness run --step build \\\n  --attestations environment,material,github,product \\\n  --outfile build-attestation.json \\\n  --key signing-key.pem \\\n  -- <your-build-command>\n```\n\n**Rego Validation Rules:**\n```rego\npackage environment\n\nimport rego.v1\n\n# Ensure correct OS\ndeny contains msg if {\n    input.os != \"darwin\"\n    msg := sprintf(\"Must run on darwin, got: %s\", [input.os])\n}\n\n# Require CI environment\ndeny contains msg if {\n    not \"CI\" in input.variables\n    msg := \"Must run in CI environment (CI variable not set)\"\n}\n```\n\n**Verification:**\n```bash\nwitness verify \\\n  --policy policy-signed.json \\\n  --publickey policy-key.pub \\\n  -a build-attestation.json \\\n  --subject <artifact>\n```\n"}]}
{"messages": [{"role": "system", "content": "You are an expert in the Witness supply chain attestation framework. You help users instrument CI/CD pipelines with witness, create policy documents, and write Rego policies to validate attestations. You understand all attestors in go-witness and how to use them effectively."}, {"role": "user", "content": "How do I create a witness policy for a build step that uses these attestors: material, environment, commandrun?"}, {"role": "assistant", "content": "Here's a complete witness policy for your build step with material, environment, commandrun attestors:\n\n**Policy Document:**\n```json\n{\n  \"expires\": \"2026-11-08T10:52:59Z\",\n  \"publickeys\": {\n    \"build-key\": {\n      \"keyid\": \"sha256:d7e6474a407ae4f87a45b6bbaad6eacdc1cf17688c7e7f5f04c74fb6165ab9ad\",\n      \"key\": \"-----BEGIN PUBLIC KEY-----\\n...\\n-----END PUBLIC KEY-----\"\n    }\n  },\n  \"steps\": {\n    \"build\": {\n      \"name\": \"build\",\n      \"attestations\": [\n        {\n          \"type\": \"https://witness.dev/attestations/material/v0.1\"\n        },\n        {\n          \"type\": \"https://witness.dev/attestations/environment/v0.1\"\n        },\n        {\n          \"type\": \"https://witness.dev/attestations/command-run/v0.1\"\n        }\n      ],\n      \"functionaries\": [\n        {\n          \"type\": \"publickey\",\n          \"publickeyid\": \"build-key\"\n        }\n      ]\n    }\n  }\n}\n```\n\n**Witness Run Command:**\n```bash\nwitness run --step build \\\n  --attestations material,environment,commandrun \\\n  --outfile build-attestation.json \\\n  --key signing-key.pem \\\n  -- <your-build-command>\n```\n\n**Rego Validation Rules:**\n```rego\n\n```\n\n**Verification:**\n```bash\nwitness verify \\\n  --policy policy-signed.json \\\n  --publickey policy-key.pub \\\n  -a build-attestation.json \\\n  --subject <artifact>\n```\n"}]}
{"messages": [{"role": "system", "content": "You are an expert in the Witness supply chain attestation framework. You help users instrument CI/CD pipelines with witness, create policy documents, and write Rego policies to validate attestations. You understand all attestors in go-witness and how to use them effectively."}, {"role": "user", "content": "How do I create a witness policy for a build step that uses these attestors: commandrun, environment?"}, {"role": "assistant", "content": "Here's a complete witness policy for your build step with commandrun, environment attestors:\n\n**Policy Document:**\n```json\n{\n  \"expires\": \"2026-11-08T10:52:59Z\",\n  \"publickeys\": {\n    \"build-key\": {\n      \"keyid\": \"sha256:b62ee35d151951df42a3d8848ebf0babdf24f38779045f4ea7b0dab485b03bac\",\n      \"key\": \"-----BEGIN PUBLIC KEY-----\\n...\\n-----END PUBLIC KEY-----\"\n    }\n  },\n  \"steps\": {\n    \"build\": {\n      \"name\": \"build\",\n      \"attestations\": [\n        {\n          \"type\": \"https://witness.dev/attestations/command-run/v0.1\"\n        },\n        {\n          \"type\": \"https://witness.dev/attestations/environment/v0.1\"\n        }\n      ],\n      \"functionaries\": [\n        {\n          \"type\": \"publickey\",\n          \"publickeyid\": \"build-key\"\n        }\n      ]\n    }\n  }\n}\n```\n\n**Witness Run Command:**\n```bash\nwitness run --step build \\\n  --attestations commandrun,environment \\\n  --outfile build-attestation.json \\\n  --key signing-key.pem \\\n  -- <your-build-command>\n```\n\n**Rego Validation Rules:**\n```rego\n\n```\n\n**Verification:**\n```bash\nwitness verify \\\n  --policy policy-signed.json \\\n  --publickey policy-key.pub \\\n  -a build-attestation.json \\\n  --subject <artifact>\n```\n"}]}
{"messages": [{"role": "system", "content": "You are an expert in the Witness supply chain attestation framework. You help users instrument CI/CD pipelines with witness, create policy documents, and write Rego policies to validate attestations. You understand all attestors in go-witness and how to use them effectively."}, {"role": "user", "content": "How do I create a multi-step witness policy for a build \u2192 test \u2192 package pipeline?"}, {"role": "assistant", "content": "Here's a complete multi-step witness policy for your pipeline:\n\n**Policy Document:**\n```json\n{\n  \"expires\": \"2026-11-08T10:52:59Z\",\n  \"publickeys\": {\n    \"ci-key\": {\n      \"keyid\": \"sha256:275cd2adebcd2f73efb4ddf581195dcd1841bfb4f1472b2d51d6f2814c0dab91\",\n      \"key\": \"-----BEGIN PUBLIC KEY-----\\n...\\n-----END PUBLIC KEY-----\"\n    }\n  },\n  \"steps\": {\n    \"build\": {\n      \"name\": \"build\",\n      \"attestations\": [\n        {\n          \"type\": \"https://witness.dev/attestations/git/v0.1\"\n        },\n        {\n          \"type\": \"https://witness.dev/attestations/command-run/v0.1\"\n        },\n        {\n          \"type\": \"https://witness.dev/attestations/product/v0.1\"\n        }\n      ],\n      \"functionaries\": [\n        {\n          \"type\": \"publickey\",\n          \"publickeyid\": \"ci-key\"\n        }\n      ]\n    },\n    \"test\": {\n      \"name\": \"test\",\n      \"attestations\": [\n        {\n          \"type\": \"https://witness.dev/attestations/material/v0.1\"\n        },\n        {\n          \"type\": \"https://witness.dev/attestations/command-run/v0.1\"\n        }\n      ],\n      \"functionaries\": [\n        {\n          \"type\": \"publickey\",\n          \"publickeyid\": \"ci-key\"\n        }\n      ]\n    },\n    \"package\": {\n      \"name\": \"package\",\n      \"attestations\": [\n        {\n          \"type\": \"https://witness.dev/attestations/material/v0.1\"\n        },\n        {\n          \"type\": \"https://witness.dev/attestations/product/v0.1\"\n        }\n      ],\n      \"functionaries\": [\n        {\n          \"type\": \"publickey\",\n          \"publickeyid\": \"ci-key\"\n        }\n      ]\n    }\n  }\n}\n```\n\n**Pipeline Commands:**\n\n```bash\n# Step 1: Build\nwitness run --step build \\\n  --attestations git,commandrun,product \\\n  -o build.json --key ci-key.pem \\\n  -- go build -o myapp\n\n# Step 2: Test\nwitness run --step test \\\n  --attestations material,commandrun \\\n  -o test.json --key ci-key.pem \\\n  -- go test ./...\n\n# Step 3: Package\nwitness run --step package \\\n  --attestations material,product \\\n  -o package.json --key ci-key.pem \\\n  -- tar czf myapp.tar.gz myapp\n\n# Verify entire pipeline\nwitness verify \\\n  --policy policy-signed.json \\\n  --publickey policy-key.pub \\\n  -a build.json -a test.json -a package.json\n```\n"}]}
{"messages": [{"role": "system", "content": "You are an expert in the Witness supply chain attestation framework. You help users instrument CI/CD pipelines with witness, create policy documents, and write Rego policies to validate attestations. You understand all attestors in go-witness and how to use them effectively."}, {"role": "user", "content": "How do I create a witness policy for a build step that uses these attestors: github, product, material, environment?"}, {"role": "assistant", "content": "Here's a complete witness policy for your build step with github, product, material, environment attestors:\n\n**Policy Document:**\n```json\n{\n  \"expires\": \"2026-11-08T10:52:59Z\",\n  \"publickeys\": {\n    \"build-key\": {\n      \"keyid\": \"sha256:a7d87a29e60dd6b4d44fa199d6a21a1ac467aabffdea3f57ba9e07158b7dba95\",\n      \"key\": \"-----BEGIN PUBLIC KEY-----\\n...\\n-----END PUBLIC KEY-----\"\n    }\n  },\n  \"steps\": {\n    \"build\": {\n      \"name\": \"build\",\n      \"attestations\": [\n        {\n          \"type\": \"https://witness.dev/attestations/github/v0.1\"\n        },\n        {\n          \"type\": \"https://witness.dev/attestations/product/v0.1\"\n        },\n        {\n          \"type\": \"https://witness.dev/attestations/material/v0.1\"\n        },\n        {\n          \"type\": \"https://witness.dev/attestations/environment/v0.1\"\n        }\n      ],\n      \"functionaries\": [\n        {\n          \"type\": \"publickey\",\n          \"publickeyid\": \"build-key\"\n        }\n      ]\n    }\n  }\n}\n```\n\n**Witness Run Command:**\n```bash\nwitness run --step build \\\n  --attestations github,product,material,environment \\\n  --outfile build-attestation.json \\\n  --key signing-key.pem \\\n  -- <your-build-command>\n```\n\n**Rego Validation Rules:**\n```rego\n\n```\n\n**Verification:**\n```bash\nwitness verify \\\n  --policy policy-signed.json \\\n  --publickey policy-key.pub \\\n  -a build-attestation.json \\\n  --subject <artifact>\n```\n"}]}
{"messages": [{"role": "system", "content": "You are an expert in the Witness supply chain attestation framework. You help users instrument CI/CD pipelines with witness, create policy documents, and write Rego policies to validate attestations. You understand all attestors in go-witness and how to use them effectively."}, {"role": "user", "content": "How do I create a multi-step witness policy for a build \u2192 test \u2192 package pipeline?"}, {"role": "assistant", "content": "Here's a complete multi-step witness policy for your pipeline:\n\n**Policy Document:**\n```json\n{\n  \"expires\": \"2026-11-08T10:52:59Z\",\n  \"publickeys\": {\n    \"ci-key\": {\n      \"keyid\": \"sha256:510cf609b0a79e81ad914db08d683459bf65e1e11f2627d48b94f7c3a764bb85\",\n      \"key\": \"-----BEGIN PUBLIC KEY-----\\n...\\n-----END PUBLIC KEY-----\"\n    }\n  },\n  \"steps\": {\n    \"build\": {\n      \"name\": \"build\",\n      \"attestations\": [\n        {\n          \"type\": \"https://witness.dev/attestations/git/v0.1\"\n        },\n        {\n          \"type\": \"https://witness.dev/attestations/command-run/v0.1\"\n        },\n        {\n          \"type\": \"https://witness.dev/attestations/product/v0.1\"\n        }\n      ],\n      \"functionaries\": [\n        {\n          \"type\": \"publickey\",\n          \"publickeyid\": \"ci-key\"\n        }\n      ]\n    },\n    \"test\": {\n      \"name\": \"test\",\n      \"attestations\": [\n        {\n          \"type\": \"https://witness.dev/attestations/material/v0.1\"\n        },\n        {\n          \"type\": \"https://witness.dev/attestations/command-run/v0.1\"\n        }\n      ],\n      \"functionaries\": [\n        {\n          \"type\": \"publickey\",\n          \"publickeyid\": \"ci-key\"\n        }\n      ]\n    },\n    \"package\": {\n      \"name\": \"package\",\n      \"attestations\": [\n        {\n          \"type\": \"https://witness.dev/attestations/material/v0.1\"\n        },\n        {\n          \"type\": \"https://witness.dev/attestations/product/v0.1\"\n        }\n      ],\n      \"functionaries\": [\n        {\n          \"type\": \"publickey\",\n          \"publickeyid\": \"ci-key\"\n        }\n      ]\n    }\n  }\n}\n```\n\n**Pipeline Commands:**\n\n```bash\n# Step 1: Build\nwitness run --step build \\\n  --attestations git,commandrun,product \\\n  -o build.json --key ci-key.pem \\\n  -- go build -o myapp\n\n# Step 2: Test\nwitness run --step test \\\n  --attestations material,commandrun \\\n  -o test.json --key ci-key.pem \\\n  -- go test ./...\n\n# Step 3: Package\nwitness run --step package \\\n  --attestations material,product \\\n  -o package.json --key ci-key.pem \\\n  -- tar czf myapp.tar.gz myapp\n\n# Verify entire pipeline\nwitness verify \\\n  --policy policy-signed.json \\\n  --publickey policy-key.pub \\\n  -a build.json -a test.json -a package.json\n```\n"}]}
{"messages": [{"role": "system", "content": "You are an expert in the Witness supply chain attestation framework. You help users instrument CI/CD pipelines with witness, create policy documents, and write Rego policies to validate attestations. You understand all attestors in go-witness and how to use them effectively."}, {"role": "user", "content": "How do I create a witness policy for a build step that uses these attestors: commandrun, git, environment, github, material?"}, {"role": "assistant", "content": "Here's a complete witness policy for your build step with commandrun, git, environment, github, material attestors:\n\n**Policy Document:**\n```json\n{\n  \"expires\": \"2026-11-08T10:52:59Z\",\n  \"publickeys\": {\n    \"build-key\": {\n      \"keyid\": \"sha256:39edf5346455006ade1357d7b856a37160985ddeb850fdae4edac8e7230b5a9e\",\n      \"key\": \"-----BEGIN PUBLIC KEY-----\\n...\\n-----END PUBLIC KEY-----\"\n    }\n  },\n  \"steps\": {\n    \"build\": {\n      \"name\": \"build\",\n      \"attestations\": [\n        {\n          \"type\": \"https://witness.dev/attestations/command-run/v0.1\"\n        },\n        {\n          \"type\": \"https://witness.dev/attestations/git/v0.1\"\n        },\n        {\n          \"type\": \"https://witness.dev/attestations/environment/v0.1\"\n        },\n        {\n          \"type\": \"https://witness.dev/attestations/github/v0.1\"\n        },\n        {\n          \"type\": \"https://witness.dev/attestations/material/v0.1\"\n        }\n      ],\n      \"functionaries\": [\n        {\n          \"type\": \"publickey\",\n          \"publickeyid\": \"build-key\"\n        }\n      ]\n    }\n  }\n}\n```\n\n**Witness Run Command:**\n```bash\nwitness run --step build \\\n  --attestations commandrun,git,environment,github,material \\\n  --outfile build-attestation.json \\\n  --key signing-key.pem \\\n  -- <your-build-command>\n```\n\n**Rego Validation Rules:**\n```rego\n\n```\n\n**Verification:**\n```bash\nwitness verify \\\n  --policy policy-signed.json \\\n  --publickey policy-key.pub \\\n  -a build-attestation.json \\\n  --subject <artifact>\n```\n"}]}
{"messages": [{"role": "system", "content": "You are an expert in the Witness supply chain attestation framework. You help users instrument CI/CD pipelines with witness, create policy documents, and write Rego policies to validate attestations. You understand all attestors in go-witness and how to use them effectively."}, {"role": "user", "content": "How do I create a multi-step witness policy for a build \u2192 test \u2192 package pipeline?"}, {"role": "assistant", "content": "Here's a complete multi-step witness policy for your pipeline:\n\n**Policy Document:**\n```json\n{\n  \"expires\": \"2026-11-08T10:52:59Z\",\n  \"publickeys\": {\n    \"ci-key\": {\n      \"keyid\": \"sha256:983cf55e114ea68be20025a202947d7be590cd2eb9efec8e27716f3e180f9c94\",\n      \"key\": \"-----BEGIN PUBLIC KEY-----\\n...\\n-----END PUBLIC KEY-----\"\n    }\n  },\n  \"steps\": {\n    \"build\": {\n      \"name\": \"build\",\n      \"attestations\": [\n        {\n          \"type\": \"https://witness.dev/attestations/git/v0.1\"\n        },\n        {\n          \"type\": \"https://witness.dev/attestations/command-run/v0.1\"\n        },\n        {\n          \"type\": \"https://witness.dev/attestations/product/v0.1\"\n        }\n      ],\n      \"functionaries\": [\n        {\n          \"type\": \"publickey\",\n          \"publickeyid\": \"ci-key\"\n        }\n      ]\n    },\n    \"test\": {\n      \"name\": \"test\",\n      \"attestations\": [\n        {\n          \"type\": \"https://witness.dev/attestations/material/v0.1\"\n        },\n        {\n          \"type\": \"https://witness.dev/attestations/command-run/v0.1\"\n        }\n      ],\n      \"functionaries\": [\n        {\n          \"type\": \"publickey\",\n          \"publickeyid\": \"ci-key\"\n        }\n      ]\n    },\n    \"package\": {\n      \"name\": \"package\",\n      \"attestations\": [\n        {\n          \"type\": \"https://witness.dev/attestations/material/v0.1\"\n        },\n        {\n          \"type\": \"https://witness.dev/attestations/product/v0.1\"\n        }\n      ],\n      \"functionaries\": [\n        {\n          \"type\": \"publickey\",\n          \"publickeyid\": \"ci-key\"\n        }\n      ]\n    }\n  }\n}\n```\n\n**Pipeline Commands:**\n\n```bash\n# Step 1: Build\nwitness run --step build \\\n  --attestations git,commandrun,product \\\n  -o build.json --key ci-key.pem \\\n  -- go build -o myapp\n\n# Step 2: Test\nwitness run --step test \\\n  --attestations material,commandrun \\\n  -o test.json --key ci-key.pem \\\n  -- go test ./...\n\n# Step 3: Package\nwitness run --step package \\\n  --attestations material,product \\\n  -o package.json --key ci-key.pem \\\n  -- tar czf myapp.tar.gz myapp\n\n# Verify entire pipeline\nwitness verify \\\n  --policy policy-signed.json \\\n  --publickey policy-key.pub \\\n  -a build.json -a test.json -a package.json\n```\n"}]}
{"messages": [{"role": "system", "content": "You are an expert in the Witness supply chain attestation framework. You help users instrument CI/CD pipelines with witness, create policy documents, and write Rego policies to validate attestations. You understand all attestors in go-witness and how to use them effectively."}, {"role": "user", "content": "How do I create a witness policy for a build step that uses these attestors: material, environment, commandrun, github, git?"}, {"role": "assistant", "content": "Here's a complete witness policy for your build step with material, environment, commandrun, github, git attestors:\n\n**Policy Document:**\n```json\n{\n  \"expires\": \"2026-11-08T10:52:59Z\",\n  \"publickeys\": {\n    \"build-key\": {\n      \"keyid\": \"sha256:2807ecbe78a42cf41da7fbbf1e197077e7ccb975c253bb3c84e6132e7efafdce\",\n      \"key\": \"-----BEGIN PUBLIC KEY-----\\n...\\n-----END PUBLIC KEY-----\"\n    }\n  },\n  \"steps\": {\n    \"build\": {\n      \"name\": \"build\",\n      \"attestations\": [\n        {\n          \"type\": \"https://witness.dev/attestations/material/v0.1\"\n        },\n        {\n          \"type\": \"https://witness.dev/attestations/environment/v0.1\"\n        },\n        {\n          \"type\": \"https://witness.dev/attestations/command-run/v0.1\"\n        },\n        {\n          \"type\": \"https://witness.dev/attestations/github/v0.1\"\n        },\n        {\n          \"type\": \"https://witness.dev/attestations/git/v0.1\"\n        }\n      ],\n      \"functionaries\": [\n        {\n          \"type\": \"publickey\",\n          \"publickeyid\": \"build-key\"\n        }\n      ]\n    }\n  }\n}\n```\n\n**Witness Run Command:**\n```bash\nwitness run --step build \\\n  --attestations material,environment,commandrun,github,git \\\n  --outfile build-attestation.json \\\n  --key signing-key.pem \\\n  -- <your-build-command>\n```\n\n**Rego Validation Rules:**\n```rego\n\n```\n\n**Verification:**\n```bash\nwitness verify \\\n  --policy policy-signed.json \\\n  --publickey policy-key.pub \\\n  -a build-attestation.json \\\n  --subject <artifact>\n```\n"}]}
{"messages": [{"role": "system", "content": "You are an expert in the Witness supply chain attestation framework. You help users instrument CI/CD pipelines with witness, create policy documents, and write Rego policies to validate attestations. You understand all attestors in go-witness and how to use them effectively."}, {"role": "user", "content": "How do I create a witness policy for a build step that uses these attestors: github, material, git, environment, product?"}, {"role": "assistant", "content": "Here's a complete witness policy for your build step with github, material, git, environment, product attestors:\n\n**Policy Document:**\n```json\n{\n  \"expires\": \"2026-11-08T10:52:59Z\",\n  \"publickeys\": {\n    \"build-key\": {\n      \"keyid\": \"sha256:aa0b9f58b585a9a23e50d1713fc71cd5f65a283372a98b6b1f36f4f0d84d2b8f\",\n      \"key\": \"-----BEGIN PUBLIC KEY-----\\n...\\n-----END PUBLIC KEY-----\"\n    }\n  },\n  \"steps\": {\n    \"build\": {\n      \"name\": \"build\",\n      \"attestations\": [\n        {\n          \"type\": \"https://witness.dev/attestations/github/v0.1\"\n        },\n        {\n          \"type\": \"https://witness.dev/attestations/material/v0.1\"\n        },\n        {\n          \"type\": \"https://witness.dev/attestations/git/v0.1\"\n        },\n        {\n          \"type\": \"https://witness.dev/attestations/environment/v0.1\"\n        },\n        {\n          \"type\": \"https://witness.dev/attestations/product/v0.1\"\n        }\n      ],\n      \"functionaries\": [\n        {\n          \"type\": \"publickey\",\n          \"publickeyid\": \"build-key\"\n        }\n      ]\n    }\n  }\n}\n```\n\n**Witness Run Command:**\n```bash\nwitness run --step build \\\n  --attestations github,material,git,environment,product \\\n  --outfile build-attestation.json \\\n  --key signing-key.pem \\\n  -- <your-build-command>\n```\n\n**Rego Validation Rules:**\n```rego\n\n```\n\n**Verification:**\n```bash\nwitness verify \\\n  --policy policy-signed.json \\\n  --publickey policy-key.pub \\\n  -a build-attestation.json \\\n  --subject <artifact>\n```\n"}]}
{"messages": [{"role": "system", "content": "You are an expert in the Witness supply chain attestation framework. You help users instrument CI/CD pipelines with witness, create policy documents, and write Rego policies to validate attestations. You understand all attestors in go-witness and how to use them effectively."}, {"role": "user", "content": "How do I create a witness policy for a build step that uses these attestors: environment, material, product, github?"}, {"role": "assistant", "content": "Here's a complete witness policy for your build step with environment, material, product, github attestors:\n\n**Policy Document:**\n```json\n{\n  \"expires\": \"2026-11-08T10:52:59Z\",\n  \"publickeys\": {\n    \"build-key\": {\n      \"keyid\": \"sha256:af6587d6540f92d8aa4785118970253e632007bfcacf7401c2e9a62489637ca9\",\n      \"key\": \"-----BEGIN PUBLIC KEY-----\\n...\\n-----END PUBLIC KEY-----\"\n    }\n  },\n  \"steps\": {\n    \"build\": {\n      \"name\": \"build\",\n      \"attestations\": [\n        {\n          \"type\": \"https://witness.dev/attestations/environment/v0.1\"\n        },\n        {\n          \"type\": \"https://witness.dev/attestations/material/v0.1\"\n        },\n        {\n          \"type\": \"https://witness.dev/attestations/product/v0.1\"\n        },\n        {\n          \"type\": \"https://witness.dev/attestations/github/v0.1\"\n        }\n      ],\n      \"functionaries\": [\n        {\n          \"type\": \"publickey\",\n          \"publickeyid\": \"build-key\"\n        }\n      ]\n    }\n  }\n}\n```\n\n**Witness Run Command:**\n```bash\nwitness run --step build \\\n  --attestations environment,material,product,github \\\n  --outfile build-attestation.json \\\n  --key signing-key.pem \\\n  -- <your-build-command>\n```\n\n**Rego Validation Rules:**\n```rego\npackage environment\n\nimport rego.v1\n\n# Ensure correct OS\ndeny contains msg if {\n    input.os != \"darwin\"\n    msg := sprintf(\"Must run on darwin, got: %s\", [input.os])\n}\n\n# Require CI environment\ndeny contains msg if {\n    not \"CI\" in input.variables\n    msg := \"Must run in CI environment (CI variable not set)\"\n}\n```\n\n**Verification:**\n```bash\nwitness verify \\\n  --policy policy-signed.json \\\n  --publickey policy-key.pub \\\n  -a build-attestation.json \\\n  --subject <artifact>\n```\n"}]}
{"messages": [{"role": "system", "content": "You are an expert in the Witness supply chain attestation framework. You help users instrument CI/CD pipelines with witness, create policy documents, and write Rego policies to validate attestations. You understand all attestors in go-witness and how to use them effectively."}, {"role": "user", "content": "How do I create a witness policy for a build step that uses these attestors: commandrun, product, material?"}, {"role": "assistant", "content": "Here's a complete witness policy for your build step with commandrun, product, material attestors:\n\n**Policy Document:**\n```json\n{\n  \"expires\": \"2026-11-08T10:52:59Z\",\n  \"publickeys\": {\n    \"build-key\": {\n      \"keyid\": \"sha256:fc63a1f39ea5fdb0a26a72aca316cb1b8a7dbec9144fc6d3ed447016afaa9940\",\n      \"key\": \"-----BEGIN PUBLIC KEY-----\\n...\\n-----END PUBLIC KEY-----\"\n    }\n  },\n  \"steps\": {\n    \"build\": {\n      \"name\": \"build\",\n      \"attestations\": [\n        {\n          \"type\": \"https://witness.dev/attestations/command-run/v0.1\"\n        },\n        {\n          \"type\": \"https://witness.dev/attestations/product/v0.1\"\n        },\n        {\n          \"type\": \"https://witness.dev/attestations/material/v0.1\"\n        }\n      ],\n      \"functionaries\": [\n        {\n          \"type\": \"publickey\",\n          \"publickeyid\": \"build-key\"\n        }\n      ]\n    }\n  }\n}\n```\n\n**Witness Run Command:**\n```bash\nwitness run --step build \\\n  --attestations commandrun,product,material \\\n  --outfile build-attestation.json \\\n  --key signing-key.pem \\\n  -- <your-build-command>\n```\n\n**Rego Validation Rules:**\n```rego\n\n```\n\n**Verification:**\n```bash\nwitness verify \\\n  --policy policy-signed.json \\\n  --publickey policy-key.pub \\\n  -a build-attestation.json \\\n  --subject <artifact>\n```\n"}]}
{"messages": [{"role": "system", "content": "You are an expert in the Witness supply chain attestation framework. You help users instrument CI/CD pipelines with witness, create policy documents, and write Rego policies to validate attestations. You understand all attestors in go-witness and how to use them effectively."}, {"role": "user", "content": "How do I create a multi-step witness policy for a build \u2192 test \u2192 package pipeline?"}, {"role": "assistant", "content": "Here's a complete multi-step witness policy for your pipeline:\n\n**Policy Document:**\n```json\n{\n  \"expires\": \"2026-11-08T10:52:59Z\",\n  \"publickeys\": {\n    \"ci-key\": {\n      \"keyid\": \"sha256:fbe260f0b7936e036fedc9586416aa5986e22646517169346461c4ee4dbfa70a\",\n      \"key\": \"-----BEGIN PUBLIC KEY-----\\n...\\n-----END PUBLIC KEY-----\"\n    }\n  },\n  \"steps\": {\n    \"build\": {\n      \"name\": \"build\",\n      \"attestations\": [\n        {\n          \"type\": \"https://witness.dev/attestations/git/v0.1\"\n        },\n        {\n          \"type\": \"https://witness.dev/attestations/command-run/v0.1\"\n        },\n        {\n          \"type\": \"https://witness.dev/attestations/product/v0.1\"\n        }\n      ],\n      \"functionaries\": [\n        {\n          \"type\": \"publickey\",\n          \"publickeyid\": \"ci-key\"\n        }\n      ]\n    },\n    \"test\": {\n      \"name\": \"test\",\n      \"attestations\": [\n        {\n          \"type\": \"https://witness.dev/attestations/material/v0.1\"\n        },\n        {\n          \"type\": \"https://witness.dev/attestations/command-run/v0.1\"\n        }\n      ],\n      \"functionaries\": [\n        {\n          \"type\": \"publickey\",\n          \"publickeyid\": \"ci-key\"\n        }\n      ]\n    },\n    \"package\": {\n      \"name\": \"package\",\n      \"attestations\": [\n        {\n          \"type\": \"https://witness.dev/attestations/material/v0.1\"\n        },\n        {\n          \"type\": \"https://witness.dev/attestations/product/v0.1\"\n        }\n      ],\n      \"functionaries\": [\n        {\n          \"type\": \"publickey\",\n          \"publickeyid\": \"ci-key\"\n        }\n      ]\n    }\n  }\n}\n```\n\n**Pipeline Commands:**\n\n```bash\n# Step 1: Build\nwitness run --step build \\\n  --attestations git,commandrun,product \\\n  -o build.json --key ci-key.pem \\\n  -- go build -o myapp\n\n# Step 2: Test\nwitness run --step test \\\n  --attestations material,commandrun \\\n  -o test.json --key ci-key.pem \\\n  -- go test ./...\n\n# Step 3: Package\nwitness run --step package \\\n  --attestations material,product \\\n  -o package.json --key ci-key.pem \\\n  -- tar czf myapp.tar.gz myapp\n\n# Verify entire pipeline\nwitness verify \\\n  --policy policy-signed.json \\\n  --publickey policy-key.pub \\\n  -a build.json -a test.json -a package.json\n```\n"}]}
{"messages": [{"role": "system", "content": "You are an expert in the Witness supply chain attestation framework. You help users instrument CI/CD pipelines with witness, create policy documents, and write Rego policies to validate attestations. You understand all attestors in go-witness and how to use them effectively."}, {"role": "user", "content": "How do I create a multi-step witness policy for a build \u2192 test \u2192 package pipeline?"}, {"role": "assistant", "content": "Here's a complete multi-step witness policy for your pipeline:\n\n**Policy Document:**\n```json\n{\n  \"expires\": \"2026-11-08T10:52:59Z\",\n  \"publickeys\": {\n    \"ci-key\": {\n      \"keyid\": \"sha256:7063b943764a74d84ab7645ca18a833ad288478dd33c77886e9402ddee67350c\",\n      \"key\": \"-----BEGIN PUBLIC KEY-----\\n...\\n-----END PUBLIC KEY-----\"\n    }\n  },\n  \"steps\": {\n    \"build\": {\n      \"name\": \"build\",\n      \"attestations\": [\n        {\n          \"type\": \"https://witness.dev/attestations/git/v0.1\"\n        },\n        {\n          \"type\": \"https://witness.dev/attestations/command-run/v0.1\"\n        },\n        {\n          \"type\": \"https://witness.dev/attestations/product/v0.1\"\n        }\n      ],\n      \"functionaries\": [\n        {\n          \"type\": \"publickey\",\n          \"publickeyid\": \"ci-key\"\n        }\n      ]\n    },\n    \"test\": {\n      \"name\": \"test\",\n      \"attestations\": [\n        {\n          \"type\": \"https://witness.dev/attestations/material/v0.1\"\n        },\n        {\n          \"type\": \"https://witness.dev/attestations/command-run/v0.1\"\n        }\n      ],\n      \"functionaries\": [\n        {\n          \"type\": \"publickey\",\n          \"publickeyid\": \"ci-key\"\n        }\n      ]\n    },\n    \"package\": {\n      \"name\": \"package\",\n      \"attestations\": [\n        {\n          \"type\": \"https://witness.dev/attestations/material/v0.1\"\n        },\n        {\n          \"type\": \"https://witness.dev/attestations/product/v0.1\"\n        }\n      ],\n      \"functionaries\": [\n        {\n          \"type\": \"publickey\",\n          \"publickeyid\": \"ci-key\"\n        }\n      ]\n    }\n  }\n}\n```\n\n**Pipeline Commands:**\n\n```bash\n# Step 1: Build\nwitness run --step build \\\n  --attestations git,commandrun,product \\\n  -o build.json --key ci-key.pem \\\n  -- go build -o myapp\n\n# Step 2: Test\nwitness run --step test \\\n  --attestations material,commandrun \\\n  -o test.json --key ci-key.pem \\\n  -- go test ./...\n\n# Step 3: Package\nwitness run --step package \\\n  --attestations material,product \\\n  -o package.json --key ci-key.pem \\\n  -- tar czf myapp.tar.gz myapp\n\n# Verify entire pipeline\nwitness verify \\\n  --policy policy-signed.json \\\n  --publickey policy-key.pub \\\n  -a build.json -a test.json -a package.json\n```\n"}]}
{"messages": [{"role": "system", "content": "You are an expert in the Witness supply chain attestation framework. You help users instrument CI/CD pipelines with witness, create policy documents, and write Rego policies to validate attestations. You understand all attestors in go-witness and how to use them effectively."}, {"role": "user", "content": "How do I create a witness policy for a build step that uses these attestors: github, environment, git, material, product?"}, {"role": "assistant", "content": "Here's a complete witness policy for your build step with github, environment, git, material, product attestors:\n\n**Policy Document:**\n```json\n{\n  \"expires\": \"2026-11-08T10:52:59Z\",\n  \"publickeys\": {\n    \"build-key\": {\n      \"keyid\": \"sha256:97cdcf9497bc109538a16b55063d34b7554bf53451378c1560b666098a60d1de\",\n      \"key\": \"-----BEGIN PUBLIC KEY-----\\n...\\n-----END PUBLIC KEY-----\"\n    }\n  },\n  \"steps\": {\n    \"build\": {\n      \"name\": \"build\",\n      \"attestations\": [\n        {\n          \"type\": \"https://witness.dev/attestations/github/v0.1\"\n        },\n        {\n          \"type\": \"https://witness.dev/attestations/environment/v0.1\"\n        },\n        {\n          \"type\": \"https://witness.dev/attestations/git/v0.1\"\n        },\n        {\n          \"type\": \"https://witness.dev/attestations/material/v0.1\"\n        },\n        {\n          \"type\": \"https://witness.dev/attestations/product/v0.1\"\n        }\n      ],\n      \"functionaries\": [\n        {\n          \"type\": \"publickey\",\n          \"publickeyid\": \"build-key\"\n        }\n      ]\n    }\n  }\n}\n```\n\n**Witness Run Command:**\n```bash\nwitness run --step build \\\n  --attestations github,environment,git,material,product \\\n  --outfile build-attestation.json \\\n  --key signing-key.pem \\\n  -- <your-build-command>\n```\n\n**Rego Validation Rules:**\n```rego\n\n```\n\n**Verification:**\n```bash\nwitness verify \\\n  --policy policy-signed.json \\\n  --publickey policy-key.pub \\\n  -a build-attestation.json \\\n  --subject <artifact>\n```\n"}]}
{"messages": [{"role": "system", "content": "You are an expert in the Witness supply chain attestation framework. You help users instrument CI/CD pipelines with witness, create policy documents, and write Rego policies to validate attestations. You understand all attestors in go-witness and how to use them effectively."}, {"role": "user", "content": "How do I create a witness policy for a build step that uses these attestors: git, material, commandrun, product, github?"}, {"role": "assistant", "content": "Here's a complete witness policy for your build step with git, material, commandrun, product, github attestors:\n\n**Policy Document:**\n```json\n{\n  \"expires\": \"2026-11-08T10:52:59Z\",\n  \"publickeys\": {\n    \"build-key\": {\n      \"keyid\": \"sha256:8d115a793ddf95ac783f6063866e2148e9934bfeeea35e582628c9846f18c860\",\n      \"key\": \"-----BEGIN PUBLIC KEY-----\\n...\\n-----END PUBLIC KEY-----\"\n    }\n  },\n  \"steps\": {\n    \"build\": {\n      \"name\": \"build\",\n      \"attestations\": [\n        {\n          \"type\": \"https://witness.dev/attestations/git/v0.1\"\n        },\n        {\n          \"type\": \"https://witness.dev/attestations/material/v0.1\"\n        },\n        {\n          \"type\": \"https://witness.dev/attestations/command-run/v0.1\"\n        },\n        {\n          \"type\": \"https://witness.dev/attestations/product/v0.1\"\n        },\n        {\n          \"type\": \"https://witness.dev/attestations/github/v0.1\"\n        }\n      ],\n      \"functionaries\": [\n        {\n          \"type\": \"publickey\",\n          \"publickeyid\": \"build-key\"\n        }\n      ]\n    }\n  }\n}\n```\n\n**Witness Run Command:**\n```bash\nwitness run --step build \\\n  --attestations git,material,commandrun,product,github \\\n  --outfile build-attestation.json \\\n  --key signing-key.pem \\\n  -- <your-build-command>\n```\n\n**Rego Validation Rules:**\n```rego\npackage git\n\nimport rego.v1\n\n# Enforce builds from specific branch\ndeny contains msg if {\n    input.branch != \"release/v1.0\"\n    msg := sprintf(\"Must build from release/v1.0 branch, got: %s\", [input.branch])\n}\n\n# Require clean working directory\ndeny contains msg if {\n    count(input.status) > 0\n    msg := \"Working directory must be clean (no uncommitted changes)\"\n}\n\n# Validate commit author\napproved_authors := {\n    \"alice.smith@example.com\",\n    \"bob.jones@company.com\",\n    \"ci-bot@company.com\"\n}\n\ndeny contains msg if {\n    not input.authoremail in approved_authors\n    msg := sprintf(\"Unauthorized commit author: %s\", [input.authoremail])\n}\n```\n\n**Verification:**\n```bash\nwitness verify \\\n  --policy policy-signed.json \\\n  --publickey policy-key.pub \\\n  -a build-attestation.json \\\n  --subject <artifact>\n```\n"}]}
{"messages": [{"role": "system", "content": "You are an expert in the Witness supply chain attestation framework. You help users instrument CI/CD pipelines with witness, create policy documents, and write Rego policies to validate attestations. You understand all attestors in go-witness and how to use them effectively."}, {"role": "user", "content": "How do I create a witness policy for a build step that uses these attestors: material, commandrun, product, environment, github?"}, {"role": "assistant", "content": "Here's a complete witness policy for your build step with material, commandrun, product, environment, github attestors:\n\n**Policy Document:**\n```json\n{\n  \"expires\": \"2026-11-08T10:52:59Z\",\n  \"publickeys\": {\n    \"build-key\": {\n      \"keyid\": \"sha256:20b84677e386ab812eb96e82009c5ea1cd8e22d18be8608d2e9b2a82c5c6f84a\",\n      \"key\": \"-----BEGIN PUBLIC KEY-----\\n...\\n-----END PUBLIC KEY-----\"\n    }\n  },\n  \"steps\": {\n    \"build\": {\n      \"name\": \"build\",\n      \"attestations\": [\n        {\n          \"type\": \"https://witness.dev/attestations/material/v0.1\"\n        },\n        {\n          \"type\": \"https://witness.dev/attestations/command-run/v0.1\"\n        },\n        {\n          \"type\": \"https://witness.dev/attestations/product/v0.1\"\n        },\n        {\n          \"type\": \"https://witness.dev/attestations/environment/v0.1\"\n        },\n        {\n          \"type\": \"https://witness.dev/attestations/github/v0.1\"\n        }\n      ],\n      \"functionaries\": [\n        {\n          \"type\": \"publickey\",\n          \"publickeyid\": \"build-key\"\n        }\n      ]\n    }\n  }\n}\n```\n\n**Witness Run Command:**\n```bash\nwitness run --step build \\\n  --attestations material,commandrun,product,environment,github \\\n  --outfile build-attestation.json \\\n  --key signing-key.pem \\\n  -- <your-build-command>\n```\n\n**Rego Validation Rules:**\n```rego\n\n```\n\n**Verification:**\n```bash\nwitness verify \\\n  --policy policy-signed.json \\\n  --publickey policy-key.pub \\\n  -a build-attestation.json \\\n  --subject <artifact>\n```\n"}]}
{"messages": [{"role": "system", "content": "You are an expert in the Witness supply chain attestation framework. You help users instrument CI/CD pipelines with witness, create policy documents, and write Rego policies to validate attestations. You understand all attestors in go-witness and how to use them effectively."}, {"role": "user", "content": "How do I create a witness policy for a build step that uses these attestors: material, git, commandrun, product, github?"}, {"role": "assistant", "content": "Here's a complete witness policy for your build step with material, git, commandrun, product, github attestors:\n\n**Policy Document:**\n```json\n{\n  \"expires\": \"2026-11-08T10:52:59Z\",\n  \"publickeys\": {\n    \"build-key\": {\n      \"keyid\": \"sha256:2c927882f1702cafeb00ec6092449448465a3f145c228184e00c839101de4e56\",\n      \"key\": \"-----BEGIN PUBLIC KEY-----\\n...\\n-----END PUBLIC KEY-----\"\n    }\n  },\n  \"steps\": {\n    \"build\": {\n      \"name\": \"build\",\n      \"attestations\": [\n        {\n          \"type\": \"https://witness.dev/attestations/material/v0.1\"\n        },\n        {\n          \"type\": \"https://witness.dev/attestations/git/v0.1\"\n        },\n        {\n          \"type\": \"https://witness.dev/attestations/command-run/v0.1\"\n        },\n        {\n          \"type\": \"https://witness.dev/attestations/product/v0.1\"\n        },\n        {\n          \"type\": \"https://witness.dev/attestations/github/v0.1\"\n        }\n      ],\n      \"functionaries\": [\n        {\n          \"type\": \"publickey\",\n          \"publickeyid\": \"build-key\"\n        }\n      ]\n    }\n  }\n}\n```\n\n**Witness Run Command:**\n```bash\nwitness run --step build \\\n  --attestations material,git,commandrun,product,github \\\n  --outfile build-attestation.json \\\n  --key signing-key.pem \\\n  -- <your-build-command>\n```\n\n**Rego Validation Rules:**\n```rego\n\n```\n\n**Verification:**\n```bash\nwitness verify \\\n  --policy policy-signed.json \\\n  --publickey policy-key.pub \\\n  -a build-attestation.json \\\n  --subject <artifact>\n```\n"}]}
{"messages": [{"role": "system", "content": "You are an expert in the Witness supply chain attestation framework. You help users instrument CI/CD pipelines with witness, create policy documents, and write Rego policies to validate attestations. You understand all attestors in go-witness and how to use them effectively."}, {"role": "user", "content": "How do I create a witness policy for a build step that uses these attestors: commandrun, environment, github, git?"}, {"role": "assistant", "content": "Here's a complete witness policy for your build step with commandrun, environment, github, git attestors:\n\n**Policy Document:**\n```json\n{\n  \"expires\": \"2026-11-08T10:52:59Z\",\n  \"publickeys\": {\n    \"build-key\": {\n      \"keyid\": \"sha256:9f0637d9f26cb935b88973c45f16ded816fa7d4a18d047ce1877c9263cdb494f\",\n      \"key\": \"-----BEGIN PUBLIC KEY-----\\n...\\n-----END PUBLIC KEY-----\"\n    }\n  },\n  \"steps\": {\n    \"build\": {\n      \"name\": \"build\",\n      \"attestations\": [\n        {\n          \"type\": \"https://witness.dev/attestations/command-run/v0.1\"\n        },\n        {\n          \"type\": \"https://witness.dev/attestations/environment/v0.1\"\n        },\n        {\n          \"type\": \"https://witness.dev/attestations/github/v0.1\"\n        },\n        {\n          \"type\": \"https://witness.dev/attestations/git/v0.1\"\n        }\n      ],\n      \"functionaries\": [\n        {\n          \"type\": \"publickey\",\n          \"publickeyid\": \"build-key\"\n        }\n      ]\n    }\n  }\n}\n```\n\n**Witness Run Command:**\n```bash\nwitness run --step build \\\n  --attestations commandrun,environment,github,git \\\n  --outfile build-attestation.json \\\n  --key signing-key.pem \\\n  -- <your-build-command>\n```\n\n**Rego Validation Rules:**\n```rego\n\n```\n\n**Verification:**\n```bash\nwitness verify \\\n  --policy policy-signed.json \\\n  --publickey policy-key.pub \\\n  -a build-attestation.json \\\n  --subject <artifact>\n```\n"}]}
{"messages": [{"role": "system", "content": "You are an expert in the Witness supply chain attestation framework. You help users instrument CI/CD pipelines with witness, create policy documents, and write Rego policies to validate attestations. You understand all attestors in go-witness and how to use them effectively."}, {"role": "user", "content": "How do I create a witness policy for a build step that uses these attestors: material, commandrun, product?"}, {"role": "assistant", "content": "Here's a complete witness policy for your build step with material, commandrun, product attestors:\n\n**Policy Document:**\n```json\n{\n  \"expires\": \"2026-11-08T10:52:59Z\",\n  \"publickeys\": {\n    \"build-key\": {\n      \"keyid\": \"sha256:e2f8d8fbc16641476de2718a97c4ecd33e9043263b973a1ccea7790aee4c26ee\",\n      \"key\": \"-----BEGIN PUBLIC KEY-----\\n...\\n-----END PUBLIC KEY-----\"\n    }\n  },\n  \"steps\": {\n    \"build\": {\n      \"name\": \"build\",\n      \"attestations\": [\n        {\n          \"type\": \"https://witness.dev/attestations/material/v0.1\"\n        },\n        {\n          \"type\": \"https://witness.dev/attestations/command-run/v0.1\"\n        },\n        {\n          \"type\": \"https://witness.dev/attestations/product/v0.1\"\n        }\n      ],\n      \"functionaries\": [\n        {\n          \"type\": \"publickey\",\n          \"publickeyid\": \"build-key\"\n        }\n      ]\n    }\n  }\n}\n```\n\n**Witness Run Command:**\n```bash\nwitness run --step build \\\n  --attestations material,commandrun,product \\\n  --outfile build-attestation.json \\\n  --key signing-key.pem \\\n  -- <your-build-command>\n```\n\n**Rego Validation Rules:**\n```rego\n\n```\n\n**Verification:**\n```bash\nwitness verify \\\n  --policy policy-signed.json \\\n  --publickey policy-key.pub \\\n  -a build-attestation.json \\\n  --subject <artifact>\n```\n"}]}
{"messages": [{"role": "system", "content": "You are an expert in the Witness supply chain attestation framework. You help users instrument CI/CD pipelines with witness, create policy documents, and write Rego policies to validate attestations. You understand all attestors in go-witness and how to use them effectively."}, {"role": "user", "content": "How do I create a witness policy for a build step that uses these attestors: git, product, github?"}, {"role": "assistant", "content": "Here's a complete witness policy for your build step with git, product, github attestors:\n\n**Policy Document:**\n```json\n{\n  \"expires\": \"2026-11-08T10:52:59Z\",\n  \"publickeys\": {\n    \"build-key\": {\n      \"keyid\": \"sha256:228c407c203565caef8db8c5e1161eed32b497f18da8189880be0ad3e11824eb\",\n      \"key\": \"-----BEGIN PUBLIC KEY-----\\n...\\n-----END PUBLIC KEY-----\"\n    }\n  },\n  \"steps\": {\n    \"build\": {\n      \"name\": \"build\",\n      \"attestations\": [\n        {\n          \"type\": \"https://witness.dev/attestations/git/v0.1\"\n        },\n        {\n          \"type\": \"https://witness.dev/attestations/product/v0.1\"\n        },\n        {\n          \"type\": \"https://witness.dev/attestations/github/v0.1\"\n        }\n      ],\n      \"functionaries\": [\n        {\n          \"type\": \"publickey\",\n          \"publickeyid\": \"build-key\"\n        }\n      ]\n    }\n  }\n}\n```\n\n**Witness Run Command:**\n```bash\nwitness run --step build \\\n  --attestations git,product,github \\\n  --outfile build-attestation.json \\\n  --key signing-key.pem \\\n  -- <your-build-command>\n```\n\n**Rego Validation Rules:**\n```rego\npackage git\n\nimport rego.v1\n\n# Enforce builds from specific branch\ndeny contains msg if {\n    input.branch != \"feature/auth\"\n    msg := sprintf(\"Must build from feature/auth branch, got: %s\", [input.branch])\n}\n\n# Require clean working directory\ndeny contains msg if {\n    count(input.status) > 0\n    msg := \"Working directory must be clean (no uncommitted changes)\"\n}\n\n# Validate commit author\napproved_authors := {\n    \"alice.smith@example.com\",\n    \"bob.jones@company.com\",\n    \"ci-bot@company.com\"\n}\n\ndeny contains msg if {\n    not input.authoremail in approved_authors\n    msg := sprintf(\"Unauthorized commit author: %s\", [input.authoremail])\n}\n```\n\n**Verification:**\n```bash\nwitness verify \\\n  --policy policy-signed.json \\\n  --publickey policy-key.pub \\\n  -a build-attestation.json \\\n  --subject <artifact>\n```\n"}]}
{"messages": [{"role": "system", "content": "You are an expert in the Witness supply chain attestation framework. You help users instrument CI/CD pipelines with witness, create policy documents, and write Rego policies to validate attestations. You understand all attestors in go-witness and how to use them effectively."}, {"role": "user", "content": "How do I create a witness policy for a build step that uses these attestors: git, github?"}, {"role": "assistant", "content": "Here's a complete witness policy for your build step with git, github attestors:\n\n**Policy Document:**\n```json\n{\n  \"expires\": \"2026-11-08T10:52:59Z\",\n  \"publickeys\": {\n    \"build-key\": {\n      \"keyid\": \"sha256:87ff40a365183ae1c6eaa16c1a7e0f89fcb49232276ab6ce1e20051d87895d06\",\n      \"key\": \"-----BEGIN PUBLIC KEY-----\\n...\\n-----END PUBLIC KEY-----\"\n    }\n  },\n  \"steps\": {\n    \"build\": {\n      \"name\": \"build\",\n      \"attestations\": [\n        {\n          \"type\": \"https://witness.dev/attestations/git/v0.1\"\n        },\n        {\n          \"type\": \"https://witness.dev/attestations/github/v0.1\"\n        }\n      ],\n      \"functionaries\": [\n        {\n          \"type\": \"publickey\",\n          \"publickeyid\": \"build-key\"\n        }\n      ]\n    }\n  }\n}\n```\n\n**Witness Run Command:**\n```bash\nwitness run --step build \\\n  --attestations git,github \\\n  --outfile build-attestation.json \\\n  --key signing-key.pem \\\n  -- <your-build-command>\n```\n\n**Rego Validation Rules:**\n```rego\npackage git\n\nimport rego.v1\n\n# Enforce builds from specific branch\ndeny contains msg if {\n    input.branch != \"develop\"\n    msg := sprintf(\"Must build from develop branch, got: %s\", [input.branch])\n}\n\n# Require clean working directory\ndeny contains msg if {\n    count(input.status) > 0\n    msg := \"Working directory must be clean (no uncommitted changes)\"\n}\n\n# Validate commit author\napproved_authors := {\n    \"alice.smith@example.com\",\n    \"bob.jones@company.com\",\n    \"ci-bot@company.com\"\n}\n\ndeny contains msg if {\n    not input.authoremail in approved_authors\n    msg := sprintf(\"Unauthorized commit author: %s\", [input.authoremail])\n}\n```\n\n**Verification:**\n```bash\nwitness verify \\\n  --policy policy-signed.json \\\n  --publickey policy-key.pub \\\n  -a build-attestation.json \\\n  --subject <artifact>\n```\n"}]}
{"messages": [{"role": "system", "content": "You are an expert in the Witness supply chain attestation framework. You help users instrument CI/CD pipelines with witness, create policy documents, and write Rego policies to validate attestations. You understand all attestors in go-witness and how to use them effectively."}, {"role": "user", "content": "How do I create a multi-step witness policy for a build \u2192 test \u2192 package pipeline?"}, {"role": "assistant", "content": "Here's a complete multi-step witness policy for your pipeline:\n\n**Policy Document:**\n```json\n{\n  \"expires\": \"2026-11-08T10:52:59Z\",\n  \"publickeys\": {\n    \"ci-key\": {\n      \"keyid\": \"sha256:19b98f7d042795cec30dac0bad5eacf9756cc9914b18d61055a6c6fb88b56184\",\n      \"key\": \"-----BEGIN PUBLIC KEY-----\\n...\\n-----END PUBLIC KEY-----\"\n    }\n  },\n  \"steps\": {\n    \"build\": {\n      \"name\": \"build\",\n      \"attestations\": [\n        {\n          \"type\": \"https://witness.dev/attestations/git/v0.1\"\n        },\n        {\n          \"type\": \"https://witness.dev/attestations/command-run/v0.1\"\n        },\n        {\n          \"type\": \"https://witness.dev/attestations/product/v0.1\"\n        }\n      ],\n      \"functionaries\": [\n        {\n          \"type\": \"publickey\",\n          \"publickeyid\": \"ci-key\"\n        }\n      ]\n    },\n    \"test\": {\n      \"name\": \"test\",\n      \"attestations\": [\n        {\n          \"type\": \"https://witness.dev/attestations/material/v0.1\"\n        },\n        {\n          \"type\": \"https://witness.dev/attestations/command-run/v0.1\"\n        }\n      ],\n      \"functionaries\": [\n        {\n          \"type\": \"publickey\",\n          \"publickeyid\": \"ci-key\"\n        }\n      ]\n    },\n    \"package\": {\n      \"name\": \"package\",\n      \"attestations\": [\n        {\n          \"type\": \"https://witness.dev/attestations/material/v0.1\"\n        },\n        {\n          \"type\": \"https://witness.dev/attestations/product/v0.1\"\n        }\n      ],\n      \"functionaries\": [\n        {\n          \"type\": \"publickey\",\n          \"publickeyid\": \"ci-key\"\n        }\n      ]\n    }\n  }\n}\n```\n\n**Pipeline Commands:**\n\n```bash\n# Step 1: Build\nwitness run --step build \\\n  --attestations git,commandrun,product \\\n  -o build.json --key ci-key.pem \\\n  -- go build -o myapp\n\n# Step 2: Test\nwitness run --step test \\\n  --attestations material,commandrun \\\n  -o test.json --key ci-key.pem \\\n  -- go test ./...\n\n# Step 3: Package\nwitness run --step package \\\n  --attestations material,product \\\n  -o package.json --key ci-key.pem \\\n  -- tar czf myapp.tar.gz myapp\n\n# Verify entire pipeline\nwitness verify \\\n  --policy policy-signed.json \\\n  --publickey policy-key.pub \\\n  -a build.json -a test.json -a package.json\n```\n"}]}
{"messages": [{"role": "system", "content": "You are an expert in the Witness supply chain attestation framework. You help users instrument CI/CD pipelines with witness, create policy documents, and write Rego policies to validate attestations. You understand all attestors in go-witness and how to use them effectively."}, {"role": "user", "content": "How do I create a multi-step witness policy for a build \u2192 test \u2192 package pipeline?"}, {"role": "assistant", "content": "Here's a complete multi-step witness policy for your pipeline:\n\n**Policy Document:**\n```json\n{\n  \"expires\": \"2026-11-08T10:52:59Z\",\n  \"publickeys\": {\n    \"ci-key\": {\n      \"keyid\": \"sha256:1888d87eda08a32ec3d56093b6be63566f90eb198a21da431f51303f00fe089e\",\n      \"key\": \"-----BEGIN PUBLIC KEY-----\\n...\\n-----END PUBLIC KEY-----\"\n    }\n  },\n  \"steps\": {\n    \"build\": {\n      \"name\": \"build\",\n      \"attestations\": [\n        {\n          \"type\": \"https://witness.dev/attestations/git/v0.1\"\n        },\n        {\n          \"type\": \"https://witness.dev/attestations/command-run/v0.1\"\n        },\n        {\n          \"type\": \"https://witness.dev/attestations/product/v0.1\"\n        }\n      ],\n      \"functionaries\": [\n        {\n          \"type\": \"publickey\",\n          \"publickeyid\": \"ci-key\"\n        }\n      ]\n    },\n    \"test\": {\n      \"name\": \"test\",\n      \"attestations\": [\n        {\n          \"type\": \"https://witness.dev/attestations/material/v0.1\"\n        },\n        {\n          \"type\": \"https://witness.dev/attestations/command-run/v0.1\"\n        }\n      ],\n      \"functionaries\": [\n        {\n          \"type\": \"publickey\",\n          \"publickeyid\": \"ci-key\"\n        }\n      ]\n    },\n    \"package\": {\n      \"name\": \"package\",\n      \"attestations\": [\n        {\n          \"type\": \"https://witness.dev/attestations/material/v0.1\"\n        },\n        {\n          \"type\": \"https://witness.dev/attestations/product/v0.1\"\n        }\n      ],\n      \"functionaries\": [\n        {\n          \"type\": \"publickey\",\n          \"publickeyid\": \"ci-key\"\n        }\n      ]\n    }\n  }\n}\n```\n\n**Pipeline Commands:**\n\n```bash\n# Step 1: Build\nwitness run --step build \\\n  --attestations git,commandrun,product \\\n  -o build.json --key ci-key.pem \\\n  -- go build -o myapp\n\n# Step 2: Test\nwitness run --step test \\\n  --attestations material,commandrun \\\n  -o test.json --key ci-key.pem \\\n  -- go test ./...\n\n# Step 3: Package\nwitness run --step package \\\n  --attestations material,product \\\n  -o package.json --key ci-key.pem \\\n  -- tar czf myapp.tar.gz myapp\n\n# Verify entire pipeline\nwitness verify \\\n  --policy policy-signed.json \\\n  --publickey policy-key.pub \\\n  -a build.json -a test.json -a package.json\n```\n"}]}
{"messages": [{"role": "system", "content": "You are an expert in the Witness supply chain attestation framework. You help users instrument CI/CD pipelines with witness, create policy documents, and write Rego policies to validate attestations. You understand all attestors in go-witness and how to use them effectively."}, {"role": "user", "content": "How do I create a witness policy for a build step that uses these attestors: environment, git, material, commandrun?"}, {"role": "assistant", "content": "Here's a complete witness policy for your build step with environment, git, material, commandrun attestors:\n\n**Policy Document:**\n```json\n{\n  \"expires\": \"2026-11-08T10:52:59Z\",\n  \"publickeys\": {\n    \"build-key\": {\n      \"keyid\": \"sha256:20c3540821d0e7a0b64d650fce23fedd0f0760ac8b6838207e77b61335f7e31b\",\n      \"key\": \"-----BEGIN PUBLIC KEY-----\\n...\\n-----END PUBLIC KEY-----\"\n    }\n  },\n  \"steps\": {\n    \"build\": {\n      \"name\": \"build\",\n      \"attestations\": [\n        {\n          \"type\": \"https://witness.dev/attestations/environment/v0.1\"\n        },\n        {\n          \"type\": \"https://witness.dev/attestations/git/v0.1\"\n        },\n        {\n          \"type\": \"https://witness.dev/attestations/material/v0.1\"\n        },\n        {\n          \"type\": \"https://witness.dev/attestations/command-run/v0.1\"\n        }\n      ],\n      \"functionaries\": [\n        {\n          \"type\": \"publickey\",\n          \"publickeyid\": \"build-key\"\n        }\n      ]\n    }\n  }\n}\n```\n\n**Witness Run Command:**\n```bash\nwitness run --step build \\\n  --attestations environment,git,material,commandrun \\\n  --outfile build-attestation.json \\\n  --key signing-key.pem \\\n  -- <your-build-command>\n```\n\n**Rego Validation Rules:**\n```rego\npackage environment\n\nimport rego.v1\n\n# Ensure correct OS\ndeny contains msg if {\n    input.os != \"windows\"\n    msg := sprintf(\"Must run on windows, got: %s\", [input.os])\n}\n\n# Require CI environment\ndeny contains msg if {\n    not \"CI\" in input.variables\n    msg := \"Must run in CI environment (CI variable not set)\"\n}\n```\n\n**Verification:**\n```bash\nwitness verify \\\n  --policy policy-signed.json \\\n  --publickey policy-key.pub \\\n  -a build-attestation.json \\\n  --subject <artifact>\n```\n"}]}
{"messages": [{"role": "system", "content": "You are an expert in the Witness supply chain attestation framework. You help users instrument CI/CD pipelines with witness, create policy documents, and write Rego policies to validate attestations. You understand all attestors in go-witness and how to use them effectively."}, {"role": "user", "content": "How do I create a witness policy for a build step that uses these attestors: product, commandrun, github, environment, git?"}, {"role": "assistant", "content": "Here's a complete witness policy for your build step with product, commandrun, github, environment, git attestors:\n\n**Policy Document:**\n```json\n{\n  \"expires\": \"2026-11-08T10:52:59Z\",\n  \"publickeys\": {\n    \"build-key\": {\n      \"keyid\": \"sha256:1bedca454dda669d93d017ae38a8a4f83208873a1cf4f512db2f01e924c95ac6\",\n      \"key\": \"-----BEGIN PUBLIC KEY-----\\n...\\n-----END PUBLIC KEY-----\"\n    }\n  },\n  \"steps\": {\n    \"build\": {\n      \"name\": \"build\",\n      \"attestations\": [\n        {\n          \"type\": \"https://witness.dev/attestations/product/v0.1\"\n        },\n        {\n          \"type\": \"https://witness.dev/attestations/command-run/v0.1\"\n        },\n        {\n          \"type\": \"https://witness.dev/attestations/github/v0.1\"\n        },\n        {\n          \"type\": \"https://witness.dev/attestations/environment/v0.1\"\n        },\n        {\n          \"type\": \"https://witness.dev/attestations/git/v0.1\"\n        }\n      ],\n      \"functionaries\": [\n        {\n          \"type\": \"publickey\",\n          \"publickeyid\": \"build-key\"\n        }\n      ]\n    }\n  }\n}\n```\n\n**Witness Run Command:**\n```bash\nwitness run --step build \\\n  --attestations product,commandrun,github,environment,git \\\n  --outfile build-attestation.json \\\n  --key signing-key.pem \\\n  -- <your-build-command>\n```\n\n**Rego Validation Rules:**\n```rego\n\n```\n\n**Verification:**\n```bash\nwitness verify \\\n  --policy policy-signed.json \\\n  --publickey policy-key.pub \\\n  -a build-attestation.json \\\n  --subject <artifact>\n```\n"}]}
{"messages": [{"role": "system", "content": "You are an expert in the Witness supply chain attestation framework. You help users instrument CI/CD pipelines with witness, create policy documents, and write Rego policies to validate attestations. You understand all attestors in go-witness and how to use them effectively."}, {"role": "user", "content": "How do I create a multi-step witness policy for a build \u2192 test \u2192 package pipeline?"}, {"role": "assistant", "content": "Here's a complete multi-step witness policy for your pipeline:\n\n**Policy Document:**\n```json\n{\n  \"expires\": \"2026-11-08T10:52:59Z\",\n  \"publickeys\": {\n    \"ci-key\": {\n      \"keyid\": \"sha256:2021e42e2517cebf1eca23e1627a57ec02192063a3f7c64c2d659925d9e10e09\",\n      \"key\": \"-----BEGIN PUBLIC KEY-----\\n...\\n-----END PUBLIC KEY-----\"\n    }\n  },\n  \"steps\": {\n    \"build\": {\n      \"name\": \"build\",\n      \"attestations\": [\n        {\n          \"type\": \"https://witness.dev/attestations/git/v0.1\"\n        },\n        {\n          \"type\": \"https://witness.dev/attestations/command-run/v0.1\"\n        },\n        {\n          \"type\": \"https://witness.dev/attestations/product/v0.1\"\n        }\n      ],\n      \"functionaries\": [\n        {\n          \"type\": \"publickey\",\n          \"publickeyid\": \"ci-key\"\n        }\n      ]\n    },\n    \"test\": {\n      \"name\": \"test\",\n      \"attestations\": [\n        {\n          \"type\": \"https://witness.dev/attestations/material/v0.1\"\n        },\n        {\n          \"type\": \"https://witness.dev/attestations/command-run/v0.1\"\n        }\n      ],\n      \"functionaries\": [\n        {\n          \"type\": \"publickey\",\n          \"publickeyid\": \"ci-key\"\n        }\n      ]\n    },\n    \"package\": {\n      \"name\": \"package\",\n      \"attestations\": [\n        {\n          \"type\": \"https://witness.dev/attestations/material/v0.1\"\n        },\n        {\n          \"type\": \"https://witness.dev/attestations/product/v0.1\"\n        }\n      ],\n      \"functionaries\": [\n        {\n          \"type\": \"publickey\",\n          \"publickeyid\": \"ci-key\"\n        }\n      ]\n    }\n  }\n}\n```\n\n**Pipeline Commands:**\n\n```bash\n# Step 1: Build\nwitness run --step build \\\n  --attestations git,commandrun,product \\\n  -o build.json --key ci-key.pem \\\n  -- go build -o myapp\n\n# Step 2: Test\nwitness run --step test \\\n  --attestations material,commandrun \\\n  -o test.json --key ci-key.pem \\\n  -- go test ./...\n\n# Step 3: Package\nwitness run --step package \\\n  --attestations material,product \\\n  -o package.json --key ci-key.pem \\\n  -- tar czf myapp.tar.gz myapp\n\n# Verify entire pipeline\nwitness verify \\\n  --policy policy-signed.json \\\n  --publickey policy-key.pub \\\n  -a build.json -a test.json -a package.json\n```\n"}]}
{"messages": [{"role": "system", "content": "You are an expert in the Witness supply chain attestation framework. You help users instrument CI/CD pipelines with witness, create policy documents, and write Rego policies to validate attestations. You understand all attestors in go-witness and how to use them effectively."}, {"role": "user", "content": "How do I create a witness policy for a build step that uses these attestors: github, commandrun, product?"}, {"role": "assistant", "content": "Here's a complete witness policy for your build step with github, commandrun, product attestors:\n\n**Policy Document:**\n```json\n{\n  \"expires\": \"2026-11-08T10:52:59Z\",\n  \"publickeys\": {\n    \"build-key\": {\n      \"keyid\": \"sha256:93528b4f0addfcfa71fbd0228de2b5c938bc48f462aeb3c6330cfa36b56e00ad\",\n      \"key\": \"-----BEGIN PUBLIC KEY-----\\n...\\n-----END PUBLIC KEY-----\"\n    }\n  },\n  \"steps\": {\n    \"build\": {\n      \"name\": \"build\",\n      \"attestations\": [\n        {\n          \"type\": \"https://witness.dev/attestations/github/v0.1\"\n        },\n        {\n          \"type\": \"https://witness.dev/attestations/command-run/v0.1\"\n        },\n        {\n          \"type\": \"https://witness.dev/attestations/product/v0.1\"\n        }\n      ],\n      \"functionaries\": [\n        {\n          \"type\": \"publickey\",\n          \"publickeyid\": \"build-key\"\n        }\n      ]\n    }\n  }\n}\n```\n\n**Witness Run Command:**\n```bash\nwitness run --step build \\\n  --attestations github,commandrun,product \\\n  --outfile build-attestation.json \\\n  --key signing-key.pem \\\n  -- <your-build-command>\n```\n\n**Rego Validation Rules:**\n```rego\n\n```\n\n**Verification:**\n```bash\nwitness verify \\\n  --policy policy-signed.json \\\n  --publickey policy-key.pub \\\n  -a build-attestation.json \\\n  --subject <artifact>\n```\n"}]}
{"messages": [{"role": "system", "content": "You are an expert in the Witness supply chain attestation framework. You help users instrument CI/CD pipelines with witness, create policy documents, and write Rego policies to validate attestations. You understand all attestors in go-witness and how to use them effectively."}, {"role": "user", "content": "How do I create a multi-step witness policy for a build \u2192 test \u2192 package pipeline?"}, {"role": "assistant", "content": "Here's a complete multi-step witness policy for your pipeline:\n\n**Policy Document:**\n```json\n{\n  \"expires\": \"2026-11-08T10:52:59Z\",\n  \"publickeys\": {\n    \"ci-key\": {\n      \"keyid\": \"sha256:11d7e6f3d4c1de969dc5a19168389490b4c612cbc191bda0df4287fe0338030d\",\n      \"key\": \"-----BEGIN PUBLIC KEY-----\\n...\\n-----END PUBLIC KEY-----\"\n    }\n  },\n  \"steps\": {\n    \"build\": {\n      \"name\": \"build\",\n      \"attestations\": [\n        {\n          \"type\": \"https://witness.dev/attestations/git/v0.1\"\n        },\n        {\n          \"type\": \"https://witness.dev/attestations/command-run/v0.1\"\n        },\n        {\n          \"type\": \"https://witness.dev/attestations/product/v0.1\"\n        }\n      ],\n      \"functionaries\": [\n        {\n          \"type\": \"publickey\",\n          \"publickeyid\": \"ci-key\"\n        }\n      ]\n    },\n    \"test\": {\n      \"name\": \"test\",\n      \"attestations\": [\n        {\n          \"type\": \"https://witness.dev/attestations/material/v0.1\"\n        },\n        {\n          \"type\": \"https://witness.dev/attestations/command-run/v0.1\"\n        }\n      ],\n      \"functionaries\": [\n        {\n          \"type\": \"publickey\",\n          \"publickeyid\": \"ci-key\"\n        }\n      ]\n    },\n    \"package\": {\n      \"name\": \"package\",\n      \"attestations\": [\n        {\n          \"type\": \"https://witness.dev/attestations/material/v0.1\"\n        },\n        {\n          \"type\": \"https://witness.dev/attestations/product/v0.1\"\n        }\n      ],\n      \"functionaries\": [\n        {\n          \"type\": \"publickey\",\n          \"publickeyid\": \"ci-key\"\n        }\n      ]\n    }\n  }\n}\n```\n\n**Pipeline Commands:**\n\n```bash\n# Step 1: Build\nwitness run --step build \\\n  --attestations git,commandrun,product \\\n  -o build.json --key ci-key.pem \\\n  -- go build -o myapp\n\n# Step 2: Test\nwitness run --step test \\\n  --attestations material,commandrun \\\n  -o test.json --key ci-key.pem \\\n  -- go test ./...\n\n# Step 3: Package\nwitness run --step package \\\n  --attestations material,product \\\n  -o package.json --key ci-key.pem \\\n  -- tar czf myapp.tar.gz myapp\n\n# Verify entire pipeline\nwitness verify \\\n  --policy policy-signed.json \\\n  --publickey policy-key.pub \\\n  -a build.json -a test.json -a package.json\n```\n"}]}
{"messages": [{"role": "system", "content": "You are an expert in the Witness supply chain attestation framework. You help users instrument CI/CD pipelines with witness, create policy documents, and write Rego policies to validate attestations. You understand all attestors in go-witness and how to use them effectively."}, {"role": "user", "content": "How do I create a witness policy for a build step that uses these attestors: git, material, environment, commandrun?"}, {"role": "assistant", "content": "Here's a complete witness policy for your build step with git, material, environment, commandrun attestors:\n\n**Policy Document:**\n```json\n{\n  \"expires\": \"2026-11-08T10:52:59Z\",\n  \"publickeys\": {\n    \"build-key\": {\n      \"keyid\": \"sha256:aaa713dcdde414ec15ca1eeaac0d8817f5dbf5a3ed428db8bbd818240911c72d\",\n      \"key\": \"-----BEGIN PUBLIC KEY-----\\n...\\n-----END PUBLIC KEY-----\"\n    }\n  },\n  \"steps\": {\n    \"build\": {\n      \"name\": \"build\",\n      \"attestations\": [\n        {\n          \"type\": \"https://witness.dev/attestations/git/v0.1\"\n        },\n        {\n          \"type\": \"https://witness.dev/attestations/material/v0.1\"\n        },\n        {\n          \"type\": \"https://witness.dev/attestations/environment/v0.1\"\n        },\n        {\n          \"type\": \"https://witness.dev/attestations/command-run/v0.1\"\n        }\n      ],\n      \"functionaries\": [\n        {\n          \"type\": \"publickey\",\n          \"publickeyid\": \"build-key\"\n        }\n      ]\n    }\n  }\n}\n```\n\n**Witness Run Command:**\n```bash\nwitness run --step build \\\n  --attestations git,material,environment,commandrun \\\n  --outfile build-attestation.json \\\n  --key signing-key.pem \\\n  -- <your-build-command>\n```\n\n**Rego Validation Rules:**\n```rego\npackage git\n\nimport rego.v1\n\n# Enforce builds from specific branch\ndeny contains msg if {\n    input.branch != \"bugfix/security\"\n    msg := sprintf(\"Must build from bugfix/security branch, got: %s\", [input.branch])\n}\n\n# Require clean working directory\ndeny contains msg if {\n    count(input.status) > 0\n    msg := \"Working directory must be clean (no uncommitted changes)\"\n}\n\n# Validate commit author\napproved_authors := {\n    \"alice.smith@example.com\",\n    \"bob.jones@company.com\",\n    \"ci-bot@company.com\"\n}\n\ndeny contains msg if {\n    not input.authoremail in approved_authors\n    msg := sprintf(\"Unauthorized commit author: %s\", [input.authoremail])\n}\n```\n\n**Verification:**\n```bash\nwitness verify \\\n  --policy policy-signed.json \\\n  --publickey policy-key.pub \\\n  -a build-attestation.json \\\n  --subject <artifact>\n```\n"}]}
{"messages": [{"role": "system", "content": "You are an expert in the Witness supply chain attestation framework. You help users instrument CI/CD pipelines with witness, create policy documents, and write Rego policies to validate attestations. You understand all attestors in go-witness and how to use them effectively."}, {"role": "user", "content": "How do I create a witness policy for a build step that uses these attestors: git, github?"}, {"role": "assistant", "content": "Here's a complete witness policy for your build step with git, github attestors:\n\n**Policy Document:**\n```json\n{\n  \"expires\": \"2026-11-08T10:52:59Z\",\n  \"publickeys\": {\n    \"build-key\": {\n      \"keyid\": \"sha256:95705e01f46531dfa13365ce67e0b00e4e75cd70cfc8ae3128f454acb139c006\",\n      \"key\": \"-----BEGIN PUBLIC KEY-----\\n...\\n-----END PUBLIC KEY-----\"\n    }\n  },\n  \"steps\": {\n    \"build\": {\n      \"name\": \"build\",\n      \"attestations\": [\n        {\n          \"type\": \"https://witness.dev/attestations/git/v0.1\"\n        },\n        {\n          \"type\": \"https://witness.dev/attestations/github/v0.1\"\n        }\n      ],\n      \"functionaries\": [\n        {\n          \"type\": \"publickey\",\n          \"publickeyid\": \"build-key\"\n        }\n      ]\n    }\n  }\n}\n```\n\n**Witness Run Command:**\n```bash\nwitness run --step build \\\n  --attestations git,github \\\n  --outfile build-attestation.json \\\n  --key signing-key.pem \\\n  -- <your-build-command>\n```\n\n**Rego Validation Rules:**\n```rego\npackage git\n\nimport rego.v1\n\n# Enforce builds from specific branch\ndeny contains msg if {\n    input.branch != \"hotfix/critical\"\n    msg := sprintf(\"Must build from hotfix/critical branch, got: %s\", [input.branch])\n}\n\n# Require clean working directory\ndeny contains msg if {\n    count(input.status) > 0\n    msg := \"Working directory must be clean (no uncommitted changes)\"\n}\n\n# Validate commit author\napproved_authors := {\n    \"alice.smith@example.com\",\n    \"bob.jones@company.com\",\n    \"ci-bot@company.com\"\n}\n\ndeny contains msg if {\n    not input.authoremail in approved_authors\n    msg := sprintf(\"Unauthorized commit author: %s\", [input.authoremail])\n}\n```\n\n**Verification:**\n```bash\nwitness verify \\\n  --policy policy-signed.json \\\n  --publickey policy-key.pub \\\n  -a build-attestation.json \\\n  --subject <artifact>\n```\n"}]}
{"messages": [{"role": "system", "content": "You are an expert in the Witness supply chain attestation framework. You help users instrument CI/CD pipelines with witness, create policy documents, and write Rego policies to validate attestations. You understand all attestors in go-witness and how to use them effectively."}, {"role": "user", "content": "How do I create a multi-step witness policy for a build \u2192 test \u2192 package pipeline?"}, {"role": "assistant", "content": "Here's a complete multi-step witness policy for your pipeline:\n\n**Policy Document:**\n```json\n{\n  \"expires\": \"2026-11-08T10:52:59Z\",\n  \"publickeys\": {\n    \"ci-key\": {\n      \"keyid\": \"sha256:a2f2461962ead3a163f97e82d2c4fca64d39642cd0ef4c27262e8b8d90793366\",\n      \"key\": \"-----BEGIN PUBLIC KEY-----\\n...\\n-----END PUBLIC KEY-----\"\n    }\n  },\n  \"steps\": {\n    \"build\": {\n      \"name\": \"build\",\n      \"attestations\": [\n        {\n          \"type\": \"https://witness.dev/attestations/git/v0.1\"\n        },\n        {\n          \"type\": \"https://witness.dev/attestations/command-run/v0.1\"\n        },\n        {\n          \"type\": \"https://witness.dev/attestations/product/v0.1\"\n        }\n      ],\n      \"functionaries\": [\n        {\n          \"type\": \"publickey\",\n          \"publickeyid\": \"ci-key\"\n        }\n      ]\n    },\n    \"test\": {\n      \"name\": \"test\",\n      \"attestations\": [\n        {\n          \"type\": \"https://witness.dev/attestations/material/v0.1\"\n        },\n        {\n          \"type\": \"https://witness.dev/attestations/command-run/v0.1\"\n        }\n      ],\n      \"functionaries\": [\n        {\n          \"type\": \"publickey\",\n          \"publickeyid\": \"ci-key\"\n        }\n      ]\n    },\n    \"package\": {\n      \"name\": \"package\",\n      \"attestations\": [\n        {\n          \"type\": \"https://witness.dev/attestations/material/v0.1\"\n        },\n        {\n          \"type\": \"https://witness.dev/attestations/product/v0.1\"\n        }\n      ],\n      \"functionaries\": [\n        {\n          \"type\": \"publickey\",\n          \"publickeyid\": \"ci-key\"\n        }\n      ]\n    }\n  }\n}\n```\n\n**Pipeline Commands:**\n\n```bash\n# Step 1: Build\nwitness run --step build \\\n  --attestations git,commandrun,product \\\n  -o build.json --key ci-key.pem \\\n  -- go build -o myapp\n\n# Step 2: Test\nwitness run --step test \\\n  --attestations material,commandrun \\\n  -o test.json --key ci-key.pem \\\n  -- go test ./...\n\n# Step 3: Package\nwitness run --step package \\\n  --attestations material,product \\\n  -o package.json --key ci-key.pem \\\n  -- tar czf myapp.tar.gz myapp\n\n# Verify entire pipeline\nwitness verify \\\n  --policy policy-signed.json \\\n  --publickey policy-key.pub \\\n  -a build.json -a test.json -a package.json\n```\n"}]}
{"messages": [{"role": "system", "content": "You are an expert in the Witness supply chain attestation framework. You help users instrument CI/CD pipelines with witness, create policy documents, and write Rego policies to validate attestations. You understand all attestors in go-witness and how to use them effectively."}, {"role": "user", "content": "How do I create a witness policy for a build step that uses these attestors: github, environment, material?"}, {"role": "assistant", "content": "Here's a complete witness policy for your build step with github, environment, material attestors:\n\n**Policy Document:**\n```json\n{\n  \"expires\": \"2026-11-08T10:52:59Z\",\n  \"publickeys\": {\n    \"build-key\": {\n      \"keyid\": \"sha256:aa28edf4d15bb9c9d45a40606336d192950a3e8c95b2310ab853d6d693f49f63\",\n      \"key\": \"-----BEGIN PUBLIC KEY-----\\n...\\n-----END PUBLIC KEY-----\"\n    }\n  },\n  \"steps\": {\n    \"build\": {\n      \"name\": \"build\",\n      \"attestations\": [\n        {\n          \"type\": \"https://witness.dev/attestations/github/v0.1\"\n        },\n        {\n          \"type\": \"https://witness.dev/attestations/environment/v0.1\"\n        },\n        {\n          \"type\": \"https://witness.dev/attestations/material/v0.1\"\n        }\n      ],\n      \"functionaries\": [\n        {\n          \"type\": \"publickey\",\n          \"publickeyid\": \"build-key\"\n        }\n      ]\n    }\n  }\n}\n```\n\n**Witness Run Command:**\n```bash\nwitness run --step build \\\n  --attestations github,environment,material \\\n  --outfile build-attestation.json \\\n  --key signing-key.pem \\\n  -- <your-build-command>\n```\n\n**Rego Validation Rules:**\n```rego\n\n```\n\n**Verification:**\n```bash\nwitness verify \\\n  --policy policy-signed.json \\\n  --publickey policy-key.pub \\\n  -a build-attestation.json \\\n  --subject <artifact>\n```\n"}]}
{"messages": [{"role": "system", "content": "You are an expert in the Witness supply chain attestation framework. You help users instrument CI/CD pipelines with witness, create policy documents, and write Rego policies to validate attestations. You understand all attestors in go-witness and how to use them effectively."}, {"role": "user", "content": "How do I create a multi-step witness policy for a build \u2192 test \u2192 package pipeline?"}, {"role": "assistant", "content": "Here's a complete multi-step witness policy for your pipeline:\n\n**Policy Document:**\n```json\n{\n  \"expires\": \"2026-11-08T10:52:59Z\",\n  \"publickeys\": {\n    \"ci-key\": {\n      \"keyid\": \"sha256:5c35bb4334c1a028b834478092c57d8d9d538ca40bb407d988fc1266adb653cb\",\n      \"key\": \"-----BEGIN PUBLIC KEY-----\\n...\\n-----END PUBLIC KEY-----\"\n    }\n  },\n  \"steps\": {\n    \"build\": {\n      \"name\": \"build\",\n      \"attestations\": [\n        {\n          \"type\": \"https://witness.dev/attestations/git/v0.1\"\n        },\n        {\n          \"type\": \"https://witness.dev/attestations/command-run/v0.1\"\n        },\n        {\n          \"type\": \"https://witness.dev/attestations/product/v0.1\"\n        }\n      ],\n      \"functionaries\": [\n        {\n          \"type\": \"publickey\",\n          \"publickeyid\": \"ci-key\"\n        }\n      ]\n    },\n    \"test\": {\n      \"name\": \"test\",\n      \"attestations\": [\n        {\n          \"type\": \"https://witness.dev/attestations/material/v0.1\"\n        },\n        {\n          \"type\": \"https://witness.dev/attestations/command-run/v0.1\"\n        }\n      ],\n      \"functionaries\": [\n        {\n          \"type\": \"publickey\",\n          \"publickeyid\": \"ci-key\"\n        }\n      ]\n    },\n    \"package\": {\n      \"name\": \"package\",\n      \"attestations\": [\n        {\n          \"type\": \"https://witness.dev/attestations/material/v0.1\"\n        },\n        {\n          \"type\": \"https://witness.dev/attestations/product/v0.1\"\n        }\n      ],\n      \"functionaries\": [\n        {\n          \"type\": \"publickey\",\n          \"publickeyid\": \"ci-key\"\n        }\n      ]\n    }\n  }\n}\n```\n\n**Pipeline Commands:**\n\n```bash\n# Step 1: Build\nwitness run --step build \\\n  --attestations git,commandrun,product \\\n  -o build.json --key ci-key.pem \\\n  -- go build -o myapp\n\n# Step 2: Test\nwitness run --step test \\\n  --attestations material,commandrun \\\n  -o test.json --key ci-key.pem \\\n  -- go test ./...\n\n# Step 3: Package\nwitness run --step package \\\n  --attestations material,product \\\n  -o package.json --key ci-key.pem \\\n  -- tar czf myapp.tar.gz myapp\n\n# Verify entire pipeline\nwitness verify \\\n  --policy policy-signed.json \\\n  --publickey policy-key.pub \\\n  -a build.json -a test.json -a package.json\n```\n"}]}
{"messages": [{"role": "system", "content": "You are an expert in the Witness supply chain attestation framework. You help users instrument CI/CD pipelines with witness, create policy documents, and write Rego policies to validate attestations. You understand all attestors in go-witness and how to use them effectively."}, {"role": "user", "content": "How do I create a witness policy for a build step that uses these attestors: product, commandrun?"}, {"role": "assistant", "content": "Here's a complete witness policy for your build step with product, commandrun attestors:\n\n**Policy Document:**\n```json\n{\n  \"expires\": \"2026-11-08T10:52:59Z\",\n  \"publickeys\": {\n    \"build-key\": {\n      \"keyid\": \"sha256:00ea736d666a85e2a6f11712a6624af50f6ab1fee7149b44ab665bd2ad59e5a8\",\n      \"key\": \"-----BEGIN PUBLIC KEY-----\\n...\\n-----END PUBLIC KEY-----\"\n    }\n  },\n  \"steps\": {\n    \"build\": {\n      \"name\": \"build\",\n      \"attestations\": [\n        {\n          \"type\": \"https://witness.dev/attestations/product/v0.1\"\n        },\n        {\n          \"type\": \"https://witness.dev/attestations/command-run/v0.1\"\n        }\n      ],\n      \"functionaries\": [\n        {\n          \"type\": \"publickey\",\n          \"publickeyid\": \"build-key\"\n        }\n      ]\n    }\n  }\n}\n```\n\n**Witness Run Command:**\n```bash\nwitness run --step build \\\n  --attestations product,commandrun \\\n  --outfile build-attestation.json \\\n  --key signing-key.pem \\\n  -- <your-build-command>\n```\n\n**Rego Validation Rules:**\n```rego\n\n```\n\n**Verification:**\n```bash\nwitness verify \\\n  --policy policy-signed.json \\\n  --publickey policy-key.pub \\\n  -a build-attestation.json \\\n  --subject <artifact>\n```\n"}]}
{"messages": [{"role": "system", "content": "You are an expert in the Witness supply chain attestation framework. You help users instrument CI/CD pipelines with witness, create policy documents, and write Rego policies to validate attestations. You understand all attestors in go-witness and how to use them effectively."}, {"role": "user", "content": "How do I create a witness policy for a build step that uses these attestors: git, commandrun, material, environment, github?"}, {"role": "assistant", "content": "Here's a complete witness policy for your build step with git, commandrun, material, environment, github attestors:\n\n**Policy Document:**\n```json\n{\n  \"expires\": \"2026-11-08T10:52:59Z\",\n  \"publickeys\": {\n    \"build-key\": {\n      \"keyid\": \"sha256:6b613cb33ae29fcc4b7efc0d1bc454372c3eb0fdd7fbaca0b7d4269f160806ef\",\n      \"key\": \"-----BEGIN PUBLIC KEY-----\\n...\\n-----END PUBLIC KEY-----\"\n    }\n  },\n  \"steps\": {\n    \"build\": {\n      \"name\": \"build\",\n      \"attestations\": [\n        {\n          \"type\": \"https://witness.dev/attestations/git/v0.1\"\n        },\n        {\n          \"type\": \"https://witness.dev/attestations/command-run/v0.1\"\n        },\n        {\n          \"type\": \"https://witness.dev/attestations/material/v0.1\"\n        },\n        {\n          \"type\": \"https://witness.dev/attestations/environment/v0.1\"\n        },\n        {\n          \"type\": \"https://witness.dev/attestations/github/v0.1\"\n        }\n      ],\n      \"functionaries\": [\n        {\n          \"type\": \"publickey\",\n          \"publickeyid\": \"build-key\"\n        }\n      ]\n    }\n  }\n}\n```\n\n**Witness Run Command:**\n```bash\nwitness run --step build \\\n  --attestations git,commandrun,material,environment,github \\\n  --outfile build-attestation.json \\\n  --key signing-key.pem \\\n  -- <your-build-command>\n```\n\n**Rego Validation Rules:**\n```rego\npackage git\n\nimport rego.v1\n\n# Enforce builds from specific branch\ndeny contains msg if {\n    input.branch != \"staging\"\n    msg := sprintf(\"Must build from staging branch, got: %s\", [input.branch])\n}\n\n# Require clean working directory\ndeny contains msg if {\n    count(input.status) > 0\n    msg := \"Working directory must be clean (no uncommitted changes)\"\n}\n\n# Validate commit author\napproved_authors := {\n    \"alice.smith@example.com\",\n    \"bob.jones@company.com\",\n    \"ci-bot@company.com\"\n}\n\ndeny contains msg if {\n    not input.authoremail in approved_authors\n    msg := sprintf(\"Unauthorized commit author: %s\", [input.authoremail])\n}\n```\n\n**Verification:**\n```bash\nwitness verify \\\n  --policy policy-signed.json \\\n  --publickey policy-key.pub \\\n  -a build-attestation.json \\\n  --subject <artifact>\n```\n"}]}
{"messages": [{"role": "system", "content": "You are an expert in the Witness supply chain attestation framework. You help users instrument CI/CD pipelines with witness, create policy documents, and write Rego policies to validate attestations. You understand all attestors in go-witness and how to use them effectively."}, {"role": "user", "content": "How do I create a witness policy for a build step that uses these attestors: commandrun, environment, product, material?"}, {"role": "assistant", "content": "Here's a complete witness policy for your build step with commandrun, environment, product, material attestors:\n\n**Policy Document:**\n```json\n{\n  \"expires\": \"2026-11-08T10:52:59Z\",\n  \"publickeys\": {\n    \"build-key\": {\n      \"keyid\": \"sha256:2457d58df8fef9fc36aeb9f709b18a962af7fcd999783c3105c3bf2ed3eda35f\",\n      \"key\": \"-----BEGIN PUBLIC KEY-----\\n...\\n-----END PUBLIC KEY-----\"\n    }\n  },\n  \"steps\": {\n    \"build\": {\n      \"name\": \"build\",\n      \"attestations\": [\n        {\n          \"type\": \"https://witness.dev/attestations/command-run/v0.1\"\n        },\n        {\n          \"type\": \"https://witness.dev/attestations/environment/v0.1\"\n        },\n        {\n          \"type\": \"https://witness.dev/attestations/product/v0.1\"\n        },\n        {\n          \"type\": \"https://witness.dev/attestations/material/v0.1\"\n        }\n      ],\n      \"functionaries\": [\n        {\n          \"type\": \"publickey\",\n          \"publickeyid\": \"build-key\"\n        }\n      ]\n    }\n  }\n}\n```\n\n**Witness Run Command:**\n```bash\nwitness run --step build \\\n  --attestations commandrun,environment,product,material \\\n  --outfile build-attestation.json \\\n  --key signing-key.pem \\\n  -- <your-build-command>\n```\n\n**Rego Validation Rules:**\n```rego\n\n```\n\n**Verification:**\n```bash\nwitness verify \\\n  --policy policy-signed.json \\\n  --publickey policy-key.pub \\\n  -a build-attestation.json \\\n  --subject <artifact>\n```\n"}]}
{"messages": [{"role": "system", "content": "You are an expert in the Witness supply chain attestation framework. You help users instrument CI/CD pipelines with witness, create policy documents, and write Rego policies to validate attestations. You understand all attestors in go-witness and how to use them effectively."}, {"role": "user", "content": "How do I create a witness policy for a build step that uses these attestors: commandrun, environment, git?"}, {"role": "assistant", "content": "Here's a complete witness policy for your build step with commandrun, environment, git attestors:\n\n**Policy Document:**\n```json\n{\n  \"expires\": \"2026-11-08T10:52:59Z\",\n  \"publickeys\": {\n    \"build-key\": {\n      \"keyid\": \"sha256:56195a7029e3f9af3ac10cb451fef90e051d27de8ac6b27b61fdb2cf33caee1e\",\n      \"key\": \"-----BEGIN PUBLIC KEY-----\\n...\\n-----END PUBLIC KEY-----\"\n    }\n  },\n  \"steps\": {\n    \"build\": {\n      \"name\": \"build\",\n      \"attestations\": [\n        {\n          \"type\": \"https://witness.dev/attestations/command-run/v0.1\"\n        },\n        {\n          \"type\": \"https://witness.dev/attestations/environment/v0.1\"\n        },\n        {\n          \"type\": \"https://witness.dev/attestations/git/v0.1\"\n        }\n      ],\n      \"functionaries\": [\n        {\n          \"type\": \"publickey\",\n          \"publickeyid\": \"build-key\"\n        }\n      ]\n    }\n  }\n}\n```\n\n**Witness Run Command:**\n```bash\nwitness run --step build \\\n  --attestations commandrun,environment,git \\\n  --outfile build-attestation.json \\\n  --key signing-key.pem \\\n  -- <your-build-command>\n```\n\n**Rego Validation Rules:**\n```rego\n\n```\n\n**Verification:**\n```bash\nwitness verify \\\n  --policy policy-signed.json \\\n  --publickey policy-key.pub \\\n  -a build-attestation.json \\\n  --subject <artifact>\n```\n"}]}
{"messages": [{"role": "system", "content": "You are an expert in the Witness supply chain attestation framework. You help users instrument CI/CD pipelines with witness, create policy documents, and write Rego policies to validate attestations. You understand all attestors in go-witness and how to use them effectively."}, {"role": "user", "content": "How do I create a witness policy for a build step that uses these attestors: material?"}, {"role": "assistant", "content": "Here's a complete witness policy for your build step with material attestors:\n\n**Policy Document:**\n```json\n{\n  \"expires\": \"2026-11-08T10:52:59Z\",\n  \"publickeys\": {\n    \"build-key\": {\n      \"keyid\": \"sha256:a5adf54da44600837c98999f0ab7a0313fbc1d245dee498144029b0d7a43be98\",\n      \"key\": \"-----BEGIN PUBLIC KEY-----\\n...\\n-----END PUBLIC KEY-----\"\n    }\n  },\n  \"steps\": {\n    \"build\": {\n      \"name\": \"build\",\n      \"attestations\": [\n        {\n          \"type\": \"https://witness.dev/attestations/material/v0.1\"\n        }\n      ],\n      \"functionaries\": [\n        {\n          \"type\": \"publickey\",\n          \"publickeyid\": \"build-key\"\n        }\n      ]\n    }\n  }\n}\n```\n\n**Witness Run Command:**\n```bash\nwitness run --step build \\\n  --attestations material \\\n  --outfile build-attestation.json \\\n  --key signing-key.pem \\\n  -- <your-build-command>\n```\n\n**Rego Validation Rules:**\n```rego\n\n```\n\n**Verification:**\n```bash\nwitness verify \\\n  --policy policy-signed.json \\\n  --publickey policy-key.pub \\\n  -a build-attestation.json \\\n  --subject <artifact>\n```\n"}]}
{"messages": [{"role": "system", "content": "You are an expert in the Witness supply chain attestation framework. You help users instrument CI/CD pipelines with witness, create policy documents, and write Rego policies to validate attestations. You understand all attestors in go-witness and how to use them effectively."}, {"role": "user", "content": "How do I create a witness policy for a build step that uses these attestors: material, commandrun, git, environment?"}, {"role": "assistant", "content": "Here's a complete witness policy for your build step with material, commandrun, git, environment attestors:\n\n**Policy Document:**\n```json\n{\n  \"expires\": \"2026-11-08T10:52:59Z\",\n  \"publickeys\": {\n    \"build-key\": {\n      \"keyid\": \"sha256:f3754ea92b1ca2283169cfe675d3400d3ab9c4661fef2275448353cf407cec37\",\n      \"key\": \"-----BEGIN PUBLIC KEY-----\\n...\\n-----END PUBLIC KEY-----\"\n    }\n  },\n  \"steps\": {\n    \"build\": {\n      \"name\": \"build\",\n      \"attestations\": [\n        {\n          \"type\": \"https://witness.dev/attestations/material/v0.1\"\n        },\n        {\n          \"type\": \"https://witness.dev/attestations/command-run/v0.1\"\n        },\n        {\n          \"type\": \"https://witness.dev/attestations/git/v0.1\"\n        },\n        {\n          \"type\": \"https://witness.dev/attestations/environment/v0.1\"\n        }\n      ],\n      \"functionaries\": [\n        {\n          \"type\": \"publickey\",\n          \"publickeyid\": \"build-key\"\n        }\n      ]\n    }\n  }\n}\n```\n\n**Witness Run Command:**\n```bash\nwitness run --step build \\\n  --attestations material,commandrun,git,environment \\\n  --outfile build-attestation.json \\\n  --key signing-key.pem \\\n  -- <your-build-command>\n```\n\n**Rego Validation Rules:**\n```rego\n\n```\n\n**Verification:**\n```bash\nwitness verify \\\n  --policy policy-signed.json \\\n  --publickey policy-key.pub \\\n  -a build-attestation.json \\\n  --subject <artifact>\n```\n"}]}
{"messages": [{"role": "system", "content": "You are an expert in the Witness supply chain attestation framework. You help users instrument CI/CD pipelines with witness, create policy documents, and write Rego policies to validate attestations. You understand all attestors in go-witness and how to use them effectively."}, {"role": "user", "content": "How do I create a multi-step witness policy for a build \u2192 test \u2192 package pipeline?"}, {"role": "assistant", "content": "Here's a complete multi-step witness policy for your pipeline:\n\n**Policy Document:**\n```json\n{\n  \"expires\": \"2026-11-08T10:52:59Z\",\n  \"publickeys\": {\n    \"ci-key\": {\n      \"keyid\": \"sha256:203fdd6cdf377feb027511a81529aed28ab14793ad916c4b50d441bee188bdd8\",\n      \"key\": \"-----BEGIN PUBLIC KEY-----\\n...\\n-----END PUBLIC KEY-----\"\n    }\n  },\n  \"steps\": {\n    \"build\": {\n      \"name\": \"build\",\n      \"attestations\": [\n        {\n          \"type\": \"https://witness.dev/attestations/git/v0.1\"\n        },\n        {\n          \"type\": \"https://witness.dev/attestations/command-run/v0.1\"\n        },\n        {\n          \"type\": \"https://witness.dev/attestations/product/v0.1\"\n        }\n      ],\n      \"functionaries\": [\n        {\n          \"type\": \"publickey\",\n          \"publickeyid\": \"ci-key\"\n        }\n      ]\n    },\n    \"test\": {\n      \"name\": \"test\",\n      \"attestations\": [\n        {\n          \"type\": \"https://witness.dev/attestations/material/v0.1\"\n        },\n        {\n          \"type\": \"https://witness.dev/attestations/command-run/v0.1\"\n        }\n      ],\n      \"functionaries\": [\n        {\n          \"type\": \"publickey\",\n          \"publickeyid\": \"ci-key\"\n        }\n      ]\n    },\n    \"package\": {\n      \"name\": \"package\",\n      \"attestations\": [\n        {\n          \"type\": \"https://witness.dev/attestations/material/v0.1\"\n        },\n        {\n          \"type\": \"https://witness.dev/attestations/product/v0.1\"\n        }\n      ],\n      \"functionaries\": [\n        {\n          \"type\": \"publickey\",\n          \"publickeyid\": \"ci-key\"\n        }\n      ]\n    }\n  }\n}\n```\n\n**Pipeline Commands:**\n\n```bash\n# Step 1: Build\nwitness run --step build \\\n  --attestations git,commandrun,product \\\n  -o build.json --key ci-key.pem \\\n  -- go build -o myapp\n\n# Step 2: Test\nwitness run --step test \\\n  --attestations material,commandrun \\\n  -o test.json --key ci-key.pem \\\n  -- go test ./...\n\n# Step 3: Package\nwitness run --step package \\\n  --attestations material,product \\\n  -o package.json --key ci-key.pem \\\n  -- tar czf myapp.tar.gz myapp\n\n# Verify entire pipeline\nwitness verify \\\n  --policy policy-signed.json \\\n  --publickey policy-key.pub \\\n  -a build.json -a test.json -a package.json\n```\n"}]}
{"messages": [{"role": "system", "content": "You are an expert in the Witness supply chain attestation framework. You help users instrument CI/CD pipelines with witness, create policy documents, and write Rego policies to validate attestations. You understand all attestors in go-witness and how to use them effectively."}, {"role": "user", "content": "How do I create a witness policy for a build step that uses these attestors: product, github, commandrun, environment?"}, {"role": "assistant", "content": "Here's a complete witness policy for your build step with product, github, commandrun, environment attestors:\n\n**Policy Document:**\n```json\n{\n  \"expires\": \"2026-11-08T10:52:59Z\",\n  \"publickeys\": {\n    \"build-key\": {\n      \"keyid\": \"sha256:fabadad83cdb6d59fd62f172ec281dd99d399c6e77eaa32ed537c9347bc6c7c6\",\n      \"key\": \"-----BEGIN PUBLIC KEY-----\\n...\\n-----END PUBLIC KEY-----\"\n    }\n  },\n  \"steps\": {\n    \"build\": {\n      \"name\": \"build\",\n      \"attestations\": [\n        {\n          \"type\": \"https://witness.dev/attestations/product/v0.1\"\n        },\n        {\n          \"type\": \"https://witness.dev/attestations/github/v0.1\"\n        },\n        {\n          \"type\": \"https://witness.dev/attestations/command-run/v0.1\"\n        },\n        {\n          \"type\": \"https://witness.dev/attestations/environment/v0.1\"\n        }\n      ],\n      \"functionaries\": [\n        {\n          \"type\": \"publickey\",\n          \"publickeyid\": \"build-key\"\n        }\n      ]\n    }\n  }\n}\n```\n\n**Witness Run Command:**\n```bash\nwitness run --step build \\\n  --attestations product,github,commandrun,environment \\\n  --outfile build-attestation.json \\\n  --key signing-key.pem \\\n  -- <your-build-command>\n```\n\n**Rego Validation Rules:**\n```rego\n\n```\n\n**Verification:**\n```bash\nwitness verify \\\n  --policy policy-signed.json \\\n  --publickey policy-key.pub \\\n  -a build-attestation.json \\\n  --subject <artifact>\n```\n"}]}
{"messages": [{"role": "system", "content": "You are an expert in the Witness supply chain attestation framework. You help users instrument CI/CD pipelines with witness, create policy documents, and write Rego policies to validate attestations. You understand all attestors in go-witness and how to use them effectively."}, {"role": "user", "content": "How do I create a witness policy for a build step that uses these attestors: commandrun, github, material, environment?"}, {"role": "assistant", "content": "Here's a complete witness policy for your build step with commandrun, github, material, environment attestors:\n\n**Policy Document:**\n```json\n{\n  \"expires\": \"2026-11-08T10:52:59Z\",\n  \"publickeys\": {\n    \"build-key\": {\n      \"keyid\": \"sha256:ff105b94a75d0876b964fa9f6e6f8682675f02a64793928eeea064518d14bbce\",\n      \"key\": \"-----BEGIN PUBLIC KEY-----\\n...\\n-----END PUBLIC KEY-----\"\n    }\n  },\n  \"steps\": {\n    \"build\": {\n      \"name\": \"build\",\n      \"attestations\": [\n        {\n          \"type\": \"https://witness.dev/attestations/command-run/v0.1\"\n        },\n        {\n          \"type\": \"https://witness.dev/attestations/github/v0.1\"\n        },\n        {\n          \"type\": \"https://witness.dev/attestations/material/v0.1\"\n        },\n        {\n          \"type\": \"https://witness.dev/attestations/environment/v0.1\"\n        }\n      ],\n      \"functionaries\": [\n        {\n          \"type\": \"publickey\",\n          \"publickeyid\": \"build-key\"\n        }\n      ]\n    }\n  }\n}\n```\n\n**Witness Run Command:**\n```bash\nwitness run --step build \\\n  --attestations commandrun,github,material,environment \\\n  --outfile build-attestation.json \\\n  --key signing-key.pem \\\n  -- <your-build-command>\n```\n\n**Rego Validation Rules:**\n```rego\n\n```\n\n**Verification:**\n```bash\nwitness verify \\\n  --policy policy-signed.json \\\n  --publickey policy-key.pub \\\n  -a build-attestation.json \\\n  --subject <artifact>\n```\n"}]}
{"messages": [{"role": "system", "content": "You are an expert in the Witness supply chain attestation framework. You help users instrument CI/CD pipelines with witness, create policy documents, and write Rego policies to validate attestations. You understand all attestors in go-witness and how to use them effectively."}, {"role": "user", "content": "How do I create a witness policy for a build step that uses these attestors: git?"}, {"role": "assistant", "content": "Here's a complete witness policy for your build step with git attestors:\n\n**Policy Document:**\n```json\n{\n  \"expires\": \"2026-11-08T10:52:59Z\",\n  \"publickeys\": {\n    \"build-key\": {\n      \"keyid\": \"sha256:79db4dc56bdabefd671bb51f322d490a2f3c784e8832d227ee9a0103bd782c1e\",\n      \"key\": \"-----BEGIN PUBLIC KEY-----\\n...\\n-----END PUBLIC KEY-----\"\n    }\n  },\n  \"steps\": {\n    \"build\": {\n      \"name\": \"build\",\n      \"attestations\": [\n        {\n          \"type\": \"https://witness.dev/attestations/git/v0.1\"\n        }\n      ],\n      \"functionaries\": [\n        {\n          \"type\": \"publickey\",\n          \"publickeyid\": \"build-key\"\n        }\n      ]\n    }\n  }\n}\n```\n\n**Witness Run Command:**\n```bash\nwitness run --step build \\\n  --attestations git \\\n  --outfile build-attestation.json \\\n  --key signing-key.pem \\\n  -- <your-build-command>\n```\n\n**Rego Validation Rules:**\n```rego\npackage git\n\nimport rego.v1\n\n# Enforce builds from specific branch\ndeny contains msg if {\n    input.branch != \"develop\"\n    msg := sprintf(\"Must build from develop branch, got: %s\", [input.branch])\n}\n\n# Require clean working directory\ndeny contains msg if {\n    count(input.status) > 0\n    msg := \"Working directory must be clean (no uncommitted changes)\"\n}\n\n# Validate commit author\napproved_authors := {\n    \"alice.smith@example.com\",\n    \"bob.jones@company.com\",\n    \"ci-bot@company.com\"\n}\n\ndeny contains msg if {\n    not input.authoremail in approved_authors\n    msg := sprintf(\"Unauthorized commit author: %s\", [input.authoremail])\n}\n```\n\n**Verification:**\n```bash\nwitness verify \\\n  --policy policy-signed.json \\\n  --publickey policy-key.pub \\\n  -a build-attestation.json \\\n  --subject <artifact>\n```\n"}]}
{"messages": [{"role": "system", "content": "You are an expert in the Witness supply chain attestation framework. You help users instrument CI/CD pipelines with witness, create policy documents, and write Rego policies to validate attestations. You understand all attestors in go-witness and how to use them effectively."}, {"role": "user", "content": "How do I create a witness policy for a build step that uses these attestors: material, product?"}, {"role": "assistant", "content": "Here's a complete witness policy for your build step with material, product attestors:\n\n**Policy Document:**\n```json\n{\n  \"expires\": \"2026-11-08T10:52:59Z\",\n  \"publickeys\": {\n    \"build-key\": {\n      \"keyid\": \"sha256:129935f0590a3b124aad300fc498992b41db65e0a8fa9fa72cac2499295fc9e4\",\n      \"key\": \"-----BEGIN PUBLIC KEY-----\\n...\\n-----END PUBLIC KEY-----\"\n    }\n  },\n  \"steps\": {\n    \"build\": {\n      \"name\": \"build\",\n      \"attestations\": [\n        {\n          \"type\": \"https://witness.dev/attestations/material/v0.1\"\n        },\n        {\n          \"type\": \"https://witness.dev/attestations/product/v0.1\"\n        }\n      ],\n      \"functionaries\": [\n        {\n          \"type\": \"publickey\",\n          \"publickeyid\": \"build-key\"\n        }\n      ]\n    }\n  }\n}\n```\n\n**Witness Run Command:**\n```bash\nwitness run --step build \\\n  --attestations material,product \\\n  --outfile build-attestation.json \\\n  --key signing-key.pem \\\n  -- <your-build-command>\n```\n\n**Rego Validation Rules:**\n```rego\n\n```\n\n**Verification:**\n```bash\nwitness verify \\\n  --policy policy-signed.json \\\n  --publickey policy-key.pub \\\n  -a build-attestation.json \\\n  --subject <artifact>\n```\n"}]}
{"messages": [{"role": "system", "content": "You are an expert in the Witness supply chain attestation framework. You help users instrument CI/CD pipelines with witness, create policy documents, and write Rego policies to validate attestations. You understand all attestors in go-witness and how to use them effectively."}, {"role": "user", "content": "How do I create a multi-step witness policy for a build \u2192 test \u2192 package pipeline?"}, {"role": "assistant", "content": "Here's a complete multi-step witness policy for your pipeline:\n\n**Policy Document:**\n```json\n{\n  \"expires\": \"2026-11-08T10:52:59Z\",\n  \"publickeys\": {\n    \"ci-key\": {\n      \"keyid\": \"sha256:093ceda3c45f7b85ed451100297a6c2d6375132ab11bb8999c407f65cef8413e\",\n      \"key\": \"-----BEGIN PUBLIC KEY-----\\n...\\n-----END PUBLIC KEY-----\"\n    }\n  },\n  \"steps\": {\n    \"build\": {\n      \"name\": \"build\",\n      \"attestations\": [\n        {\n          \"type\": \"https://witness.dev/attestations/git/v0.1\"\n        },\n        {\n          \"type\": \"https://witness.dev/attestations/command-run/v0.1\"\n        },\n        {\n          \"type\": \"https://witness.dev/attestations/product/v0.1\"\n        }\n      ],\n      \"functionaries\": [\n        {\n          \"type\": \"publickey\",\n          \"publickeyid\": \"ci-key\"\n        }\n      ]\n    },\n    \"test\": {\n      \"name\": \"test\",\n      \"attestations\": [\n        {\n          \"type\": \"https://witness.dev/attestations/material/v0.1\"\n        },\n        {\n          \"type\": \"https://witness.dev/attestations/command-run/v0.1\"\n        }\n      ],\n      \"functionaries\": [\n        {\n          \"type\": \"publickey\",\n          \"publickeyid\": \"ci-key\"\n        }\n      ]\n    },\n    \"package\": {\n      \"name\": \"package\",\n      \"attestations\": [\n        {\n          \"type\": \"https://witness.dev/attestations/material/v0.1\"\n        },\n        {\n          \"type\": \"https://witness.dev/attestations/product/v0.1\"\n        }\n      ],\n      \"functionaries\": [\n        {\n          \"type\": \"publickey\",\n          \"publickeyid\": \"ci-key\"\n        }\n      ]\n    }\n  }\n}\n```\n\n**Pipeline Commands:**\n\n```bash\n# Step 1: Build\nwitness run --step build \\\n  --attestations git,commandrun,product \\\n  -o build.json --key ci-key.pem \\\n  -- go build -o myapp\n\n# Step 2: Test\nwitness run --step test \\\n  --attestations material,commandrun \\\n  -o test.json --key ci-key.pem \\\n  -- go test ./...\n\n# Step 3: Package\nwitness run --step package \\\n  --attestations material,product \\\n  -o package.json --key ci-key.pem \\\n  -- tar czf myapp.tar.gz myapp\n\n# Verify entire pipeline\nwitness verify \\\n  --policy policy-signed.json \\\n  --publickey policy-key.pub \\\n  -a build.json -a test.json -a package.json\n```\n"}]}
{"messages": [{"role": "system", "content": "You are an expert in the Witness supply chain attestation framework. You help users instrument CI/CD pipelines with witness, create policy documents, and write Rego policies to validate attestations. You understand all attestors in go-witness and how to use them effectively."}, {"role": "user", "content": "How do I create a witness policy for a build step that uses these attestors: git, material, environment?"}, {"role": "assistant", "content": "Here's a complete witness policy for your build step with git, material, environment attestors:\n\n**Policy Document:**\n```json\n{\n  \"expires\": \"2026-11-08T10:52:59Z\",\n  \"publickeys\": {\n    \"build-key\": {\n      \"keyid\": \"sha256:15073d3878a94b4910a2a70d5d91a6fc247396a131f50ca57ff1718532b0a79a\",\n      \"key\": \"-----BEGIN PUBLIC KEY-----\\n...\\n-----END PUBLIC KEY-----\"\n    }\n  },\n  \"steps\": {\n    \"build\": {\n      \"name\": \"build\",\n      \"attestations\": [\n        {\n          \"type\": \"https://witness.dev/attestations/git/v0.1\"\n        },\n        {\n          \"type\": \"https://witness.dev/attestations/material/v0.1\"\n        },\n        {\n          \"type\": \"https://witness.dev/attestations/environment/v0.1\"\n        }\n      ],\n      \"functionaries\": [\n        {\n          \"type\": \"publickey\",\n          \"publickeyid\": \"build-key\"\n        }\n      ]\n    }\n  }\n}\n```\n\n**Witness Run Command:**\n```bash\nwitness run --step build \\\n  --attestations git,material,environment \\\n  --outfile build-attestation.json \\\n  --key signing-key.pem \\\n  -- <your-build-command>\n```\n\n**Rego Validation Rules:**\n```rego\npackage git\n\nimport rego.v1\n\n# Enforce builds from specific branch\ndeny contains msg if {\n    input.branch != \"feature/api\"\n    msg := sprintf(\"Must build from feature/api branch, got: %s\", [input.branch])\n}\n\n# Require clean working directory\ndeny contains msg if {\n    count(input.status) > 0\n    msg := \"Working directory must be clean (no uncommitted changes)\"\n}\n\n# Validate commit author\napproved_authors := {\n    \"alice.smith@example.com\",\n    \"bob.jones@company.com\",\n    \"ci-bot@company.com\"\n}\n\ndeny contains msg if {\n    not input.authoremail in approved_authors\n    msg := sprintf(\"Unauthorized commit author: %s\", [input.authoremail])\n}\n```\n\n**Verification:**\n```bash\nwitness verify \\\n  --policy policy-signed.json \\\n  --publickey policy-key.pub \\\n  -a build-attestation.json \\\n  --subject <artifact>\n```\n"}]}
{"messages": [{"role": "system", "content": "You are an expert in the Witness supply chain attestation framework. You help users instrument CI/CD pipelines with witness, create policy documents, and write Rego policies to validate attestations. You understand all attestors in go-witness and how to use them effectively."}, {"role": "user", "content": "How do I create a multi-step witness policy for a build \u2192 test \u2192 package pipeline?"}, {"role": "assistant", "content": "Here's a complete multi-step witness policy for your pipeline:\n\n**Policy Document:**\n```json\n{\n  \"expires\": \"2026-11-08T10:52:59Z\",\n  \"publickeys\": {\n    \"ci-key\": {\n      \"keyid\": \"sha256:03e85d278770876acf22bba86de3cf136fb7b71eaaaabbbd92c806f82a5af224\",\n      \"key\": \"-----BEGIN PUBLIC KEY-----\\n...\\n-----END PUBLIC KEY-----\"\n    }\n  },\n  \"steps\": {\n    \"build\": {\n      \"name\": \"build\",\n      \"attestations\": [\n        {\n          \"type\": \"https://witness.dev/attestations/git/v0.1\"\n        },\n        {\n          \"type\": \"https://witness.dev/attestations/command-run/v0.1\"\n        },\n        {\n          \"type\": \"https://witness.dev/attestations/product/v0.1\"\n        }\n      ],\n      \"functionaries\": [\n        {\n          \"type\": \"publickey\",\n          \"publickeyid\": \"ci-key\"\n        }\n      ]\n    },\n    \"test\": {\n      \"name\": \"test\",\n      \"attestations\": [\n        {\n          \"type\": \"https://witness.dev/attestations/material/v0.1\"\n        },\n        {\n          \"type\": \"https://witness.dev/attestations/command-run/v0.1\"\n        }\n      ],\n      \"functionaries\": [\n        {\n          \"type\": \"publickey\",\n          \"publickeyid\": \"ci-key\"\n        }\n      ]\n    },\n    \"package\": {\n      \"name\": \"package\",\n      \"attestations\": [\n        {\n          \"type\": \"https://witness.dev/attestations/material/v0.1\"\n        },\n        {\n          \"type\": \"https://witness.dev/attestations/product/v0.1\"\n        }\n      ],\n      \"functionaries\": [\n        {\n          \"type\": \"publickey\",\n          \"publickeyid\": \"ci-key\"\n        }\n      ]\n    }\n  }\n}\n```\n\n**Pipeline Commands:**\n\n```bash\n# Step 1: Build\nwitness run --step build \\\n  --attestations git,commandrun,product \\\n  -o build.json --key ci-key.pem \\\n  -- go build -o myapp\n\n# Step 2: Test\nwitness run --step test \\\n  --attestations material,commandrun \\\n  -o test.json --key ci-key.pem \\\n  -- go test ./...\n\n# Step 3: Package\nwitness run --step package \\\n  --attestations material,product \\\n  -o package.json --key ci-key.pem \\\n  -- tar czf myapp.tar.gz myapp\n\n# Verify entire pipeline\nwitness verify \\\n  --policy policy-signed.json \\\n  --publickey policy-key.pub \\\n  -a build.json -a test.json -a package.json\n```\n"}]}
{"messages": [{"role": "system", "content": "You are an expert in the Witness supply chain attestation framework. You help users instrument CI/CD pipelines with witness, create policy documents, and write Rego policies to validate attestations. You understand all attestors in go-witness and how to use them effectively."}, {"role": "user", "content": "How do I create a witness policy for a build step that uses these attestors: material, commandrun?"}, {"role": "assistant", "content": "Here's a complete witness policy for your build step with material, commandrun attestors:\n\n**Policy Document:**\n```json\n{\n  \"expires\": \"2026-11-08T10:52:59Z\",\n  \"publickeys\": {\n    \"build-key\": {\n      \"keyid\": \"sha256:1425665845db5b243975631bce613b16b8424a882f719d7a1298d54472d6ec8b\",\n      \"key\": \"-----BEGIN PUBLIC KEY-----\\n...\\n-----END PUBLIC KEY-----\"\n    }\n  },\n  \"steps\": {\n    \"build\": {\n      \"name\": \"build\",\n      \"attestations\": [\n        {\n          \"type\": \"https://witness.dev/attestations/material/v0.1\"\n        },\n        {\n          \"type\": \"https://witness.dev/attestations/command-run/v0.1\"\n        }\n      ],\n      \"functionaries\": [\n        {\n          \"type\": \"publickey\",\n          \"publickeyid\": \"build-key\"\n        }\n      ]\n    }\n  }\n}\n```\n\n**Witness Run Command:**\n```bash\nwitness run --step build \\\n  --attestations material,commandrun \\\n  --outfile build-attestation.json \\\n  --key signing-key.pem \\\n  -- <your-build-command>\n```\n\n**Rego Validation Rules:**\n```rego\n\n```\n\n**Verification:**\n```bash\nwitness verify \\\n  --policy policy-signed.json \\\n  --publickey policy-key.pub \\\n  -a build-attestation.json \\\n  --subject <artifact>\n```\n"}]}
{"messages": [{"role": "system", "content": "You are an expert in the Witness supply chain attestation framework. You help users instrument CI/CD pipelines with witness, create policy documents, and write Rego policies to validate attestations. You understand all attestors in go-witness and how to use them effectively."}, {"role": "user", "content": "How do I create a multi-step witness policy for a build \u2192 test \u2192 package pipeline?"}, {"role": "assistant", "content": "Here's a complete multi-step witness policy for your pipeline:\n\n**Policy Document:**\n```json\n{\n  \"expires\": \"2026-11-08T10:52:59Z\",\n  \"publickeys\": {\n    \"ci-key\": {\n      \"keyid\": \"sha256:a3c13b44760ff3bbcd20b64885f9a9008cfcabfd0e9ae0965e6880e2e68c3f89\",\n      \"key\": \"-----BEGIN PUBLIC KEY-----\\n...\\n-----END PUBLIC KEY-----\"\n    }\n  },\n  \"steps\": {\n    \"build\": {\n      \"name\": \"build\",\n      \"attestations\": [\n        {\n          \"type\": \"https://witness.dev/attestations/git/v0.1\"\n        },\n        {\n          \"type\": \"https://witness.dev/attestations/command-run/v0.1\"\n        },\n        {\n          \"type\": \"https://witness.dev/attestations/product/v0.1\"\n        }\n      ],\n      \"functionaries\": [\n        {\n          \"type\": \"publickey\",\n          \"publickeyid\": \"ci-key\"\n        }\n      ]\n    },\n    \"test\": {\n      \"name\": \"test\",\n      \"attestations\": [\n        {\n          \"type\": \"https://witness.dev/attestations/material/v0.1\"\n        },\n        {\n          \"type\": \"https://witness.dev/attestations/command-run/v0.1\"\n        }\n      ],\n      \"functionaries\": [\n        {\n          \"type\": \"publickey\",\n          \"publickeyid\": \"ci-key\"\n        }\n      ]\n    },\n    \"package\": {\n      \"name\": \"package\",\n      \"attestations\": [\n        {\n          \"type\": \"https://witness.dev/attestations/material/v0.1\"\n        },\n        {\n          \"type\": \"https://witness.dev/attestations/product/v0.1\"\n        }\n      ],\n      \"functionaries\": [\n        {\n          \"type\": \"publickey\",\n          \"publickeyid\": \"ci-key\"\n        }\n      ]\n    }\n  }\n}\n```\n\n**Pipeline Commands:**\n\n```bash\n# Step 1: Build\nwitness run --step build \\\n  --attestations git,commandrun,product \\\n  -o build.json --key ci-key.pem \\\n  -- go build -o myapp\n\n# Step 2: Test\nwitness run --step test \\\n  --attestations material,commandrun \\\n  -o test.json --key ci-key.pem \\\n  -- go test ./...\n\n# Step 3: Package\nwitness run --step package \\\n  --attestations material,product \\\n  -o package.json --key ci-key.pem \\\n  -- tar czf myapp.tar.gz myapp\n\n# Verify entire pipeline\nwitness verify \\\n  --policy policy-signed.json \\\n  --publickey policy-key.pub \\\n  -a build.json -a test.json -a package.json\n```\n"}]}
{"messages": [{"role": "system", "content": "You are an expert in the Witness supply chain attestation framework. You help users instrument CI/CD pipelines with witness, create policy documents, and write Rego policies to validate attestations. You understand all attestors in go-witness and how to use them effectively."}, {"role": "user", "content": "How do I create a witness policy for a build step that uses these attestors: git, commandrun, github, environment, product?"}, {"role": "assistant", "content": "Here's a complete witness policy for your build step with git, commandrun, github, environment, product attestors:\n\n**Policy Document:**\n```json\n{\n  \"expires\": \"2026-11-08T10:52:59Z\",\n  \"publickeys\": {\n    \"build-key\": {\n      \"keyid\": \"sha256:3d6e02fe4e20dce49539e5a501813e83af6bae7f8e23135e5d7b48fc535728a6\",\n      \"key\": \"-----BEGIN PUBLIC KEY-----\\n...\\n-----END PUBLIC KEY-----\"\n    }\n  },\n  \"steps\": {\n    \"build\": {\n      \"name\": \"build\",\n      \"attestations\": [\n        {\n          \"type\": \"https://witness.dev/attestations/git/v0.1\"\n        },\n        {\n          \"type\": \"https://witness.dev/attestations/command-run/v0.1\"\n        },\n        {\n          \"type\": \"https://witness.dev/attestations/github/v0.1\"\n        },\n        {\n          \"type\": \"https://witness.dev/attestations/environment/v0.1\"\n        },\n        {\n          \"type\": \"https://witness.dev/attestations/product/v0.1\"\n        }\n      ],\n      \"functionaries\": [\n        {\n          \"type\": \"publickey\",\n          \"publickeyid\": \"build-key\"\n        }\n      ]\n    }\n  }\n}\n```\n\n**Witness Run Command:**\n```bash\nwitness run --step build \\\n  --attestations git,commandrun,github,environment,product \\\n  --outfile build-attestation.json \\\n  --key signing-key.pem \\\n  -- <your-build-command>\n```\n\n**Rego Validation Rules:**\n```rego\npackage git\n\nimport rego.v1\n\n# Enforce builds from specific branch\ndeny contains msg if {\n    input.branch != \"staging\"\n    msg := sprintf(\"Must build from staging branch, got: %s\", [input.branch])\n}\n\n# Require clean working directory\ndeny contains msg if {\n    count(input.status) > 0\n    msg := \"Working directory must be clean (no uncommitted changes)\"\n}\n\n# Validate commit author\napproved_authors := {\n    \"alice.smith@example.com\",\n    \"bob.jones@company.com\",\n    \"ci-bot@company.com\"\n}\n\ndeny contains msg if {\n    not input.authoremail in approved_authors\n    msg := sprintf(\"Unauthorized commit author: %s\", [input.authoremail])\n}\n```\n\n**Verification:**\n```bash\nwitness verify \\\n  --policy policy-signed.json \\\n  --publickey policy-key.pub \\\n  -a build-attestation.json \\\n  --subject <artifact>\n```\n"}]}
{"messages": [{"role": "system", "content": "You are an expert in the Witness supply chain attestation framework. You help users instrument CI/CD pipelines with witness, create policy documents, and write Rego policies to validate attestations. You understand all attestors in go-witness and how to use them effectively."}, {"role": "user", "content": "How do I create a witness policy for a build step that uses these attestors: git, commandrun, product, github?"}, {"role": "assistant", "content": "Here's a complete witness policy for your build step with git, commandrun, product, github attestors:\n\n**Policy Document:**\n```json\n{\n  \"expires\": \"2026-11-08T10:52:59Z\",\n  \"publickeys\": {\n    \"build-key\": {\n      \"keyid\": \"sha256:53f9fb630441b20fed75a401d4deefe5c79684cb45b96e30ccdcbf3626c8c841\",\n      \"key\": \"-----BEGIN PUBLIC KEY-----\\n...\\n-----END PUBLIC KEY-----\"\n    }\n  },\n  \"steps\": {\n    \"build\": {\n      \"name\": \"build\",\n      \"attestations\": [\n        {\n          \"type\": \"https://witness.dev/attestations/git/v0.1\"\n        },\n        {\n          \"type\": \"https://witness.dev/attestations/command-run/v0.1\"\n        },\n        {\n          \"type\": \"https://witness.dev/attestations/product/v0.1\"\n        },\n        {\n          \"type\": \"https://witness.dev/attestations/github/v0.1\"\n        }\n      ],\n      \"functionaries\": [\n        {\n          \"type\": \"publickey\",\n          \"publickeyid\": \"build-key\"\n        }\n      ]\n    }\n  }\n}\n```\n\n**Witness Run Command:**\n```bash\nwitness run --step build \\\n  --attestations git,commandrun,product,github \\\n  --outfile build-attestation.json \\\n  --key signing-key.pem \\\n  -- <your-build-command>\n```\n\n**Rego Validation Rules:**\n```rego\npackage git\n\nimport rego.v1\n\n# Enforce builds from specific branch\ndeny contains msg if {\n    input.branch != \"main\"\n    msg := sprintf(\"Must build from main branch, got: %s\", [input.branch])\n}\n\n# Require clean working directory\ndeny contains msg if {\n    count(input.status) > 0\n    msg := \"Working directory must be clean (no uncommitted changes)\"\n}\n\n# Validate commit author\napproved_authors := {\n    \"alice.smith@example.com\",\n    \"bob.jones@company.com\",\n    \"ci-bot@company.com\"\n}\n\ndeny contains msg if {\n    not input.authoremail in approved_authors\n    msg := sprintf(\"Unauthorized commit author: %s\", [input.authoremail])\n}\n```\n\n**Verification:**\n```bash\nwitness verify \\\n  --policy policy-signed.json \\\n  --publickey policy-key.pub \\\n  -a build-attestation.json \\\n  --subject <artifact>\n```\n"}]}
{"messages": [{"role": "system", "content": "You are an expert in the Witness supply chain attestation framework. You help users instrument CI/CD pipelines with witness, create policy documents, and write Rego policies to validate attestations. You understand all attestors in go-witness and how to use them effectively."}, {"role": "user", "content": "How do I create a witness policy for a build step that uses these attestors: git, environment, commandrun?"}, {"role": "assistant", "content": "Here's a complete witness policy for your build step with git, environment, commandrun attestors:\n\n**Policy Document:**\n```json\n{\n  \"expires\": \"2026-11-08T10:52:59Z\",\n  \"publickeys\": {\n    \"build-key\": {\n      \"keyid\": \"sha256:dbcab5efcd1de92e473bdc7d4039a166d9355607a6e0c3a3eb2608bd82209648\",\n      \"key\": \"-----BEGIN PUBLIC KEY-----\\n...\\n-----END PUBLIC KEY-----\"\n    }\n  },\n  \"steps\": {\n    \"build\": {\n      \"name\": \"build\",\n      \"attestations\": [\n        {\n          \"type\": \"https://witness.dev/attestations/git/v0.1\"\n        },\n        {\n          \"type\": \"https://witness.dev/attestations/environment/v0.1\"\n        },\n        {\n          \"type\": \"https://witness.dev/attestations/command-run/v0.1\"\n        }\n      ],\n      \"functionaries\": [\n        {\n          \"type\": \"publickey\",\n          \"publickeyid\": \"build-key\"\n        }\n      ]\n    }\n  }\n}\n```\n\n**Witness Run Command:**\n```bash\nwitness run --step build \\\n  --attestations git,environment,commandrun \\\n  --outfile build-attestation.json \\\n  --key signing-key.pem \\\n  -- <your-build-command>\n```\n\n**Rego Validation Rules:**\n```rego\npackage git\n\nimport rego.v1\n\n# Enforce builds from specific branch\ndeny contains msg if {\n    input.branch != \"staging\"\n    msg := sprintf(\"Must build from staging branch, got: %s\", [input.branch])\n}\n\n# Require clean working directory\ndeny contains msg if {\n    count(input.status) > 0\n    msg := \"Working directory must be clean (no uncommitted changes)\"\n}\n\n# Validate commit author\napproved_authors := {\n    \"alice.smith@example.com\",\n    \"bob.jones@company.com\",\n    \"ci-bot@company.com\"\n}\n\ndeny contains msg if {\n    not input.authoremail in approved_authors\n    msg := sprintf(\"Unauthorized commit author: %s\", [input.authoremail])\n}\n```\n\n**Verification:**\n```bash\nwitness verify \\\n  --policy policy-signed.json \\\n  --publickey policy-key.pub \\\n  -a build-attestation.json \\\n  --subject <artifact>\n```\n"}]}
{"messages": [{"role": "system", "content": "You are an expert in the Witness supply chain attestation framework. You help users instrument CI/CD pipelines with witness, create policy documents, and write Rego policies to validate attestations. You understand all attestors in go-witness and how to use them effectively."}, {"role": "user", "content": "How do I create a witness policy for a build step that uses these attestors: commandrun, git?"}, {"role": "assistant", "content": "Here's a complete witness policy for your build step with commandrun, git attestors:\n\n**Policy Document:**\n```json\n{\n  \"expires\": \"2026-11-08T10:52:59Z\",\n  \"publickeys\": {\n    \"build-key\": {\n      \"keyid\": \"sha256:045f95d3e3650f3b890e36a6ea1f27342056b40bbecbcded1528f585e0ddac86\",\n      \"key\": \"-----BEGIN PUBLIC KEY-----\\n...\\n-----END PUBLIC KEY-----\"\n    }\n  },\n  \"steps\": {\n    \"build\": {\n      \"name\": \"build\",\n      \"attestations\": [\n        {\n          \"type\": \"https://witness.dev/attestations/command-run/v0.1\"\n        },\n        {\n          \"type\": \"https://witness.dev/attestations/git/v0.1\"\n        }\n      ],\n      \"functionaries\": [\n        {\n          \"type\": \"publickey\",\n          \"publickeyid\": \"build-key\"\n        }\n      ]\n    }\n  }\n}\n```\n\n**Witness Run Command:**\n```bash\nwitness run --step build \\\n  --attestations commandrun,git \\\n  --outfile build-attestation.json \\\n  --key signing-key.pem \\\n  -- <your-build-command>\n```\n\n**Rego Validation Rules:**\n```rego\n\n```\n\n**Verification:**\n```bash\nwitness verify \\\n  --policy policy-signed.json \\\n  --publickey policy-key.pub \\\n  -a build-attestation.json \\\n  --subject <artifact>\n```\n"}]}
{"messages": [{"role": "system", "content": "You are an expert in the Witness supply chain attestation framework. You help users instrument CI/CD pipelines with witness, create policy documents, and write Rego policies to validate attestations. You understand all attestors in go-witness and how to use them effectively."}, {"role": "user", "content": "How do I create a multi-step witness policy for a build \u2192 test \u2192 package pipeline?"}, {"role": "assistant", "content": "Here's a complete multi-step witness policy for your pipeline:\n\n**Policy Document:**\n```json\n{\n  \"expires\": \"2026-11-08T10:52:59Z\",\n  \"publickeys\": {\n    \"ci-key\": {\n      \"keyid\": \"sha256:a12faac182418b915fd358619f13db2c639e9ec47f77ac77511b8c5de7b74951\",\n      \"key\": \"-----BEGIN PUBLIC KEY-----\\n...\\n-----END PUBLIC KEY-----\"\n    }\n  },\n  \"steps\": {\n    \"build\": {\n      \"name\": \"build\",\n      \"attestations\": [\n        {\n          \"type\": \"https://witness.dev/attestations/git/v0.1\"\n        },\n        {\n          \"type\": \"https://witness.dev/attestations/command-run/v0.1\"\n        },\n        {\n          \"type\": \"https://witness.dev/attestations/product/v0.1\"\n        }\n      ],\n      \"functionaries\": [\n        {\n          \"type\": \"publickey\",\n          \"publickeyid\": \"ci-key\"\n        }\n      ]\n    },\n    \"test\": {\n      \"name\": \"test\",\n      \"attestations\": [\n        {\n          \"type\": \"https://witness.dev/attestations/material/v0.1\"\n        },\n        {\n          \"type\": \"https://witness.dev/attestations/command-run/v0.1\"\n        }\n      ],\n      \"functionaries\": [\n        {\n          \"type\": \"publickey\",\n          \"publickeyid\": \"ci-key\"\n        }\n      ]\n    },\n    \"package\": {\n      \"name\": \"package\",\n      \"attestations\": [\n        {\n          \"type\": \"https://witness.dev/attestations/material/v0.1\"\n        },\n        {\n          \"type\": \"https://witness.dev/attestations/product/v0.1\"\n        }\n      ],\n      \"functionaries\": [\n        {\n          \"type\": \"publickey\",\n          \"publickeyid\": \"ci-key\"\n        }\n      ]\n    }\n  }\n}\n```\n\n**Pipeline Commands:**\n\n```bash\n# Step 1: Build\nwitness run --step build \\\n  --attestations git,commandrun,product \\\n  -o build.json --key ci-key.pem \\\n  -- go build -o myapp\n\n# Step 2: Test\nwitness run --step test \\\n  --attestations material,commandrun \\\n  -o test.json --key ci-key.pem \\\n  -- go test ./...\n\n# Step 3: Package\nwitness run --step package \\\n  --attestations material,product \\\n  -o package.json --key ci-key.pem \\\n  -- tar czf myapp.tar.gz myapp\n\n# Verify entire pipeline\nwitness verify \\\n  --policy policy-signed.json \\\n  --publickey policy-key.pub \\\n  -a build.json -a test.json -a package.json\n```\n"}]}
{"messages": [{"role": "system", "content": "You are an expert in the Witness supply chain attestation framework. You help users instrument CI/CD pipelines with witness, create policy documents, and write Rego policies to validate attestations. You understand all attestors in go-witness and how to use them effectively."}, {"role": "user", "content": "How do I create a witness policy for a build step that uses these attestors: product?"}, {"role": "assistant", "content": "Here's a complete witness policy for your build step with product attestors:\n\n**Policy Document:**\n```json\n{\n  \"expires\": \"2026-11-08T10:52:59Z\",\n  \"publickeys\": {\n    \"build-key\": {\n      \"keyid\": \"sha256:eb3b3a25103d3cc4daabbc62b9cfcb75f3b15f6f89b22f8b829d65b642ec391b\",\n      \"key\": \"-----BEGIN PUBLIC KEY-----\\n...\\n-----END PUBLIC KEY-----\"\n    }\n  },\n  \"steps\": {\n    \"build\": {\n      \"name\": \"build\",\n      \"attestations\": [\n        {\n          \"type\": \"https://witness.dev/attestations/product/v0.1\"\n        }\n      ],\n      \"functionaries\": [\n        {\n          \"type\": \"publickey\",\n          \"publickeyid\": \"build-key\"\n        }\n      ]\n    }\n  }\n}\n```\n\n**Witness Run Command:**\n```bash\nwitness run --step build \\\n  --attestations product \\\n  --outfile build-attestation.json \\\n  --key signing-key.pem \\\n  -- <your-build-command>\n```\n\n**Rego Validation Rules:**\n```rego\n\n```\n\n**Verification:**\n```bash\nwitness verify \\\n  --policy policy-signed.json \\\n  --publickey policy-key.pub \\\n  -a build-attestation.json \\\n  --subject <artifact>\n```\n"}]}
{"messages": [{"role": "system", "content": "You are an expert in the Witness supply chain attestation framework. You help users instrument CI/CD pipelines with witness, create policy documents, and write Rego policies to validate attestations. You understand all attestors in go-witness and how to use them effectively."}, {"role": "user", "content": "How do I create a witness policy for a build step that uses these attestors: environment, git, github, product?"}, {"role": "assistant", "content": "Here's a complete witness policy for your build step with environment, git, github, product attestors:\n\n**Policy Document:**\n```json\n{\n  \"expires\": \"2026-11-08T10:52:59Z\",\n  \"publickeys\": {\n    \"build-key\": {\n      \"keyid\": \"sha256:d5afe0534c36050af798bb91344ffbc42f0a9d176a6bd0107ceb869310df9ccc\",\n      \"key\": \"-----BEGIN PUBLIC KEY-----\\n...\\n-----END PUBLIC KEY-----\"\n    }\n  },\n  \"steps\": {\n    \"build\": {\n      \"name\": \"build\",\n      \"attestations\": [\n        {\n          \"type\": \"https://witness.dev/attestations/environment/v0.1\"\n        },\n        {\n          \"type\": \"https://witness.dev/attestations/git/v0.1\"\n        },\n        {\n          \"type\": \"https://witness.dev/attestations/github/v0.1\"\n        },\n        {\n          \"type\": \"https://witness.dev/attestations/product/v0.1\"\n        }\n      ],\n      \"functionaries\": [\n        {\n          \"type\": \"publickey\",\n          \"publickeyid\": \"build-key\"\n        }\n      ]\n    }\n  }\n}\n```\n\n**Witness Run Command:**\n```bash\nwitness run --step build \\\n  --attestations environment,git,github,product \\\n  --outfile build-attestation.json \\\n  --key signing-key.pem \\\n  -- <your-build-command>\n```\n\n**Rego Validation Rules:**\n```rego\npackage environment\n\nimport rego.v1\n\n# Ensure correct OS\ndeny contains msg if {\n    input.os != \"windows\"\n    msg := sprintf(\"Must run on windows, got: %s\", [input.os])\n}\n\n# Require CI environment\ndeny contains msg if {\n    not \"CI\" in input.variables\n    msg := \"Must run in CI environment (CI variable not set)\"\n}\n```\n\n**Verification:**\n```bash\nwitness verify \\\n  --policy policy-signed.json \\\n  --publickey policy-key.pub \\\n  -a build-attestation.json \\\n  --subject <artifact>\n```\n"}]}
{"messages": [{"role": "system", "content": "You are an expert in the Witness supply chain attestation framework. You help users instrument CI/CD pipelines with witness, create policy documents, and write Rego policies to validate attestations. You understand all attestors in go-witness and how to use them effectively."}, {"role": "user", "content": "How do I create a multi-step witness policy for a build \u2192 test \u2192 package pipeline?"}, {"role": "assistant", "content": "Here's a complete multi-step witness policy for your pipeline:\n\n**Policy Document:**\n```json\n{\n  \"expires\": \"2026-11-08T10:52:59Z\",\n  \"publickeys\": {\n    \"ci-key\": {\n      \"keyid\": \"sha256:58e1e243d4881d9c4956d82c7b55fc07e9ff827d1bc0b906bd70db257c1a98c2\",\n      \"key\": \"-----BEGIN PUBLIC KEY-----\\n...\\n-----END PUBLIC KEY-----\"\n    }\n  },\n  \"steps\": {\n    \"build\": {\n      \"name\": \"build\",\n      \"attestations\": [\n        {\n          \"type\": \"https://witness.dev/attestations/git/v0.1\"\n        },\n        {\n          \"type\": \"https://witness.dev/attestations/command-run/v0.1\"\n        },\n        {\n          \"type\": \"https://witness.dev/attestations/product/v0.1\"\n        }\n      ],\n      \"functionaries\": [\n        {\n          \"type\": \"publickey\",\n          \"publickeyid\": \"ci-key\"\n        }\n      ]\n    },\n    \"test\": {\n      \"name\": \"test\",\n      \"attestations\": [\n        {\n          \"type\": \"https://witness.dev/attestations/material/v0.1\"\n        },\n        {\n          \"type\": \"https://witness.dev/attestations/command-run/v0.1\"\n        }\n      ],\n      \"functionaries\": [\n        {\n          \"type\": \"publickey\",\n          \"publickeyid\": \"ci-key\"\n        }\n      ]\n    },\n    \"package\": {\n      \"name\": \"package\",\n      \"attestations\": [\n        {\n          \"type\": \"https://witness.dev/attestations/material/v0.1\"\n        },\n        {\n          \"type\": \"https://witness.dev/attestations/product/v0.1\"\n        }\n      ],\n      \"functionaries\": [\n        {\n          \"type\": \"publickey\",\n          \"publickeyid\": \"ci-key\"\n        }\n      ]\n    }\n  }\n}\n```\n\n**Pipeline Commands:**\n\n```bash\n# Step 1: Build\nwitness run --step build \\\n  --attestations git,commandrun,product \\\n  -o build.json --key ci-key.pem \\\n  -- go build -o myapp\n\n# Step 2: Test\nwitness run --step test \\\n  --attestations material,commandrun \\\n  -o test.json --key ci-key.pem \\\n  -- go test ./...\n\n# Step 3: Package\nwitness run --step package \\\n  --attestations material,product \\\n  -o package.json --key ci-key.pem \\\n  -- tar czf myapp.tar.gz myapp\n\n# Verify entire pipeline\nwitness verify \\\n  --policy policy-signed.json \\\n  --publickey policy-key.pub \\\n  -a build.json -a test.json -a package.json\n```\n"}]}
{"messages": [{"role": "system", "content": "You are an expert in the Witness supply chain attestation framework. You help users instrument CI/CD pipelines with witness, create policy documents, and write Rego policies to validate attestations. You understand all attestors in go-witness and how to use them effectively."}, {"role": "user", "content": "How do I create a witness policy for a build step that uses these attestors: product, commandrun, github?"}, {"role": "assistant", "content": "Here's a complete witness policy for your build step with product, commandrun, github attestors:\n\n**Policy Document:**\n```json\n{\n  \"expires\": \"2026-11-08T10:52:59Z\",\n  \"publickeys\": {\n    \"build-key\": {\n      \"keyid\": \"sha256:080c9614571195653ecc777e407be3662877b803de31094368c48d9b82e117f2\",\n      \"key\": \"-----BEGIN PUBLIC KEY-----\\n...\\n-----END PUBLIC KEY-----\"\n    }\n  },\n  \"steps\": {\n    \"build\": {\n      \"name\": \"build\",\n      \"attestations\": [\n        {\n          \"type\": \"https://witness.dev/attestations/product/v0.1\"\n        },\n        {\n          \"type\": \"https://witness.dev/attestations/command-run/v0.1\"\n        },\n        {\n          \"type\": \"https://witness.dev/attestations/github/v0.1\"\n        }\n      ],\n      \"functionaries\": [\n        {\n          \"type\": \"publickey\",\n          \"publickeyid\": \"build-key\"\n        }\n      ]\n    }\n  }\n}\n```\n\n**Witness Run Command:**\n```bash\nwitness run --step build \\\n  --attestations product,commandrun,github \\\n  --outfile build-attestation.json \\\n  --key signing-key.pem \\\n  -- <your-build-command>\n```\n\n**Rego Validation Rules:**\n```rego\n\n```\n\n**Verification:**\n```bash\nwitness verify \\\n  --policy policy-signed.json \\\n  --publickey policy-key.pub \\\n  -a build-attestation.json \\\n  --subject <artifact>\n```\n"}]}
{"messages": [{"role": "system", "content": "You are an expert in the Witness supply chain attestation framework. You help users instrument CI/CD pipelines with witness, create policy documents, and write Rego policies to validate attestations. You understand all attestors in go-witness and how to use them effectively."}, {"role": "user", "content": "How do I create a witness policy for a build step that uses these attestors: material, git, github?"}, {"role": "assistant", "content": "Here's a complete witness policy for your build step with material, git, github attestors:\n\n**Policy Document:**\n```json\n{\n  \"expires\": \"2026-11-08T10:52:59Z\",\n  \"publickeys\": {\n    \"build-key\": {\n      \"keyid\": \"sha256:8ff409f405a72560adca304fb2c92af0770fef6e7864806921199b5eeb3b77a9\",\n      \"key\": \"-----BEGIN PUBLIC KEY-----\\n...\\n-----END PUBLIC KEY-----\"\n    }\n  },\n  \"steps\": {\n    \"build\": {\n      \"name\": \"build\",\n      \"attestations\": [\n        {\n          \"type\": \"https://witness.dev/attestations/material/v0.1\"\n        },\n        {\n          \"type\": \"https://witness.dev/attestations/git/v0.1\"\n        },\n        {\n          \"type\": \"https://witness.dev/attestations/github/v0.1\"\n        }\n      ],\n      \"functionaries\": [\n        {\n          \"type\": \"publickey\",\n          \"publickeyid\": \"build-key\"\n        }\n      ]\n    }\n  }\n}\n```\n\n**Witness Run Command:**\n```bash\nwitness run --step build \\\n  --attestations material,git,github \\\n  --outfile build-attestation.json \\\n  --key signing-key.pem \\\n  -- <your-build-command>\n```\n\n**Rego Validation Rules:**\n```rego\n\n```\n\n**Verification:**\n```bash\nwitness verify \\\n  --policy policy-signed.json \\\n  --publickey policy-key.pub \\\n  -a build-attestation.json \\\n  --subject <artifact>\n```\n"}]}
{"messages": [{"role": "system", "content": "You are an expert in the Witness supply chain attestation framework. You help users instrument CI/CD pipelines with witness, create policy documents, and write Rego policies to validate attestations. You understand all attestors in go-witness and how to use them effectively."}, {"role": "user", "content": "How do I create a witness policy for a build step that uses these attestors: git, product, github, environment, commandrun?"}, {"role": "assistant", "content": "Here's a complete witness policy for your build step with git, product, github, environment, commandrun attestors:\n\n**Policy Document:**\n```json\n{\n  \"expires\": \"2026-11-08T10:52:59Z\",\n  \"publickeys\": {\n    \"build-key\": {\n      \"keyid\": \"sha256:b166cb0b6db2c35653011ef4faac0e18eb87746957c938891a4eae2fb6a4bbc5\",\n      \"key\": \"-----BEGIN PUBLIC KEY-----\\n...\\n-----END PUBLIC KEY-----\"\n    }\n  },\n  \"steps\": {\n    \"build\": {\n      \"name\": \"build\",\n      \"attestations\": [\n        {\n          \"type\": \"https://witness.dev/attestations/git/v0.1\"\n        },\n        {\n          \"type\": \"https://witness.dev/attestations/product/v0.1\"\n        },\n        {\n          \"type\": \"https://witness.dev/attestations/github/v0.1\"\n        },\n        {\n          \"type\": \"https://witness.dev/attestations/environment/v0.1\"\n        },\n        {\n          \"type\": \"https://witness.dev/attestations/command-run/v0.1\"\n        }\n      ],\n      \"functionaries\": [\n        {\n          \"type\": \"publickey\",\n          \"publickeyid\": \"build-key\"\n        }\n      ]\n    }\n  }\n}\n```\n\n**Witness Run Command:**\n```bash\nwitness run --step build \\\n  --attestations git,product,github,environment,commandrun \\\n  --outfile build-attestation.json \\\n  --key signing-key.pem \\\n  -- <your-build-command>\n```\n\n**Rego Validation Rules:**\n```rego\npackage git\n\nimport rego.v1\n\n# Enforce builds from specific branch\ndeny contains msg if {\n    input.branch != \"staging\"\n    msg := sprintf(\"Must build from staging branch, got: %s\", [input.branch])\n}\n\n# Require clean working directory\ndeny contains msg if {\n    count(input.status) > 0\n    msg := \"Working directory must be clean (no uncommitted changes)\"\n}\n\n# Validate commit author\napproved_authors := {\n    \"alice.smith@example.com\",\n    \"bob.jones@company.com\",\n    \"ci-bot@company.com\"\n}\n\ndeny contains msg if {\n    not input.authoremail in approved_authors\n    msg := sprintf(\"Unauthorized commit author: %s\", [input.authoremail])\n}\n```\n\n**Verification:**\n```bash\nwitness verify \\\n  --policy policy-signed.json \\\n  --publickey policy-key.pub \\\n  -a build-attestation.json \\\n  --subject <artifact>\n```\n"}]}
{"messages": [{"role": "system", "content": "You are an expert in the Witness supply chain attestation framework. You help users instrument CI/CD pipelines with witness, create policy documents, and write Rego policies to validate attestations. You understand all attestors in go-witness and how to use them effectively."}, {"role": "user", "content": "How do I create a witness policy for a build step that uses these attestors: github, material?"}, {"role": "assistant", "content": "Here's a complete witness policy for your build step with github, material attestors:\n\n**Policy Document:**\n```json\n{\n  \"expires\": \"2026-11-08T10:52:59Z\",\n  \"publickeys\": {\n    \"build-key\": {\n      \"keyid\": \"sha256:aa79c267272455dd6c9f19e927985579de78814023b71239d1fd7a8c84b26e9c\",\n      \"key\": \"-----BEGIN PUBLIC KEY-----\\n...\\n-----END PUBLIC KEY-----\"\n    }\n  },\n  \"steps\": {\n    \"build\": {\n      \"name\": \"build\",\n      \"attestations\": [\n        {\n          \"type\": \"https://witness.dev/attestations/github/v0.1\"\n        },\n        {\n          \"type\": \"https://witness.dev/attestations/material/v0.1\"\n        }\n      ],\n      \"functionaries\": [\n        {\n          \"type\": \"publickey\",\n          \"publickeyid\": \"build-key\"\n        }\n      ]\n    }\n  }\n}\n```\n\n**Witness Run Command:**\n```bash\nwitness run --step build \\\n  --attestations github,material \\\n  --outfile build-attestation.json \\\n  --key signing-key.pem \\\n  -- <your-build-command>\n```\n\n**Rego Validation Rules:**\n```rego\n\n```\n\n**Verification:**\n```bash\nwitness verify \\\n  --policy policy-signed.json \\\n  --publickey policy-key.pub \\\n  -a build-attestation.json \\\n  --subject <artifact>\n```\n"}]}
{"messages": [{"role": "system", "content": "You are an expert in the Witness supply chain attestation framework. You help users instrument CI/CD pipelines with witness, create policy documents, and write Rego policies to validate attestations. You understand all attestors in go-witness and how to use them effectively."}, {"role": "user", "content": "How do I create a witness policy for a build step that uses these attestors: github, git, environment, commandrun?"}, {"role": "assistant", "content": "Here's a complete witness policy for your build step with github, git, environment, commandrun attestors:\n\n**Policy Document:**\n```json\n{\n  \"expires\": \"2026-11-08T10:52:59Z\",\n  \"publickeys\": {\n    \"build-key\": {\n      \"keyid\": \"sha256:8fa9ca6d4ea9721329b4410fd08e48d0aff0fe33c39b44d8be189636108951d1\",\n      \"key\": \"-----BEGIN PUBLIC KEY-----\\n...\\n-----END PUBLIC KEY-----\"\n    }\n  },\n  \"steps\": {\n    \"build\": {\n      \"name\": \"build\",\n      \"attestations\": [\n        {\n          \"type\": \"https://witness.dev/attestations/github/v0.1\"\n        },\n        {\n          \"type\": \"https://witness.dev/attestations/git/v0.1\"\n        },\n        {\n          \"type\": \"https://witness.dev/attestations/environment/v0.1\"\n        },\n        {\n          \"type\": \"https://witness.dev/attestations/command-run/v0.1\"\n        }\n      ],\n      \"functionaries\": [\n        {\n          \"type\": \"publickey\",\n          \"publickeyid\": \"build-key\"\n        }\n      ]\n    }\n  }\n}\n```\n\n**Witness Run Command:**\n```bash\nwitness run --step build \\\n  --attestations github,git,environment,commandrun \\\n  --outfile build-attestation.json \\\n  --key signing-key.pem \\\n  -- <your-build-command>\n```\n\n**Rego Validation Rules:**\n```rego\n\n```\n\n**Verification:**\n```bash\nwitness verify \\\n  --policy policy-signed.json \\\n  --publickey policy-key.pub \\\n  -a build-attestation.json \\\n  --subject <artifact>\n```\n"}]}
{"messages": [{"role": "system", "content": "You are an expert in the Witness supply chain attestation framework. You help users instrument CI/CD pipelines with witness, create policy documents, and write Rego policies to validate attestations. You understand all attestors in go-witness and how to use them effectively."}, {"role": "user", "content": "How do I create a witness policy for a build step that uses these attestors: git, environment, material, github?"}, {"role": "assistant", "content": "Here's a complete witness policy for your build step with git, environment, material, github attestors:\n\n**Policy Document:**\n```json\n{\n  \"expires\": \"2026-11-08T10:52:59Z\",\n  \"publickeys\": {\n    \"build-key\": {\n      \"keyid\": \"sha256:87f6f3e8e24c70f0418e646591da1d906f4fff7789d80fd7a99bf478ccade672\",\n      \"key\": \"-----BEGIN PUBLIC KEY-----\\n...\\n-----END PUBLIC KEY-----\"\n    }\n  },\n  \"steps\": {\n    \"build\": {\n      \"name\": \"build\",\n      \"attestations\": [\n        {\n          \"type\": \"https://witness.dev/attestations/git/v0.1\"\n        },\n        {\n          \"type\": \"https://witness.dev/attestations/environment/v0.1\"\n        },\n        {\n          \"type\": \"https://witness.dev/attestations/material/v0.1\"\n        },\n        {\n          \"type\": \"https://witness.dev/attestations/github/v0.1\"\n        }\n      ],\n      \"functionaries\": [\n        {\n          \"type\": \"publickey\",\n          \"publickeyid\": \"build-key\"\n        }\n      ]\n    }\n  }\n}\n```\n\n**Witness Run Command:**\n```bash\nwitness run --step build \\\n  --attestations git,environment,material,github \\\n  --outfile build-attestation.json \\\n  --key signing-key.pem \\\n  -- <your-build-command>\n```\n\n**Rego Validation Rules:**\n```rego\npackage git\n\nimport rego.v1\n\n# Enforce builds from specific branch\ndeny contains msg if {\n    input.branch != \"develop\"\n    msg := sprintf(\"Must build from develop branch, got: %s\", [input.branch])\n}\n\n# Require clean working directory\ndeny contains msg if {\n    count(input.status) > 0\n    msg := \"Working directory must be clean (no uncommitted changes)\"\n}\n\n# Validate commit author\napproved_authors := {\n    \"alice.smith@example.com\",\n    \"bob.jones@company.com\",\n    \"ci-bot@company.com\"\n}\n\ndeny contains msg if {\n    not input.authoremail in approved_authors\n    msg := sprintf(\"Unauthorized commit author: %s\", [input.authoremail])\n}\n```\n\n**Verification:**\n```bash\nwitness verify \\\n  --policy policy-signed.json \\\n  --publickey policy-key.pub \\\n  -a build-attestation.json \\\n  --subject <artifact>\n```\n"}]}
{"messages": [{"role": "system", "content": "You are an expert in the Witness supply chain attestation framework. You help users instrument CI/CD pipelines with witness, create policy documents, and write Rego policies to validate attestations. You understand all attestors in go-witness and how to use them effectively."}, {"role": "user", "content": "How do I create a witness policy for a build step that uses these attestors: git, commandrun, product?"}, {"role": "assistant", "content": "Here's a complete witness policy for your build step with git, commandrun, product attestors:\n\n**Policy Document:**\n```json\n{\n  \"expires\": \"2026-11-08T10:52:59Z\",\n  \"publickeys\": {\n    \"build-key\": {\n      \"keyid\": \"sha256:0cfa6795d488eafbcd92a6f04707393796be6d2a85a984a3b46f7b765df1a72a\",\n      \"key\": \"-----BEGIN PUBLIC KEY-----\\n...\\n-----END PUBLIC KEY-----\"\n    }\n  },\n  \"steps\": {\n    \"build\": {\n      \"name\": \"build\",\n      \"attestations\": [\n        {\n          \"type\": \"https://witness.dev/attestations/git/v0.1\"\n        },\n        {\n          \"type\": \"https://witness.dev/attestations/command-run/v0.1\"\n        },\n        {\n          \"type\": \"https://witness.dev/attestations/product/v0.1\"\n        }\n      ],\n      \"functionaries\": [\n        {\n          \"type\": \"publickey\",\n          \"publickeyid\": \"build-key\"\n        }\n      ]\n    }\n  }\n}\n```\n\n**Witness Run Command:**\n```bash\nwitness run --step build \\\n  --attestations git,commandrun,product \\\n  --outfile build-attestation.json \\\n  --key signing-key.pem \\\n  -- <your-build-command>\n```\n\n**Rego Validation Rules:**\n```rego\npackage git\n\nimport rego.v1\n\n# Enforce builds from specific branch\ndeny contains msg if {\n    input.branch != \"release/v1.0\"\n    msg := sprintf(\"Must build from release/v1.0 branch, got: %s\", [input.branch])\n}\n\n# Require clean working directory\ndeny contains msg if {\n    count(input.status) > 0\n    msg := \"Working directory must be clean (no uncommitted changes)\"\n}\n\n# Validate commit author\napproved_authors := {\n    \"alice.smith@example.com\",\n    \"bob.jones@company.com\",\n    \"ci-bot@company.com\"\n}\n\ndeny contains msg if {\n    not input.authoremail in approved_authors\n    msg := sprintf(\"Unauthorized commit author: %s\", [input.authoremail])\n}\n```\n\n**Verification:**\n```bash\nwitness verify \\\n  --policy policy-signed.json \\\n  --publickey policy-key.pub \\\n  -a build-attestation.json \\\n  --subject <artifact>\n```\n"}]}
{"messages": [{"role": "system", "content": "You are an expert in the Witness supply chain attestation framework. You help users instrument CI/CD pipelines with witness, create policy documents, and write Rego policies to validate attestations. You understand all attestors in go-witness and how to use them effectively."}, {"role": "user", "content": "How do I create a witness policy for a build step that uses these attestors: material?"}, {"role": "assistant", "content": "Here's a complete witness policy for your build step with material attestors:\n\n**Policy Document:**\n```json\n{\n  \"expires\": \"2026-11-08T10:52:59Z\",\n  \"publickeys\": {\n    \"build-key\": {\n      \"keyid\": \"sha256:180146ae0c7addeaf4e3925ccb264f92b66d591464ebe376d53b64ce6cc36853\",\n      \"key\": \"-----BEGIN PUBLIC KEY-----\\n...\\n-----END PUBLIC KEY-----\"\n    }\n  },\n  \"steps\": {\n    \"build\": {\n      \"name\": \"build\",\n      \"attestations\": [\n        {\n          \"type\": \"https://witness.dev/attestations/material/v0.1\"\n        }\n      ],\n      \"functionaries\": [\n        {\n          \"type\": \"publickey\",\n          \"publickeyid\": \"build-key\"\n        }\n      ]\n    }\n  }\n}\n```\n\n**Witness Run Command:**\n```bash\nwitness run --step build \\\n  --attestations material \\\n  --outfile build-attestation.json \\\n  --key signing-key.pem \\\n  -- <your-build-command>\n```\n\n**Rego Validation Rules:**\n```rego\n\n```\n\n**Verification:**\n```bash\nwitness verify \\\n  --policy policy-signed.json \\\n  --publickey policy-key.pub \\\n  -a build-attestation.json \\\n  --subject <artifact>\n```\n"}]}
{"messages": [{"role": "system", "content": "You are an expert in the Witness supply chain attestation framework. You help users instrument CI/CD pipelines with witness, create policy documents, and write Rego policies to validate attestations. You understand all attestors in go-witness and how to use them effectively."}, {"role": "user", "content": "How do I create a witness policy for a build step that uses these attestors: environment?"}, {"role": "assistant", "content": "Here's a complete witness policy for your build step with environment attestors:\n\n**Policy Document:**\n```json\n{\n  \"expires\": \"2026-11-08T10:52:59Z\",\n  \"publickeys\": {\n    \"build-key\": {\n      \"keyid\": \"sha256:18f396bdcd6be341d909f9cf4d304767d4393166de6b69a16850e4336648d2e2\",\n      \"key\": \"-----BEGIN PUBLIC KEY-----\\n...\\n-----END PUBLIC KEY-----\"\n    }\n  },\n  \"steps\": {\n    \"build\": {\n      \"name\": \"build\",\n      \"attestations\": [\n        {\n          \"type\": \"https://witness.dev/attestations/environment/v0.1\"\n        }\n      ],\n      \"functionaries\": [\n        {\n          \"type\": \"publickey\",\n          \"publickeyid\": \"build-key\"\n        }\n      ]\n    }\n  }\n}\n```\n\n**Witness Run Command:**\n```bash\nwitness run --step build \\\n  --attestations environment \\\n  --outfile build-attestation.json \\\n  --key signing-key.pem \\\n  -- <your-build-command>\n```\n\n**Rego Validation Rules:**\n```rego\npackage environment\n\nimport rego.v1\n\n# Ensure correct OS\ndeny contains msg if {\n    input.os != \"windows\"\n    msg := sprintf(\"Must run on windows, got: %s\", [input.os])\n}\n\n# Require CI environment\ndeny contains msg if {\n    not \"CI\" in input.variables\n    msg := \"Must run in CI environment (CI variable not set)\"\n}\n```\n\n**Verification:**\n```bash\nwitness verify \\\n  --policy policy-signed.json \\\n  --publickey policy-key.pub \\\n  -a build-attestation.json \\\n  --subject <artifact>\n```\n"}]}
{"messages": [{"role": "system", "content": "You are an expert in the Witness supply chain attestation framework. You help users instrument CI/CD pipelines with witness, create policy documents, and write Rego policies to validate attestations. You understand all attestors in go-witness and how to use them effectively."}, {"role": "user", "content": "How do I create a witness policy for a build step that uses these attestors: product, environment, git, github, commandrun?"}, {"role": "assistant", "content": "Here's a complete witness policy for your build step with product, environment, git, github, commandrun attestors:\n\n**Policy Document:**\n```json\n{\n  \"expires\": \"2026-11-08T10:52:59Z\",\n  \"publickeys\": {\n    \"build-key\": {\n      \"keyid\": \"sha256:7efef72566f30223783ced85e1c2692c87923e2270d508077d5cf3069f6c1ff7\",\n      \"key\": \"-----BEGIN PUBLIC KEY-----\\n...\\n-----END PUBLIC KEY-----\"\n    }\n  },\n  \"steps\": {\n    \"build\": {\n      \"name\": \"build\",\n      \"attestations\": [\n        {\n          \"type\": \"https://witness.dev/attestations/product/v0.1\"\n        },\n        {\n          \"type\": \"https://witness.dev/attestations/environment/v0.1\"\n        },\n        {\n          \"type\": \"https://witness.dev/attestations/git/v0.1\"\n        },\n        {\n          \"type\": \"https://witness.dev/attestations/github/v0.1\"\n        },\n        {\n          \"type\": \"https://witness.dev/attestations/command-run/v0.1\"\n        }\n      ],\n      \"functionaries\": [\n        {\n          \"type\": \"publickey\",\n          \"publickeyid\": \"build-key\"\n        }\n      ]\n    }\n  }\n}\n```\n\n**Witness Run Command:**\n```bash\nwitness run --step build \\\n  --attestations product,environment,git,github,commandrun \\\n  --outfile build-attestation.json \\\n  --key signing-key.pem \\\n  -- <your-build-command>\n```\n\n**Rego Validation Rules:**\n```rego\n\n```\n\n**Verification:**\n```bash\nwitness verify \\\n  --policy policy-signed.json \\\n  --publickey policy-key.pub \\\n  -a build-attestation.json \\\n  --subject <artifact>\n```\n"}]}
{"messages": [{"role": "system", "content": "You are an expert in the Witness supply chain attestation framework. You help users instrument CI/CD pipelines with witness, create policy documents, and write Rego policies to validate attestations. You understand all attestors in go-witness and how to use them effectively."}, {"role": "user", "content": "How do I create a witness policy for a build step that uses these attestors: material, github, git?"}, {"role": "assistant", "content": "Here's a complete witness policy for your build step with material, github, git attestors:\n\n**Policy Document:**\n```json\n{\n  \"expires\": \"2026-11-08T10:52:59Z\",\n  \"publickeys\": {\n    \"build-key\": {\n      \"keyid\": \"sha256:de7c51e290ce1629dec58900d07f27875806f46829f8043dc10960f5add8c4f2\",\n      \"key\": \"-----BEGIN PUBLIC KEY-----\\n...\\n-----END PUBLIC KEY-----\"\n    }\n  },\n  \"steps\": {\n    \"build\": {\n      \"name\": \"build\",\n      \"attestations\": [\n        {\n          \"type\": \"https://witness.dev/attestations/material/v0.1\"\n        },\n        {\n          \"type\": \"https://witness.dev/attestations/github/v0.1\"\n        },\n        {\n          \"type\": \"https://witness.dev/attestations/git/v0.1\"\n        }\n      ],\n      \"functionaries\": [\n        {\n          \"type\": \"publickey\",\n          \"publickeyid\": \"build-key\"\n        }\n      ]\n    }\n  }\n}\n```\n\n**Witness Run Command:**\n```bash\nwitness run --step build \\\n  --attestations material,github,git \\\n  --outfile build-attestation.json \\\n  --key signing-key.pem \\\n  -- <your-build-command>\n```\n\n**Rego Validation Rules:**\n```rego\n\n```\n\n**Verification:**\n```bash\nwitness verify \\\n  --policy policy-signed.json \\\n  --publickey policy-key.pub \\\n  -a build-attestation.json \\\n  --subject <artifact>\n```\n"}]}
{"messages": [{"role": "system", "content": "You are an expert in the Witness supply chain attestation framework. You help users instrument CI/CD pipelines with witness, create policy documents, and write Rego policies to validate attestations. You understand all attestors in go-witness and how to use them effectively."}, {"role": "user", "content": "How do I create a witness policy for a build step that uses these attestors: github, environment, product, git, material?"}, {"role": "assistant", "content": "Here's a complete witness policy for your build step with github, environment, product, git, material attestors:\n\n**Policy Document:**\n```json\n{\n  \"expires\": \"2026-11-08T10:52:59Z\",\n  \"publickeys\": {\n    \"build-key\": {\n      \"keyid\": \"sha256:11e4eb6f646efef4c5f176e9d14118d5364147d24f26abb4caa08ed88bffafc4\",\n      \"key\": \"-----BEGIN PUBLIC KEY-----\\n...\\n-----END PUBLIC KEY-----\"\n    }\n  },\n  \"steps\": {\n    \"build\": {\n      \"name\": \"build\",\n      \"attestations\": [\n        {\n          \"type\": \"https://witness.dev/attestations/github/v0.1\"\n        },\n        {\n          \"type\": \"https://witness.dev/attestations/environment/v0.1\"\n        },\n        {\n          \"type\": \"https://witness.dev/attestations/product/v0.1\"\n        },\n        {\n          \"type\": \"https://witness.dev/attestations/git/v0.1\"\n        },\n        {\n          \"type\": \"https://witness.dev/attestations/material/v0.1\"\n        }\n      ],\n      \"functionaries\": [\n        {\n          \"type\": \"publickey\",\n          \"publickeyid\": \"build-key\"\n        }\n      ]\n    }\n  }\n}\n```\n\n**Witness Run Command:**\n```bash\nwitness run --step build \\\n  --attestations github,environment,product,git,material \\\n  --outfile build-attestation.json \\\n  --key signing-key.pem \\\n  -- <your-build-command>\n```\n\n**Rego Validation Rules:**\n```rego\n\n```\n\n**Verification:**\n```bash\nwitness verify \\\n  --policy policy-signed.json \\\n  --publickey policy-key.pub \\\n  -a build-attestation.json \\\n  --subject <artifact>\n```\n"}]}
{"messages": [{"role": "system", "content": "You are an expert in the Witness supply chain attestation framework. You help users instrument CI/CD pipelines with witness, create policy documents, and write Rego policies to validate attestations. You understand all attestors in go-witness and how to use them effectively."}, {"role": "user", "content": "How do I create a witness policy for a build step that uses these attestors: git, environment, material, commandrun, product?"}, {"role": "assistant", "content": "Here's a complete witness policy for your build step with git, environment, material, commandrun, product attestors:\n\n**Policy Document:**\n```json\n{\n  \"expires\": \"2026-11-08T10:52:59Z\",\n  \"publickeys\": {\n    \"build-key\": {\n      \"keyid\": \"sha256:f31abb4748d29f186ec11207c32094946bda14dd19445266b02e58e2d31b7d33\",\n      \"key\": \"-----BEGIN PUBLIC KEY-----\\n...\\n-----END PUBLIC KEY-----\"\n    }\n  },\n  \"steps\": {\n    \"build\": {\n      \"name\": \"build\",\n      \"attestations\": [\n        {\n          \"type\": \"https://witness.dev/attestations/git/v0.1\"\n        },\n        {\n          \"type\": \"https://witness.dev/attestations/environment/v0.1\"\n        },\n        {\n          \"type\": \"https://witness.dev/attestations/material/v0.1\"\n        },\n        {\n          \"type\": \"https://witness.dev/attestations/command-run/v0.1\"\n        },\n        {\n          \"type\": \"https://witness.dev/attestations/product/v0.1\"\n        }\n      ],\n      \"functionaries\": [\n        {\n          \"type\": \"publickey\",\n          \"publickeyid\": \"build-key\"\n        }\n      ]\n    }\n  }\n}\n```\n\n**Witness Run Command:**\n```bash\nwitness run --step build \\\n  --attestations git,environment,material,commandrun,product \\\n  --outfile build-attestation.json \\\n  --key signing-key.pem \\\n  -- <your-build-command>\n```\n\n**Rego Validation Rules:**\n```rego\npackage git\n\nimport rego.v1\n\n# Enforce builds from specific branch\ndeny contains msg if {\n    input.branch != \"feature/auth\"\n    msg := sprintf(\"Must build from feature/auth branch, got: %s\", [input.branch])\n}\n\n# Require clean working directory\ndeny contains msg if {\n    count(input.status) > 0\n    msg := \"Working directory must be clean (no uncommitted changes)\"\n}\n\n# Validate commit author\napproved_authors := {\n    \"alice.smith@example.com\",\n    \"bob.jones@company.com\",\n    \"ci-bot@company.com\"\n}\n\ndeny contains msg if {\n    not input.authoremail in approved_authors\n    msg := sprintf(\"Unauthorized commit author: %s\", [input.authoremail])\n}\n```\n\n**Verification:**\n```bash\nwitness verify \\\n  --policy policy-signed.json \\\n  --publickey policy-key.pub \\\n  -a build-attestation.json \\\n  --subject <artifact>\n```\n"}]}
{"messages": [{"role": "system", "content": "You are an expert in the Witness supply chain attestation framework. You help users instrument CI/CD pipelines with witness, create policy documents, and write Rego policies to validate attestations. You understand all attestors in go-witness and how to use them effectively."}, {"role": "user", "content": "How do I create a witness policy for a build step that uses these attestors: material?"}, {"role": "assistant", "content": "Here's a complete witness policy for your build step with material attestors:\n\n**Policy Document:**\n```json\n{\n  \"expires\": \"2026-11-08T10:52:59Z\",\n  \"publickeys\": {\n    \"build-key\": {\n      \"keyid\": \"sha256:6d45661dedcd87d7dd5cae18ad6abcb46a2f09763f8f58c61e696752170a18da\",\n      \"key\": \"-----BEGIN PUBLIC KEY-----\\n...\\n-----END PUBLIC KEY-----\"\n    }\n  },\n  \"steps\": {\n    \"build\": {\n      \"name\": \"build\",\n      \"attestations\": [\n        {\n          \"type\": \"https://witness.dev/attestations/material/v0.1\"\n        }\n      ],\n      \"functionaries\": [\n        {\n          \"type\": \"publickey\",\n          \"publickeyid\": \"build-key\"\n        }\n      ]\n    }\n  }\n}\n```\n\n**Witness Run Command:**\n```bash\nwitness run --step build \\\n  --attestations material \\\n  --outfile build-attestation.json \\\n  --key signing-key.pem \\\n  -- <your-build-command>\n```\n\n**Rego Validation Rules:**\n```rego\n\n```\n\n**Verification:**\n```bash\nwitness verify \\\n  --policy policy-signed.json \\\n  --publickey policy-key.pub \\\n  -a build-attestation.json \\\n  --subject <artifact>\n```\n"}]}
{"messages": [{"role": "system", "content": "You are an expert in the Witness supply chain attestation framework. You help users instrument CI/CD pipelines with witness, create policy documents, and write Rego policies to validate attestations. You understand all attestors in go-witness and how to use them effectively."}, {"role": "user", "content": "How do I create a witness policy for a build step that uses these attestors: git, material, commandrun, product, environment?"}, {"role": "assistant", "content": "Here's a complete witness policy for your build step with git, material, commandrun, product, environment attestors:\n\n**Policy Document:**\n```json\n{\n  \"expires\": \"2026-11-08T10:52:59Z\",\n  \"publickeys\": {\n    \"build-key\": {\n      \"keyid\": \"sha256:5f8c82cf0b51e1a99242e602f838ef3cccd65d8f7f4a71ce90f1b538a7511cb3\",\n      \"key\": \"-----BEGIN PUBLIC KEY-----\\n...\\n-----END PUBLIC KEY-----\"\n    }\n  },\n  \"steps\": {\n    \"build\": {\n      \"name\": \"build\",\n      \"attestations\": [\n        {\n          \"type\": \"https://witness.dev/attestations/git/v0.1\"\n        },\n        {\n          \"type\": \"https://witness.dev/attestations/material/v0.1\"\n        },\n        {\n          \"type\": \"https://witness.dev/attestations/command-run/v0.1\"\n        },\n        {\n          \"type\": \"https://witness.dev/attestations/product/v0.1\"\n        },\n        {\n          \"type\": \"https://witness.dev/attestations/environment/v0.1\"\n        }\n      ],\n      \"functionaries\": [\n        {\n          \"type\": \"publickey\",\n          \"publickeyid\": \"build-key\"\n        }\n      ]\n    }\n  }\n}\n```\n\n**Witness Run Command:**\n```bash\nwitness run --step build \\\n  --attestations git,material,commandrun,product,environment \\\n  --outfile build-attestation.json \\\n  --key signing-key.pem \\\n  -- <your-build-command>\n```\n\n**Rego Validation Rules:**\n```rego\npackage git\n\nimport rego.v1\n\n# Enforce builds from specific branch\ndeny contains msg if {\n    input.branch != \"hotfix/critical\"\n    msg := sprintf(\"Must build from hotfix/critical branch, got: %s\", [input.branch])\n}\n\n# Require clean working directory\ndeny contains msg if {\n    count(input.status) > 0\n    msg := \"Working directory must be clean (no uncommitted changes)\"\n}\n\n# Validate commit author\napproved_authors := {\n    \"alice.smith@example.com\",\n    \"bob.jones@company.com\",\n    \"ci-bot@company.com\"\n}\n\ndeny contains msg if {\n    not input.authoremail in approved_authors\n    msg := sprintf(\"Unauthorized commit author: %s\", [input.authoremail])\n}\n```\n\n**Verification:**\n```bash\nwitness verify \\\n  --policy policy-signed.json \\\n  --publickey policy-key.pub \\\n  -a build-attestation.json \\\n  --subject <artifact>\n```\n"}]}
{"messages": [{"role": "system", "content": "You are an expert in the Witness supply chain attestation framework. You help users instrument CI/CD pipelines with witness, create policy documents, and write Rego policies to validate attestations. You understand all attestors in go-witness and how to use them effectively."}, {"role": "user", "content": "How do I create a witness policy for a build step that uses these attestors: product, environment?"}, {"role": "assistant", "content": "Here's a complete witness policy for your build step with product, environment attestors:\n\n**Policy Document:**\n```json\n{\n  \"expires\": \"2026-11-08T10:52:59Z\",\n  \"publickeys\": {\n    \"build-key\": {\n      \"keyid\": \"sha256:987bd9bf01ba78f53a2c4e714330108c6017c6b330b694417f14501baae1ffec\",\n      \"key\": \"-----BEGIN PUBLIC KEY-----\\n...\\n-----END PUBLIC KEY-----\"\n    }\n  },\n  \"steps\": {\n    \"build\": {\n      \"name\": \"build\",\n      \"attestations\": [\n        {\n          \"type\": \"https://witness.dev/attestations/product/v0.1\"\n        },\n        {\n          \"type\": \"https://witness.dev/attestations/environment/v0.1\"\n        }\n      ],\n      \"functionaries\": [\n        {\n          \"type\": \"publickey\",\n          \"publickeyid\": \"build-key\"\n        }\n      ]\n    }\n  }\n}\n```\n\n**Witness Run Command:**\n```bash\nwitness run --step build \\\n  --attestations product,environment \\\n  --outfile build-attestation.json \\\n  --key signing-key.pem \\\n  -- <your-build-command>\n```\n\n**Rego Validation Rules:**\n```rego\n\n```\n\n**Verification:**\n```bash\nwitness verify \\\n  --policy policy-signed.json \\\n  --publickey policy-key.pub \\\n  -a build-attestation.json \\\n  --subject <artifact>\n```\n"}]}
{"messages": [{"role": "system", "content": "You are an expert in the Witness supply chain attestation framework. You help users instrument CI/CD pipelines with witness, create policy documents, and write Rego policies to validate attestations. You understand all attestors in go-witness and how to use them effectively."}, {"role": "user", "content": "How do I create a witness policy for a build step that uses these attestors: material, product?"}, {"role": "assistant", "content": "Here's a complete witness policy for your build step with material, product attestors:\n\n**Policy Document:**\n```json\n{\n  \"expires\": \"2026-11-08T10:52:59Z\",\n  \"publickeys\": {\n    \"build-key\": {\n      \"keyid\": \"sha256:6e0bfbed9e328883b2e59eb907c8cbba6cf15a49ff7fe15c628263b43658edcd\",\n      \"key\": \"-----BEGIN PUBLIC KEY-----\\n...\\n-----END PUBLIC KEY-----\"\n    }\n  },\n  \"steps\": {\n    \"build\": {\n      \"name\": \"build\",\n      \"attestations\": [\n        {\n          \"type\": \"https://witness.dev/attestations/material/v0.1\"\n        },\n        {\n          \"type\": \"https://witness.dev/attestations/product/v0.1\"\n        }\n      ],\n      \"functionaries\": [\n        {\n          \"type\": \"publickey\",\n          \"publickeyid\": \"build-key\"\n        }\n      ]\n    }\n  }\n}\n```\n\n**Witness Run Command:**\n```bash\nwitness run --step build \\\n  --attestations material,product \\\n  --outfile build-attestation.json \\\n  --key signing-key.pem \\\n  -- <your-build-command>\n```\n\n**Rego Validation Rules:**\n```rego\n\n```\n\n**Verification:**\n```bash\nwitness verify \\\n  --policy policy-signed.json \\\n  --publickey policy-key.pub \\\n  -a build-attestation.json \\\n  --subject <artifact>\n```\n"}]}
{"messages": [{"role": "system", "content": "You are an expert in the Witness supply chain attestation framework. You help users instrument CI/CD pipelines with witness, create policy documents, and write Rego policies to validate attestations. You understand all attestors in go-witness and how to use them effectively."}, {"role": "user", "content": "How do I create a multi-step witness policy for a build \u2192 test \u2192 package pipeline?"}, {"role": "assistant", "content": "Here's a complete multi-step witness policy for your pipeline:\n\n**Policy Document:**\n```json\n{\n  \"expires\": \"2026-11-08T10:52:59Z\",\n  \"publickeys\": {\n    \"ci-key\": {\n      \"keyid\": \"sha256:24bbf7bfedb10596f961b01dda9c9ed3580f71eb543009de6e09d36fc2e2ee70\",\n      \"key\": \"-----BEGIN PUBLIC KEY-----\\n...\\n-----END PUBLIC KEY-----\"\n    }\n  },\n  \"steps\": {\n    \"build\": {\n      \"name\": \"build\",\n      \"attestations\": [\n        {\n          \"type\": \"https://witness.dev/attestations/git/v0.1\"\n        },\n        {\n          \"type\": \"https://witness.dev/attestations/command-run/v0.1\"\n        },\n        {\n          \"type\": \"https://witness.dev/attestations/product/v0.1\"\n        }\n      ],\n      \"functionaries\": [\n        {\n          \"type\": \"publickey\",\n          \"publickeyid\": \"ci-key\"\n        }\n      ]\n    },\n    \"test\": {\n      \"name\": \"test\",\n      \"attestations\": [\n        {\n          \"type\": \"https://witness.dev/attestations/material/v0.1\"\n        },\n        {\n          \"type\": \"https://witness.dev/attestations/command-run/v0.1\"\n        }\n      ],\n      \"functionaries\": [\n        {\n          \"type\": \"publickey\",\n          \"publickeyid\": \"ci-key\"\n        }\n      ]\n    },\n    \"package\": {\n      \"name\": \"package\",\n      \"attestations\": [\n        {\n          \"type\": \"https://witness.dev/attestations/material/v0.1\"\n        },\n        {\n          \"type\": \"https://witness.dev/attestations/product/v0.1\"\n        }\n      ],\n      \"functionaries\": [\n        {\n          \"type\": \"publickey\",\n          \"publickeyid\": \"ci-key\"\n        }\n      ]\n    }\n  }\n}\n```\n\n**Pipeline Commands:**\n\n```bash\n# Step 1: Build\nwitness run --step build \\\n  --attestations git,commandrun,product \\\n  -o build.json --key ci-key.pem \\\n  -- go build -o myapp\n\n# Step 2: Test\nwitness run --step test \\\n  --attestations material,commandrun \\\n  -o test.json --key ci-key.pem \\\n  -- go test ./...\n\n# Step 3: Package\nwitness run --step package \\\n  --attestations material,product \\\n  -o package.json --key ci-key.pem \\\n  -- tar czf myapp.tar.gz myapp\n\n# Verify entire pipeline\nwitness verify \\\n  --policy policy-signed.json \\\n  --publickey policy-key.pub \\\n  -a build.json -a test.json -a package.json\n```\n"}]}
{"messages": [{"role": "system", "content": "You are an expert in the Witness supply chain attestation framework. You help users instrument CI/CD pipelines with witness, create policy documents, and write Rego policies to validate attestations. You understand all attestors in go-witness and how to use them effectively."}, {"role": "user", "content": "How do I create a witness policy for a build step that uses these attestors: commandrun, git, environment, product?"}, {"role": "assistant", "content": "Here's a complete witness policy for your build step with commandrun, git, environment, product attestors:\n\n**Policy Document:**\n```json\n{\n  \"expires\": \"2026-11-08T10:52:59Z\",\n  \"publickeys\": {\n    \"build-key\": {\n      \"keyid\": \"sha256:49c017765cb0b168330483f153725582b82b747f6637de5b6fa5c75948fc0d96\",\n      \"key\": \"-----BEGIN PUBLIC KEY-----\\n...\\n-----END PUBLIC KEY-----\"\n    }\n  },\n  \"steps\": {\n    \"build\": {\n      \"name\": \"build\",\n      \"attestations\": [\n        {\n          \"type\": \"https://witness.dev/attestations/command-run/v0.1\"\n        },\n        {\n          \"type\": \"https://witness.dev/attestations/git/v0.1\"\n        },\n        {\n          \"type\": \"https://witness.dev/attestations/environment/v0.1\"\n        },\n        {\n          \"type\": \"https://witness.dev/attestations/product/v0.1\"\n        }\n      ],\n      \"functionaries\": [\n        {\n          \"type\": \"publickey\",\n          \"publickeyid\": \"build-key\"\n        }\n      ]\n    }\n  }\n}\n```\n\n**Witness Run Command:**\n```bash\nwitness run --step build \\\n  --attestations commandrun,git,environment,product \\\n  --outfile build-attestation.json \\\n  --key signing-key.pem \\\n  -- <your-build-command>\n```\n\n**Rego Validation Rules:**\n```rego\n\n```\n\n**Verification:**\n```bash\nwitness verify \\\n  --policy policy-signed.json \\\n  --publickey policy-key.pub \\\n  -a build-attestation.json \\\n  --subject <artifact>\n```\n"}]}
{"messages": [{"role": "system", "content": "You are an expert in the Witness supply chain attestation framework. You help users instrument CI/CD pipelines with witness, create policy documents, and write Rego policies to validate attestations. You understand all attestors in go-witness and how to use them effectively."}, {"role": "user", "content": "How do I create a multi-step witness policy for a build \u2192 test \u2192 package pipeline?"}, {"role": "assistant", "content": "Here's a complete multi-step witness policy for your pipeline:\n\n**Policy Document:**\n```json\n{\n  \"expires\": \"2026-11-08T10:52:59Z\",\n  \"publickeys\": {\n    \"ci-key\": {\n      \"keyid\": \"sha256:16ddc3bf1702fb76cf4b928475b092336b656c252ea511dfcf3b5ff3a6d9fa09\",\n      \"key\": \"-----BEGIN PUBLIC KEY-----\\n...\\n-----END PUBLIC KEY-----\"\n    }\n  },\n  \"steps\": {\n    \"build\": {\n      \"name\": \"build\",\n      \"attestations\": [\n        {\n          \"type\": \"https://witness.dev/attestations/git/v0.1\"\n        },\n        {\n          \"type\": \"https://witness.dev/attestations/command-run/v0.1\"\n        },\n        {\n          \"type\": \"https://witness.dev/attestations/product/v0.1\"\n        }\n      ],\n      \"functionaries\": [\n        {\n          \"type\": \"publickey\",\n          \"publickeyid\": \"ci-key\"\n        }\n      ]\n    },\n    \"test\": {\n      \"name\": \"test\",\n      \"attestations\": [\n        {\n          \"type\": \"https://witness.dev/attestations/material/v0.1\"\n        },\n        {\n          \"type\": \"https://witness.dev/attestations/command-run/v0.1\"\n        }\n      ],\n      \"functionaries\": [\n        {\n          \"type\": \"publickey\",\n          \"publickeyid\": \"ci-key\"\n        }\n      ]\n    },\n    \"package\": {\n      \"name\": \"package\",\n      \"attestations\": [\n        {\n          \"type\": \"https://witness.dev/attestations/material/v0.1\"\n        },\n        {\n          \"type\": \"https://witness.dev/attestations/product/v0.1\"\n        }\n      ],\n      \"functionaries\": [\n        {\n          \"type\": \"publickey\",\n          \"publickeyid\": \"ci-key\"\n        }\n      ]\n    }\n  }\n}\n```\n\n**Pipeline Commands:**\n\n```bash\n# Step 1: Build\nwitness run --step build \\\n  --attestations git,commandrun,product \\\n  -o build.json --key ci-key.pem \\\n  -- go build -o myapp\n\n# Step 2: Test\nwitness run --step test \\\n  --attestations material,commandrun \\\n  -o test.json --key ci-key.pem \\\n  -- go test ./...\n\n# Step 3: Package\nwitness run --step package \\\n  --attestations material,product \\\n  -o package.json --key ci-key.pem \\\n  -- tar czf myapp.tar.gz myapp\n\n# Verify entire pipeline\nwitness verify \\\n  --policy policy-signed.json \\\n  --publickey policy-key.pub \\\n  -a build.json -a test.json -a package.json\n```\n"}]}
{"messages": [{"role": "system", "content": "You are an expert in the Witness supply chain attestation framework. You help users instrument CI/CD pipelines with witness, create policy documents, and write Rego policies to validate attestations. You understand all attestors in go-witness and how to use them effectively."}, {"role": "user", "content": "How do I create a witness policy for a build step that uses these attestors: github, environment, git?"}, {"role": "assistant", "content": "Here's a complete witness policy for your build step with github, environment, git attestors:\n\n**Policy Document:**\n```json\n{\n  \"expires\": \"2026-11-08T10:52:59Z\",\n  \"publickeys\": {\n    \"build-key\": {\n      \"keyid\": \"sha256:09be8438a8416ecc181933c15624b3f74cc4bcb17105153713d81f4129f17f2a\",\n      \"key\": \"-----BEGIN PUBLIC KEY-----\\n...\\n-----END PUBLIC KEY-----\"\n    }\n  },\n  \"steps\": {\n    \"build\": {\n      \"name\": \"build\",\n      \"attestations\": [\n        {\n          \"type\": \"https://witness.dev/attestations/github/v0.1\"\n        },\n        {\n          \"type\": \"https://witness.dev/attestations/environment/v0.1\"\n        },\n        {\n          \"type\": \"https://witness.dev/attestations/git/v0.1\"\n        }\n      ],\n      \"functionaries\": [\n        {\n          \"type\": \"publickey\",\n          \"publickeyid\": \"build-key\"\n        }\n      ]\n    }\n  }\n}\n```\n\n**Witness Run Command:**\n```bash\nwitness run --step build \\\n  --attestations github,environment,git \\\n  --outfile build-attestation.json \\\n  --key signing-key.pem \\\n  -- <your-build-command>\n```\n\n**Rego Validation Rules:**\n```rego\n\n```\n\n**Verification:**\n```bash\nwitness verify \\\n  --policy policy-signed.json \\\n  --publickey policy-key.pub \\\n  -a build-attestation.json \\\n  --subject <artifact>\n```\n"}]}
{"messages": [{"role": "system", "content": "You are an expert in the Witness supply chain attestation framework. You help users instrument CI/CD pipelines with witness, create policy documents, and write Rego policies to validate attestations. You understand all attestors in go-witness and how to use them effectively."}, {"role": "user", "content": "How do I create a witness policy for a build step that uses these attestors: github?"}, {"role": "assistant", "content": "Here's a complete witness policy for your build step with github attestors:\n\n**Policy Document:**\n```json\n{\n  \"expires\": \"2026-11-08T10:52:59Z\",\n  \"publickeys\": {\n    \"build-key\": {\n      \"keyid\": \"sha256:4abe8f2afbef94709baeb48189087d623c25e80ca376683b4149bf21e9d1638b\",\n      \"key\": \"-----BEGIN PUBLIC KEY-----\\n...\\n-----END PUBLIC KEY-----\"\n    }\n  },\n  \"steps\": {\n    \"build\": {\n      \"name\": \"build\",\n      \"attestations\": [\n        {\n          \"type\": \"https://witness.dev/attestations/github/v0.1\"\n        }\n      ],\n      \"functionaries\": [\n        {\n          \"type\": \"publickey\",\n          \"publickeyid\": \"build-key\"\n        }\n      ]\n    }\n  }\n}\n```\n\n**Witness Run Command:**\n```bash\nwitness run --step build \\\n  --attestations github \\\n  --outfile build-attestation.json \\\n  --key signing-key.pem \\\n  -- <your-build-command>\n```\n\n**Rego Validation Rules:**\n```rego\n\n```\n\n**Verification:**\n```bash\nwitness verify \\\n  --policy policy-signed.json \\\n  --publickey policy-key.pub \\\n  -a build-attestation.json \\\n  --subject <artifact>\n```\n"}]}
{"messages": [{"role": "system", "content": "You are an expert in the Witness supply chain attestation framework. You help users instrument CI/CD pipelines with witness, create policy documents, and write Rego policies to validate attestations. You understand all attestors in go-witness and how to use them effectively."}, {"role": "user", "content": "How do I create a multi-step witness policy for a build \u2192 test \u2192 package pipeline?"}, {"role": "assistant", "content": "Here's a complete multi-step witness policy for your pipeline:\n\n**Policy Document:**\n```json\n{\n  \"expires\": \"2026-11-08T10:52:59Z\",\n  \"publickeys\": {\n    \"ci-key\": {\n      \"keyid\": \"sha256:2284ef508ae46eba7e40b6e03d51e6d24a401150945433b6e8a5c1b74183af4f\",\n      \"key\": \"-----BEGIN PUBLIC KEY-----\\n...\\n-----END PUBLIC KEY-----\"\n    }\n  },\n  \"steps\": {\n    \"build\": {\n      \"name\": \"build\",\n      \"attestations\": [\n        {\n          \"type\": \"https://witness.dev/attestations/git/v0.1\"\n        },\n        {\n          \"type\": \"https://witness.dev/attestations/command-run/v0.1\"\n        },\n        {\n          \"type\": \"https://witness.dev/attestations/product/v0.1\"\n        }\n      ],\n      \"functionaries\": [\n        {\n          \"type\": \"publickey\",\n          \"publickeyid\": \"ci-key\"\n        }\n      ]\n    },\n    \"test\": {\n      \"name\": \"test\",\n      \"attestations\": [\n        {\n          \"type\": \"https://witness.dev/attestations/material/v0.1\"\n        },\n        {\n          \"type\": \"https://witness.dev/attestations/command-run/v0.1\"\n        }\n      ],\n      \"functionaries\": [\n        {\n          \"type\": \"publickey\",\n          \"publickeyid\": \"ci-key\"\n        }\n      ]\n    },\n    \"package\": {\n      \"name\": \"package\",\n      \"attestations\": [\n        {\n          \"type\": \"https://witness.dev/attestations/material/v0.1\"\n        },\n        {\n          \"type\": \"https://witness.dev/attestations/product/v0.1\"\n        }\n      ],\n      \"functionaries\": [\n        {\n          \"type\": \"publickey\",\n          \"publickeyid\": \"ci-key\"\n        }\n      ]\n    }\n  }\n}\n```\n\n**Pipeline Commands:**\n\n```bash\n# Step 1: Build\nwitness run --step build \\\n  --attestations git,commandrun,product \\\n  -o build.json --key ci-key.pem \\\n  -- go build -o myapp\n\n# Step 2: Test\nwitness run --step test \\\n  --attestations material,commandrun \\\n  -o test.json --key ci-key.pem \\\n  -- go test ./...\n\n# Step 3: Package\nwitness run --step package \\\n  --attestations material,product \\\n  -o package.json --key ci-key.pem \\\n  -- tar czf myapp.tar.gz myapp\n\n# Verify entire pipeline\nwitness verify \\\n  --policy policy-signed.json \\\n  --publickey policy-key.pub \\\n  -a build.json -a test.json -a package.json\n```\n"}]}
{"messages": [{"role": "system", "content": "You are an expert in the Witness supply chain attestation framework. You help users instrument CI/CD pipelines with witness, create policy documents, and write Rego policies to validate attestations. You understand all attestors in go-witness and how to use them effectively."}, {"role": "user", "content": "How do I create a witness policy for a build step that uses these attestors: environment, github, commandrun, product?"}, {"role": "assistant", "content": "Here's a complete witness policy for your build step with environment, github, commandrun, product attestors:\n\n**Policy Document:**\n```json\n{\n  \"expires\": \"2026-11-08T10:52:59Z\",\n  \"publickeys\": {\n    \"build-key\": {\n      \"keyid\": \"sha256:a3e7b0dfb25e2383db3dfab91d6cdbd33a7cd0decf350ab38adba0d2d686b43c\",\n      \"key\": \"-----BEGIN PUBLIC KEY-----\\n...\\n-----END PUBLIC KEY-----\"\n    }\n  },\n  \"steps\": {\n    \"build\": {\n      \"name\": \"build\",\n      \"attestations\": [\n        {\n          \"type\": \"https://witness.dev/attestations/environment/v0.1\"\n        },\n        {\n          \"type\": \"https://witness.dev/attestations/github/v0.1\"\n        },\n        {\n          \"type\": \"https://witness.dev/attestations/command-run/v0.1\"\n        },\n        {\n          \"type\": \"https://witness.dev/attestations/product/v0.1\"\n        }\n      ],\n      \"functionaries\": [\n        {\n          \"type\": \"publickey\",\n          \"publickeyid\": \"build-key\"\n        }\n      ]\n    }\n  }\n}\n```\n\n**Witness Run Command:**\n```bash\nwitness run --step build \\\n  --attestations environment,github,commandrun,product \\\n  --outfile build-attestation.json \\\n  --key signing-key.pem \\\n  -- <your-build-command>\n```\n\n**Rego Validation Rules:**\n```rego\npackage environment\n\nimport rego.v1\n\n# Ensure correct OS\ndeny contains msg if {\n    input.os != \"windows\"\n    msg := sprintf(\"Must run on windows, got: %s\", [input.os])\n}\n\n# Require CI environment\ndeny contains msg if {\n    not \"CI\" in input.variables\n    msg := \"Must run in CI environment (CI variable not set)\"\n}\n```\n\n**Verification:**\n```bash\nwitness verify \\\n  --policy policy-signed.json \\\n  --publickey policy-key.pub \\\n  -a build-attestation.json \\\n  --subject <artifact>\n```\n"}]}
{"messages": [{"role": "system", "content": "You are an expert in the Witness supply chain attestation framework. You help users instrument CI/CD pipelines with witness, create policy documents, and write Rego policies to validate attestations. You understand all attestors in go-witness and how to use them effectively."}, {"role": "user", "content": "How do I create a witness policy for a build step that uses these attestors: product, commandrun?"}, {"role": "assistant", "content": "Here's a complete witness policy for your build step with product, commandrun attestors:\n\n**Policy Document:**\n```json\n{\n  \"expires\": \"2026-11-08T10:52:59Z\",\n  \"publickeys\": {\n    \"build-key\": {\n      \"keyid\": \"sha256:1e2bdbfdd18c2f4c5a45475e20ee1a5f0912a2819f814258ed9f84c0b9845ccd\",\n      \"key\": \"-----BEGIN PUBLIC KEY-----\\n...\\n-----END PUBLIC KEY-----\"\n    }\n  },\n  \"steps\": {\n    \"build\": {\n      \"name\": \"build\",\n      \"attestations\": [\n        {\n          \"type\": \"https://witness.dev/attestations/product/v0.1\"\n        },\n        {\n          \"type\": \"https://witness.dev/attestations/command-run/v0.1\"\n        }\n      ],\n      \"functionaries\": [\n        {\n          \"type\": \"publickey\",\n          \"publickeyid\": \"build-key\"\n        }\n      ]\n    }\n  }\n}\n```\n\n**Witness Run Command:**\n```bash\nwitness run --step build \\\n  --attestations product,commandrun \\\n  --outfile build-attestation.json \\\n  --key signing-key.pem \\\n  -- <your-build-command>\n```\n\n**Rego Validation Rules:**\n```rego\n\n```\n\n**Verification:**\n```bash\nwitness verify \\\n  --policy policy-signed.json \\\n  --publickey policy-key.pub \\\n  -a build-attestation.json \\\n  --subject <artifact>\n```\n"}]}
{"messages": [{"role": "system", "content": "You are an expert in the Witness supply chain attestation framework. You help users instrument CI/CD pipelines with witness, create policy documents, and write Rego policies to validate attestations. You understand all attestors in go-witness and how to use them effectively."}, {"role": "user", "content": "How do I create a multi-step witness policy for a build \u2192 test \u2192 package pipeline?"}, {"role": "assistant", "content": "Here's a complete multi-step witness policy for your pipeline:\n\n**Policy Document:**\n```json\n{\n  \"expires\": \"2026-11-08T10:52:59Z\",\n  \"publickeys\": {\n    \"ci-key\": {\n      \"keyid\": \"sha256:eccec2e190d518809f374b884fc27f2e2fa32442924428682bd4a9b29cd57d73\",\n      \"key\": \"-----BEGIN PUBLIC KEY-----\\n...\\n-----END PUBLIC KEY-----\"\n    }\n  },\n  \"steps\": {\n    \"build\": {\n      \"name\": \"build\",\n      \"attestations\": [\n        {\n          \"type\": \"https://witness.dev/attestations/git/v0.1\"\n        },\n        {\n          \"type\": \"https://witness.dev/attestations/command-run/v0.1\"\n        },\n        {\n          \"type\": \"https://witness.dev/attestations/product/v0.1\"\n        }\n      ],\n      \"functionaries\": [\n        {\n          \"type\": \"publickey\",\n          \"publickeyid\": \"ci-key\"\n        }\n      ]\n    },\n    \"test\": {\n      \"name\": \"test\",\n      \"attestations\": [\n        {\n          \"type\": \"https://witness.dev/attestations/material/v0.1\"\n        },\n        {\n          \"type\": \"https://witness.dev/attestations/command-run/v0.1\"\n        }\n      ],\n      \"functionaries\": [\n        {\n          \"type\": \"publickey\",\n          \"publickeyid\": \"ci-key\"\n        }\n      ]\n    },\n    \"package\": {\n      \"name\": \"package\",\n      \"attestations\": [\n        {\n          \"type\": \"https://witness.dev/attestations/material/v0.1\"\n        },\n        {\n          \"type\": \"https://witness.dev/attestations/product/v0.1\"\n        }\n      ],\n      \"functionaries\": [\n        {\n          \"type\": \"publickey\",\n          \"publickeyid\": \"ci-key\"\n        }\n      ]\n    }\n  }\n}\n```\n\n**Pipeline Commands:**\n\n```bash\n# Step 1: Build\nwitness run --step build \\\n  --attestations git,commandrun,product \\\n  -o build.json --key ci-key.pem \\\n  -- go build -o myapp\n\n# Step 2: Test\nwitness run --step test \\\n  --attestations material,commandrun \\\n  -o test.json --key ci-key.pem \\\n  -- go test ./...\n\n# Step 3: Package\nwitness run --step package \\\n  --attestations material,product \\\n  -o package.json --key ci-key.pem \\\n  -- tar czf myapp.tar.gz myapp\n\n# Verify entire pipeline\nwitness verify \\\n  --policy policy-signed.json \\\n  --publickey policy-key.pub \\\n  -a build.json -a test.json -a package.json\n```\n"}]}
{"messages": [{"role": "system", "content": "You are an expert in the Witness supply chain attestation framework. You help users instrument CI/CD pipelines with witness, create policy documents, and write Rego policies to validate attestations. You understand all attestors in go-witness and how to use them effectively."}, {"role": "user", "content": "How do I create a multi-step witness policy for a build \u2192 test \u2192 package pipeline?"}, {"role": "assistant", "content": "Here's a complete multi-step witness policy for your pipeline:\n\n**Policy Document:**\n```json\n{\n  \"expires\": \"2026-11-08T10:52:59Z\",\n  \"publickeys\": {\n    \"ci-key\": {\n      \"keyid\": \"sha256:0e1cb71855a4ba2df68d62279c48ad057ab1a5e9a3ffd742c346143e333393cf\",\n      \"key\": \"-----BEGIN PUBLIC KEY-----\\n...\\n-----END PUBLIC KEY-----\"\n    }\n  },\n  \"steps\": {\n    \"build\": {\n      \"name\": \"build\",\n      \"attestations\": [\n        {\n          \"type\": \"https://witness.dev/attestations/git/v0.1\"\n        },\n        {\n          \"type\": \"https://witness.dev/attestations/command-run/v0.1\"\n        },\n        {\n          \"type\": \"https://witness.dev/attestations/product/v0.1\"\n        }\n      ],\n      \"functionaries\": [\n        {\n          \"type\": \"publickey\",\n          \"publickeyid\": \"ci-key\"\n        }\n      ]\n    },\n    \"test\": {\n      \"name\": \"test\",\n      \"attestations\": [\n        {\n          \"type\": \"https://witness.dev/attestations/material/v0.1\"\n        },\n        {\n          \"type\": \"https://witness.dev/attestations/command-run/v0.1\"\n        }\n      ],\n      \"functionaries\": [\n        {\n          \"type\": \"publickey\",\n          \"publickeyid\": \"ci-key\"\n        }\n      ]\n    },\n    \"package\": {\n      \"name\": \"package\",\n      \"attestations\": [\n        {\n          \"type\": \"https://witness.dev/attestations/material/v0.1\"\n        },\n        {\n          \"type\": \"https://witness.dev/attestations/product/v0.1\"\n        }\n      ],\n      \"functionaries\": [\n        {\n          \"type\": \"publickey\",\n          \"publickeyid\": \"ci-key\"\n        }\n      ]\n    }\n  }\n}\n```\n\n**Pipeline Commands:**\n\n```bash\n# Step 1: Build\nwitness run --step build \\\n  --attestations git,commandrun,product \\\n  -o build.json --key ci-key.pem \\\n  -- go build -o myapp\n\n# Step 2: Test\nwitness run --step test \\\n  --attestations material,commandrun \\\n  -o test.json --key ci-key.pem \\\n  -- go test ./...\n\n# Step 3: Package\nwitness run --step package \\\n  --attestations material,product \\\n  -o package.json --key ci-key.pem \\\n  -- tar czf myapp.tar.gz myapp\n\n# Verify entire pipeline\nwitness verify \\\n  --policy policy-signed.json \\\n  --publickey policy-key.pub \\\n  -a build.json -a test.json -a package.json\n```\n"}]}
{"messages": [{"role": "system", "content": "You are an expert in the Witness supply chain attestation framework. You help users instrument CI/CD pipelines with witness, create policy documents, and write Rego policies to validate attestations. You understand all attestors in go-witness and how to use them effectively."}, {"role": "user", "content": "How do I create a witness policy for a build step that uses these attestors: github, environment, material, product?"}, {"role": "assistant", "content": "Here's a complete witness policy for your build step with github, environment, material, product attestors:\n\n**Policy Document:**\n```json\n{\n  \"expires\": \"2026-11-08T10:52:59Z\",\n  \"publickeys\": {\n    \"build-key\": {\n      \"keyid\": \"sha256:27e0809947ade3e5a664f32fb922730f9c8c8783ffff44e7f75ab616e52cff82\",\n      \"key\": \"-----BEGIN PUBLIC KEY-----\\n...\\n-----END PUBLIC KEY-----\"\n    }\n  },\n  \"steps\": {\n    \"build\": {\n      \"name\": \"build\",\n      \"attestations\": [\n        {\n          \"type\": \"https://witness.dev/attestations/github/v0.1\"\n        },\n        {\n          \"type\": \"https://witness.dev/attestations/environment/v0.1\"\n        },\n        {\n          \"type\": \"https://witness.dev/attestations/material/v0.1\"\n        },\n        {\n          \"type\": \"https://witness.dev/attestations/product/v0.1\"\n        }\n      ],\n      \"functionaries\": [\n        {\n          \"type\": \"publickey\",\n          \"publickeyid\": \"build-key\"\n        }\n      ]\n    }\n  }\n}\n```\n\n**Witness Run Command:**\n```bash\nwitness run --step build \\\n  --attestations github,environment,material,product \\\n  --outfile build-attestation.json \\\n  --key signing-key.pem \\\n  -- <your-build-command>\n```\n\n**Rego Validation Rules:**\n```rego\n\n```\n\n**Verification:**\n```bash\nwitness verify \\\n  --policy policy-signed.json \\\n  --publickey policy-key.pub \\\n  -a build-attestation.json \\\n  --subject <artifact>\n```\n"}]}
{"messages": [{"role": "system", "content": "You are an expert in the Witness supply chain attestation framework. You help users instrument CI/CD pipelines with witness, create policy documents, and write Rego policies to validate attestations. You understand all attestors in go-witness and how to use them effectively."}, {"role": "user", "content": "How do I create a multi-step witness policy for a build \u2192 test \u2192 package pipeline?"}, {"role": "assistant", "content": "Here's a complete multi-step witness policy for your pipeline:\n\n**Policy Document:**\n```json\n{\n  \"expires\": \"2026-11-08T10:52:59Z\",\n  \"publickeys\": {\n    \"ci-key\": {\n      \"keyid\": \"sha256:8a9740861f06a958ec502db773822ec42ec11dfc0a3c4408577dfdd6284f30fd\",\n      \"key\": \"-----BEGIN PUBLIC KEY-----\\n...\\n-----END PUBLIC KEY-----\"\n    }\n  },\n  \"steps\": {\n    \"build\": {\n      \"name\": \"build\",\n      \"attestations\": [\n        {\n          \"type\": \"https://witness.dev/attestations/git/v0.1\"\n        },\n        {\n          \"type\": \"https://witness.dev/attestations/command-run/v0.1\"\n        },\n        {\n          \"type\": \"https://witness.dev/attestations/product/v0.1\"\n        }\n      ],\n      \"functionaries\": [\n        {\n          \"type\": \"publickey\",\n          \"publickeyid\": \"ci-key\"\n        }\n      ]\n    },\n    \"test\": {\n      \"name\": \"test\",\n      \"attestations\": [\n        {\n          \"type\": \"https://witness.dev/attestations/material/v0.1\"\n        },\n        {\n          \"type\": \"https://witness.dev/attestations/command-run/v0.1\"\n        }\n      ],\n      \"functionaries\": [\n        {\n          \"type\": \"publickey\",\n          \"publickeyid\": \"ci-key\"\n        }\n      ]\n    },\n    \"package\": {\n      \"name\": \"package\",\n      \"attestations\": [\n        {\n          \"type\": \"https://witness.dev/attestations/material/v0.1\"\n        },\n        {\n          \"type\": \"https://witness.dev/attestations/product/v0.1\"\n        }\n      ],\n      \"functionaries\": [\n        {\n          \"type\": \"publickey\",\n          \"publickeyid\": \"ci-key\"\n        }\n      ]\n    }\n  }\n}\n```\n\n**Pipeline Commands:**\n\n```bash\n# Step 1: Build\nwitness run --step build \\\n  --attestations git,commandrun,product \\\n  -o build.json --key ci-key.pem \\\n  -- go build -o myapp\n\n# Step 2: Test\nwitness run --step test \\\n  --attestations material,commandrun \\\n  -o test.json --key ci-key.pem \\\n  -- go test ./...\n\n# Step 3: Package\nwitness run --step package \\\n  --attestations material,product \\\n  -o package.json --key ci-key.pem \\\n  -- tar czf myapp.tar.gz myapp\n\n# Verify entire pipeline\nwitness verify \\\n  --policy policy-signed.json \\\n  --publickey policy-key.pub \\\n  -a build.json -a test.json -a package.json\n```\n"}]}
{"messages": [{"role": "system", "content": "You are an expert in the Witness supply chain attestation framework. You help users instrument CI/CD pipelines with witness, create policy documents, and write Rego policies to validate attestations. You understand all attestors in go-witness and how to use them effectively."}, {"role": "user", "content": "How do I create a multi-step witness policy for a build \u2192 test \u2192 package pipeline?"}, {"role": "assistant", "content": "Here's a complete multi-step witness policy for your pipeline:\n\n**Policy Document:**\n```json\n{\n  \"expires\": \"2026-11-08T10:52:59Z\",\n  \"publickeys\": {\n    \"ci-key\": {\n      \"keyid\": \"sha256:85dd2e343cf262f583dc00af837a521242a1dd2659e8e78575344fe3f91a913b\",\n      \"key\": \"-----BEGIN PUBLIC KEY-----\\n...\\n-----END PUBLIC KEY-----\"\n    }\n  },\n  \"steps\": {\n    \"build\": {\n      \"name\": \"build\",\n      \"attestations\": [\n        {\n          \"type\": \"https://witness.dev/attestations/git/v0.1\"\n        },\n        {\n          \"type\": \"https://witness.dev/attestations/command-run/v0.1\"\n        },\n        {\n          \"type\": \"https://witness.dev/attestations/product/v0.1\"\n        }\n      ],\n      \"functionaries\": [\n        {\n          \"type\": \"publickey\",\n          \"publickeyid\": \"ci-key\"\n        }\n      ]\n    },\n    \"test\": {\n      \"name\": \"test\",\n      \"attestations\": [\n        {\n          \"type\": \"https://witness.dev/attestations/material/v0.1\"\n        },\n        {\n          \"type\": \"https://witness.dev/attestations/command-run/v0.1\"\n        }\n      ],\n      \"functionaries\": [\n        {\n          \"type\": \"publickey\",\n          \"publickeyid\": \"ci-key\"\n        }\n      ]\n    },\n    \"package\": {\n      \"name\": \"package\",\n      \"attestations\": [\n        {\n          \"type\": \"https://witness.dev/attestations/material/v0.1\"\n        },\n        {\n          \"type\": \"https://witness.dev/attestations/product/v0.1\"\n        }\n      ],\n      \"functionaries\": [\n        {\n          \"type\": \"publickey\",\n          \"publickeyid\": \"ci-key\"\n        }\n      ]\n    }\n  }\n}\n```\n\n**Pipeline Commands:**\n\n```bash\n# Step 1: Build\nwitness run --step build \\\n  --attestations git,commandrun,product \\\n  -o build.json --key ci-key.pem \\\n  -- go build -o myapp\n\n# Step 2: Test\nwitness run --step test \\\n  --attestations material,commandrun \\\n  -o test.json --key ci-key.pem \\\n  -- go test ./...\n\n# Step 3: Package\nwitness run --step package \\\n  --attestations material,product \\\n  -o package.json --key ci-key.pem \\\n  -- tar czf myapp.tar.gz myapp\n\n# Verify entire pipeline\nwitness verify \\\n  --policy policy-signed.json \\\n  --publickey policy-key.pub \\\n  -a build.json -a test.json -a package.json\n```\n"}]}
{"messages": [{"role": "system", "content": "You are an expert in the Witness supply chain attestation framework. You help users instrument CI/CD pipelines with witness, create policy documents, and write Rego policies to validate attestations. You understand all attestors in go-witness and how to use them effectively."}, {"role": "user", "content": "How do I create a witness policy for a build step that uses these attestors: github, commandrun, material, environment?"}, {"role": "assistant", "content": "Here's a complete witness policy for your build step with github, commandrun, material, environment attestors:\n\n**Policy Document:**\n```json\n{\n  \"expires\": \"2026-11-08T10:52:59Z\",\n  \"publickeys\": {\n    \"build-key\": {\n      \"keyid\": \"sha256:a9989496f0002321188f79c65db481f12771234bc4a35cd08d463be24c81d99d\",\n      \"key\": \"-----BEGIN PUBLIC KEY-----\\n...\\n-----END PUBLIC KEY-----\"\n    }\n  },\n  \"steps\": {\n    \"build\": {\n      \"name\": \"build\",\n      \"attestations\": [\n        {\n          \"type\": \"https://witness.dev/attestations/github/v0.1\"\n        },\n        {\n          \"type\": \"https://witness.dev/attestations/command-run/v0.1\"\n        },\n        {\n          \"type\": \"https://witness.dev/attestations/material/v0.1\"\n        },\n        {\n          \"type\": \"https://witness.dev/attestations/environment/v0.1\"\n        }\n      ],\n      \"functionaries\": [\n        {\n          \"type\": \"publickey\",\n          \"publickeyid\": \"build-key\"\n        }\n      ]\n    }\n  }\n}\n```\n\n**Witness Run Command:**\n```bash\nwitness run --step build \\\n  --attestations github,commandrun,material,environment \\\n  --outfile build-attestation.json \\\n  --key signing-key.pem \\\n  -- <your-build-command>\n```\n\n**Rego Validation Rules:**\n```rego\n\n```\n\n**Verification:**\n```bash\nwitness verify \\\n  --policy policy-signed.json \\\n  --publickey policy-key.pub \\\n  -a build-attestation.json \\\n  --subject <artifact>\n```\n"}]}
{"messages": [{"role": "system", "content": "You are an expert in the Witness supply chain attestation framework. You help users instrument CI/CD pipelines with witness, create policy documents, and write Rego policies to validate attestations. You understand all attestors in go-witness and how to use them effectively."}, {"role": "user", "content": "How do I create a witness policy for a build step that uses these attestors: commandrun, environment, product, git, material?"}, {"role": "assistant", "content": "Here's a complete witness policy for your build step with commandrun, environment, product, git, material attestors:\n\n**Policy Document:**\n```json\n{\n  \"expires\": \"2026-11-08T10:52:59Z\",\n  \"publickeys\": {\n    \"build-key\": {\n      \"keyid\": \"sha256:6f77975f5893e1cd828dbfd65f5e9f6586a1dc16d2b078508f940c7c62071bcb\",\n      \"key\": \"-----BEGIN PUBLIC KEY-----\\n...\\n-----END PUBLIC KEY-----\"\n    }\n  },\n  \"steps\": {\n    \"build\": {\n      \"name\": \"build\",\n      \"attestations\": [\n        {\n          \"type\": \"https://witness.dev/attestations/command-run/v0.1\"\n        },\n        {\n          \"type\": \"https://witness.dev/attestations/environment/v0.1\"\n        },\n        {\n          \"type\": \"https://witness.dev/attestations/product/v0.1\"\n        },\n        {\n          \"type\": \"https://witness.dev/attestations/git/v0.1\"\n        },\n        {\n          \"type\": \"https://witness.dev/attestations/material/v0.1\"\n        }\n      ],\n      \"functionaries\": [\n        {\n          \"type\": \"publickey\",\n          \"publickeyid\": \"build-key\"\n        }\n      ]\n    }\n  }\n}\n```\n\n**Witness Run Command:**\n```bash\nwitness run --step build \\\n  --attestations commandrun,environment,product,git,material \\\n  --outfile build-attestation.json \\\n  --key signing-key.pem \\\n  -- <your-build-command>\n```\n\n**Rego Validation Rules:**\n```rego\n\n```\n\n**Verification:**\n```bash\nwitness verify \\\n  --policy policy-signed.json \\\n  --publickey policy-key.pub \\\n  -a build-attestation.json \\\n  --subject <artifact>\n```\n"}]}
{"messages": [{"role": "system", "content": "You are an expert in the Witness supply chain attestation framework. You help users instrument CI/CD pipelines with witness, create policy documents, and write Rego policies to validate attestations. You understand all attestors in go-witness and how to use them effectively."}, {"role": "user", "content": "How do I create a multi-step witness policy for a build \u2192 test \u2192 package pipeline?"}, {"role": "assistant", "content": "Here's a complete multi-step witness policy for your pipeline:\n\n**Policy Document:**\n```json\n{\n  \"expires\": \"2026-11-08T10:52:59Z\",\n  \"publickeys\": {\n    \"ci-key\": {\n      \"keyid\": \"sha256:15449f2201547d3568d5679c81686db8be9e14fdf1a613d55baa69ea7623cdf8\",\n      \"key\": \"-----BEGIN PUBLIC KEY-----\\n...\\n-----END PUBLIC KEY-----\"\n    }\n  },\n  \"steps\": {\n    \"build\": {\n      \"name\": \"build\",\n      \"attestations\": [\n        {\n          \"type\": \"https://witness.dev/attestations/git/v0.1\"\n        },\n        {\n          \"type\": \"https://witness.dev/attestations/command-run/v0.1\"\n        },\n        {\n          \"type\": \"https://witness.dev/attestations/product/v0.1\"\n        }\n      ],\n      \"functionaries\": [\n        {\n          \"type\": \"publickey\",\n          \"publickeyid\": \"ci-key\"\n        }\n      ]\n    },\n    \"test\": {\n      \"name\": \"test\",\n      \"attestations\": [\n        {\n          \"type\": \"https://witness.dev/attestations/material/v0.1\"\n        },\n        {\n          \"type\": \"https://witness.dev/attestations/command-run/v0.1\"\n        }\n      ],\n      \"functionaries\": [\n        {\n          \"type\": \"publickey\",\n          \"publickeyid\": \"ci-key\"\n        }\n      ]\n    },\n    \"package\": {\n      \"name\": \"package\",\n      \"attestations\": [\n        {\n          \"type\": \"https://witness.dev/attestations/material/v0.1\"\n        },\n        {\n          \"type\": \"https://witness.dev/attestations/product/v0.1\"\n        }\n      ],\n      \"functionaries\": [\n        {\n          \"type\": \"publickey\",\n          \"publickeyid\": \"ci-key\"\n        }\n      ]\n    }\n  }\n}\n```\n\n**Pipeline Commands:**\n\n```bash\n# Step 1: Build\nwitness run --step build \\\n  --attestations git,commandrun,product \\\n  -o build.json --key ci-key.pem \\\n  -- go build -o myapp\n\n# Step 2: Test\nwitness run --step test \\\n  --attestations material,commandrun \\\n  -o test.json --key ci-key.pem \\\n  -- go test ./...\n\n# Step 3: Package\nwitness run --step package \\\n  --attestations material,product \\\n  -o package.json --key ci-key.pem \\\n  -- tar czf myapp.tar.gz myapp\n\n# Verify entire pipeline\nwitness verify \\\n  --policy policy-signed.json \\\n  --publickey policy-key.pub \\\n  -a build.json -a test.json -a package.json\n```\n"}]}
{"messages": [{"role": "system", "content": "You are an expert in the Witness supply chain attestation framework. You help users instrument CI/CD pipelines with witness, create policy documents, and write Rego policies to validate attestations. You understand all attestors in go-witness and how to use them effectively."}, {"role": "user", "content": "How do I create a witness policy for a build step that uses these attestors: commandrun, environment, github?"}, {"role": "assistant", "content": "Here's a complete witness policy for your build step with commandrun, environment, github attestors:\n\n**Policy Document:**\n```json\n{\n  \"expires\": \"2026-11-08T10:52:59Z\",\n  \"publickeys\": {\n    \"build-key\": {\n      \"keyid\": \"sha256:c154a30b91b1bc75e608b73e80e5ba537e633db1ea984525db8c56ad18ad271b\",\n      \"key\": \"-----BEGIN PUBLIC KEY-----\\n...\\n-----END PUBLIC KEY-----\"\n    }\n  },\n  \"steps\": {\n    \"build\": {\n      \"name\": \"build\",\n      \"attestations\": [\n        {\n          \"type\": \"https://witness.dev/attestations/command-run/v0.1\"\n        },\n        {\n          \"type\": \"https://witness.dev/attestations/environment/v0.1\"\n        },\n        {\n          \"type\": \"https://witness.dev/attestations/github/v0.1\"\n        }\n      ],\n      \"functionaries\": [\n        {\n          \"type\": \"publickey\",\n          \"publickeyid\": \"build-key\"\n        }\n      ]\n    }\n  }\n}\n```\n\n**Witness Run Command:**\n```bash\nwitness run --step build \\\n  --attestations commandrun,environment,github \\\n  --outfile build-attestation.json \\\n  --key signing-key.pem \\\n  -- <your-build-command>\n```\n\n**Rego Validation Rules:**\n```rego\n\n```\n\n**Verification:**\n```bash\nwitness verify \\\n  --policy policy-signed.json \\\n  --publickey policy-key.pub \\\n  -a build-attestation.json \\\n  --subject <artifact>\n```\n"}]}
{"messages": [{"role": "system", "content": "You are an expert in the Witness supply chain attestation framework. You help users instrument CI/CD pipelines with witness, create policy documents, and write Rego policies to validate attestations. You understand all attestors in go-witness and how to use them effectively."}, {"role": "user", "content": "How do I create a witness policy for a build step that uses these attestors: github, git, product, material?"}, {"role": "assistant", "content": "Here's a complete witness policy for your build step with github, git, product, material attestors:\n\n**Policy Document:**\n```json\n{\n  \"expires\": \"2026-11-08T10:52:59Z\",\n  \"publickeys\": {\n    \"build-key\": {\n      \"keyid\": \"sha256:a60aab0f243d8c659836616973c90c6f43a824e60d1afdca6ed05345bb086410\",\n      \"key\": \"-----BEGIN PUBLIC KEY-----\\n...\\n-----END PUBLIC KEY-----\"\n    }\n  },\n  \"steps\": {\n    \"build\": {\n      \"name\": \"build\",\n      \"attestations\": [\n        {\n          \"type\": \"https://witness.dev/attestations/github/v0.1\"\n        },\n        {\n          \"type\": \"https://witness.dev/attestations/git/v0.1\"\n        },\n        {\n          \"type\": \"https://witness.dev/attestations/product/v0.1\"\n        },\n        {\n          \"type\": \"https://witness.dev/attestations/material/v0.1\"\n        }\n      ],\n      \"functionaries\": [\n        {\n          \"type\": \"publickey\",\n          \"publickeyid\": \"build-key\"\n        }\n      ]\n    }\n  }\n}\n```\n\n**Witness Run Command:**\n```bash\nwitness run --step build \\\n  --attestations github,git,product,material \\\n  --outfile build-attestation.json \\\n  --key signing-key.pem \\\n  -- <your-build-command>\n```\n\n**Rego Validation Rules:**\n```rego\n\n```\n\n**Verification:**\n```bash\nwitness verify \\\n  --policy policy-signed.json \\\n  --publickey policy-key.pub \\\n  -a build-attestation.json \\\n  --subject <artifact>\n```\n"}]}
{"messages": [{"role": "system", "content": "You are an expert in the Witness supply chain attestation framework. You help users instrument CI/CD pipelines with witness, create policy documents, and write Rego policies to validate attestations. You understand all attestors in go-witness and how to use them effectively."}, {"role": "user", "content": "How do I create a witness policy for a build step that uses these attestors: environment, git, github, product, commandrun?"}, {"role": "assistant", "content": "Here's a complete witness policy for your build step with environment, git, github, product, commandrun attestors:\n\n**Policy Document:**\n```json\n{\n  \"expires\": \"2026-11-08T10:52:59Z\",\n  \"publickeys\": {\n    \"build-key\": {\n      \"keyid\": \"sha256:f8ae222b26f2484e1bbbd1f2e82e2f97180d2bc2dd54a7da43db7b3198d7feeb\",\n      \"key\": \"-----BEGIN PUBLIC KEY-----\\n...\\n-----END PUBLIC KEY-----\"\n    }\n  },\n  \"steps\": {\n    \"build\": {\n      \"name\": \"build\",\n      \"attestations\": [\n        {\n          \"type\": \"https://witness.dev/attestations/environment/v0.1\"\n        },\n        {\n          \"type\": \"https://witness.dev/attestations/git/v0.1\"\n        },\n        {\n          \"type\": \"https://witness.dev/attestations/github/v0.1\"\n        },\n        {\n          \"type\": \"https://witness.dev/attestations/product/v0.1\"\n        },\n        {\n          \"type\": \"https://witness.dev/attestations/command-run/v0.1\"\n        }\n      ],\n      \"functionaries\": [\n        {\n          \"type\": \"publickey\",\n          \"publickeyid\": \"build-key\"\n        }\n      ]\n    }\n  }\n}\n```\n\n**Witness Run Command:**\n```bash\nwitness run --step build \\\n  --attestations environment,git,github,product,commandrun \\\n  --outfile build-attestation.json \\\n  --key signing-key.pem \\\n  -- <your-build-command>\n```\n\n**Rego Validation Rules:**\n```rego\npackage environment\n\nimport rego.v1\n\n# Ensure correct OS\ndeny contains msg if {\n    input.os != \"darwin\"\n    msg := sprintf(\"Must run on darwin, got: %s\", [input.os])\n}\n\n# Require CI environment\ndeny contains msg if {\n    not \"CI\" in input.variables\n    msg := \"Must run in CI environment (CI variable not set)\"\n}\n```\n\n**Verification:**\n```bash\nwitness verify \\\n  --policy policy-signed.json \\\n  --publickey policy-key.pub \\\n  -a build-attestation.json \\\n  --subject <artifact>\n```\n"}]}
{"messages": [{"role": "system", "content": "You are an expert in the Witness supply chain attestation framework. You help users instrument CI/CD pipelines with witness, create policy documents, and write Rego policies to validate attestations. You understand all attestors in go-witness and how to use them effectively."}, {"role": "user", "content": "How do I create a witness policy for a build step that uses these attestors: github?"}, {"role": "assistant", "content": "Here's a complete witness policy for your build step with github attestors:\n\n**Policy Document:**\n```json\n{\n  \"expires\": \"2026-11-08T10:52:59Z\",\n  \"publickeys\": {\n    \"build-key\": {\n      \"keyid\": \"sha256:d5534f24b28b6cb0f672c8e81add3f0418f243246ef9c5985ab9b45c8bdd21ae\",\n      \"key\": \"-----BEGIN PUBLIC KEY-----\\n...\\n-----END PUBLIC KEY-----\"\n    }\n  },\n  \"steps\": {\n    \"build\": {\n      \"name\": \"build\",\n      \"attestations\": [\n        {\n          \"type\": \"https://witness.dev/attestations/github/v0.1\"\n        }\n      ],\n      \"functionaries\": [\n        {\n          \"type\": \"publickey\",\n          \"publickeyid\": \"build-key\"\n        }\n      ]\n    }\n  }\n}\n```\n\n**Witness Run Command:**\n```bash\nwitness run --step build \\\n  --attestations github \\\n  --outfile build-attestation.json \\\n  --key signing-key.pem \\\n  -- <your-build-command>\n```\n\n**Rego Validation Rules:**\n```rego\n\n```\n\n**Verification:**\n```bash\nwitness verify \\\n  --policy policy-signed.json \\\n  --publickey policy-key.pub \\\n  -a build-attestation.json \\\n  --subject <artifact>\n```\n"}]}
{"messages": [{"role": "system", "content": "You are an expert in the Witness supply chain attestation framework. You help users instrument CI/CD pipelines with witness, create policy documents, and write Rego policies to validate attestations. You understand all attestors in go-witness and how to use them effectively."}, {"role": "user", "content": "How do I create a witness policy for a build step that uses these attestors: github, environment, commandrun, material?"}, {"role": "assistant", "content": "Here's a complete witness policy for your build step with github, environment, commandrun, material attestors:\n\n**Policy Document:**\n```json\n{\n  \"expires\": \"2026-11-08T10:52:59Z\",\n  \"publickeys\": {\n    \"build-key\": {\n      \"keyid\": \"sha256:91738e65b1a5debeab2bd61b155541ad129d88e856af624c943e6a5dd09b35e0\",\n      \"key\": \"-----BEGIN PUBLIC KEY-----\\n...\\n-----END PUBLIC KEY-----\"\n    }\n  },\n  \"steps\": {\n    \"build\": {\n      \"name\": \"build\",\n      \"attestations\": [\n        {\n          \"type\": \"https://witness.dev/attestations/github/v0.1\"\n        },\n        {\n          \"type\": \"https://witness.dev/attestations/environment/v0.1\"\n        },\n        {\n          \"type\": \"https://witness.dev/attestations/command-run/v0.1\"\n        },\n        {\n          \"type\": \"https://witness.dev/attestations/material/v0.1\"\n        }\n      ],\n      \"functionaries\": [\n        {\n          \"type\": \"publickey\",\n          \"publickeyid\": \"build-key\"\n        }\n      ]\n    }\n  }\n}\n```\n\n**Witness Run Command:**\n```bash\nwitness run --step build \\\n  --attestations github,environment,commandrun,material \\\n  --outfile build-attestation.json \\\n  --key signing-key.pem \\\n  -- <your-build-command>\n```\n\n**Rego Validation Rules:**\n```rego\n\n```\n\n**Verification:**\n```bash\nwitness verify \\\n  --policy policy-signed.json \\\n  --publickey policy-key.pub \\\n  -a build-attestation.json \\\n  --subject <artifact>\n```\n"}]}
{"messages": [{"role": "system", "content": "You are an expert in the Witness supply chain attestation framework. You help users instrument CI/CD pipelines with witness, create policy documents, and write Rego policies to validate attestations. You understand all attestors in go-witness and how to use them effectively."}, {"role": "user", "content": "How do I create a witness policy for a build step that uses these attestors: github, commandrun?"}, {"role": "assistant", "content": "Here's a complete witness policy for your build step with github, commandrun attestors:\n\n**Policy Document:**\n```json\n{\n  \"expires\": \"2026-11-08T10:52:59Z\",\n  \"publickeys\": {\n    \"build-key\": {\n      \"keyid\": \"sha256:3e294852c0d9f22da40f02dbf4275413aa8ef04e00fcd1848370efb24f15edb4\",\n      \"key\": \"-----BEGIN PUBLIC KEY-----\\n...\\n-----END PUBLIC KEY-----\"\n    }\n  },\n  \"steps\": {\n    \"build\": {\n      \"name\": \"build\",\n      \"attestations\": [\n        {\n          \"type\": \"https://witness.dev/attestations/github/v0.1\"\n        },\n        {\n          \"type\": \"https://witness.dev/attestations/command-run/v0.1\"\n        }\n      ],\n      \"functionaries\": [\n        {\n          \"type\": \"publickey\",\n          \"publickeyid\": \"build-key\"\n        }\n      ]\n    }\n  }\n}\n```\n\n**Witness Run Command:**\n```bash\nwitness run --step build \\\n  --attestations github,commandrun \\\n  --outfile build-attestation.json \\\n  --key signing-key.pem \\\n  -- <your-build-command>\n```\n\n**Rego Validation Rules:**\n```rego\n\n```\n\n**Verification:**\n```bash\nwitness verify \\\n  --policy policy-signed.json \\\n  --publickey policy-key.pub \\\n  -a build-attestation.json \\\n  --subject <artifact>\n```\n"}]}
{"messages": [{"role": "system", "content": "You are an expert in the Witness supply chain attestation framework. You help users instrument CI/CD pipelines with witness, create policy documents, and write Rego policies to validate attestations. You understand all attestors in go-witness and how to use them effectively."}, {"role": "user", "content": "How do I create a witness policy for a build step that uses these attestors: material, environment, github, product, git?"}, {"role": "assistant", "content": "Here's a complete witness policy for your build step with material, environment, github, product, git attestors:\n\n**Policy Document:**\n```json\n{\n  \"expires\": \"2026-11-08T10:52:59Z\",\n  \"publickeys\": {\n    \"build-key\": {\n      \"keyid\": \"sha256:d66b425696ba47a7e1d011ed4361e5e03e59f277c17f6cbb3ecfb70fdbb9e481\",\n      \"key\": \"-----BEGIN PUBLIC KEY-----\\n...\\n-----END PUBLIC KEY-----\"\n    }\n  },\n  \"steps\": {\n    \"build\": {\n      \"name\": \"build\",\n      \"attestations\": [\n        {\n          \"type\": \"https://witness.dev/attestations/material/v0.1\"\n        },\n        {\n          \"type\": \"https://witness.dev/attestations/environment/v0.1\"\n        },\n        {\n          \"type\": \"https://witness.dev/attestations/github/v0.1\"\n        },\n        {\n          \"type\": \"https://witness.dev/attestations/product/v0.1\"\n        },\n        {\n          \"type\": \"https://witness.dev/attestations/git/v0.1\"\n        }\n      ],\n      \"functionaries\": [\n        {\n          \"type\": \"publickey\",\n          \"publickeyid\": \"build-key\"\n        }\n      ]\n    }\n  }\n}\n```\n\n**Witness Run Command:**\n```bash\nwitness run --step build \\\n  --attestations material,environment,github,product,git \\\n  --outfile build-attestation.json \\\n  --key signing-key.pem \\\n  -- <your-build-command>\n```\n\n**Rego Validation Rules:**\n```rego\n\n```\n\n**Verification:**\n```bash\nwitness verify \\\n  --policy policy-signed.json \\\n  --publickey policy-key.pub \\\n  -a build-attestation.json \\\n  --subject <artifact>\n```\n"}]}
{"messages": [{"role": "system", "content": "You are an expert in the Witness supply chain attestation framework. You help users instrument CI/CD pipelines with witness, create policy documents, and write Rego policies to validate attestations. You understand all attestors in go-witness and how to use them effectively."}, {"role": "user", "content": "How do I create a witness policy for a build step that uses these attestors: github?"}, {"role": "assistant", "content": "Here's a complete witness policy for your build step with github attestors:\n\n**Policy Document:**\n```json\n{\n  \"expires\": \"2026-11-08T10:52:59Z\",\n  \"publickeys\": {\n    \"build-key\": {\n      \"keyid\": \"sha256:fe087e8a6913321633305be794498a45d52da06db5fbe2d4ef84a2defabc68d7\",\n      \"key\": \"-----BEGIN PUBLIC KEY-----\\n...\\n-----END PUBLIC KEY-----\"\n    }\n  },\n  \"steps\": {\n    \"build\": {\n      \"name\": \"build\",\n      \"attestations\": [\n        {\n          \"type\": \"https://witness.dev/attestations/github/v0.1\"\n        }\n      ],\n      \"functionaries\": [\n        {\n          \"type\": \"publickey\",\n          \"publickeyid\": \"build-key\"\n        }\n      ]\n    }\n  }\n}\n```\n\n**Witness Run Command:**\n```bash\nwitness run --step build \\\n  --attestations github \\\n  --outfile build-attestation.json \\\n  --key signing-key.pem \\\n  -- <your-build-command>\n```\n\n**Rego Validation Rules:**\n```rego\n\n```\n\n**Verification:**\n```bash\nwitness verify \\\n  --policy policy-signed.json \\\n  --publickey policy-key.pub \\\n  -a build-attestation.json \\\n  --subject <artifact>\n```\n"}]}
{"messages": [{"role": "system", "content": "You are an expert in the Witness supply chain attestation framework. You help users instrument CI/CD pipelines with witness, create policy documents, and write Rego policies to validate attestations. You understand all attestors in go-witness and how to use them effectively."}, {"role": "user", "content": "How do I create a multi-step witness policy for a build \u2192 test \u2192 package pipeline?"}, {"role": "assistant", "content": "Here's a complete multi-step witness policy for your pipeline:\n\n**Policy Document:**\n```json\n{\n  \"expires\": \"2026-11-08T10:52:59Z\",\n  \"publickeys\": {\n    \"ci-key\": {\n      \"keyid\": \"sha256:27063a8c5bb6cf1929fab05008a8c81ea23dc1fe6aa904399baafea83b4031cd\",\n      \"key\": \"-----BEGIN PUBLIC KEY-----\\n...\\n-----END PUBLIC KEY-----\"\n    }\n  },\n  \"steps\": {\n    \"build\": {\n      \"name\": \"build\",\n      \"attestations\": [\n        {\n          \"type\": \"https://witness.dev/attestations/git/v0.1\"\n        },\n        {\n          \"type\": \"https://witness.dev/attestations/command-run/v0.1\"\n        },\n        {\n          \"type\": \"https://witness.dev/attestations/product/v0.1\"\n        }\n      ],\n      \"functionaries\": [\n        {\n          \"type\": \"publickey\",\n          \"publickeyid\": \"ci-key\"\n        }\n      ]\n    },\n    \"test\": {\n      \"name\": \"test\",\n      \"attestations\": [\n        {\n          \"type\": \"https://witness.dev/attestations/material/v0.1\"\n        },\n        {\n          \"type\": \"https://witness.dev/attestations/command-run/v0.1\"\n        }\n      ],\n      \"functionaries\": [\n        {\n          \"type\": \"publickey\",\n          \"publickeyid\": \"ci-key\"\n        }\n      ]\n    },\n    \"package\": {\n      \"name\": \"package\",\n      \"attestations\": [\n        {\n          \"type\": \"https://witness.dev/attestations/material/v0.1\"\n        },\n        {\n          \"type\": \"https://witness.dev/attestations/product/v0.1\"\n        }\n      ],\n      \"functionaries\": [\n        {\n          \"type\": \"publickey\",\n          \"publickeyid\": \"ci-key\"\n        }\n      ]\n    }\n  }\n}\n```\n\n**Pipeline Commands:**\n\n```bash\n# Step 1: Build\nwitness run --step build \\\n  --attestations git,commandrun,product \\\n  -o build.json --key ci-key.pem \\\n  -- go build -o myapp\n\n# Step 2: Test\nwitness run --step test \\\n  --attestations material,commandrun \\\n  -o test.json --key ci-key.pem \\\n  -- go test ./...\n\n# Step 3: Package\nwitness run --step package \\\n  --attestations material,product \\\n  -o package.json --key ci-key.pem \\\n  -- tar czf myapp.tar.gz myapp\n\n# Verify entire pipeline\nwitness verify \\\n  --policy policy-signed.json \\\n  --publickey policy-key.pub \\\n  -a build.json -a test.json -a package.json\n```\n"}]}
{"messages": [{"role": "system", "content": "You are an expert in the Witness supply chain attestation framework. You help users instrument CI/CD pipelines with witness, create policy documents, and write Rego policies to validate attestations. You understand all attestors in go-witness and how to use them effectively."}, {"role": "user", "content": "How do I create a witness policy for a build step that uses these attestors: commandrun, environment, product, github?"}, {"role": "assistant", "content": "Here's a complete witness policy for your build step with commandrun, environment, product, github attestors:\n\n**Policy Document:**\n```json\n{\n  \"expires\": \"2026-11-08T10:52:59Z\",\n  \"publickeys\": {\n    \"build-key\": {\n      \"keyid\": \"sha256:51d9d6aade34c80f635afcf2fea761eaa985c3333fd4c84ebfe352640a67d759\",\n      \"key\": \"-----BEGIN PUBLIC KEY-----\\n...\\n-----END PUBLIC KEY-----\"\n    }\n  },\n  \"steps\": {\n    \"build\": {\n      \"name\": \"build\",\n      \"attestations\": [\n        {\n          \"type\": \"https://witness.dev/attestations/command-run/v0.1\"\n        },\n        {\n          \"type\": \"https://witness.dev/attestations/environment/v0.1\"\n        },\n        {\n          \"type\": \"https://witness.dev/attestations/product/v0.1\"\n        },\n        {\n          \"type\": \"https://witness.dev/attestations/github/v0.1\"\n        }\n      ],\n      \"functionaries\": [\n        {\n          \"type\": \"publickey\",\n          \"publickeyid\": \"build-key\"\n        }\n      ]\n    }\n  }\n}\n```\n\n**Witness Run Command:**\n```bash\nwitness run --step build \\\n  --attestations commandrun,environment,product,github \\\n  --outfile build-attestation.json \\\n  --key signing-key.pem \\\n  -- <your-build-command>\n```\n\n**Rego Validation Rules:**\n```rego\n\n```\n\n**Verification:**\n```bash\nwitness verify \\\n  --policy policy-signed.json \\\n  --publickey policy-key.pub \\\n  -a build-attestation.json \\\n  --subject <artifact>\n```\n"}]}
{"messages": [{"role": "system", "content": "You are an expert in the Witness supply chain attestation framework. You help users instrument CI/CD pipelines with witness, create policy documents, and write Rego policies to validate attestations. You understand all attestors in go-witness and how to use them effectively."}, {"role": "user", "content": "How do I create a multi-step witness policy for a build \u2192 test \u2192 package pipeline?"}, {"role": "assistant", "content": "Here's a complete multi-step witness policy for your pipeline:\n\n**Policy Document:**\n```json\n{\n  \"expires\": \"2026-11-08T10:52:59Z\",\n  \"publickeys\": {\n    \"ci-key\": {\n      \"keyid\": \"sha256:042d0e21e11d81ce85440d177facaf20d83c2a2b77aad2ba0cd1024cf6d20cb1\",\n      \"key\": \"-----BEGIN PUBLIC KEY-----\\n...\\n-----END PUBLIC KEY-----\"\n    }\n  },\n  \"steps\": {\n    \"build\": {\n      \"name\": \"build\",\n      \"attestations\": [\n        {\n          \"type\": \"https://witness.dev/attestations/git/v0.1\"\n        },\n        {\n          \"type\": \"https://witness.dev/attestations/command-run/v0.1\"\n        },\n        {\n          \"type\": \"https://witness.dev/attestations/product/v0.1\"\n        }\n      ],\n      \"functionaries\": [\n        {\n          \"type\": \"publickey\",\n          \"publickeyid\": \"ci-key\"\n        }\n      ]\n    },\n    \"test\": {\n      \"name\": \"test\",\n      \"attestations\": [\n        {\n          \"type\": \"https://witness.dev/attestations/material/v0.1\"\n        },\n        {\n          \"type\": \"https://witness.dev/attestations/command-run/v0.1\"\n        }\n      ],\n      \"functionaries\": [\n        {\n          \"type\": \"publickey\",\n          \"publickeyid\": \"ci-key\"\n        }\n      ]\n    },\n    \"package\": {\n      \"name\": \"package\",\n      \"attestations\": [\n        {\n          \"type\": \"https://witness.dev/attestations/material/v0.1\"\n        },\n        {\n          \"type\": \"https://witness.dev/attestations/product/v0.1\"\n        }\n      ],\n      \"functionaries\": [\n        {\n          \"type\": \"publickey\",\n          \"publickeyid\": \"ci-key\"\n        }\n      ]\n    }\n  }\n}\n```\n\n**Pipeline Commands:**\n\n```bash\n# Step 1: Build\nwitness run --step build \\\n  --attestations git,commandrun,product \\\n  -o build.json --key ci-key.pem \\\n  -- go build -o myapp\n\n# Step 2: Test\nwitness run --step test \\\n  --attestations material,commandrun \\\n  -o test.json --key ci-key.pem \\\n  -- go test ./...\n\n# Step 3: Package\nwitness run --step package \\\n  --attestations material,product \\\n  -o package.json --key ci-key.pem \\\n  -- tar czf myapp.tar.gz myapp\n\n# Verify entire pipeline\nwitness verify \\\n  --policy policy-signed.json \\\n  --publickey policy-key.pub \\\n  -a build.json -a test.json -a package.json\n```\n"}]}
{"messages": [{"role": "system", "content": "You are an expert in the Witness supply chain attestation framework. You help users instrument CI/CD pipelines with witness, create policy documents, and write Rego policies to validate attestations. You understand all attestors in go-witness and how to use them effectively."}, {"role": "user", "content": "How do I create a multi-step witness policy for a build \u2192 test \u2192 package pipeline?"}, {"role": "assistant", "content": "Here's a complete multi-step witness policy for your pipeline:\n\n**Policy Document:**\n```json\n{\n  \"expires\": \"2026-11-08T10:52:59Z\",\n  \"publickeys\": {\n    \"ci-key\": {\n      \"keyid\": \"sha256:751ce2f55c9c36a561f497b26d23b104c4bf54b81543c1ec100a65d6b16cd737\",\n      \"key\": \"-----BEGIN PUBLIC KEY-----\\n...\\n-----END PUBLIC KEY-----\"\n    }\n  },\n  \"steps\": {\n    \"build\": {\n      \"name\": \"build\",\n      \"attestations\": [\n        {\n          \"type\": \"https://witness.dev/attestations/git/v0.1\"\n        },\n        {\n          \"type\": \"https://witness.dev/attestations/command-run/v0.1\"\n        },\n        {\n          \"type\": \"https://witness.dev/attestations/product/v0.1\"\n        }\n      ],\n      \"functionaries\": [\n        {\n          \"type\": \"publickey\",\n          \"publickeyid\": \"ci-key\"\n        }\n      ]\n    },\n    \"test\": {\n      \"name\": \"test\",\n      \"attestations\": [\n        {\n          \"type\": \"https://witness.dev/attestations/material/v0.1\"\n        },\n        {\n          \"type\": \"https://witness.dev/attestations/command-run/v0.1\"\n        }\n      ],\n      \"functionaries\": [\n        {\n          \"type\": \"publickey\",\n          \"publickeyid\": \"ci-key\"\n        }\n      ]\n    },\n    \"package\": {\n      \"name\": \"package\",\n      \"attestations\": [\n        {\n          \"type\": \"https://witness.dev/attestations/material/v0.1\"\n        },\n        {\n          \"type\": \"https://witness.dev/attestations/product/v0.1\"\n        }\n      ],\n      \"functionaries\": [\n        {\n          \"type\": \"publickey\",\n          \"publickeyid\": \"ci-key\"\n        }\n      ]\n    }\n  }\n}\n```\n\n**Pipeline Commands:**\n\n```bash\n# Step 1: Build\nwitness run --step build \\\n  --attestations git,commandrun,product \\\n  -o build.json --key ci-key.pem \\\n  -- go build -o myapp\n\n# Step 2: Test\nwitness run --step test \\\n  --attestations material,commandrun \\\n  -o test.json --key ci-key.pem \\\n  -- go test ./...\n\n# Step 3: Package\nwitness run --step package \\\n  --attestations material,product \\\n  -o package.json --key ci-key.pem \\\n  -- tar czf myapp.tar.gz myapp\n\n# Verify entire pipeline\nwitness verify \\\n  --policy policy-signed.json \\\n  --publickey policy-key.pub \\\n  -a build.json -a test.json -a package.json\n```\n"}]}
{"messages": [{"role": "system", "content": "You are an expert in the Witness supply chain attestation framework. You help users instrument CI/CD pipelines with witness, create policy documents, and write Rego policies to validate attestations. You understand all attestors in go-witness and how to use them effectively."}, {"role": "user", "content": "How do I create a witness policy for a build step that uses these attestors: commandrun?"}, {"role": "assistant", "content": "Here's a complete witness policy for your build step with commandrun attestors:\n\n**Policy Document:**\n```json\n{\n  \"expires\": \"2026-11-08T10:52:59Z\",\n  \"publickeys\": {\n    \"build-key\": {\n      \"keyid\": \"sha256:9053f8c760b9b9541e0b743b72b5a32b084646eddb39a336032172e87638c7ee\",\n      \"key\": \"-----BEGIN PUBLIC KEY-----\\n...\\n-----END PUBLIC KEY-----\"\n    }\n  },\n  \"steps\": {\n    \"build\": {\n      \"name\": \"build\",\n      \"attestations\": [\n        {\n          \"type\": \"https://witness.dev/attestations/command-run/v0.1\"\n        }\n      ],\n      \"functionaries\": [\n        {\n          \"type\": \"publickey\",\n          \"publickeyid\": \"build-key\"\n        }\n      ]\n    }\n  }\n}\n```\n\n**Witness Run Command:**\n```bash\nwitness run --step build \\\n  --attestations commandrun \\\n  --outfile build-attestation.json \\\n  --key signing-key.pem \\\n  -- <your-build-command>\n```\n\n**Rego Validation Rules:**\n```rego\n\n```\n\n**Verification:**\n```bash\nwitness verify \\\n  --policy policy-signed.json \\\n  --publickey policy-key.pub \\\n  -a build-attestation.json \\\n  --subject <artifact>\n```\n"}]}
{"messages": [{"role": "system", "content": "You are an expert in the Witness supply chain attestation framework. You help users instrument CI/CD pipelines with witness, create policy documents, and write Rego policies to validate attestations. You understand all attestors in go-witness and how to use them effectively."}, {"role": "user", "content": "How do I create a witness policy for a build step that uses these attestors: github, environment?"}, {"role": "assistant", "content": "Here's a complete witness policy for your build step with github, environment attestors:\n\n**Policy Document:**\n```json\n{\n  \"expires\": \"2026-11-08T10:52:59Z\",\n  \"publickeys\": {\n    \"build-key\": {\n      \"keyid\": \"sha256:ad9faef398416603c92153fbf0d8b26fcc0370af754f99fe02744a58ea02c495\",\n      \"key\": \"-----BEGIN PUBLIC KEY-----\\n...\\n-----END PUBLIC KEY-----\"\n    }\n  },\n  \"steps\": {\n    \"build\": {\n      \"name\": \"build\",\n      \"attestations\": [\n        {\n          \"type\": \"https://witness.dev/attestations/github/v0.1\"\n        },\n        {\n          \"type\": \"https://witness.dev/attestations/environment/v0.1\"\n        }\n      ],\n      \"functionaries\": [\n        {\n          \"type\": \"publickey\",\n          \"publickeyid\": \"build-key\"\n        }\n      ]\n    }\n  }\n}\n```\n\n**Witness Run Command:**\n```bash\nwitness run --step build \\\n  --attestations github,environment \\\n  --outfile build-attestation.json \\\n  --key signing-key.pem \\\n  -- <your-build-command>\n```\n\n**Rego Validation Rules:**\n```rego\n\n```\n\n**Verification:**\n```bash\nwitness verify \\\n  --policy policy-signed.json \\\n  --publickey policy-key.pub \\\n  -a build-attestation.json \\\n  --subject <artifact>\n```\n"}]}
{"messages": [{"role": "system", "content": "You are an expert in the Witness supply chain attestation framework. You help users instrument CI/CD pipelines with witness, create policy documents, and write Rego policies to validate attestations. You understand all attestors in go-witness and how to use them effectively."}, {"role": "user", "content": "How do I create a multi-step witness policy for a build \u2192 test \u2192 package pipeline?"}, {"role": "assistant", "content": "Here's a complete multi-step witness policy for your pipeline:\n\n**Policy Document:**\n```json\n{\n  \"expires\": \"2026-11-08T10:52:59Z\",\n  \"publickeys\": {\n    \"ci-key\": {\n      \"keyid\": \"sha256:4355dcd446b60e7bb11b8333bcb632f9532df29fc0d9ad689cd6be95f5b700ae\",\n      \"key\": \"-----BEGIN PUBLIC KEY-----\\n...\\n-----END PUBLIC KEY-----\"\n    }\n  },\n  \"steps\": {\n    \"build\": {\n      \"name\": \"build\",\n      \"attestations\": [\n        {\n          \"type\": \"https://witness.dev/attestations/git/v0.1\"\n        },\n        {\n          \"type\": \"https://witness.dev/attestations/command-run/v0.1\"\n        },\n        {\n          \"type\": \"https://witness.dev/attestations/product/v0.1\"\n        }\n      ],\n      \"functionaries\": [\n        {\n          \"type\": \"publickey\",\n          \"publickeyid\": \"ci-key\"\n        }\n      ]\n    },\n    \"test\": {\n      \"name\": \"test\",\n      \"attestations\": [\n        {\n          \"type\": \"https://witness.dev/attestations/material/v0.1\"\n        },\n        {\n          \"type\": \"https://witness.dev/attestations/command-run/v0.1\"\n        }\n      ],\n      \"functionaries\": [\n        {\n          \"type\": \"publickey\",\n          \"publickeyid\": \"ci-key\"\n        }\n      ]\n    },\n    \"package\": {\n      \"name\": \"package\",\n      \"attestations\": [\n        {\n          \"type\": \"https://witness.dev/attestations/material/v0.1\"\n        },\n        {\n          \"type\": \"https://witness.dev/attestations/product/v0.1\"\n        }\n      ],\n      \"functionaries\": [\n        {\n          \"type\": \"publickey\",\n          \"publickeyid\": \"ci-key\"\n        }\n      ]\n    }\n  }\n}\n```\n\n**Pipeline Commands:**\n\n```bash\n# Step 1: Build\nwitness run --step build \\\n  --attestations git,commandrun,product \\\n  -o build.json --key ci-key.pem \\\n  -- go build -o myapp\n\n# Step 2: Test\nwitness run --step test \\\n  --attestations material,commandrun \\\n  -o test.json --key ci-key.pem \\\n  -- go test ./...\n\n# Step 3: Package\nwitness run --step package \\\n  --attestations material,product \\\n  -o package.json --key ci-key.pem \\\n  -- tar czf myapp.tar.gz myapp\n\n# Verify entire pipeline\nwitness verify \\\n  --policy policy-signed.json \\\n  --publickey policy-key.pub \\\n  -a build.json -a test.json -a package.json\n```\n"}]}
{"messages": [{"role": "system", "content": "You are an expert in the Witness supply chain attestation framework. You help users instrument CI/CD pipelines with witness, create policy documents, and write Rego policies to validate attestations. You understand all attestors in go-witness and how to use them effectively."}, {"role": "user", "content": "How do I create a witness policy for a build step that uses these attestors: git, material, environment, product?"}, {"role": "assistant", "content": "Here's a complete witness policy for your build step with git, material, environment, product attestors:\n\n**Policy Document:**\n```json\n{\n  \"expires\": \"2026-11-08T10:52:59Z\",\n  \"publickeys\": {\n    \"build-key\": {\n      \"keyid\": \"sha256:0ba5fe43c6a7d26c2fb86ee32292f6d30dc36817232edd01b1c740c407185189\",\n      \"key\": \"-----BEGIN PUBLIC KEY-----\\n...\\n-----END PUBLIC KEY-----\"\n    }\n  },\n  \"steps\": {\n    \"build\": {\n      \"name\": \"build\",\n      \"attestations\": [\n        {\n          \"type\": \"https://witness.dev/attestations/git/v0.1\"\n        },\n        {\n          \"type\": \"https://witness.dev/attestations/material/v0.1\"\n        },\n        {\n          \"type\": \"https://witness.dev/attestations/environment/v0.1\"\n        },\n        {\n          \"type\": \"https://witness.dev/attestations/product/v0.1\"\n        }\n      ],\n      \"functionaries\": [\n        {\n          \"type\": \"publickey\",\n          \"publickeyid\": \"build-key\"\n        }\n      ]\n    }\n  }\n}\n```\n\n**Witness Run Command:**\n```bash\nwitness run --step build \\\n  --attestations git,material,environment,product \\\n  --outfile build-attestation.json \\\n  --key signing-key.pem \\\n  -- <your-build-command>\n```\n\n**Rego Validation Rules:**\n```rego\npackage git\n\nimport rego.v1\n\n# Enforce builds from specific branch\ndeny contains msg if {\n    input.branch != \"master\"\n    msg := sprintf(\"Must build from master branch, got: %s\", [input.branch])\n}\n\n# Require clean working directory\ndeny contains msg if {\n    count(input.status) > 0\n    msg := \"Working directory must be clean (no uncommitted changes)\"\n}\n\n# Validate commit author\napproved_authors := {\n    \"alice.smith@example.com\",\n    \"bob.jones@company.com\",\n    \"ci-bot@company.com\"\n}\n\ndeny contains msg if {\n    not input.authoremail in approved_authors\n    msg := sprintf(\"Unauthorized commit author: %s\", [input.authoremail])\n}\n```\n\n**Verification:**\n```bash\nwitness verify \\\n  --policy policy-signed.json \\\n  --publickey policy-key.pub \\\n  -a build-attestation.json \\\n  --subject <artifact>\n```\n"}]}
{"messages": [{"role": "system", "content": "You are an expert in the Witness supply chain attestation framework. You help users instrument CI/CD pipelines with witness, create policy documents, and write Rego policies to validate attestations. You understand all attestors in go-witness and how to use them effectively."}, {"role": "user", "content": "How do I create a multi-step witness policy for a build \u2192 test \u2192 package pipeline?"}, {"role": "assistant", "content": "Here's a complete multi-step witness policy for your pipeline:\n\n**Policy Document:**\n```json\n{\n  \"expires\": \"2026-11-08T10:52:59Z\",\n  \"publickeys\": {\n    \"ci-key\": {\n      \"keyid\": \"sha256:e168eaa339e713a703a113902ef9239e3291e9d7bbd39d9e3b47e6d841b2ef26\",\n      \"key\": \"-----BEGIN PUBLIC KEY-----\\n...\\n-----END PUBLIC KEY-----\"\n    }\n  },\n  \"steps\": {\n    \"build\": {\n      \"name\": \"build\",\n      \"attestations\": [\n        {\n          \"type\": \"https://witness.dev/attestations/git/v0.1\"\n        },\n        {\n          \"type\": \"https://witness.dev/attestations/command-run/v0.1\"\n        },\n        {\n          \"type\": \"https://witness.dev/attestations/product/v0.1\"\n        }\n      ],\n      \"functionaries\": [\n        {\n          \"type\": \"publickey\",\n          \"publickeyid\": \"ci-key\"\n        }\n      ]\n    },\n    \"test\": {\n      \"name\": \"test\",\n      \"attestations\": [\n        {\n          \"type\": \"https://witness.dev/attestations/material/v0.1\"\n        },\n        {\n          \"type\": \"https://witness.dev/attestations/command-run/v0.1\"\n        }\n      ],\n      \"functionaries\": [\n        {\n          \"type\": \"publickey\",\n          \"publickeyid\": \"ci-key\"\n        }\n      ]\n    },\n    \"package\": {\n      \"name\": \"package\",\n      \"attestations\": [\n        {\n          \"type\": \"https://witness.dev/attestations/material/v0.1\"\n        },\n        {\n          \"type\": \"https://witness.dev/attestations/product/v0.1\"\n        }\n      ],\n      \"functionaries\": [\n        {\n          \"type\": \"publickey\",\n          \"publickeyid\": \"ci-key\"\n        }\n      ]\n    }\n  }\n}\n```\n\n**Pipeline Commands:**\n\n```bash\n# Step 1: Build\nwitness run --step build \\\n  --attestations git,commandrun,product \\\n  -o build.json --key ci-key.pem \\\n  -- go build -o myapp\n\n# Step 2: Test\nwitness run --step test \\\n  --attestations material,commandrun \\\n  -o test.json --key ci-key.pem \\\n  -- go test ./...\n\n# Step 3: Package\nwitness run --step package \\\n  --attestations material,product \\\n  -o package.json --key ci-key.pem \\\n  -- tar czf myapp.tar.gz myapp\n\n# Verify entire pipeline\nwitness verify \\\n  --policy policy-signed.json \\\n  --publickey policy-key.pub \\\n  -a build.json -a test.json -a package.json\n```\n"}]}
{"messages": [{"role": "system", "content": "You are an expert in the Witness supply chain attestation framework. You help users instrument CI/CD pipelines with witness, create policy documents, and write Rego policies to validate attestations. You understand all attestors in go-witness and how to use them effectively."}, {"role": "user", "content": "How do I create a witness policy for a build step that uses these attestors: environment, material, github?"}, {"role": "assistant", "content": "Here's a complete witness policy for your build step with environment, material, github attestors:\n\n**Policy Document:**\n```json\n{\n  \"expires\": \"2026-11-08T10:52:59Z\",\n  \"publickeys\": {\n    \"build-key\": {\n      \"keyid\": \"sha256:3db2f02d4449b57d484c8ce060ad22f3da1711c2fd697af620c7af708b12847b\",\n      \"key\": \"-----BEGIN PUBLIC KEY-----\\n...\\n-----END PUBLIC KEY-----\"\n    }\n  },\n  \"steps\": {\n    \"build\": {\n      \"name\": \"build\",\n      \"attestations\": [\n        {\n          \"type\": \"https://witness.dev/attestations/environment/v0.1\"\n        },\n        {\n          \"type\": \"https://witness.dev/attestations/material/v0.1\"\n        },\n        {\n          \"type\": \"https://witness.dev/attestations/github/v0.1\"\n        }\n      ],\n      \"functionaries\": [\n        {\n          \"type\": \"publickey\",\n          \"publickeyid\": \"build-key\"\n        }\n      ]\n    }\n  }\n}\n```\n\n**Witness Run Command:**\n```bash\nwitness run --step build \\\n  --attestations environment,material,github \\\n  --outfile build-attestation.json \\\n  --key signing-key.pem \\\n  -- <your-build-command>\n```\n\n**Rego Validation Rules:**\n```rego\npackage environment\n\nimport rego.v1\n\n# Ensure correct OS\ndeny contains msg if {\n    input.os != \"darwin\"\n    msg := sprintf(\"Must run on darwin, got: %s\", [input.os])\n}\n\n# Require CI environment\ndeny contains msg if {\n    not \"CI\" in input.variables\n    msg := \"Must run in CI environment (CI variable not set)\"\n}\n```\n\n**Verification:**\n```bash\nwitness verify \\\n  --policy policy-signed.json \\\n  --publickey policy-key.pub \\\n  -a build-attestation.json \\\n  --subject <artifact>\n```\n"}]}
{"messages": [{"role": "system", "content": "You are an expert in the Witness supply chain attestation framework. You help users instrument CI/CD pipelines with witness, create policy documents, and write Rego policies to validate attestations. You understand all attestors in go-witness and how to use them effectively."}, {"role": "user", "content": "How do I create a witness policy for a build step that uses these attestors: commandrun?"}, {"role": "assistant", "content": "Here's a complete witness policy for your build step with commandrun attestors:\n\n**Policy Document:**\n```json\n{\n  \"expires\": \"2026-11-08T10:52:59Z\",\n  \"publickeys\": {\n    \"build-key\": {\n      \"keyid\": \"sha256:ec2c5e7994c5cc915746344c8378790fd52c87ae9d6e8574036944e01cc3957b\",\n      \"key\": \"-----BEGIN PUBLIC KEY-----\\n...\\n-----END PUBLIC KEY-----\"\n    }\n  },\n  \"steps\": {\n    \"build\": {\n      \"name\": \"build\",\n      \"attestations\": [\n        {\n          \"type\": \"https://witness.dev/attestations/command-run/v0.1\"\n        }\n      ],\n      \"functionaries\": [\n        {\n          \"type\": \"publickey\",\n          \"publickeyid\": \"build-key\"\n        }\n      ]\n    }\n  }\n}\n```\n\n**Witness Run Command:**\n```bash\nwitness run --step build \\\n  --attestations commandrun \\\n  --outfile build-attestation.json \\\n  --key signing-key.pem \\\n  -- <your-build-command>\n```\n\n**Rego Validation Rules:**\n```rego\n\n```\n\n**Verification:**\n```bash\nwitness verify \\\n  --policy policy-signed.json \\\n  --publickey policy-key.pub \\\n  -a build-attestation.json \\\n  --subject <artifact>\n```\n"}]}
{"messages": [{"role": "system", "content": "You are an expert in the Witness supply chain attestation framework. You help users instrument CI/CD pipelines with witness, create policy documents, and write Rego policies to validate attestations. You understand all attestors in go-witness and how to use them effectively."}, {"role": "user", "content": "How do I create a multi-step witness policy for a build \u2192 test \u2192 package pipeline?"}, {"role": "assistant", "content": "Here's a complete multi-step witness policy for your pipeline:\n\n**Policy Document:**\n```json\n{\n  \"expires\": \"2026-11-08T10:52:59Z\",\n  \"publickeys\": {\n    \"ci-key\": {\n      \"keyid\": \"sha256:d8aa8c5ede7d31d1d9e376504fca7a7499313e207366c46d09db9dcd84395d8a\",\n      \"key\": \"-----BEGIN PUBLIC KEY-----\\n...\\n-----END PUBLIC KEY-----\"\n    }\n  },\n  \"steps\": {\n    \"build\": {\n      \"name\": \"build\",\n      \"attestations\": [\n        {\n          \"type\": \"https://witness.dev/attestations/git/v0.1\"\n        },\n        {\n          \"type\": \"https://witness.dev/attestations/command-run/v0.1\"\n        },\n        {\n          \"type\": \"https://witness.dev/attestations/product/v0.1\"\n        }\n      ],\n      \"functionaries\": [\n        {\n          \"type\": \"publickey\",\n          \"publickeyid\": \"ci-key\"\n        }\n      ]\n    },\n    \"test\": {\n      \"name\": \"test\",\n      \"attestations\": [\n        {\n          \"type\": \"https://witness.dev/attestations/material/v0.1\"\n        },\n        {\n          \"type\": \"https://witness.dev/attestations/command-run/v0.1\"\n        }\n      ],\n      \"functionaries\": [\n        {\n          \"type\": \"publickey\",\n          \"publickeyid\": \"ci-key\"\n        }\n      ]\n    },\n    \"package\": {\n      \"name\": \"package\",\n      \"attestations\": [\n        {\n          \"type\": \"https://witness.dev/attestations/material/v0.1\"\n        },\n        {\n          \"type\": \"https://witness.dev/attestations/product/v0.1\"\n        }\n      ],\n      \"functionaries\": [\n        {\n          \"type\": \"publickey\",\n          \"publickeyid\": \"ci-key\"\n        }\n      ]\n    }\n  }\n}\n```\n\n**Pipeline Commands:**\n\n```bash\n# Step 1: Build\nwitness run --step build \\\n  --attestations git,commandrun,product \\\n  -o build.json --key ci-key.pem \\\n  -- go build -o myapp\n\n# Step 2: Test\nwitness run --step test \\\n  --attestations material,commandrun \\\n  -o test.json --key ci-key.pem \\\n  -- go test ./...\n\n# Step 3: Package\nwitness run --step package \\\n  --attestations material,product \\\n  -o package.json --key ci-key.pem \\\n  -- tar czf myapp.tar.gz myapp\n\n# Verify entire pipeline\nwitness verify \\\n  --policy policy-signed.json \\\n  --publickey policy-key.pub \\\n  -a build.json -a test.json -a package.json\n```\n"}]}
{"messages": [{"role": "system", "content": "You are an expert in the Witness supply chain attestation framework. You help users instrument CI/CD pipelines with witness, create policy documents, and write Rego policies to validate attestations. You understand all attestors in go-witness and how to use them effectively."}, {"role": "user", "content": "How do I create a witness policy for a build step that uses these attestors: environment, material, commandrun, git?"}, {"role": "assistant", "content": "Here's a complete witness policy for your build step with environment, material, commandrun, git attestors:\n\n**Policy Document:**\n```json\n{\n  \"expires\": \"2026-11-08T10:52:59Z\",\n  \"publickeys\": {\n    \"build-key\": {\n      \"keyid\": \"sha256:5f6e17e80091bd966c28d806cdec98d801e1c3eaf8811d7a82e23a57044e88ec\",\n      \"key\": \"-----BEGIN PUBLIC KEY-----\\n...\\n-----END PUBLIC KEY-----\"\n    }\n  },\n  \"steps\": {\n    \"build\": {\n      \"name\": \"build\",\n      \"attestations\": [\n        {\n          \"type\": \"https://witness.dev/attestations/environment/v0.1\"\n        },\n        {\n          \"type\": \"https://witness.dev/attestations/material/v0.1\"\n        },\n        {\n          \"type\": \"https://witness.dev/attestations/command-run/v0.1\"\n        },\n        {\n          \"type\": \"https://witness.dev/attestations/git/v0.1\"\n        }\n      ],\n      \"functionaries\": [\n        {\n          \"type\": \"publickey\",\n          \"publickeyid\": \"build-key\"\n        }\n      ]\n    }\n  }\n}\n```\n\n**Witness Run Command:**\n```bash\nwitness run --step build \\\n  --attestations environment,material,commandrun,git \\\n  --outfile build-attestation.json \\\n  --key signing-key.pem \\\n  -- <your-build-command>\n```\n\n**Rego Validation Rules:**\n```rego\npackage environment\n\nimport rego.v1\n\n# Ensure correct OS\ndeny contains msg if {\n    input.os != \"linux\"\n    msg := sprintf(\"Must run on linux, got: %s\", [input.os])\n}\n\n# Require CI environment\ndeny contains msg if {\n    not \"CI\" in input.variables\n    msg := \"Must run in CI environment (CI variable not set)\"\n}\n```\n\n**Verification:**\n```bash\nwitness verify \\\n  --policy policy-signed.json \\\n  --publickey policy-key.pub \\\n  -a build-attestation.json \\\n  --subject <artifact>\n```\n"}]}
{"messages": [{"role": "system", "content": "You are an expert in the Witness supply chain attestation framework. You help users instrument CI/CD pipelines with witness, create policy documents, and write Rego policies to validate attestations. You understand all attestors in go-witness and how to use them effectively."}, {"role": "user", "content": "How do I create a witness policy for a build step that uses these attestors: material, commandrun, product?"}, {"role": "assistant", "content": "Here's a complete witness policy for your build step with material, commandrun, product attestors:\n\n**Policy Document:**\n```json\n{\n  \"expires\": \"2026-11-08T10:52:59Z\",\n  \"publickeys\": {\n    \"build-key\": {\n      \"keyid\": \"sha256:28646bfe9075983e48bf1faf1004c3ab51dd374483105fbd209f8e0c45300e9d\",\n      \"key\": \"-----BEGIN PUBLIC KEY-----\\n...\\n-----END PUBLIC KEY-----\"\n    }\n  },\n  \"steps\": {\n    \"build\": {\n      \"name\": \"build\",\n      \"attestations\": [\n        {\n          \"type\": \"https://witness.dev/attestations/material/v0.1\"\n        },\n        {\n          \"type\": \"https://witness.dev/attestations/command-run/v0.1\"\n        },\n        {\n          \"type\": \"https://witness.dev/attestations/product/v0.1\"\n        }\n      ],\n      \"functionaries\": [\n        {\n          \"type\": \"publickey\",\n          \"publickeyid\": \"build-key\"\n        }\n      ]\n    }\n  }\n}\n```\n\n**Witness Run Command:**\n```bash\nwitness run --step build \\\n  --attestations material,commandrun,product \\\n  --outfile build-attestation.json \\\n  --key signing-key.pem \\\n  -- <your-build-command>\n```\n\n**Rego Validation Rules:**\n```rego\n\n```\n\n**Verification:**\n```bash\nwitness verify \\\n  --policy policy-signed.json \\\n  --publickey policy-key.pub \\\n  -a build-attestation.json \\\n  --subject <artifact>\n```\n"}]}
{"messages": [{"role": "system", "content": "You are an expert in the Witness supply chain attestation framework. You help users instrument CI/CD pipelines with witness, create policy documents, and write Rego policies to validate attestations. You understand all attestors in go-witness and how to use them effectively."}, {"role": "user", "content": "How do I create a witness policy for a build step that uses these attestors: git, github, commandrun, product, material?"}, {"role": "assistant", "content": "Here's a complete witness policy for your build step with git, github, commandrun, product, material attestors:\n\n**Policy Document:**\n```json\n{\n  \"expires\": \"2026-11-08T10:52:59Z\",\n  \"publickeys\": {\n    \"build-key\": {\n      \"keyid\": \"sha256:a8935008ab5e720443e91bd411dc5e6db40cc045ab07dc668627eb30dbcaa800\",\n      \"key\": \"-----BEGIN PUBLIC KEY-----\\n...\\n-----END PUBLIC KEY-----\"\n    }\n  },\n  \"steps\": {\n    \"build\": {\n      \"name\": \"build\",\n      \"attestations\": [\n        {\n          \"type\": \"https://witness.dev/attestations/git/v0.1\"\n        },\n        {\n          \"type\": \"https://witness.dev/attestations/github/v0.1\"\n        },\n        {\n          \"type\": \"https://witness.dev/attestations/command-run/v0.1\"\n        },\n        {\n          \"type\": \"https://witness.dev/attestations/product/v0.1\"\n        },\n        {\n          \"type\": \"https://witness.dev/attestations/material/v0.1\"\n        }\n      ],\n      \"functionaries\": [\n        {\n          \"type\": \"publickey\",\n          \"publickeyid\": \"build-key\"\n        }\n      ]\n    }\n  }\n}\n```\n\n**Witness Run Command:**\n```bash\nwitness run --step build \\\n  --attestations git,github,commandrun,product,material \\\n  --outfile build-attestation.json \\\n  --key signing-key.pem \\\n  -- <your-build-command>\n```\n\n**Rego Validation Rules:**\n```rego\npackage git\n\nimport rego.v1\n\n# Enforce builds from specific branch\ndeny contains msg if {\n    input.branch != \"master\"\n    msg := sprintf(\"Must build from master branch, got: %s\", [input.branch])\n}\n\n# Require clean working directory\ndeny contains msg if {\n    count(input.status) > 0\n    msg := \"Working directory must be clean (no uncommitted changes)\"\n}\n\n# Validate commit author\napproved_authors := {\n    \"alice.smith@example.com\",\n    \"bob.jones@company.com\",\n    \"ci-bot@company.com\"\n}\n\ndeny contains msg if {\n    not input.authoremail in approved_authors\n    msg := sprintf(\"Unauthorized commit author: %s\", [input.authoremail])\n}\n```\n\n**Verification:**\n```bash\nwitness verify \\\n  --policy policy-signed.json \\\n  --publickey policy-key.pub \\\n  -a build-attestation.json \\\n  --subject <artifact>\n```\n"}]}
{"messages": [{"role": "system", "content": "You are an expert in the Witness supply chain attestation framework. You help users instrument CI/CD pipelines with witness, create policy documents, and write Rego policies to validate attestations. You understand all attestors in go-witness and how to use them effectively."}, {"role": "user", "content": "How do I create a witness policy for a build step that uses these attestors: git?"}, {"role": "assistant", "content": "Here's a complete witness policy for your build step with git attestors:\n\n**Policy Document:**\n```json\n{\n  \"expires\": \"2026-11-08T10:52:59Z\",\n  \"publickeys\": {\n    \"build-key\": {\n      \"keyid\": \"sha256:ba6b425575c04a0ec232d254acecc0eee3edcdf8d1cc22580c34b2ca81a6abe8\",\n      \"key\": \"-----BEGIN PUBLIC KEY-----\\n...\\n-----END PUBLIC KEY-----\"\n    }\n  },\n  \"steps\": {\n    \"build\": {\n      \"name\": \"build\",\n      \"attestations\": [\n        {\n          \"type\": \"https://witness.dev/attestations/git/v0.1\"\n        }\n      ],\n      \"functionaries\": [\n        {\n          \"type\": \"publickey\",\n          \"publickeyid\": \"build-key\"\n        }\n      ]\n    }\n  }\n}\n```\n\n**Witness Run Command:**\n```bash\nwitness run --step build \\\n  --attestations git \\\n  --outfile build-attestation.json \\\n  --key signing-key.pem \\\n  -- <your-build-command>\n```\n\n**Rego Validation Rules:**\n```rego\npackage git\n\nimport rego.v1\n\n# Enforce builds from specific branch\ndeny contains msg if {\n    input.branch != \"bugfix/security\"\n    msg := sprintf(\"Must build from bugfix/security branch, got: %s\", [input.branch])\n}\n\n# Require clean working directory\ndeny contains msg if {\n    count(input.status) > 0\n    msg := \"Working directory must be clean (no uncommitted changes)\"\n}\n\n# Validate commit author\napproved_authors := {\n    \"alice.smith@example.com\",\n    \"bob.jones@company.com\",\n    \"ci-bot@company.com\"\n}\n\ndeny contains msg if {\n    not input.authoremail in approved_authors\n    msg := sprintf(\"Unauthorized commit author: %s\", [input.authoremail])\n}\n```\n\n**Verification:**\n```bash\nwitness verify \\\n  --policy policy-signed.json \\\n  --publickey policy-key.pub \\\n  -a build-attestation.json \\\n  --subject <artifact>\n```\n"}]}
{"messages": [{"role": "system", "content": "You are an expert in the Witness supply chain attestation framework. You help users instrument CI/CD pipelines with witness, create policy documents, and write Rego policies to validate attestations. You understand all attestors in go-witness and how to use them effectively."}, {"role": "user", "content": "How do I create a witness policy for a build step that uses these attestors: github, git, environment, commandrun?"}, {"role": "assistant", "content": "Here's a complete witness policy for your build step with github, git, environment, commandrun attestors:\n\n**Policy Document:**\n```json\n{\n  \"expires\": \"2026-11-08T10:52:59Z\",\n  \"publickeys\": {\n    \"build-key\": {\n      \"keyid\": \"sha256:ee23cd66195802152a3fc1623f0cdd13af89411b18d4de24b2f12ea9a9afe5f2\",\n      \"key\": \"-----BEGIN PUBLIC KEY-----\\n...\\n-----END PUBLIC KEY-----\"\n    }\n  },\n  \"steps\": {\n    \"build\": {\n      \"name\": \"build\",\n      \"attestations\": [\n        {\n          \"type\": \"https://witness.dev/attestations/github/v0.1\"\n        },\n        {\n          \"type\": \"https://witness.dev/attestations/git/v0.1\"\n        },\n        {\n          \"type\": \"https://witness.dev/attestations/environment/v0.1\"\n        },\n        {\n          \"type\": \"https://witness.dev/attestations/command-run/v0.1\"\n        }\n      ],\n      \"functionaries\": [\n        {\n          \"type\": \"publickey\",\n          \"publickeyid\": \"build-key\"\n        }\n      ]\n    }\n  }\n}\n```\n\n**Witness Run Command:**\n```bash\nwitness run --step build \\\n  --attestations github,git,environment,commandrun \\\n  --outfile build-attestation.json \\\n  --key signing-key.pem \\\n  -- <your-build-command>\n```\n\n**Rego Validation Rules:**\n```rego\n\n```\n\n**Verification:**\n```bash\nwitness verify \\\n  --policy policy-signed.json \\\n  --publickey policy-key.pub \\\n  -a build-attestation.json \\\n  --subject <artifact>\n```\n"}]}
{"messages": [{"role": "system", "content": "You are an expert in the Witness supply chain attestation framework. You help users instrument CI/CD pipelines with witness, create policy documents, and write Rego policies to validate attestations. You understand all attestors in go-witness and how to use them effectively."}, {"role": "user", "content": "How do I create a witness policy for a build step that uses these attestors: commandrun, environment, product, git, material?"}, {"role": "assistant", "content": "Here's a complete witness policy for your build step with commandrun, environment, product, git, material attestors:\n\n**Policy Document:**\n```json\n{\n  \"expires\": \"2026-11-08T10:52:59Z\",\n  \"publickeys\": {\n    \"build-key\": {\n      \"keyid\": \"sha256:5fe33976ca1fd1b7946353abb9b82af43f998c835d0d70c0559cb95084c66930\",\n      \"key\": \"-----BEGIN PUBLIC KEY-----\\n...\\n-----END PUBLIC KEY-----\"\n    }\n  },\n  \"steps\": {\n    \"build\": {\n      \"name\": \"build\",\n      \"attestations\": [\n        {\n          \"type\": \"https://witness.dev/attestations/command-run/v0.1\"\n        },\n        {\n          \"type\": \"https://witness.dev/attestations/environment/v0.1\"\n        },\n        {\n          \"type\": \"https://witness.dev/attestations/product/v0.1\"\n        },\n        {\n          \"type\": \"https://witness.dev/attestations/git/v0.1\"\n        },\n        {\n          \"type\": \"https://witness.dev/attestations/material/v0.1\"\n        }\n      ],\n      \"functionaries\": [\n        {\n          \"type\": \"publickey\",\n          \"publickeyid\": \"build-key\"\n        }\n      ]\n    }\n  }\n}\n```\n\n**Witness Run Command:**\n```bash\nwitness run --step build \\\n  --attestations commandrun,environment,product,git,material \\\n  --outfile build-attestation.json \\\n  --key signing-key.pem \\\n  -- <your-build-command>\n```\n\n**Rego Validation Rules:**\n```rego\n\n```\n\n**Verification:**\n```bash\nwitness verify \\\n  --policy policy-signed.json \\\n  --publickey policy-key.pub \\\n  -a build-attestation.json \\\n  --subject <artifact>\n```\n"}]}
{"messages": [{"role": "system", "content": "You are an expert in the Witness supply chain attestation framework. You help users instrument CI/CD pipelines with witness, create policy documents, and write Rego policies to validate attestations. You understand all attestors in go-witness and how to use them effectively."}, {"role": "user", "content": "How do I create a witness policy for a build step that uses these attestors: commandrun, environment, product, material, github?"}, {"role": "assistant", "content": "Here's a complete witness policy for your build step with commandrun, environment, product, material, github attestors:\n\n**Policy Document:**\n```json\n{\n  \"expires\": \"2026-11-08T10:52:59Z\",\n  \"publickeys\": {\n    \"build-key\": {\n      \"keyid\": \"sha256:9e47c3e8330e3312d569f473b78d7fcb4f8afde250c79a18c0448dce1f2da493\",\n      \"key\": \"-----BEGIN PUBLIC KEY-----\\n...\\n-----END PUBLIC KEY-----\"\n    }\n  },\n  \"steps\": {\n    \"build\": {\n      \"name\": \"build\",\n      \"attestations\": [\n        {\n          \"type\": \"https://witness.dev/attestations/command-run/v0.1\"\n        },\n        {\n          \"type\": \"https://witness.dev/attestations/environment/v0.1\"\n        },\n        {\n          \"type\": \"https://witness.dev/attestations/product/v0.1\"\n        },\n        {\n          \"type\": \"https://witness.dev/attestations/material/v0.1\"\n        },\n        {\n          \"type\": \"https://witness.dev/attestations/github/v0.1\"\n        }\n      ],\n      \"functionaries\": [\n        {\n          \"type\": \"publickey\",\n          \"publickeyid\": \"build-key\"\n        }\n      ]\n    }\n  }\n}\n```\n\n**Witness Run Command:**\n```bash\nwitness run --step build \\\n  --attestations commandrun,environment,product,material,github \\\n  --outfile build-attestation.json \\\n  --key signing-key.pem \\\n  -- <your-build-command>\n```\n\n**Rego Validation Rules:**\n```rego\n\n```\n\n**Verification:**\n```bash\nwitness verify \\\n  --policy policy-signed.json \\\n  --publickey policy-key.pub \\\n  -a build-attestation.json \\\n  --subject <artifact>\n```\n"}]}
{"messages": [{"role": "system", "content": "You are an expert in the Witness supply chain attestation framework. You help users instrument CI/CD pipelines with witness, create policy documents, and write Rego policies to validate attestations. You understand all attestors in go-witness and how to use them effectively."}, {"role": "user", "content": "How do I create a witness policy for a build step that uses these attestors: commandrun, environment, material, git?"}, {"role": "assistant", "content": "Here's a complete witness policy for your build step with commandrun, environment, material, git attestors:\n\n**Policy Document:**\n```json\n{\n  \"expires\": \"2026-11-08T10:52:59Z\",\n  \"publickeys\": {\n    \"build-key\": {\n      \"keyid\": \"sha256:faf8475cb5adf67f74016c4a83279058731f387c389f1d029cfc8a561b0d74f1\",\n      \"key\": \"-----BEGIN PUBLIC KEY-----\\n...\\n-----END PUBLIC KEY-----\"\n    }\n  },\n  \"steps\": {\n    \"build\": {\n      \"name\": \"build\",\n      \"attestations\": [\n        {\n          \"type\": \"https://witness.dev/attestations/command-run/v0.1\"\n        },\n        {\n          \"type\": \"https://witness.dev/attestations/environment/v0.1\"\n        },\n        {\n          \"type\": \"https://witness.dev/attestations/material/v0.1\"\n        },\n        {\n          \"type\": \"https://witness.dev/attestations/git/v0.1\"\n        }\n      ],\n      \"functionaries\": [\n        {\n          \"type\": \"publickey\",\n          \"publickeyid\": \"build-key\"\n        }\n      ]\n    }\n  }\n}\n```\n\n**Witness Run Command:**\n```bash\nwitness run --step build \\\n  --attestations commandrun,environment,material,git \\\n  --outfile build-attestation.json \\\n  --key signing-key.pem \\\n  -- <your-build-command>\n```\n\n**Rego Validation Rules:**\n```rego\n\n```\n\n**Verification:**\n```bash\nwitness verify \\\n  --policy policy-signed.json \\\n  --publickey policy-key.pub \\\n  -a build-attestation.json \\\n  --subject <artifact>\n```\n"}]}
{"messages": [{"role": "system", "content": "You are an expert in the Witness supply chain attestation framework. You help users instrument CI/CD pipelines with witness, create policy documents, and write Rego policies to validate attestations. You understand all attestors in go-witness and how to use them effectively."}, {"role": "user", "content": "How do I create a multi-step witness policy for a build \u2192 test \u2192 package pipeline?"}, {"role": "assistant", "content": "Here's a complete multi-step witness policy for your pipeline:\n\n**Policy Document:**\n```json\n{\n  \"expires\": \"2026-11-08T10:52:59Z\",\n  \"publickeys\": {\n    \"ci-key\": {\n      \"keyid\": \"sha256:8b9b6fb0fd2e6e06c64ebe34988fecafa152a3053de99e4c52dee7e5e4a02729\",\n      \"key\": \"-----BEGIN PUBLIC KEY-----\\n...\\n-----END PUBLIC KEY-----\"\n    }\n  },\n  \"steps\": {\n    \"build\": {\n      \"name\": \"build\",\n      \"attestations\": [\n        {\n          \"type\": \"https://witness.dev/attestations/git/v0.1\"\n        },\n        {\n          \"type\": \"https://witness.dev/attestations/command-run/v0.1\"\n        },\n        {\n          \"type\": \"https://witness.dev/attestations/product/v0.1\"\n        }\n      ],\n      \"functionaries\": [\n        {\n          \"type\": \"publickey\",\n          \"publickeyid\": \"ci-key\"\n        }\n      ]\n    },\n    \"test\": {\n      \"name\": \"test\",\n      \"attestations\": [\n        {\n          \"type\": \"https://witness.dev/attestations/material/v0.1\"\n        },\n        {\n          \"type\": \"https://witness.dev/attestations/command-run/v0.1\"\n        }\n      ],\n      \"functionaries\": [\n        {\n          \"type\": \"publickey\",\n          \"publickeyid\": \"ci-key\"\n        }\n      ]\n    },\n    \"package\": {\n      \"name\": \"package\",\n      \"attestations\": [\n        {\n          \"type\": \"https://witness.dev/attestations/material/v0.1\"\n        },\n        {\n          \"type\": \"https://witness.dev/attestations/product/v0.1\"\n        }\n      ],\n      \"functionaries\": [\n        {\n          \"type\": \"publickey\",\n          \"publickeyid\": \"ci-key\"\n        }\n      ]\n    }\n  }\n}\n```\n\n**Pipeline Commands:**\n\n```bash\n# Step 1: Build\nwitness run --step build \\\n  --attestations git,commandrun,product \\\n  -o build.json --key ci-key.pem \\\n  -- go build -o myapp\n\n# Step 2: Test\nwitness run --step test \\\n  --attestations material,commandrun \\\n  -o test.json --key ci-key.pem \\\n  -- go test ./...\n\n# Step 3: Package\nwitness run --step package \\\n  --attestations material,product \\\n  -o package.json --key ci-key.pem \\\n  -- tar czf myapp.tar.gz myapp\n\n# Verify entire pipeline\nwitness verify \\\n  --policy policy-signed.json \\\n  --publickey policy-key.pub \\\n  -a build.json -a test.json -a package.json\n```\n"}]}
{"messages": [{"role": "system", "content": "You are an expert in the Witness supply chain attestation framework. You help users instrument CI/CD pipelines with witness, create policy documents, and write Rego policies to validate attestations. You understand all attestors in go-witness and how to use them effectively."}, {"role": "user", "content": "How do I create a multi-step witness policy for a build \u2192 test \u2192 package pipeline?"}, {"role": "assistant", "content": "Here's a complete multi-step witness policy for your pipeline:\n\n**Policy Document:**\n```json\n{\n  \"expires\": \"2026-11-08T10:52:59Z\",\n  \"publickeys\": {\n    \"ci-key\": {\n      \"keyid\": \"sha256:18e7124ffba2fbcbd7dd20d8bc2fd5acc34962307189aaaaf6c158cdb70d8f0a\",\n      \"key\": \"-----BEGIN PUBLIC KEY-----\\n...\\n-----END PUBLIC KEY-----\"\n    }\n  },\n  \"steps\": {\n    \"build\": {\n      \"name\": \"build\",\n      \"attestations\": [\n        {\n          \"type\": \"https://witness.dev/attestations/git/v0.1\"\n        },\n        {\n          \"type\": \"https://witness.dev/attestations/command-run/v0.1\"\n        },\n        {\n          \"type\": \"https://witness.dev/attestations/product/v0.1\"\n        }\n      ],\n      \"functionaries\": [\n        {\n          \"type\": \"publickey\",\n          \"publickeyid\": \"ci-key\"\n        }\n      ]\n    },\n    \"test\": {\n      \"name\": \"test\",\n      \"attestations\": [\n        {\n          \"type\": \"https://witness.dev/attestations/material/v0.1\"\n        },\n        {\n          \"type\": \"https://witness.dev/attestations/command-run/v0.1\"\n        }\n      ],\n      \"functionaries\": [\n        {\n          \"type\": \"publickey\",\n          \"publickeyid\": \"ci-key\"\n        }\n      ]\n    },\n    \"package\": {\n      \"name\": \"package\",\n      \"attestations\": [\n        {\n          \"type\": \"https://witness.dev/attestations/material/v0.1\"\n        },\n        {\n          \"type\": \"https://witness.dev/attestations/product/v0.1\"\n        }\n      ],\n      \"functionaries\": [\n        {\n          \"type\": \"publickey\",\n          \"publickeyid\": \"ci-key\"\n        }\n      ]\n    }\n  }\n}\n```\n\n**Pipeline Commands:**\n\n```bash\n# Step 1: Build\nwitness run --step build \\\n  --attestations git,commandrun,product \\\n  -o build.json --key ci-key.pem \\\n  -- go build -o myapp\n\n# Step 2: Test\nwitness run --step test \\\n  --attestations material,commandrun \\\n  -o test.json --key ci-key.pem \\\n  -- go test ./...\n\n# Step 3: Package\nwitness run --step package \\\n  --attestations material,product \\\n  -o package.json --key ci-key.pem \\\n  -- tar czf myapp.tar.gz myapp\n\n# Verify entire pipeline\nwitness verify \\\n  --policy policy-signed.json \\\n  --publickey policy-key.pub \\\n  -a build.json -a test.json -a package.json\n```\n"}]}
{"messages": [{"role": "system", "content": "You are an expert in the Witness supply chain attestation framework. You help users instrument CI/CD pipelines with witness, create policy documents, and write Rego policies to validate attestations. You understand all attestors in go-witness and how to use them effectively."}, {"role": "user", "content": "How do I create a witness policy for a build step that uses these attestors: environment, material, product, commandrun?"}, {"role": "assistant", "content": "Here's a complete witness policy for your build step with environment, material, product, commandrun attestors:\n\n**Policy Document:**\n```json\n{\n  \"expires\": \"2026-11-08T10:52:59Z\",\n  \"publickeys\": {\n    \"build-key\": {\n      \"keyid\": \"sha256:a9fa899980bfeb921c9675b09d9abe84cff31b1676cda7b0d9a08e7a4d129493\",\n      \"key\": \"-----BEGIN PUBLIC KEY-----\\n...\\n-----END PUBLIC KEY-----\"\n    }\n  },\n  \"steps\": {\n    \"build\": {\n      \"name\": \"build\",\n      \"attestations\": [\n        {\n          \"type\": \"https://witness.dev/attestations/environment/v0.1\"\n        },\n        {\n          \"type\": \"https://witness.dev/attestations/material/v0.1\"\n        },\n        {\n          \"type\": \"https://witness.dev/attestations/product/v0.1\"\n        },\n        {\n          \"type\": \"https://witness.dev/attestations/command-run/v0.1\"\n        }\n      ],\n      \"functionaries\": [\n        {\n          \"type\": \"publickey\",\n          \"publickeyid\": \"build-key\"\n        }\n      ]\n    }\n  }\n}\n```\n\n**Witness Run Command:**\n```bash\nwitness run --step build \\\n  --attestations environment,material,product,commandrun \\\n  --outfile build-attestation.json \\\n  --key signing-key.pem \\\n  -- <your-build-command>\n```\n\n**Rego Validation Rules:**\n```rego\npackage environment\n\nimport rego.v1\n\n# Ensure correct OS\ndeny contains msg if {\n    input.os != \"linux\"\n    msg := sprintf(\"Must run on linux, got: %s\", [input.os])\n}\n\n# Require CI environment\ndeny contains msg if {\n    not \"CI\" in input.variables\n    msg := \"Must run in CI environment (CI variable not set)\"\n}\n```\n\n**Verification:**\n```bash\nwitness verify \\\n  --policy policy-signed.json \\\n  --publickey policy-key.pub \\\n  -a build-attestation.json \\\n  --subject <artifact>\n```\n"}]}
{"messages": [{"role": "system", "content": "You are an expert in the Witness supply chain attestation framework. You help users instrument CI/CD pipelines with witness, create policy documents, and write Rego policies to validate attestations. You understand all attestors in go-witness and how to use them effectively."}, {"role": "user", "content": "How do I create a witness policy for a build step that uses these attestors: environment, github?"}, {"role": "assistant", "content": "Here's a complete witness policy for your build step with environment, github attestors:\n\n**Policy Document:**\n```json\n{\n  \"expires\": \"2026-11-08T10:52:59Z\",\n  \"publickeys\": {\n    \"build-key\": {\n      \"keyid\": \"sha256:ba34209eb1ca5a8603a5c422454ffa964504fd7ffb3ba663e9af15462ecd07de\",\n      \"key\": \"-----BEGIN PUBLIC KEY-----\\n...\\n-----END PUBLIC KEY-----\"\n    }\n  },\n  \"steps\": {\n    \"build\": {\n      \"name\": \"build\",\n      \"attestations\": [\n        {\n          \"type\": \"https://witness.dev/attestations/environment/v0.1\"\n        },\n        {\n          \"type\": \"https://witness.dev/attestations/github/v0.1\"\n        }\n      ],\n      \"functionaries\": [\n        {\n          \"type\": \"publickey\",\n          \"publickeyid\": \"build-key\"\n        }\n      ]\n    }\n  }\n}\n```\n\n**Witness Run Command:**\n```bash\nwitness run --step build \\\n  --attestations environment,github \\\n  --outfile build-attestation.json \\\n  --key signing-key.pem \\\n  -- <your-build-command>\n```\n\n**Rego Validation Rules:**\n```rego\npackage environment\n\nimport rego.v1\n\n# Ensure correct OS\ndeny contains msg if {\n    input.os != \"linux\"\n    msg := sprintf(\"Must run on linux, got: %s\", [input.os])\n}\n\n# Require CI environment\ndeny contains msg if {\n    not \"CI\" in input.variables\n    msg := \"Must run in CI environment (CI variable not set)\"\n}\n```\n\n**Verification:**\n```bash\nwitness verify \\\n  --policy policy-signed.json \\\n  --publickey policy-key.pub \\\n  -a build-attestation.json \\\n  --subject <artifact>\n```\n"}]}
{"messages": [{"role": "system", "content": "You are an expert in the Witness supply chain attestation framework. You help users instrument CI/CD pipelines with witness, create policy documents, and write Rego policies to validate attestations. You understand all attestors in go-witness and how to use them effectively."}, {"role": "user", "content": "How do I create a witness policy for a build step that uses these attestors: commandrun, github, product, material?"}, {"role": "assistant", "content": "Here's a complete witness policy for your build step with commandrun, github, product, material attestors:\n\n**Policy Document:**\n```json\n{\n  \"expires\": \"2026-11-08T10:52:59Z\",\n  \"publickeys\": {\n    \"build-key\": {\n      \"keyid\": \"sha256:f90c3e4360025edc4dd0b381ebd85d3c04a757dd2a0429ddf93f23e1c46eab95\",\n      \"key\": \"-----BEGIN PUBLIC KEY-----\\n...\\n-----END PUBLIC KEY-----\"\n    }\n  },\n  \"steps\": {\n    \"build\": {\n      \"name\": \"build\",\n      \"attestations\": [\n        {\n          \"type\": \"https://witness.dev/attestations/command-run/v0.1\"\n        },\n        {\n          \"type\": \"https://witness.dev/attestations/github/v0.1\"\n        },\n        {\n          \"type\": \"https://witness.dev/attestations/product/v0.1\"\n        },\n        {\n          \"type\": \"https://witness.dev/attestations/material/v0.1\"\n        }\n      ],\n      \"functionaries\": [\n        {\n          \"type\": \"publickey\",\n          \"publickeyid\": \"build-key\"\n        }\n      ]\n    }\n  }\n}\n```\n\n**Witness Run Command:**\n```bash\nwitness run --step build \\\n  --attestations commandrun,github,product,material \\\n  --outfile build-attestation.json \\\n  --key signing-key.pem \\\n  -- <your-build-command>\n```\n\n**Rego Validation Rules:**\n```rego\n\n```\n\n**Verification:**\n```bash\nwitness verify \\\n  --policy policy-signed.json \\\n  --publickey policy-key.pub \\\n  -a build-attestation.json \\\n  --subject <artifact>\n```\n"}]}
{"messages": [{"role": "system", "content": "You are an expert in the Witness supply chain attestation framework. You help users instrument CI/CD pipelines with witness, create policy documents, and write Rego policies to validate attestations. You understand all attestors in go-witness and how to use them effectively."}, {"role": "user", "content": "How do I create a witness policy for a build step that uses these attestors: material, environment, github, commandrun?"}, {"role": "assistant", "content": "Here's a complete witness policy for your build step with material, environment, github, commandrun attestors:\n\n**Policy Document:**\n```json\n{\n  \"expires\": \"2026-11-08T10:52:59Z\",\n  \"publickeys\": {\n    \"build-key\": {\n      \"keyid\": \"sha256:7320de25f7a5f1f63ef03b21d765627c933f4e0be2635604df21a98e287e1944\",\n      \"key\": \"-----BEGIN PUBLIC KEY-----\\n...\\n-----END PUBLIC KEY-----\"\n    }\n  },\n  \"steps\": {\n    \"build\": {\n      \"name\": \"build\",\n      \"attestations\": [\n        {\n          \"type\": \"https://witness.dev/attestations/material/v0.1\"\n        },\n        {\n          \"type\": \"https://witness.dev/attestations/environment/v0.1\"\n        },\n        {\n          \"type\": \"https://witness.dev/attestations/github/v0.1\"\n        },\n        {\n          \"type\": \"https://witness.dev/attestations/command-run/v0.1\"\n        }\n      ],\n      \"functionaries\": [\n        {\n          \"type\": \"publickey\",\n          \"publickeyid\": \"build-key\"\n        }\n      ]\n    }\n  }\n}\n```\n\n**Witness Run Command:**\n```bash\nwitness run --step build \\\n  --attestations material,environment,github,commandrun \\\n  --outfile build-attestation.json \\\n  --key signing-key.pem \\\n  -- <your-build-command>\n```\n\n**Rego Validation Rules:**\n```rego\n\n```\n\n**Verification:**\n```bash\nwitness verify \\\n  --policy policy-signed.json \\\n  --publickey policy-key.pub \\\n  -a build-attestation.json \\\n  --subject <artifact>\n```\n"}]}
{"messages": [{"role": "system", "content": "You are an expert in the Witness supply chain attestation framework. You help users instrument CI/CD pipelines with witness, create policy documents, and write Rego policies to validate attestations. You understand all attestors in go-witness and how to use them effectively."}, {"role": "user", "content": "How do I create a witness policy for a build step that uses these attestors: github, material, git, commandrun?"}, {"role": "assistant", "content": "Here's a complete witness policy for your build step with github, material, git, commandrun attestors:\n\n**Policy Document:**\n```json\n{\n  \"expires\": \"2026-11-08T10:52:59Z\",\n  \"publickeys\": {\n    \"build-key\": {\n      \"keyid\": \"sha256:bdd13f4761688445c38feef7f4cf36382ce276cf26e5eb3523b4a653bbbf4683\",\n      \"key\": \"-----BEGIN PUBLIC KEY-----\\n...\\n-----END PUBLIC KEY-----\"\n    }\n  },\n  \"steps\": {\n    \"build\": {\n      \"name\": \"build\",\n      \"attestations\": [\n        {\n          \"type\": \"https://witness.dev/attestations/github/v0.1\"\n        },\n        {\n          \"type\": \"https://witness.dev/attestations/material/v0.1\"\n        },\n        {\n          \"type\": \"https://witness.dev/attestations/git/v0.1\"\n        },\n        {\n          \"type\": \"https://witness.dev/attestations/command-run/v0.1\"\n        }\n      ],\n      \"functionaries\": [\n        {\n          \"type\": \"publickey\",\n          \"publickeyid\": \"build-key\"\n        }\n      ]\n    }\n  }\n}\n```\n\n**Witness Run Command:**\n```bash\nwitness run --step build \\\n  --attestations github,material,git,commandrun \\\n  --outfile build-attestation.json \\\n  --key signing-key.pem \\\n  -- <your-build-command>\n```\n\n**Rego Validation Rules:**\n```rego\n\n```\n\n**Verification:**\n```bash\nwitness verify \\\n  --policy policy-signed.json \\\n  --publickey policy-key.pub \\\n  -a build-attestation.json \\\n  --subject <artifact>\n```\n"}]}
{"messages": [{"role": "system", "content": "You are an expert in the Witness supply chain attestation framework. You help users instrument CI/CD pipelines with witness, create policy documents, and write Rego policies to validate attestations. You understand all attestors in go-witness and how to use them effectively."}, {"role": "user", "content": "How do I create a multi-step witness policy for a build \u2192 test \u2192 package pipeline?"}, {"role": "assistant", "content": "Here's a complete multi-step witness policy for your pipeline:\n\n**Policy Document:**\n```json\n{\n  \"expires\": \"2026-11-08T10:52:59Z\",\n  \"publickeys\": {\n    \"ci-key\": {\n      \"keyid\": \"sha256:963d9e8ef425d80f9d9c4855da85591c076c55938aeed7a9ec298932cb01d084\",\n      \"key\": \"-----BEGIN PUBLIC KEY-----\\n...\\n-----END PUBLIC KEY-----\"\n    }\n  },\n  \"steps\": {\n    \"build\": {\n      \"name\": \"build\",\n      \"attestations\": [\n        {\n          \"type\": \"https://witness.dev/attestations/git/v0.1\"\n        },\n        {\n          \"type\": \"https://witness.dev/attestations/command-run/v0.1\"\n        },\n        {\n          \"type\": \"https://witness.dev/attestations/product/v0.1\"\n        }\n      ],\n      \"functionaries\": [\n        {\n          \"type\": \"publickey\",\n          \"publickeyid\": \"ci-key\"\n        }\n      ]\n    },\n    \"test\": {\n      \"name\": \"test\",\n      \"attestations\": [\n        {\n          \"type\": \"https://witness.dev/attestations/material/v0.1\"\n        },\n        {\n          \"type\": \"https://witness.dev/attestations/command-run/v0.1\"\n        }\n      ],\n      \"functionaries\": [\n        {\n          \"type\": \"publickey\",\n          \"publickeyid\": \"ci-key\"\n        }\n      ]\n    },\n    \"package\": {\n      \"name\": \"package\",\n      \"attestations\": [\n        {\n          \"type\": \"https://witness.dev/attestations/material/v0.1\"\n        },\n        {\n          \"type\": \"https://witness.dev/attestations/product/v0.1\"\n        }\n      ],\n      \"functionaries\": [\n        {\n          \"type\": \"publickey\",\n          \"publickeyid\": \"ci-key\"\n        }\n      ]\n    }\n  }\n}\n```\n\n**Pipeline Commands:**\n\n```bash\n# Step 1: Build\nwitness run --step build \\\n  --attestations git,commandrun,product \\\n  -o build.json --key ci-key.pem \\\n  -- go build -o myapp\n\n# Step 2: Test\nwitness run --step test \\\n  --attestations material,commandrun \\\n  -o test.json --key ci-key.pem \\\n  -- go test ./...\n\n# Step 3: Package\nwitness run --step package \\\n  --attestations material,product \\\n  -o package.json --key ci-key.pem \\\n  -- tar czf myapp.tar.gz myapp\n\n# Verify entire pipeline\nwitness verify \\\n  --policy policy-signed.json \\\n  --publickey policy-key.pub \\\n  -a build.json -a test.json -a package.json\n```\n"}]}
{"messages": [{"role": "system", "content": "You are an expert in the Witness supply chain attestation framework. You help users instrument CI/CD pipelines with witness, create policy documents, and write Rego policies to validate attestations. You understand all attestors in go-witness and how to use them effectively."}, {"role": "user", "content": "How do I create a witness policy for a build step that uses these attestors: github, commandrun, environment?"}, {"role": "assistant", "content": "Here's a complete witness policy for your build step with github, commandrun, environment attestors:\n\n**Policy Document:**\n```json\n{\n  \"expires\": \"2026-11-08T10:52:59Z\",\n  \"publickeys\": {\n    \"build-key\": {\n      \"keyid\": \"sha256:8fcd913a1d1636ddbd33977b9035258b3ea6592f8dd92f1e47b8adaa9b12f2c4\",\n      \"key\": \"-----BEGIN PUBLIC KEY-----\\n...\\n-----END PUBLIC KEY-----\"\n    }\n  },\n  \"steps\": {\n    \"build\": {\n      \"name\": \"build\",\n      \"attestations\": [\n        {\n          \"type\": \"https://witness.dev/attestations/github/v0.1\"\n        },\n        {\n          \"type\": \"https://witness.dev/attestations/command-run/v0.1\"\n        },\n        {\n          \"type\": \"https://witness.dev/attestations/environment/v0.1\"\n        }\n      ],\n      \"functionaries\": [\n        {\n          \"type\": \"publickey\",\n          \"publickeyid\": \"build-key\"\n        }\n      ]\n    }\n  }\n}\n```\n\n**Witness Run Command:**\n```bash\nwitness run --step build \\\n  --attestations github,commandrun,environment \\\n  --outfile build-attestation.json \\\n  --key signing-key.pem \\\n  -- <your-build-command>\n```\n\n**Rego Validation Rules:**\n```rego\n\n```\n\n**Verification:**\n```bash\nwitness verify \\\n  --policy policy-signed.json \\\n  --publickey policy-key.pub \\\n  -a build-attestation.json \\\n  --subject <artifact>\n```\n"}]}
{"messages": [{"role": "system", "content": "You are an expert in the Witness supply chain attestation framework. You help users instrument CI/CD pipelines with witness, create policy documents, and write Rego policies to validate attestations. You understand all attestors in go-witness and how to use them effectively."}, {"role": "user", "content": "How do I create a witness policy for a build step that uses these attestors: github, git, environment, material, commandrun?"}, {"role": "assistant", "content": "Here's a complete witness policy for your build step with github, git, environment, material, commandrun attestors:\n\n**Policy Document:**\n```json\n{\n  \"expires\": \"2026-11-08T10:52:59Z\",\n  \"publickeys\": {\n    \"build-key\": {\n      \"keyid\": \"sha256:9e112c49eba8377b14b10267bbac4d29e4d9ce4e6458305c33b30061c2371296\",\n      \"key\": \"-----BEGIN PUBLIC KEY-----\\n...\\n-----END PUBLIC KEY-----\"\n    }\n  },\n  \"steps\": {\n    \"build\": {\n      \"name\": \"build\",\n      \"attestations\": [\n        {\n          \"type\": \"https://witness.dev/attestations/github/v0.1\"\n        },\n        {\n          \"type\": \"https://witness.dev/attestations/git/v0.1\"\n        },\n        {\n          \"type\": \"https://witness.dev/attestations/environment/v0.1\"\n        },\n        {\n          \"type\": \"https://witness.dev/attestations/material/v0.1\"\n        },\n        {\n          \"type\": \"https://witness.dev/attestations/command-run/v0.1\"\n        }\n      ],\n      \"functionaries\": [\n        {\n          \"type\": \"publickey\",\n          \"publickeyid\": \"build-key\"\n        }\n      ]\n    }\n  }\n}\n```\n\n**Witness Run Command:**\n```bash\nwitness run --step build \\\n  --attestations github,git,environment,material,commandrun \\\n  --outfile build-attestation.json \\\n  --key signing-key.pem \\\n  -- <your-build-command>\n```\n\n**Rego Validation Rules:**\n```rego\n\n```\n\n**Verification:**\n```bash\nwitness verify \\\n  --policy policy-signed.json \\\n  --publickey policy-key.pub \\\n  -a build-attestation.json \\\n  --subject <artifact>\n```\n"}]}
{"messages": [{"role": "system", "content": "You are an expert in the Witness supply chain attestation framework. You help users instrument CI/CD pipelines with witness, create policy documents, and write Rego policies to validate attestations. You understand all attestors in go-witness and how to use them effectively."}, {"role": "user", "content": "How do I create a witness policy for a build step that uses these attestors: commandrun, product, github, environment, material?"}, {"role": "assistant", "content": "Here's a complete witness policy for your build step with commandrun, product, github, environment, material attestors:\n\n**Policy Document:**\n```json\n{\n  \"expires\": \"2026-11-08T10:52:59Z\",\n  \"publickeys\": {\n    \"build-key\": {\n      \"keyid\": \"sha256:49559269ae888317fa939e88ec4f750dfdd9beab228198c9bc2f3309aab4e366\",\n      \"key\": \"-----BEGIN PUBLIC KEY-----\\n...\\n-----END PUBLIC KEY-----\"\n    }\n  },\n  \"steps\": {\n    \"build\": {\n      \"name\": \"build\",\n      \"attestations\": [\n        {\n          \"type\": \"https://witness.dev/attestations/command-run/v0.1\"\n        },\n        {\n          \"type\": \"https://witness.dev/attestations/product/v0.1\"\n        },\n        {\n          \"type\": \"https://witness.dev/attestations/github/v0.1\"\n        },\n        {\n          \"type\": \"https://witness.dev/attestations/environment/v0.1\"\n        },\n        {\n          \"type\": \"https://witness.dev/attestations/material/v0.1\"\n        }\n      ],\n      \"functionaries\": [\n        {\n          \"type\": \"publickey\",\n          \"publickeyid\": \"build-key\"\n        }\n      ]\n    }\n  }\n}\n```\n\n**Witness Run Command:**\n```bash\nwitness run --step build \\\n  --attestations commandrun,product,github,environment,material \\\n  --outfile build-attestation.json \\\n  --key signing-key.pem \\\n  -- <your-build-command>\n```\n\n**Rego Validation Rules:**\n```rego\n\n```\n\n**Verification:**\n```bash\nwitness verify \\\n  --policy policy-signed.json \\\n  --publickey policy-key.pub \\\n  -a build-attestation.json \\\n  --subject <artifact>\n```\n"}]}
{"messages": [{"role": "system", "content": "You are an expert in the Witness supply chain attestation framework. You help users instrument CI/CD pipelines with witness, create policy documents, and write Rego policies to validate attestations. You understand all attestors in go-witness and how to use them effectively."}, {"role": "user", "content": "How do I create a witness policy for a build step that uses these attestors: product, github, material?"}, {"role": "assistant", "content": "Here's a complete witness policy for your build step with product, github, material attestors:\n\n**Policy Document:**\n```json\n{\n  \"expires\": \"2026-11-08T10:52:59Z\",\n  \"publickeys\": {\n    \"build-key\": {\n      \"keyid\": \"sha256:b6eb9873add57524514542a6e1dbb2d031bc00c182342618214b886c3b23cae3\",\n      \"key\": \"-----BEGIN PUBLIC KEY-----\\n...\\n-----END PUBLIC KEY-----\"\n    }\n  },\n  \"steps\": {\n    \"build\": {\n      \"name\": \"build\",\n      \"attestations\": [\n        {\n          \"type\": \"https://witness.dev/attestations/product/v0.1\"\n        },\n        {\n          \"type\": \"https://witness.dev/attestations/github/v0.1\"\n        },\n        {\n          \"type\": \"https://witness.dev/attestations/material/v0.1\"\n        }\n      ],\n      \"functionaries\": [\n        {\n          \"type\": \"publickey\",\n          \"publickeyid\": \"build-key\"\n        }\n      ]\n    }\n  }\n}\n```\n\n**Witness Run Command:**\n```bash\nwitness run --step build \\\n  --attestations product,github,material \\\n  --outfile build-attestation.json \\\n  --key signing-key.pem \\\n  -- <your-build-command>\n```\n\n**Rego Validation Rules:**\n```rego\n\n```\n\n**Verification:**\n```bash\nwitness verify \\\n  --policy policy-signed.json \\\n  --publickey policy-key.pub \\\n  -a build-attestation.json \\\n  --subject <artifact>\n```\n"}]}
{"messages": [{"role": "system", "content": "You are an expert in the Witness supply chain attestation framework. You help users instrument CI/CD pipelines with witness, create policy documents, and write Rego policies to validate attestations. You understand all attestors in go-witness and how to use them effectively."}, {"role": "user", "content": "How do I create a multi-step witness policy for a build \u2192 test \u2192 package pipeline?"}, {"role": "assistant", "content": "Here's a complete multi-step witness policy for your pipeline:\n\n**Policy Document:**\n```json\n{\n  \"expires\": \"2026-11-08T10:52:59Z\",\n  \"publickeys\": {\n    \"ci-key\": {\n      \"keyid\": \"sha256:b3d9d8e7ab30beedff6d48a31501668797aa5dea40cd3d1917e83c0053843f00\",\n      \"key\": \"-----BEGIN PUBLIC KEY-----\\n...\\n-----END PUBLIC KEY-----\"\n    }\n  },\n  \"steps\": {\n    \"build\": {\n      \"name\": \"build\",\n      \"attestations\": [\n        {\n          \"type\": \"https://witness.dev/attestations/git/v0.1\"\n        },\n        {\n          \"type\": \"https://witness.dev/attestations/command-run/v0.1\"\n        },\n        {\n          \"type\": \"https://witness.dev/attestations/product/v0.1\"\n        }\n      ],\n      \"functionaries\": [\n        {\n          \"type\": \"publickey\",\n          \"publickeyid\": \"ci-key\"\n        }\n      ]\n    },\n    \"test\": {\n      \"name\": \"test\",\n      \"attestations\": [\n        {\n          \"type\": \"https://witness.dev/attestations/material/v0.1\"\n        },\n        {\n          \"type\": \"https://witness.dev/attestations/command-run/v0.1\"\n        }\n      ],\n      \"functionaries\": [\n        {\n          \"type\": \"publickey\",\n          \"publickeyid\": \"ci-key\"\n        }\n      ]\n    },\n    \"package\": {\n      \"name\": \"package\",\n      \"attestations\": [\n        {\n          \"type\": \"https://witness.dev/attestations/material/v0.1\"\n        },\n        {\n          \"type\": \"https://witness.dev/attestations/product/v0.1\"\n        }\n      ],\n      \"functionaries\": [\n        {\n          \"type\": \"publickey\",\n          \"publickeyid\": \"ci-key\"\n        }\n      ]\n    }\n  }\n}\n```\n\n**Pipeline Commands:**\n\n```bash\n# Step 1: Build\nwitness run --step build \\\n  --attestations git,commandrun,product \\\n  -o build.json --key ci-key.pem \\\n  -- go build -o myapp\n\n# Step 2: Test\nwitness run --step test \\\n  --attestations material,commandrun \\\n  -o test.json --key ci-key.pem \\\n  -- go test ./...\n\n# Step 3: Package\nwitness run --step package \\\n  --attestations material,product \\\n  -o package.json --key ci-key.pem \\\n  -- tar czf myapp.tar.gz myapp\n\n# Verify entire pipeline\nwitness verify \\\n  --policy policy-signed.json \\\n  --publickey policy-key.pub \\\n  -a build.json -a test.json -a package.json\n```\n"}]}
{"messages": [{"role": "system", "content": "You are an expert in the Witness supply chain attestation framework. You help users instrument CI/CD pipelines with witness, create policy documents, and write Rego policies to validate attestations. You understand all attestors in go-witness and how to use them effectively."}, {"role": "user", "content": "How do I create a witness policy for a build step that uses these attestors: git?"}, {"role": "assistant", "content": "Here's a complete witness policy for your build step with git attestors:\n\n**Policy Document:**\n```json\n{\n  \"expires\": \"2026-11-08T10:52:59Z\",\n  \"publickeys\": {\n    \"build-key\": {\n      \"keyid\": \"sha256:111994f588e465028d07e75f67939f608c552e5ceb398d8fba906caf67d06ef9\",\n      \"key\": \"-----BEGIN PUBLIC KEY-----\\n...\\n-----END PUBLIC KEY-----\"\n    }\n  },\n  \"steps\": {\n    \"build\": {\n      \"name\": \"build\",\n      \"attestations\": [\n        {\n          \"type\": \"https://witness.dev/attestations/git/v0.1\"\n        }\n      ],\n      \"functionaries\": [\n        {\n          \"type\": \"publickey\",\n          \"publickeyid\": \"build-key\"\n        }\n      ]\n    }\n  }\n}\n```\n\n**Witness Run Command:**\n```bash\nwitness run --step build \\\n  --attestations git \\\n  --outfile build-attestation.json \\\n  --key signing-key.pem \\\n  -- <your-build-command>\n```\n\n**Rego Validation Rules:**\n```rego\npackage git\n\nimport rego.v1\n\n# Enforce builds from specific branch\ndeny contains msg if {\n    input.branch != \"feature/api\"\n    msg := sprintf(\"Must build from feature/api branch, got: %s\", [input.branch])\n}\n\n# Require clean working directory\ndeny contains msg if {\n    count(input.status) > 0\n    msg := \"Working directory must be clean (no uncommitted changes)\"\n}\n\n# Validate commit author\napproved_authors := {\n    \"alice.smith@example.com\",\n    \"bob.jones@company.com\",\n    \"ci-bot@company.com\"\n}\n\ndeny contains msg if {\n    not input.authoremail in approved_authors\n    msg := sprintf(\"Unauthorized commit author: %s\", [input.authoremail])\n}\n```\n\n**Verification:**\n```bash\nwitness verify \\\n  --policy policy-signed.json \\\n  --publickey policy-key.pub \\\n  -a build-attestation.json \\\n  --subject <artifact>\n```\n"}]}
{"messages": [{"role": "system", "content": "You are an expert in the Witness supply chain attestation framework. You help users instrument CI/CD pipelines with witness, create policy documents, and write Rego policies to validate attestations. You understand all attestors in go-witness and how to use them effectively."}, {"role": "user", "content": "How do I create a multi-step witness policy for a build \u2192 test \u2192 package pipeline?"}, {"role": "assistant", "content": "Here's a complete multi-step witness policy for your pipeline:\n\n**Policy Document:**\n```json\n{\n  \"expires\": \"2026-11-08T10:52:59Z\",\n  \"publickeys\": {\n    \"ci-key\": {\n      \"keyid\": \"sha256:3a587f6f9f503de07dd5b8922191f7cf9439045e5898f6596629e4371cccccce\",\n      \"key\": \"-----BEGIN PUBLIC KEY-----\\n...\\n-----END PUBLIC KEY-----\"\n    }\n  },\n  \"steps\": {\n    \"build\": {\n      \"name\": \"build\",\n      \"attestations\": [\n        {\n          \"type\": \"https://witness.dev/attestations/git/v0.1\"\n        },\n        {\n          \"type\": \"https://witness.dev/attestations/command-run/v0.1\"\n        },\n        {\n          \"type\": \"https://witness.dev/attestations/product/v0.1\"\n        }\n      ],\n      \"functionaries\": [\n        {\n          \"type\": \"publickey\",\n          \"publickeyid\": \"ci-key\"\n        }\n      ]\n    },\n    \"test\": {\n      \"name\": \"test\",\n      \"attestations\": [\n        {\n          \"type\": \"https://witness.dev/attestations/material/v0.1\"\n        },\n        {\n          \"type\": \"https://witness.dev/attestations/command-run/v0.1\"\n        }\n      ],\n      \"functionaries\": [\n        {\n          \"type\": \"publickey\",\n          \"publickeyid\": \"ci-key\"\n        }\n      ]\n    },\n    \"package\": {\n      \"name\": \"package\",\n      \"attestations\": [\n        {\n          \"type\": \"https://witness.dev/attestations/material/v0.1\"\n        },\n        {\n          \"type\": \"https://witness.dev/attestations/product/v0.1\"\n        }\n      ],\n      \"functionaries\": [\n        {\n          \"type\": \"publickey\",\n          \"publickeyid\": \"ci-key\"\n        }\n      ]\n    }\n  }\n}\n```\n\n**Pipeline Commands:**\n\n```bash\n# Step 1: Build\nwitness run --step build \\\n  --attestations git,commandrun,product \\\n  -o build.json --key ci-key.pem \\\n  -- go build -o myapp\n\n# Step 2: Test\nwitness run --step test \\\n  --attestations material,commandrun \\\n  -o test.json --key ci-key.pem \\\n  -- go test ./...\n\n# Step 3: Package\nwitness run --step package \\\n  --attestations material,product \\\n  -o package.json --key ci-key.pem \\\n  -- tar czf myapp.tar.gz myapp\n\n# Verify entire pipeline\nwitness verify \\\n  --policy policy-signed.json \\\n  --publickey policy-key.pub \\\n  -a build.json -a test.json -a package.json\n```\n"}]}
{"messages": [{"role": "system", "content": "You are an expert in the Witness supply chain attestation framework. You help users instrument CI/CD pipelines with witness, create policy documents, and write Rego policies to validate attestations. You understand all attestors in go-witness and how to use them effectively."}, {"role": "user", "content": "How do I create a multi-step witness policy for a build \u2192 test \u2192 package pipeline?"}, {"role": "assistant", "content": "Here's a complete multi-step witness policy for your pipeline:\n\n**Policy Document:**\n```json\n{\n  \"expires\": \"2026-11-08T10:52:59Z\",\n  \"publickeys\": {\n    \"ci-key\": {\n      \"keyid\": \"sha256:b489dd60a3043051568045fa5f6913a47ce29c1e77a784880d591a0c80722738\",\n      \"key\": \"-----BEGIN PUBLIC KEY-----\\n...\\n-----END PUBLIC KEY-----\"\n    }\n  },\n  \"steps\": {\n    \"build\": {\n      \"name\": \"build\",\n      \"attestations\": [\n        {\n          \"type\": \"https://witness.dev/attestations/git/v0.1\"\n        },\n        {\n          \"type\": \"https://witness.dev/attestations/command-run/v0.1\"\n        },\n        {\n          \"type\": \"https://witness.dev/attestations/product/v0.1\"\n        }\n      ],\n      \"functionaries\": [\n        {\n          \"type\": \"publickey\",\n          \"publickeyid\": \"ci-key\"\n        }\n      ]\n    },\n    \"test\": {\n      \"name\": \"test\",\n      \"attestations\": [\n        {\n          \"type\": \"https://witness.dev/attestations/material/v0.1\"\n        },\n        {\n          \"type\": \"https://witness.dev/attestations/command-run/v0.1\"\n        }\n      ],\n      \"functionaries\": [\n        {\n          \"type\": \"publickey\",\n          \"publickeyid\": \"ci-key\"\n        }\n      ]\n    },\n    \"package\": {\n      \"name\": \"package\",\n      \"attestations\": [\n        {\n          \"type\": \"https://witness.dev/attestations/material/v0.1\"\n        },\n        {\n          \"type\": \"https://witness.dev/attestations/product/v0.1\"\n        }\n      ],\n      \"functionaries\": [\n        {\n          \"type\": \"publickey\",\n          \"publickeyid\": \"ci-key\"\n        }\n      ]\n    }\n  }\n}\n```\n\n**Pipeline Commands:**\n\n```bash\n# Step 1: Build\nwitness run --step build \\\n  --attestations git,commandrun,product \\\n  -o build.json --key ci-key.pem \\\n  -- go build -o myapp\n\n# Step 2: Test\nwitness run --step test \\\n  --attestations material,commandrun \\\n  -o test.json --key ci-key.pem \\\n  -- go test ./...\n\n# Step 3: Package\nwitness run --step package \\\n  --attestations material,product \\\n  -o package.json --key ci-key.pem \\\n  -- tar czf myapp.tar.gz myapp\n\n# Verify entire pipeline\nwitness verify \\\n  --policy policy-signed.json \\\n  --publickey policy-key.pub \\\n  -a build.json -a test.json -a package.json\n```\n"}]}
{"messages": [{"role": "system", "content": "You are an expert in the Witness supply chain attestation framework. You help users instrument CI/CD pipelines with witness, create policy documents, and write Rego policies to validate attestations. You understand all attestors in go-witness and how to use them effectively."}, {"role": "user", "content": "How do I create a multi-step witness policy for a build \u2192 test \u2192 package pipeline?"}, {"role": "assistant", "content": "Here's a complete multi-step witness policy for your pipeline:\n\n**Policy Document:**\n```json\n{\n  \"expires\": \"2026-11-08T10:52:59Z\",\n  \"publickeys\": {\n    \"ci-key\": {\n      \"keyid\": \"sha256:7be4d5bef4608c94e02cea8737d3501da9b55c2cfbab4b54d2e9d2f8939aa3fa\",\n      \"key\": \"-----BEGIN PUBLIC KEY-----\\n...\\n-----END PUBLIC KEY-----\"\n    }\n  },\n  \"steps\": {\n    \"build\": {\n      \"name\": \"build\",\n      \"attestations\": [\n        {\n          \"type\": \"https://witness.dev/attestations/git/v0.1\"\n        },\n        {\n          \"type\": \"https://witness.dev/attestations/command-run/v0.1\"\n        },\n        {\n          \"type\": \"https://witness.dev/attestations/product/v0.1\"\n        }\n      ],\n      \"functionaries\": [\n        {\n          \"type\": \"publickey\",\n          \"publickeyid\": \"ci-key\"\n        }\n      ]\n    },\n    \"test\": {\n      \"name\": \"test\",\n      \"attestations\": [\n        {\n          \"type\": \"https://witness.dev/attestations/material/v0.1\"\n        },\n        {\n          \"type\": \"https://witness.dev/attestations/command-run/v0.1\"\n        }\n      ],\n      \"functionaries\": [\n        {\n          \"type\": \"publickey\",\n          \"publickeyid\": \"ci-key\"\n        }\n      ]\n    },\n    \"package\": {\n      \"name\": \"package\",\n      \"attestations\": [\n        {\n          \"type\": \"https://witness.dev/attestations/material/v0.1\"\n        },\n        {\n          \"type\": \"https://witness.dev/attestations/product/v0.1\"\n        }\n      ],\n      \"functionaries\": [\n        {\n          \"type\": \"publickey\",\n          \"publickeyid\": \"ci-key\"\n        }\n      ]\n    }\n  }\n}\n```\n\n**Pipeline Commands:**\n\n```bash\n# Step 1: Build\nwitness run --step build \\\n  --attestations git,commandrun,product \\\n  -o build.json --key ci-key.pem \\\n  -- go build -o myapp\n\n# Step 2: Test\nwitness run --step test \\\n  --attestations material,commandrun \\\n  -o test.json --key ci-key.pem \\\n  -- go test ./...\n\n# Step 3: Package\nwitness run --step package \\\n  --attestations material,product \\\n  -o package.json --key ci-key.pem \\\n  -- tar czf myapp.tar.gz myapp\n\n# Verify entire pipeline\nwitness verify \\\n  --policy policy-signed.json \\\n  --publickey policy-key.pub \\\n  -a build.json -a test.json -a package.json\n```\n"}]}
{"messages": [{"role": "system", "content": "You are an expert in the Witness supply chain attestation framework. You help users instrument CI/CD pipelines with witness, create policy documents, and write Rego policies to validate attestations. You understand all attestors in go-witness and how to use them effectively."}, {"role": "user", "content": "How do I create a witness policy for a build step that uses these attestors: product?"}, {"role": "assistant", "content": "Here's a complete witness policy for your build step with product attestors:\n\n**Policy Document:**\n```json\n{\n  \"expires\": \"2026-11-08T10:52:59Z\",\n  \"publickeys\": {\n    \"build-key\": {\n      \"keyid\": \"sha256:165fe9c13c636c54c3ee0ea5f955cee938604c92770c65cd7bc3bfcf83d001cf\",\n      \"key\": \"-----BEGIN PUBLIC KEY-----\\n...\\n-----END PUBLIC KEY-----\"\n    }\n  },\n  \"steps\": {\n    \"build\": {\n      \"name\": \"build\",\n      \"attestations\": [\n        {\n          \"type\": \"https://witness.dev/attestations/product/v0.1\"\n        }\n      ],\n      \"functionaries\": [\n        {\n          \"type\": \"publickey\",\n          \"publickeyid\": \"build-key\"\n        }\n      ]\n    }\n  }\n}\n```\n\n**Witness Run Command:**\n```bash\nwitness run --step build \\\n  --attestations product \\\n  --outfile build-attestation.json \\\n  --key signing-key.pem \\\n  -- <your-build-command>\n```\n\n**Rego Validation Rules:**\n```rego\n\n```\n\n**Verification:**\n```bash\nwitness verify \\\n  --policy policy-signed.json \\\n  --publickey policy-key.pub \\\n  -a build-attestation.json \\\n  --subject <artifact>\n```\n"}]}
{"messages": [{"role": "system", "content": "You are an expert in the Witness supply chain attestation framework. You help users instrument CI/CD pipelines with witness, create policy documents, and write Rego policies to validate attestations. You understand all attestors in go-witness and how to use them effectively."}, {"role": "user", "content": "How do I create a witness policy for a build step that uses these attestors: commandrun, environment, github, git?"}, {"role": "assistant", "content": "Here's a complete witness policy for your build step with commandrun, environment, github, git attestors:\n\n**Policy Document:**\n```json\n{\n  \"expires\": \"2026-11-08T10:52:59Z\",\n  \"publickeys\": {\n    \"build-key\": {\n      \"keyid\": \"sha256:e5c9c8c163cba6e2b930a7be0646f4088b2e718358b9d49b2aaa7cf4e2e4e036\",\n      \"key\": \"-----BEGIN PUBLIC KEY-----\\n...\\n-----END PUBLIC KEY-----\"\n    }\n  },\n  \"steps\": {\n    \"build\": {\n      \"name\": \"build\",\n      \"attestations\": [\n        {\n          \"type\": \"https://witness.dev/attestations/command-run/v0.1\"\n        },\n        {\n          \"type\": \"https://witness.dev/attestations/environment/v0.1\"\n        },\n        {\n          \"type\": \"https://witness.dev/attestations/github/v0.1\"\n        },\n        {\n          \"type\": \"https://witness.dev/attestations/git/v0.1\"\n        }\n      ],\n      \"functionaries\": [\n        {\n          \"type\": \"publickey\",\n          \"publickeyid\": \"build-key\"\n        }\n      ]\n    }\n  }\n}\n```\n\n**Witness Run Command:**\n```bash\nwitness run --step build \\\n  --attestations commandrun,environment,github,git \\\n  --outfile build-attestation.json \\\n  --key signing-key.pem \\\n  -- <your-build-command>\n```\n\n**Rego Validation Rules:**\n```rego\n\n```\n\n**Verification:**\n```bash\nwitness verify \\\n  --policy policy-signed.json \\\n  --publickey policy-key.pub \\\n  -a build-attestation.json \\\n  --subject <artifact>\n```\n"}]}
{"messages": [{"role": "system", "content": "You are an expert in the Witness supply chain attestation framework. You help users instrument CI/CD pipelines with witness, create policy documents, and write Rego policies to validate attestations. You understand all attestors in go-witness and how to use them effectively."}, {"role": "user", "content": "How do I create a witness policy for a build step that uses these attestors: product?"}, {"role": "assistant", "content": "Here's a complete witness policy for your build step with product attestors:\n\n**Policy Document:**\n```json\n{\n  \"expires\": \"2026-11-08T10:52:59Z\",\n  \"publickeys\": {\n    \"build-key\": {\n      \"keyid\": \"sha256:27ac706d6ecbb14f88752117c3cbe9533d62d8472fc81980f10054e08223a922\",\n      \"key\": \"-----BEGIN PUBLIC KEY-----\\n...\\n-----END PUBLIC KEY-----\"\n    }\n  },\n  \"steps\": {\n    \"build\": {\n      \"name\": \"build\",\n      \"attestations\": [\n        {\n          \"type\": \"https://witness.dev/attestations/product/v0.1\"\n        }\n      ],\n      \"functionaries\": [\n        {\n          \"type\": \"publickey\",\n          \"publickeyid\": \"build-key\"\n        }\n      ]\n    }\n  }\n}\n```\n\n**Witness Run Command:**\n```bash\nwitness run --step build \\\n  --attestations product \\\n  --outfile build-attestation.json \\\n  --key signing-key.pem \\\n  -- <your-build-command>\n```\n\n**Rego Validation Rules:**\n```rego\n\n```\n\n**Verification:**\n```bash\nwitness verify \\\n  --policy policy-signed.json \\\n  --publickey policy-key.pub \\\n  -a build-attestation.json \\\n  --subject <artifact>\n```\n"}]}
{"messages": [{"role": "system", "content": "You are an expert in the Witness supply chain attestation framework. You help users instrument CI/CD pipelines with witness, create policy documents, and write Rego policies to validate attestations. You understand all attestors in go-witness and how to use them effectively."}, {"role": "user", "content": "How do I create a witness policy for a build step that uses these attestors: material, commandrun?"}, {"role": "assistant", "content": "Here's a complete witness policy for your build step with material, commandrun attestors:\n\n**Policy Document:**\n```json\n{\n  \"expires\": \"2026-11-08T10:52:59Z\",\n  \"publickeys\": {\n    \"build-key\": {\n      \"keyid\": \"sha256:6011b915cf3231e29fa9d5aa3110578ef7d8afe6a05d9de0c218cb575acf3f62\",\n      \"key\": \"-----BEGIN PUBLIC KEY-----\\n...\\n-----END PUBLIC KEY-----\"\n    }\n  },\n  \"steps\": {\n    \"build\": {\n      \"name\": \"build\",\n      \"attestations\": [\n        {\n          \"type\": \"https://witness.dev/attestations/material/v0.1\"\n        },\n        {\n          \"type\": \"https://witness.dev/attestations/command-run/v0.1\"\n        }\n      ],\n      \"functionaries\": [\n        {\n          \"type\": \"publickey\",\n          \"publickeyid\": \"build-key\"\n        }\n      ]\n    }\n  }\n}\n```\n\n**Witness Run Command:**\n```bash\nwitness run --step build \\\n  --attestations material,commandrun \\\n  --outfile build-attestation.json \\\n  --key signing-key.pem \\\n  -- <your-build-command>\n```\n\n**Rego Validation Rules:**\n```rego\n\n```\n\n**Verification:**\n```bash\nwitness verify \\\n  --policy policy-signed.json \\\n  --publickey policy-key.pub \\\n  -a build-attestation.json \\\n  --subject <artifact>\n```\n"}]}
{"messages": [{"role": "system", "content": "You are an expert in the Witness supply chain attestation framework. You help users instrument CI/CD pipelines with witness, create policy documents, and write Rego policies to validate attestations. You understand all attestors in go-witness and how to use them effectively."}, {"role": "user", "content": "How do I create a witness policy for a build step that uses these attestors: material, commandrun, product, environment?"}, {"role": "assistant", "content": "Here's a complete witness policy for your build step with material, commandrun, product, environment attestors:\n\n**Policy Document:**\n```json\n{\n  \"expires\": \"2026-11-08T10:52:59Z\",\n  \"publickeys\": {\n    \"build-key\": {\n      \"keyid\": \"sha256:4397a64be5493e54ee7291c503c7b320e6251b86d862b83d4a549ce8f3cd457e\",\n      \"key\": \"-----BEGIN PUBLIC KEY-----\\n...\\n-----END PUBLIC KEY-----\"\n    }\n  },\n  \"steps\": {\n    \"build\": {\n      \"name\": \"build\",\n      \"attestations\": [\n        {\n          \"type\": \"https://witness.dev/attestations/material/v0.1\"\n        },\n        {\n          \"type\": \"https://witness.dev/attestations/command-run/v0.1\"\n        },\n        {\n          \"type\": \"https://witness.dev/attestations/product/v0.1\"\n        },\n        {\n          \"type\": \"https://witness.dev/attestations/environment/v0.1\"\n        }\n      ],\n      \"functionaries\": [\n        {\n          \"type\": \"publickey\",\n          \"publickeyid\": \"build-key\"\n        }\n      ]\n    }\n  }\n}\n```\n\n**Witness Run Command:**\n```bash\nwitness run --step build \\\n  --attestations material,commandrun,product,environment \\\n  --outfile build-attestation.json \\\n  --key signing-key.pem \\\n  -- <your-build-command>\n```\n\n**Rego Validation Rules:**\n```rego\n\n```\n\n**Verification:**\n```bash\nwitness verify \\\n  --policy policy-signed.json \\\n  --publickey policy-key.pub \\\n  -a build-attestation.json \\\n  --subject <artifact>\n```\n"}]}
{"messages": [{"role": "system", "content": "You are an expert in the Witness supply chain attestation framework. You help users instrument CI/CD pipelines with witness, create policy documents, and write Rego policies to validate attestations. You understand all attestors in go-witness and how to use them effectively."}, {"role": "user", "content": "How do I create a witness policy for a build step that uses these attestors: git, product?"}, {"role": "assistant", "content": "Here's a complete witness policy for your build step with git, product attestors:\n\n**Policy Document:**\n```json\n{\n  \"expires\": \"2026-11-08T10:52:59Z\",\n  \"publickeys\": {\n    \"build-key\": {\n      \"keyid\": \"sha256:0ff45a67c10dc44604c7f4b99b142501fc2c821301a1e1325bf35fcb85cdc123\",\n      \"key\": \"-----BEGIN PUBLIC KEY-----\\n...\\n-----END PUBLIC KEY-----\"\n    }\n  },\n  \"steps\": {\n    \"build\": {\n      \"name\": \"build\",\n      \"attestations\": [\n        {\n          \"type\": \"https://witness.dev/attestations/git/v0.1\"\n        },\n        {\n          \"type\": \"https://witness.dev/attestations/product/v0.1\"\n        }\n      ],\n      \"functionaries\": [\n        {\n          \"type\": \"publickey\",\n          \"publickeyid\": \"build-key\"\n        }\n      ]\n    }\n  }\n}\n```\n\n**Witness Run Command:**\n```bash\nwitness run --step build \\\n  --attestations git,product \\\n  --outfile build-attestation.json \\\n  --key signing-key.pem \\\n  -- <your-build-command>\n```\n\n**Rego Validation Rules:**\n```rego\npackage git\n\nimport rego.v1\n\n# Enforce builds from specific branch\ndeny contains msg if {\n    input.branch != \"develop\"\n    msg := sprintf(\"Must build from develop branch, got: %s\", [input.branch])\n}\n\n# Require clean working directory\ndeny contains msg if {\n    count(input.status) > 0\n    msg := \"Working directory must be clean (no uncommitted changes)\"\n}\n\n# Validate commit author\napproved_authors := {\n    \"alice.smith@example.com\",\n    \"bob.jones@company.com\",\n    \"ci-bot@company.com\"\n}\n\ndeny contains msg if {\n    not input.authoremail in approved_authors\n    msg := sprintf(\"Unauthorized commit author: %s\", [input.authoremail])\n}\n```\n\n**Verification:**\n```bash\nwitness verify \\\n  --policy policy-signed.json \\\n  --publickey policy-key.pub \\\n  -a build-attestation.json \\\n  --subject <artifact>\n```\n"}]}
{"messages": [{"role": "system", "content": "You are an expert in the Witness supply chain attestation framework. You help users instrument CI/CD pipelines with witness, create policy documents, and write Rego policies to validate attestations. You understand all attestors in go-witness and how to use them effectively."}, {"role": "user", "content": "How do I create a witness policy for a build step that uses these attestors: material, product, environment, github?"}, {"role": "assistant", "content": "Here's a complete witness policy for your build step with material, product, environment, github attestors:\n\n**Policy Document:**\n```json\n{\n  \"expires\": \"2026-11-08T10:52:59Z\",\n  \"publickeys\": {\n    \"build-key\": {\n      \"keyid\": \"sha256:d108341a693dcfc72879667f4d2b64a2dbeb5da8cda4b260e9a35e8c0cb67868\",\n      \"key\": \"-----BEGIN PUBLIC KEY-----\\n...\\n-----END PUBLIC KEY-----\"\n    }\n  },\n  \"steps\": {\n    \"build\": {\n      \"name\": \"build\",\n      \"attestations\": [\n        {\n          \"type\": \"https://witness.dev/attestations/material/v0.1\"\n        },\n        {\n          \"type\": \"https://witness.dev/attestations/product/v0.1\"\n        },\n        {\n          \"type\": \"https://witness.dev/attestations/environment/v0.1\"\n        },\n        {\n          \"type\": \"https://witness.dev/attestations/github/v0.1\"\n        }\n      ],\n      \"functionaries\": [\n        {\n          \"type\": \"publickey\",\n          \"publickeyid\": \"build-key\"\n        }\n      ]\n    }\n  }\n}\n```\n\n**Witness Run Command:**\n```bash\nwitness run --step build \\\n  --attestations material,product,environment,github \\\n  --outfile build-attestation.json \\\n  --key signing-key.pem \\\n  -- <your-build-command>\n```\n\n**Rego Validation Rules:**\n```rego\n\n```\n\n**Verification:**\n```bash\nwitness verify \\\n  --policy policy-signed.json \\\n  --publickey policy-key.pub \\\n  -a build-attestation.json \\\n  --subject <artifact>\n```\n"}]}
{"messages": [{"role": "system", "content": "You are an expert in the Witness supply chain attestation framework. You help users instrument CI/CD pipelines with witness, create policy documents, and write Rego policies to validate attestations. You understand all attestors in go-witness and how to use them effectively."}, {"role": "user", "content": "How do I create a witness policy for a build step that uses these attestors: product, environment?"}, {"role": "assistant", "content": "Here's a complete witness policy for your build step with product, environment attestors:\n\n**Policy Document:**\n```json\n{\n  \"expires\": \"2026-11-08T10:52:59Z\",\n  \"publickeys\": {\n    \"build-key\": {\n      \"keyid\": \"sha256:c3263c11bb36df0749e063f349c962729e3858ec491c8aaad4e8a31ff042db4e\",\n      \"key\": \"-----BEGIN PUBLIC KEY-----\\n...\\n-----END PUBLIC KEY-----\"\n    }\n  },\n  \"steps\": {\n    \"build\": {\n      \"name\": \"build\",\n      \"attestations\": [\n        {\n          \"type\": \"https://witness.dev/attestations/product/v0.1\"\n        },\n        {\n          \"type\": \"https://witness.dev/attestations/environment/v0.1\"\n        }\n      ],\n      \"functionaries\": [\n        {\n          \"type\": \"publickey\",\n          \"publickeyid\": \"build-key\"\n        }\n      ]\n    }\n  }\n}\n```\n\n**Witness Run Command:**\n```bash\nwitness run --step build \\\n  --attestations product,environment \\\n  --outfile build-attestation.json \\\n  --key signing-key.pem \\\n  -- <your-build-command>\n```\n\n**Rego Validation Rules:**\n```rego\n\n```\n\n**Verification:**\n```bash\nwitness verify \\\n  --policy policy-signed.json \\\n  --publickey policy-key.pub \\\n  -a build-attestation.json \\\n  --subject <artifact>\n```\n"}]}
{"messages": [{"role": "system", "content": "You are an expert in the Witness supply chain attestation framework. You help users instrument CI/CD pipelines with witness, create policy documents, and write Rego policies to validate attestations. You understand all attestors in go-witness and how to use them effectively."}, {"role": "user", "content": "How do I create a multi-step witness policy for a build \u2192 test \u2192 package pipeline?"}, {"role": "assistant", "content": "Here's a complete multi-step witness policy for your pipeline:\n\n**Policy Document:**\n```json\n{\n  \"expires\": \"2026-11-08T10:52:59Z\",\n  \"publickeys\": {\n    \"ci-key\": {\n      \"keyid\": \"sha256:5a96d9ed6cbcf70bdcd563077f1e36cb4e5401c7a098ec870f24e35c2fe55848\",\n      \"key\": \"-----BEGIN PUBLIC KEY-----\\n...\\n-----END PUBLIC KEY-----\"\n    }\n  },\n  \"steps\": {\n    \"build\": {\n      \"name\": \"build\",\n      \"attestations\": [\n        {\n          \"type\": \"https://witness.dev/attestations/git/v0.1\"\n        },\n        {\n          \"type\": \"https://witness.dev/attestations/command-run/v0.1\"\n        },\n        {\n          \"type\": \"https://witness.dev/attestations/product/v0.1\"\n        }\n      ],\n      \"functionaries\": [\n        {\n          \"type\": \"publickey\",\n          \"publickeyid\": \"ci-key\"\n        }\n      ]\n    },\n    \"test\": {\n      \"name\": \"test\",\n      \"attestations\": [\n        {\n          \"type\": \"https://witness.dev/attestations/material/v0.1\"\n        },\n        {\n          \"type\": \"https://witness.dev/attestations/command-run/v0.1\"\n        }\n      ],\n      \"functionaries\": [\n        {\n          \"type\": \"publickey\",\n          \"publickeyid\": \"ci-key\"\n        }\n      ]\n    },\n    \"package\": {\n      \"name\": \"package\",\n      \"attestations\": [\n        {\n          \"type\": \"https://witness.dev/attestations/material/v0.1\"\n        },\n        {\n          \"type\": \"https://witness.dev/attestations/product/v0.1\"\n        }\n      ],\n      \"functionaries\": [\n        {\n          \"type\": \"publickey\",\n          \"publickeyid\": \"ci-key\"\n        }\n      ]\n    }\n  }\n}\n```\n\n**Pipeline Commands:**\n\n```bash\n# Step 1: Build\nwitness run --step build \\\n  --attestations git,commandrun,product \\\n  -o build.json --key ci-key.pem \\\n  -- go build -o myapp\n\n# Step 2: Test\nwitness run --step test \\\n  --attestations material,commandrun \\\n  -o test.json --key ci-key.pem \\\n  -- go test ./...\n\n# Step 3: Package\nwitness run --step package \\\n  --attestations material,product \\\n  -o package.json --key ci-key.pem \\\n  -- tar czf myapp.tar.gz myapp\n\n# Verify entire pipeline\nwitness verify \\\n  --policy policy-signed.json \\\n  --publickey policy-key.pub \\\n  -a build.json -a test.json -a package.json\n```\n"}]}
{"messages": [{"role": "system", "content": "You are an expert in the Witness supply chain attestation framework. You help users instrument CI/CD pipelines with witness, create policy documents, and write Rego policies to validate attestations. You understand all attestors in go-witness and how to use them effectively."}, {"role": "user", "content": "How do I create a witness policy for a build step that uses these attestors: github, material, commandrun, product, git?"}, {"role": "assistant", "content": "Here's a complete witness policy for your build step with github, material, commandrun, product, git attestors:\n\n**Policy Document:**\n```json\n{\n  \"expires\": \"2026-11-08T10:52:59Z\",\n  \"publickeys\": {\n    \"build-key\": {\n      \"keyid\": \"sha256:995dbbb97f55e8411989e94f71c436773bb2820e1165dfa3ff343ed89eb59719\",\n      \"key\": \"-----BEGIN PUBLIC KEY-----\\n...\\n-----END PUBLIC KEY-----\"\n    }\n  },\n  \"steps\": {\n    \"build\": {\n      \"name\": \"build\",\n      \"attestations\": [\n        {\n          \"type\": \"https://witness.dev/attestations/github/v0.1\"\n        },\n        {\n          \"type\": \"https://witness.dev/attestations/material/v0.1\"\n        },\n        {\n          \"type\": \"https://witness.dev/attestations/command-run/v0.1\"\n        },\n        {\n          \"type\": \"https://witness.dev/attestations/product/v0.1\"\n        },\n        {\n          \"type\": \"https://witness.dev/attestations/git/v0.1\"\n        }\n      ],\n      \"functionaries\": [\n        {\n          \"type\": \"publickey\",\n          \"publickeyid\": \"build-key\"\n        }\n      ]\n    }\n  }\n}\n```\n\n**Witness Run Command:**\n```bash\nwitness run --step build \\\n  --attestations github,material,commandrun,product,git \\\n  --outfile build-attestation.json \\\n  --key signing-key.pem \\\n  -- <your-build-command>\n```\n\n**Rego Validation Rules:**\n```rego\n\n```\n\n**Verification:**\n```bash\nwitness verify \\\n  --policy policy-signed.json \\\n  --publickey policy-key.pub \\\n  -a build-attestation.json \\\n  --subject <artifact>\n```\n"}]}
{"messages": [{"role": "system", "content": "You are an expert in the Witness supply chain attestation framework. You help users instrument CI/CD pipelines with witness, create policy documents, and write Rego policies to validate attestations. You understand all attestors in go-witness and how to use them effectively."}, {"role": "user", "content": "How do I create a witness policy for a build step that uses these attestors: git, commandrun?"}, {"role": "assistant", "content": "Here's a complete witness policy for your build step with git, commandrun attestors:\n\n**Policy Document:**\n```json\n{\n  \"expires\": \"2026-11-08T10:52:59Z\",\n  \"publickeys\": {\n    \"build-key\": {\n      \"keyid\": \"sha256:6b6ff9e2c25b87ca4a31dd537156d34ab361c9b16f7b070245c98254509f0486\",\n      \"key\": \"-----BEGIN PUBLIC KEY-----\\n...\\n-----END PUBLIC KEY-----\"\n    }\n  },\n  \"steps\": {\n    \"build\": {\n      \"name\": \"build\",\n      \"attestations\": [\n        {\n          \"type\": \"https://witness.dev/attestations/git/v0.1\"\n        },\n        {\n          \"type\": \"https://witness.dev/attestations/command-run/v0.1\"\n        }\n      ],\n      \"functionaries\": [\n        {\n          \"type\": \"publickey\",\n          \"publickeyid\": \"build-key\"\n        }\n      ]\n    }\n  }\n}\n```\n\n**Witness Run Command:**\n```bash\nwitness run --step build \\\n  --attestations git,commandrun \\\n  --outfile build-attestation.json \\\n  --key signing-key.pem \\\n  -- <your-build-command>\n```\n\n**Rego Validation Rules:**\n```rego\npackage git\n\nimport rego.v1\n\n# Enforce builds from specific branch\ndeny contains msg if {\n    input.branch != \"feature/auth\"\n    msg := sprintf(\"Must build from feature/auth branch, got: %s\", [input.branch])\n}\n\n# Require clean working directory\ndeny contains msg if {\n    count(input.status) > 0\n    msg := \"Working directory must be clean (no uncommitted changes)\"\n}\n\n# Validate commit author\napproved_authors := {\n    \"alice.smith@example.com\",\n    \"bob.jones@company.com\",\n    \"ci-bot@company.com\"\n}\n\ndeny contains msg if {\n    not input.authoremail in approved_authors\n    msg := sprintf(\"Unauthorized commit author: %s\", [input.authoremail])\n}\n```\n\n**Verification:**\n```bash\nwitness verify \\\n  --policy policy-signed.json \\\n  --publickey policy-key.pub \\\n  -a build-attestation.json \\\n  --subject <artifact>\n```\n"}]}
{"messages": [{"role": "system", "content": "You are an expert in the Witness supply chain attestation framework. You help users instrument CI/CD pipelines with witness, create policy documents, and write Rego policies to validate attestations. You understand all attestors in go-witness and how to use them effectively."}, {"role": "user", "content": "How do I create a witness policy for a build step that uses these attestors: commandrun, git, environment?"}, {"role": "assistant", "content": "Here's a complete witness policy for your build step with commandrun, git, environment attestors:\n\n**Policy Document:**\n```json\n{\n  \"expires\": \"2026-11-08T10:52:59Z\",\n  \"publickeys\": {\n    \"build-key\": {\n      \"keyid\": \"sha256:bb2f1185d5cad263db58d5c549fbaf2c507901da514bfbebd090a9f9057ccf87\",\n      \"key\": \"-----BEGIN PUBLIC KEY-----\\n...\\n-----END PUBLIC KEY-----\"\n    }\n  },\n  \"steps\": {\n    \"build\": {\n      \"name\": \"build\",\n      \"attestations\": [\n        {\n          \"type\": \"https://witness.dev/attestations/command-run/v0.1\"\n        },\n        {\n          \"type\": \"https://witness.dev/attestations/git/v0.1\"\n        },\n        {\n          \"type\": \"https://witness.dev/attestations/environment/v0.1\"\n        }\n      ],\n      \"functionaries\": [\n        {\n          \"type\": \"publickey\",\n          \"publickeyid\": \"build-key\"\n        }\n      ]\n    }\n  }\n}\n```\n\n**Witness Run Command:**\n```bash\nwitness run --step build \\\n  --attestations commandrun,git,environment \\\n  --outfile build-attestation.json \\\n  --key signing-key.pem \\\n  -- <your-build-command>\n```\n\n**Rego Validation Rules:**\n```rego\n\n```\n\n**Verification:**\n```bash\nwitness verify \\\n  --policy policy-signed.json \\\n  --publickey policy-key.pub \\\n  -a build-attestation.json \\\n  --subject <artifact>\n```\n"}]}
{"messages": [{"role": "system", "content": "You are an expert in the Witness supply chain attestation framework. You help users instrument CI/CD pipelines with witness, create policy documents, and write Rego policies to validate attestations. You understand all attestors in go-witness and how to use them effectively."}, {"role": "user", "content": "How do I create a multi-step witness policy for a build \u2192 test \u2192 package pipeline?"}, {"role": "assistant", "content": "Here's a complete multi-step witness policy for your pipeline:\n\n**Policy Document:**\n```json\n{\n  \"expires\": \"2026-11-08T10:52:59Z\",\n  \"publickeys\": {\n    \"ci-key\": {\n      \"keyid\": \"sha256:86d673dd97ffc9d91175e27aec541667e01bd44adb539d5c80bf9a160aad1a2a\",\n      \"key\": \"-----BEGIN PUBLIC KEY-----\\n...\\n-----END PUBLIC KEY-----\"\n    }\n  },\n  \"steps\": {\n    \"build\": {\n      \"name\": \"build\",\n      \"attestations\": [\n        {\n          \"type\": \"https://witness.dev/attestations/git/v0.1\"\n        },\n        {\n          \"type\": \"https://witness.dev/attestations/command-run/v0.1\"\n        },\n        {\n          \"type\": \"https://witness.dev/attestations/product/v0.1\"\n        }\n      ],\n      \"functionaries\": [\n        {\n          \"type\": \"publickey\",\n          \"publickeyid\": \"ci-key\"\n        }\n      ]\n    },\n    \"test\": {\n      \"name\": \"test\",\n      \"attestations\": [\n        {\n          \"type\": \"https://witness.dev/attestations/material/v0.1\"\n        },\n        {\n          \"type\": \"https://witness.dev/attestations/command-run/v0.1\"\n        }\n      ],\n      \"functionaries\": [\n        {\n          \"type\": \"publickey\",\n          \"publickeyid\": \"ci-key\"\n        }\n      ]\n    },\n    \"package\": {\n      \"name\": \"package\",\n      \"attestations\": [\n        {\n          \"type\": \"https://witness.dev/attestations/material/v0.1\"\n        },\n        {\n          \"type\": \"https://witness.dev/attestations/product/v0.1\"\n        }\n      ],\n      \"functionaries\": [\n        {\n          \"type\": \"publickey\",\n          \"publickeyid\": \"ci-key\"\n        }\n      ]\n    }\n  }\n}\n```\n\n**Pipeline Commands:**\n\n```bash\n# Step 1: Build\nwitness run --step build \\\n  --attestations git,commandrun,product \\\n  -o build.json --key ci-key.pem \\\n  -- go build -o myapp\n\n# Step 2: Test\nwitness run --step test \\\n  --attestations material,commandrun \\\n  -o test.json --key ci-key.pem \\\n  -- go test ./...\n\n# Step 3: Package\nwitness run --step package \\\n  --attestations material,product \\\n  -o package.json --key ci-key.pem \\\n  -- tar czf myapp.tar.gz myapp\n\n# Verify entire pipeline\nwitness verify \\\n  --policy policy-signed.json \\\n  --publickey policy-key.pub \\\n  -a build.json -a test.json -a package.json\n```\n"}]}
{"messages": [{"role": "system", "content": "You are an expert in the Witness supply chain attestation framework. You help users instrument CI/CD pipelines with witness, create policy documents, and write Rego policies to validate attestations. You understand all attestors in go-witness and how to use them effectively."}, {"role": "user", "content": "How do I create a witness policy for a build step that uses these attestors: commandrun, environment?"}, {"role": "assistant", "content": "Here's a complete witness policy for your build step with commandrun, environment attestors:\n\n**Policy Document:**\n```json\n{\n  \"expires\": \"2026-11-08T10:52:59Z\",\n  \"publickeys\": {\n    \"build-key\": {\n      \"keyid\": \"sha256:e97fcfb920392c748fa0ad84f687cd4eaa1c4bcd6fe5c502d66c2fb4c483683a\",\n      \"key\": \"-----BEGIN PUBLIC KEY-----\\n...\\n-----END PUBLIC KEY-----\"\n    }\n  },\n  \"steps\": {\n    \"build\": {\n      \"name\": \"build\",\n      \"attestations\": [\n        {\n          \"type\": \"https://witness.dev/attestations/command-run/v0.1\"\n        },\n        {\n          \"type\": \"https://witness.dev/attestations/environment/v0.1\"\n        }\n      ],\n      \"functionaries\": [\n        {\n          \"type\": \"publickey\",\n          \"publickeyid\": \"build-key\"\n        }\n      ]\n    }\n  }\n}\n```\n\n**Witness Run Command:**\n```bash\nwitness run --step build \\\n  --attestations commandrun,environment \\\n  --outfile build-attestation.json \\\n  --key signing-key.pem \\\n  -- <your-build-command>\n```\n\n**Rego Validation Rules:**\n```rego\n\n```\n\n**Verification:**\n```bash\nwitness verify \\\n  --policy policy-signed.json \\\n  --publickey policy-key.pub \\\n  -a build-attestation.json \\\n  --subject <artifact>\n```\n"}]}
{"messages": [{"role": "system", "content": "You are an expert in the Witness supply chain attestation framework. You help users instrument CI/CD pipelines with witness, create policy documents, and write Rego policies to validate attestations. You understand all attestors in go-witness and how to use them effectively."}, {"role": "user", "content": "How do I create a witness policy for a build step that uses these attestors: commandrun, product, github?"}, {"role": "assistant", "content": "Here's a complete witness policy for your build step with commandrun, product, github attestors:\n\n**Policy Document:**\n```json\n{\n  \"expires\": \"2026-11-08T10:52:59Z\",\n  \"publickeys\": {\n    \"build-key\": {\n      \"keyid\": \"sha256:7e3ba5a635db885c5b350de5b8bddb3c10eefc64e350e02c08498743e8552132\",\n      \"key\": \"-----BEGIN PUBLIC KEY-----\\n...\\n-----END PUBLIC KEY-----\"\n    }\n  },\n  \"steps\": {\n    \"build\": {\n      \"name\": \"build\",\n      \"attestations\": [\n        {\n          \"type\": \"https://witness.dev/attestations/command-run/v0.1\"\n        },\n        {\n          \"type\": \"https://witness.dev/attestations/product/v0.1\"\n        },\n        {\n          \"type\": \"https://witness.dev/attestations/github/v0.1\"\n        }\n      ],\n      \"functionaries\": [\n        {\n          \"type\": \"publickey\",\n          \"publickeyid\": \"build-key\"\n        }\n      ]\n    }\n  }\n}\n```\n\n**Witness Run Command:**\n```bash\nwitness run --step build \\\n  --attestations commandrun,product,github \\\n  --outfile build-attestation.json \\\n  --key signing-key.pem \\\n  -- <your-build-command>\n```\n\n**Rego Validation Rules:**\n```rego\n\n```\n\n**Verification:**\n```bash\nwitness verify \\\n  --policy policy-signed.json \\\n  --publickey policy-key.pub \\\n  -a build-attestation.json \\\n  --subject <artifact>\n```\n"}]}
{"messages": [{"role": "system", "content": "You are an expert in the Witness supply chain attestation framework. You help users instrument CI/CD pipelines with witness, create policy documents, and write Rego policies to validate attestations. You understand all attestors in go-witness and how to use them effectively."}, {"role": "user", "content": "How do I create a witness policy for a build step that uses these attestors: material, product, commandrun?"}, {"role": "assistant", "content": "Here's a complete witness policy for your build step with material, product, commandrun attestors:\n\n**Policy Document:**\n```json\n{\n  \"expires\": \"2026-11-08T10:52:59Z\",\n  \"publickeys\": {\n    \"build-key\": {\n      \"keyid\": \"sha256:e1f930300c06efef4b0b6394034c6e30cc828395ee58253725e758525afd82ea\",\n      \"key\": \"-----BEGIN PUBLIC KEY-----\\n...\\n-----END PUBLIC KEY-----\"\n    }\n  },\n  \"steps\": {\n    \"build\": {\n      \"name\": \"build\",\n      \"attestations\": [\n        {\n          \"type\": \"https://witness.dev/attestations/material/v0.1\"\n        },\n        {\n          \"type\": \"https://witness.dev/attestations/product/v0.1\"\n        },\n        {\n          \"type\": \"https://witness.dev/attestations/command-run/v0.1\"\n        }\n      ],\n      \"functionaries\": [\n        {\n          \"type\": \"publickey\",\n          \"publickeyid\": \"build-key\"\n        }\n      ]\n    }\n  }\n}\n```\n\n**Witness Run Command:**\n```bash\nwitness run --step build \\\n  --attestations material,product,commandrun \\\n  --outfile build-attestation.json \\\n  --key signing-key.pem \\\n  -- <your-build-command>\n```\n\n**Rego Validation Rules:**\n```rego\n\n```\n\n**Verification:**\n```bash\nwitness verify \\\n  --policy policy-signed.json \\\n  --publickey policy-key.pub \\\n  -a build-attestation.json \\\n  --subject <artifact>\n```\n"}]}
{"messages": [{"role": "system", "content": "You are an expert in the Witness supply chain attestation framework. You help users instrument CI/CD pipelines with witness, create policy documents, and write Rego policies to validate attestations. You understand all attestors in go-witness and how to use them effectively."}, {"role": "user", "content": "How do I create a multi-step witness policy for a build \u2192 test \u2192 package pipeline?"}, {"role": "assistant", "content": "Here's a complete multi-step witness policy for your pipeline:\n\n**Policy Document:**\n```json\n{\n  \"expires\": \"2026-11-08T10:52:59Z\",\n  \"publickeys\": {\n    \"ci-key\": {\n      \"keyid\": \"sha256:dbb78722782591b3ccf5da567651a0cf8017421c847b9e33053ca34dc04f763e\",\n      \"key\": \"-----BEGIN PUBLIC KEY-----\\n...\\n-----END PUBLIC KEY-----\"\n    }\n  },\n  \"steps\": {\n    \"build\": {\n      \"name\": \"build\",\n      \"attestations\": [\n        {\n          \"type\": \"https://witness.dev/attestations/git/v0.1\"\n        },\n        {\n          \"type\": \"https://witness.dev/attestations/command-run/v0.1\"\n        },\n        {\n          \"type\": \"https://witness.dev/attestations/product/v0.1\"\n        }\n      ],\n      \"functionaries\": [\n        {\n          \"type\": \"publickey\",\n          \"publickeyid\": \"ci-key\"\n        }\n      ]\n    },\n    \"test\": {\n      \"name\": \"test\",\n      \"attestations\": [\n        {\n          \"type\": \"https://witness.dev/attestations/material/v0.1\"\n        },\n        {\n          \"type\": \"https://witness.dev/attestations/command-run/v0.1\"\n        }\n      ],\n      \"functionaries\": [\n        {\n          \"type\": \"publickey\",\n          \"publickeyid\": \"ci-key\"\n        }\n      ]\n    },\n    \"package\": {\n      \"name\": \"package\",\n      \"attestations\": [\n        {\n          \"type\": \"https://witness.dev/attestations/material/v0.1\"\n        },\n        {\n          \"type\": \"https://witness.dev/attestations/product/v0.1\"\n        }\n      ],\n      \"functionaries\": [\n        {\n          \"type\": \"publickey\",\n          \"publickeyid\": \"ci-key\"\n        }\n      ]\n    }\n  }\n}\n```\n\n**Pipeline Commands:**\n\n```bash\n# Step 1: Build\nwitness run --step build \\\n  --attestations git,commandrun,product \\\n  -o build.json --key ci-key.pem \\\n  -- go build -o myapp\n\n# Step 2: Test\nwitness run --step test \\\n  --attestations material,commandrun \\\n  -o test.json --key ci-key.pem \\\n  -- go test ./...\n\n# Step 3: Package\nwitness run --step package \\\n  --attestations material,product \\\n  -o package.json --key ci-key.pem \\\n  -- tar czf myapp.tar.gz myapp\n\n# Verify entire pipeline\nwitness verify \\\n  --policy policy-signed.json \\\n  --publickey policy-key.pub \\\n  -a build.json -a test.json -a package.json\n```\n"}]}
{"messages": [{"role": "system", "content": "You are an expert in the Witness supply chain attestation framework. You help users instrument CI/CD pipelines with witness, create policy documents, and write Rego policies to validate attestations. You understand all attestors in go-witness and how to use them effectively."}, {"role": "user", "content": "How do I create a witness policy for a build step that uses these attestors: material, commandrun, github, git?"}, {"role": "assistant", "content": "Here's a complete witness policy for your build step with material, commandrun, github, git attestors:\n\n**Policy Document:**\n```json\n{\n  \"expires\": \"2026-11-08T10:52:59Z\",\n  \"publickeys\": {\n    \"build-key\": {\n      \"keyid\": \"sha256:812c2c7e59fc7a1e3ff03475ee0d1292b43a5b4da7b783a2fe3c41d357261660\",\n      \"key\": \"-----BEGIN PUBLIC KEY-----\\n...\\n-----END PUBLIC KEY-----\"\n    }\n  },\n  \"steps\": {\n    \"build\": {\n      \"name\": \"build\",\n      \"attestations\": [\n        {\n          \"type\": \"https://witness.dev/attestations/material/v0.1\"\n        },\n        {\n          \"type\": \"https://witness.dev/attestations/command-run/v0.1\"\n        },\n        {\n          \"type\": \"https://witness.dev/attestations/github/v0.1\"\n        },\n        {\n          \"type\": \"https://witness.dev/attestations/git/v0.1\"\n        }\n      ],\n      \"functionaries\": [\n        {\n          \"type\": \"publickey\",\n          \"publickeyid\": \"build-key\"\n        }\n      ]\n    }\n  }\n}\n```\n\n**Witness Run Command:**\n```bash\nwitness run --step build \\\n  --attestations material,commandrun,github,git \\\n  --outfile build-attestation.json \\\n  --key signing-key.pem \\\n  -- <your-build-command>\n```\n\n**Rego Validation Rules:**\n```rego\n\n```\n\n**Verification:**\n```bash\nwitness verify \\\n  --policy policy-signed.json \\\n  --publickey policy-key.pub \\\n  -a build-attestation.json \\\n  --subject <artifact>\n```\n"}]}
{"messages": [{"role": "system", "content": "You are an expert in the Witness supply chain attestation framework. You help users instrument CI/CD pipelines with witness, create policy documents, and write Rego policies to validate attestations. You understand all attestors in go-witness and how to use them effectively."}, {"role": "user", "content": "How do I create a witness policy for a build step that uses these attestors: commandrun, product?"}, {"role": "assistant", "content": "Here's a complete witness policy for your build step with commandrun, product attestors:\n\n**Policy Document:**\n```json\n{\n  \"expires\": \"2026-11-08T10:52:59Z\",\n  \"publickeys\": {\n    \"build-key\": {\n      \"keyid\": \"sha256:1b171bda3b6b5ae79723d11f392bae35cac37eef162c25f3af4813f83a51ff43\",\n      \"key\": \"-----BEGIN PUBLIC KEY-----\\n...\\n-----END PUBLIC KEY-----\"\n    }\n  },\n  \"steps\": {\n    \"build\": {\n      \"name\": \"build\",\n      \"attestations\": [\n        {\n          \"type\": \"https://witness.dev/attestations/command-run/v0.1\"\n        },\n        {\n          \"type\": \"https://witness.dev/attestations/product/v0.1\"\n        }\n      ],\n      \"functionaries\": [\n        {\n          \"type\": \"publickey\",\n          \"publickeyid\": \"build-key\"\n        }\n      ]\n    }\n  }\n}\n```\n\n**Witness Run Command:**\n```bash\nwitness run --step build \\\n  --attestations commandrun,product \\\n  --outfile build-attestation.json \\\n  --key signing-key.pem \\\n  -- <your-build-command>\n```\n\n**Rego Validation Rules:**\n```rego\n\n```\n\n**Verification:**\n```bash\nwitness verify \\\n  --policy policy-signed.json \\\n  --publickey policy-key.pub \\\n  -a build-attestation.json \\\n  --subject <artifact>\n```\n"}]}
{"messages": [{"role": "system", "content": "You are an expert in the Witness supply chain attestation framework. You help users instrument CI/CD pipelines with witness, create policy documents, and write Rego policies to validate attestations. You understand all attestors in go-witness and how to use them effectively."}, {"role": "user", "content": "How do I create a witness policy for a build step that uses these attestors: github, product, git?"}, {"role": "assistant", "content": "Here's a complete witness policy for your build step with github, product, git attestors:\n\n**Policy Document:**\n```json\n{\n  \"expires\": \"2026-11-08T10:52:59Z\",\n  \"publickeys\": {\n    \"build-key\": {\n      \"keyid\": \"sha256:64d4250612d9dc164d35c7db56f14443f1dccfc8b94a9faf2e5fcd56f98d1381\",\n      \"key\": \"-----BEGIN PUBLIC KEY-----\\n...\\n-----END PUBLIC KEY-----\"\n    }\n  },\n  \"steps\": {\n    \"build\": {\n      \"name\": \"build\",\n      \"attestations\": [\n        {\n          \"type\": \"https://witness.dev/attestations/github/v0.1\"\n        },\n        {\n          \"type\": \"https://witness.dev/attestations/product/v0.1\"\n        },\n        {\n          \"type\": \"https://witness.dev/attestations/git/v0.1\"\n        }\n      ],\n      \"functionaries\": [\n        {\n          \"type\": \"publickey\",\n          \"publickeyid\": \"build-key\"\n        }\n      ]\n    }\n  }\n}\n```\n\n**Witness Run Command:**\n```bash\nwitness run --step build \\\n  --attestations github,product,git \\\n  --outfile build-attestation.json \\\n  --key signing-key.pem \\\n  -- <your-build-command>\n```\n\n**Rego Validation Rules:**\n```rego\n\n```\n\n**Verification:**\n```bash\nwitness verify \\\n  --policy policy-signed.json \\\n  --publickey policy-key.pub \\\n  -a build-attestation.json \\\n  --subject <artifact>\n```\n"}]}
{"messages": [{"role": "system", "content": "You are an expert in the Witness supply chain attestation framework. You help users instrument CI/CD pipelines with witness, create policy documents, and write Rego policies to validate attestations. You understand all attestors in go-witness and how to use them effectively."}, {"role": "user", "content": "How do I create a witness policy for a build step that uses these attestors: material, git, github?"}, {"role": "assistant", "content": "Here's a complete witness policy for your build step with material, git, github attestors:\n\n**Policy Document:**\n```json\n{\n  \"expires\": \"2026-11-08T10:52:59Z\",\n  \"publickeys\": {\n    \"build-key\": {\n      \"keyid\": \"sha256:05f8f5abe287bc6cf66eefbfa4df7133221671b5f7676394fe868c28462fdffd\",\n      \"key\": \"-----BEGIN PUBLIC KEY-----\\n...\\n-----END PUBLIC KEY-----\"\n    }\n  },\n  \"steps\": {\n    \"build\": {\n      \"name\": \"build\",\n      \"attestations\": [\n        {\n          \"type\": \"https://witness.dev/attestations/material/v0.1\"\n        },\n        {\n          \"type\": \"https://witness.dev/attestations/git/v0.1\"\n        },\n        {\n          \"type\": \"https://witness.dev/attestations/github/v0.1\"\n        }\n      ],\n      \"functionaries\": [\n        {\n          \"type\": \"publickey\",\n          \"publickeyid\": \"build-key\"\n        }\n      ]\n    }\n  }\n}\n```\n\n**Witness Run Command:**\n```bash\nwitness run --step build \\\n  --attestations material,git,github \\\n  --outfile build-attestation.json \\\n  --key signing-key.pem \\\n  -- <your-build-command>\n```\n\n**Rego Validation Rules:**\n```rego\n\n```\n\n**Verification:**\n```bash\nwitness verify \\\n  --policy policy-signed.json \\\n  --publickey policy-key.pub \\\n  -a build-attestation.json \\\n  --subject <artifact>\n```\n"}]}
{"messages": [{"role": "system", "content": "You are an expert in the Witness supply chain attestation framework. You help users instrument CI/CD pipelines with witness, create policy documents, and write Rego policies to validate attestations. You understand all attestors in go-witness and how to use them effectively."}, {"role": "user", "content": "How do I create a multi-step witness policy for a build \u2192 test \u2192 package pipeline?"}, {"role": "assistant", "content": "Here's a complete multi-step witness policy for your pipeline:\n\n**Policy Document:**\n```json\n{\n  \"expires\": \"2026-11-08T10:52:59Z\",\n  \"publickeys\": {\n    \"ci-key\": {\n      \"keyid\": \"sha256:c75061692b029806c8b00da1cb3b6a8a7166a27a70e39b74771068cd81e58b42\",\n      \"key\": \"-----BEGIN PUBLIC KEY-----\\n...\\n-----END PUBLIC KEY-----\"\n    }\n  },\n  \"steps\": {\n    \"build\": {\n      \"name\": \"build\",\n      \"attestations\": [\n        {\n          \"type\": \"https://witness.dev/attestations/git/v0.1\"\n        },\n        {\n          \"type\": \"https://witness.dev/attestations/command-run/v0.1\"\n        },\n        {\n          \"type\": \"https://witness.dev/attestations/product/v0.1\"\n        }\n      ],\n      \"functionaries\": [\n        {\n          \"type\": \"publickey\",\n          \"publickeyid\": \"ci-key\"\n        }\n      ]\n    },\n    \"test\": {\n      \"name\": \"test\",\n      \"attestations\": [\n        {\n          \"type\": \"https://witness.dev/attestations/material/v0.1\"\n        },\n        {\n          \"type\": \"https://witness.dev/attestations/command-run/v0.1\"\n        }\n      ],\n      \"functionaries\": [\n        {\n          \"type\": \"publickey\",\n          \"publickeyid\": \"ci-key\"\n        }\n      ]\n    },\n    \"package\": {\n      \"name\": \"package\",\n      \"attestations\": [\n        {\n          \"type\": \"https://witness.dev/attestations/material/v0.1\"\n        },\n        {\n          \"type\": \"https://witness.dev/attestations/product/v0.1\"\n        }\n      ],\n      \"functionaries\": [\n        {\n          \"type\": \"publickey\",\n          \"publickeyid\": \"ci-key\"\n        }\n      ]\n    }\n  }\n}\n```\n\n**Pipeline Commands:**\n\n```bash\n# Step 1: Build\nwitness run --step build \\\n  --attestations git,commandrun,product \\\n  -o build.json --key ci-key.pem \\\n  -- go build -o myapp\n\n# Step 2: Test\nwitness run --step test \\\n  --attestations material,commandrun \\\n  -o test.json --key ci-key.pem \\\n  -- go test ./...\n\n# Step 3: Package\nwitness run --step package \\\n  --attestations material,product \\\n  -o package.json --key ci-key.pem \\\n  -- tar czf myapp.tar.gz myapp\n\n# Verify entire pipeline\nwitness verify \\\n  --policy policy-signed.json \\\n  --publickey policy-key.pub \\\n  -a build.json -a test.json -a package.json\n```\n"}]}
{"messages": [{"role": "system", "content": "You are an expert in the Witness supply chain attestation framework. You help users instrument CI/CD pipelines with witness, create policy documents, and write Rego policies to validate attestations. You understand all attestors in go-witness and how to use them effectively."}, {"role": "user", "content": "How do I create a witness policy for a build step that uses these attestors: git, product, github, material, environment?"}, {"role": "assistant", "content": "Here's a complete witness policy for your build step with git, product, github, material, environment attestors:\n\n**Policy Document:**\n```json\n{\n  \"expires\": \"2026-11-08T10:52:59Z\",\n  \"publickeys\": {\n    \"build-key\": {\n      \"keyid\": \"sha256:e52853d6dacea27ecbade33d4d7ac5c9e7d3a3ce88251d9ba1a0427b85cfb744\",\n      \"key\": \"-----BEGIN PUBLIC KEY-----\\n...\\n-----END PUBLIC KEY-----\"\n    }\n  },\n  \"steps\": {\n    \"build\": {\n      \"name\": \"build\",\n      \"attestations\": [\n        {\n          \"type\": \"https://witness.dev/attestations/git/v0.1\"\n        },\n        {\n          \"type\": \"https://witness.dev/attestations/product/v0.1\"\n        },\n        {\n          \"type\": \"https://witness.dev/attestations/github/v0.1\"\n        },\n        {\n          \"type\": \"https://witness.dev/attestations/material/v0.1\"\n        },\n        {\n          \"type\": \"https://witness.dev/attestations/environment/v0.1\"\n        }\n      ],\n      \"functionaries\": [\n        {\n          \"type\": \"publickey\",\n          \"publickeyid\": \"build-key\"\n        }\n      ]\n    }\n  }\n}\n```\n\n**Witness Run Command:**\n```bash\nwitness run --step build \\\n  --attestations git,product,github,material,environment \\\n  --outfile build-attestation.json \\\n  --key signing-key.pem \\\n  -- <your-build-command>\n```\n\n**Rego Validation Rules:**\n```rego\npackage git\n\nimport rego.v1\n\n# Enforce builds from specific branch\ndeny contains msg if {\n    input.branch != \"develop\"\n    msg := sprintf(\"Must build from develop branch, got: %s\", [input.branch])\n}\n\n# Require clean working directory\ndeny contains msg if {\n    count(input.status) > 0\n    msg := \"Working directory must be clean (no uncommitted changes)\"\n}\n\n# Validate commit author\napproved_authors := {\n    \"alice.smith@example.com\",\n    \"bob.jones@company.com\",\n    \"ci-bot@company.com\"\n}\n\ndeny contains msg if {\n    not input.authoremail in approved_authors\n    msg := sprintf(\"Unauthorized commit author: %s\", [input.authoremail])\n}\n```\n\n**Verification:**\n```bash\nwitness verify \\\n  --policy policy-signed.json \\\n  --publickey policy-key.pub \\\n  -a build-attestation.json \\\n  --subject <artifact>\n```\n"}]}
{"messages": [{"role": "system", "content": "You are an expert in the Witness supply chain attestation framework. You help users instrument CI/CD pipelines with witness, create policy documents, and write Rego policies to validate attestations. You understand all attestors in go-witness and how to use them effectively."}, {"role": "user", "content": "How do I create a witness policy for a build step that uses these attestors: git?"}, {"role": "assistant", "content": "Here's a complete witness policy for your build step with git attestors:\n\n**Policy Document:**\n```json\n{\n  \"expires\": \"2026-11-08T10:52:59Z\",\n  \"publickeys\": {\n    \"build-key\": {\n      \"keyid\": \"sha256:c639942a8ca277b8f9c4857a5e0806216cbeb1716e403143866ad7584a2fed86\",\n      \"key\": \"-----BEGIN PUBLIC KEY-----\\n...\\n-----END PUBLIC KEY-----\"\n    }\n  },\n  \"steps\": {\n    \"build\": {\n      \"name\": \"build\",\n      \"attestations\": [\n        {\n          \"type\": \"https://witness.dev/attestations/git/v0.1\"\n        }\n      ],\n      \"functionaries\": [\n        {\n          \"type\": \"publickey\",\n          \"publickeyid\": \"build-key\"\n        }\n      ]\n    }\n  }\n}\n```\n\n**Witness Run Command:**\n```bash\nwitness run --step build \\\n  --attestations git \\\n  --outfile build-attestation.json \\\n  --key signing-key.pem \\\n  -- <your-build-command>\n```\n\n**Rego Validation Rules:**\n```rego\npackage git\n\nimport rego.v1\n\n# Enforce builds from specific branch\ndeny contains msg if {\n    input.branch != \"bugfix/security\"\n    msg := sprintf(\"Must build from bugfix/security branch, got: %s\", [input.branch])\n}\n\n# Validate commit author\napproved_authors := {\n    \"alice.smith@example.com\",\n    \"bob.jones@company.com\",\n    \"ci-bot@company.com\"\n}\n\ndeny contains msg if {\n    not input.authoremail in approved_authors\n    msg := sprintf(\"Unauthorized commit author: %s\", [input.authoremail])\n}\n```\n\n**Verification:**\n```bash\nwitness verify \\\n  --policy policy-signed.json \\\n  --publickey policy-key.pub \\\n  -a build-attestation.json \\\n  --subject <artifact>\n```\n"}]}
{"messages": [{"role": "system", "content": "You are an expert in the Witness supply chain attestation framework. You help users instrument CI/CD pipelines with witness, create policy documents, and write Rego policies to validate attestations. You understand all attestors in go-witness and how to use them effectively."}, {"role": "user", "content": "How do I create a witness policy for a build step that uses these attestors: git, product?"}, {"role": "assistant", "content": "Here's a complete witness policy for your build step with git, product attestors:\n\n**Policy Document:**\n```json\n{\n  \"expires\": \"2026-11-08T10:52:59Z\",\n  \"publickeys\": {\n    \"build-key\": {\n      \"keyid\": \"sha256:4d3486a2234ed7fe551b3c66da18f0ce5c55dc33ebb3e1389ddc4ebc67b46911\",\n      \"key\": \"-----BEGIN PUBLIC KEY-----\\n...\\n-----END PUBLIC KEY-----\"\n    }\n  },\n  \"steps\": {\n    \"build\": {\n      \"name\": \"build\",\n      \"attestations\": [\n        {\n          \"type\": \"https://witness.dev/attestations/git/v0.1\"\n        },\n        {\n          \"type\": \"https://witness.dev/attestations/product/v0.1\"\n        }\n      ],\n      \"functionaries\": [\n        {\n          \"type\": \"publickey\",\n          \"publickeyid\": \"build-key\"\n        }\n      ]\n    }\n  }\n}\n```\n\n**Witness Run Command:**\n```bash\nwitness run --step build \\\n  --attestations git,product \\\n  --outfile build-attestation.json \\\n  --key signing-key.pem \\\n  -- <your-build-command>\n```\n\n**Rego Validation Rules:**\n```rego\npackage git\n\nimport rego.v1\n\n# Enforce builds from specific branch\ndeny contains msg if {\n    input.branch != \"bugfix/security\"\n    msg := sprintf(\"Must build from bugfix/security branch, got: %s\", [input.branch])\n}\n\n# Require clean working directory\ndeny contains msg if {\n    count(input.status) > 0\n    msg := \"Working directory must be clean (no uncommitted changes)\"\n}\n\n# Validate commit author\napproved_authors := {\n    \"alice.smith@example.com\",\n    \"bob.jones@company.com\",\n    \"ci-bot@company.com\"\n}\n\ndeny contains msg if {\n    not input.authoremail in approved_authors\n    msg := sprintf(\"Unauthorized commit author: %s\", [input.authoremail])\n}\n```\n\n**Verification:**\n```bash\nwitness verify \\\n  --policy policy-signed.json \\\n  --publickey policy-key.pub \\\n  -a build-attestation.json \\\n  --subject <artifact>\n```\n"}]}
{"messages": [{"role": "system", "content": "You are an expert in the Witness supply chain attestation framework. You help users instrument CI/CD pipelines with witness, create policy documents, and write Rego policies to validate attestations. You understand all attestors in go-witness and how to use them effectively."}, {"role": "user", "content": "How do I create a multi-step witness policy for a build \u2192 test \u2192 package pipeline?"}, {"role": "assistant", "content": "Here's a complete multi-step witness policy for your pipeline:\n\n**Policy Document:**\n```json\n{\n  \"expires\": \"2026-11-08T10:52:59Z\",\n  \"publickeys\": {\n    \"ci-key\": {\n      \"keyid\": \"sha256:dbef6845b17c728f74cef0aadd1b78f47ecbbb2d51293930e40af3370765d766\",\n      \"key\": \"-----BEGIN PUBLIC KEY-----\\n...\\n-----END PUBLIC KEY-----\"\n    }\n  },\n  \"steps\": {\n    \"build\": {\n      \"name\": \"build\",\n      \"attestations\": [\n        {\n          \"type\": \"https://witness.dev/attestations/git/v0.1\"\n        },\n        {\n          \"type\": \"https://witness.dev/attestations/command-run/v0.1\"\n        },\n        {\n          \"type\": \"https://witness.dev/attestations/product/v0.1\"\n        }\n      ],\n      \"functionaries\": [\n        {\n          \"type\": \"publickey\",\n          \"publickeyid\": \"ci-key\"\n        }\n      ]\n    },\n    \"test\": {\n      \"name\": \"test\",\n      \"attestations\": [\n        {\n          \"type\": \"https://witness.dev/attestations/material/v0.1\"\n        },\n        {\n          \"type\": \"https://witness.dev/attestations/command-run/v0.1\"\n        }\n      ],\n      \"functionaries\": [\n        {\n          \"type\": \"publickey\",\n          \"publickeyid\": \"ci-key\"\n        }\n      ]\n    },\n    \"package\": {\n      \"name\": \"package\",\n      \"attestations\": [\n        {\n          \"type\": \"https://witness.dev/attestations/material/v0.1\"\n        },\n        {\n          \"type\": \"https://witness.dev/attestations/product/v0.1\"\n        }\n      ],\n      \"functionaries\": [\n        {\n          \"type\": \"publickey\",\n          \"publickeyid\": \"ci-key\"\n        }\n      ]\n    }\n  }\n}\n```\n\n**Pipeline Commands:**\n\n```bash\n# Step 1: Build\nwitness run --step build \\\n  --attestations git,commandrun,product \\\n  -o build.json --key ci-key.pem \\\n  -- go build -o myapp\n\n# Step 2: Test\nwitness run --step test \\\n  --attestations material,commandrun \\\n  -o test.json --key ci-key.pem \\\n  -- go test ./...\n\n# Step 3: Package\nwitness run --step package \\\n  --attestations material,product \\\n  -o package.json --key ci-key.pem \\\n  -- tar czf myapp.tar.gz myapp\n\n# Verify entire pipeline\nwitness verify \\\n  --policy policy-signed.json \\\n  --publickey policy-key.pub \\\n  -a build.json -a test.json -a package.json\n```\n"}]}
{"messages": [{"role": "system", "content": "You are an expert in the Witness supply chain attestation framework. You help users instrument CI/CD pipelines with witness, create policy documents, and write Rego policies to validate attestations. You understand all attestors in go-witness and how to use them effectively."}, {"role": "user", "content": "How do I create a witness policy for a build step that uses these attestors: product, environment?"}, {"role": "assistant", "content": "Here's a complete witness policy for your build step with product, environment attestors:\n\n**Policy Document:**\n```json\n{\n  \"expires\": \"2026-11-08T10:52:59Z\",\n  \"publickeys\": {\n    \"build-key\": {\n      \"keyid\": \"sha256:6ef4763902314b4ff6f4771269765cfd112f72b1ba1a098f4d498924a21c27f4\",\n      \"key\": \"-----BEGIN PUBLIC KEY-----\\n...\\n-----END PUBLIC KEY-----\"\n    }\n  },\n  \"steps\": {\n    \"build\": {\n      \"name\": \"build\",\n      \"attestations\": [\n        {\n          \"type\": \"https://witness.dev/attestations/product/v0.1\"\n        },\n        {\n          \"type\": \"https://witness.dev/attestations/environment/v0.1\"\n        }\n      ],\n      \"functionaries\": [\n        {\n          \"type\": \"publickey\",\n          \"publickeyid\": \"build-key\"\n        }\n      ]\n    }\n  }\n}\n```\n\n**Witness Run Command:**\n```bash\nwitness run --step build \\\n  --attestations product,environment \\\n  --outfile build-attestation.json \\\n  --key signing-key.pem \\\n  -- <your-build-command>\n```\n\n**Rego Validation Rules:**\n```rego\n\n```\n\n**Verification:**\n```bash\nwitness verify \\\n  --policy policy-signed.json \\\n  --publickey policy-key.pub \\\n  -a build-attestation.json \\\n  --subject <artifact>\n```\n"}]}
{"messages": [{"role": "system", "content": "You are an expert in the Witness supply chain attestation framework. You help users instrument CI/CD pipelines with witness, create policy documents, and write Rego policies to validate attestations. You understand all attestors in go-witness and how to use them effectively."}, {"role": "user", "content": "How do I create a multi-step witness policy for a build \u2192 test \u2192 package pipeline?"}, {"role": "assistant", "content": "Here's a complete multi-step witness policy for your pipeline:\n\n**Policy Document:**\n```json\n{\n  \"expires\": \"2026-11-08T10:52:59Z\",\n  \"publickeys\": {\n    \"ci-key\": {\n      \"keyid\": \"sha256:7381972dafadd29c861ce99ed6d91af12fffadc83d421dca14a7d6064cc7b004\",\n      \"key\": \"-----BEGIN PUBLIC KEY-----\\n...\\n-----END PUBLIC KEY-----\"\n    }\n  },\n  \"steps\": {\n    \"build\": {\n      \"name\": \"build\",\n      \"attestations\": [\n        {\n          \"type\": \"https://witness.dev/attestations/git/v0.1\"\n        },\n        {\n          \"type\": \"https://witness.dev/attestations/command-run/v0.1\"\n        },\n        {\n          \"type\": \"https://witness.dev/attestations/product/v0.1\"\n        }\n      ],\n      \"functionaries\": [\n        {\n          \"type\": \"publickey\",\n          \"publickeyid\": \"ci-key\"\n        }\n      ]\n    },\n    \"test\": {\n      \"name\": \"test\",\n      \"attestations\": [\n        {\n          \"type\": \"https://witness.dev/attestations/material/v0.1\"\n        },\n        {\n          \"type\": \"https://witness.dev/attestations/command-run/v0.1\"\n        }\n      ],\n      \"functionaries\": [\n        {\n          \"type\": \"publickey\",\n          \"publickeyid\": \"ci-key\"\n        }\n      ]\n    },\n    \"package\": {\n      \"name\": \"package\",\n      \"attestations\": [\n        {\n          \"type\": \"https://witness.dev/attestations/material/v0.1\"\n        },\n        {\n          \"type\": \"https://witness.dev/attestations/product/v0.1\"\n        }\n      ],\n      \"functionaries\": [\n        {\n          \"type\": \"publickey\",\n          \"publickeyid\": \"ci-key\"\n        }\n      ]\n    }\n  }\n}\n```\n\n**Pipeline Commands:**\n\n```bash\n# Step 1: Build\nwitness run --step build \\\n  --attestations git,commandrun,product \\\n  -o build.json --key ci-key.pem \\\n  -- go build -o myapp\n\n# Step 2: Test\nwitness run --step test \\\n  --attestations material,commandrun \\\n  -o test.json --key ci-key.pem \\\n  -- go test ./...\n\n# Step 3: Package\nwitness run --step package \\\n  --attestations material,product \\\n  -o package.json --key ci-key.pem \\\n  -- tar czf myapp.tar.gz myapp\n\n# Verify entire pipeline\nwitness verify \\\n  --policy policy-signed.json \\\n  --publickey policy-key.pub \\\n  -a build.json -a test.json -a package.json\n```\n"}]}
{"messages": [{"role": "system", "content": "You are an expert in the Witness supply chain attestation framework. You help users instrument CI/CD pipelines with witness, create policy documents, and write Rego policies to validate attestations. You understand all attestors in go-witness and how to use them effectively."}, {"role": "user", "content": "How do I create a multi-step witness policy for a build \u2192 test \u2192 package pipeline?"}, {"role": "assistant", "content": "Here's a complete multi-step witness policy for your pipeline:\n\n**Policy Document:**\n```json\n{\n  \"expires\": \"2026-11-08T10:52:59Z\",\n  \"publickeys\": {\n    \"ci-key\": {\n      \"keyid\": \"sha256:2e298eb63ca8439cf2a687ab54dc57d49743a5f8b904a98e883a0dff67bf1105\",\n      \"key\": \"-----BEGIN PUBLIC KEY-----\\n...\\n-----END PUBLIC KEY-----\"\n    }\n  },\n  \"steps\": {\n    \"build\": {\n      \"name\": \"build\",\n      \"attestations\": [\n        {\n          \"type\": \"https://witness.dev/attestations/git/v0.1\"\n        },\n        {\n          \"type\": \"https://witness.dev/attestations/command-run/v0.1\"\n        },\n        {\n          \"type\": \"https://witness.dev/attestations/product/v0.1\"\n        }\n      ],\n      \"functionaries\": [\n        {\n          \"type\": \"publickey\",\n          \"publickeyid\": \"ci-key\"\n        }\n      ]\n    },\n    \"test\": {\n      \"name\": \"test\",\n      \"attestations\": [\n        {\n          \"type\": \"https://witness.dev/attestations/material/v0.1\"\n        },\n        {\n          \"type\": \"https://witness.dev/attestations/command-run/v0.1\"\n        }\n      ],\n      \"functionaries\": [\n        {\n          \"type\": \"publickey\",\n          \"publickeyid\": \"ci-key\"\n        }\n      ]\n    },\n    \"package\": {\n      \"name\": \"package\",\n      \"attestations\": [\n        {\n          \"type\": \"https://witness.dev/attestations/material/v0.1\"\n        },\n        {\n          \"type\": \"https://witness.dev/attestations/product/v0.1\"\n        }\n      ],\n      \"functionaries\": [\n        {\n          \"type\": \"publickey\",\n          \"publickeyid\": \"ci-key\"\n        }\n      ]\n    }\n  }\n}\n```\n\n**Pipeline Commands:**\n\n```bash\n# Step 1: Build\nwitness run --step build \\\n  --attestations git,commandrun,product \\\n  -o build.json --key ci-key.pem \\\n  -- go build -o myapp\n\n# Step 2: Test\nwitness run --step test \\\n  --attestations material,commandrun \\\n  -o test.json --key ci-key.pem \\\n  -- go test ./...\n\n# Step 3: Package\nwitness run --step package \\\n  --attestations material,product \\\n  -o package.json --key ci-key.pem \\\n  -- tar czf myapp.tar.gz myapp\n\n# Verify entire pipeline\nwitness verify \\\n  --policy policy-signed.json \\\n  --publickey policy-key.pub \\\n  -a build.json -a test.json -a package.json\n```\n"}]}
{"messages": [{"role": "system", "content": "You are an expert in the Witness supply chain attestation framework. You help users instrument CI/CD pipelines with witness, create policy documents, and write Rego policies to validate attestations. You understand all attestors in go-witness and how to use them effectively."}, {"role": "user", "content": "How do I create a witness policy for a build step that uses these attestors: commandrun?"}, {"role": "assistant", "content": "Here's a complete witness policy for your build step with commandrun attestors:\n\n**Policy Document:**\n```json\n{\n  \"expires\": \"2026-11-08T10:52:59Z\",\n  \"publickeys\": {\n    \"build-key\": {\n      \"keyid\": \"sha256:cd7a5ef90bb46e508557fe4bbc4e1572a09b56132889d673e3aa5e006b3f3a08\",\n      \"key\": \"-----BEGIN PUBLIC KEY-----\\n...\\n-----END PUBLIC KEY-----\"\n    }\n  },\n  \"steps\": {\n    \"build\": {\n      \"name\": \"build\",\n      \"attestations\": [\n        {\n          \"type\": \"https://witness.dev/attestations/command-run/v0.1\"\n        }\n      ],\n      \"functionaries\": [\n        {\n          \"type\": \"publickey\",\n          \"publickeyid\": \"build-key\"\n        }\n      ]\n    }\n  }\n}\n```\n\n**Witness Run Command:**\n```bash\nwitness run --step build \\\n  --attestations commandrun \\\n  --outfile build-attestation.json \\\n  --key signing-key.pem \\\n  -- <your-build-command>\n```\n\n**Rego Validation Rules:**\n```rego\n\n```\n\n**Verification:**\n```bash\nwitness verify \\\n  --policy policy-signed.json \\\n  --publickey policy-key.pub \\\n  -a build-attestation.json \\\n  --subject <artifact>\n```\n"}]}
{"messages": [{"role": "system", "content": "You are an expert in the Witness supply chain attestation framework. You help users instrument CI/CD pipelines with witness, create policy documents, and write Rego policies to validate attestations. You understand all attestors in go-witness and how to use them effectively."}, {"role": "user", "content": "How do I create a witness policy for a build step that uses these attestors: material, product, environment?"}, {"role": "assistant", "content": "Here's a complete witness policy for your build step with material, product, environment attestors:\n\n**Policy Document:**\n```json\n{\n  \"expires\": \"2026-11-08T10:52:59Z\",\n  \"publickeys\": {\n    \"build-key\": {\n      \"keyid\": \"sha256:0588775c9bd68a95fccff2ae7542c7232e8039c2d442b53f6cccef59453f3856\",\n      \"key\": \"-----BEGIN PUBLIC KEY-----\\n...\\n-----END PUBLIC KEY-----\"\n    }\n  },\n  \"steps\": {\n    \"build\": {\n      \"name\": \"build\",\n      \"attestations\": [\n        {\n          \"type\": \"https://witness.dev/attestations/material/v0.1\"\n        },\n        {\n          \"type\": \"https://witness.dev/attestations/product/v0.1\"\n        },\n        {\n          \"type\": \"https://witness.dev/attestations/environment/v0.1\"\n        }\n      ],\n      \"functionaries\": [\n        {\n          \"type\": \"publickey\",\n          \"publickeyid\": \"build-key\"\n        }\n      ]\n    }\n  }\n}\n```\n\n**Witness Run Command:**\n```bash\nwitness run --step build \\\n  --attestations material,product,environment \\\n  --outfile build-attestation.json \\\n  --key signing-key.pem \\\n  -- <your-build-command>\n```\n\n**Rego Validation Rules:**\n```rego\n\n```\n\n**Verification:**\n```bash\nwitness verify \\\n  --policy policy-signed.json \\\n  --publickey policy-key.pub \\\n  -a build-attestation.json \\\n  --subject <artifact>\n```\n"}]}
{"messages": [{"role": "system", "content": "You are an expert in the Witness supply chain attestation framework. You help users instrument CI/CD pipelines with witness, create policy documents, and write Rego policies to validate attestations. You understand all attestors in go-witness and how to use them effectively."}, {"role": "user", "content": "How do I create a witness policy for a build step that uses these attestors: environment, github?"}, {"role": "assistant", "content": "Here's a complete witness policy for your build step with environment, github attestors:\n\n**Policy Document:**\n```json\n{\n  \"expires\": \"2026-11-08T10:52:59Z\",\n  \"publickeys\": {\n    \"build-key\": {\n      \"keyid\": \"sha256:474315e2b2ba51cb9f6b5dbcec5ce9e0e6a059da5e104b660448e27e57cf422f\",\n      \"key\": \"-----BEGIN PUBLIC KEY-----\\n...\\n-----END PUBLIC KEY-----\"\n    }\n  },\n  \"steps\": {\n    \"build\": {\n      \"name\": \"build\",\n      \"attestations\": [\n        {\n          \"type\": \"https://witness.dev/attestations/environment/v0.1\"\n        },\n        {\n          \"type\": \"https://witness.dev/attestations/github/v0.1\"\n        }\n      ],\n      \"functionaries\": [\n        {\n          \"type\": \"publickey\",\n          \"publickeyid\": \"build-key\"\n        }\n      ]\n    }\n  }\n}\n```\n\n**Witness Run Command:**\n```bash\nwitness run --step build \\\n  --attestations environment,github \\\n  --outfile build-attestation.json \\\n  --key signing-key.pem \\\n  -- <your-build-command>\n```\n\n**Rego Validation Rules:**\n```rego\npackage environment\n\nimport rego.v1\n\n# Ensure correct OS\ndeny contains msg if {\n    input.os != \"linux\"\n    msg := sprintf(\"Must run on linux, got: %s\", [input.os])\n}\n\n# Require CI environment\ndeny contains msg if {\n    not \"CI\" in input.variables\n    msg := \"Must run in CI environment (CI variable not set)\"\n}\n```\n\n**Verification:**\n```bash\nwitness verify \\\n  --policy policy-signed.json \\\n  --publickey policy-key.pub \\\n  -a build-attestation.json \\\n  --subject <artifact>\n```\n"}]}
{"messages": [{"role": "system", "content": "You are an expert in the Witness supply chain attestation framework. You help users instrument CI/CD pipelines with witness, create policy documents, and write Rego policies to validate attestations. You understand all attestors in go-witness and how to use them effectively."}, {"role": "user", "content": "How do I create a witness policy for a build step that uses these attestors: material, github, product?"}, {"role": "assistant", "content": "Here's a complete witness policy for your build step with material, github, product attestors:\n\n**Policy Document:**\n```json\n{\n  \"expires\": \"2026-11-08T10:52:59Z\",\n  \"publickeys\": {\n    \"build-key\": {\n      \"keyid\": \"sha256:1e9f7f0c0bf497e34a31589fe13123db906d2bd3981300dec3b4d7e4dd9f0c32\",\n      \"key\": \"-----BEGIN PUBLIC KEY-----\\n...\\n-----END PUBLIC KEY-----\"\n    }\n  },\n  \"steps\": {\n    \"build\": {\n      \"name\": \"build\",\n      \"attestations\": [\n        {\n          \"type\": \"https://witness.dev/attestations/material/v0.1\"\n        },\n        {\n          \"type\": \"https://witness.dev/attestations/github/v0.1\"\n        },\n        {\n          \"type\": \"https://witness.dev/attestations/product/v0.1\"\n        }\n      ],\n      \"functionaries\": [\n        {\n          \"type\": \"publickey\",\n          \"publickeyid\": \"build-key\"\n        }\n      ]\n    }\n  }\n}\n```\n\n**Witness Run Command:**\n```bash\nwitness run --step build \\\n  --attestations material,github,product \\\n  --outfile build-attestation.json \\\n  --key signing-key.pem \\\n  -- <your-build-command>\n```\n\n**Rego Validation Rules:**\n```rego\n\n```\n\n**Verification:**\n```bash\nwitness verify \\\n  --policy policy-signed.json \\\n  --publickey policy-key.pub \\\n  -a build-attestation.json \\\n  --subject <artifact>\n```\n"}]}
{"messages": [{"role": "system", "content": "You are an expert in the Witness supply chain attestation framework. You help users instrument CI/CD pipelines with witness, create policy documents, and write Rego policies to validate attestations. You understand all attestors in go-witness and how to use them effectively."}, {"role": "user", "content": "How do I create a witness policy for a build step that uses these attestors: material?"}, {"role": "assistant", "content": "Here's a complete witness policy for your build step with material attestors:\n\n**Policy Document:**\n```json\n{\n  \"expires\": \"2026-11-08T10:52:59Z\",\n  \"publickeys\": {\n    \"build-key\": {\n      \"keyid\": \"sha256:3e27338347fc2bc0ecf38f0fc4138b073568ac222e276c8c9435fe19582cd4b6\",\n      \"key\": \"-----BEGIN PUBLIC KEY-----\\n...\\n-----END PUBLIC KEY-----\"\n    }\n  },\n  \"steps\": {\n    \"build\": {\n      \"name\": \"build\",\n      \"attestations\": [\n        {\n          \"type\": \"https://witness.dev/attestations/material/v0.1\"\n        }\n      ],\n      \"functionaries\": [\n        {\n          \"type\": \"publickey\",\n          \"publickeyid\": \"build-key\"\n        }\n      ]\n    }\n  }\n}\n```\n\n**Witness Run Command:**\n```bash\nwitness run --step build \\\n  --attestations material \\\n  --outfile build-attestation.json \\\n  --key signing-key.pem \\\n  -- <your-build-command>\n```\n\n**Rego Validation Rules:**\n```rego\n\n```\n\n**Verification:**\n```bash\nwitness verify \\\n  --policy policy-signed.json \\\n  --publickey policy-key.pub \\\n  -a build-attestation.json \\\n  --subject <artifact>\n```\n"}]}
{"messages": [{"role": "system", "content": "You are an expert in the Witness supply chain attestation framework. You help users instrument CI/CD pipelines with witness, create policy documents, and write Rego policies to validate attestations. You understand all attestors in go-witness and how to use them effectively."}, {"role": "user", "content": "How do I create a witness policy for a build step that uses these attestors: environment, product, github, commandrun, material?"}, {"role": "assistant", "content": "Here's a complete witness policy for your build step with environment, product, github, commandrun, material attestors:\n\n**Policy Document:**\n```json\n{\n  \"expires\": \"2026-11-08T10:52:59Z\",\n  \"publickeys\": {\n    \"build-key\": {\n      \"keyid\": \"sha256:5632c18c8450335d9f34877acbc0bee248a8a0beba78f951f1c91b31ddce3f0b\",\n      \"key\": \"-----BEGIN PUBLIC KEY-----\\n...\\n-----END PUBLIC KEY-----\"\n    }\n  },\n  \"steps\": {\n    \"build\": {\n      \"name\": \"build\",\n      \"attestations\": [\n        {\n          \"type\": \"https://witness.dev/attestations/environment/v0.1\"\n        },\n        {\n          \"type\": \"https://witness.dev/attestations/product/v0.1\"\n        },\n        {\n          \"type\": \"https://witness.dev/attestations/github/v0.1\"\n        },\n        {\n          \"type\": \"https://witness.dev/attestations/command-run/v0.1\"\n        },\n        {\n          \"type\": \"https://witness.dev/attestations/material/v0.1\"\n        }\n      ],\n      \"functionaries\": [\n        {\n          \"type\": \"publickey\",\n          \"publickeyid\": \"build-key\"\n        }\n      ]\n    }\n  }\n}\n```\n\n**Witness Run Command:**\n```bash\nwitness run --step build \\\n  --attestations environment,product,github,commandrun,material \\\n  --outfile build-attestation.json \\\n  --key signing-key.pem \\\n  -- <your-build-command>\n```\n\n**Rego Validation Rules:**\n```rego\npackage environment\n\nimport rego.v1\n\n# Ensure correct OS\ndeny contains msg if {\n    input.os != \"windows\"\n    msg := sprintf(\"Must run on windows, got: %s\", [input.os])\n}\n\n# Require CI environment\ndeny contains msg if {\n    not \"CI\" in input.variables\n    msg := \"Must run in CI environment (CI variable not set)\"\n}\n```\n\n**Verification:**\n```bash\nwitness verify \\\n  --policy policy-signed.json \\\n  --publickey policy-key.pub \\\n  -a build-attestation.json \\\n  --subject <artifact>\n```\n"}]}
{"messages": [{"role": "system", "content": "You are an expert in the Witness supply chain attestation framework. You help users instrument CI/CD pipelines with witness, create policy documents, and write Rego policies to validate attestations. You understand all attestors in go-witness and how to use them effectively."}, {"role": "user", "content": "How do I create a witness policy for a build step that uses these attestors: github?"}, {"role": "assistant", "content": "Here's a complete witness policy for your build step with github attestors:\n\n**Policy Document:**\n```json\n{\n  \"expires\": \"2026-11-08T10:52:59Z\",\n  \"publickeys\": {\n    \"build-key\": {\n      \"keyid\": \"sha256:398b36868197db9c2a22cd990f6c09ac7f6b3dbf6f3f6a803a59d9df50a2443b\",\n      \"key\": \"-----BEGIN PUBLIC KEY-----\\n...\\n-----END PUBLIC KEY-----\"\n    }\n  },\n  \"steps\": {\n    \"build\": {\n      \"name\": \"build\",\n      \"attestations\": [\n        {\n          \"type\": \"https://witness.dev/attestations/github/v0.1\"\n        }\n      ],\n      \"functionaries\": [\n        {\n          \"type\": \"publickey\",\n          \"publickeyid\": \"build-key\"\n        }\n      ]\n    }\n  }\n}\n```\n\n**Witness Run Command:**\n```bash\nwitness run --step build \\\n  --attestations github \\\n  --outfile build-attestation.json \\\n  --key signing-key.pem \\\n  -- <your-build-command>\n```\n\n**Rego Validation Rules:**\n```rego\n\n```\n\n**Verification:**\n```bash\nwitness verify \\\n  --policy policy-signed.json \\\n  --publickey policy-key.pub \\\n  -a build-attestation.json \\\n  --subject <artifact>\n```\n"}]}
{"messages": [{"role": "system", "content": "You are an expert in the Witness supply chain attestation framework. You help users instrument CI/CD pipelines with witness, create policy documents, and write Rego policies to validate attestations. You understand all attestors in go-witness and how to use them effectively."}, {"role": "user", "content": "How do I create a witness policy for a build step that uses these attestors: github, environment, material, commandrun?"}, {"role": "assistant", "content": "Here's a complete witness policy for your build step with github, environment, material, commandrun attestors:\n\n**Policy Document:**\n```json\n{\n  \"expires\": \"2026-11-08T10:52:59Z\",\n  \"publickeys\": {\n    \"build-key\": {\n      \"keyid\": \"sha256:bd8350b6823a10b7fc866719c9d801976d0b52d74f690cae1433e3ce53706b45\",\n      \"key\": \"-----BEGIN PUBLIC KEY-----\\n...\\n-----END PUBLIC KEY-----\"\n    }\n  },\n  \"steps\": {\n    \"build\": {\n      \"name\": \"build\",\n      \"attestations\": [\n        {\n          \"type\": \"https://witness.dev/attestations/github/v0.1\"\n        },\n        {\n          \"type\": \"https://witness.dev/attestations/environment/v0.1\"\n        },\n        {\n          \"type\": \"https://witness.dev/attestations/material/v0.1\"\n        },\n        {\n          \"type\": \"https://witness.dev/attestations/command-run/v0.1\"\n        }\n      ],\n      \"functionaries\": [\n        {\n          \"type\": \"publickey\",\n          \"publickeyid\": \"build-key\"\n        }\n      ]\n    }\n  }\n}\n```\n\n**Witness Run Command:**\n```bash\nwitness run --step build \\\n  --attestations github,environment,material,commandrun \\\n  --outfile build-attestation.json \\\n  --key signing-key.pem \\\n  -- <your-build-command>\n```\n\n**Rego Validation Rules:**\n```rego\n\n```\n\n**Verification:**\n```bash\nwitness verify \\\n  --policy policy-signed.json \\\n  --publickey policy-key.pub \\\n  -a build-attestation.json \\\n  --subject <artifact>\n```\n"}]}
{"messages": [{"role": "system", "content": "You are an expert in the Witness supply chain attestation framework. You help users instrument CI/CD pipelines with witness, create policy documents, and write Rego policies to validate attestations. You understand all attestors in go-witness and how to use them effectively."}, {"role": "user", "content": "How do I create a multi-step witness policy for a build \u2192 test \u2192 package pipeline?"}, {"role": "assistant", "content": "Here's a complete multi-step witness policy for your pipeline:\n\n**Policy Document:**\n```json\n{\n  \"expires\": \"2026-11-08T10:52:59Z\",\n  \"publickeys\": {\n    \"ci-key\": {\n      \"keyid\": \"sha256:cd6ca6442cdc67a6772c68c949561feb1fdb1f83dd50917a5fdf7ee7600e2fa5\",\n      \"key\": \"-----BEGIN PUBLIC KEY-----\\n...\\n-----END PUBLIC KEY-----\"\n    }\n  },\n  \"steps\": {\n    \"build\": {\n      \"name\": \"build\",\n      \"attestations\": [\n        {\n          \"type\": \"https://witness.dev/attestations/git/v0.1\"\n        },\n        {\n          \"type\": \"https://witness.dev/attestations/command-run/v0.1\"\n        },\n        {\n          \"type\": \"https://witness.dev/attestations/product/v0.1\"\n        }\n      ],\n      \"functionaries\": [\n        {\n          \"type\": \"publickey\",\n          \"publickeyid\": \"ci-key\"\n        }\n      ]\n    },\n    \"test\": {\n      \"name\": \"test\",\n      \"attestations\": [\n        {\n          \"type\": \"https://witness.dev/attestations/material/v0.1\"\n        },\n        {\n          \"type\": \"https://witness.dev/attestations/command-run/v0.1\"\n        }\n      ],\n      \"functionaries\": [\n        {\n          \"type\": \"publickey\",\n          \"publickeyid\": \"ci-key\"\n        }\n      ]\n    },\n    \"package\": {\n      \"name\": \"package\",\n      \"attestations\": [\n        {\n          \"type\": \"https://witness.dev/attestations/material/v0.1\"\n        },\n        {\n          \"type\": \"https://witness.dev/attestations/product/v0.1\"\n        }\n      ],\n      \"functionaries\": [\n        {\n          \"type\": \"publickey\",\n          \"publickeyid\": \"ci-key\"\n        }\n      ]\n    }\n  }\n}\n```\n\n**Pipeline Commands:**\n\n```bash\n# Step 1: Build\nwitness run --step build \\\n  --attestations git,commandrun,product \\\n  -o build.json --key ci-key.pem \\\n  -- go build -o myapp\n\n# Step 2: Test\nwitness run --step test \\\n  --attestations material,commandrun \\\n  -o test.json --key ci-key.pem \\\n  -- go test ./...\n\n# Step 3: Package\nwitness run --step package \\\n  --attestations material,product \\\n  -o package.json --key ci-key.pem \\\n  -- tar czf myapp.tar.gz myapp\n\n# Verify entire pipeline\nwitness verify \\\n  --policy policy-signed.json \\\n  --publickey policy-key.pub \\\n  -a build.json -a test.json -a package.json\n```\n"}]}
{"messages": [{"role": "system", "content": "You are an expert in the Witness supply chain attestation framework. You help users instrument CI/CD pipelines with witness, create policy documents, and write Rego policies to validate attestations. You understand all attestors in go-witness and how to use them effectively."}, {"role": "user", "content": "How do I create a multi-step witness policy for a build \u2192 test \u2192 package pipeline?"}, {"role": "assistant", "content": "Here's a complete multi-step witness policy for your pipeline:\n\n**Policy Document:**\n```json\n{\n  \"expires\": \"2026-11-08T10:52:59Z\",\n  \"publickeys\": {\n    \"ci-key\": {\n      \"keyid\": \"sha256:9f9e587363872605c1914fd5395c87971b45338c80b74617af9f702a0a3b1d60\",\n      \"key\": \"-----BEGIN PUBLIC KEY-----\\n...\\n-----END PUBLIC KEY-----\"\n    }\n  },\n  \"steps\": {\n    \"build\": {\n      \"name\": \"build\",\n      \"attestations\": [\n        {\n          \"type\": \"https://witness.dev/attestations/git/v0.1\"\n        },\n        {\n          \"type\": \"https://witness.dev/attestations/command-run/v0.1\"\n        },\n        {\n          \"type\": \"https://witness.dev/attestations/product/v0.1\"\n        }\n      ],\n      \"functionaries\": [\n        {\n          \"type\": \"publickey\",\n          \"publickeyid\": \"ci-key\"\n        }\n      ]\n    },\n    \"test\": {\n      \"name\": \"test\",\n      \"attestations\": [\n        {\n          \"type\": \"https://witness.dev/attestations/material/v0.1\"\n        },\n        {\n          \"type\": \"https://witness.dev/attestations/command-run/v0.1\"\n        }\n      ],\n      \"functionaries\": [\n        {\n          \"type\": \"publickey\",\n          \"publickeyid\": \"ci-key\"\n        }\n      ]\n    },\n    \"package\": {\n      \"name\": \"package\",\n      \"attestations\": [\n        {\n          \"type\": \"https://witness.dev/attestations/material/v0.1\"\n        },\n        {\n          \"type\": \"https://witness.dev/attestations/product/v0.1\"\n        }\n      ],\n      \"functionaries\": [\n        {\n          \"type\": \"publickey\",\n          \"publickeyid\": \"ci-key\"\n        }\n      ]\n    }\n  }\n}\n```\n\n**Pipeline Commands:**\n\n```bash\n# Step 1: Build\nwitness run --step build \\\n  --attestations git,commandrun,product \\\n  -o build.json --key ci-key.pem \\\n  -- go build -o myapp\n\n# Step 2: Test\nwitness run --step test \\\n  --attestations material,commandrun \\\n  -o test.json --key ci-key.pem \\\n  -- go test ./...\n\n# Step 3: Package\nwitness run --step package \\\n  --attestations material,product \\\n  -o package.json --key ci-key.pem \\\n  -- tar czf myapp.tar.gz myapp\n\n# Verify entire pipeline\nwitness verify \\\n  --policy policy-signed.json \\\n  --publickey policy-key.pub \\\n  -a build.json -a test.json -a package.json\n```\n"}]}
{"messages": [{"role": "system", "content": "You are an expert in the Witness supply chain attestation framework. You help users instrument CI/CD pipelines with witness, create policy documents, and write Rego policies to validate attestations. You understand all attestors in go-witness and how to use them effectively."}, {"role": "user", "content": "How do I create a witness policy for a build step that uses these attestors: git, product, environment?"}, {"role": "assistant", "content": "Here's a complete witness policy for your build step with git, product, environment attestors:\n\n**Policy Document:**\n```json\n{\n  \"expires\": \"2026-11-08T10:52:59Z\",\n  \"publickeys\": {\n    \"build-key\": {\n      \"keyid\": \"sha256:829c1e343fedd0e47f6a3567641ea7586c9c2a066eec9339793a9fcd2c1c4492\",\n      \"key\": \"-----BEGIN PUBLIC KEY-----\\n...\\n-----END PUBLIC KEY-----\"\n    }\n  },\n  \"steps\": {\n    \"build\": {\n      \"name\": \"build\",\n      \"attestations\": [\n        {\n          \"type\": \"https://witness.dev/attestations/git/v0.1\"\n        },\n        {\n          \"type\": \"https://witness.dev/attestations/product/v0.1\"\n        },\n        {\n          \"type\": \"https://witness.dev/attestations/environment/v0.1\"\n        }\n      ],\n      \"functionaries\": [\n        {\n          \"type\": \"publickey\",\n          \"publickeyid\": \"build-key\"\n        }\n      ]\n    }\n  }\n}\n```\n\n**Witness Run Command:**\n```bash\nwitness run --step build \\\n  --attestations git,product,environment \\\n  --outfile build-attestation.json \\\n  --key signing-key.pem \\\n  -- <your-build-command>\n```\n\n**Rego Validation Rules:**\n```rego\npackage git\n\nimport rego.v1\n\n# Enforce builds from specific branch\ndeny contains msg if {\n    input.branch != \"release/v1.0\"\n    msg := sprintf(\"Must build from release/v1.0 branch, got: %s\", [input.branch])\n}\n\n# Validate commit author\napproved_authors := {\n    \"alice.smith@example.com\",\n    \"bob.jones@company.com\",\n    \"ci-bot@company.com\"\n}\n\ndeny contains msg if {\n    not input.authoremail in approved_authors\n    msg := sprintf(\"Unauthorized commit author: %s\", [input.authoremail])\n}\n```\n\n**Verification:**\n```bash\nwitness verify \\\n  --policy policy-signed.json \\\n  --publickey policy-key.pub \\\n  -a build-attestation.json \\\n  --subject <artifact>\n```\n"}]}
{"messages": [{"role": "system", "content": "You are an expert in the Witness supply chain attestation framework. You help users instrument CI/CD pipelines with witness, create policy documents, and write Rego policies to validate attestations. You understand all attestors in go-witness and how to use them effectively."}, {"role": "user", "content": "How do I create a multi-step witness policy for a build \u2192 test \u2192 package pipeline?"}, {"role": "assistant", "content": "Here's a complete multi-step witness policy for your pipeline:\n\n**Policy Document:**\n```json\n{\n  \"expires\": \"2026-11-08T10:52:59Z\",\n  \"publickeys\": {\n    \"ci-key\": {\n      \"keyid\": \"sha256:569c06dc80356858f65ddb75eea406bb4ae4ece2f5332a1add1f2b9b75f013a3\",\n      \"key\": \"-----BEGIN PUBLIC KEY-----\\n...\\n-----END PUBLIC KEY-----\"\n    }\n  },\n  \"steps\": {\n    \"build\": {\n      \"name\": \"build\",\n      \"attestations\": [\n        {\n          \"type\": \"https://witness.dev/attestations/git/v0.1\"\n        },\n        {\n          \"type\": \"https://witness.dev/attestations/command-run/v0.1\"\n        },\n        {\n          \"type\": \"https://witness.dev/attestations/product/v0.1\"\n        }\n      ],\n      \"functionaries\": [\n        {\n          \"type\": \"publickey\",\n          \"publickeyid\": \"ci-key\"\n        }\n      ]\n    },\n    \"test\": {\n      \"name\": \"test\",\n      \"attestations\": [\n        {\n          \"type\": \"https://witness.dev/attestations/material/v0.1\"\n        },\n        {\n          \"type\": \"https://witness.dev/attestations/command-run/v0.1\"\n        }\n      ],\n      \"functionaries\": [\n        {\n          \"type\": \"publickey\",\n          \"publickeyid\": \"ci-key\"\n        }\n      ]\n    },\n    \"package\": {\n      \"name\": \"package\",\n      \"attestations\": [\n        {\n          \"type\": \"https://witness.dev/attestations/material/v0.1\"\n        },\n        {\n          \"type\": \"https://witness.dev/attestations/product/v0.1\"\n        }\n      ],\n      \"functionaries\": [\n        {\n          \"type\": \"publickey\",\n          \"publickeyid\": \"ci-key\"\n        }\n      ]\n    }\n  }\n}\n```\n\n**Pipeline Commands:**\n\n```bash\n# Step 1: Build\nwitness run --step build \\\n  --attestations git,commandrun,product \\\n  -o build.json --key ci-key.pem \\\n  -- go build -o myapp\n\n# Step 2: Test\nwitness run --step test \\\n  --attestations material,commandrun \\\n  -o test.json --key ci-key.pem \\\n  -- go test ./...\n\n# Step 3: Package\nwitness run --step package \\\n  --attestations material,product \\\n  -o package.json --key ci-key.pem \\\n  -- tar czf myapp.tar.gz myapp\n\n# Verify entire pipeline\nwitness verify \\\n  --policy policy-signed.json \\\n  --publickey policy-key.pub \\\n  -a build.json -a test.json -a package.json\n```\n"}]}
{"messages": [{"role": "system", "content": "You are an expert in the Witness supply chain attestation framework. You help users instrument CI/CD pipelines with witness, create policy documents, and write Rego policies to validate attestations. You understand all attestors in go-witness and how to use them effectively."}, {"role": "user", "content": "How do I create a witness policy for a build step that uses these attestors: product, material, environment?"}, {"role": "assistant", "content": "Here's a complete witness policy for your build step with product, material, environment attestors:\n\n**Policy Document:**\n```json\n{\n  \"expires\": \"2026-11-08T10:52:59Z\",\n  \"publickeys\": {\n    \"build-key\": {\n      \"keyid\": \"sha256:2fd8bd3d72a9a26d3eda567abe9af4fe14d63ba59e9c34c4d68a1b30557eaa57\",\n      \"key\": \"-----BEGIN PUBLIC KEY-----\\n...\\n-----END PUBLIC KEY-----\"\n    }\n  },\n  \"steps\": {\n    \"build\": {\n      \"name\": \"build\",\n      \"attestations\": [\n        {\n          \"type\": \"https://witness.dev/attestations/product/v0.1\"\n        },\n        {\n          \"type\": \"https://witness.dev/attestations/material/v0.1\"\n        },\n        {\n          \"type\": \"https://witness.dev/attestations/environment/v0.1\"\n        }\n      ],\n      \"functionaries\": [\n        {\n          \"type\": \"publickey\",\n          \"publickeyid\": \"build-key\"\n        }\n      ]\n    }\n  }\n}\n```\n\n**Witness Run Command:**\n```bash\nwitness run --step build \\\n  --attestations product,material,environment \\\n  --outfile build-attestation.json \\\n  --key signing-key.pem \\\n  -- <your-build-command>\n```\n\n**Rego Validation Rules:**\n```rego\n\n```\n\n**Verification:**\n```bash\nwitness verify \\\n  --policy policy-signed.json \\\n  --publickey policy-key.pub \\\n  -a build-attestation.json \\\n  --subject <artifact>\n```\n"}]}
{"messages": [{"role": "system", "content": "You are an expert in the Witness supply chain attestation framework. You help users instrument CI/CD pipelines with witness, create policy documents, and write Rego policies to validate attestations. You understand all attestors in go-witness and how to use them effectively."}, {"role": "user", "content": "How do I create a multi-step witness policy for a build \u2192 test \u2192 package pipeline?"}, {"role": "assistant", "content": "Here's a complete multi-step witness policy for your pipeline:\n\n**Policy Document:**\n```json\n{\n  \"expires\": \"2026-11-08T10:52:59Z\",\n  \"publickeys\": {\n    \"ci-key\": {\n      \"keyid\": \"sha256:0d126c03a282c6c2d1b430d5fc2754c90956bf25c1f7a3cbc30d24a775e65375\",\n      \"key\": \"-----BEGIN PUBLIC KEY-----\\n...\\n-----END PUBLIC KEY-----\"\n    }\n  },\n  \"steps\": {\n    \"build\": {\n      \"name\": \"build\",\n      \"attestations\": [\n        {\n          \"type\": \"https://witness.dev/attestations/git/v0.1\"\n        },\n        {\n          \"type\": \"https://witness.dev/attestations/command-run/v0.1\"\n        },\n        {\n          \"type\": \"https://witness.dev/attestations/product/v0.1\"\n        }\n      ],\n      \"functionaries\": [\n        {\n          \"type\": \"publickey\",\n          \"publickeyid\": \"ci-key\"\n        }\n      ]\n    },\n    \"test\": {\n      \"name\": \"test\",\n      \"attestations\": [\n        {\n          \"type\": \"https://witness.dev/attestations/material/v0.1\"\n        },\n        {\n          \"type\": \"https://witness.dev/attestations/command-run/v0.1\"\n        }\n      ],\n      \"functionaries\": [\n        {\n          \"type\": \"publickey\",\n          \"publickeyid\": \"ci-key\"\n        }\n      ]\n    },\n    \"package\": {\n      \"name\": \"package\",\n      \"attestations\": [\n        {\n          \"type\": \"https://witness.dev/attestations/material/v0.1\"\n        },\n        {\n          \"type\": \"https://witness.dev/attestations/product/v0.1\"\n        }\n      ],\n      \"functionaries\": [\n        {\n          \"type\": \"publickey\",\n          \"publickeyid\": \"ci-key\"\n        }\n      ]\n    }\n  }\n}\n```\n\n**Pipeline Commands:**\n\n```bash\n# Step 1: Build\nwitness run --step build \\\n  --attestations git,commandrun,product \\\n  -o build.json --key ci-key.pem \\\n  -- go build -o myapp\n\n# Step 2: Test\nwitness run --step test \\\n  --attestations material,commandrun \\\n  -o test.json --key ci-key.pem \\\n  -- go test ./...\n\n# Step 3: Package\nwitness run --step package \\\n  --attestations material,product \\\n  -o package.json --key ci-key.pem \\\n  -- tar czf myapp.tar.gz myapp\n\n# Verify entire pipeline\nwitness verify \\\n  --policy policy-signed.json \\\n  --publickey policy-key.pub \\\n  -a build.json -a test.json -a package.json\n```\n"}]}
{"messages": [{"role": "system", "content": "You are an expert in the Witness supply chain attestation framework. You help users instrument CI/CD pipelines with witness, create policy documents, and write Rego policies to validate attestations. You understand all attestors in go-witness and how to use them effectively."}, {"role": "user", "content": "How do I create a multi-step witness policy for a build \u2192 test \u2192 package pipeline?"}, {"role": "assistant", "content": "Here's a complete multi-step witness policy for your pipeline:\n\n**Policy Document:**\n```json\n{\n  \"expires\": \"2026-11-08T10:52:59Z\",\n  \"publickeys\": {\n    \"ci-key\": {\n      \"keyid\": \"sha256:b46d93236dec4069d2b67622f4601ee4da5a023c06c99e93d0b32bd19ddd8f5c\",\n      \"key\": \"-----BEGIN PUBLIC KEY-----\\n...\\n-----END PUBLIC KEY-----\"\n    }\n  },\n  \"steps\": {\n    \"build\": {\n      \"name\": \"build\",\n      \"attestations\": [\n        {\n          \"type\": \"https://witness.dev/attestations/git/v0.1\"\n        },\n        {\n          \"type\": \"https://witness.dev/attestations/command-run/v0.1\"\n        },\n        {\n          \"type\": \"https://witness.dev/attestations/product/v0.1\"\n        }\n      ],\n      \"functionaries\": [\n        {\n          \"type\": \"publickey\",\n          \"publickeyid\": \"ci-key\"\n        }\n      ]\n    },\n    \"test\": {\n      \"name\": \"test\",\n      \"attestations\": [\n        {\n          \"type\": \"https://witness.dev/attestations/material/v0.1\"\n        },\n        {\n          \"type\": \"https://witness.dev/attestations/command-run/v0.1\"\n        }\n      ],\n      \"functionaries\": [\n        {\n          \"type\": \"publickey\",\n          \"publickeyid\": \"ci-key\"\n        }\n      ]\n    },\n    \"package\": {\n      \"name\": \"package\",\n      \"attestations\": [\n        {\n          \"type\": \"https://witness.dev/attestations/material/v0.1\"\n        },\n        {\n          \"type\": \"https://witness.dev/attestations/product/v0.1\"\n        }\n      ],\n      \"functionaries\": [\n        {\n          \"type\": \"publickey\",\n          \"publickeyid\": \"ci-key\"\n        }\n      ]\n    }\n  }\n}\n```\n\n**Pipeline Commands:**\n\n```bash\n# Step 1: Build\nwitness run --step build \\\n  --attestations git,commandrun,product \\\n  -o build.json --key ci-key.pem \\\n  -- go build -o myapp\n\n# Step 2: Test\nwitness run --step test \\\n  --attestations material,commandrun \\\n  -o test.json --key ci-key.pem \\\n  -- go test ./...\n\n# Step 3: Package\nwitness run --step package \\\n  --attestations material,product \\\n  -o package.json --key ci-key.pem \\\n  -- tar czf myapp.tar.gz myapp\n\n# Verify entire pipeline\nwitness verify \\\n  --policy policy-signed.json \\\n  --publickey policy-key.pub \\\n  -a build.json -a test.json -a package.json\n```\n"}]}
{"messages": [{"role": "system", "content": "You are an expert in the Witness supply chain attestation framework. You help users instrument CI/CD pipelines with witness, create policy documents, and write Rego policies to validate attestations. You understand all attestors in go-witness and how to use them effectively."}, {"role": "user", "content": "How do I create a witness policy for a build step that uses these attestors: product, commandrun, material, github, environment?"}, {"role": "assistant", "content": "Here's a complete witness policy for your build step with product, commandrun, material, github, environment attestors:\n\n**Policy Document:**\n```json\n{\n  \"expires\": \"2026-11-08T10:52:59Z\",\n  \"publickeys\": {\n    \"build-key\": {\n      \"keyid\": \"sha256:230b6ce04533795703b6c9c07aa7e24cba58be6e0a0e22b4ca9c493a45c47504\",\n      \"key\": \"-----BEGIN PUBLIC KEY-----\\n...\\n-----END PUBLIC KEY-----\"\n    }\n  },\n  \"steps\": {\n    \"build\": {\n      \"name\": \"build\",\n      \"attestations\": [\n        {\n          \"type\": \"https://witness.dev/attestations/product/v0.1\"\n        },\n        {\n          \"type\": \"https://witness.dev/attestations/command-run/v0.1\"\n        },\n        {\n          \"type\": \"https://witness.dev/attestations/material/v0.1\"\n        },\n        {\n          \"type\": \"https://witness.dev/attestations/github/v0.1\"\n        },\n        {\n          \"type\": \"https://witness.dev/attestations/environment/v0.1\"\n        }\n      ],\n      \"functionaries\": [\n        {\n          \"type\": \"publickey\",\n          \"publickeyid\": \"build-key\"\n        }\n      ]\n    }\n  }\n}\n```\n\n**Witness Run Command:**\n```bash\nwitness run --step build \\\n  --attestations product,commandrun,material,github,environment \\\n  --outfile build-attestation.json \\\n  --key signing-key.pem \\\n  -- <your-build-command>\n```\n\n**Rego Validation Rules:**\n```rego\n\n```\n\n**Verification:**\n```bash\nwitness verify \\\n  --policy policy-signed.json \\\n  --publickey policy-key.pub \\\n  -a build-attestation.json \\\n  --subject <artifact>\n```\n"}]}
{"messages": [{"role": "system", "content": "You are an expert in the Witness supply chain attestation framework. You help users instrument CI/CD pipelines with witness, create policy documents, and write Rego policies to validate attestations. You understand all attestors in go-witness and how to use them effectively."}, {"role": "user", "content": "How do I create a witness policy for a build step that uses these attestors: environment, commandrun, git?"}, {"role": "assistant", "content": "Here's a complete witness policy for your build step with environment, commandrun, git attestors:\n\n**Policy Document:**\n```json\n{\n  \"expires\": \"2026-11-08T10:52:59Z\",\n  \"publickeys\": {\n    \"build-key\": {\n      \"keyid\": \"sha256:0d241441d1b4a2ccd3b8ee724c5a4bc7958e5597b54e010a9a4c03dc34f49831\",\n      \"key\": \"-----BEGIN PUBLIC KEY-----\\n...\\n-----END PUBLIC KEY-----\"\n    }\n  },\n  \"steps\": {\n    \"build\": {\n      \"name\": \"build\",\n      \"attestations\": [\n        {\n          \"type\": \"https://witness.dev/attestations/environment/v0.1\"\n        },\n        {\n          \"type\": \"https://witness.dev/attestations/command-run/v0.1\"\n        },\n        {\n          \"type\": \"https://witness.dev/attestations/git/v0.1\"\n        }\n      ],\n      \"functionaries\": [\n        {\n          \"type\": \"publickey\",\n          \"publickeyid\": \"build-key\"\n        }\n      ]\n    }\n  }\n}\n```\n\n**Witness Run Command:**\n```bash\nwitness run --step build \\\n  --attestations environment,commandrun,git \\\n  --outfile build-attestation.json \\\n  --key signing-key.pem \\\n  -- <your-build-command>\n```\n\n**Rego Validation Rules:**\n```rego\npackage environment\n\nimport rego.v1\n\n# Ensure correct OS\ndeny contains msg if {\n    input.os != \"windows\"\n    msg := sprintf(\"Must run on windows, got: %s\", [input.os])\n}\n\n# Require CI environment\ndeny contains msg if {\n    not \"CI\" in input.variables\n    msg := \"Must run in CI environment (CI variable not set)\"\n}\n```\n\n**Verification:**\n```bash\nwitness verify \\\n  --policy policy-signed.json \\\n  --publickey policy-key.pub \\\n  -a build-attestation.json \\\n  --subject <artifact>\n```\n"}]}
{"messages": [{"role": "system", "content": "You are an expert in the Witness supply chain attestation framework. You help users instrument CI/CD pipelines with witness, create policy documents, and write Rego policies to validate attestations. You understand all attestors in go-witness and how to use them effectively."}, {"role": "user", "content": "How do I create a witness policy for a build step that uses these attestors: github?"}, {"role": "assistant", "content": "Here's a complete witness policy for your build step with github attestors:\n\n**Policy Document:**\n```json\n{\n  \"expires\": \"2026-11-08T10:52:59Z\",\n  \"publickeys\": {\n    \"build-key\": {\n      \"keyid\": \"sha256:c577dc3ce2fbfb21365aef2cb931b68dc77a6c91b66aa338c9e89275a9582236\",\n      \"key\": \"-----BEGIN PUBLIC KEY-----\\n...\\n-----END PUBLIC KEY-----\"\n    }\n  },\n  \"steps\": {\n    \"build\": {\n      \"name\": \"build\",\n      \"attestations\": [\n        {\n          \"type\": \"https://witness.dev/attestations/github/v0.1\"\n        }\n      ],\n      \"functionaries\": [\n        {\n          \"type\": \"publickey\",\n          \"publickeyid\": \"build-key\"\n        }\n      ]\n    }\n  }\n}\n```\n\n**Witness Run Command:**\n```bash\nwitness run --step build \\\n  --attestations github \\\n  --outfile build-attestation.json \\\n  --key signing-key.pem \\\n  -- <your-build-command>\n```\n\n**Rego Validation Rules:**\n```rego\n\n```\n\n**Verification:**\n```bash\nwitness verify \\\n  --policy policy-signed.json \\\n  --publickey policy-key.pub \\\n  -a build-attestation.json \\\n  --subject <artifact>\n```\n"}]}
{"messages": [{"role": "system", "content": "You are an expert in the Witness supply chain attestation framework. You help users instrument CI/CD pipelines with witness, create policy documents, and write Rego policies to validate attestations. You understand all attestors in go-witness and how to use them effectively."}, {"role": "user", "content": "How do I create a witness policy for a build step that uses these attestors: commandrun, environment, product, material?"}, {"role": "assistant", "content": "Here's a complete witness policy for your build step with commandrun, environment, product, material attestors:\n\n**Policy Document:**\n```json\n{\n  \"expires\": \"2026-11-08T10:52:59Z\",\n  \"publickeys\": {\n    \"build-key\": {\n      \"keyid\": \"sha256:711e0c232ef0c33c270c144a88c0ed70c8f4acc2d7b1e2cf8b26764ab241bf51\",\n      \"key\": \"-----BEGIN PUBLIC KEY-----\\n...\\n-----END PUBLIC KEY-----\"\n    }\n  },\n  \"steps\": {\n    \"build\": {\n      \"name\": \"build\",\n      \"attestations\": [\n        {\n          \"type\": \"https://witness.dev/attestations/command-run/v0.1\"\n        },\n        {\n          \"type\": \"https://witness.dev/attestations/environment/v0.1\"\n        },\n        {\n          \"type\": \"https://witness.dev/attestations/product/v0.1\"\n        },\n        {\n          \"type\": \"https://witness.dev/attestations/material/v0.1\"\n        }\n      ],\n      \"functionaries\": [\n        {\n          \"type\": \"publickey\",\n          \"publickeyid\": \"build-key\"\n        }\n      ]\n    }\n  }\n}\n```\n\n**Witness Run Command:**\n```bash\nwitness run --step build \\\n  --attestations commandrun,environment,product,material \\\n  --outfile build-attestation.json \\\n  --key signing-key.pem \\\n  -- <your-build-command>\n```\n\n**Rego Validation Rules:**\n```rego\n\n```\n\n**Verification:**\n```bash\nwitness verify \\\n  --policy policy-signed.json \\\n  --publickey policy-key.pub \\\n  -a build-attestation.json \\\n  --subject <artifact>\n```\n"}]}
{"messages": [{"role": "system", "content": "You are an expert in the Witness supply chain attestation framework. You help users instrument CI/CD pipelines with witness, create policy documents, and write Rego policies to validate attestations. You understand all attestors in go-witness and how to use them effectively."}, {"role": "user", "content": "How do I create a witness policy for a build step that uses these attestors: github?"}, {"role": "assistant", "content": "Here's a complete witness policy for your build step with github attestors:\n\n**Policy Document:**\n```json\n{\n  \"expires\": \"2026-11-08T10:52:59Z\",\n  \"publickeys\": {\n    \"build-key\": {\n      \"keyid\": \"sha256:9bb60862447a728de1e501849f4c9c8e330232b6782ae644798e9e8568e9c730\",\n      \"key\": \"-----BEGIN PUBLIC KEY-----\\n...\\n-----END PUBLIC KEY-----\"\n    }\n  },\n  \"steps\": {\n    \"build\": {\n      \"name\": \"build\",\n      \"attestations\": [\n        {\n          \"type\": \"https://witness.dev/attestations/github/v0.1\"\n        }\n      ],\n      \"functionaries\": [\n        {\n          \"type\": \"publickey\",\n          \"publickeyid\": \"build-key\"\n        }\n      ]\n    }\n  }\n}\n```\n\n**Witness Run Command:**\n```bash\nwitness run --step build \\\n  --attestations github \\\n  --outfile build-attestation.json \\\n  --key signing-key.pem \\\n  -- <your-build-command>\n```\n\n**Rego Validation Rules:**\n```rego\n\n```\n\n**Verification:**\n```bash\nwitness verify \\\n  --policy policy-signed.json \\\n  --publickey policy-key.pub \\\n  -a build-attestation.json \\\n  --subject <artifact>\n```\n"}]}
{"messages": [{"role": "system", "content": "You are an expert in the Witness supply chain attestation framework. You help users instrument CI/CD pipelines with witness, create policy documents, and write Rego policies to validate attestations. You understand all attestors in go-witness and how to use them effectively."}, {"role": "user", "content": "How do I create a multi-step witness policy for a build \u2192 test \u2192 package pipeline?"}, {"role": "assistant", "content": "Here's a complete multi-step witness policy for your pipeline:\n\n**Policy Document:**\n```json\n{\n  \"expires\": \"2026-11-08T10:52:59Z\",\n  \"publickeys\": {\n    \"ci-key\": {\n      \"keyid\": \"sha256:61f9aede362b911be91aed13c9f22a64a35219c94dc65157e5f2dcd10723953a\",\n      \"key\": \"-----BEGIN PUBLIC KEY-----\\n...\\n-----END PUBLIC KEY-----\"\n    }\n  },\n  \"steps\": {\n    \"build\": {\n      \"name\": \"build\",\n      \"attestations\": [\n        {\n          \"type\": \"https://witness.dev/attestations/git/v0.1\"\n        },\n        {\n          \"type\": \"https://witness.dev/attestations/command-run/v0.1\"\n        },\n        {\n          \"type\": \"https://witness.dev/attestations/product/v0.1\"\n        }\n      ],\n      \"functionaries\": [\n        {\n          \"type\": \"publickey\",\n          \"publickeyid\": \"ci-key\"\n        }\n      ]\n    },\n    \"test\": {\n      \"name\": \"test\",\n      \"attestations\": [\n        {\n          \"type\": \"https://witness.dev/attestations/material/v0.1\"\n        },\n        {\n          \"type\": \"https://witness.dev/attestations/command-run/v0.1\"\n        }\n      ],\n      \"functionaries\": [\n        {\n          \"type\": \"publickey\",\n          \"publickeyid\": \"ci-key\"\n        }\n      ]\n    },\n    \"package\": {\n      \"name\": \"package\",\n      \"attestations\": [\n        {\n          \"type\": \"https://witness.dev/attestations/material/v0.1\"\n        },\n        {\n          \"type\": \"https://witness.dev/attestations/product/v0.1\"\n        }\n      ],\n      \"functionaries\": [\n        {\n          \"type\": \"publickey\",\n          \"publickeyid\": \"ci-key\"\n        }\n      ]\n    }\n  }\n}\n```\n\n**Pipeline Commands:**\n\n```bash\n# Step 1: Build\nwitness run --step build \\\n  --attestations git,commandrun,product \\\n  -o build.json --key ci-key.pem \\\n  -- go build -o myapp\n\n# Step 2: Test\nwitness run --step test \\\n  --attestations material,commandrun \\\n  -o test.json --key ci-key.pem \\\n  -- go test ./...\n\n# Step 3: Package\nwitness run --step package \\\n  --attestations material,product \\\n  -o package.json --key ci-key.pem \\\n  -- tar czf myapp.tar.gz myapp\n\n# Verify entire pipeline\nwitness verify \\\n  --policy policy-signed.json \\\n  --publickey policy-key.pub \\\n  -a build.json -a test.json -a package.json\n```\n"}]}
{"messages": [{"role": "system", "content": "You are an expert in the Witness supply chain attestation framework. You help users instrument CI/CD pipelines with witness, create policy documents, and write Rego policies to validate attestations. You understand all attestors in go-witness and how to use them effectively."}, {"role": "user", "content": "How do I create a multi-step witness policy for a build \u2192 test \u2192 package pipeline?"}, {"role": "assistant", "content": "Here's a complete multi-step witness policy for your pipeline:\n\n**Policy Document:**\n```json\n{\n  \"expires\": \"2026-11-08T10:52:59Z\",\n  \"publickeys\": {\n    \"ci-key\": {\n      \"keyid\": \"sha256:319c940e447aff00f2389cb1cc20914a7950291dc466c760a4b1b0ac1cf3d120\",\n      \"key\": \"-----BEGIN PUBLIC KEY-----\\n...\\n-----END PUBLIC KEY-----\"\n    }\n  },\n  \"steps\": {\n    \"build\": {\n      \"name\": \"build\",\n      \"attestations\": [\n        {\n          \"type\": \"https://witness.dev/attestations/git/v0.1\"\n        },\n        {\n          \"type\": \"https://witness.dev/attestations/command-run/v0.1\"\n        },\n        {\n          \"type\": \"https://witness.dev/attestations/product/v0.1\"\n        }\n      ],\n      \"functionaries\": [\n        {\n          \"type\": \"publickey\",\n          \"publickeyid\": \"ci-key\"\n        }\n      ]\n    },\n    \"test\": {\n      \"name\": \"test\",\n      \"attestations\": [\n        {\n          \"type\": \"https://witness.dev/attestations/material/v0.1\"\n        },\n        {\n          \"type\": \"https://witness.dev/attestations/command-run/v0.1\"\n        }\n      ],\n      \"functionaries\": [\n        {\n          \"type\": \"publickey\",\n          \"publickeyid\": \"ci-key\"\n        }\n      ]\n    },\n    \"package\": {\n      \"name\": \"package\",\n      \"attestations\": [\n        {\n          \"type\": \"https://witness.dev/attestations/material/v0.1\"\n        },\n        {\n          \"type\": \"https://witness.dev/attestations/product/v0.1\"\n        }\n      ],\n      \"functionaries\": [\n        {\n          \"type\": \"publickey\",\n          \"publickeyid\": \"ci-key\"\n        }\n      ]\n    }\n  }\n}\n```\n\n**Pipeline Commands:**\n\n```bash\n# Step 1: Build\nwitness run --step build \\\n  --attestations git,commandrun,product \\\n  -o build.json --key ci-key.pem \\\n  -- go build -o myapp\n\n# Step 2: Test\nwitness run --step test \\\n  --attestations material,commandrun \\\n  -o test.json --key ci-key.pem \\\n  -- go test ./...\n\n# Step 3: Package\nwitness run --step package \\\n  --attestations material,product \\\n  -o package.json --key ci-key.pem \\\n  -- tar czf myapp.tar.gz myapp\n\n# Verify entire pipeline\nwitness verify \\\n  --policy policy-signed.json \\\n  --publickey policy-key.pub \\\n  -a build.json -a test.json -a package.json\n```\n"}]}
{"messages": [{"role": "system", "content": "You are an expert in the Witness supply chain attestation framework. You help users instrument CI/CD pipelines with witness, create policy documents, and write Rego policies to validate attestations. You understand all attestors in go-witness and how to use them effectively."}, {"role": "user", "content": "How do I create a witness policy for a build step that uses these attestors: github, commandrun, environment, material?"}, {"role": "assistant", "content": "Here's a complete witness policy for your build step with github, commandrun, environment, material attestors:\n\n**Policy Document:**\n```json\n{\n  \"expires\": \"2026-11-08T10:52:59Z\",\n  \"publickeys\": {\n    \"build-key\": {\n      \"keyid\": \"sha256:1544b7cc436970687fcc9915690fec38bc73deaeb2c5e183d8c8cb03024c5f0e\",\n      \"key\": \"-----BEGIN PUBLIC KEY-----\\n...\\n-----END PUBLIC KEY-----\"\n    }\n  },\n  \"steps\": {\n    \"build\": {\n      \"name\": \"build\",\n      \"attestations\": [\n        {\n          \"type\": \"https://witness.dev/attestations/github/v0.1\"\n        },\n        {\n          \"type\": \"https://witness.dev/attestations/command-run/v0.1\"\n        },\n        {\n          \"type\": \"https://witness.dev/attestations/environment/v0.1\"\n        },\n        {\n          \"type\": \"https://witness.dev/attestations/material/v0.1\"\n        }\n      ],\n      \"functionaries\": [\n        {\n          \"type\": \"publickey\",\n          \"publickeyid\": \"build-key\"\n        }\n      ]\n    }\n  }\n}\n```\n\n**Witness Run Command:**\n```bash\nwitness run --step build \\\n  --attestations github,commandrun,environment,material \\\n  --outfile build-attestation.json \\\n  --key signing-key.pem \\\n  -- <your-build-command>\n```\n\n**Rego Validation Rules:**\n```rego\n\n```\n\n**Verification:**\n```bash\nwitness verify \\\n  --policy policy-signed.json \\\n  --publickey policy-key.pub \\\n  -a build-attestation.json \\\n  --subject <artifact>\n```\n"}]}
{"messages": [{"role": "system", "content": "You are an expert in the Witness supply chain attestation framework. You help users instrument CI/CD pipelines with witness, create policy documents, and write Rego policies to validate attestations. You understand all attestors in go-witness and how to use them effectively."}, {"role": "user", "content": "How do I create a witness policy for a build step that uses these attestors: environment, product, github, material?"}, {"role": "assistant", "content": "Here's a complete witness policy for your build step with environment, product, github, material attestors:\n\n**Policy Document:**\n```json\n{\n  \"expires\": \"2026-11-08T10:52:59Z\",\n  \"publickeys\": {\n    \"build-key\": {\n      \"keyid\": \"sha256:37449ccaeece7ee78ba3eb0e6c41cf4c54606d92b6a9dccc7de6e63232b7a4b7\",\n      \"key\": \"-----BEGIN PUBLIC KEY-----\\n...\\n-----END PUBLIC KEY-----\"\n    }\n  },\n  \"steps\": {\n    \"build\": {\n      \"name\": \"build\",\n      \"attestations\": [\n        {\n          \"type\": \"https://witness.dev/attestations/environment/v0.1\"\n        },\n        {\n          \"type\": \"https://witness.dev/attestations/product/v0.1\"\n        },\n        {\n          \"type\": \"https://witness.dev/attestations/github/v0.1\"\n        },\n        {\n          \"type\": \"https://witness.dev/attestations/material/v0.1\"\n        }\n      ],\n      \"functionaries\": [\n        {\n          \"type\": \"publickey\",\n          \"publickeyid\": \"build-key\"\n        }\n      ]\n    }\n  }\n}\n```\n\n**Witness Run Command:**\n```bash\nwitness run --step build \\\n  --attestations environment,product,github,material \\\n  --outfile build-attestation.json \\\n  --key signing-key.pem \\\n  -- <your-build-command>\n```\n\n**Rego Validation Rules:**\n```rego\npackage environment\n\nimport rego.v1\n\n# Ensure correct OS\ndeny contains msg if {\n    input.os != \"windows\"\n    msg := sprintf(\"Must run on windows, got: %s\", [input.os])\n}\n\n# Require CI environment\ndeny contains msg if {\n    not \"CI\" in input.variables\n    msg := \"Must run in CI environment (CI variable not set)\"\n}\n```\n\n**Verification:**\n```bash\nwitness verify \\\n  --policy policy-signed.json \\\n  --publickey policy-key.pub \\\n  -a build-attestation.json \\\n  --subject <artifact>\n```\n"}]}
{"messages": [{"role": "system", "content": "You are an expert in the Witness supply chain attestation framework. You help users instrument CI/CD pipelines with witness, create policy documents, and write Rego policies to validate attestations. You understand all attestors in go-witness and how to use them effectively."}, {"role": "user", "content": "How do I create a witness policy for a build step that uses these attestors: git, material, environment?"}, {"role": "assistant", "content": "Here's a complete witness policy for your build step with git, material, environment attestors:\n\n**Policy Document:**\n```json\n{\n  \"expires\": \"2026-11-08T10:52:59Z\",\n  \"publickeys\": {\n    \"build-key\": {\n      \"keyid\": \"sha256:d88e3edd20eab25def219920618b60a35b04934182615cf58a6a74f722dca44f\",\n      \"key\": \"-----BEGIN PUBLIC KEY-----\\n...\\n-----END PUBLIC KEY-----\"\n    }\n  },\n  \"steps\": {\n    \"build\": {\n      \"name\": \"build\",\n      \"attestations\": [\n        {\n          \"type\": \"https://witness.dev/attestations/git/v0.1\"\n        },\n        {\n          \"type\": \"https://witness.dev/attestations/material/v0.1\"\n        },\n        {\n          \"type\": \"https://witness.dev/attestations/environment/v0.1\"\n        }\n      ],\n      \"functionaries\": [\n        {\n          \"type\": \"publickey\",\n          \"publickeyid\": \"build-key\"\n        }\n      ]\n    }\n  }\n}\n```\n\n**Witness Run Command:**\n```bash\nwitness run --step build \\\n  --attestations git,material,environment \\\n  --outfile build-attestation.json \\\n  --key signing-key.pem \\\n  -- <your-build-command>\n```\n\n**Rego Validation Rules:**\n```rego\npackage git\n\nimport rego.v1\n\n# Enforce builds from specific branch\ndeny contains msg if {\n    input.branch != \"hotfix/critical\"\n    msg := sprintf(\"Must build from hotfix/critical branch, got: %s\", [input.branch])\n}\n\n# Require clean working directory\ndeny contains msg if {\n    count(input.status) > 0\n    msg := \"Working directory must be clean (no uncommitted changes)\"\n}\n\n# Validate commit author\napproved_authors := {\n    \"alice.smith@example.com\",\n    \"bob.jones@company.com\",\n    \"ci-bot@company.com\"\n}\n\ndeny contains msg if {\n    not input.authoremail in approved_authors\n    msg := sprintf(\"Unauthorized commit author: %s\", [input.authoremail])\n}\n```\n\n**Verification:**\n```bash\nwitness verify \\\n  --policy policy-signed.json \\\n  --publickey policy-key.pub \\\n  -a build-attestation.json \\\n  --subject <artifact>\n```\n"}]}
{"messages": [{"role": "system", "content": "You are an expert in the Witness supply chain attestation framework. You help users instrument CI/CD pipelines with witness, create policy documents, and write Rego policies to validate attestations. You understand all attestors in go-witness and how to use them effectively."}, {"role": "user", "content": "How do I create a witness policy for a build step that uses these attestors: commandrun?"}, {"role": "assistant", "content": "Here's a complete witness policy for your build step with commandrun attestors:\n\n**Policy Document:**\n```json\n{\n  \"expires\": \"2026-11-08T10:52:59Z\",\n  \"publickeys\": {\n    \"build-key\": {\n      \"keyid\": \"sha256:a4ec59e3245017b1793ef536c01909b2925f2e5f74d8f2c8fbbd2fa395a69c1e\",\n      \"key\": \"-----BEGIN PUBLIC KEY-----\\n...\\n-----END PUBLIC KEY-----\"\n    }\n  },\n  \"steps\": {\n    \"build\": {\n      \"name\": \"build\",\n      \"attestations\": [\n        {\n          \"type\": \"https://witness.dev/attestations/command-run/v0.1\"\n        }\n      ],\n      \"functionaries\": [\n        {\n          \"type\": \"publickey\",\n          \"publickeyid\": \"build-key\"\n        }\n      ]\n    }\n  }\n}\n```\n\n**Witness Run Command:**\n```bash\nwitness run --step build \\\n  --attestations commandrun \\\n  --outfile build-attestation.json \\\n  --key signing-key.pem \\\n  -- <your-build-command>\n```\n\n**Rego Validation Rules:**\n```rego\n\n```\n\n**Verification:**\n```bash\nwitness verify \\\n  --policy policy-signed.json \\\n  --publickey policy-key.pub \\\n  -a build-attestation.json \\\n  --subject <artifact>\n```\n"}]}
{"messages": [{"role": "system", "content": "You are an expert in the Witness supply chain attestation framework. You help users instrument CI/CD pipelines with witness, create policy documents, and write Rego policies to validate attestations. You understand all attestors in go-witness and how to use them effectively."}, {"role": "user", "content": "How do I create a witness policy for a build step that uses these attestors: git, environment?"}, {"role": "assistant", "content": "Here's a complete witness policy for your build step with git, environment attestors:\n\n**Policy Document:**\n```json\n{\n  \"expires\": \"2026-11-08T10:52:59Z\",\n  \"publickeys\": {\n    \"build-key\": {\n      \"keyid\": \"sha256:32c9de9a9c69d61a2789aeb1ffce454bcf90b84bc87f16a28dd832933ef205bc\",\n      \"key\": \"-----BEGIN PUBLIC KEY-----\\n...\\n-----END PUBLIC KEY-----\"\n    }\n  },\n  \"steps\": {\n    \"build\": {\n      \"name\": \"build\",\n      \"attestations\": [\n        {\n          \"type\": \"https://witness.dev/attestations/git/v0.1\"\n        },\n        {\n          \"type\": \"https://witness.dev/attestations/environment/v0.1\"\n        }\n      ],\n      \"functionaries\": [\n        {\n          \"type\": \"publickey\",\n          \"publickeyid\": \"build-key\"\n        }\n      ]\n    }\n  }\n}\n```\n\n**Witness Run Command:**\n```bash\nwitness run --step build \\\n  --attestations git,environment \\\n  --outfile build-attestation.json \\\n  --key signing-key.pem \\\n  -- <your-build-command>\n```\n\n**Rego Validation Rules:**\n```rego\npackage git\n\nimport rego.v1\n\n# Enforce builds from specific branch\ndeny contains msg if {\n    input.branch != \"develop\"\n    msg := sprintf(\"Must build from develop branch, got: %s\", [input.branch])\n}\n\n# Validate commit author\napproved_authors := {\n    \"alice.smith@example.com\",\n    \"bob.jones@company.com\",\n    \"ci-bot@company.com\"\n}\n\ndeny contains msg if {\n    not input.authoremail in approved_authors\n    msg := sprintf(\"Unauthorized commit author: %s\", [input.authoremail])\n}\n```\n\n**Verification:**\n```bash\nwitness verify \\\n  --policy policy-signed.json \\\n  --publickey policy-key.pub \\\n  -a build-attestation.json \\\n  --subject <artifact>\n```\n"}]}
{"messages": [{"role": "system", "content": "You are an expert in the Witness supply chain attestation framework. You help users instrument CI/CD pipelines with witness, create policy documents, and write Rego policies to validate attestations. You understand all attestors in go-witness and how to use them effectively."}, {"role": "user", "content": "How do I create a multi-step witness policy for a build \u2192 test \u2192 package pipeline?"}, {"role": "assistant", "content": "Here's a complete multi-step witness policy for your pipeline:\n\n**Policy Document:**\n```json\n{\n  \"expires\": \"2026-11-08T10:52:59Z\",\n  \"publickeys\": {\n    \"ci-key\": {\n      \"keyid\": \"sha256:128f415c8aa1554973395e2b38dbad3ac9bb0cbf79e41a972aaa162d8f742cce\",\n      \"key\": \"-----BEGIN PUBLIC KEY-----\\n...\\n-----END PUBLIC KEY-----\"\n    }\n  },\n  \"steps\": {\n    \"build\": {\n      \"name\": \"build\",\n      \"attestations\": [\n        {\n          \"type\": \"https://witness.dev/attestations/git/v0.1\"\n        },\n        {\n          \"type\": \"https://witness.dev/attestations/command-run/v0.1\"\n        },\n        {\n          \"type\": \"https://witness.dev/attestations/product/v0.1\"\n        }\n      ],\n      \"functionaries\": [\n        {\n          \"type\": \"publickey\",\n          \"publickeyid\": \"ci-key\"\n        }\n      ]\n    },\n    \"test\": {\n      \"name\": \"test\",\n      \"attestations\": [\n        {\n          \"type\": \"https://witness.dev/attestations/material/v0.1\"\n        },\n        {\n          \"type\": \"https://witness.dev/attestations/command-run/v0.1\"\n        }\n      ],\n      \"functionaries\": [\n        {\n          \"type\": \"publickey\",\n          \"publickeyid\": \"ci-key\"\n        }\n      ]\n    },\n    \"package\": {\n      \"name\": \"package\",\n      \"attestations\": [\n        {\n          \"type\": \"https://witness.dev/attestations/material/v0.1\"\n        },\n        {\n          \"type\": \"https://witness.dev/attestations/product/v0.1\"\n        }\n      ],\n      \"functionaries\": [\n        {\n          \"type\": \"publickey\",\n          \"publickeyid\": \"ci-key\"\n        }\n      ]\n    }\n  }\n}\n```\n\n**Pipeline Commands:**\n\n```bash\n# Step 1: Build\nwitness run --step build \\\n  --attestations git,commandrun,product \\\n  -o build.json --key ci-key.pem \\\n  -- go build -o myapp\n\n# Step 2: Test\nwitness run --step test \\\n  --attestations material,commandrun \\\n  -o test.json --key ci-key.pem \\\n  -- go test ./...\n\n# Step 3: Package\nwitness run --step package \\\n  --attestations material,product \\\n  -o package.json --key ci-key.pem \\\n  -- tar czf myapp.tar.gz myapp\n\n# Verify entire pipeline\nwitness verify \\\n  --policy policy-signed.json \\\n  --publickey policy-key.pub \\\n  -a build.json -a test.json -a package.json\n```\n"}]}
{"messages": [{"role": "system", "content": "You are an expert in the Witness supply chain attestation framework. You help users instrument CI/CD pipelines with witness, create policy documents, and write Rego policies to validate attestations. You understand all attestors in go-witness and how to use them effectively."}, {"role": "user", "content": "How do I create a multi-step witness policy for a build \u2192 test \u2192 package pipeline?"}, {"role": "assistant", "content": "Here's a complete multi-step witness policy for your pipeline:\n\n**Policy Document:**\n```json\n{\n  \"expires\": \"2026-11-08T10:52:59Z\",\n  \"publickeys\": {\n    \"ci-key\": {\n      \"keyid\": \"sha256:c635e8cd89aec143b8f87c61d41b8fdb1359992ecc8f1af20e8f871c6eb89742\",\n      \"key\": \"-----BEGIN PUBLIC KEY-----\\n...\\n-----END PUBLIC KEY-----\"\n    }\n  },\n  \"steps\": {\n    \"build\": {\n      \"name\": \"build\",\n      \"attestations\": [\n        {\n          \"type\": \"https://witness.dev/attestations/git/v0.1\"\n        },\n        {\n          \"type\": \"https://witness.dev/attestations/command-run/v0.1\"\n        },\n        {\n          \"type\": \"https://witness.dev/attestations/product/v0.1\"\n        }\n      ],\n      \"functionaries\": [\n        {\n          \"type\": \"publickey\",\n          \"publickeyid\": \"ci-key\"\n        }\n      ]\n    },\n    \"test\": {\n      \"name\": \"test\",\n      \"attestations\": [\n        {\n          \"type\": \"https://witness.dev/attestations/material/v0.1\"\n        },\n        {\n          \"type\": \"https://witness.dev/attestations/command-run/v0.1\"\n        }\n      ],\n      \"functionaries\": [\n        {\n          \"type\": \"publickey\",\n          \"publickeyid\": \"ci-key\"\n        }\n      ]\n    },\n    \"package\": {\n      \"name\": \"package\",\n      \"attestations\": [\n        {\n          \"type\": \"https://witness.dev/attestations/material/v0.1\"\n        },\n        {\n          \"type\": \"https://witness.dev/attestations/product/v0.1\"\n        }\n      ],\n      \"functionaries\": [\n        {\n          \"type\": \"publickey\",\n          \"publickeyid\": \"ci-key\"\n        }\n      ]\n    }\n  }\n}\n```\n\n**Pipeline Commands:**\n\n```bash\n# Step 1: Build\nwitness run --step build \\\n  --attestations git,commandrun,product \\\n  -o build.json --key ci-key.pem \\\n  -- go build -o myapp\n\n# Step 2: Test\nwitness run --step test \\\n  --attestations material,commandrun \\\n  -o test.json --key ci-key.pem \\\n  -- go test ./...\n\n# Step 3: Package\nwitness run --step package \\\n  --attestations material,product \\\n  -o package.json --key ci-key.pem \\\n  -- tar czf myapp.tar.gz myapp\n\n# Verify entire pipeline\nwitness verify \\\n  --policy policy-signed.json \\\n  --publickey policy-key.pub \\\n  -a build.json -a test.json -a package.json\n```\n"}]}
{"messages": [{"role": "system", "content": "You are an expert in the Witness supply chain attestation framework. You help users instrument CI/CD pipelines with witness, create policy documents, and write Rego policies to validate attestations. You understand all attestors in go-witness and how to use them effectively."}, {"role": "user", "content": "How do I create a multi-step witness policy for a build \u2192 test \u2192 package pipeline?"}, {"role": "assistant", "content": "Here's a complete multi-step witness policy for your pipeline:\n\n**Policy Document:**\n```json\n{\n  \"expires\": \"2026-11-08T10:52:59Z\",\n  \"publickeys\": {\n    \"ci-key\": {\n      \"keyid\": \"sha256:3cc9d4c9735e49bd3fa875a5aba859706e5bd95709e2fd78ea994093c454ec0d\",\n      \"key\": \"-----BEGIN PUBLIC KEY-----\\n...\\n-----END PUBLIC KEY-----\"\n    }\n  },\n  \"steps\": {\n    \"build\": {\n      \"name\": \"build\",\n      \"attestations\": [\n        {\n          \"type\": \"https://witness.dev/attestations/git/v0.1\"\n        },\n        {\n          \"type\": \"https://witness.dev/attestations/command-run/v0.1\"\n        },\n        {\n          \"type\": \"https://witness.dev/attestations/product/v0.1\"\n        }\n      ],\n      \"functionaries\": [\n        {\n          \"type\": \"publickey\",\n          \"publickeyid\": \"ci-key\"\n        }\n      ]\n    },\n    \"test\": {\n      \"name\": \"test\",\n      \"attestations\": [\n        {\n          \"type\": \"https://witness.dev/attestations/material/v0.1\"\n        },\n        {\n          \"type\": \"https://witness.dev/attestations/command-run/v0.1\"\n        }\n      ],\n      \"functionaries\": [\n        {\n          \"type\": \"publickey\",\n          \"publickeyid\": \"ci-key\"\n        }\n      ]\n    },\n    \"package\": {\n      \"name\": \"package\",\n      \"attestations\": [\n        {\n          \"type\": \"https://witness.dev/attestations/material/v0.1\"\n        },\n        {\n          \"type\": \"https://witness.dev/attestations/product/v0.1\"\n        }\n      ],\n      \"functionaries\": [\n        {\n          \"type\": \"publickey\",\n          \"publickeyid\": \"ci-key\"\n        }\n      ]\n    }\n  }\n}\n```\n\n**Pipeline Commands:**\n\n```bash\n# Step 1: Build\nwitness run --step build \\\n  --attestations git,commandrun,product \\\n  -o build.json --key ci-key.pem \\\n  -- go build -o myapp\n\n# Step 2: Test\nwitness run --step test \\\n  --attestations material,commandrun \\\n  -o test.json --key ci-key.pem \\\n  -- go test ./...\n\n# Step 3: Package\nwitness run --step package \\\n  --attestations material,product \\\n  -o package.json --key ci-key.pem \\\n  -- tar czf myapp.tar.gz myapp\n\n# Verify entire pipeline\nwitness verify \\\n  --policy policy-signed.json \\\n  --publickey policy-key.pub \\\n  -a build.json -a test.json -a package.json\n```\n"}]}
{"messages": [{"role": "system", "content": "You are an expert in the Witness supply chain attestation framework. You help users instrument CI/CD pipelines with witness, create policy documents, and write Rego policies to validate attestations. You understand all attestors in go-witness and how to use them effectively."}, {"role": "user", "content": "How do I create a multi-step witness policy for a build \u2192 test \u2192 package pipeline?"}, {"role": "assistant", "content": "Here's a complete multi-step witness policy for your pipeline:\n\n**Policy Document:**\n```json\n{\n  \"expires\": \"2026-11-08T10:52:59Z\",\n  \"publickeys\": {\n    \"ci-key\": {\n      \"keyid\": \"sha256:4f125a408db7abdbac8ef5b786646fdc0955c84bb27cef7d7894ff37ed8f0f81\",\n      \"key\": \"-----BEGIN PUBLIC KEY-----\\n...\\n-----END PUBLIC KEY-----\"\n    }\n  },\n  \"steps\": {\n    \"build\": {\n      \"name\": \"build\",\n      \"attestations\": [\n        {\n          \"type\": \"https://witness.dev/attestations/git/v0.1\"\n        },\n        {\n          \"type\": \"https://witness.dev/attestations/command-run/v0.1\"\n        },\n        {\n          \"type\": \"https://witness.dev/attestations/product/v0.1\"\n        }\n      ],\n      \"functionaries\": [\n        {\n          \"type\": \"publickey\",\n          \"publickeyid\": \"ci-key\"\n        }\n      ]\n    },\n    \"test\": {\n      \"name\": \"test\",\n      \"attestations\": [\n        {\n          \"type\": \"https://witness.dev/attestations/material/v0.1\"\n        },\n        {\n          \"type\": \"https://witness.dev/attestations/command-run/v0.1\"\n        }\n      ],\n      \"functionaries\": [\n        {\n          \"type\": \"publickey\",\n          \"publickeyid\": \"ci-key\"\n        }\n      ]\n    },\n    \"package\": {\n      \"name\": \"package\",\n      \"attestations\": [\n        {\n          \"type\": \"https://witness.dev/attestations/material/v0.1\"\n        },\n        {\n          \"type\": \"https://witness.dev/attestations/product/v0.1\"\n        }\n      ],\n      \"functionaries\": [\n        {\n          \"type\": \"publickey\",\n          \"publickeyid\": \"ci-key\"\n        }\n      ]\n    }\n  }\n}\n```\n\n**Pipeline Commands:**\n\n```bash\n# Step 1: Build\nwitness run --step build \\\n  --attestations git,commandrun,product \\\n  -o build.json --key ci-key.pem \\\n  -- go build -o myapp\n\n# Step 2: Test\nwitness run --step test \\\n  --attestations material,commandrun \\\n  -o test.json --key ci-key.pem \\\n  -- go test ./...\n\n# Step 3: Package\nwitness run --step package \\\n  --attestations material,product \\\n  -o package.json --key ci-key.pem \\\n  -- tar czf myapp.tar.gz myapp\n\n# Verify entire pipeline\nwitness verify \\\n  --policy policy-signed.json \\\n  --publickey policy-key.pub \\\n  -a build.json -a test.json -a package.json\n```\n"}]}
{"messages": [{"role": "system", "content": "You are an expert in the Witness supply chain attestation framework. You help users instrument CI/CD pipelines with witness, create policy documents, and write Rego policies to validate attestations. You understand all attestors in go-witness and how to use them effectively."}, {"role": "user", "content": "How do I create a witness policy for a build step that uses these attestors: environment, commandrun?"}, {"role": "assistant", "content": "Here's a complete witness policy for your build step with environment, commandrun attestors:\n\n**Policy Document:**\n```json\n{\n  \"expires\": \"2026-11-08T10:52:59Z\",\n  \"publickeys\": {\n    \"build-key\": {\n      \"keyid\": \"sha256:6dcb0320c9079e507e4e5097348bf4cd1a3dfa27a146ae2b31130f22fd88018e\",\n      \"key\": \"-----BEGIN PUBLIC KEY-----\\n...\\n-----END PUBLIC KEY-----\"\n    }\n  },\n  \"steps\": {\n    \"build\": {\n      \"name\": \"build\",\n      \"attestations\": [\n        {\n          \"type\": \"https://witness.dev/attestations/environment/v0.1\"\n        },\n        {\n          \"type\": \"https://witness.dev/attestations/command-run/v0.1\"\n        }\n      ],\n      \"functionaries\": [\n        {\n          \"type\": \"publickey\",\n          \"publickeyid\": \"build-key\"\n        }\n      ]\n    }\n  }\n}\n```\n\n**Witness Run Command:**\n```bash\nwitness run --step build \\\n  --attestations environment,commandrun \\\n  --outfile build-attestation.json \\\n  --key signing-key.pem \\\n  -- <your-build-command>\n```\n\n**Rego Validation Rules:**\n```rego\npackage environment\n\nimport rego.v1\n\n# Ensure correct OS\ndeny contains msg if {\n    input.os != \"linux\"\n    msg := sprintf(\"Must run on linux, got: %s\", [input.os])\n}\n\n# Require CI environment\ndeny contains msg if {\n    not \"CI\" in input.variables\n    msg := \"Must run in CI environment (CI variable not set)\"\n}\n```\n\n**Verification:**\n```bash\nwitness verify \\\n  --policy policy-signed.json \\\n  --publickey policy-key.pub \\\n  -a build-attestation.json \\\n  --subject <artifact>\n```\n"}]}
{"messages": [{"role": "system", "content": "You are an expert in the Witness supply chain attestation framework. You help users instrument CI/CD pipelines with witness, create policy documents, and write Rego policies to validate attestations. You understand all attestors in go-witness and how to use them effectively."}, {"role": "user", "content": "How do I create a witness policy for a build step that uses these attestors: material, environment, commandrun?"}, {"role": "assistant", "content": "Here's a complete witness policy for your build step with material, environment, commandrun attestors:\n\n**Policy Document:**\n```json\n{\n  \"expires\": \"2026-11-08T10:52:59Z\",\n  \"publickeys\": {\n    \"build-key\": {\n      \"keyid\": \"sha256:632c9906aa81a13a6bab42255fdf4c3f4e7d9e99a9c37f877dd6347608fda4c0\",\n      \"key\": \"-----BEGIN PUBLIC KEY-----\\n...\\n-----END PUBLIC KEY-----\"\n    }\n  },\n  \"steps\": {\n    \"build\": {\n      \"name\": \"build\",\n      \"attestations\": [\n        {\n          \"type\": \"https://witness.dev/attestations/material/v0.1\"\n        },\n        {\n          \"type\": \"https://witness.dev/attestations/environment/v0.1\"\n        },\n        {\n          \"type\": \"https://witness.dev/attestations/command-run/v0.1\"\n        }\n      ],\n      \"functionaries\": [\n        {\n          \"type\": \"publickey\",\n          \"publickeyid\": \"build-key\"\n        }\n      ]\n    }\n  }\n}\n```\n\n**Witness Run Command:**\n```bash\nwitness run --step build \\\n  --attestations material,environment,commandrun \\\n  --outfile build-attestation.json \\\n  --key signing-key.pem \\\n  -- <your-build-command>\n```\n\n**Rego Validation Rules:**\n```rego\n\n```\n\n**Verification:**\n```bash\nwitness verify \\\n  --policy policy-signed.json \\\n  --publickey policy-key.pub \\\n  -a build-attestation.json \\\n  --subject <artifact>\n```\n"}]}
{"messages": [{"role": "system", "content": "You are an expert in the Witness supply chain attestation framework. You help users instrument CI/CD pipelines with witness, create policy documents, and write Rego policies to validate attestations. You understand all attestors in go-witness and how to use them effectively."}, {"role": "user", "content": "How do I create a multi-step witness policy for a build \u2192 test \u2192 package pipeline?"}, {"role": "assistant", "content": "Here's a complete multi-step witness policy for your pipeline:\n\n**Policy Document:**\n```json\n{\n  \"expires\": \"2026-11-08T10:52:59Z\",\n  \"publickeys\": {\n    \"ci-key\": {\n      \"keyid\": \"sha256:6e85589bdeee38954ceab8484470e6e148e2ade65de8e5c018485692f0b948d5\",\n      \"key\": \"-----BEGIN PUBLIC KEY-----\\n...\\n-----END PUBLIC KEY-----\"\n    }\n  },\n  \"steps\": {\n    \"build\": {\n      \"name\": \"build\",\n      \"attestations\": [\n        {\n          \"type\": \"https://witness.dev/attestations/git/v0.1\"\n        },\n        {\n          \"type\": \"https://witness.dev/attestations/command-run/v0.1\"\n        },\n        {\n          \"type\": \"https://witness.dev/attestations/product/v0.1\"\n        }\n      ],\n      \"functionaries\": [\n        {\n          \"type\": \"publickey\",\n          \"publickeyid\": \"ci-key\"\n        }\n      ]\n    },\n    \"test\": {\n      \"name\": \"test\",\n      \"attestations\": [\n        {\n          \"type\": \"https://witness.dev/attestations/material/v0.1\"\n        },\n        {\n          \"type\": \"https://witness.dev/attestations/command-run/v0.1\"\n        }\n      ],\n      \"functionaries\": [\n        {\n          \"type\": \"publickey\",\n          \"publickeyid\": \"ci-key\"\n        }\n      ]\n    },\n    \"package\": {\n      \"name\": \"package\",\n      \"attestations\": [\n        {\n          \"type\": \"https://witness.dev/attestations/material/v0.1\"\n        },\n        {\n          \"type\": \"https://witness.dev/attestations/product/v0.1\"\n        }\n      ],\n      \"functionaries\": [\n        {\n          \"type\": \"publickey\",\n          \"publickeyid\": \"ci-key\"\n        }\n      ]\n    }\n  }\n}\n```\n\n**Pipeline Commands:**\n\n```bash\n# Step 1: Build\nwitness run --step build \\\n  --attestations git,commandrun,product \\\n  -o build.json --key ci-key.pem \\\n  -- go build -o myapp\n\n# Step 2: Test\nwitness run --step test \\\n  --attestations material,commandrun \\\n  -o test.json --key ci-key.pem \\\n  -- go test ./...\n\n# Step 3: Package\nwitness run --step package \\\n  --attestations material,product \\\n  -o package.json --key ci-key.pem \\\n  -- tar czf myapp.tar.gz myapp\n\n# Verify entire pipeline\nwitness verify \\\n  --policy policy-signed.json \\\n  --publickey policy-key.pub \\\n  -a build.json -a test.json -a package.json\n```\n"}]}
{"messages": [{"role": "system", "content": "You are an expert in the Witness supply chain attestation framework. You help users instrument CI/CD pipelines with witness, create policy documents, and write Rego policies to validate attestations. You understand all attestors in go-witness and how to use them effectively."}, {"role": "user", "content": "How do I create a witness policy for a build step that uses these attestors: github, commandrun, product, environment, material?"}, {"role": "assistant", "content": "Here's a complete witness policy for your build step with github, commandrun, product, environment, material attestors:\n\n**Policy Document:**\n```json\n{\n  \"expires\": \"2026-11-08T10:52:59Z\",\n  \"publickeys\": {\n    \"build-key\": {\n      \"keyid\": \"sha256:9efdeb7542865bc98509cb83041831ddbc8112a520e6d48f43e32d36f3c2b4ea\",\n      \"key\": \"-----BEGIN PUBLIC KEY-----\\n...\\n-----END PUBLIC KEY-----\"\n    }\n  },\n  \"steps\": {\n    \"build\": {\n      \"name\": \"build\",\n      \"attestations\": [\n        {\n          \"type\": \"https://witness.dev/attestations/github/v0.1\"\n        },\n        {\n          \"type\": \"https://witness.dev/attestations/command-run/v0.1\"\n        },\n        {\n          \"type\": \"https://witness.dev/attestations/product/v0.1\"\n        },\n        {\n          \"type\": \"https://witness.dev/attestations/environment/v0.1\"\n        },\n        {\n          \"type\": \"https://witness.dev/attestations/material/v0.1\"\n        }\n      ],\n      \"functionaries\": [\n        {\n          \"type\": \"publickey\",\n          \"publickeyid\": \"build-key\"\n        }\n      ]\n    }\n  }\n}\n```\n\n**Witness Run Command:**\n```bash\nwitness run --step build \\\n  --attestations github,commandrun,product,environment,material \\\n  --outfile build-attestation.json \\\n  --key signing-key.pem \\\n  -- <your-build-command>\n```\n\n**Rego Validation Rules:**\n```rego\n\n```\n\n**Verification:**\n```bash\nwitness verify \\\n  --policy policy-signed.json \\\n  --publickey policy-key.pub \\\n  -a build-attestation.json \\\n  --subject <artifact>\n```\n"}]}
{"messages": [{"role": "system", "content": "You are an expert in the Witness supply chain attestation framework. You help users instrument CI/CD pipelines with witness, create policy documents, and write Rego policies to validate attestations. You understand all attestors in go-witness and how to use them effectively."}, {"role": "user", "content": "How do I create a multi-step witness policy for a build \u2192 test \u2192 package pipeline?"}, {"role": "assistant", "content": "Here's a complete multi-step witness policy for your pipeline:\n\n**Policy Document:**\n```json\n{\n  \"expires\": \"2026-11-08T10:52:59Z\",\n  \"publickeys\": {\n    \"ci-key\": {\n      \"keyid\": \"sha256:fd4dc690b7c0a828a654f65a1593456004b26e9188758ec953763ef1cb7cfcaa\",\n      \"key\": \"-----BEGIN PUBLIC KEY-----\\n...\\n-----END PUBLIC KEY-----\"\n    }\n  },\n  \"steps\": {\n    \"build\": {\n      \"name\": \"build\",\n      \"attestations\": [\n        {\n          \"type\": \"https://witness.dev/attestations/git/v0.1\"\n        },\n        {\n          \"type\": \"https://witness.dev/attestations/command-run/v0.1\"\n        },\n        {\n          \"type\": \"https://witness.dev/attestations/product/v0.1\"\n        }\n      ],\n      \"functionaries\": [\n        {\n          \"type\": \"publickey\",\n          \"publickeyid\": \"ci-key\"\n        }\n      ]\n    },\n    \"test\": {\n      \"name\": \"test\",\n      \"attestations\": [\n        {\n          \"type\": \"https://witness.dev/attestations/material/v0.1\"\n        },\n        {\n          \"type\": \"https://witness.dev/attestations/command-run/v0.1\"\n        }\n      ],\n      \"functionaries\": [\n        {\n          \"type\": \"publickey\",\n          \"publickeyid\": \"ci-key\"\n        }\n      ]\n    },\n    \"package\": {\n      \"name\": \"package\",\n      \"attestations\": [\n        {\n          \"type\": \"https://witness.dev/attestations/material/v0.1\"\n        },\n        {\n          \"type\": \"https://witness.dev/attestations/product/v0.1\"\n        }\n      ],\n      \"functionaries\": [\n        {\n          \"type\": \"publickey\",\n          \"publickeyid\": \"ci-key\"\n        }\n      ]\n    }\n  }\n}\n```\n\n**Pipeline Commands:**\n\n```bash\n# Step 1: Build\nwitness run --step build \\\n  --attestations git,commandrun,product \\\n  -o build.json --key ci-key.pem \\\n  -- go build -o myapp\n\n# Step 2: Test\nwitness run --step test \\\n  --attestations material,commandrun \\\n  -o test.json --key ci-key.pem \\\n  -- go test ./...\n\n# Step 3: Package\nwitness run --step package \\\n  --attestations material,product \\\n  -o package.json --key ci-key.pem \\\n  -- tar czf myapp.tar.gz myapp\n\n# Verify entire pipeline\nwitness verify \\\n  --policy policy-signed.json \\\n  --publickey policy-key.pub \\\n  -a build.json -a test.json -a package.json\n```\n"}]}
{"messages": [{"role": "system", "content": "You are an expert in the Witness supply chain attestation framework. You help users instrument CI/CD pipelines with witness, create policy documents, and write Rego policies to validate attestations. You understand all attestors in go-witness and how to use them effectively."}, {"role": "user", "content": "How do I create a multi-step witness policy for a build \u2192 test \u2192 package pipeline?"}, {"role": "assistant", "content": "Here's a complete multi-step witness policy for your pipeline:\n\n**Policy Document:**\n```json\n{\n  \"expires\": \"2026-11-08T10:52:59Z\",\n  \"publickeys\": {\n    \"ci-key\": {\n      \"keyid\": \"sha256:f4a170834cd37436bae6884b41ffd57ba22992348c47a26271a621b40ca5c4dd\",\n      \"key\": \"-----BEGIN PUBLIC KEY-----\\n...\\n-----END PUBLIC KEY-----\"\n    }\n  },\n  \"steps\": {\n    \"build\": {\n      \"name\": \"build\",\n      \"attestations\": [\n        {\n          \"type\": \"https://witness.dev/attestations/git/v0.1\"\n        },\n        {\n          \"type\": \"https://witness.dev/attestations/command-run/v0.1\"\n        },\n        {\n          \"type\": \"https://witness.dev/attestations/product/v0.1\"\n        }\n      ],\n      \"functionaries\": [\n        {\n          \"type\": \"publickey\",\n          \"publickeyid\": \"ci-key\"\n        }\n      ]\n    },\n    \"test\": {\n      \"name\": \"test\",\n      \"attestations\": [\n        {\n          \"type\": \"https://witness.dev/attestations/material/v0.1\"\n        },\n        {\n          \"type\": \"https://witness.dev/attestations/command-run/v0.1\"\n        }\n      ],\n      \"functionaries\": [\n        {\n          \"type\": \"publickey\",\n          \"publickeyid\": \"ci-key\"\n        }\n      ]\n    },\n    \"package\": {\n      \"name\": \"package\",\n      \"attestations\": [\n        {\n          \"type\": \"https://witness.dev/attestations/material/v0.1\"\n        },\n        {\n          \"type\": \"https://witness.dev/attestations/product/v0.1\"\n        }\n      ],\n      \"functionaries\": [\n        {\n          \"type\": \"publickey\",\n          \"publickeyid\": \"ci-key\"\n        }\n      ]\n    }\n  }\n}\n```\n\n**Pipeline Commands:**\n\n```bash\n# Step 1: Build\nwitness run --step build \\\n  --attestations git,commandrun,product \\\n  -o build.json --key ci-key.pem \\\n  -- go build -o myapp\n\n# Step 2: Test\nwitness run --step test \\\n  --attestations material,commandrun \\\n  -o test.json --key ci-key.pem \\\n  -- go test ./...\n\n# Step 3: Package\nwitness run --step package \\\n  --attestations material,product \\\n  -o package.json --key ci-key.pem \\\n  -- tar czf myapp.tar.gz myapp\n\n# Verify entire pipeline\nwitness verify \\\n  --policy policy-signed.json \\\n  --publickey policy-key.pub \\\n  -a build.json -a test.json -a package.json\n```\n"}]}
{"messages": [{"role": "system", "content": "You are an expert in the Witness supply chain attestation framework. You help users instrument CI/CD pipelines with witness, create policy documents, and write Rego policies to validate attestations. You understand all attestors in go-witness and how to use them effectively."}, {"role": "user", "content": "How do I create a witness policy for a build step that uses these attestors: git, product, github, environment, material?"}, {"role": "assistant", "content": "Here's a complete witness policy for your build step with git, product, github, environment, material attestors:\n\n**Policy Document:**\n```json\n{\n  \"expires\": \"2026-11-08T10:52:59Z\",\n  \"publickeys\": {\n    \"build-key\": {\n      \"keyid\": \"sha256:04cfcc964c13c9d54766c890a99e83001acd51ccc496459112a00bdbec81e371\",\n      \"key\": \"-----BEGIN PUBLIC KEY-----\\n...\\n-----END PUBLIC KEY-----\"\n    }\n  },\n  \"steps\": {\n    \"build\": {\n      \"name\": \"build\",\n      \"attestations\": [\n        {\n          \"type\": \"https://witness.dev/attestations/git/v0.1\"\n        },\n        {\n          \"type\": \"https://witness.dev/attestations/product/v0.1\"\n        },\n        {\n          \"type\": \"https://witness.dev/attestations/github/v0.1\"\n        },\n        {\n          \"type\": \"https://witness.dev/attestations/environment/v0.1\"\n        },\n        {\n          \"type\": \"https://witness.dev/attestations/material/v0.1\"\n        }\n      ],\n      \"functionaries\": [\n        {\n          \"type\": \"publickey\",\n          \"publickeyid\": \"build-key\"\n        }\n      ]\n    }\n  }\n}\n```\n\n**Witness Run Command:**\n```bash\nwitness run --step build \\\n  --attestations git,product,github,environment,material \\\n  --outfile build-attestation.json \\\n  --key signing-key.pem \\\n  -- <your-build-command>\n```\n\n**Rego Validation Rules:**\n```rego\npackage git\n\nimport rego.v1\n\n# Enforce builds from specific branch\ndeny contains msg if {\n    input.branch != \"bugfix/security\"\n    msg := sprintf(\"Must build from bugfix/security branch, got: %s\", [input.branch])\n}\n\n# Validate commit author\napproved_authors := {\n    \"alice.smith@example.com\",\n    \"bob.jones@company.com\",\n    \"ci-bot@company.com\"\n}\n\ndeny contains msg if {\n    not input.authoremail in approved_authors\n    msg := sprintf(\"Unauthorized commit author: %s\", [input.authoremail])\n}\n```\n\n**Verification:**\n```bash\nwitness verify \\\n  --policy policy-signed.json \\\n  --publickey policy-key.pub \\\n  -a build-attestation.json \\\n  --subject <artifact>\n```\n"}]}
{"messages": [{"role": "system", "content": "You are an expert in the Witness supply chain attestation framework. You help users instrument CI/CD pipelines with witness, create policy documents, and write Rego policies to validate attestations. You understand all attestors in go-witness and how to use them effectively."}, {"role": "user", "content": "How do I create a multi-step witness policy for a build \u2192 test \u2192 package pipeline?"}, {"role": "assistant", "content": "Here's a complete multi-step witness policy for your pipeline:\n\n**Policy Document:**\n```json\n{\n  \"expires\": \"2026-11-08T10:52:59Z\",\n  \"publickeys\": {\n    \"ci-key\": {\n      \"keyid\": \"sha256:8df5089080b7121ba44f78900baee8963238bafb9b0e388b34365af2e311320d\",\n      \"key\": \"-----BEGIN PUBLIC KEY-----\\n...\\n-----END PUBLIC KEY-----\"\n    }\n  },\n  \"steps\": {\n    \"build\": {\n      \"name\": \"build\",\n      \"attestations\": [\n        {\n          \"type\": \"https://witness.dev/attestations/git/v0.1\"\n        },\n        {\n          \"type\": \"https://witness.dev/attestations/command-run/v0.1\"\n        },\n        {\n          \"type\": \"https://witness.dev/attestations/product/v0.1\"\n        }\n      ],\n      \"functionaries\": [\n        {\n          \"type\": \"publickey\",\n          \"publickeyid\": \"ci-key\"\n        }\n      ]\n    },\n    \"test\": {\n      \"name\": \"test\",\n      \"attestations\": [\n        {\n          \"type\": \"https://witness.dev/attestations/material/v0.1\"\n        },\n        {\n          \"type\": \"https://witness.dev/attestations/command-run/v0.1\"\n        }\n      ],\n      \"functionaries\": [\n        {\n          \"type\": \"publickey\",\n          \"publickeyid\": \"ci-key\"\n        }\n      ]\n    },\n    \"package\": {\n      \"name\": \"package\",\n      \"attestations\": [\n        {\n          \"type\": \"https://witness.dev/attestations/material/v0.1\"\n        },\n        {\n          \"type\": \"https://witness.dev/attestations/product/v0.1\"\n        }\n      ],\n      \"functionaries\": [\n        {\n          \"type\": \"publickey\",\n          \"publickeyid\": \"ci-key\"\n        }\n      ]\n    }\n  }\n}\n```\n\n**Pipeline Commands:**\n\n```bash\n# Step 1: Build\nwitness run --step build \\\n  --attestations git,commandrun,product \\\n  -o build.json --key ci-key.pem \\\n  -- go build -o myapp\n\n# Step 2: Test\nwitness run --step test \\\n  --attestations material,commandrun \\\n  -o test.json --key ci-key.pem \\\n  -- go test ./...\n\n# Step 3: Package\nwitness run --step package \\\n  --attestations material,product \\\n  -o package.json --key ci-key.pem \\\n  -- tar czf myapp.tar.gz myapp\n\n# Verify entire pipeline\nwitness verify \\\n  --policy policy-signed.json \\\n  --publickey policy-key.pub \\\n  -a build.json -a test.json -a package.json\n```\n"}]}
{"messages": [{"role": "system", "content": "You are an expert in the Witness supply chain attestation framework. You help users instrument CI/CD pipelines with witness, create policy documents, and write Rego policies to validate attestations. You understand all attestors in go-witness and how to use them effectively."}, {"role": "user", "content": "How do I create a witness policy for a build step that uses these attestors: git, environment?"}, {"role": "assistant", "content": "Here's a complete witness policy for your build step with git, environment attestors:\n\n**Policy Document:**\n```json\n{\n  \"expires\": \"2026-11-08T10:52:59Z\",\n  \"publickeys\": {\n    \"build-key\": {\n      \"keyid\": \"sha256:078cb6a22f054b1c62f3f87d8ce914df3ca7841e74d424db70017ab9a04ea7b4\",\n      \"key\": \"-----BEGIN PUBLIC KEY-----\\n...\\n-----END PUBLIC KEY-----\"\n    }\n  },\n  \"steps\": {\n    \"build\": {\n      \"name\": \"build\",\n      \"attestations\": [\n        {\n          \"type\": \"https://witness.dev/attestations/git/v0.1\"\n        },\n        {\n          \"type\": \"https://witness.dev/attestations/environment/v0.1\"\n        }\n      ],\n      \"functionaries\": [\n        {\n          \"type\": \"publickey\",\n          \"publickeyid\": \"build-key\"\n        }\n      ]\n    }\n  }\n}\n```\n\n**Witness Run Command:**\n```bash\nwitness run --step build \\\n  --attestations git,environment \\\n  --outfile build-attestation.json \\\n  --key signing-key.pem \\\n  -- <your-build-command>\n```\n\n**Rego Validation Rules:**\n```rego\npackage git\n\nimport rego.v1\n\n# Enforce builds from specific branch\ndeny contains msg if {\n    input.branch != \"staging\"\n    msg := sprintf(\"Must build from staging branch, got: %s\", [input.branch])\n}\n\n# Require clean working directory\ndeny contains msg if {\n    count(input.status) > 0\n    msg := \"Working directory must be clean (no uncommitted changes)\"\n}\n\n# Validate commit author\napproved_authors := {\n    \"alice.smith@example.com\",\n    \"bob.jones@company.com\",\n    \"ci-bot@company.com\"\n}\n\ndeny contains msg if {\n    not input.authoremail in approved_authors\n    msg := sprintf(\"Unauthorized commit author: %s\", [input.authoremail])\n}\n```\n\n**Verification:**\n```bash\nwitness verify \\\n  --policy policy-signed.json \\\n  --publickey policy-key.pub \\\n  -a build-attestation.json \\\n  --subject <artifact>\n```\n"}]}
{"messages": [{"role": "system", "content": "You are an expert in the Witness supply chain attestation framework. You help users instrument CI/CD pipelines with witness, create policy documents, and write Rego policies to validate attestations. You understand all attestors in go-witness and how to use them effectively."}, {"role": "user", "content": "How do I create a witness policy for a build step that uses these attestors: material, git?"}, {"role": "assistant", "content": "Here's a complete witness policy for your build step with material, git attestors:\n\n**Policy Document:**\n```json\n{\n  \"expires\": \"2026-11-08T10:52:59Z\",\n  \"publickeys\": {\n    \"build-key\": {\n      \"keyid\": \"sha256:a91e95a115931bc1f54f52b4345ab64750363a71b26197a39abfde80b0f7fd06\",\n      \"key\": \"-----BEGIN PUBLIC KEY-----\\n...\\n-----END PUBLIC KEY-----\"\n    }\n  },\n  \"steps\": {\n    \"build\": {\n      \"name\": \"build\",\n      \"attestations\": [\n        {\n          \"type\": \"https://witness.dev/attestations/material/v0.1\"\n        },\n        {\n          \"type\": \"https://witness.dev/attestations/git/v0.1\"\n        }\n      ],\n      \"functionaries\": [\n        {\n          \"type\": \"publickey\",\n          \"publickeyid\": \"build-key\"\n        }\n      ]\n    }\n  }\n}\n```\n\n**Witness Run Command:**\n```bash\nwitness run --step build \\\n  --attestations material,git \\\n  --outfile build-attestation.json \\\n  --key signing-key.pem \\\n  -- <your-build-command>\n```\n\n**Rego Validation Rules:**\n```rego\n\n```\n\n**Verification:**\n```bash\nwitness verify \\\n  --policy policy-signed.json \\\n  --publickey policy-key.pub \\\n  -a build-attestation.json \\\n  --subject <artifact>\n```\n"}]}
{"messages": [{"role": "system", "content": "You are an expert in the Witness supply chain attestation framework. You help users instrument CI/CD pipelines with witness, create policy documents, and write Rego policies to validate attestations. You understand all attestors in go-witness and how to use them effectively."}, {"role": "user", "content": "How do I create a witness policy for a build step that uses these attestors: product, github?"}, {"role": "assistant", "content": "Here's a complete witness policy for your build step with product, github attestors:\n\n**Policy Document:**\n```json\n{\n  \"expires\": \"2026-11-08T10:52:59Z\",\n  \"publickeys\": {\n    \"build-key\": {\n      \"keyid\": \"sha256:039432d0b2c96b9801916fe35e88327db20646cdad6810478cef335ffb8b64d6\",\n      \"key\": \"-----BEGIN PUBLIC KEY-----\\n...\\n-----END PUBLIC KEY-----\"\n    }\n  },\n  \"steps\": {\n    \"build\": {\n      \"name\": \"build\",\n      \"attestations\": [\n        {\n          \"type\": \"https://witness.dev/attestations/product/v0.1\"\n        },\n        {\n          \"type\": \"https://witness.dev/attestations/github/v0.1\"\n        }\n      ],\n      \"functionaries\": [\n        {\n          \"type\": \"publickey\",\n          \"publickeyid\": \"build-key\"\n        }\n      ]\n    }\n  }\n}\n```\n\n**Witness Run Command:**\n```bash\nwitness run --step build \\\n  --attestations product,github \\\n  --outfile build-attestation.json \\\n  --key signing-key.pem \\\n  -- <your-build-command>\n```\n\n**Rego Validation Rules:**\n```rego\n\n```\n\n**Verification:**\n```bash\nwitness verify \\\n  --policy policy-signed.json \\\n  --publickey policy-key.pub \\\n  -a build-attestation.json \\\n  --subject <artifact>\n```\n"}]}
{"messages": [{"role": "system", "content": "You are an expert in the Witness supply chain attestation framework. You help users instrument CI/CD pipelines with witness, create policy documents, and write Rego policies to validate attestations. You understand all attestors in go-witness and how to use them effectively."}, {"role": "user", "content": "How do I create a witness policy for a build step that uses these attestors: git, environment, github, commandrun?"}, {"role": "assistant", "content": "Here's a complete witness policy for your build step with git, environment, github, commandrun attestors:\n\n**Policy Document:**\n```json\n{\n  \"expires\": \"2026-11-08T10:52:59Z\",\n  \"publickeys\": {\n    \"build-key\": {\n      \"keyid\": \"sha256:12ed0d40f00c80227e877df8fc4ebdcdd9ed78e81768e3a7022560d2d268dca7\",\n      \"key\": \"-----BEGIN PUBLIC KEY-----\\n...\\n-----END PUBLIC KEY-----\"\n    }\n  },\n  \"steps\": {\n    \"build\": {\n      \"name\": \"build\",\n      \"attestations\": [\n        {\n          \"type\": \"https://witness.dev/attestations/git/v0.1\"\n        },\n        {\n          \"type\": \"https://witness.dev/attestations/environment/v0.1\"\n        },\n        {\n          \"type\": \"https://witness.dev/attestations/github/v0.1\"\n        },\n        {\n          \"type\": \"https://witness.dev/attestations/command-run/v0.1\"\n        }\n      ],\n      \"functionaries\": [\n        {\n          \"type\": \"publickey\",\n          \"publickeyid\": \"build-key\"\n        }\n      ]\n    }\n  }\n}\n```\n\n**Witness Run Command:**\n```bash\nwitness run --step build \\\n  --attestations git,environment,github,commandrun \\\n  --outfile build-attestation.json \\\n  --key signing-key.pem \\\n  -- <your-build-command>\n```\n\n**Rego Validation Rules:**\n```rego\npackage git\n\nimport rego.v1\n\n# Enforce builds from specific branch\ndeny contains msg if {\n    input.branch != \"release/v1.0\"\n    msg := sprintf(\"Must build from release/v1.0 branch, got: %s\", [input.branch])\n}\n\n# Validate commit author\napproved_authors := {\n    \"alice.smith@example.com\",\n    \"bob.jones@company.com\",\n    \"ci-bot@company.com\"\n}\n\ndeny contains msg if {\n    not input.authoremail in approved_authors\n    msg := sprintf(\"Unauthorized commit author: %s\", [input.authoremail])\n}\n```\n\n**Verification:**\n```bash\nwitness verify \\\n  --policy policy-signed.json \\\n  --publickey policy-key.pub \\\n  -a build-attestation.json \\\n  --subject <artifact>\n```\n"}]}
{"messages": [{"role": "system", "content": "You are an expert in the Witness supply chain attestation framework. You help users instrument CI/CD pipelines with witness, create policy documents, and write Rego policies to validate attestations. You understand all attestors in go-witness and how to use them effectively."}, {"role": "user", "content": "How do I create a multi-step witness policy for a build \u2192 test \u2192 package pipeline?"}, {"role": "assistant", "content": "Here's a complete multi-step witness policy for your pipeline:\n\n**Policy Document:**\n```json\n{\n  \"expires\": \"2026-11-08T10:52:59Z\",\n  \"publickeys\": {\n    \"ci-key\": {\n      \"keyid\": \"sha256:cbc9d4a994502af5d98b420cec89fa4b60747e06137b015f40860fec3a2ab216\",\n      \"key\": \"-----BEGIN PUBLIC KEY-----\\n...\\n-----END PUBLIC KEY-----\"\n    }\n  },\n  \"steps\": {\n    \"build\": {\n      \"name\": \"build\",\n      \"attestations\": [\n        {\n          \"type\": \"https://witness.dev/attestations/git/v0.1\"\n        },\n        {\n          \"type\": \"https://witness.dev/attestations/command-run/v0.1\"\n        },\n        {\n          \"type\": \"https://witness.dev/attestations/product/v0.1\"\n        }\n      ],\n      \"functionaries\": [\n        {\n          \"type\": \"publickey\",\n          \"publickeyid\": \"ci-key\"\n        }\n      ]\n    },\n    \"test\": {\n      \"name\": \"test\",\n      \"attestations\": [\n        {\n          \"type\": \"https://witness.dev/attestations/material/v0.1\"\n        },\n        {\n          \"type\": \"https://witness.dev/attestations/command-run/v0.1\"\n        }\n      ],\n      \"functionaries\": [\n        {\n          \"type\": \"publickey\",\n          \"publickeyid\": \"ci-key\"\n        }\n      ]\n    },\n    \"package\": {\n      \"name\": \"package\",\n      \"attestations\": [\n        {\n          \"type\": \"https://witness.dev/attestations/material/v0.1\"\n        },\n        {\n          \"type\": \"https://witness.dev/attestations/product/v0.1\"\n        }\n      ],\n      \"functionaries\": [\n        {\n          \"type\": \"publickey\",\n          \"publickeyid\": \"ci-key\"\n        }\n      ]\n    }\n  }\n}\n```\n\n**Pipeline Commands:**\n\n```bash\n# Step 1: Build\nwitness run --step build \\\n  --attestations git,commandrun,product \\\n  -o build.json --key ci-key.pem \\\n  -- go build -o myapp\n\n# Step 2: Test\nwitness run --step test \\\n  --attestations material,commandrun \\\n  -o test.json --key ci-key.pem \\\n  -- go test ./...\n\n# Step 3: Package\nwitness run --step package \\\n  --attestations material,product \\\n  -o package.json --key ci-key.pem \\\n  -- tar czf myapp.tar.gz myapp\n\n# Verify entire pipeline\nwitness verify \\\n  --policy policy-signed.json \\\n  --publickey policy-key.pub \\\n  -a build.json -a test.json -a package.json\n```\n"}]}
{"messages": [{"role": "system", "content": "You are an expert in the Witness supply chain attestation framework. You help users instrument CI/CD pipelines with witness, create policy documents, and write Rego policies to validate attestations. You understand all attestors in go-witness and how to use them effectively."}, {"role": "user", "content": "How do I create a witness policy for a build step that uses these attestors: github, git, environment?"}, {"role": "assistant", "content": "Here's a complete witness policy for your build step with github, git, environment attestors:\n\n**Policy Document:**\n```json\n{\n  \"expires\": \"2026-11-08T10:52:59Z\",\n  \"publickeys\": {\n    \"build-key\": {\n      \"keyid\": \"sha256:588680923949074b528d86e6cc9f5444c47e742410869d608ff39f28a8936f67\",\n      \"key\": \"-----BEGIN PUBLIC KEY-----\\n...\\n-----END PUBLIC KEY-----\"\n    }\n  },\n  \"steps\": {\n    \"build\": {\n      \"name\": \"build\",\n      \"attestations\": [\n        {\n          \"type\": \"https://witness.dev/attestations/github/v0.1\"\n        },\n        {\n          \"type\": \"https://witness.dev/attestations/git/v0.1\"\n        },\n        {\n          \"type\": \"https://witness.dev/attestations/environment/v0.1\"\n        }\n      ],\n      \"functionaries\": [\n        {\n          \"type\": \"publickey\",\n          \"publickeyid\": \"build-key\"\n        }\n      ]\n    }\n  }\n}\n```\n\n**Witness Run Command:**\n```bash\nwitness run --step build \\\n  --attestations github,git,environment \\\n  --outfile build-attestation.json \\\n  --key signing-key.pem \\\n  -- <your-build-command>\n```\n\n**Rego Validation Rules:**\n```rego\n\n```\n\n**Verification:**\n```bash\nwitness verify \\\n  --policy policy-signed.json \\\n  --publickey policy-key.pub \\\n  -a build-attestation.json \\\n  --subject <artifact>\n```\n"}]}
{"messages": [{"role": "system", "content": "You are an expert in the Witness supply chain attestation framework. You help users instrument CI/CD pipelines with witness, create policy documents, and write Rego policies to validate attestations. You understand all attestors in go-witness and how to use them effectively."}, {"role": "user", "content": "How do I create a witness policy for a build step that uses these attestors: product?"}, {"role": "assistant", "content": "Here's a complete witness policy for your build step with product attestors:\n\n**Policy Document:**\n```json\n{\n  \"expires\": \"2026-11-08T10:52:59Z\",\n  \"publickeys\": {\n    \"build-key\": {\n      \"keyid\": \"sha256:332cd9556f277877baa25d25b5e83e76fbef1004ca555ef5a25a64e317be97af\",\n      \"key\": \"-----BEGIN PUBLIC KEY-----\\n...\\n-----END PUBLIC KEY-----\"\n    }\n  },\n  \"steps\": {\n    \"build\": {\n      \"name\": \"build\",\n      \"attestations\": [\n        {\n          \"type\": \"https://witness.dev/attestations/product/v0.1\"\n        }\n      ],\n      \"functionaries\": [\n        {\n          \"type\": \"publickey\",\n          \"publickeyid\": \"build-key\"\n        }\n      ]\n    }\n  }\n}\n```\n\n**Witness Run Command:**\n```bash\nwitness run --step build \\\n  --attestations product \\\n  --outfile build-attestation.json \\\n  --key signing-key.pem \\\n  -- <your-build-command>\n```\n\n**Rego Validation Rules:**\n```rego\n\n```\n\n**Verification:**\n```bash\nwitness verify \\\n  --policy policy-signed.json \\\n  --publickey policy-key.pub \\\n  -a build-attestation.json \\\n  --subject <artifact>\n```\n"}]}
{"messages": [{"role": "system", "content": "You are an expert in the Witness supply chain attestation framework. You help users instrument CI/CD pipelines with witness, create policy documents, and write Rego policies to validate attestations. You understand all attestors in go-witness and how to use them effectively."}, {"role": "user", "content": "How do I create a witness policy for a build step that uses these attestors: material, product, environment, commandrun?"}, {"role": "assistant", "content": "Here's a complete witness policy for your build step with material, product, environment, commandrun attestors:\n\n**Policy Document:**\n```json\n{\n  \"expires\": \"2026-11-08T10:52:59Z\",\n  \"publickeys\": {\n    \"build-key\": {\n      \"keyid\": \"sha256:9ec4b9f55ccf26a33bc4afb2adfda18c0611b2922a243b688e411861abe6d7d1\",\n      \"key\": \"-----BEGIN PUBLIC KEY-----\\n...\\n-----END PUBLIC KEY-----\"\n    }\n  },\n  \"steps\": {\n    \"build\": {\n      \"name\": \"build\",\n      \"attestations\": [\n        {\n          \"type\": \"https://witness.dev/attestations/material/v0.1\"\n        },\n        {\n          \"type\": \"https://witness.dev/attestations/product/v0.1\"\n        },\n        {\n          \"type\": \"https://witness.dev/attestations/environment/v0.1\"\n        },\n        {\n          \"type\": \"https://witness.dev/attestations/command-run/v0.1\"\n        }\n      ],\n      \"functionaries\": [\n        {\n          \"type\": \"publickey\",\n          \"publickeyid\": \"build-key\"\n        }\n      ]\n    }\n  }\n}\n```\n\n**Witness Run Command:**\n```bash\nwitness run --step build \\\n  --attestations material,product,environment,commandrun \\\n  --outfile build-attestation.json \\\n  --key signing-key.pem \\\n  -- <your-build-command>\n```\n\n**Rego Validation Rules:**\n```rego\n\n```\n\n**Verification:**\n```bash\nwitness verify \\\n  --policy policy-signed.json \\\n  --publickey policy-key.pub \\\n  -a build-attestation.json \\\n  --subject <artifact>\n```\n"}]}
{"messages": [{"role": "system", "content": "You are an expert in the Witness supply chain attestation framework. You help users instrument CI/CD pipelines with witness, create policy documents, and write Rego policies to validate attestations. You understand all attestors in go-witness and how to use them effectively."}, {"role": "user", "content": "How do I create a witness policy for a build step that uses these attestors: commandrun?"}, {"role": "assistant", "content": "Here's a complete witness policy for your build step with commandrun attestors:\n\n**Policy Document:**\n```json\n{\n  \"expires\": \"2026-11-08T10:52:59Z\",\n  \"publickeys\": {\n    \"build-key\": {\n      \"keyid\": \"sha256:c131716382ca3aeeedb6ff2db8567f22f17387abe800baadc7b644733885f39f\",\n      \"key\": \"-----BEGIN PUBLIC KEY-----\\n...\\n-----END PUBLIC KEY-----\"\n    }\n  },\n  \"steps\": {\n    \"build\": {\n      \"name\": \"build\",\n      \"attestations\": [\n        {\n          \"type\": \"https://witness.dev/attestations/command-run/v0.1\"\n        }\n      ],\n      \"functionaries\": [\n        {\n          \"type\": \"publickey\",\n          \"publickeyid\": \"build-key\"\n        }\n      ]\n    }\n  }\n}\n```\n\n**Witness Run Command:**\n```bash\nwitness run --step build \\\n  --attestations commandrun \\\n  --outfile build-attestation.json \\\n  --key signing-key.pem \\\n  -- <your-build-command>\n```\n\n**Rego Validation Rules:**\n```rego\n\n```\n\n**Verification:**\n```bash\nwitness verify \\\n  --policy policy-signed.json \\\n  --publickey policy-key.pub \\\n  -a build-attestation.json \\\n  --subject <artifact>\n```\n"}]}
{"messages": [{"role": "system", "content": "You are an expert in the Witness supply chain attestation framework. You help users instrument CI/CD pipelines with witness, create policy documents, and write Rego policies to validate attestations. You understand all attestors in go-witness and how to use them effectively."}, {"role": "user", "content": "How do I create a witness policy for a build step that uses these attestors: git, material, environment, github?"}, {"role": "assistant", "content": "Here's a complete witness policy for your build step with git, material, environment, github attestors:\n\n**Policy Document:**\n```json\n{\n  \"expires\": \"2026-11-08T10:52:59Z\",\n  \"publickeys\": {\n    \"build-key\": {\n      \"keyid\": \"sha256:c7acc915582252d51eb87dab52371a6e0b53caf24ab2e3509ee100f0547648b9\",\n      \"key\": \"-----BEGIN PUBLIC KEY-----\\n...\\n-----END PUBLIC KEY-----\"\n    }\n  },\n  \"steps\": {\n    \"build\": {\n      \"name\": \"build\",\n      \"attestations\": [\n        {\n          \"type\": \"https://witness.dev/attestations/git/v0.1\"\n        },\n        {\n          \"type\": \"https://witness.dev/attestations/material/v0.1\"\n        },\n        {\n          \"type\": \"https://witness.dev/attestations/environment/v0.1\"\n        },\n        {\n          \"type\": \"https://witness.dev/attestations/github/v0.1\"\n        }\n      ],\n      \"functionaries\": [\n        {\n          \"type\": \"publickey\",\n          \"publickeyid\": \"build-key\"\n        }\n      ]\n    }\n  }\n}\n```\n\n**Witness Run Command:**\n```bash\nwitness run --step build \\\n  --attestations git,material,environment,github \\\n  --outfile build-attestation.json \\\n  --key signing-key.pem \\\n  -- <your-build-command>\n```\n\n**Rego Validation Rules:**\n```rego\npackage git\n\nimport rego.v1\n\n# Enforce builds from specific branch\ndeny contains msg if {\n    input.branch != \"staging\"\n    msg := sprintf(\"Must build from staging branch, got: %s\", [input.branch])\n}\n\n# Require clean working directory\ndeny contains msg if {\n    count(input.status) > 0\n    msg := \"Working directory must be clean (no uncommitted changes)\"\n}\n\n# Validate commit author\napproved_authors := {\n    \"alice.smith@example.com\",\n    \"bob.jones@company.com\",\n    \"ci-bot@company.com\"\n}\n\ndeny contains msg if {\n    not input.authoremail in approved_authors\n    msg := sprintf(\"Unauthorized commit author: %s\", [input.authoremail])\n}\n```\n\n**Verification:**\n```bash\nwitness verify \\\n  --policy policy-signed.json \\\n  --publickey policy-key.pub \\\n  -a build-attestation.json \\\n  --subject <artifact>\n```\n"}]}
{"messages": [{"role": "system", "content": "You are an expert in the Witness supply chain attestation framework. You help users instrument CI/CD pipelines with witness, create policy documents, and write Rego policies to validate attestations. You understand all attestors in go-witness and how to use them effectively."}, {"role": "user", "content": "How do I create a witness policy for a build step that uses these attestors: github?"}, {"role": "assistant", "content": "Here's a complete witness policy for your build step with github attestors:\n\n**Policy Document:**\n```json\n{\n  \"expires\": \"2026-11-08T10:52:59Z\",\n  \"publickeys\": {\n    \"build-key\": {\n      \"keyid\": \"sha256:6962c7455aabe2c5cadc2ed3a40b5fad51424aac205dbf9ceb8105cc8cfb8153\",\n      \"key\": \"-----BEGIN PUBLIC KEY-----\\n...\\n-----END PUBLIC KEY-----\"\n    }\n  },\n  \"steps\": {\n    \"build\": {\n      \"name\": \"build\",\n      \"attestations\": [\n        {\n          \"type\": \"https://witness.dev/attestations/github/v0.1\"\n        }\n      ],\n      \"functionaries\": [\n        {\n          \"type\": \"publickey\",\n          \"publickeyid\": \"build-key\"\n        }\n      ]\n    }\n  }\n}\n```\n\n**Witness Run Command:**\n```bash\nwitness run --step build \\\n  --attestations github \\\n  --outfile build-attestation.json \\\n  --key signing-key.pem \\\n  -- <your-build-command>\n```\n\n**Rego Validation Rules:**\n```rego\n\n```\n\n**Verification:**\n```bash\nwitness verify \\\n  --policy policy-signed.json \\\n  --publickey policy-key.pub \\\n  -a build-attestation.json \\\n  --subject <artifact>\n```\n"}]}
{"messages": [{"role": "system", "content": "You are an expert in the Witness supply chain attestation framework. You help users instrument CI/CD pipelines with witness, create policy documents, and write Rego policies to validate attestations. You understand all attestors in go-witness and how to use them effectively."}, {"role": "user", "content": "How do I create a witness policy for a build step that uses these attestors: commandrun, environment, github, git, material?"}, {"role": "assistant", "content": "Here's a complete witness policy for your build step with commandrun, environment, github, git, material attestors:\n\n**Policy Document:**\n```json\n{\n  \"expires\": \"2026-11-08T10:52:59Z\",\n  \"publickeys\": {\n    \"build-key\": {\n      \"keyid\": \"sha256:4511ee87d2c2e0ea7047e5a8e7bb6cad47f7738db1fb47b3ed57912c0f4a4ba1\",\n      \"key\": \"-----BEGIN PUBLIC KEY-----\\n...\\n-----END PUBLIC KEY-----\"\n    }\n  },\n  \"steps\": {\n    \"build\": {\n      \"name\": \"build\",\n      \"attestations\": [\n        {\n          \"type\": \"https://witness.dev/attestations/command-run/v0.1\"\n        },\n        {\n          \"type\": \"https://witness.dev/attestations/environment/v0.1\"\n        },\n        {\n          \"type\": \"https://witness.dev/attestations/github/v0.1\"\n        },\n        {\n          \"type\": \"https://witness.dev/attestations/git/v0.1\"\n        },\n        {\n          \"type\": \"https://witness.dev/attestations/material/v0.1\"\n        }\n      ],\n      \"functionaries\": [\n        {\n          \"type\": \"publickey\",\n          \"publickeyid\": \"build-key\"\n        }\n      ]\n    }\n  }\n}\n```\n\n**Witness Run Command:**\n```bash\nwitness run --step build \\\n  --attestations commandrun,environment,github,git,material \\\n  --outfile build-attestation.json \\\n  --key signing-key.pem \\\n  -- <your-build-command>\n```\n\n**Rego Validation Rules:**\n```rego\n\n```\n\n**Verification:**\n```bash\nwitness verify \\\n  --policy policy-signed.json \\\n  --publickey policy-key.pub \\\n  -a build-attestation.json \\\n  --subject <artifact>\n```\n"}]}
{"messages": [{"role": "system", "content": "You are an expert in the Witness supply chain attestation framework. You help users instrument CI/CD pipelines with witness, create policy documents, and write Rego policies to validate attestations. You understand all attestors in go-witness and how to use them effectively."}, {"role": "user", "content": "How do I create a witness policy for a build step that uses these attestors: github, environment, material?"}, {"role": "assistant", "content": "Here's a complete witness policy for your build step with github, environment, material attestors:\n\n**Policy Document:**\n```json\n{\n  \"expires\": \"2026-11-08T10:52:59Z\",\n  \"publickeys\": {\n    \"build-key\": {\n      \"keyid\": \"sha256:84664e60856e559873a8a02f9d5ab635fb391bbaa73a54727d7eb994d97bd68b\",\n      \"key\": \"-----BEGIN PUBLIC KEY-----\\n...\\n-----END PUBLIC KEY-----\"\n    }\n  },\n  \"steps\": {\n    \"build\": {\n      \"name\": \"build\",\n      \"attestations\": [\n        {\n          \"type\": \"https://witness.dev/attestations/github/v0.1\"\n        },\n        {\n          \"type\": \"https://witness.dev/attestations/environment/v0.1\"\n        },\n        {\n          \"type\": \"https://witness.dev/attestations/material/v0.1\"\n        }\n      ],\n      \"functionaries\": [\n        {\n          \"type\": \"publickey\",\n          \"publickeyid\": \"build-key\"\n        }\n      ]\n    }\n  }\n}\n```\n\n**Witness Run Command:**\n```bash\nwitness run --step build \\\n  --attestations github,environment,material \\\n  --outfile build-attestation.json \\\n  --key signing-key.pem \\\n  -- <your-build-command>\n```\n\n**Rego Validation Rules:**\n```rego\n\n```\n\n**Verification:**\n```bash\nwitness verify \\\n  --policy policy-signed.json \\\n  --publickey policy-key.pub \\\n  -a build-attestation.json \\\n  --subject <artifact>\n```\n"}]}
{"messages": [{"role": "system", "content": "You are an expert in the Witness supply chain attestation framework. You help users instrument CI/CD pipelines with witness, create policy documents, and write Rego policies to validate attestations. You understand all attestors in go-witness and how to use them effectively."}, {"role": "user", "content": "How do I create a multi-step witness policy for a build \u2192 test \u2192 package pipeline?"}, {"role": "assistant", "content": "Here's a complete multi-step witness policy for your pipeline:\n\n**Policy Document:**\n```json\n{\n  \"expires\": \"2026-11-08T10:52:59Z\",\n  \"publickeys\": {\n    \"ci-key\": {\n      \"keyid\": \"sha256:deedeee6fd30a49a62e342fb0f5f39ac1a4ee646bc36db346311cdde5c961923\",\n      \"key\": \"-----BEGIN PUBLIC KEY-----\\n...\\n-----END PUBLIC KEY-----\"\n    }\n  },\n  \"steps\": {\n    \"build\": {\n      \"name\": \"build\",\n      \"attestations\": [\n        {\n          \"type\": \"https://witness.dev/attestations/git/v0.1\"\n        },\n        {\n          \"type\": \"https://witness.dev/attestations/command-run/v0.1\"\n        },\n        {\n          \"type\": \"https://witness.dev/attestations/product/v0.1\"\n        }\n      ],\n      \"functionaries\": [\n        {\n          \"type\": \"publickey\",\n          \"publickeyid\": \"ci-key\"\n        }\n      ]\n    },\n    \"test\": {\n      \"name\": \"test\",\n      \"attestations\": [\n        {\n          \"type\": \"https://witness.dev/attestations/material/v0.1\"\n        },\n        {\n          \"type\": \"https://witness.dev/attestations/command-run/v0.1\"\n        }\n      ],\n      \"functionaries\": [\n        {\n          \"type\": \"publickey\",\n          \"publickeyid\": \"ci-key\"\n        }\n      ]\n    },\n    \"package\": {\n      \"name\": \"package\",\n      \"attestations\": [\n        {\n          \"type\": \"https://witness.dev/attestations/material/v0.1\"\n        },\n        {\n          \"type\": \"https://witness.dev/attestations/product/v0.1\"\n        }\n      ],\n      \"functionaries\": [\n        {\n          \"type\": \"publickey\",\n          \"publickeyid\": \"ci-key\"\n        }\n      ]\n    }\n  }\n}\n```\n\n**Pipeline Commands:**\n\n```bash\n# Step 1: Build\nwitness run --step build \\\n  --attestations git,commandrun,product \\\n  -o build.json --key ci-key.pem \\\n  -- go build -o myapp\n\n# Step 2: Test\nwitness run --step test \\\n  --attestations material,commandrun \\\n  -o test.json --key ci-key.pem \\\n  -- go test ./...\n\n# Step 3: Package\nwitness run --step package \\\n  --attestations material,product \\\n  -o package.json --key ci-key.pem \\\n  -- tar czf myapp.tar.gz myapp\n\n# Verify entire pipeline\nwitness verify \\\n  --policy policy-signed.json \\\n  --publickey policy-key.pub \\\n  -a build.json -a test.json -a package.json\n```\n"}]}
{"messages": [{"role": "system", "content": "You are an expert in the Witness supply chain attestation framework. You help users instrument CI/CD pipelines with witness, create policy documents, and write Rego policies to validate attestations. You understand all attestors in go-witness and how to use them effectively."}, {"role": "user", "content": "How do I create a witness policy for a build step that uses these attestors: material, environment, commandrun, product, github?"}, {"role": "assistant", "content": "Here's a complete witness policy for your build step with material, environment, commandrun, product, github attestors:\n\n**Policy Document:**\n```json\n{\n  \"expires\": \"2026-11-08T10:52:59Z\",\n  \"publickeys\": {\n    \"build-key\": {\n      \"keyid\": \"sha256:383187ab0aa51a12500a5e67036e8c73bfd8562ee1e436f305e0fce01e301cad\",\n      \"key\": \"-----BEGIN PUBLIC KEY-----\\n...\\n-----END PUBLIC KEY-----\"\n    }\n  },\n  \"steps\": {\n    \"build\": {\n      \"name\": \"build\",\n      \"attestations\": [\n        {\n          \"type\": \"https://witness.dev/attestations/material/v0.1\"\n        },\n        {\n          \"type\": \"https://witness.dev/attestations/environment/v0.1\"\n        },\n        {\n          \"type\": \"https://witness.dev/attestations/command-run/v0.1\"\n        },\n        {\n          \"type\": \"https://witness.dev/attestations/product/v0.1\"\n        },\n        {\n          \"type\": \"https://witness.dev/attestations/github/v0.1\"\n        }\n      ],\n      \"functionaries\": [\n        {\n          \"type\": \"publickey\",\n          \"publickeyid\": \"build-key\"\n        }\n      ]\n    }\n  }\n}\n```\n\n**Witness Run Command:**\n```bash\nwitness run --step build \\\n  --attestations material,environment,commandrun,product,github \\\n  --outfile build-attestation.json \\\n  --key signing-key.pem \\\n  -- <your-build-command>\n```\n\n**Rego Validation Rules:**\n```rego\n\n```\n\n**Verification:**\n```bash\nwitness verify \\\n  --policy policy-signed.json \\\n  --publickey policy-key.pub \\\n  -a build-attestation.json \\\n  --subject <artifact>\n```\n"}]}
{"messages": [{"role": "system", "content": "You are an expert in the Witness supply chain attestation framework. You help users instrument CI/CD pipelines with witness, create policy documents, and write Rego policies to validate attestations. You understand all attestors in go-witness and how to use them effectively."}, {"role": "user", "content": "How do I create a multi-step witness policy for a build \u2192 test \u2192 package pipeline?"}, {"role": "assistant", "content": "Here's a complete multi-step witness policy for your pipeline:\n\n**Policy Document:**\n```json\n{\n  \"expires\": \"2026-11-08T10:52:59Z\",\n  \"publickeys\": {\n    \"ci-key\": {\n      \"keyid\": \"sha256:c5661d23e5542d72d46890303befb360d34d47f0284471492b43e11a583ed0c6\",\n      \"key\": \"-----BEGIN PUBLIC KEY-----\\n...\\n-----END PUBLIC KEY-----\"\n    }\n  },\n  \"steps\": {\n    \"build\": {\n      \"name\": \"build\",\n      \"attestations\": [\n        {\n          \"type\": \"https://witness.dev/attestations/git/v0.1\"\n        },\n        {\n          \"type\": \"https://witness.dev/attestations/command-run/v0.1\"\n        },\n        {\n          \"type\": \"https://witness.dev/attestations/product/v0.1\"\n        }\n      ],\n      \"functionaries\": [\n        {\n          \"type\": \"publickey\",\n          \"publickeyid\": \"ci-key\"\n        }\n      ]\n    },\n    \"test\": {\n      \"name\": \"test\",\n      \"attestations\": [\n        {\n          \"type\": \"https://witness.dev/attestations/material/v0.1\"\n        },\n        {\n          \"type\": \"https://witness.dev/attestations/command-run/v0.1\"\n        }\n      ],\n      \"functionaries\": [\n        {\n          \"type\": \"publickey\",\n          \"publickeyid\": \"ci-key\"\n        }\n      ]\n    },\n    \"package\": {\n      \"name\": \"package\",\n      \"attestations\": [\n        {\n          \"type\": \"https://witness.dev/attestations/material/v0.1\"\n        },\n        {\n          \"type\": \"https://witness.dev/attestations/product/v0.1\"\n        }\n      ],\n      \"functionaries\": [\n        {\n          \"type\": \"publickey\",\n          \"publickeyid\": \"ci-key\"\n        }\n      ]\n    }\n  }\n}\n```\n\n**Pipeline Commands:**\n\n```bash\n# Step 1: Build\nwitness run --step build \\\n  --attestations git,commandrun,product \\\n  -o build.json --key ci-key.pem \\\n  -- go build -o myapp\n\n# Step 2: Test\nwitness run --step test \\\n  --attestations material,commandrun \\\n  -o test.json --key ci-key.pem \\\n  -- go test ./...\n\n# Step 3: Package\nwitness run --step package \\\n  --attestations material,product \\\n  -o package.json --key ci-key.pem \\\n  -- tar czf myapp.tar.gz myapp\n\n# Verify entire pipeline\nwitness verify \\\n  --policy policy-signed.json \\\n  --publickey policy-key.pub \\\n  -a build.json -a test.json -a package.json\n```\n"}]}
{"messages": [{"role": "system", "content": "You are an expert in the Witness supply chain attestation framework. You help users instrument CI/CD pipelines with witness, create policy documents, and write Rego policies to validate attestations. You understand all attestors in go-witness and how to use them effectively."}, {"role": "user", "content": "How do I create a multi-step witness policy for a build \u2192 test \u2192 package pipeline?"}, {"role": "assistant", "content": "Here's a complete multi-step witness policy for your pipeline:\n\n**Policy Document:**\n```json\n{\n  \"expires\": \"2026-11-08T10:52:59Z\",\n  \"publickeys\": {\n    \"ci-key\": {\n      \"keyid\": \"sha256:3ed1784501c8bf56ef5944921e5990123a51c5bf5dd8db2499fe403ee75bcbdf\",\n      \"key\": \"-----BEGIN PUBLIC KEY-----\\n...\\n-----END PUBLIC KEY-----\"\n    }\n  },\n  \"steps\": {\n    \"build\": {\n      \"name\": \"build\",\n      \"attestations\": [\n        {\n          \"type\": \"https://witness.dev/attestations/git/v0.1\"\n        },\n        {\n          \"type\": \"https://witness.dev/attestations/command-run/v0.1\"\n        },\n        {\n          \"type\": \"https://witness.dev/attestations/product/v0.1\"\n        }\n      ],\n      \"functionaries\": [\n        {\n          \"type\": \"publickey\",\n          \"publickeyid\": \"ci-key\"\n        }\n      ]\n    },\n    \"test\": {\n      \"name\": \"test\",\n      \"attestations\": [\n        {\n          \"type\": \"https://witness.dev/attestations/material/v0.1\"\n        },\n        {\n          \"type\": \"https://witness.dev/attestations/command-run/v0.1\"\n        }\n      ],\n      \"functionaries\": [\n        {\n          \"type\": \"publickey\",\n          \"publickeyid\": \"ci-key\"\n        }\n      ]\n    },\n    \"package\": {\n      \"name\": \"package\",\n      \"attestations\": [\n        {\n          \"type\": \"https://witness.dev/attestations/material/v0.1\"\n        },\n        {\n          \"type\": \"https://witness.dev/attestations/product/v0.1\"\n        }\n      ],\n      \"functionaries\": [\n        {\n          \"type\": \"publickey\",\n          \"publickeyid\": \"ci-key\"\n        }\n      ]\n    }\n  }\n}\n```\n\n**Pipeline Commands:**\n\n```bash\n# Step 1: Build\nwitness run --step build \\\n  --attestations git,commandrun,product \\\n  -o build.json --key ci-key.pem \\\n  -- go build -o myapp\n\n# Step 2: Test\nwitness run --step test \\\n  --attestations material,commandrun \\\n  -o test.json --key ci-key.pem \\\n  -- go test ./...\n\n# Step 3: Package\nwitness run --step package \\\n  --attestations material,product \\\n  -o package.json --key ci-key.pem \\\n  -- tar czf myapp.tar.gz myapp\n\n# Verify entire pipeline\nwitness verify \\\n  --policy policy-signed.json \\\n  --publickey policy-key.pub \\\n  -a build.json -a test.json -a package.json\n```\n"}]}
{"messages": [{"role": "system", "content": "You are an expert in the Witness supply chain attestation framework. You help users instrument CI/CD pipelines with witness, create policy documents, and write Rego policies to validate attestations. You understand all attestors in go-witness and how to use them effectively."}, {"role": "user", "content": "How do I create a witness policy for a build step that uses these attestors: github, git, product, environment?"}, {"role": "assistant", "content": "Here's a complete witness policy for your build step with github, git, product, environment attestors:\n\n**Policy Document:**\n```json\n{\n  \"expires\": \"2026-11-08T10:52:59Z\",\n  \"publickeys\": {\n    \"build-key\": {\n      \"keyid\": \"sha256:be567ca226cb4c2ee9b22e2f9f9030d9f4058863db1d3b979ba8c933af07f639\",\n      \"key\": \"-----BEGIN PUBLIC KEY-----\\n...\\n-----END PUBLIC KEY-----\"\n    }\n  },\n  \"steps\": {\n    \"build\": {\n      \"name\": \"build\",\n      \"attestations\": [\n        {\n          \"type\": \"https://witness.dev/attestations/github/v0.1\"\n        },\n        {\n          \"type\": \"https://witness.dev/attestations/git/v0.1\"\n        },\n        {\n          \"type\": \"https://witness.dev/attestations/product/v0.1\"\n        },\n        {\n          \"type\": \"https://witness.dev/attestations/environment/v0.1\"\n        }\n      ],\n      \"functionaries\": [\n        {\n          \"type\": \"publickey\",\n          \"publickeyid\": \"build-key\"\n        }\n      ]\n    }\n  }\n}\n```\n\n**Witness Run Command:**\n```bash\nwitness run --step build \\\n  --attestations github,git,product,environment \\\n  --outfile build-attestation.json \\\n  --key signing-key.pem \\\n  -- <your-build-command>\n```\n\n**Rego Validation Rules:**\n```rego\n\n```\n\n**Verification:**\n```bash\nwitness verify \\\n  --policy policy-signed.json \\\n  --publickey policy-key.pub \\\n  -a build-attestation.json \\\n  --subject <artifact>\n```\n"}]}
{"messages": [{"role": "system", "content": "You are an expert in the Witness supply chain attestation framework. You help users instrument CI/CD pipelines with witness, create policy documents, and write Rego policies to validate attestations. You understand all attestors in go-witness and how to use them effectively."}, {"role": "user", "content": "How do I create a witness policy for a build step that uses these attestors: commandrun, product, material?"}, {"role": "assistant", "content": "Here's a complete witness policy for your build step with commandrun, product, material attestors:\n\n**Policy Document:**\n```json\n{\n  \"expires\": \"2026-11-08T10:52:59Z\",\n  \"publickeys\": {\n    \"build-key\": {\n      \"keyid\": \"sha256:f3bc7468309ba52b7b137ce82f9f22e0e556948575706c17cca0bab6c7d29b02\",\n      \"key\": \"-----BEGIN PUBLIC KEY-----\\n...\\n-----END PUBLIC KEY-----\"\n    }\n  },\n  \"steps\": {\n    \"build\": {\n      \"name\": \"build\",\n      \"attestations\": [\n        {\n          \"type\": \"https://witness.dev/attestations/command-run/v0.1\"\n        },\n        {\n          \"type\": \"https://witness.dev/attestations/product/v0.1\"\n        },\n        {\n          \"type\": \"https://witness.dev/attestations/material/v0.1\"\n        }\n      ],\n      \"functionaries\": [\n        {\n          \"type\": \"publickey\",\n          \"publickeyid\": \"build-key\"\n        }\n      ]\n    }\n  }\n}\n```\n\n**Witness Run Command:**\n```bash\nwitness run --step build \\\n  --attestations commandrun,product,material \\\n  --outfile build-attestation.json \\\n  --key signing-key.pem \\\n  -- <your-build-command>\n```\n\n**Rego Validation Rules:**\n```rego\n\n```\n\n**Verification:**\n```bash\nwitness verify \\\n  --policy policy-signed.json \\\n  --publickey policy-key.pub \\\n  -a build-attestation.json \\\n  --subject <artifact>\n```\n"}]}
{"messages": [{"role": "system", "content": "You are an expert in the Witness supply chain attestation framework. You help users instrument CI/CD pipelines with witness, create policy documents, and write Rego policies to validate attestations. You understand all attestors in go-witness and how to use them effectively."}, {"role": "user", "content": "How do I create a witness policy for a build step that uses these attestors: github?"}, {"role": "assistant", "content": "Here's a complete witness policy for your build step with github attestors:\n\n**Policy Document:**\n```json\n{\n  \"expires\": \"2026-11-08T10:52:59Z\",\n  \"publickeys\": {\n    \"build-key\": {\n      \"keyid\": \"sha256:5422dac77222848e16ba3b233cb56821a337fd67f26fdb78cf5e846d6ed229a2\",\n      \"key\": \"-----BEGIN PUBLIC KEY-----\\n...\\n-----END PUBLIC KEY-----\"\n    }\n  },\n  \"steps\": {\n    \"build\": {\n      \"name\": \"build\",\n      \"attestations\": [\n        {\n          \"type\": \"https://witness.dev/attestations/github/v0.1\"\n        }\n      ],\n      \"functionaries\": [\n        {\n          \"type\": \"publickey\",\n          \"publickeyid\": \"build-key\"\n        }\n      ]\n    }\n  }\n}\n```\n\n**Witness Run Command:**\n```bash\nwitness run --step build \\\n  --attestations github \\\n  --outfile build-attestation.json \\\n  --key signing-key.pem \\\n  -- <your-build-command>\n```\n\n**Rego Validation Rules:**\n```rego\n\n```\n\n**Verification:**\n```bash\nwitness verify \\\n  --policy policy-signed.json \\\n  --publickey policy-key.pub \\\n  -a build-attestation.json \\\n  --subject <artifact>\n```\n"}]}
{"messages": [{"role": "system", "content": "You are an expert in the Witness supply chain attestation framework. You help users instrument CI/CD pipelines with witness, create policy documents, and write Rego policies to validate attestations. You understand all attestors in go-witness and how to use them effectively."}, {"role": "user", "content": "How do I create a witness policy for a build step that uses these attestors: commandrun, git, github?"}, {"role": "assistant", "content": "Here's a complete witness policy for your build step with commandrun, git, github attestors:\n\n**Policy Document:**\n```json\n{\n  \"expires\": \"2026-11-08T10:52:59Z\",\n  \"publickeys\": {\n    \"build-key\": {\n      \"keyid\": \"sha256:3441c99041a793d785d631c6c56eefe62dbe53435f065418a535b9bc73f42f3b\",\n      \"key\": \"-----BEGIN PUBLIC KEY-----\\n...\\n-----END PUBLIC KEY-----\"\n    }\n  },\n  \"steps\": {\n    \"build\": {\n      \"name\": \"build\",\n      \"attestations\": [\n        {\n          \"type\": \"https://witness.dev/attestations/command-run/v0.1\"\n        },\n        {\n          \"type\": \"https://witness.dev/attestations/git/v0.1\"\n        },\n        {\n          \"type\": \"https://witness.dev/attestations/github/v0.1\"\n        }\n      ],\n      \"functionaries\": [\n        {\n          \"type\": \"publickey\",\n          \"publickeyid\": \"build-key\"\n        }\n      ]\n    }\n  }\n}\n```\n\n**Witness Run Command:**\n```bash\nwitness run --step build \\\n  --attestations commandrun,git,github \\\n  --outfile build-attestation.json \\\n  --key signing-key.pem \\\n  -- <your-build-command>\n```\n\n**Rego Validation Rules:**\n```rego\n\n```\n\n**Verification:**\n```bash\nwitness verify \\\n  --policy policy-signed.json \\\n  --publickey policy-key.pub \\\n  -a build-attestation.json \\\n  --subject <artifact>\n```\n"}]}
{"messages": [{"role": "system", "content": "You are an expert in the Witness supply chain attestation framework. You help users instrument CI/CD pipelines with witness, create policy documents, and write Rego policies to validate attestations. You understand all attestors in go-witness and how to use them effectively."}, {"role": "user", "content": "How do I create a witness policy for a build step that uses these attestors: github, commandrun, environment, material?"}, {"role": "assistant", "content": "Here's a complete witness policy for your build step with github, commandrun, environment, material attestors:\n\n**Policy Document:**\n```json\n{\n  \"expires\": \"2026-11-08T10:52:59Z\",\n  \"publickeys\": {\n    \"build-key\": {\n      \"keyid\": \"sha256:13e6f99eb75f2564f89f7adf0d13851a7cf5a800bdbe1a9e2b8801dacca2e5bd\",\n      \"key\": \"-----BEGIN PUBLIC KEY-----\\n...\\n-----END PUBLIC KEY-----\"\n    }\n  },\n  \"steps\": {\n    \"build\": {\n      \"name\": \"build\",\n      \"attestations\": [\n        {\n          \"type\": \"https://witness.dev/attestations/github/v0.1\"\n        },\n        {\n          \"type\": \"https://witness.dev/attestations/command-run/v0.1\"\n        },\n        {\n          \"type\": \"https://witness.dev/attestations/environment/v0.1\"\n        },\n        {\n          \"type\": \"https://witness.dev/attestations/material/v0.1\"\n        }\n      ],\n      \"functionaries\": [\n        {\n          \"type\": \"publickey\",\n          \"publickeyid\": \"build-key\"\n        }\n      ]\n    }\n  }\n}\n```\n\n**Witness Run Command:**\n```bash\nwitness run --step build \\\n  --attestations github,commandrun,environment,material \\\n  --outfile build-attestation.json \\\n  --key signing-key.pem \\\n  -- <your-build-command>\n```\n\n**Rego Validation Rules:**\n```rego\n\n```\n\n**Verification:**\n```bash\nwitness verify \\\n  --policy policy-signed.json \\\n  --publickey policy-key.pub \\\n  -a build-attestation.json \\\n  --subject <artifact>\n```\n"}]}
{"messages": [{"role": "system", "content": "You are an expert in the Witness supply chain attestation framework. You help users instrument CI/CD pipelines with witness, create policy documents, and write Rego policies to validate attestations. You understand all attestors in go-witness and how to use them effectively."}, {"role": "user", "content": "How do I create a multi-step witness policy for a build \u2192 test \u2192 package pipeline?"}, {"role": "assistant", "content": "Here's a complete multi-step witness policy for your pipeline:\n\n**Policy Document:**\n```json\n{\n  \"expires\": \"2026-11-08T10:52:59Z\",\n  \"publickeys\": {\n    \"ci-key\": {\n      \"keyid\": \"sha256:dfea79e06f740ddc549841bd3b064131599a500aea36865acc17b96d3f235ec0\",\n      \"key\": \"-----BEGIN PUBLIC KEY-----\\n...\\n-----END PUBLIC KEY-----\"\n    }\n  },\n  \"steps\": {\n    \"build\": {\n      \"name\": \"build\",\n      \"attestations\": [\n        {\n          \"type\": \"https://witness.dev/attestations/git/v0.1\"\n        },\n        {\n          \"type\": \"https://witness.dev/attestations/command-run/v0.1\"\n        },\n        {\n          \"type\": \"https://witness.dev/attestations/product/v0.1\"\n        }\n      ],\n      \"functionaries\": [\n        {\n          \"type\": \"publickey\",\n          \"publickeyid\": \"ci-key\"\n        }\n      ]\n    },\n    \"test\": {\n      \"name\": \"test\",\n      \"attestations\": [\n        {\n          \"type\": \"https://witness.dev/attestations/material/v0.1\"\n        },\n        {\n          \"type\": \"https://witness.dev/attestations/command-run/v0.1\"\n        }\n      ],\n      \"functionaries\": [\n        {\n          \"type\": \"publickey\",\n          \"publickeyid\": \"ci-key\"\n        }\n      ]\n    },\n    \"package\": {\n      \"name\": \"package\",\n      \"attestations\": [\n        {\n          \"type\": \"https://witness.dev/attestations/material/v0.1\"\n        },\n        {\n          \"type\": \"https://witness.dev/attestations/product/v0.1\"\n        }\n      ],\n      \"functionaries\": [\n        {\n          \"type\": \"publickey\",\n          \"publickeyid\": \"ci-key\"\n        }\n      ]\n    }\n  }\n}\n```\n\n**Pipeline Commands:**\n\n```bash\n# Step 1: Build\nwitness run --step build \\\n  --attestations git,commandrun,product \\\n  -o build.json --key ci-key.pem \\\n  -- go build -o myapp\n\n# Step 2: Test\nwitness run --step test \\\n  --attestations material,commandrun \\\n  -o test.json --key ci-key.pem \\\n  -- go test ./...\n\n# Step 3: Package\nwitness run --step package \\\n  --attestations material,product \\\n  -o package.json --key ci-key.pem \\\n  -- tar czf myapp.tar.gz myapp\n\n# Verify entire pipeline\nwitness verify \\\n  --policy policy-signed.json \\\n  --publickey policy-key.pub \\\n  -a build.json -a test.json -a package.json\n```\n"}]}
{"messages": [{"role": "system", "content": "You are an expert in the Witness supply chain attestation framework. You help users instrument CI/CD pipelines with witness, create policy documents, and write Rego policies to validate attestations. You understand all attestors in go-witness and how to use them effectively."}, {"role": "user", "content": "How do I create a witness policy for a build step that uses these attestors: product?"}, {"role": "assistant", "content": "Here's a complete witness policy for your build step with product attestors:\n\n**Policy Document:**\n```json\n{\n  \"expires\": \"2026-11-08T10:52:59Z\",\n  \"publickeys\": {\n    \"build-key\": {\n      \"keyid\": \"sha256:3362fe9d82ee138a0d4da39f2e2b6a9b89e205addb0fe6cd727b8f0b4e986a1f\",\n      \"key\": \"-----BEGIN PUBLIC KEY-----\\n...\\n-----END PUBLIC KEY-----\"\n    }\n  },\n  \"steps\": {\n    \"build\": {\n      \"name\": \"build\",\n      \"attestations\": [\n        {\n          \"type\": \"https://witness.dev/attestations/product/v0.1\"\n        }\n      ],\n      \"functionaries\": [\n        {\n          \"type\": \"publickey\",\n          \"publickeyid\": \"build-key\"\n        }\n      ]\n    }\n  }\n}\n```\n\n**Witness Run Command:**\n```bash\nwitness run --step build \\\n  --attestations product \\\n  --outfile build-attestation.json \\\n  --key signing-key.pem \\\n  -- <your-build-command>\n```\n\n**Rego Validation Rules:**\n```rego\n\n```\n\n**Verification:**\n```bash\nwitness verify \\\n  --policy policy-signed.json \\\n  --publickey policy-key.pub \\\n  -a build-attestation.json \\\n  --subject <artifact>\n```\n"}]}
{"messages": [{"role": "system", "content": "You are an expert in the Witness supply chain attestation framework. You help users instrument CI/CD pipelines with witness, create policy documents, and write Rego policies to validate attestations. You understand all attestors in go-witness and how to use them effectively."}, {"role": "user", "content": "How do I create a multi-step witness policy for a build \u2192 test \u2192 package pipeline?"}, {"role": "assistant", "content": "Here's a complete multi-step witness policy for your pipeline:\n\n**Policy Document:**\n```json\n{\n  \"expires\": \"2026-11-08T10:52:59Z\",\n  \"publickeys\": {\n    \"ci-key\": {\n      \"keyid\": \"sha256:f333b78ba34fdd48a00595f28e0b6fcd5435dc7ee501bc3a9a5daa1107d7f78b\",\n      \"key\": \"-----BEGIN PUBLIC KEY-----\\n...\\n-----END PUBLIC KEY-----\"\n    }\n  },\n  \"steps\": {\n    \"build\": {\n      \"name\": \"build\",\n      \"attestations\": [\n        {\n          \"type\": \"https://witness.dev/attestations/git/v0.1\"\n        },\n        {\n          \"type\": \"https://witness.dev/attestations/command-run/v0.1\"\n        },\n        {\n          \"type\": \"https://witness.dev/attestations/product/v0.1\"\n        }\n      ],\n      \"functionaries\": [\n        {\n          \"type\": \"publickey\",\n          \"publickeyid\": \"ci-key\"\n        }\n      ]\n    },\n    \"test\": {\n      \"name\": \"test\",\n      \"attestations\": [\n        {\n          \"type\": \"https://witness.dev/attestations/material/v0.1\"\n        },\n        {\n          \"type\": \"https://witness.dev/attestations/command-run/v0.1\"\n        }\n      ],\n      \"functionaries\": [\n        {\n          \"type\": \"publickey\",\n          \"publickeyid\": \"ci-key\"\n        }\n      ]\n    },\n    \"package\": {\n      \"name\": \"package\",\n      \"attestations\": [\n        {\n          \"type\": \"https://witness.dev/attestations/material/v0.1\"\n        },\n        {\n          \"type\": \"https://witness.dev/attestations/product/v0.1\"\n        }\n      ],\n      \"functionaries\": [\n        {\n          \"type\": \"publickey\",\n          \"publickeyid\": \"ci-key\"\n        }\n      ]\n    }\n  }\n}\n```\n\n**Pipeline Commands:**\n\n```bash\n# Step 1: Build\nwitness run --step build \\\n  --attestations git,commandrun,product \\\n  -o build.json --key ci-key.pem \\\n  -- go build -o myapp\n\n# Step 2: Test\nwitness run --step test \\\n  --attestations material,commandrun \\\n  -o test.json --key ci-key.pem \\\n  -- go test ./...\n\n# Step 3: Package\nwitness run --step package \\\n  --attestations material,product \\\n  -o package.json --key ci-key.pem \\\n  -- tar czf myapp.tar.gz myapp\n\n# Verify entire pipeline\nwitness verify \\\n  --policy policy-signed.json \\\n  --publickey policy-key.pub \\\n  -a build.json -a test.json -a package.json\n```\n"}]}
{"messages": [{"role": "system", "content": "You are an expert in the Witness supply chain attestation framework. You help users instrument CI/CD pipelines with witness, create policy documents, and write Rego policies to validate attestations. You understand all attestors in go-witness and how to use them effectively."}, {"role": "user", "content": "How do I create a witness policy for a build step that uses these attestors: environment, github, git, material?"}, {"role": "assistant", "content": "Here's a complete witness policy for your build step with environment, github, git, material attestors:\n\n**Policy Document:**\n```json\n{\n  \"expires\": \"2026-11-08T10:52:59Z\",\n  \"publickeys\": {\n    \"build-key\": {\n      \"keyid\": \"sha256:e2edfd0da225567b3018f4bca02d0ebe91e2f003a57e8ba28bbbc8e4e563ffb7\",\n      \"key\": \"-----BEGIN PUBLIC KEY-----\\n...\\n-----END PUBLIC KEY-----\"\n    }\n  },\n  \"steps\": {\n    \"build\": {\n      \"name\": \"build\",\n      \"attestations\": [\n        {\n          \"type\": \"https://witness.dev/attestations/environment/v0.1\"\n        },\n        {\n          \"type\": \"https://witness.dev/attestations/github/v0.1\"\n        },\n        {\n          \"type\": \"https://witness.dev/attestations/git/v0.1\"\n        },\n        {\n          \"type\": \"https://witness.dev/attestations/material/v0.1\"\n        }\n      ],\n      \"functionaries\": [\n        {\n          \"type\": \"publickey\",\n          \"publickeyid\": \"build-key\"\n        }\n      ]\n    }\n  }\n}\n```\n\n**Witness Run Command:**\n```bash\nwitness run --step build \\\n  --attestations environment,github,git,material \\\n  --outfile build-attestation.json \\\n  --key signing-key.pem \\\n  -- <your-build-command>\n```\n\n**Rego Validation Rules:**\n```rego\npackage environment\n\nimport rego.v1\n\n# Ensure correct OS\ndeny contains msg if {\n    input.os != \"linux\"\n    msg := sprintf(\"Must run on linux, got: %s\", [input.os])\n}\n\n# Require CI environment\ndeny contains msg if {\n    not \"CI\" in input.variables\n    msg := \"Must run in CI environment (CI variable not set)\"\n}\n```\n\n**Verification:**\n```bash\nwitness verify \\\n  --policy policy-signed.json \\\n  --publickey policy-key.pub \\\n  -a build-attestation.json \\\n  --subject <artifact>\n```\n"}]}
{"messages": [{"role": "system", "content": "You are an expert in the Witness supply chain attestation framework. You help users instrument CI/CD pipelines with witness, create policy documents, and write Rego policies to validate attestations. You understand all attestors in go-witness and how to use them effectively."}, {"role": "user", "content": "How do I create a witness policy for a build step that uses these attestors: environment, git, github, commandrun, product?"}, {"role": "assistant", "content": "Here's a complete witness policy for your build step with environment, git, github, commandrun, product attestors:\n\n**Policy Document:**\n```json\n{\n  \"expires\": \"2026-11-08T10:52:59Z\",\n  \"publickeys\": {\n    \"build-key\": {\n      \"keyid\": \"sha256:9f617fec740abacf6bbf701a6e0a60dbc999b46bc6e5f4a545356836a8171d5a\",\n      \"key\": \"-----BEGIN PUBLIC KEY-----\\n...\\n-----END PUBLIC KEY-----\"\n    }\n  },\n  \"steps\": {\n    \"build\": {\n      \"name\": \"build\",\n      \"attestations\": [\n        {\n          \"type\": \"https://witness.dev/attestations/environment/v0.1\"\n        },\n        {\n          \"type\": \"https://witness.dev/attestations/git/v0.1\"\n        },\n        {\n          \"type\": \"https://witness.dev/attestations/github/v0.1\"\n        },\n        {\n          \"type\": \"https://witness.dev/attestations/command-run/v0.1\"\n        },\n        {\n          \"type\": \"https://witness.dev/attestations/product/v0.1\"\n        }\n      ],\n      \"functionaries\": [\n        {\n          \"type\": \"publickey\",\n          \"publickeyid\": \"build-key\"\n        }\n      ]\n    }\n  }\n}\n```\n\n**Witness Run Command:**\n```bash\nwitness run --step build \\\n  --attestations environment,git,github,commandrun,product \\\n  --outfile build-attestation.json \\\n  --key signing-key.pem \\\n  -- <your-build-command>\n```\n\n**Rego Validation Rules:**\n```rego\npackage environment\n\nimport rego.v1\n\n# Ensure correct OS\ndeny contains msg if {\n    input.os != \"darwin\"\n    msg := sprintf(\"Must run on darwin, got: %s\", [input.os])\n}\n\n# Require CI environment\ndeny contains msg if {\n    not \"CI\" in input.variables\n    msg := \"Must run in CI environment (CI variable not set)\"\n}\n```\n\n**Verification:**\n```bash\nwitness verify \\\n  --policy policy-signed.json \\\n  --publickey policy-key.pub \\\n  -a build-attestation.json \\\n  --subject <artifact>\n```\n"}]}
{"messages": [{"role": "system", "content": "You are an expert in the Witness supply chain attestation framework. You help users instrument CI/CD pipelines with witness, create policy documents, and write Rego policies to validate attestations. You understand all attestors in go-witness and how to use them effectively."}, {"role": "user", "content": "How do I create a witness policy for a build step that uses these attestors: product, material, commandrun, git, github?"}, {"role": "assistant", "content": "Here's a complete witness policy for your build step with product, material, commandrun, git, github attestors:\n\n**Policy Document:**\n```json\n{\n  \"expires\": \"2026-11-08T10:52:59Z\",\n  \"publickeys\": {\n    \"build-key\": {\n      \"keyid\": \"sha256:62a9589adcc87238dab5e2d98c3b88d5e963a2e72b2420a8650681fe07d56555\",\n      \"key\": \"-----BEGIN PUBLIC KEY-----\\n...\\n-----END PUBLIC KEY-----\"\n    }\n  },\n  \"steps\": {\n    \"build\": {\n      \"name\": \"build\",\n      \"attestations\": [\n        {\n          \"type\": \"https://witness.dev/attestations/product/v0.1\"\n        },\n        {\n          \"type\": \"https://witness.dev/attestations/material/v0.1\"\n        },\n        {\n          \"type\": \"https://witness.dev/attestations/command-run/v0.1\"\n        },\n        {\n          \"type\": \"https://witness.dev/attestations/git/v0.1\"\n        },\n        {\n          \"type\": \"https://witness.dev/attestations/github/v0.1\"\n        }\n      ],\n      \"functionaries\": [\n        {\n          \"type\": \"publickey\",\n          \"publickeyid\": \"build-key\"\n        }\n      ]\n    }\n  }\n}\n```\n\n**Witness Run Command:**\n```bash\nwitness run --step build \\\n  --attestations product,material,commandrun,git,github \\\n  --outfile build-attestation.json \\\n  --key signing-key.pem \\\n  -- <your-build-command>\n```\n\n**Rego Validation Rules:**\n```rego\n\n```\n\n**Verification:**\n```bash\nwitness verify \\\n  --policy policy-signed.json \\\n  --publickey policy-key.pub \\\n  -a build-attestation.json \\\n  --subject <artifact>\n```\n"}]}
{"messages": [{"role": "system", "content": "You are an expert in the Witness supply chain attestation framework. You help users instrument CI/CD pipelines with witness, create policy documents, and write Rego policies to validate attestations. You understand all attestors in go-witness and how to use them effectively."}, {"role": "user", "content": "How do I create a witness policy for a build step that uses these attestors: commandrun?"}, {"role": "assistant", "content": "Here's a complete witness policy for your build step with commandrun attestors:\n\n**Policy Document:**\n```json\n{\n  \"expires\": \"2026-11-08T10:52:59Z\",\n  \"publickeys\": {\n    \"build-key\": {\n      \"keyid\": \"sha256:b2b94e21e8c9329880917319d2a93d9b984e5b48e56ea13af05271a3bec685f5\",\n      \"key\": \"-----BEGIN PUBLIC KEY-----\\n...\\n-----END PUBLIC KEY-----\"\n    }\n  },\n  \"steps\": {\n    \"build\": {\n      \"name\": \"build\",\n      \"attestations\": [\n        {\n          \"type\": \"https://witness.dev/attestations/command-run/v0.1\"\n        }\n      ],\n      \"functionaries\": [\n        {\n          \"type\": \"publickey\",\n          \"publickeyid\": \"build-key\"\n        }\n      ]\n    }\n  }\n}\n```\n\n**Witness Run Command:**\n```bash\nwitness run --step build \\\n  --attestations commandrun \\\n  --outfile build-attestation.json \\\n  --key signing-key.pem \\\n  -- <your-build-command>\n```\n\n**Rego Validation Rules:**\n```rego\n\n```\n\n**Verification:**\n```bash\nwitness verify \\\n  --policy policy-signed.json \\\n  --publickey policy-key.pub \\\n  -a build-attestation.json \\\n  --subject <artifact>\n```\n"}]}
{"messages": [{"role": "system", "content": "You are an expert in the Witness supply chain attestation framework. You help users instrument CI/CD pipelines with witness, create policy documents, and write Rego policies to validate attestations. You understand all attestors in go-witness and how to use them effectively."}, {"role": "user", "content": "How do I create a witness policy for a build step that uses these attestors: git, environment, product, commandrun, material?"}, {"role": "assistant", "content": "Here's a complete witness policy for your build step with git, environment, product, commandrun, material attestors:\n\n**Policy Document:**\n```json\n{\n  \"expires\": \"2026-11-08T10:52:59Z\",\n  \"publickeys\": {\n    \"build-key\": {\n      \"keyid\": \"sha256:0d1b65a214c6ceb706fef3d78547b807e1a7efe4d2ef4ad395da321a48e6e3dc\",\n      \"key\": \"-----BEGIN PUBLIC KEY-----\\n...\\n-----END PUBLIC KEY-----\"\n    }\n  },\n  \"steps\": {\n    \"build\": {\n      \"name\": \"build\",\n      \"attestations\": [\n        {\n          \"type\": \"https://witness.dev/attestations/git/v0.1\"\n        },\n        {\n          \"type\": \"https://witness.dev/attestations/environment/v0.1\"\n        },\n        {\n          \"type\": \"https://witness.dev/attestations/product/v0.1\"\n        },\n        {\n          \"type\": \"https://witness.dev/attestations/command-run/v0.1\"\n        },\n        {\n          \"type\": \"https://witness.dev/attestations/material/v0.1\"\n        }\n      ],\n      \"functionaries\": [\n        {\n          \"type\": \"publickey\",\n          \"publickeyid\": \"build-key\"\n        }\n      ]\n    }\n  }\n}\n```\n\n**Witness Run Command:**\n```bash\nwitness run --step build \\\n  --attestations git,environment,product,commandrun,material \\\n  --outfile build-attestation.json \\\n  --key signing-key.pem \\\n  -- <your-build-command>\n```\n\n**Rego Validation Rules:**\n```rego\npackage git\n\nimport rego.v1\n\n# Enforce builds from specific branch\ndeny contains msg if {\n    input.branch != \"staging\"\n    msg := sprintf(\"Must build from staging branch, got: %s\", [input.branch])\n}\n\n# Require clean working directory\ndeny contains msg if {\n    count(input.status) > 0\n    msg := \"Working directory must be clean (no uncommitted changes)\"\n}\n\n# Validate commit author\napproved_authors := {\n    \"alice.smith@example.com\",\n    \"bob.jones@company.com\",\n    \"ci-bot@company.com\"\n}\n\ndeny contains msg if {\n    not input.authoremail in approved_authors\n    msg := sprintf(\"Unauthorized commit author: %s\", [input.authoremail])\n}\n```\n\n**Verification:**\n```bash\nwitness verify \\\n  --policy policy-signed.json \\\n  --publickey policy-key.pub \\\n  -a build-attestation.json \\\n  --subject <artifact>\n```\n"}]}
{"messages": [{"role": "system", "content": "You are an expert in the Witness supply chain attestation framework. You help users instrument CI/CD pipelines with witness, create policy documents, and write Rego policies to validate attestations. You understand all attestors in go-witness and how to use them effectively."}, {"role": "user", "content": "How do I create a witness policy for a build step that uses these attestors: git, github, commandrun?"}, {"role": "assistant", "content": "Here's a complete witness policy for your build step with git, github, commandrun attestors:\n\n**Policy Document:**\n```json\n{\n  \"expires\": \"2026-11-08T10:52:59Z\",\n  \"publickeys\": {\n    \"build-key\": {\n      \"keyid\": \"sha256:2da12cca3852bfb1bb5323ed4474dcf64d82a1770cab2ed89594d885f045ae64\",\n      \"key\": \"-----BEGIN PUBLIC KEY-----\\n...\\n-----END PUBLIC KEY-----\"\n    }\n  },\n  \"steps\": {\n    \"build\": {\n      \"name\": \"build\",\n      \"attestations\": [\n        {\n          \"type\": \"https://witness.dev/attestations/git/v0.1\"\n        },\n        {\n          \"type\": \"https://witness.dev/attestations/github/v0.1\"\n        },\n        {\n          \"type\": \"https://witness.dev/attestations/command-run/v0.1\"\n        }\n      ],\n      \"functionaries\": [\n        {\n          \"type\": \"publickey\",\n          \"publickeyid\": \"build-key\"\n        }\n      ]\n    }\n  }\n}\n```\n\n**Witness Run Command:**\n```bash\nwitness run --step build \\\n  --attestations git,github,commandrun \\\n  --outfile build-attestation.json \\\n  --key signing-key.pem \\\n  -- <your-build-command>\n```\n\n**Rego Validation Rules:**\n```rego\npackage git\n\nimport rego.v1\n\n# Enforce builds from specific branch\ndeny contains msg if {\n    input.branch != \"master\"\n    msg := sprintf(\"Must build from master branch, got: %s\", [input.branch])\n}\n\n# Require clean working directory\ndeny contains msg if {\n    count(input.status) > 0\n    msg := \"Working directory must be clean (no uncommitted changes)\"\n}\n\n# Validate commit author\napproved_authors := {\n    \"alice.smith@example.com\",\n    \"bob.jones@company.com\",\n    \"ci-bot@company.com\"\n}\n\ndeny contains msg if {\n    not input.authoremail in approved_authors\n    msg := sprintf(\"Unauthorized commit author: %s\", [input.authoremail])\n}\n```\n\n**Verification:**\n```bash\nwitness verify \\\n  --policy policy-signed.json \\\n  --publickey policy-key.pub \\\n  -a build-attestation.json \\\n  --subject <artifact>\n```\n"}]}
{"messages": [{"role": "system", "content": "You are an expert in the Witness supply chain attestation framework. You help users instrument CI/CD pipelines with witness, create policy documents, and write Rego policies to validate attestations. You understand all attestors in go-witness and how to use them effectively."}, {"role": "user", "content": "How do I create a witness policy for a build step that uses these attestors: product?"}, {"role": "assistant", "content": "Here's a complete witness policy for your build step with product attestors:\n\n**Policy Document:**\n```json\n{\n  \"expires\": \"2026-11-08T10:52:59Z\",\n  \"publickeys\": {\n    \"build-key\": {\n      \"keyid\": \"sha256:ca25a609e935619d05e89396fd0d339d2538d509c6ab11dee1420eca5c21bdbe\",\n      \"key\": \"-----BEGIN PUBLIC KEY-----\\n...\\n-----END PUBLIC KEY-----\"\n    }\n  },\n  \"steps\": {\n    \"build\": {\n      \"name\": \"build\",\n      \"attestations\": [\n        {\n          \"type\": \"https://witness.dev/attestations/product/v0.1\"\n        }\n      ],\n      \"functionaries\": [\n        {\n          \"type\": \"publickey\",\n          \"publickeyid\": \"build-key\"\n        }\n      ]\n    }\n  }\n}\n```\n\n**Witness Run Command:**\n```bash\nwitness run --step build \\\n  --attestations product \\\n  --outfile build-attestation.json \\\n  --key signing-key.pem \\\n  -- <your-build-command>\n```\n\n**Rego Validation Rules:**\n```rego\n\n```\n\n**Verification:**\n```bash\nwitness verify \\\n  --policy policy-signed.json \\\n  --publickey policy-key.pub \\\n  -a build-attestation.json \\\n  --subject <artifact>\n```\n"}]}
{"messages": [{"role": "system", "content": "You are an expert in the Witness supply chain attestation framework. You help users instrument CI/CD pipelines with witness, create policy documents, and write Rego policies to validate attestations. You understand all attestors in go-witness and how to use them effectively."}, {"role": "user", "content": "How do I create a witness policy for a build step that uses these attestors: commandrun, product, environment, material, git?"}, {"role": "assistant", "content": "Here's a complete witness policy for your build step with commandrun, product, environment, material, git attestors:\n\n**Policy Document:**\n```json\n{\n  \"expires\": \"2026-11-08T10:52:59Z\",\n  \"publickeys\": {\n    \"build-key\": {\n      \"keyid\": \"sha256:284a8b8f3abe244e994b54617ee8c299d9357110a6b853410b387a17a538f0af\",\n      \"key\": \"-----BEGIN PUBLIC KEY-----\\n...\\n-----END PUBLIC KEY-----\"\n    }\n  },\n  \"steps\": {\n    \"build\": {\n      \"name\": \"build\",\n      \"attestations\": [\n        {\n          \"type\": \"https://witness.dev/attestations/command-run/v0.1\"\n        },\n        {\n          \"type\": \"https://witness.dev/attestations/product/v0.1\"\n        },\n        {\n          \"type\": \"https://witness.dev/attestations/environment/v0.1\"\n        },\n        {\n          \"type\": \"https://witness.dev/attestations/material/v0.1\"\n        },\n        {\n          \"type\": \"https://witness.dev/attestations/git/v0.1\"\n        }\n      ],\n      \"functionaries\": [\n        {\n          \"type\": \"publickey\",\n          \"publickeyid\": \"build-key\"\n        }\n      ]\n    }\n  }\n}\n```\n\n**Witness Run Command:**\n```bash\nwitness run --step build \\\n  --attestations commandrun,product,environment,material,git \\\n  --outfile build-attestation.json \\\n  --key signing-key.pem \\\n  -- <your-build-command>\n```\n\n**Rego Validation Rules:**\n```rego\n\n```\n\n**Verification:**\n```bash\nwitness verify \\\n  --policy policy-signed.json \\\n  --publickey policy-key.pub \\\n  -a build-attestation.json \\\n  --subject <artifact>\n```\n"}]}
{"messages": [{"role": "system", "content": "You are an expert in the Witness supply chain attestation framework. You help users instrument CI/CD pipelines with witness, create policy documents, and write Rego policies to validate attestations. You understand all attestors in go-witness and how to use them effectively."}, {"role": "user", "content": "How do I create a witness policy for a build step that uses these attestors: material?"}, {"role": "assistant", "content": "Here's a complete witness policy for your build step with material attestors:\n\n**Policy Document:**\n```json\n{\n  \"expires\": \"2026-11-08T10:52:59Z\",\n  \"publickeys\": {\n    \"build-key\": {\n      \"keyid\": \"sha256:2b06fba3ab0630890aee3123734fe2bb89212b90b13323e2f128d90d854deecf\",\n      \"key\": \"-----BEGIN PUBLIC KEY-----\\n...\\n-----END PUBLIC KEY-----\"\n    }\n  },\n  \"steps\": {\n    \"build\": {\n      \"name\": \"build\",\n      \"attestations\": [\n        {\n          \"type\": \"https://witness.dev/attestations/material/v0.1\"\n        }\n      ],\n      \"functionaries\": [\n        {\n          \"type\": \"publickey\",\n          \"publickeyid\": \"build-key\"\n        }\n      ]\n    }\n  }\n}\n```\n\n**Witness Run Command:**\n```bash\nwitness run --step build \\\n  --attestations material \\\n  --outfile build-attestation.json \\\n  --key signing-key.pem \\\n  -- <your-build-command>\n```\n\n**Rego Validation Rules:**\n```rego\n\n```\n\n**Verification:**\n```bash\nwitness verify \\\n  --policy policy-signed.json \\\n  --publickey policy-key.pub \\\n  -a build-attestation.json \\\n  --subject <artifact>\n```\n"}]}
{"messages": [{"role": "system", "content": "You are an expert in the Witness supply chain attestation framework. You help users instrument CI/CD pipelines with witness, create policy documents, and write Rego policies to validate attestations. You understand all attestors in go-witness and how to use them effectively."}, {"role": "user", "content": "How do I create a witness policy for a build step that uses these attestors: material, environment, git?"}, {"role": "assistant", "content": "Here's a complete witness policy for your build step with material, environment, git attestors:\n\n**Policy Document:**\n```json\n{\n  \"expires\": \"2026-11-08T10:52:59Z\",\n  \"publickeys\": {\n    \"build-key\": {\n      \"keyid\": \"sha256:e3b33a09c1b314730d9a1d03162d0ba386d11c15f06931e4eca9eebd645106a9\",\n      \"key\": \"-----BEGIN PUBLIC KEY-----\\n...\\n-----END PUBLIC KEY-----\"\n    }\n  },\n  \"steps\": {\n    \"build\": {\n      \"name\": \"build\",\n      \"attestations\": [\n        {\n          \"type\": \"https://witness.dev/attestations/material/v0.1\"\n        },\n        {\n          \"type\": \"https://witness.dev/attestations/environment/v0.1\"\n        },\n        {\n          \"type\": \"https://witness.dev/attestations/git/v0.1\"\n        }\n      ],\n      \"functionaries\": [\n        {\n          \"type\": \"publickey\",\n          \"publickeyid\": \"build-key\"\n        }\n      ]\n    }\n  }\n}\n```\n\n**Witness Run Command:**\n```bash\nwitness run --step build \\\n  --attestations material,environment,git \\\n  --outfile build-attestation.json \\\n  --key signing-key.pem \\\n  -- <your-build-command>\n```\n\n**Rego Validation Rules:**\n```rego\n\n```\n\n**Verification:**\n```bash\nwitness verify \\\n  --policy policy-signed.json \\\n  --publickey policy-key.pub \\\n  -a build-attestation.json \\\n  --subject <artifact>\n```\n"}]}
{"messages": [{"role": "system", "content": "You are an expert in the Witness supply chain attestation framework. You help users instrument CI/CD pipelines with witness, create policy documents, and write Rego policies to validate attestations. You understand all attestors in go-witness and how to use them effectively."}, {"role": "user", "content": "How do I create a witness policy for a build step that uses these attestors: material?"}, {"role": "assistant", "content": "Here's a complete witness policy for your build step with material attestors:\n\n**Policy Document:**\n```json\n{\n  \"expires\": \"2026-11-08T10:52:59Z\",\n  \"publickeys\": {\n    \"build-key\": {\n      \"keyid\": \"sha256:3259ac7c1c205a86e1a027d28ca0349df351661ece29b30343407744c688ccdb\",\n      \"key\": \"-----BEGIN PUBLIC KEY-----\\n...\\n-----END PUBLIC KEY-----\"\n    }\n  },\n  \"steps\": {\n    \"build\": {\n      \"name\": \"build\",\n      \"attestations\": [\n        {\n          \"type\": \"https://witness.dev/attestations/material/v0.1\"\n        }\n      ],\n      \"functionaries\": [\n        {\n          \"type\": \"publickey\",\n          \"publickeyid\": \"build-key\"\n        }\n      ]\n    }\n  }\n}\n```\n\n**Witness Run Command:**\n```bash\nwitness run --step build \\\n  --attestations material \\\n  --outfile build-attestation.json \\\n  --key signing-key.pem \\\n  -- <your-build-command>\n```\n\n**Rego Validation Rules:**\n```rego\n\n```\n\n**Verification:**\n```bash\nwitness verify \\\n  --policy policy-signed.json \\\n  --publickey policy-key.pub \\\n  -a build-attestation.json \\\n  --subject <artifact>\n```\n"}]}
{"messages": [{"role": "system", "content": "You are an expert in the Witness supply chain attestation framework. You help users instrument CI/CD pipelines with witness, create policy documents, and write Rego policies to validate attestations. You understand all attestors in go-witness and how to use them effectively."}, {"role": "user", "content": "How do I create a witness policy for a build step that uses these attestors: commandrun?"}, {"role": "assistant", "content": "Here's a complete witness policy for your build step with commandrun attestors:\n\n**Policy Document:**\n```json\n{\n  \"expires\": \"2026-11-08T10:52:59Z\",\n  \"publickeys\": {\n    \"build-key\": {\n      \"keyid\": \"sha256:f013c04d46d6122282435e9d91fcd3561bc59747f5c3aec8c49ca6a5ac37f890\",\n      \"key\": \"-----BEGIN PUBLIC KEY-----\\n...\\n-----END PUBLIC KEY-----\"\n    }\n  },\n  \"steps\": {\n    \"build\": {\n      \"name\": \"build\",\n      \"attestations\": [\n        {\n          \"type\": \"https://witness.dev/attestations/command-run/v0.1\"\n        }\n      ],\n      \"functionaries\": [\n        {\n          \"type\": \"publickey\",\n          \"publickeyid\": \"build-key\"\n        }\n      ]\n    }\n  }\n}\n```\n\n**Witness Run Command:**\n```bash\nwitness run --step build \\\n  --attestations commandrun \\\n  --outfile build-attestation.json \\\n  --key signing-key.pem \\\n  -- <your-build-command>\n```\n\n**Rego Validation Rules:**\n```rego\n\n```\n\n**Verification:**\n```bash\nwitness verify \\\n  --policy policy-signed.json \\\n  --publickey policy-key.pub \\\n  -a build-attestation.json \\\n  --subject <artifact>\n```\n"}]}
{"messages": [{"role": "system", "content": "You are an expert in the Witness supply chain attestation framework. You help users instrument CI/CD pipelines with witness, create policy documents, and write Rego policies to validate attestations. You understand all attestors in go-witness and how to use them effectively."}, {"role": "user", "content": "How do I create a multi-step witness policy for a build \u2192 test \u2192 package pipeline?"}, {"role": "assistant", "content": "Here's a complete multi-step witness policy for your pipeline:\n\n**Policy Document:**\n```json\n{\n  \"expires\": \"2026-11-08T10:52:59Z\",\n  \"publickeys\": {\n    \"ci-key\": {\n      \"keyid\": \"sha256:e6539a001795e960c68e7c0550eec45c7bd71bc9944193006f2bcabd37c3e4a9\",\n      \"key\": \"-----BEGIN PUBLIC KEY-----\\n...\\n-----END PUBLIC KEY-----\"\n    }\n  },\n  \"steps\": {\n    \"build\": {\n      \"name\": \"build\",\n      \"attestations\": [\n        {\n          \"type\": \"https://witness.dev/attestations/git/v0.1\"\n        },\n        {\n          \"type\": \"https://witness.dev/attestations/command-run/v0.1\"\n        },\n        {\n          \"type\": \"https://witness.dev/attestations/product/v0.1\"\n        }\n      ],\n      \"functionaries\": [\n        {\n          \"type\": \"publickey\",\n          \"publickeyid\": \"ci-key\"\n        }\n      ]\n    },\n    \"test\": {\n      \"name\": \"test\",\n      \"attestations\": [\n        {\n          \"type\": \"https://witness.dev/attestations/material/v0.1\"\n        },\n        {\n          \"type\": \"https://witness.dev/attestations/command-run/v0.1\"\n        }\n      ],\n      \"functionaries\": [\n        {\n          \"type\": \"publickey\",\n          \"publickeyid\": \"ci-key\"\n        }\n      ]\n    },\n    \"package\": {\n      \"name\": \"package\",\n      \"attestations\": [\n        {\n          \"type\": \"https://witness.dev/attestations/material/v0.1\"\n        },\n        {\n          \"type\": \"https://witness.dev/attestations/product/v0.1\"\n        }\n      ],\n      \"functionaries\": [\n        {\n          \"type\": \"publickey\",\n          \"publickeyid\": \"ci-key\"\n        }\n      ]\n    }\n  }\n}\n```\n\n**Pipeline Commands:**\n\n```bash\n# Step 1: Build\nwitness run --step build \\\n  --attestations git,commandrun,product \\\n  -o build.json --key ci-key.pem \\\n  -- go build -o myapp\n\n# Step 2: Test\nwitness run --step test \\\n  --attestations material,commandrun \\\n  -o test.json --key ci-key.pem \\\n  -- go test ./...\n\n# Step 3: Package\nwitness run --step package \\\n  --attestations material,product \\\n  -o package.json --key ci-key.pem \\\n  -- tar czf myapp.tar.gz myapp\n\n# Verify entire pipeline\nwitness verify \\\n  --policy policy-signed.json \\\n  --publickey policy-key.pub \\\n  -a build.json -a test.json -a package.json\n```\n"}]}
{"messages": [{"role": "system", "content": "You are an expert in the Witness supply chain attestation framework. You help users instrument CI/CD pipelines with witness, create policy documents, and write Rego policies to validate attestations. You understand all attestors in go-witness and how to use them effectively."}, {"role": "user", "content": "How do I create a witness policy for a build step that uses these attestors: git?"}, {"role": "assistant", "content": "Here's a complete witness policy for your build step with git attestors:\n\n**Policy Document:**\n```json\n{\n  \"expires\": \"2026-11-08T10:52:59Z\",\n  \"publickeys\": {\n    \"build-key\": {\n      \"keyid\": \"sha256:b7b5384c047d2bb16127c63e7dae465a83f861f163df45997a028a3d245b4db0\",\n      \"key\": \"-----BEGIN PUBLIC KEY-----\\n...\\n-----END PUBLIC KEY-----\"\n    }\n  },\n  \"steps\": {\n    \"build\": {\n      \"name\": \"build\",\n      \"attestations\": [\n        {\n          \"type\": \"https://witness.dev/attestations/git/v0.1\"\n        }\n      ],\n      \"functionaries\": [\n        {\n          \"type\": \"publickey\",\n          \"publickeyid\": \"build-key\"\n        }\n      ]\n    }\n  }\n}\n```\n\n**Witness Run Command:**\n```bash\nwitness run --step build \\\n  --attestations git \\\n  --outfile build-attestation.json \\\n  --key signing-key.pem \\\n  -- <your-build-command>\n```\n\n**Rego Validation Rules:**\n```rego\npackage git\n\nimport rego.v1\n\n# Enforce builds from specific branch\ndeny contains msg if {\n    input.branch != \"master\"\n    msg := sprintf(\"Must build from master branch, got: %s\", [input.branch])\n}\n\n# Require clean working directory\ndeny contains msg if {\n    count(input.status) > 0\n    msg := \"Working directory must be clean (no uncommitted changes)\"\n}\n\n# Validate commit author\napproved_authors := {\n    \"alice.smith@example.com\",\n    \"bob.jones@company.com\",\n    \"ci-bot@company.com\"\n}\n\ndeny contains msg if {\n    not input.authoremail in approved_authors\n    msg := sprintf(\"Unauthorized commit author: %s\", [input.authoremail])\n}\n```\n\n**Verification:**\n```bash\nwitness verify \\\n  --policy policy-signed.json \\\n  --publickey policy-key.pub \\\n  -a build-attestation.json \\\n  --subject <artifact>\n```\n"}]}
{"messages": [{"role": "system", "content": "You are an expert in the Witness supply chain attestation framework. You help users instrument CI/CD pipelines with witness, create policy documents, and write Rego policies to validate attestations. You understand all attestors in go-witness and how to use them effectively."}, {"role": "user", "content": "How do I create a multi-step witness policy for a build \u2192 test \u2192 package pipeline?"}, {"role": "assistant", "content": "Here's a complete multi-step witness policy for your pipeline:\n\n**Policy Document:**\n```json\n{\n  \"expires\": \"2026-11-08T10:52:59Z\",\n  \"publickeys\": {\n    \"ci-key\": {\n      \"keyid\": \"sha256:e4acb7eeda8647f860300c07e700b4893b34d82d59a44170585d1bc5e93b2646\",\n      \"key\": \"-----BEGIN PUBLIC KEY-----\\n...\\n-----END PUBLIC KEY-----\"\n    }\n  },\n  \"steps\": {\n    \"build\": {\n      \"name\": \"build\",\n      \"attestations\": [\n        {\n          \"type\": \"https://witness.dev/attestations/git/v0.1\"\n        },\n        {\n          \"type\": \"https://witness.dev/attestations/command-run/v0.1\"\n        },\n        {\n          \"type\": \"https://witness.dev/attestations/product/v0.1\"\n        }\n      ],\n      \"functionaries\": [\n        {\n          \"type\": \"publickey\",\n          \"publickeyid\": \"ci-key\"\n        }\n      ]\n    },\n    \"test\": {\n      \"name\": \"test\",\n      \"attestations\": [\n        {\n          \"type\": \"https://witness.dev/attestations/material/v0.1\"\n        },\n        {\n          \"type\": \"https://witness.dev/attestations/command-run/v0.1\"\n        }\n      ],\n      \"functionaries\": [\n        {\n          \"type\": \"publickey\",\n          \"publickeyid\": \"ci-key\"\n        }\n      ]\n    },\n    \"package\": {\n      \"name\": \"package\",\n      \"attestations\": [\n        {\n          \"type\": \"https://witness.dev/attestations/material/v0.1\"\n        },\n        {\n          \"type\": \"https://witness.dev/attestations/product/v0.1\"\n        }\n      ],\n      \"functionaries\": [\n        {\n          \"type\": \"publickey\",\n          \"publickeyid\": \"ci-key\"\n        }\n      ]\n    }\n  }\n}\n```\n\n**Pipeline Commands:**\n\n```bash\n# Step 1: Build\nwitness run --step build \\\n  --attestations git,commandrun,product \\\n  -o build.json --key ci-key.pem \\\n  -- go build -o myapp\n\n# Step 2: Test\nwitness run --step test \\\n  --attestations material,commandrun \\\n  -o test.json --key ci-key.pem \\\n  -- go test ./...\n\n# Step 3: Package\nwitness run --step package \\\n  --attestations material,product \\\n  -o package.json --key ci-key.pem \\\n  -- tar czf myapp.tar.gz myapp\n\n# Verify entire pipeline\nwitness verify \\\n  --policy policy-signed.json \\\n  --publickey policy-key.pub \\\n  -a build.json -a test.json -a package.json\n```\n"}]}
{"messages": [{"role": "system", "content": "You are an expert in the Witness supply chain attestation framework. You help users instrument CI/CD pipelines with witness, create policy documents, and write Rego policies to validate attestations. You understand all attestors in go-witness and how to use them effectively."}, {"role": "user", "content": "How do I create a witness policy for a build step that uses these attestors: git, github, environment?"}, {"role": "assistant", "content": "Here's a complete witness policy for your build step with git, github, environment attestors:\n\n**Policy Document:**\n```json\n{\n  \"expires\": \"2026-11-08T10:52:59Z\",\n  \"publickeys\": {\n    \"build-key\": {\n      \"keyid\": \"sha256:ec5f84b5febad5fafb8ac859efd305aa32aa603c0d5947abc0035866aa33af5f\",\n      \"key\": \"-----BEGIN PUBLIC KEY-----\\n...\\n-----END PUBLIC KEY-----\"\n    }\n  },\n  \"steps\": {\n    \"build\": {\n      \"name\": \"build\",\n      \"attestations\": [\n        {\n          \"type\": \"https://witness.dev/attestations/git/v0.1\"\n        },\n        {\n          \"type\": \"https://witness.dev/attestations/github/v0.1\"\n        },\n        {\n          \"type\": \"https://witness.dev/attestations/environment/v0.1\"\n        }\n      ],\n      \"functionaries\": [\n        {\n          \"type\": \"publickey\",\n          \"publickeyid\": \"build-key\"\n        }\n      ]\n    }\n  }\n}\n```\n\n**Witness Run Command:**\n```bash\nwitness run --step build \\\n  --attestations git,github,environment \\\n  --outfile build-attestation.json \\\n  --key signing-key.pem \\\n  -- <your-build-command>\n```\n\n**Rego Validation Rules:**\n```rego\npackage git\n\nimport rego.v1\n\n# Enforce builds from specific branch\ndeny contains msg if {\n    input.branch != \"feature/auth\"\n    msg := sprintf(\"Must build from feature/auth branch, got: %s\", [input.branch])\n}\n\n# Validate commit author\napproved_authors := {\n    \"alice.smith@example.com\",\n    \"bob.jones@company.com\",\n    \"ci-bot@company.com\"\n}\n\ndeny contains msg if {\n    not input.authoremail in approved_authors\n    msg := sprintf(\"Unauthorized commit author: %s\", [input.authoremail])\n}\n```\n\n**Verification:**\n```bash\nwitness verify \\\n  --policy policy-signed.json \\\n  --publickey policy-key.pub \\\n  -a build-attestation.json \\\n  --subject <artifact>\n```\n"}]}
{"messages": [{"role": "system", "content": "You are an expert in the Witness supply chain attestation framework. You help users instrument CI/CD pipelines with witness, create policy documents, and write Rego policies to validate attestations. You understand all attestors in go-witness and how to use them effectively."}, {"role": "user", "content": "How do I create a multi-step witness policy for a build \u2192 test \u2192 package pipeline?"}, {"role": "assistant", "content": "Here's a complete multi-step witness policy for your pipeline:\n\n**Policy Document:**\n```json\n{\n  \"expires\": \"2026-11-08T10:52:59Z\",\n  \"publickeys\": {\n    \"ci-key\": {\n      \"keyid\": \"sha256:bcf55a2d61b81d6432da58e9b699c4fa6e51a045e8cc9fa281ce2aac5bb293f6\",\n      \"key\": \"-----BEGIN PUBLIC KEY-----\\n...\\n-----END PUBLIC KEY-----\"\n    }\n  },\n  \"steps\": {\n    \"build\": {\n      \"name\": \"build\",\n      \"attestations\": [\n        {\n          \"type\": \"https://witness.dev/attestations/git/v0.1\"\n        },\n        {\n          \"type\": \"https://witness.dev/attestations/command-run/v0.1\"\n        },\n        {\n          \"type\": \"https://witness.dev/attestations/product/v0.1\"\n        }\n      ],\n      \"functionaries\": [\n        {\n          \"type\": \"publickey\",\n          \"publickeyid\": \"ci-key\"\n        }\n      ]\n    },\n    \"test\": {\n      \"name\": \"test\",\n      \"attestations\": [\n        {\n          \"type\": \"https://witness.dev/attestations/material/v0.1\"\n        },\n        {\n          \"type\": \"https://witness.dev/attestations/command-run/v0.1\"\n        }\n      ],\n      \"functionaries\": [\n        {\n          \"type\": \"publickey\",\n          \"publickeyid\": \"ci-key\"\n        }\n      ]\n    },\n    \"package\": {\n      \"name\": \"package\",\n      \"attestations\": [\n        {\n          \"type\": \"https://witness.dev/attestations/material/v0.1\"\n        },\n        {\n          \"type\": \"https://witness.dev/attestations/product/v0.1\"\n        }\n      ],\n      \"functionaries\": [\n        {\n          \"type\": \"publickey\",\n          \"publickeyid\": \"ci-key\"\n        }\n      ]\n    }\n  }\n}\n```\n\n**Pipeline Commands:**\n\n```bash\n# Step 1: Build\nwitness run --step build \\\n  --attestations git,commandrun,product \\\n  -o build.json --key ci-key.pem \\\n  -- go build -o myapp\n\n# Step 2: Test\nwitness run --step test \\\n  --attestations material,commandrun \\\n  -o test.json --key ci-key.pem \\\n  -- go test ./...\n\n# Step 3: Package\nwitness run --step package \\\n  --attestations material,product \\\n  -o package.json --key ci-key.pem \\\n  -- tar czf myapp.tar.gz myapp\n\n# Verify entire pipeline\nwitness verify \\\n  --policy policy-signed.json \\\n  --publickey policy-key.pub \\\n  -a build.json -a test.json -a package.json\n```\n"}]}
{"messages": [{"role": "system", "content": "You are an expert in the Witness supply chain attestation framework. You help users instrument CI/CD pipelines with witness, create policy documents, and write Rego policies to validate attestations. You understand all attestors in go-witness and how to use them effectively."}, {"role": "user", "content": "How do I create a witness policy for a build step that uses these attestors: github, product?"}, {"role": "assistant", "content": "Here's a complete witness policy for your build step with github, product attestors:\n\n**Policy Document:**\n```json\n{\n  \"expires\": \"2026-11-08T10:52:59Z\",\n  \"publickeys\": {\n    \"build-key\": {\n      \"keyid\": \"sha256:5ad67e2350602c1e24088a7825a5022bb84d2c85dbafe7d2b440a545be681fdd\",\n      \"key\": \"-----BEGIN PUBLIC KEY-----\\n...\\n-----END PUBLIC KEY-----\"\n    }\n  },\n  \"steps\": {\n    \"build\": {\n      \"name\": \"build\",\n      \"attestations\": [\n        {\n          \"type\": \"https://witness.dev/attestations/github/v0.1\"\n        },\n        {\n          \"type\": \"https://witness.dev/attestations/product/v0.1\"\n        }\n      ],\n      \"functionaries\": [\n        {\n          \"type\": \"publickey\",\n          \"publickeyid\": \"build-key\"\n        }\n      ]\n    }\n  }\n}\n```\n\n**Witness Run Command:**\n```bash\nwitness run --step build \\\n  --attestations github,product \\\n  --outfile build-attestation.json \\\n  --key signing-key.pem \\\n  -- <your-build-command>\n```\n\n**Rego Validation Rules:**\n```rego\n\n```\n\n**Verification:**\n```bash\nwitness verify \\\n  --policy policy-signed.json \\\n  --publickey policy-key.pub \\\n  -a build-attestation.json \\\n  --subject <artifact>\n```\n"}]}
{"messages": [{"role": "system", "content": "You are an expert in the Witness supply chain attestation framework. You help users instrument CI/CD pipelines with witness, create policy documents, and write Rego policies to validate attestations. You understand all attestors in go-witness and how to use them effectively."}, {"role": "user", "content": "How do I create a multi-step witness policy for a build \u2192 test \u2192 package pipeline?"}, {"role": "assistant", "content": "Here's a complete multi-step witness policy for your pipeline:\n\n**Policy Document:**\n```json\n{\n  \"expires\": \"2026-11-08T10:52:59Z\",\n  \"publickeys\": {\n    \"ci-key\": {\n      \"keyid\": \"sha256:932cbf92d5d217da7471aa3bcbccbc95e884f42e488701b0aa7f43b7785be2de\",\n      \"key\": \"-----BEGIN PUBLIC KEY-----\\n...\\n-----END PUBLIC KEY-----\"\n    }\n  },\n  \"steps\": {\n    \"build\": {\n      \"name\": \"build\",\n      \"attestations\": [\n        {\n          \"type\": \"https://witness.dev/attestations/git/v0.1\"\n        },\n        {\n          \"type\": \"https://witness.dev/attestations/command-run/v0.1\"\n        },\n        {\n          \"type\": \"https://witness.dev/attestations/product/v0.1\"\n        }\n      ],\n      \"functionaries\": [\n        {\n          \"type\": \"publickey\",\n          \"publickeyid\": \"ci-key\"\n        }\n      ]\n    },\n    \"test\": {\n      \"name\": \"test\",\n      \"attestations\": [\n        {\n          \"type\": \"https://witness.dev/attestations/material/v0.1\"\n        },\n        {\n          \"type\": \"https://witness.dev/attestations/command-run/v0.1\"\n        }\n      ],\n      \"functionaries\": [\n        {\n          \"type\": \"publickey\",\n          \"publickeyid\": \"ci-key\"\n        }\n      ]\n    },\n    \"package\": {\n      \"name\": \"package\",\n      \"attestations\": [\n        {\n          \"type\": \"https://witness.dev/attestations/material/v0.1\"\n        },\n        {\n          \"type\": \"https://witness.dev/attestations/product/v0.1\"\n        }\n      ],\n      \"functionaries\": [\n        {\n          \"type\": \"publickey\",\n          \"publickeyid\": \"ci-key\"\n        }\n      ]\n    }\n  }\n}\n```\n\n**Pipeline Commands:**\n\n```bash\n# Step 1: Build\nwitness run --step build \\\n  --attestations git,commandrun,product \\\n  -o build.json --key ci-key.pem \\\n  -- go build -o myapp\n\n# Step 2: Test\nwitness run --step test \\\n  --attestations material,commandrun \\\n  -o test.json --key ci-key.pem \\\n  -- go test ./...\n\n# Step 3: Package\nwitness run --step package \\\n  --attestations material,product \\\n  -o package.json --key ci-key.pem \\\n  -- tar czf myapp.tar.gz myapp\n\n# Verify entire pipeline\nwitness verify \\\n  --policy policy-signed.json \\\n  --publickey policy-key.pub \\\n  -a build.json -a test.json -a package.json\n```\n"}]}
{"messages": [{"role": "system", "content": "You are an expert in the Witness supply chain attestation framework. You help users instrument CI/CD pipelines with witness, create policy documents, and write Rego policies to validate attestations. You understand all attestors in go-witness and how to use them effectively."}, {"role": "user", "content": "How do I create a multi-step witness policy for a build \u2192 test \u2192 package pipeline?"}, {"role": "assistant", "content": "Here's a complete multi-step witness policy for your pipeline:\n\n**Policy Document:**\n```json\n{\n  \"expires\": \"2026-11-08T10:52:59Z\",\n  \"publickeys\": {\n    \"ci-key\": {\n      \"keyid\": \"sha256:2fde80fde8b86f8b5e4f3d33f310aff2236a6c8d6186714a77a4a31ca60487e6\",\n      \"key\": \"-----BEGIN PUBLIC KEY-----\\n...\\n-----END PUBLIC KEY-----\"\n    }\n  },\n  \"steps\": {\n    \"build\": {\n      \"name\": \"build\",\n      \"attestations\": [\n        {\n          \"type\": \"https://witness.dev/attestations/git/v0.1\"\n        },\n        {\n          \"type\": \"https://witness.dev/attestations/command-run/v0.1\"\n        },\n        {\n          \"type\": \"https://witness.dev/attestations/product/v0.1\"\n        }\n      ],\n      \"functionaries\": [\n        {\n          \"type\": \"publickey\",\n          \"publickeyid\": \"ci-key\"\n        }\n      ]\n    },\n    \"test\": {\n      \"name\": \"test\",\n      \"attestations\": [\n        {\n          \"type\": \"https://witness.dev/attestations/material/v0.1\"\n        },\n        {\n          \"type\": \"https://witness.dev/attestations/command-run/v0.1\"\n        }\n      ],\n      \"functionaries\": [\n        {\n          \"type\": \"publickey\",\n          \"publickeyid\": \"ci-key\"\n        }\n      ]\n    },\n    \"package\": {\n      \"name\": \"package\",\n      \"attestations\": [\n        {\n          \"type\": \"https://witness.dev/attestations/material/v0.1\"\n        },\n        {\n          \"type\": \"https://witness.dev/attestations/product/v0.1\"\n        }\n      ],\n      \"functionaries\": [\n        {\n          \"type\": \"publickey\",\n          \"publickeyid\": \"ci-key\"\n        }\n      ]\n    }\n  }\n}\n```\n\n**Pipeline Commands:**\n\n```bash\n# Step 1: Build\nwitness run --step build \\\n  --attestations git,commandrun,product \\\n  -o build.json --key ci-key.pem \\\n  -- go build -o myapp\n\n# Step 2: Test\nwitness run --step test \\\n  --attestations material,commandrun \\\n  -o test.json --key ci-key.pem \\\n  -- go test ./...\n\n# Step 3: Package\nwitness run --step package \\\n  --attestations material,product \\\n  -o package.json --key ci-key.pem \\\n  -- tar czf myapp.tar.gz myapp\n\n# Verify entire pipeline\nwitness verify \\\n  --policy policy-signed.json \\\n  --publickey policy-key.pub \\\n  -a build.json -a test.json -a package.json\n```\n"}]}
{"messages": [{"role": "system", "content": "You are an expert in the Witness supply chain attestation framework. You help users instrument CI/CD pipelines with witness, create policy documents, and write Rego policies to validate attestations. You understand all attestors in go-witness and how to use them effectively."}, {"role": "user", "content": "How do I create a witness policy for a build step that uses these attestors: git, material, github, product, commandrun?"}, {"role": "assistant", "content": "Here's a complete witness policy for your build step with git, material, github, product, commandrun attestors:\n\n**Policy Document:**\n```json\n{\n  \"expires\": \"2026-11-08T10:52:59Z\",\n  \"publickeys\": {\n    \"build-key\": {\n      \"keyid\": \"sha256:cded2d2eaa4c4d3b74109a01824307825451c797d6bdc81b0bd791dba72e450b\",\n      \"key\": \"-----BEGIN PUBLIC KEY-----\\n...\\n-----END PUBLIC KEY-----\"\n    }\n  },\n  \"steps\": {\n    \"build\": {\n      \"name\": \"build\",\n      \"attestations\": [\n        {\n          \"type\": \"https://witness.dev/attestations/git/v0.1\"\n        },\n        {\n          \"type\": \"https://witness.dev/attestations/material/v0.1\"\n        },\n        {\n          \"type\": \"https://witness.dev/attestations/github/v0.1\"\n        },\n        {\n          \"type\": \"https://witness.dev/attestations/product/v0.1\"\n        },\n        {\n          \"type\": \"https://witness.dev/attestations/command-run/v0.1\"\n        }\n      ],\n      \"functionaries\": [\n        {\n          \"type\": \"publickey\",\n          \"publickeyid\": \"build-key\"\n        }\n      ]\n    }\n  }\n}\n```\n\n**Witness Run Command:**\n```bash\nwitness run --step build \\\n  --attestations git,material,github,product,commandrun \\\n  --outfile build-attestation.json \\\n  --key signing-key.pem \\\n  -- <your-build-command>\n```\n\n**Rego Validation Rules:**\n```rego\npackage git\n\nimport rego.v1\n\n# Enforce builds from specific branch\ndeny contains msg if {\n    input.branch != \"bugfix/security\"\n    msg := sprintf(\"Must build from bugfix/security branch, got: %s\", [input.branch])\n}\n\n# Validate commit author\napproved_authors := {\n    \"alice.smith@example.com\",\n    \"bob.jones@company.com\",\n    \"ci-bot@company.com\"\n}\n\ndeny contains msg if {\n    not input.authoremail in approved_authors\n    msg := sprintf(\"Unauthorized commit author: %s\", [input.authoremail])\n}\n```\n\n**Verification:**\n```bash\nwitness verify \\\n  --policy policy-signed.json \\\n  --publickey policy-key.pub \\\n  -a build-attestation.json \\\n  --subject <artifact>\n```\n"}]}
