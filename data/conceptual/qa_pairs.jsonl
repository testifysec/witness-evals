{"messages": [{"role": "system", "content": "You are an expert in the Witness supply chain attestation framework. You help users instrument CI/CD pipelines with witness, create policy documents, and write Rego policies to validate attestations. You understand all attestors in go-witness and how to use them effectively."}, {"role": "user", "content": "What are the main flags for witness run?"}, {"role": "assistant", "content": "The main flags for `witness run` are:\n\n**Required**:\n- `--step <name>` - Step name for the attestation\n- `--signer-file-key-path <path>` or `-k` - Private key for signing\n- `-- <command>` - Command to run and attest\n\n**Common**:\n- `--attestations <list>` or `-a` - Comma-separated attestor list (default: environment,git)\n- `--outfile <path>` or `-o` - Output file for signed attestation\n- `--trace` - Enable process tracing (Linux only)\n\n**Example**:\n```bash\nwitness run --step build \\\n  --signer-file-key-path key.pem \\\n  --attestations git,environment,material,product \\\n  --outfile build.att \\\n  -- go build -o app\n```"}]}
{"messages": [{"role": "system", "content": "You are an expert in the Witness supply chain attestation framework. You help users instrument CI/CD pipelines with witness, create policy documents, and write Rego policies to validate attestations. You understand all attestors in go-witness and how to use them effectively."}, {"role": "user", "content": "What are the main flags for witness verify?"}, {"role": "assistant", "content": "The main flags for `witness verify` are:\n\n**Required**:\n- `--policy <path>` or `-p` - Signed policy document\n- `--publickey <path>` or `-k` - Public key to verify policy signature\n- `--attestations <file>` - Attestation file(s) to verify\n- `-f <file>` - Artifact file to verify against\n\n**Example**:\n```bash\nwitness verify \\\n  --policy policy-signed.json \\\n  --publickey policy-key.pub \\\n  --attestations build.att \\\n  -f myapp\n```"}]}
{"messages": [{"role": "system", "content": "You are an expert in the Witness supply chain attestation framework. You help users instrument CI/CD pipelines with witness, create policy documents, and write Rego policies to validate attestations. You understand all attestors in go-witness and how to use them effectively."}, {"role": "user", "content": "What fields does the git attestor capture?"}, {"role": "assistant", "content": "The git attestor captures:\n\n**Commit Information**:\n- `commithash` - SHA of current commit\n- `branch` - Current branch name (from HEAD)\n- `author` - Commit author name\n- `authoremail` - Commit author email\n- `committername` - Committer name\n- `committeremail` - Committer email\n- `commitmessage` - Commit message\n- `commitdate` - Commit timestamp\n\n**Repository State**:\n- `status` - Working directory status (modified, added, deleted files)\n- `remotes` - Remote URLs (credentials redacted)\n- `tags` - Tags pointing to current commit\n- `signature` - GPG signature if present\n- `parenthashes` - Parent commit SHAs\n- `treehash` - Git tree hash\n\n**Tool Information**:\n- `gittool` - \"go-git\" or \"go-git+git-bin\"\n- `gitbinpath` - Path to git binary (if using git-bin)\n- `gitbinhash` - Hash of git binary\n\nAll captured automatically when you include `git` in `--attestations`."}]}
{"messages": [{"role": "system", "content": "You are an expert in the Witness supply chain attestation framework. You help users instrument CI/CD pipelines with witness, create policy documents, and write Rego policies to validate attestations. You understand all attestors in go-witness and how to use them effectively."}, {"role": "user", "content": "What fields does the environment attestor capture?"}, {"role": "assistant", "content": "The environment attestor captures:\n\n**System Information**:\n- `os` - Operating system (linux, darwin, windows)\n- `hostname` - System hostname\n- `username` - Current user\n\n**Environment Variables**:\n- `variables` - Map of environment variable names to values\n- Sensitive variables are automatically filtered (passwords, tokens, keys)\n- Use `--env-add-sensitive-key` to add custom filters\n\n**Example output**:\n```json\n{\n  \"os\": \"linux\",\n  \"hostname\": \"build-server-01\",\n  \"username\": \"ci-runner\",\n  \"variables\": {\n    \"CI\": \"true\",\n    \"PATH\": \"/usr/local/bin:/usr/bin\",\n    \"GITHUB_ACTIONS\": \"true\"\n  }\n}\n```\n\nCaptured automatically when you include `environment` in `--attestations`."}]}
{"messages": [{"role": "system", "content": "You are an expert in the Witness supply chain attestation framework. You help users instrument CI/CD pipelines with witness, create policy documents, and write Rego policies to validate attestations. You understand all attestors in go-witness and how to use them effectively."}, {"role": "user", "content": "What's the difference between material and product attestors?"}, {"role": "assistant", "content": "**Material Attestor** (input files):\n- Captures files BEFORE the command runs\n- Records all files in working directory\n- Used to track source code, dependencies, configs\n- Type: `https://witness.dev/attestations/material/v0.1`\n\n**Product Attestor** (output files):\n- Captures files AFTER the command runs\n- Records files created or modified by the command\n- Used to track build artifacts, binaries, packages\n- Type: `https://witness.dev/attestations/product/v0.1`\n\n**Both are always included automatically** - you don't need to specify them in `--attestations`.\n\n**Example**:\n```bash\nwitness run --step build \\\n  --attestations git,environment \\\n  -k key.pem -o build.att \\\n  -- go build -o myapp\n\n# Material will include: main.go, go.mod, go.sum\n# Product will include: myapp (the binary)\n```"}]}
{"messages": [{"role": "system", "content": "You are an expert in the Witness supply chain attestation framework. You help users instrument CI/CD pipelines with witness, create policy documents, and write Rego policies to validate attestations. You understand all attestors in go-witness and how to use them effectively."}, {"role": "user", "content": "What is the structure of a witness policy document?"}, {"role": "assistant", "content": "A witness policy document has this structure:\n\n```json\n{\n  \"expires\": \"2026-12-31T23:59:59Z\",\n  \"publickeys\": {\n    \"<key-id>\": {\n      \"keyid\": \"<sha256:...>\",\n      \"key\": \"<base64-encoded-public-key>\"\n    }\n  },\n  \"steps\": {\n    \"<step-name>\": {\n      \"name\": \"<step-name>\",\n      \"attestations\": [\n        {\"type\": \"https://witness.dev/attestations/<attestor>/v0.1\"}\n      ],\n      \"functionaries\": [\n        {\n          \"type\": \"publickey\",\n          \"publickeyid\": \"<key-id>\"\n        }\n      ]\n    }\n  }\n}\n```\n\n**Key Fields**:\n- `expires`: Policy expiration timestamp (ISO 8601)\n- `publickeys`: Map of key IDs to public keys\n- `steps`: Map of step names to step definitions\n- `attestations`: Required attestor types for the step\n- `functionaries`: Authorized signers for the step\n\nSign the policy with:\n```bash\nwitness sign --infile policy.json --outfile policy-signed.json -k policy-key.pem\n```"}]}
{"messages": [{"role": "system", "content": "You are an expert in the Witness supply chain attestation framework. You help users instrument CI/CD pipelines with witness, create policy documents, and write Rego policies to validate attestations. You understand all attestors in go-witness and how to use them effectively."}, {"role": "user", "content": "What is a functionary in witness?"}, {"role": "assistant", "content": "A **functionary** is an authorized signer for a witness step.\n\n**Purpose**: Controls WHO can create attestations for each step in your pipeline.\n\n**Types**:\n1. **PublicKey functionary** - Specific public key must sign\n2. **X.509 functionary** - Certificate-based authorization\n\n**Example**:\n```json\n{\n  \"steps\": {\n    \"build\": {\n      \"functionaries\": [\n        {\n          \"type\": \"publickey\",\n          \"publickeyid\": \"sha256:abc123...\"\n        }\n      ]\n    }\n  }\n}\n```\n\n**How it works**:\n1. Developer signs attestation with their private key\n2. Witness verify checks signature against functionary list\n3. If key ID matches, attestation is trusted\n4. If not, verification fails\n\n**Best practice**: Different functionaries for different steps (build vs deploy)."}]}
{"messages": [{"role": "system", "content": "You are an expert in the Witness supply chain attestation framework. You help users instrument CI/CD pipelines with witness, create policy documents, and write Rego policies to validate attestations. You understand all attestors in go-witness and how to use them effectively."}, {"role": "user", "content": "What attestors are available in witness?"}, {"role": "assistant", "content": "Witness includes 27+ attestor types:\n\n**Core**:\n- `git` - Repository state\n- `environment` - System info and env vars\n- `material` - Input files (always included)\n- `product` - Output files (always included)\n- `command-run` - Command execution (always included)\n\n**CI/CD Platforms**:\n- `github` - GitHub Actions metadata\n- `gitlab` - GitLab CI metadata\n- `jenkins` - Jenkins environment\n- `aws-codebuild` - AWS CodeBuild info\n\n**Security**:\n- `sbom` - Software Bill of Materials\n- `vex` - Vulnerability info\n- `sarif` - Static analysis results\n- `secretscan` - Secret detection\n\n**Containers**:\n- `docker` - Docker daemon info\n- `oci` - OCI image metadata\n\n**Cloud Identity**:\n- `aws-iid` - AWS instance identity\n- `gcp-iit` - GCP identity token\n\n**Build Tools**:\n- `maven` - Maven project info\n- `lockfiles` - Dependency lockfiles\n- `slsa` - SLSA provenance\n\n**Other**:\n- `link` - in-toto link metadata\n- `k8smanifest` - Kubernetes manifests\n- `system-packages` - Installed packages\n- `omnitrail` - Omnitrail integration\n- `jwt` - JWT tokens\n- `policyverify` - Policy verification results\n\nUse with: `--attestations git,github,sbom,product`"}]}
