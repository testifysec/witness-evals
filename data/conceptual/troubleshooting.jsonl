{"messages": [{"role": "system", "content": "You are an expert in the Witness supply chain attestation framework. You help users instrument CI/CD pipelines with witness, create policy documents, and write Rego policies to validate attestations. You understand all attestors in go-witness and how to use them effectively."}, {"role": "user", "content": "Why do I get 'unknown flag: --key'?"}, {"role": "assistant", "content": "The correct flag is `--signer-file-key-path` or `-k`, not `--key`.\n\n**Correct usage**:\n```bash\nwitness run --step build \\\n  --signer-file-key-path key.pem \\\n  -o build.att \\\n  -- go build\n```\n\n**Short form**:\n```bash\nwitness run --step build -k key.pem -o build.att -- go build\n```"}]}
{"messages": [{"role": "system", "content": "You are an expert in the Witness supply chain attestation framework. You help users instrument CI/CD pipelines with witness, create policy documents, and write Rego policies to validate attestations. You understand all attestors in go-witness and how to use them effectively."}, {"role": "user", "content": "How do I fix 'failed to load any signers'?"}, {"role": "assistant", "content": "This error means witness couldn't load a signing key. Check:\n\n1. **Key file exists**: `ls -la key.pem`\n2. **Key file permissions**: `chmod 600 key.pem`\n3. **Key format is correct**: Ed25519 or RSA\n\n**Generate Ed25519 key**:\n```bash\nopenssl genpkey -algorithm ed25519 -out key.pem\n```\n\n**Generate RSA key**:\n```bash\nopenssl genrsa -out key.pem 2048\n```\n\nThen use with `-k key.pem`"}]}
{"messages": [{"role": "system", "content": "You are an expert in the Witness supply chain attestation framework. You help users instrument CI/CD pipelines with witness, create policy documents, and write Rego policies to validate attestations. You understand all attestors in go-witness and how to use them effectively."}, {"role": "user", "content": "What does 'attestor not found' mean?"}, {"role": "assistant", "content": "Attestor name is incorrect. Use exact name from `witness attestors list`.\n\n**Common mistakes**:\n- `commandrun` \u2192 Correct: `command-run` (with hyphen)\n- `aws-iid` \u2192 Correct: `aws` (no -iid suffix)\n\n**Check available attestors**:\n```bash\nwitness attestors list\n```\n\n**Correct usage**:\n```bash\nwitness run --step build -a git,environment,material,product -k key.pem -o build.att -- go build\n```"}]}
{"messages": [{"role": "system", "content": "You are an expert in the Witness supply chain attestation framework. You help users instrument CI/CD pipelines with witness, create policy documents, and write Rego policies to validate attestations. You understand all attestors in go-witness and how to use them effectively."}, {"role": "user", "content": "Why does verification fail with 'no verifiers present to validate against collection verifiers'?"}, {"role": "assistant", "content": "This usually means the public key in your policy doesn't match the signing key.\n\n**Debug steps**:\n\n1. **Extract key ID from attestation**:\n```bash\njq -r '.signatures[0].keyid' build.att\n```\n\n2. **Check policy has that key ID**:\n```bash\njq '.publickeys | keys' policy.json\n```\n\n3. **Ensure key IDs match**:\nThe `publickeyid` in functionaries must match a key in `publickeys`.\n\n**Fix**: Regenerate policy with correct key ID extracted from attestation."}]}
{"messages": [{"role": "system", "content": "You are an expert in the Witness supply chain attestation framework. You help users instrument CI/CD pipelines with witness, create policy documents, and write Rego policies to validate attestations. You understand all attestors in go-witness and how to use them effectively."}, {"role": "user", "content": "How do I debug Rego policy failures?"}, {"role": "assistant", "content": "Test Rego policies with OPA before adding to witness:\n\n**1. Save Rego to file**:\n```bash\ncat > policy.rego <<'EOF'\npackage git\nimport rego.v1\ndeny contains msg if {\n    input.branch != \"main\"\n    msg := \"Wrong branch\"\n}\nEOF\n```\n\n**2. Create test input from attestation**:\n```bash\njq '.predicate.attestations[] | select(.type | contains(\"git\")) | .attestation' build.att > test-input.json\n```\n\n**3. Test with OPA**:\n```bash\nopa eval -d policy.rego -i test-input.json 'data.git.deny'\n```\n\n**4. Check output**:\n- Empty result `{}` - policy passed\n- Has values - shows denial messages\n\nThis lets you test Rego before running full witness verify."}]}
